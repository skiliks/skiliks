<?php

class m130118_114923_mail_sending_time extends CDbMigration
{
	public function up()
	{
        $connection = $this->getDbConnection();
        $transaction = $connection->beginTransaction();
        try
        {
            $this->delete('mail_box');
            $mail_template = $connection->createCommand("SELECT `t`.`id`, `t`.`sending_time_str`, `t`.`sending_date_str` FROM `mail_template` AS `t`")->queryAll();
            $this->addColumn('mail_template', 'sent_at', 'datetime DEFAULT NULL');
            $this->dropColumn('mail_template', 'receiving_date');
            $this->dropColumn('mail_template', 'sending_date');
            $this->dropColumn('mail_template', 'sending_time');
            $this->dropColumn('mail_template', 'sending_time_str');
            $this->dropColumn('mail_template', 'sending_date_str');
            $this->addColumn('mail_box', 'sent_at', 'datetime DEFAULT NULL');
            $this->dropColumn('mail_box', 'receiving_date');
            $this->dropColumn('mail_box', 'sending_date');
            $this->dropColumn('mail_box', 'sending_time');

            foreach($mail_template as $mail){


                if(empty($mail['sending_time_str'])) {
                    $datetime = null;
                }else{
                    $date = new DateTime($mail['sending_date_str'].' '.$mail['sending_time_str'], new DateTimeZone('Europe/Moscow'));
                    $datetime = $date->format('Y-m-d H:i:sP');
                }
                $this->update('mail_template', ['sent_at'=>$datetime], "id = ".$mail['id']);

            }

        }
        catch(Exception $e)
        {
            echo "Exception: ".$e->getMessage()."\n";
            $transaction->rollback();
            return false;
        }
	}

	public function down()
	{
        $connection = $this->getDbConnection();
        $transaction = $connection->beginTransaction();
        try
        {
            $this->dropColumn('mail_box', 'sent_at');
            $this->addColumn('mail_box', 'receiving_date', 'int(11) DEFAULT NULL');
            $this->addColumn('mail_box', 'sending_date', 'int(11) DEFAULT NULL');
            $this->addColumn('mail_box', 'sending_time', 'int(11) DEFAULT NULL');
            $mail_template = "
                SET NAMES utf8;
                SET FOREIGN_KEY_CHECKS = 0;

                -- ----------------------------
                --  Table structure for `mail_template`
                -- ----------------------------
                DROP TABLE IF EXISTS `mail_template`;
                CREATE TABLE `mail_template` (
                  `id` int(11) NOT NULL AUTO_INCREMENT,
                  `group_id` int(11) NOT NULL DEFAULT '5',
                  `sender_id` int(11) NOT NULL,
                  `receiver_id` int(11) NOT NULL,
                  `sending_date` int(11) DEFAULT NULL,
                  `receiving_date` int(11) DEFAULT NULL,
                  `message` text,
                  `subject_id` int(11) DEFAULT NULL,
                  `code` varchar(5) NOT NULL,
                  `sending_time` int(11) DEFAULT NULL,
                  `type` tinyint(4) NOT NULL DEFAULT '0' COMMENT 'Столбец нужен для типа сообщения 1 - Входящие, 2 - Исходящие, 3 - Входящие(доставлен), 4 - Исходящие(доставлен)',
                  `sending_time_str` varchar(5) DEFAULT NULL,
                  `sending_date_str` varchar(10) DEFAULT NULL,
                  `type_of_importance` enum('none','2_min','plan','info','first_category','spam','reply_all') DEFAULT 'none' COMMENT 'Is it spam, is it impotrant etc. None - not desided by game autor jet.',
                  PRIMARY KEY (`id`),
                  UNIQUE KEY `mail_code_unique` (`code`),
                  KEY `fk_mail_template_group_id` (`group_id`),
                  KEY `fk_mail_template_sender_id` (`sender_id`),
                  KEY `fk_mail_template_receiver_id` (`receiver_id`),
                  KEY `fk_mail_template_subject_id` (`subject_id`)
                ) ENGINE=InnoDB AUTO_INCREMENT=97 DEFAULT CHARSET=utf8 COMMENT='Шаблоны писем';

                -- ----------------------------
                --  Records of `mail_template`
                -- ----------------------------

                INSERT INTO `mail_template` VALUES ('1', '1', '4', '1', '1331375520', null, 'Добрый день! \n\nЯ немного с опережением сделала работу по ценовой политике (вчера выдался свободный вечер). Мне кажется, что я отразила все мысли, которые мы обсуждали на установочной встрече. Будет время в отпуске - посмотрите. \n\nС уважением, Марина Крутько  \nВедущий аналитик отдела анализа и планирования', '833', 'MY1', '632', '3', '10:32', '03.10.2012', 'none'), ('2', '1', '11', '1', '1331377320', null, 'Доброго вам времени суток! \nПроизводственный отдел просит вас рассмотреть возможность внесения изменений в текущую форму отчетности по объемам производства и производственным мощностям. На текущий момент в отчетности не достает развернутого анализа остатков на всех наших складах, включая торговые. Это приводит к тому, что мы периодически производим товар, который уже есть в регионах. Логисты говорят, что вполне могли бы обеспечить перебросу товара из одного региона в другой. Таким образом, нам удалось бы сэкономить на производственных издержках без снижения объемов продаж. Прошу вас оценить сроки, трудоемкость и наличие возможности добавить в производственный отчет данные по складским остаткам.\nЗаранее благодарю, Бобр В.,  \nНач. производственного отдела.', '834', 'MY2', '662', '3', '11:02', '03.10.2012', 'none'), ('3', '1', '13', '1', '1397069100', null, 'Коллеги, добрый день!        \nПосле нескольких продуктивных совещаний с вами (отдельное спасибо Федорову А. за регулярное участие!) мы подготовили итоговую версию системы мотивации для менеджеров первого и второго уровня. Мы планируем вводить ее в действие с начала 02 года (именно она и будет забюджетирована). Ждем ваших окончательных комментариев и корректировок. Если не участвуете в обсуждении - потом не сетуйте на то, что система была принята без вашего весомого голоса! Благодарю за оперативность! \nС наилучшими пожеланиями, Людовкина С.', '835', 'MY3', '1125', '3', '18:45', '28.09.2012', 'none'), ('4', '1', '18', '1', '1326213000', null, 'Коллеги! В связи с изменениями трудового законодательства юридический отдел вынужден внести в трудовой договор, действующий в данный момент в компании как основной, ряд корректив. Просим вас ознакомиться с ними и донести до своих сотрудников, что с 01 января 02 года будет запущена кампания по подписанию такого варианта трудового договора со всеми актуальными и вновь пришедшими сотрудниками компании. Просим отнестить к этой работе со всей ответственностью и должным вниманием. \nС уважением, Адвокатов Ю.', '836', 'MY4', '990', '3', '16:30', '01.10.2012', 'none'), ('5', '5', '9', '1', '1334071800', null, 'Добрый день, коллеги! \nЯ, как всегда, по срочному вопросу. Ни у кого ведь нет сомнений, что продажи крайне важны для компании?! Судя по тому, как у нас работает аналитически отдел - этот приоритет ему не ясен. Дело в том, что у нас регулярно запаздвает отчетность, я так работать не могу - данные приходят тогда, когдя я уже все продала, и планировать поздно. Таким образом, я и мои люди постоянно действуем вслепую!  И это по трем тысячам клиентов!  Какие у вас есть мнения, что с этим делать. ', '837', 'M1', '930', '1', '15:30', '04.10.2012', '2_min'), ('6', '5', '9', '1', '1334066700', null, 'Без комментариев - читайте сами!  Прошу ответ срочно!\nДиректор по продажам Скоробей А.М.     \n\nFwd:\n Уважаемая Алевтина Михайловна! Несколько раз обращался к вашим менеджерам, но воз и ныне там.  Нам очень не удобно работать с вашим текущим прайс-листом! Формат, выбранный вами, не позволяет закачивать цены автоматически и все приходится вбивать вручную. Это серьезно замедляет приемку товара и постановку его в продажи! Хочу отметить, что у всех ваших конкурентов прайс-листы сделаны современым способом и не требуют от нас таких трудозатрат. \n\nПрошу вас решить эту проблему как можно скорее, иначе со следующего месяца нам придется выставлять вам счет за работу людей, вбивающих ваши цены в нашу систему. \n\nС уважением, Горбатюк Е.Д. \nДиректор ООО \"Луч\"', '838', 'M2', '845', '1', '14:05', '04.10.2012', '2_min'), ('7', '5', '13', '1', '1334064600', null, 'Алексей! \nЯ засекла всех твоих аналитиков на ресурсе по поиску работы. Даже новенького. Ну он еще пока может и не снимал своего объявления - ждет окончания испытательного срока, но вот другие… Что ты с ними делаешь? Бьешь что-ли? Тебе надо с ними поговорить. Я тебе трех аналитиков за 2 дня не найду!  \nВсего доброго, Людовкина С.', '839', 'M3', '810', '1', '13:30', '04.10.2012', 'plan'), ('8', '5', '8', '1', '1334059260', null, 'Привет, Леша! У нас началась подготовка к годовой стратегической сессии. Ты вечно не доволен форматом нашей презентации, которую заполняют все подразделения для отчета и планов. Шли свои предложения заранее, чтобы ничего не переделывать в пожарном режиме. Удачи, Олег', '840', 'M4', '721', '1', '12:01', '04.10.2012', 'plan'), ('9', '5', '16', '37', '1334062200', null, 'Срочно! Подготовить и переслать график отпусков на следующий год. Кто не шлет - в отпуск не идет!  \nОтдел кадров.', '841', 'M5', '770', '1', '12:50', '04.10.2012', 'plan'), ('10', '5', '7', '37', '1334055720', null, 'Внимание! Важно!\n \nУ нас начали работу консультанты по стратегии. Проект большой и важный, требует участия каждого! Просьба всем, как можно скорее, согласовать свои встречи с консультантами! \n\nЭто просьба Генерального Директора. \n\nС уважением, ассистент ГД Долгова Н.Т.', '842', 'M6', '662', '1', '11:02', '04.10.2012', 'info'), ('11', '5', '14', '37', '1334058000', null, 'Коллеги! \nТретий раз прошу всех переслать свои пожелания по закупке офисной мебели и планы по ремонту, я из-за вас не могу бюджет сдать нормальный. Всем, кто уже прислал - спасибо! Жду до конца сегодняшнего дня.  \nС уваженим, Хозин.', '843', 'M7', '700', '1', '11:40', '04.10.2012', 'info'), ('12', '5', '10', '1', '1334055660', null, 'Алексей, срочный вопрос! \n\nМы протестировали ваш сервер на предмет восстановления и ап-грейда. Ребята возились с ним почти неделю, к сожалению, восстановлению и ремонту он не подлежит! Нужно менять срочно! \n\nВ нашем бюджете денег на смену сервера не предусмотрено. Я так понимаю, ты тоже такого форс-мажора не предвидел?!\n\nПиши служебку на деньги. Надо ХХ тыс. на ЕХ5 сервер (менее мощный покупать бессмысслено). \n\nПротянешь - будем разгребать проблемы с потерей информации. Мне ваши объемы информации хранить негде. \n\nВсего, Семен', '844', 'M8', '661', '1', '11:01', '04.10.2012', 'first_category'), ('13', '5', '4', '1', '1334016000', null, 'Добрый день! \n\nПересылаю пока сырую презентацию для ГД.  Что делать дальше мне ясно. Устраивает ли вас структура? Все данные для ее заполнения у меня готовы. Постараюсь завершить работу к 15.30. \n\nС уважением, Марина Крутько \nВедущий аналитик отдела анализа и планирования.', '845', 'M9', '0', '1', '', '04.10.2012', 'plan'), ('14', '5', '4', '1', '1334071800', null, 'Алексей, пересылаю итоговую версию презентации для ГД. Я бы еще поработала над оформлением, но суть уже закончена и можно показывать. Жду обратной связи. \n\nС уважением, Марина Крутько Ведущий аналитик отдела анализа и планирования.', '846', 'M10', '930', '1', '15:30', '04.10.2012', 'first_category'), ('15', '5', '4', '1', '1334016000', null, 'Отправляю все, что есть. Версия черновая. \n\nС уважением, Марина Крутько Ведущий аналитик отдела анализа и планирования.', '847', 'M11', '0', '1', '', '04.10.2012', 'plan'), ('16', '5', '2', '1', '1334016000', null, 'Прошу не отвлекать меня от работы по вопросам, относящимся к твоей зоне ответственности.  Спроси у меня еще как цифры в excel поменять! \nДенежная Р.Р.', '848', 'M12', '0', '1', '', '04.10.2012', 'info'), ('17', '5', '12', '1', '1334016000', null, 'Привет, Алексей! Проверяю. Как будет готов - перешлю. \nУдачи, Трудякин', '849', 'M31', '0', '1', '', '04.10.2012', 'info'), ('18', '5', '12', '1', '1334016000', null, 'Прекрати отвлекать от работы! \nТрудякин.', '850', 'M33', '0', '1', '', '04.10.2012', 'info'), ('19', '5', '12', '1', '1334016000', null, 'Алексей! Пересылаю бюджет логистики на 02 год. \nС уважением, Трудякин.', '269', 'M34', '0', '1', '', '04.10.2012', 'info'), ('20', '5', '12', '1', '1334016000', null, 'Алексей, прикрепляю форму для выгрузки данных. \nСделайте точно в этом разрезе по прошедшим девяти месяцам 01 года. \nСпасибо за помощь! \nТрудякин.', '851', 'M41', '0', '1', '', '04.10.2012', 'first_category'), ('21', '5', '3', '12', '1334016000', null, 'Добрый день! Заполнил вашу форму. Есть ли вопросы? \nВсего доброго, Трутнев С.', '852', 'M43', '0', '1', '', '04.10.2012', 'info'), ('22', '5', '3', '1', '1334016000', null, 'Вот, сделал. Смотрите. \nС уваженим, Трутнев С.', '853', 'M44', '0', '1', '', '04.10.2012', 'info'), ('23', '5', '25', '1', '1334056500', null, 'Привет, Алексей! \n\nУ меня просьба, срочная! \nПришли, пожалуйста, данные по динамике рынка за 00 - 01 год (рост объемов продаж). Даже если вы исследований не делаете, то у вас процентов 50% всего рынка представлено в закупках. Легко можно экстраполировать на весь рынок. \n\nБез этих данных я не могу проверить корректность нашего бюджета. У меня на все осталось пять дней. \n\nОчень нужно, не подведи! \n\nЗаранее благодарю, Иван Доброхотов \nНач.отдела анализа и планирования ОАО \"Терминал\"', '854', 'M47', '675', '1', '11:15', '04.10.2012', '2_min'), ('24', '5', '11', '1', '1334070300', null, 'Уважаемый Алексей! \nПриношу извинения еще раз! Как я сказал по телефону, здесь нет нашей прямой вины. Очень постараемся не допускать такого в будущем году. Прошу Вас рассмотреть и включить новую версию в сводный бюджет. \nС глубочайшим уважением, Бобр В.', '855', 'M56', '905', '1', '15:05', '04.10.2012', 'info'), ('25', '5', '19', '1', '1334073660', null, 'Коллеги!         \nПросим всех сотрудников обновить информацию о номерах своих пенсионных свидетельтв. Часть из вас не сдала свидетельства еще с прошлого года!\nОбращаем ваше внимание, что следующая зп не будет начислена, если данные не будут представлены или обновлены.  \nБухгалтерия.', '856', 'M60', '961', '1', '16:01', '04.10.2012', 'spam'), ('26', '5', '24', '1', '1334076300', null, 'Уважаемая бухгалтерия!  \nЯ передал вам информацию дважды, и вы все время ее теряете! Больше давать данные не стану - это дело принципа! Каждый должен выполнять свою работу: моя работа - заниматься производством, ваша - хранить данные!\nСерков А.Т.', '857', 'M61', '1005', '1', '16:45', '04.10.2012', 'spam'), ('27', '5', '19', '1', '1334077380', null, 'Уважаемый Г-н Серков! \nВаши данные у нас есть. Можете не предоставлять. Однако не все в офисе столь же сознательные и ответственные. А данные ваша были утрачены не по вине бухгалтерии, а по причине отвратительно организованного переезда в новый офис. \nБухгалтерия.', '858', 'M62', '1023', '1', '17:03', '04.10.2012', 'spam'), ('28', '5', '14', '1', '1334078220', null, 'Уважаемая бухгалтерия! \nДавайте не поднимать давно забытый скандал! Вы же даже сами тогда извинялись за свои необоснованные претензии. Для того, чтобы сохранить важные данные, их надо складывать в отведенные для этого места! \nНач.АХО, Хозин.', '859', 'M63', '1037', '1', '17:17', '04.10.2012', 'spam'), ('29', '5', '29', '1', '1334074200', null, 'Леша, здорово!\nЕсть лишний билет на матч Лиги чемпионов Спартак-Барселона в сектор С. Поедешь с нами? Давно не виделись. Ответь срочно! \nОлег \n', '860', 'M64', '970', '1', '16:10', '04.10.2012', 'spam'), ('30', '5', '17', '1', '1334078580', null, 'Уважаемые коллеги, \nв понедельник в офисе будет проведена вакцинация. Время вакцинации вашего отдела с 10 до 12 в большой переговорной. Стоимость вакцинации включена в вашу страховку. Всем, кто не пройдет вакцинацию, больничный оплачиваться не будет.  \nОтдел персонала ', '861', 'M65', '1043', '1', '17:23', '04.10.2012', '2_min'), ('31', '5', '17', '1', '1334070180', null, 'Уважаемые коллеги, \nк нашей компании присоединился новый сотрудник - - главный экономист - Сергей Иванович. Сергей Иванович работал в компании “LTD” более 10 лет. Прошу вас найти время и встретиться с ним, чтобы познакомиться и помочь войти в курс дела. \nОтдел  персонала', '862', 'M66', '903', '1', '15:03', '04.10.2012', 'spam'), ('32', '5', '30', '1', '1334074620', null, 'Леха, привет, братан!  Ты не забыл, что отцу 60 в конце этого месяца? Надо придумать подарок и организовать ресторан. Ты дернешь в отпуск - а я все буду делать один? Так не пойдет! Подарок я куплю, а ресторан бери на себя! Нам надо разместить человек двадцать, лучше без музыки и рядом с домом родителей - чтобы пешком. Найдешь - пиши адрес, я всех приглашу, так уж и быть!  \nСерый. \nP.S.Как думаешь, дядю Андрея приглашать? Он же брат, только вот они с отцом не очень...', '863', 'M67', '977', '1', '16:17', '04.10.2012', 'info'), ('33', '5', '19', '1', '1334076300', null, 'Коллеги,  просим вас проверить дату истечения ваших кредитных карт. Сообщите нам, если ваша карта истекает в этом месяце, чтобы мы могли во время заняться перевыпуском. Напоминаем, если данные от вас не поступают, мы считаем, что ваша карта не нуждается в перевыпуске! \nБухгалтерия', '864', 'M68', '1005', '1', '16:45', '04.10.2012', 'spam'), ('34', '5', '31', '1', '1334080080', null, 'Алексей, приветствую.\n\nМы не знакомы лично. Ваш адрес мне дал наш общий знакомый с самыми лучшими рекомендациями вашего профессионализма.\n \nЯ руковожу фирмой “Легкий полет”, мы ищем опытного аналитика и менеджера для нашего планового отдела из 5 человек. \n\nБыло бы вам интересно обсудить возможность другой работы? \n\nС уважением,\nСтепанов Сергей ', '865', 'M69', '1068', '1', '17:48', '04.10.2012', 'spam'), ('35', '5', '32', '1', '1334073300', null, 'Дорогие мои, \nнадо чаще встречаться, как говорится в слогане известного пива. В эту пятницу будет 5 лет со дня нашего выпуска. Вы, конечно, все очень серьезные и занятые люди, но отказать мне не имеете права. Жду всех (я имею в виду всех, и тебя Леша, и тебя Ксюша) в 19.00 в Парке Культуры возле Бурана. Я подготовла для вас сюрприз. \nТолько немного намекну... “Он капитан, и родина его Марсель...” Помните?! \nВсех целую,\nваша вечная староста, \nМарина ', '866', 'M70', '955', '1', '15:55', '04.10.2012', 'spam'), ('36', '5', '13', '1', '1334062980', null, 'Алексей, \nперешли мне. плз., описание позиции \"Аналитик\", по которому мы Лошадкина искали. Что-то не могу его у себя в компе найти, удалила что-ли...\nНадеюсь, за твой отпуск продвинемся и к твоему возвращению будет у тебя несколько кандидатов на встречу. Время сейчас хорошее.\nУдачи,\nЛюдовкина С.', '867', 'M71', '783', '1', '13:03', '04.10.2012', '2_min'), ('37', '5', '15', '1', '1334066580', null, 'Алексей, добрый день! \n\nМы проводим комплексный анализ работы подразделения в регионе С. В том числе нас интересует складской остаток на 01 число каждого месяца за весь текущий год. \n\nОгромная просьба подготовить этот отчет в ближайшие дни. Моя командировка закончится в понедельник, а мне еще надо провести инвентаризацию на базе данных, которые будут в этом отчете.\n\nСпасибо за помощь,\nАндрей Точных\nНач.службы внутреннего аудита', '868', 'M72', '843', '1', '14:03', '04.10.2012', '2_min'), ('38', '5', '20', '1', '1334057700', null, 'Алексей, приветствую!\nЯ взял на работу регионального аналитика, как мы и договаривались. Надеюсь, что теперь у нас будут значительно быстрее проводится все операции. Вы мне обещали его натаскать и задать корпоративный стандарт работы. Он весь ваш!\nС уважением,\nКаменский В.П.\nИсполнительный директор регионального подразделения Д', '869', 'M73', '695', '1', '11:35', '04.10.2012', 'plan'), ('39', '5', '23', '1', '1334070000', null, 'Добрый день,\n\nВаша сотрудница М.Крутько прислана нам запрос на закупку нескольких фото файлов. Говорит, что нужны для презентации. Мы так не работаем. Нам нужен запрос от руководителя отдела и вообще-то это оформляется через служебку. Вы подтверждаете, что ей нужны файлы?\n\nОтдел рекламы и оформления\nПетрашевич И.', '870', 'M74', '900', '1', '15:00', '04.10.2012', '2_min'), ('40', '5', '12', '1', '1334078220', null, 'Алексей,\nа дай-ка мне адресок какого-нибудь положительного клиента. Хочу ему пару вопросов задач, чтобы представить весь объем моих работ по проекту.\n\nСпасибо,\nТрудякин', '871', 'M75', '1037', '1', '17:17', '04.10.2012', '2_min'), ('41', '5', '22', '1', '1334060580', null, 'Алексей, привет!\nТы меня спрашивал несколько дней назад когда я смогу тебе показать работу аналитической надстройки, что прислали наши подрядчики. Могу сегодня. Тебе в 4-5 дня подойдет?\n\nМягков Юра', '872', 'M76', '743', '1', '12:23', '04.10.2012', '2_min'), ('42', '5', '33', '1', '1334065680', null, 'Уважаемый Алексей!\n\nВы направляли в адрес нашей конференции заявку на участие в роли спикера. \n\nЗаявленная вами тема показалась оргкомитету актуальной и заслуживающей внимания.\n\nПросим вас подготовить тезисы вашего выступления и переслать их в наш адрес не позднее 30 октября.\n\nБлагодарим за ваше участие, \nОрганизационный комитет конференции \"Аналитика и бизнес\"\nИванова О.И.', '873', 'M77', '828', '1', '13:48', '04.10.2012', 'plan'), ('43', '3', '1', '2', '1331396400', null, 'Раиса Романовна, добрый вечер!\n\nВо вложении файл с отчетом для Правления. Дайте знать, пожалуйста, есть ли замечания, постараюсь внести коррективы к дате встречи Правления. \n\nС уважением,\nФедоров А.', '874', 'MSY10', '980', '4', '16:20', '03.10.2012', ''), ('44', '5', '1', '2', '1334016000', null, 'Раиса Романовна, \n\nВо вложении скорректированный файл с отчетом для Правления.  \n\nС уважением,\nФедоров А.', '322', 'MS10', '0', '2', '', '04.10.2012', ''), ('45', '5', '1', '2', '1334016000', null, 'Служебная записка', '213', 'MS20', '0', '2', '', '04.10.2012', ''), ('46', '5', '1', '4', '1334016000', null, 'Марина,\n\nво вложении - файл Сводного бюджета. Как мы и говорили, задача срочная. У нас есть всего три часа. Будут вопросы - обращайся!\n\nС уважением,\nА.Федоров', '323', 'MS21', '0', '2', '', '04.10.2012', ''), ('47', '5', '1', '3', '1334016000', null, 'Сергей,\n\nво вложении - файл Сводного бюджета. Как мы и говорили, задача срочная. У нас есть всего три часа. Будут вопросы - обращайся!\n\nС уважением,\nА.Федоров', '323', 'MS22', '0', '2', '', '04.10.2012', ''), ('48', '5', '1', '3', '1334016000', null, 'Сергей,\n\nво вложении - Методика формирования сводного бюджета. Думаю, она поможет ответить на все твои вопросы. Если что не понятно - обращайся!\n\nС уважением,\nА.Федоров', '233', 'MS23', '0', '2', '', '04.10.2012', ''), ('49', '5', '1', '6', '1334016000', null, 'Уважаемый Валерий Семенович,\n\nво вложении - Презентация на выставку. \n\nГотов ответить на Ваши вопросы и дать комментарии!\n\nС уважением,\nА.Федоров', '220', 'MS25', '0', '2', '', '04.10.2012', ''), ('50', '5', '1', '3', '1334016000', null, 'Сергей! \nПрочти сообщение ниже и срочно подготовь служебку на получение денег для сервера на имя Денежной. \n\nС уважением,\nФедоров А.\n\n', '326', 'MS27', '0', '2', '', '04.10.2012', ''), ('51', '5', '1', '11', '1334016000', null, 'Уважаемый Василий,\n\nя нашел для вас последнюю итоговую версию бюджета производства прошлого года. Она во вложении.\n\nВсего доброго,\nФедоров А.', '279', 'MS28', '0', '2', '', '04.10.2012', ''), ('52', '5', '1', '3', '1334016000', null, 'Сергей,\n\nпрошу тебя найти последнюю итоговую версию бюджета производства на 01 год и переслать ее Начальнику производственного отдела  Василию Бобру. Поставь меня в копию, пожалуйста.\n\nС уважением,\nФедоров А.', '253', 'MS29', '0', '2', '', '04.10.2012', ''), ('53', '5', '1', '12', '1334016000', null, 'Егор, приветствую!\n\nНесмотря на прошедший срок сдачи, так и не получил от вас бюджет логистики на 02 год. Надеюсь, что ты понимаешь, что отсутствие вашего бюджета задерживает весь процесс бюджетирования и формирования сводного. От меня требуется подготовить и сдать сводный бюджет в течение трех часов. Срочно жду от тебя бюджет логистики! \n\nС уважением,\nФедоров А.', '269', 'MS30', '0', '2', '', '04.10.2012', ''), ('54', '5', '1', '12', '1334016000', null, 'Егор, \n\nвсе возможные сроки реакции на мою просьбу уже прошли! Я требую немедленно предоставить бюджет логистики или мне придется информировать Генерального директора о несоблюдении регламента. \n\nС уважением,\nФедоров А.', '423', 'MS32', '0', '2', '', '04.10.2012', ''), ('55', '5', '1', '2', '1334016000', null, 'Вот сводный бюджет. Файл прикреплен', '208', 'MS35', '0', '2', '', '04.10.2012', ''), ('56', '5', '1', '2', '1334016000', null, 'Вот новый сводный бюджет. Изменения следующие….Файл прикреплен', '209', 'MS36', '0', '2', '', '04.10.2012', ''), ('57', '5', '1', '4', '1334016000', null, 'Марина,\n\nя посмотрел наброски к презентации. Все в порядке, продолжай! Жду итоговый вариант к 15.30.\n\nС уважением,\nФедоров А.', '457', 'MS57', '0', '2', '', '04.10.2012', ''), ('58', '5', '1', '4', '1334016000', null, 'хорошо, продолжай, о результатах встречи расскажу', '458', 'MS37', '0', '2', '', '04.10.2012', ''), ('60', '5', '1', '4', '1334016000', null, 'Распечатай столько-то к такому-то числу, в цвете. ', '247', 'MS39', '0', '2', '', '04.10.2012', ''), ('61', '5', '1', '3', '1334016000', null, 'Сергей,\n\nнесколько дней назад логисты просили сделать для них выгрузку. Мы обсуждали с тобой эту задачу и сроки ее исполнения. Сегодня - срок сдачи работы. Перешли мне то, что у тебя получилось в ближайшие тридцать минут, пожалуйста. \n\nС уважением,\nФедоров А.', '228', 'MS58', '0', '2', '', '04.10.2012', ''), ('62', '5', '1', '3', '1334016000', null, 'Логисты хотят получить данные в приложенной форме. За последние 9 месяцев. Сделай срочно! Думаю, что пару часов тебе хватит. Вложен пример формы.', '229', 'MS42', '0', '2', '', '04.10.2012', ''), ('63', '5', '1', '12', '1334016000', null, 'Егор,\n\nво вложении - форма о твоему запросу. \n\nМы сделали срочно, как ты и просил.\n\nСообщи, пожалуйста, все ли вас устраивает и не осталось ли вопросов по этому заданию.\n\nС уважением,\nФедоров А.', '274', 'MS45', '0', '2', '', '04.10.2012', ''), ('64', '5', '1', '3', '1334016000', null, 'По задаче ТЕ3.2 Подготовь отчет по данным от наших клиентов - по всему рынку. В нем должно быть отражено…..  И отправь Ивану Доброхотову - я в копии.', '779', 'MS46', '0', '2', '', '04.10.2012', ''), ('65', '5', '1', '2', '1334016000', null, 'По задаче ТRC6 (o доле производственных затрат). Должен написать точно тему, хорошо струткурировать письмо. Сдлеть эту работу срочно после звонка.', '212', 'MS48', '0', '2', '', '04.10.2012', ''), ('66', '5', '1', '9', '1334016000', null, 'Давайте встретимся. У меня есть информация по процессу вашего бюджета. Есть что обсудить.ИЛИ  Разговаривал с вашим нач.отдела продаж региона А. Он рассказал о вашей системе планирования. Это безобразие! Это не верный метод. Вы таким образом ставите под угрозу бюджет всей компании. Дайте мне слово, что все поменяете, иначе я буду жаловаться ФД!', '324', 'MS49', '0', '2', '', '04.10.2012', ''), ('67', '5', '1', '2', '1334016000', null, 'Жалоба на ОК. Эти козлы время не согласовывают, а потом меня еще пугают!', '214', 'MS50', '0', '2', '', '04.10.2012', ''), ('68', '5', '1', '7', '1334016000', null, 'Наталья Тимофеевна,\n\nБосс просил уточнить у вас следующую информацию относительно его презентации на выставке:\n1. Сколько копий нам надо распечатать.\n2. Кому передать распечатанные копии.\n3. Когда они должны быть переданы.\n\nСпасибо за информацию,\nФедоров А.', '304', 'MS51', '0', '2', '', '04.10.2012', ''), ('69', '5', '1', '3', '1334016000', null, 'Стандартная работа по подготовке отчета по 3 кв. Начинай с продаж. К моему возвращению отчет должен быть у меня на проверку.', '780', 'MS54', '0', '2', '', '04.10.2012', ''), ('70', '5', '1', '39', '1334016000', null, 'Коллеги,\n\nзавтра, в 12.00, приглашаю вас в мой кабинет для презентации новой системы премирования на 4 квартал.\n\nС уважением,\nФедоров А.', '309', 'MS55', '0', '2', '', '04.10.2012', ''), ('71', '5', '1', '9', '1334016000', null, 'ответить всем и предложить встретиться для обсуждения этого вопроса, в неправильной версии - разъяснения, что аналитика понимает важность продаж, что отчетность сейчас собирается долго т.к. Не автоматизирован процесс сбора данных с клиентов, а мы этим сейчас занимаемся...', '284', 'MS40', '0', '2', '', '04.10.2012', 'reply_all'), ('72', '5', '1', '9', '1334016000', null, 'предложить директору по продажам выяснить у других клиентов - так ли это у всех, если да, то выносить на общее обсуждение с участием наших ИТ-ков', '285', 'MS52', '0', '2', '', '04.10.2012', 'reply_all'), ('73', '5', '1', '2', '1334016000', null, 'Раиса Романовна\n\nПрикрепляю мой план на завтра. Завтра я должен уйти в 16.00, как я уже говорил вам ранее.\n\nС уважением,\nФедоров А.', '211', 'MS53', '0', '2', '', '04.10.2012', ''), ('74', '5', '1', '39', '1334016000', null, 'Коллеги, вам нужно пройти вакцинацию в понедельник. Запланируйте в своих календарях, пожалуйста.\n\nС уваженим,\nФедоров А.\n', '310', 'MS65', '0', '2', '', '04.10.2012', ''), ('75', '5', '1', '15', '1334016000', null, 'Аркадий, приветствую!\n\nОтчет сделаем. Данные будут у тебя завтра во второй половине дня.\n\nУдачи,\nФедоров А.', '312', 'MS66', '0', '2', '', '04.10.2012', ''), ('76', '5', '1', '3', '1334016000', null, 'Сергей, \n\nвключи это задание в свой план работ, пожалуйста. Тебе необходимо выгрузить складской остаток в регионе С на 01 число каждого месяца с января по октябрь этого года. \n\nПрошу выполнить задание до двух дня, чтобы я мог его посмотреть перед отправкой. \n\nСпасибо,\nФедоров А.', '237', 'MS67', '0', '2', '', '04.10.2012', ''), ('77', '5', '1', '20', '1334016000', null, 'Добрый день, Виктор Петрович!\n\nОчень рад, что вы нашли аналитика!\n\nНепременно помогу вам с его обучением и адаптацией. Завтра с четрех я в отпуске, а потому, запланирую разговор с ним на первые дни недели после отпуска. ', '314', 'MS62', '0', '2', '', '04.10.2012', ''), ('78', '5', '1', '13', '1334016000', null, 'Хорошо, лови.', '292', 'MS63', '0', '2', '', '04.10.2012', ''), ('79', '5', '1', '23', '1334016000', null, 'Да, сделайте. Подтверждаю.', '318', 'MS64', '0', '2', '', '04.10.2012', ''), ('80', '5', '1', '12', '1334016000', null, 'Адрес ниже.', '275', 'MS60', '0', '2', '', '04.10.2012', ''), ('81', '5', '1', '22', '1334016000', null, 'Привет, Юра! Сегодня и завтра, к сожалению, не могу. Давай запланируем после отпуска.', '316', 'MS61', '0', '2', '', '04.10.2012', ''), ('82', '5', '1', '4', '1334016000', null, 'Марина,\n\nБосс сегодня встречаться не смог, а завтра он на выезде. Потому прошу тебя встретиться с ним в понедельник в 10.00 для пояснений по презентации. Презентацию ему я уже отправил.\n\nНе волнуйся, я уверен, что ты справишься.\n\nСпасибо,\nФедоров А.', '245', 'MS68', '0', '2', '', '04.10.2012', ''), ('83', '5', '1', '12', '1334016000', null, 'Егор, во вложении моя версия квартального плана.\n\nС уважениям,\nФедоров А.', '492', 'MS69', '0', '2', '', '04.10.2012', ''), ('84', '5', '1', '3', '1334016000', null, 'Сергей,\n\nты сделал ошибку в отчете для Правления, а я ее проустил. Опять получил сегодня выговор от Денежной. Исправь немедленно и пришли мне новую версию отчета.\n\nФедоров А.', '236', 'MS70', '0', '2', '', '04.10.2012', ''), ('85', '5', '1', '13', '1334016000', null, 'B1', '808', 'MS71', null, '2', null, null, ''), ('86', '5', '1', '8', '1334016000', null, 'B1', '817', 'MS72', null, '2', null, null, ''), ('87', '5', '1', '10', '1334016000', null, 'B1', '792', 'MS73', null, '2', null, null, ''), ('88', '5', '1', '4', '1334016000', null, 'B1', '457', 'MS74', null, '2', null, null, ''), ('89', '5', '1', '12', '1334016000', null, 'B1', '875', 'MS75', null, '2', null, null, ''), ('90', '5', '1', '12', '1334016000', null, 'B1', '274', 'MS76', null, '2', null, null, ''), ('91', '5', '1', '3', '1334016000', null, 'B1', '876', 'MS77', null, '2', null, null, ''), ('92', '5', '1', '3', '1334016000', null, 'B1', '877', 'MS78', null, '2', null, null, ''), ('93', '5', '1', '25', '1334016000', null, 'B1', '786', 'MS79', null, '2', null, null, ''), ('94', '5', '1', '11', '1334016000', null, 'B1', '804', 'MS80', null, '2', null, null, ''), ('95', '5', '1', '4', '1334016000', null, 'Марина! \nПрочти сообщение ниже и срочно подготовь служебку на получение денег для сервера на имя Денежной. \n\nС уважением,\nФедоров А.\n\n', '326', 'MS81', null, '2', null, null, ''), ('96', '5', '1', '4', '1334016000', null, 'Марина,\n\nпрошу тебя найти последнюю итоговую версию бюджета производства на 01 год и переслать ее Начальнику производственного отдела  Василию Бобру. Поставь меня в копию, пожалуйста.\n\nС уважением,\nФедоров А.', '253', 'MS82', null, '2', null, null, '');

                SET FOREIGN_KEY_CHECKS = 1;";
            $connection->createCommand($mail_template)->execute();
            $transaction->commit();
        }
        catch(Exception $e)
        {
            echo "Exception: ".$e->getMessage()."\n";
            $transaction->rollback();
            return false;
        }
	}
}