if(!Array.prototype.indexOf){
Array.prototype.indexOf=function(_1){
var _2=this.length;
var _3=Number(arguments[1])||0;
_3=(_3<0)?Math.ceil(_3):Math.floor(_3);
if(_3<0){
_3+=_2;
}
for(;_3<_2;_3++){
if(_3 in this&&this[_3]===_1){
return _3;
}
}
return -1;
};
}
if(!this.JSON){
this.JSON={};
}
(function(){
function f(n){
return n<10?"0"+n:n;
}
if(typeof Date.prototype.toJSON!=="function"){
Date.prototype.toJSON=function(_5){
return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null;
};
String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(_6){
return this.valueOf();
};
}
var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,_8=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,_9,_a,_b={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\"":"\\\"","\\":"\\\\"},_c;
function quote(_d){
_8.lastIndex=0;
return _8.test(_d)?"\""+_d.replace(_8,function(a){
var c=_b[a];
return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);
})+"\"":"\""+_d+"\"";
}
function str(key,_11){
var i,k,v,_15,_16=_9,_17,_18=_11[key];
if(_18&&typeof _18==="object"&&typeof _18.toJSON==="function"){
_18=_18.toJSON(key);
}
if(typeof _c==="function"){
_18=_c.call(_11,key,_18);
}
switch(typeof _18){
case "string":
return quote(_18);
case "number":
return isFinite(_18)?String(_18):"null";
case "boolean":
case "null":
return String(_18);
case "object":
if(!_18){
return "null";
}
_9+=_a;
_17=[];
if(Object.prototype.toString.apply(_18)==="[object Array]"){
_15=_18.length;
for(i=0;i<_15;i+=1){
_17[i]=str(i,_18)||"null";
}
v=_17.length===0?"[]":_9?"[\n"+_9+_17.join(",\n"+_9)+"\n"+_16+"]":"["+_17.join(",")+"]";
_9=_16;
return v;
}
if(_c&&typeof _c==="object"){
_15=_c.length;
for(i=0;i<_15;i+=1){
k=_c[i];
if(typeof k==="string"){
v=str(k,_18);
if(v){
_17.push(quote(k)+(_9?": ":":")+v);
}
}
}
}else{
for(k in _18){
if(Object.hasOwnProperty.call(_18,k)){
v=str(k,_18);
if(v){
_17.push(quote(k)+(_9?": ":":")+v);
}
}
}
}
v=_17.length===0?"{}":_9?"{\n"+_9+_17.join(",\n"+_9)+"\n"+_16+"}":"{"+_17.join(",")+"}";
_9=_16;
return v;
}
}
if(typeof JSON.stringify!=="function"){
JSON.stringify=function(_19,_1a,_1b){
var i;
_9="";
_a="";
if(typeof _1b==="number"){
for(i=0;i<_1b;i+=1){
_a+=" ";
}
}else{
if(typeof _1b==="string"){
_a=_1b;
}
}
_c=_1a;
if(_1a&&typeof _1a!=="function"&&(typeof _1a!=="object"||typeof _1a.length!=="number")){
throw new Error("JSON.stringify");
}
return str("",{"":_19});
};
}
if(typeof JSON.parse!=="function"){
JSON.parse=function(_1d,_1e){
var j;
function walk(_20,key){
var k,v,_24=_20[key];
if(_24&&typeof _24==="object"){
for(k in _24){
if(Object.hasOwnProperty.call(_24,k)){
v=walk(_24,k);
if(v!==undefined){
_24[k]=v;
}else{
delete _24[k];
}
}
}
}
return _1e.call(_20,key,_24);
}
_1d=String(_1d);
cx.lastIndex=0;
if(cx.test(_1d)){
_1d=_1d.replace(cx,function(a){
return "\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);
});
}
if(/^[\],:{}\s]*$/.test(_1d.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){
j=eval("("+_1d+")");
return typeof _1e==="function"?walk({"":j},""):j;
}
throw new SyntaxError("JSON.parse");
};
}
}());
var is_gecko=/gecko/i.test(navigator.userAgent);
var is_ie=/MSIE/.test(navigator.userAgent);
function setSelectionRange(_26,_27,end){
if(is_gecko){
_26.setSelectionRange(_27,end);
}else{
var _29=_26.createTextRange();
_29.collapse(true);
_29.moveStart("character",_27);
_29.moveEnd("character",end-_27);
_29.select();
}
}
function getSelectionStart(_2a){
if(is_gecko){
return _2a.selectionStart;
}
var _2b=document.selection.createRange();
var _2c=_2b.compareEndPoints("StartToEnd",_2b)==0;
if(!_2c){
_2b.collapse(true);
}
var b=_2b.getBookmark();
return b.charCodeAt(2)-2;
}
function getSelectionEnd(_2e){
if(is_gecko){
return _2e.selectionEnd;
}
var _2f=document.selection.createRange();
var _30=_2f.compareEndPoints("StartToEnd",_2f)==0;
if(!_30){
_2f.collapse(false);
}
var b=_2f.getBookmark();
return b.charCodeAt(2)-2;
}
var browser_ie=false;
var browser_ie6=false;
var browser_nn4=false;
var browser_nn6=false;
var browser_opera=false;
var browser_safari=false;
var browser_ff3=false;
var browser_chrome=false;
var web_kit=false;
var os_windows=false;
var os_linux=false;
var os_mac=false;
var browser_firefox=false;
if(document.all&&window.navigator.userAgent.toUpperCase().indexOf("IE")>=0){
browser_ie=true;
if(window.navigator.appVersion.indexOf("6.0")>-1){
browser_ie6=true;
}
}else{
if(document.layers){
browser_nn4=true;
}else{
if(document.layers||(!document.all&&document.getElementById)){
browser_nn6=true;
}
}
}
if(window.navigator.userAgent.toUpperCase().indexOf("OPERA")>=0){
browser_opera=true;
browser_nn6=true;
}
if(window.navigator.userAgent.toUpperCase().indexOf("APPLEWEBKIT")>=0){
web_kit=true;
}
if(window.navigator.userAgent.toUpperCase().indexOf("SAFARI")>=0){
browser_safari=true;
}
if(window.navigator.userAgent.toUpperCase().indexOf("CHROME")>=0){
browser_chrome=true;
}
if(window.navigator.userAgent.toUpperCase().indexOf("FIREFOX/3")>=0){
browser_ff3=true;
}
if(window.navigator.platform.toUpperCase().indexOf("WIN")>=0){
os_windows=true;
}
if(window.navigator.platform.toUpperCase().indexOf("LINUX")>=0){
os_linux=true;
}
if(window.navigator.platform.toUpperCase().indexOf("MAC")>=0){
os_mac=true;
}
if(window.navigator.userAgent.toUpperCase().indexOf("FIREFOX/3")>=0){
browser_ff3=true;
}
if(window.navigator.userAgent.toUpperCase().indexOf("FIREFOX")!=-1){
browser_firefox=true;
}
function findPosX(obj){
var _33=0;
if(document.getElementById||document.all){
try{
while(obj.offsetParent){
_33+=obj.offsetLeft;
obj=obj.offsetParent;
}
}
catch(e){
return _33;
}
}else{
if(document.layers){
_33+=obj.x;
}
}
return _33;
}
function findPosY(obj){
var _35=0;
if(document.getElementById||document.all){
try{
while(obj.offsetParent){
_35+=obj.offsetTop;
obj=obj.offsetParent;
}
}
catch(e){
return _35;
}
}else{
if(document.layers){
_35+=obj.y;
}
}
return _35;
}
function findDocDim(){
if(browser_ie){
return {width:document.documentElement.offsetWidth+document.body.scrollLeft,height:document.documentElement.offsetHeight+document.body.scrollTop};
}else{
if(browser_nn4||browser_nn6){
return {width:window.innerWidth+document.body.scrollLeft,height:window.innerHeight+document.body.scrollTop};
}
}
}
function findClientDim(){
if(browser_ie){
var _36=document.documentElement.clientWidth;
var _37=document.documentElement.offsetHeight;
}else{
if(browser_nn4||browser_nn6){
var _36=window.innerWidth;
var _37=window.innerHeight;
}
}
return {width:_36,height:_37};
}
function getCursorPos(ev){
if(browser_ie){
var x=window.event.clientX+document.documentElement.scrollLeft;
var y=window.event.clientY+document.documentElement.scrollTop;
}else{
if(browser_nn6){
var x=ev.pageX;
var y=ev.pageY;
}
}
return {x:x,y:y};
}
var scrX=0,scrY=0,pgeX=0,pgeY=0,srcElement;
if(browser_ie){
document.attachEvent("onclick",popUpListener);
}else{
if(browser_nn4||browser_nn6){
document.addEventListener("click",popUpListener,true);
}
}
function popUpListener(e){
if(browser_ie){
srcElement=window.event.srcElement;
}else{
if(browser_nn4||browser_nn6){
srcElement=e.target;
scrX=e.screenX;
scrY=e.screenY;
pgeX=e.pageX;
pgeY=e.pageY;
}
}
}
function getObj(n,d){
if(!d){
d=document;
}
return d.getElementById(n);
}
function getXmlhttp(){
if(window.XMLHttpRequest){
var _3e=new XMLHttpRequest();
}else{
try{
var _3e=new ActiveXObject("Microsoft.XMLHTTP");
}
catch(ee){
try{
var _3e=new ActiveXObject("Microsoft.XMLDOM");
}
catch(e){
var _3e=new ActiveXObject("Msxml2.XMLHTTP");
}
}
}
return _3e;
}
function getXMLHttpRequest(){
var _3f=false;
try{
_3f=new ActiveXObject("Msxml2.XMLHTTP");
}
catch(e){
try{
_3f=new ActiveXObject("Microsoft.XMLHTTP");
}
catch(E){
_3f=false;
}
}
if(!_3f&&typeof XMLHttpRequest!="undefined"){
_3f=new XMLHttpRequest();
}
return _3f;
}
function clearTextSelection(){
if(!READ_WRITE){
return;
}
if(window.getSelection){
window.getSelection().removeAllRanges();
}else{
if(document.getSelection){
var s=document.getSelection();
if(s.collapse){
s.collapse(true);
}
if(s.removeAllRanges){
s.removeAllRanges();
}
}else{
if(document.selection){
if(document.selection.type!="Text"){
document.selection.empty();
}else{
document.selection.clear();
}
}
}
}
}
String.prototype.trim=function(){
var x=this;
x=x.replace(/^\s*(.*)/,"$1");
x=x.replace(/(.*?)\s*$/,"$1");
return x;
};
String.prototype.Ltrim=function(){
var x=this;
x=x.replace(/^\s*(.*)/,"$1");
return x;
};
String.prototype.Rtrim=function(){
var x=this;
x=x.replace(/(.*?)\s*$/,"$1");
return x;
};
if(!document.all){
function getOuterHTML(_44){
var str="";
var _46=["IMG","HR","BR","INPUT"];
switch(_44.nodeType){
case 1:
str+="<"+_44.nodeName;
for(var i=0;i<_44.attributes.length;i++){
if(_44.attributes.item(i).nodeValue!=null){
str+=" ";
str+=_44.attributes.item(i).nodeName;
str+="=\"";
str+=_44.attributes.item(i).nodeValue;
str+="\"";
}
}
if(_44.childNodes.length==0&&_46.indexOf(_44.nodeName)>0){
str+=">";
}else{
str+=">";
str+=_44.innerHTML;
str+="</"+_44.nodeName+">";
}
break;
case 3:
str+=_44.nodeValue;
break;
case 4:
str+="<![CDATA["+_44.nodeValue+"]]>";
break;
case 5:
str+="&"+_44.nodeName+";";
break;
case 8:
str+="<!--"+_44.nodeValue+"-->";
break;
}
return str;
}
}
function MM_openBrWindow(_48,_49,_4a){
if(document.all){
left=(screen.width/2)-200;
atop=(screen.height/2)-200;
var ft="width=400,height=360"+",left="+left+",top="+atop+",resizable=yes";
win=window.open(_48,_49,ft);
win.focus();
}else{
if(document.getElementById){
win=window.open(_48,_49,"width=400,height=360,resizable=yes");
win.focus();
win.moveTo((document.width/2)-235,(document.height/2)-130);
}
}
}
var scrollConst=0;
function isCapsLockOn(_4c,_4d){
return ((_4c>=65&&_4c<=90&&!_4d)||(_4c>=95&&_4c<=123&&_4d))?true:false;
}
function get_cookie(_4e){
var arg=_4e+"=";
var _50=arg.length;
var _51=document.cookie.length;
var i=0;
while(i<_51){
var j=i+_50;
if(document.cookie.substring(i,j)==arg){
return get_cookie_val(j);
}
i=document.cookie.indexOf(" ",i)+1;
if(i==0){
break;
}
}
return null;
}
function get_cookie_val(_54){
var _55=document.cookie.indexOf(";",_54);
if(_55==-1){
_55=document.cookie.length;
}
return unescape(document.cookie.substring(_54,_55));
}
function set_cookie(_56,_57){
var _58=set_cookie.arguments;
var _59=set_cookie.arguments.length;
var _5a=(_59>2)?_58[2]:null;
var _5b=(_59>3)?_58[3]:null;
var _5c=(_59>4)?_58[4]:null;
var _5d=(_59>5)?_58[5]:false;
document.cookie=_56+"="+escape(_57)+((_5a==null)?"":("; expires="+_5a.toGMTString()))+((_5b==null)?"":("; path="+_5b))+((_5c==null)?"":("; domain="+_5c))+((_5d==true)?"; secure":"");
}
function del_cookie(_5e){
var exp=new Date();
exp.setTime(exp.getTime()-1);
var _60=get_cookie(_5e);
document.cookie=_5e+"="+_60+"; expires="+exp.toGMTString();
}
function getCaretPos(_61){
var txt=_61.value;
var len=txt.length;
var pos=-1;
if((typeof document.selection!="undefined")&&(!browser_opera)){
var _65=document.selection.createRange();
if(_61.tagName.toUpperCase()!="INPUT"){
var _66=_65.duplicate();
_66.moveToElementText(_61);
_66.setEndPoint("EndToEnd",_65);
_61.selectionStart=_66.text.length-_65.text.length;
_61.selectionEnd=_61.selectionStart+_65.text.length;
pos=_61.selectionStart;
}else{
if(_61.tagName.toUpperCase()=="INPUT"){
pos=getFormInputCaretPos(_61,_65);
}
}
}else{
if(typeof _61.selectionStart!="undefined"){
pos=_61.selectionStart;
}
}
return pos;
}
function getCaretPosByLine(_67){
var txt=_67.value;
var len=txt.length;
var erg=txt.split("\n");
var pos=-1;
if(typeof document.selection!="undefined"&&!browser_opera){
range_sel=document.selection.createRange();
range_obj=_67.createTextRange();
range_obj.moveToBookmark(range_sel.getBookmark());
range_obj.moveEnd("character",_67.value.length);
pos=len-range_obj.text.length;
}else{
if(browser_opera||typeof _67.selectionStart!="undefined"){
pos=_67.selectionStart;
}
}
if(pos!=-1){
var ind=0;
for(ind;erg.length;ind++){
len=erg[ind].length+1;
if(pos<len){
break;
}
pos-=len;
}
ind++;
pos++;
return [ind,pos];
}
}
function setCaretPos(_6d,pos){
if(_6d.style.display=="none"||_6d.disabled||_6d.style.visibility=="hidden"){
return false;
}
_6d.focus();
if(!isNaN(pos)){
setSelectionRange(_6d,pos,pos);
}else{
if(pos=="START"){
setSelectionRange(_6d,0,0);
}else{
if(pos=="END"){
setSelectionRange(_6d,_6d.value.length,_6d.value.length);
}
}
}
}
function getSelectedText(el){
if(is_ie&&!browser_opera){
if(document.selection){
var _70=document.selection.createRange();
if(el.tagName=="TEXTAREA"){
var _71=_70.duplicate();
_71.moveToElementText(el);
_71.setEndPoint("EndToEnd",_70);
el.selectionStart=_71.text.length-_70.text.length;
el.selectionEnd=el.selectionStart+_70.text.length;
}else{
if(el.tagName.toUpperCase()=="INPUT"){
el.selectionStart=getFormInputCaretPos(el,_70);
el.selectionEnd=getSelectionEnd(el,_70);
}
}
}
return el.value.substring(el.selectionStart,el.selectionEnd);
}else{
return el.value.substring(getSelectionStart(el),getSelectionEnd(el));
}
}
function selectText(_72,_73,end){
_72.focus();
setSelectionRange(_72,_73,end);
}
function insertText(_75,val){
var _77=getCaretPos(_75);
var _78=_75.value.substring(0,getSelectionStart(_75));
var _79=_75.value.substr(getSelectionEnd(_75),_75.value.length);
_75.value=_78+val+_79;
setCaretPos(_75,(_77+val.length));
return _77;
}
function getText(el,_7b,end){
return el.value.substr(_7b,end);
}
function getTextByLine(_7d,_7e,_7f,end){
var txt=_7d.value;
var len=txt.length;
var erg=txt.split("\n");
if(erg[_7e-1]){
return erg[_7e-1].substr(_7f,end);
}else{
return "";
}
}
function getCurrentStyle(el,_85){
if(browser_ie){
if(el&&el.currentStyle){
return el.currentStyle[_85];
}
}else{
if(browser_nn6){
return document.defaultView.getComputedStyle(el,"")[_85];
}
}
}
function getCurrentStyles(el){
if(browser_ie||browser_opera){
return el.currentStyle;
}else{
if(browser_nn6){
return document.defaultView.getComputedStyle(el,"");
}
}
}
function getSelectionStart(_87){
var txt=_87.value;
var len=txt.length;
var _8a=-1;
if(typeof document.selection!="undefined"&&!browser_opera){
var _8b=document.selection.createRange();
if(_87.tagName.toUpperCase()!="INPUT"){
var _8c=_8b.duplicate();
_8c.moveToElementText(_87);
_8c.setEndPoint("EndToEnd",_8b);
_87.selectionStart=_8c.text.length-_8b.text.length;
_87.selectionEnd=_87.selectionStart+_8b.text.length;
_8a=_87.selectionStart;
}else{
_8a=getFormInputCaretPos(_87,_8b);
}
}else{
if(typeof _87.selectionStart!="undefined"){
_8a=_87.selectionStart;
}
}
return _8a;
}
function getSelectionEnd(_8d){
var _8e=-1;
if(typeof document.selection!="undefined"&&!browser_opera){
_8e=getSelectionStart(_8d)+document.selection.createRange().text.length;
}else{
if(typeof _8d.selectionStart!="undefined"){
_8e=_8d.selectionEnd;
}
}
return _8e;
}
function getFormInputCaretPos(_8f,_90){
var pos,_92,_93;
if(_8f.tagName.toUpperCase()=="INPUT"){
_92=_90.compareEndPoints("StartToEnd",_90)==0;
if(!_92){
_90.collapse(true);
}
_93=_90.getBookmark();
pos=_93.charCodeAt(2)-2;
return pos;
}
}
function LightenColor(_94,_95){
var r,g,b,txt;
r=parseInt(_94.substr(1,2),16),g=parseInt(_94.substr(3,2),16),b=parseInt(_94.substr(5,2),16),r+=_95;
if(r>255){
r=255;
}
if(r<0){
r=0;
}
g+=_95;
if(g>255){
g=255;
}
if(g<0){
g=0;
}
b+=_95;
if(b>255){
b=255;
}
if(b<0){
b=0;
}
txt=b.toString(16);
if(txt.length<2){
txt="0"+txt;
}
txt=g.toString(16)+txt;
if(txt.length<4){
txt="0"+txt;
}
txt=r.toString(16)+txt;
if(txt.length<6){
txt="0"+txt;
}
return "#"+txt.toUpperCase();
}
function DarkenColor(_9a,_9b){
return LightenColor(_9a,_9b*-1);
}
function isChild(_9c,_9d){
try{
if(_9c==_9d){
return false;
}
while(_9c.parentNode!=_9d){
if(_9c.parentNode==document.body){
return false;
}else{
_9c=_9c.parentNode;
}
}
return true;
}
catch(e){
return false;
}
}
function escapeSpecialChar(_9e){
var _9f=arguments[1];
_9e=encodeURIComponent(escape(_9e));
if(_9f!="no"){
if(arguments[0].indexOf(".")!=-1){
_9e=_9e.replace(/\./g,"\\.");
}
if(arguments[0].indexOf("*")!=-1){
_9e=_9e.replace(/\*/g,"\\*");
}
if(arguments[0].indexOf("_")!=-1){
_9e=_9e.replace(/\_/g,"\\_");
}
if(arguments[0].indexOf("-")!=-1){
_9e=_9e.replace(/\-/g,"\\-");
}
}
return _9e;
}
function unescapeSpecialChar(_a0){
var _a1=arguments[1];
if(_a1!="no"){
if(arguments[0].indexOf(".")!=-1){
_a0=_a0.replace(/\\\./g,".");
}
if(arguments[0].indexOf("*")!=-1){
_a0=_a0.replace(/\\\*/g,"*");
}
if(arguments[0].indexOf("_")!=-1){
_a0=_a0.replace(/\\\_/g,"_");
}
if(arguments[0].indexOf("-")!=-1){
_a0=_a0.replace(/\\\-/g,"-");
}
}
_a0=unescape(decodeURIComponent(_a0));
return _a0;
}
function setSelectionRange(_a2,_a3,end){
try{
if(_a2.setSelectionRange){
_a2.setSelectionRange(_a3,end);
}else{
if(_a2.createTextRange){
var _a5=_a2.createTextRange();
_a5.collapse(true);
if(_a3!=end){
_a5.moveEnd("character",end);
_a5.moveStart("character",_a3);
}else{
_a5.moveStart("character",_a3);
}
_a5.select();
}
}
}
catch(e){
}
}
function getCountOfOccrnceOfCharInStr(_a6,_a7){
return (_a6.split(_a7).length-1);
}
getMaxLengthOfAnElemInAnArr=function(arr){
var _a9=0;
var _aa=0;
for(_aa in arr){
_a9=(arr[_aa].length>_a9)?arr[_aa].length:_a9;
}
return _a9;
};
function stopEvt(ev){
if(!ev){
var ev=window.event;
}
if(browser_ie){
window.event.cancelBubble=true;
ev.returnValue=false;
}else{
if(browser_nn6){
ev.stopPropagation();
ev.preventDefault();
}
}
return false;
}
function disableKeys(ev){
if(typeof ev!="undefined"){
if((ev.keyCode==79)||(ev.keyCode==70)||(ev.keyCode==80)){
ev.keyCode=0;
return false;
}
}
}
function matchString(str,_ae){
var _af=[];
if(isNaN(str)&&(new RegExp("[a-z].*","gi")).exec(str)!=null){
str=escapeSpecialChar(str);
var len=_ae.length;
for(var _b1=0;_b1<len;_b1++){
var tmp=escapeSpecialChar(_ae[_b1],"no");
var re=new RegExp("^"+str+".*?","gi");
var m=re.exec(tmp);
if(m&&m.index==0){
_af[_af.length]=unescapeSpecialChar(tmp);
}
}
}
return _af;
}
function isCaretPosAtEnd(_b5){
return (_b5.value.length==getSelectionEnd(_b5))?true:false;
}
function isTextSelected(_b6){
return (getSelectedText(_b6).length>0)?true:false;
}
function restrictTextSelection(el){
el.onselectstart=new Function("return false");
(browser_ie)?el.attachEvent("onmousedown",function(){
el.onmousedown=new Function("return false");
}):el.addEventListener("mousedown",function(){
el.onmousedown=new Function("return false");
},false);
}
function resumeTextSelection(el){
el.onselectstart=new Function("return true");
}
function isNumber(obj){
return (typeof (obj)=="number")?true:false;
}
function isObject(obj){
return (typeof (obj)=="object")?true:false;
}
function isStr(obj){
return (typeof (obj)=="string")?true:false;
}
function isBoolean(obj){
return (typeof (obj)=="boolean")?true:false;
}
function isDialogHidden(){
if(dialogHidden==true){
return true;
}else{
return false;
}
}
function isDIV(el){
return (isObject(el)&&(el.tagName=="DIV"))?true:false;
}
function getChildNodes(el){
if(browser_ie){
return ((el)?el.childNodes:null);
}else{
if(browser_nn6){
return ((el)?el.childNodes:null);
}
}
}
function getChildNode(el,idx){
if(browser_ie){
return ((el&&el.childNodes[idx]!=null)?el.childNodes[idx]:null);
}else{
if(browser_nn6){
return ((el&&el.childNodes.item(idx)!=null)?el.childNodes.item(idx):null);
}
}
}
function getChildItem(_c1,i){
if(browser_ie){
return _c1[i];
}else{
if(browser_nn6){
return _c1.item(i);
}
}
}
function findIndex(el){
if(el&&!isUndefined(el.parentNode)&&el.parentNode!=null){
var _c4=el.parentNode.childNodes;
var _c5=-1;
for(var i=0,len=_c4.length;i<len;i++){
if(_c4[i]==el){
_c5=i;
break;
}
}
return _c5;
}else{
return 0;
}
}
function getChildNodesLength(el){
if(browser_ie){
return el.children.length;
}else{
if(browser_nn6){
return el.childNodes.length;
}
}
}
function isUndefined(o){
return typeof o==="undefined";
}
function isElement(o){
return (o&&o.tagName)?true:false;
}
function isArray(o){
return Object.prototype.toString.call(o)==="[object Array]";
}
function convertNumber(num){
if(isNumber(num)){
return num;
}else{
var str=parseInt(num);
if(isNaN(str)){
return num;
}else{
return str;
}
}
}
function getPrintableCharacterKeyCodes(){
return [8,32,46,48,49,50,51,52,53,54,55,56,57,59,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,107,109,188,190,191,192,219,220,221,222];
}
Array.prototype.contains=function(obj,_cf){
var i=this.length;
if(typeof _cf=="undefined"){
while(i--){
if(this[i]==obj){
return true;
}
}
}else{
while(i--){
if(this[i][_cf]==obj[_cf]){
return true;
}
}
}
return false;
};
function parseJSON(_d1){
if(window.JSON){
return JSON.parse(_d1);
}else{
return eval("("+_d1+")");
}
}
String.prototype.toBoolean=function(){
return "true"==this;
};
function isString(o){
return typeof o==="string";
}
ArrayUtils={getSortedIndex:function(_d3,_d4,_d5){
var _d6=_d3.length,mid=-1,low=_d5||0;
while(low<_d6){
mid=(low+_d6)>>1;
(_d3[mid]<_d4)?low=mid+1:_d6=mid;
}
return low;
},indexOf:function(_d9,_da,_db){
var len=_d9.length;
var idx=this.getSortedIndex(_d9,_da,_db);
return (_d9[idx]===_da)?idx:-1;
},slice:function(ary,_df,_e0){
var _e1=ary.length;
_df=(_df>0)?_df:0;
_e0=(_df<0||_e0>=_e1)?_e1:_e0;
try{
return Array.prototype.slice.call(ary,_df,_e0);
}
catch(e){
var _e2=[];
for(var i=_df;i<_e0;i++){
_e2.push(ary[i]);
}
return _e2;
}
}};
function unique(_e4){
var _e5=[];
label:
for(var i=0,len=_e4.length;i<len;i++){
for(var j=0,_e9=_e5.length;j<_e9;j++){
if(_e5[j]==_e4[i]){
continue label;
}
}
_e5[_e5.length]=_e4[i];
}
return _e5;
}
function escapeSpecialCharacters(_ea){
return _ea.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;");
}
if(!Array.prototype.indexOf){
Array.prototype.indexOf=function(_eb,_ec){
var k=_ec||0;
for(;k<len;k++){
if(k in t&&t[k]===_eb){
return k;
}
}
return -1;
};
}
function showElements(_ee,_ef,_f0){
if(isUndefined(_ef)){
for(var i=0;i<_ee.length;i++){
if($("#"+_ee[i]).is(":hidden")&&_f0){
$("#"+_ee[i]).show();
}else{
$("#"+_ee[i]).show();
}
}
}else{
for(var i=0;i<_ee.length;i++){
if($("#"+_ee[i]).is(":hidden")&&_f0){
$("#"+_ef).zbutton("show","#"+_ee[i]);
}else{
$("#"+_ef).zbutton("show","#"+_ee[i]);
}
}
}
}
function hideElements(_f2,_f3,_f4){
if(isUndefined(_f3)){
for(var i=0;i<_f2.length;i++){
if($("#"+_f2[i]).is(":visible")&&_f4){
$("#"+_f2[i]).hide();
}else{
$("#"+_f2[i]).hide();
}
}
}else{
for(var i=0;i<_f2.length;i++){
if(!$("#"+_f2[i]).is(":hidden")&&_f4){
$("#"+_f3).zbutton("hide","#"+_f2[i]);
}else{
$("#"+_f3).zbutton("hide","#"+_f2[i]);
}
}
}
}
function CenterItem(_f6){
var _f7=$(window).width();
var _f8=$(window).height();
var _f9=_f7/2;
var _fa=$(_f6).width()/2;
var _fb=_f9-_fa;
var _fc=_f8/2;
var _fd=$(_f6).height()/2;
var _fe=_fc-_fd;
if(_f7>$(_f6).width()){
$(_f6).css("left",_fb);
}else{
$(_f6).css("left","0");
}
if(_f8>$(_f6).height()){
$(_f6).css("top",_fe);
}else{
$(_f6).css("top","0");
}
$("#_DIALOG_LAYER").draggable({containment:"parent"});
}
function positionDialog(){
if(pivotSheet){
return;
}
CenterItem($("#_DIALOG_LAYER"));
if($("#FreezeLayer").length>0){
$("#FreezeLayer").css("z-index",1000);
if(browser_ie){
$("#_DIALOG_LAYER").css("z-index",100000);
}else{
$("#_DIALOG_LAYER").css("z-index",9999);
}
}
if($(window).width()!=$(window).width()){
if($(".ui-dialog").filter(":visible")||dialogOpened){
$(".ui-icon-closethick").click();
}
}
if($("#conditionalDialogContent").is(":visible")){
$("#_DIALOG_LAYER .closeButton").bind("click",function(){
$.sheetdialog.closeOpenedDialog();
});
}
$("#_DIALOG_CONTENT").draggable({start:function(_ff,ui){
_ff.stopPropagation();
return false;
}});
}
function rgb2hex(rgb){
rgb=rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
return "#"+("0"+parseInt(rgb[1],10).toString(16)).slice(-2)+("0"+parseInt(rgb[2],10).toString(16)).slice(-2)+("0"+parseInt(rgb[3],10).toString(16)).slice(-2);
}
function addSTDMode(_102){
if(isNaN){
_102=_102+"";
}
if(_102.indexOf("px")==-1){
_102=_102.concat("px");
}
return _102;
}
function getOnlyNumber(text){
var _104=text.replace(/[^0-9]/gi,"");
return _104;
}
var IETRIDIENTVERSION=10000;
function getIeTridentVersion(){
if(browser_ie){
var _105=10000;
var uA=navigator.userAgent;
var reg=/Trident\/[0-9]\.[0-9]/g;
if(reg.test){
var _108=[];
_108=uA.match(reg);
var str=_108[0];
var num=/[0-9]\.[0-9]/g;
if(num.test(str)){
_105=str.match(num)[0];
IETRIDIENTVERSION=parseFloat(_105);
}
}
}
return IETRIDIENTVERSION;
}
var featureSupport={boxAlign:false,checkForBoxAlign:function(){
return typeof document.body.style.webkitBoxAlign=="string";
}};
window.performance=window.performance||{};
performance.now=(function(){
return performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||function(){
return new Date().getTime();
};
})();
var nativeGetElementsByClassName=document.getElementsByClassName;
var csrfParamName="csrfParam";
var csrfToken="";
function sendXMLHTTPRequest(_10b,_10c,_10d,_10e,path,_110,_111){
if(_10d){
var _112,_113;
if(_110){
_112=parent.csrfParamName;
_113=parent.csrfToken;
}else{
if(_111){
_112=opener.csrfParamName;
_113=opener.csrfToken;
}else{
_112=csrfParamName;
_113=csrfToken;
}
}
if(typeof _10c!="undefined"){
if(_10c.lastIndexOf("&")==_10c.length-1){
_10c+=_112+"="+_113;
}else{
_10c+="&"+_112+"="+_113;
}
}else{
_10c=_112+"="+_113;
}
}
if(_10e&&typeof path!="undefined"){
if(_110){
parent.postAjax(_10b,path,_10c);
}else{
if(_111){
opener.postAjax(_10b,path,_10c);
}else{
postAjax(_10b,path,_10c);
}
}
}else{
_10b.send(_10c);
}
}
function appendCSRFToURL(url){
if(typeof url!="undefined"){
if(url.lastIndexOf("&")==url.length-1){
url+=csrfParamName+"="+csrfToken;
}else{
url+="&"+csrfParamName+"="+csrfToken;
}
}else{
url=csrfParamName+"="+csrfToken;
}
return url;
}
var isSaveToMyAccountCalled=false;
function callIamDialog(_115,_116,_117,_118){
if(jsPUBLIC_VIEW&&PUBLIC_EDIT_MODE){
isSaveToMyAccountCalled=true;
_115+=encodeURIComponent("&currenttime="+CURRENTTIME+"&savechanges=true");
}
if(typeof _117=="undefined"&&_117==""){
_117="100%";
}
if(!_116){
_116="";
}else{
_116="split="+_116+"&";
}
if(typeof _118=="undefined"){
_118="";
}
if(!_119){
var _119="/";
}
showURLInDialog(_119+"copysignin.jsp?"+_116+"src="+_115,"position=absmiddle,modal=yes,title="+_118);
return false;
}
function publicSaveToMyAccount(_11a){
if(jsPUBLIC_VIEW&&PUBLIC_EDIT_MODE){
isSaveToMyAccountCalled=true;
_11a+="&currenttime="+CURRENTTIME+"&savechanges=true";
}
location.href=_11a;
}
var USER_DETAILS={IS_ORG_USER:false};
var DOC_DETEAILS={IS_DOC_OWNER:false};
var GRID_DETAILS={CURRCELL_HAS_COMMENT:undefined};
var WIDGET={BOLD:undefined,ITALIC:undefined,UNDERLINE:undefined,STRIKE:undefined,WRAP:undefined,PERCENT:undefined,HALIGNMENU:undefined,VALIGNMENU:undefined,PERCENT:undefined};
var TABS={FORMAT:undefined,INSERT:undefined,VIEW:undefined,MACROS:undefined,SHARE:undefined,REVIEW:undefined};
var TOOLBARS={FORMAT:undefined,REVIEW:undefined};
var isExportEvent=false;
var ie=false;
var DOCUMENT_ID="doc_id";
var COLLAB_DOCUMENT_ID="";
var DOCUMENTSHEET_ID="docsheet_id";
var DOCUMENTSHEET_NAME="docsheet_name";
var DOCUMENT_VIEW="NEW_VIEW";
var COLOR_DIV_ID="bg_fill_div";
var DOCUMENT_NAME="";
var DOC_NAME="";
var NEWDOCNAME="";
var DEFAULT_FILENAME_FLAG=false;
var jsNEW_DOC_VIEW=false;
var jsOPEN_DOC_VIEW=false;
var jsSHARE_VIEW=false;
var jsTRASH_VIEW=false;
var jsGUEST_VIEW=false;
var jsPUBLIC_VIEW=false;
var jsEMBED_VIEW=false;
var ISAPP_READONLYMODE=false;
var jsTHROWAWAY_VIEW=false;
var jsGADGET_VIEW=false;
var jsREMOTE_VIEW=false;
var jsVERSION_VIEW=false;
var jsREMOTE_SAVE_VIEW=false;
var DOCUMENT_LOCKED=false;
var READ_WRITE=false;
var IPHONE_VIEW=false;
var isDocumentPublic=false;
var isDocumentSemiPublic=false;
var SAVED=true;
var OOLOADED=true;
var ENTEREDPERFCHECK=false;
var CANREADWRITE=true;
var ACCOUNT_ID=0;
var AUTO_SAVED=null;
var SERVERPORT="";
var SERVERNAME="";
var SERVERSCHEME="";
var TAGLIST="";
var TOTALSHEETS=0;
var CURRSHEETINDEX=0;
var SAVEPARAM="";
var ISPRINTDIALOGOPENED=false;
var IMAGE_PATH="";
var LOCKED_USER="";
var SAVECHART="false";
var IMPORTDOC="IMPORTDOC";
var ERRORIMPORT=false;
var CURRENTTIME="CURRENTTIME";
var IMPORTACC="0";
var IMPORTTIME="IMPORTTIME";
var LOGINNAME="";
var isEdit=false;
var ENABLECACHE=true;
var ENABLERTC=true;
var HTMLVIEW=false;
var HTMLCHARTINFO=new Array();
var DELETEHTML=false;
var STYLE_PATH="";
var USE_COMPRESSION="";
var BUILD_VERSION="";
var ssServer="";
var initSSWidth="";
var initSSHeight="";
var initColHeadHeight="";
var initRowHeadWidth="";
var initCols="";
var initRows="";
var initColWidth="";
var initRowHeight="";
var defCellStyleStr="";
var defCellStyle="";
var defCellFormat="";
var defCellHolderProp="";
var tablewidth="";
var tableheight="";
var bridgeNumber="-1";
var saveForward="";
var commentCnt=0;
var guestId="";
var versionDetailsNo=0;
var IS_UNSAVED_SHEET=false;
var IS_REVERT_ALLOWED=false;
var ALL_SHEET_SHARED=false;
var isSheetBasedShare=false;
var DOCUMENT_VERSION="";
var isRegistered=true;
var selectedFolderId="0";
var isVersionPending=false;
var cursor_Row_Index=0;
var cursor_Col_Index=0;
var position_Bottom=0;
var position_Left=0;
if(document.all){
ie=true;
}
var jsREMOTE_VIEW_SAVE_CALLED=false;
var isRangeDialog=false;
var CURR_DOC_OWNERNAME="";
var isPublished=false;
var commentString="";
var isRangeEdit=false;
var SHAREDUSERS="";
var NOTIFY="false";
var COLLAB_ID="";
var ISSAMESHEET="true";
var RTCSHEETNAME="";
var SAVEDOC="false";
var C_STARTROW="";
var C_ENDROW="";
var C_STARTCOL="";
var C_ENDCOL="";
var RTC_DOCID="";
var RTC_DOCNAME="";
var RTC_EXISTS="false";
var COLLABORATIVE_EDITING="OFF";
var SHAREDUSERSLIST=new Array();
var ISCOLLAB="false";
var CURRENTUSER="";
var documentOpened="false";
var LISTOFCOLLABIDS="";
var BACKUPCOLLABID="";
var DONTNOTIFY=false;
var INSERTIMAGE=false;
var IMAGEOBJECT=null;
var XPOSITION=null;
var YPOSITION=null;
var UPDATEIMAGEINOO=true;
var oFCKeditorforDoc=null;
var oFCKeditorforSheet=null;
var doAutoSave=false;
var usedCursCol=0;
var usedCursRow=0;
var publicURL="";
var sbWidth=200;
var MKIMODE=false;
var NOPDF=false;
var USERCURRENCY;
var CURRENCYSYMBOLS=["$","&#x20AC;","&#xA3;","&#xA5;","Rs","&#xFFE5;"];
var savedFlag=true;
var DO_INDEX_SEARCH=false;
var DOCUMENT_NAME_URL="";
var BACKGROUNDCOLOR="";
var FONTCOLOR="";
var sbDocId="";
var CURR_THEME="";
var DEFAULT_THEME="";
var wholeValAsStringInArrFormt="";
var defineNameHTML="";
var isNameDialogOpened=false;
var currentNamesListSPAN="";
var NAMEDRANGES=new Array();
var ASSIGNEDTO="";
var NAMESELECTEDBYUSER=false;
var FOCUSSEDNAMEINPUTOBJECT="";
var SHEETSWITCH=false;
var isExprFieldExpanded=false;
var H_SCROLLBAR_HEIGHT;
var V_SCROLLBAR_WIDTH;
var MACROSAVED=true;
var ISMINDLG=false;
var ISMACRODOCCHANGE=false;
var RECORDINGMACRO=false;
var MACRO_DOC_SAVED=true;
var PARENTVIEW_ID;
var PIVOT_TYPE;
var isdbserver=false;
var hidepivotWarningBanner="hide";
var readFromEngine=false;
var TOP="";
var zoid=-1;
var zuid=-1;
var publicPolicy="onlyOrg";
var SHARE_DOCUMENT_EXTERNALLY=false;
var EXPORT_DOCUMENT=false;
var PUBLISH_DOCUMENT=false;
var ACCEPT_SHARING_FROM_NONORGUSERS=false;
var orgName="";
var orgDisplayName="";
var isDocumentPublicOrg=false;
var isDocumentSemiPublicOrg=false;
var CLONEIMAGE=false;
var ISGEEDITOR=false;
var RMUSER="";
var USERSTATEID="";
var GE_SAVED;
var colorcodes=["6BA125","076CB0","FC7A0A","F3CC03","D70005","5E8C5E","476FB3","CFA012","DF4620","5D39A5"];
var colorcodeidx=0;
var usercolorcode=new Array();
var usercell=new Array();
var userpresencediv=new Array();
var userpresencediv_sub=new Array();
var userpremission=new Array();
var userpresenceintvl;
var displayAll=false;
var SET_LASTEDITED_DOCID=false;
var TEMPLATE_FLAG="";
var isTemplatePublic=false;
var filenameFieldId="";
var CREATE_TEMPLATE_FROM_UI="";
var CREATE_TEMPLATE_FROM_MENU="";
var isEngineSupported=false;
var WIDTHHEIGHTUNDO=false;
var VBAEDITORMODULENAME="";
var VBAEDITORLINENO="";
var VBAEDITORMODULETYPE="";
var VBAEDITORSHOW="";
var isPivotDialogOpen=false;
var isEditPivotDialogOpen=false;
var allowOrgEdit=false;
var allowExport=true;
var showFormulas=true;
var allowExportOrg=true;
var showFormulasOrg=true;
var showPublic=true;
var pubType="";
var allowExportPublic=true;
var poweredByObjHt=0;
var isEditorClosed;
var ROWS_PER_TILE=8;
var TWO_TILES_COUNT=2*ROWS_PER_TILE;
var ARROW_HEIGHT_IN_SCROLLBAR=16;
var ARROW_WIDTH_IN_SCROLLBAR=16;
var cellDefaultHeight=17;
var cellDefaultWidth=80;
var SCROLL_PER_MOUSEWHEEL=40;
var isRespondedInScroll=true;
var FILE_FORMAT;
var showErrorPanelMsg="ShowErrorPanel";
var parseError=false;
var countryArray=new Array();
fromOpenFreeze=false;
var PUBLIC_EDIT_MODE=false;
var LOAD_OBJECT_IN_PUBLIC=false;
var CONTAINSMACRO=false;
var HASDRAWCONTROL=false;
var HAS_FILTERS=false;
var isInOOMode=false;
var tempPublicDocId="";
var HASCONDITIONALFORMAT=false;
var showPrevMessage;
var PREVIOUS_MESSAGE="";
var remoteAPIParam="";
var wmsCommErrorStatus="";
var wmsErrorMsgShown=false;
var isAnyOnline=false;
var DISABLECHAT=false;
var editedFormulaCellInfo={"isOtherSheet":false,"cellFieldDetails":{}};
var importId=null;
var CONTACT_SERVER_URL="";
var INTERNAL_VIEW=false;
var serviceDocId;
var servicePushFormat;
var serviceDocVersion;
var isDocContainsArrayFormula=false;
var remoteUserDocId="";
var hasOleMoved=false;
var isUnRegisteredUser;
var userEmail;
var isPublicEditDoc=false;
var isPublicViewDoc=false;
var isReadOnlyViewMode=false;
var ruleElem=null;
var colorElem=null;
var cfinputElem=null;
var cfinputVal=null;
var isConditionalDialogOpen=false;
var toolbarinited=false;
var saveDocBeforeFreeze=false;
var Row={};
var hiddenRowInfo=[];
var hiddenRowStartIdxAry=[];
var hiddenRowEndIdxAry=[];
var indexedHiddenRowAry=[];
var rowsInPage=[];
var isCopiedRowRangeHasFilteredRows=false;
var isDevelopmentMode=false;
var isCollabJoined=false;
var responseWaitingTime;
var FILEDIALOG;
var isConfirmation=true;
var isCoOwnerSharedDoc=false;
var fromGoTo=false;
var isPrintMessageShown=false;
var isFMenuOpened=false;
var UI={fontNamesCSSClassMap:{"Arial":"fnal","Arial Black":"fnab","Book Antiqua":"fnba","Calibri":"fnci","Comic Sans MS":"fncs","Courier New":"fncn","Garamond":"fngd","Georgia":"fnga","Lucida Console":"fnlc","MingLiU":"fnml","MS Gothic":"fnmg","MS PGothic":"fnmpg","MS Mincho":"fnmm","MS P Mincho":"fnmpm","MS Sans Serif":"fnms","SimHei":"fnsh","Tahoma":"fnta","Times New Roman":"fntn","Trebuchet MS":"fntms","Verdana":"fnva","FangSong_GB2312":"fnfs","KaiTi_GB2312":"fnkt","LiSu":"fnls","SimSun":"fnss","NSimSun":"fnnss","YouYuan":"fnyy","Simsun (Founder Extended)":"fnssfe","FZShuTi":"fnfzst","FZYaoti":"fnfzy","STFangsong":"fnstf","STHupo":"fnsth","STKaiti":"fnstk","STLiti":"fnstl","STSong":"fnsts","STXinwei":"fnstxw","STXihei":"fnstxh","STXingkai":"fnstxk","STZhongsong":"fnstz","Microsoft YaHei":"fnmyh","STCaiyun":"fnstc","GIST-TMOTChanakya":"fntc","GIST-TMOTIlango":"fnti","GIST-TMOTPattinathar":"fntptn","GIST-TMOTPadma":"fntp","GIST-TMOTKrishnan":"fntk","TSC_Kannadaasan":"fntka","Anjal":"fna","Impact":"fnit","Andale Mono":"fnam","Palatino Linotype":"fnpl","Symbol":"fnsl","Webdings":"fnws","Wingdings 2":"fnws2","Wingdings 3":"fnws3"},CSSClassFontNamesMap:{"fnal":"Arial","fnab":"Arial Black","fnba":"Book Antiqua","fnci":"Calibri","fncs":"Comic Sans MS","fncn":"Courier New","fngd":"Garamond","fnga":"Georgia","fnlc":"Lucida Console","fnml":"MingLiU","fnmg":"MS Gothic","fnmpg":"MS PGothic","fnmm":"MS Mincho","fnmpm":"MS P Mincho","fnms":"MS Sans Serif","fnsh":"SimHei","fnta":"Tahoma","fntn":"Times New Roman","fntms":"Trebuchet MS","fnva":"Verdana","fnfs":"FangSong_GB2312","fnkt":"KaiTi_GB2312","fnls":"LiSu","fnss":"SimSun","fnnss":"NSimSun","fnyy":"YouYuan","fnssfe":"Simsun (Founder Extended)","fnfzst":"FZShuTi","fnfzy":"FZYaoti","fnstf":"STFangsong","fnsth":"STHupo","fnstk":"STKaiti","fnstl":"STLiti","fnsts":"STSong","fnstxw":"STXinwei","fnstxh":"STXihei","fnstxk":"STXingkai","fnstz":"STZhongsong","fnmyh":"Microsoft YaHei","fnstc":"STCaiyun","fntc":"GIST-TMOTChanakya","fnti":"GIST-TMOTIlango","fntptn":"GIST-TMOTPattinathar","fntp":"GIST-TMOTPadma","fntk":"GIST-TMOTKrishnan","fntka":"TSC_Kannadaasan","fna":"Anjal","fnit":"Impact","fnam":"Andale Mono","fnpl":"Palatino Linotype","fnsl":"Symbol","fnws":"Webdings","fnws2":"Wingdings 2","fnws3":"Wingdings 3"}};
var rq=new Array();
function handleOthersLoad(){
for(var i=0;i<rq.length;i++){
if(rq[i]&&window.frames["_I_M_F_R_"+i]){
setTimeout(rq[i]+"(window.frames._I_M_F_R_"+i+".window.document)",1000);
rq[i]=false;
loadoff();
}
}
}
function postAjax(_11c,url,nvp){
_11c.open("POST",url,true);
_11c.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");
_11c.setRequestHeader("Content-length",nvp.length);
_11c.send(nvp);
}
function handleOthers(u,f){
if(document.cellform){
document.cellform.view.value=getObj("VIEW").value;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
}
var _121=document.createElement("DIV");
fcs=_121.style;
fcs.visibility="hidden";
fcs.position="absolute";
fcs.top="0px";
fcs.left="0px";
rt=rq.length;
_121.innerHTML="<iframe src=\""+u+"\" name=\"_I_M_F_R_"+rt+"\" height=\"0\" width=\"0\"></iframe>";
rq[rq.length]=f;
document.body.appendChild(_121);
window.setTimeout("handleOthersLoad()",100);
return true;
}
function handleIE(u,f,_124,_125,_126,nvp,_128){
if(document.cellform){
document.cellform.view.value=getObj("VIEW").value;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
}
var _129=null;
try{
if(_129==null){
try{
_129=new ActiveXObject("Msxml2.XMLHTTP");
}
catch(e){
}
}
if(_129==null){
try{
_129=new ActiveXObject("Microsoft.XMLHTTP");
}
catch(e){
throw new Exception("Browser not supported");
}
}
rt=rq.length;
var _12a;
_12a=rt;
rq[_12a]=_129;
var _12b=document.cellform.actionMode.value.toUpperCase();
rq[_12a].onreadystatechange=function(){
if(rq[_12a].readyState==4){
if(!_128&&u.indexOf("version.do")==-1&&_12b!="COPYTOCLIP"){
noOfUpdateRequestInProgress--;
}
if(rq[_12a].responseText=="Error"){
showAlertDialog(jsTitleMsg.ErrorOccurred);
}else{
var _12c=rq[_12a];
if(_128){
f(rq[_12a].responseText,rq[_12a].status,rq[_12a].statusText,"",_12a);
}else{
if(rq[_12a].responseXML){
_12c=rq[_12a].responseXML;
}
if(isObject(_124)){
f(_12c,rq[_12a].status,rq[_12a].statusText,_12b,_12a);
}else{
f(_12c,rq[_12a].status,rq[_12a].statusText,"",_12a);
}
}
}
if(noOfUpdateRequestInProgress==0){
loadoff();
}
}
};
if(isObject(_124)){
var cn=_124.elements;
var nvp="";
for(i=0;i<cn.length;i++){
try{
nvp+=cn.item(i).name+"="+cn.item(i).value+"&";
}
catch(e){
showAlertDialog(e);
}
}
document.cellform.cellValue.value="";
document.cellform.textAreaValue.value="";
if(_125){
nvp=appendCSRFToURL(nvp);
}
nvp=nvp.replace(/\+/g,"%2B");
nvp=encodeURI(nvp);
u+=((u.indexOf("?")+1)?"&":"?");
rq[rt].open("POST",u,true);
rq[rt].setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");
rq[rt].setRequestHeader("Content-length",nvp.length);
rq[rt].send(nvp);
}else{
if(_126=="POST"){
if(_125){
nvp=appendCSRFToURL(nvp);
}
nvp=nvp.replace(/\+/g,"%2B");
nvp=encodeURI(nvp);
rq[rt].open("POST",u,true);
rq[rt].setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");
rq[rt].setRequestHeader("Content-length",nvp.length);
rq[rt].send(nvp);
}else{
rq[rt].load(u);
}
}
return true;
}
catch(e){
showAlertDialog(e);
}
}
function handleNS(u,f,_130,_131,_132,nvp,_134){
if(_134){
}
if(document.cellform){
document.cellform.view.value=getObj("VIEW").value;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
}
rt=rq.length;
var _135;
_135=rt;
rq[_135]=new XMLHttpRequest();
var _136="";
if(document.cellform){
_136=document.cellform.actionMode.value.toUpperCase();
}
if(!_134&&u.indexOf("version.do")==-1&&_136!="COPYTOCLIP"){
setResponseWaitingTime();
}
rq[_135].onreadystatechange=function(){
if(rq[_135].readyState==4){
if(!_134&&u.indexOf("version.do")==-1&&_136!="COPYTOCLIP"){
noOfUpdateRequestInProgress--;
}
var frm=document.cellform;
if(frm&&u.indexOf(frm.action)!=-1){
if(f==updateCell){
gridListener.listen(0);
}else{
if(f==formatCell){
gridListener.listen(1);
}
}
}
if(rq[_135].responseText=="Error"){
showAlertDialog(jsTitleMsg.ErrorOccurred);
}else{
if(_134){
f(rq[_135].responseText,rq[_135].status,rq[_135].statusText,"",_135);
}else{
if(intAutoSuggestion){
var _138=parseJSON(rq[_135].responseText);
updateJson(_138);
}
if(isObject(_130)){
f(rq[_135].responseXML,rq[_135].status,rq[_135].statusText,_136,_135);
}else{
f(rq[_135].responseXML,rq[_135].status,rq[_135].statusText,"",_135);
}
}
}
if(noOfUpdateRequestInProgress==0){
clearResponseWaitingTime();
}
}
};
if(isObject(_130)){
var cn=_130.elements;
var nvp="";
for(i=0;i<cn.length;i++){
try{
nvp+=cn.item(i).name+"="+cn.item(i).value+"&";
}
catch(e){
showAlertDialog(e);
}
}
document.cellform.cellValue.value="";
document.cellform.textAreaValue.value="";
if(_131){
nvp=appendCSRFToURL(nvp);
}
nvp=nvp.replace(/\+/g,"%2B");
nvp=encodeURI(nvp);
rq[rt].open("POST",u,true);
rq[rt].setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
rq[rt].setRequestHeader("Content-length",nvp.length);
rq[rt].send(nvp);
}else{
if(_132=="POST"){
if(_131){
nvp=appendCSRFToURL(nvp);
}
nvp=nvp.replace(/\+/g,"%2B");
nvp=encodeURI(nvp);
rq[rt].open("POST",u,true);
rq[rt].setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
rq[rt].setRequestHeader("Content-length",nvp.length);
rq[rt].send(nvp);
}else{
rq[rt].open("GET",u,true);
rq[rt].setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
rq[rt].send(null);
}
}
return true;
}
function importxml(url,_13b,_13c,_13d,nvp,_13f){
return handleRequest(url,_13b,"",_13c,_13d,nvp,"",_13f);
}
function handleRequest(rurl,_141,_142,_143,_144,nvp,_146,_147){
var _148="";
if(document.cellform){
_148=document.cellform.actionMode.value.toUpperCase();
}
var _149=document.cellform.afterRTC.value;
if(!(_149)&&document.cellform===_142&&_148!="COPYFORMAT"&&_148!="CALLBACK"){
exitFormatPainter();
}
if(!_146&&rurl.indexOf("version.do")==-1&&_148!="COPYTOCLIP"){
if(_147!="false"){
if(isCellRange()){
loadon();
}else{
if(_148=="COPYPASTE"||_148=="CUTPASTE"||_148=="COPYPASTETEXTAREA"){
loadon();
}
}
}
noOfUpdateRequestInProgress++;
}
rurl+=((rurl.indexOf("?")+1)?"&":"?")+"randomNo="+Math.random();
if(window.XMLHttpRequest){
return handleNS(rurl,_141,_142,_143,_144,nvp,_146);
}
if(!navigator.__ice_version&&window.ActiveXObject){
return handleIE(rurl,_141,_142,_143,_144,nvp,_146);
}
if(document.createElement&&document.childNodes){
return handleOthers(rurl,_141);
}
return false;
}
function importxmlForForm(_14a,_14b,_14c,_14d){
document.cellform.currentSelection.value=getCurrentSelection();
return handleRequest(_14a.action,_14b,_14a,_14c,"POST","",_14d);
}
function loadoff(){
hideProgressMessage();
}
function loadon(){
getObj("loading").style.display="block";
showPrevMessage=true;
PREVIOUS_MESSAGE=getObj("loading").innerHTML;
}
function replace(_14e,text,by){
var _151=_14e.length,_152=text.length;
if((_151==0)||(_152==0)){
return _14e;
}
var i=_14e.indexOf(text);
if((!i)&&(text!=_14e.substring(0,_152))){
return _14e;
}
if(i==-1){
return _14e;
}
var _154=_14e.substring(0,i)+by;
if(i+_152<_151){
_154+=replace(_14e.substring(i+_152,_151),text,by);
}
return _154;
}
function replaceSplChrs(text){
return text.replace(/&quot;/g,"\"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&amp;/g,"&");
}
function revertSplChrs(text){
return text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;");
}
function doit(text,_158){
text=text.replace(/\%/g,"%25");
text=text.replace(/\!/g,"%21");
text=text.replace(/\"/g,"%22");
text=text.replace(/\#/g,"%23");
text=text.replace(/\$/g,"%24");
text=text.replace(/\&/g,"%26");
text=text.replace(/\(/g,"%28");
text=text.replace(/\)/g,"%29");
text=text.replace(/\*/g,"%2A");
text=text.replace(/\+/g,"%2B");
text=text.replace(/\,/g,"%2C");
text=text.replace(/\-/g,"%2D");
text=text.replace(/\./g,"%2E");
text=text.replace(/\//g,"%2F");
text=text.replace(/\:/g,"%3A");
text=text.replace(/\;/g,"%3B");
text=text.replace(/\</g,"%3C");
text=text.replace(/\=/g,"%3D");
text=text.replace(/\>/g,"%3E");
text=text.replace(/\?/g,"%3F");
text=text.replace(/\@/g,"%40");
text=text.replace(/\[/g,"%5B");
text=text.replace(/\\/g,"%5C");
text=text.replace(/\]/g,"%5D");
text=text.replace(/\^/g,"%5E");
text=text.replace(/\_/g,"%5F");
text=text.replace(/\`/g,"%60");
text=text.replace(/\{/g,"%7B");
text=text.replace(/\|/g,"%7C");
text=text.replace(/\}/g,"%7D");
text=text.replace(/\~/g,"%7E");
if(_158){
text=replace(text,"\n","%0A");
}
return text;
}
var FadeInterval=200;
var StartFadeAt=7;
var fadeelemsarr=null;
var FadeSteps=new Array();
FadeSteps[1]="ff";
FadeSteps[2]="ee";
FadeSteps[3]="dd";
FadeSteps[4]="cc";
FadeSteps[5]="bb";
FadeSteps[6]="aa";
FadeSteps[7]="99";
var bgColors=new Array();
function DoFade(elem,_15a){
var _15b=new Array(1);
_15b[0]=elem;
DoFades(_15b,_15a);
}
function DoFades(_15c,_15d){
fadeelemsarr=_15c;
setColors();
fadeaway(_15d);
}
function setColors(){
for(i=0;i<fadeelemsarr.length;i++){
if(fadeelemsarr[i]){
var _15e=fadeelemsarr[i].style.backgroundColor;
if(_15e==null||_15e==""){
_15e="rgb(255,255,255)";
}
bgColors[i]=_15e;
}
}
}
function fadeaway(_15f){
if(_15f==null){
_15f=StartFadeAt;
}
if(_15f>=1){
for(i=0;i<fadeelemsarr.length;i++){
elem=fadeelemsarr[i];
if(elem){
elem.style.backgroundColor=getColor(bgColors[i])+FadeSteps[_15f];
if(_15f==1){
elem.style.backgroundColor="";
if(bgColors[i]!="rgb(255,255,255)"){
elem.style.backgroundColor=bgColors[i];
}
}
}
}
_15f--;
setTimeout("fadeaway("+_15f+")",FadeInterval);
}
}
function getColor(colr){
if(colr==""){
return;
}
var ret="";
var _162="#";
if(colr.indexOf("#")==-1){
var _163=colr.substring(colr.indexOf("(")+1,colr.indexOf(")"));
var _164=_163.split(",");
_162+=d2h(_164[0].trim());
_162+=d2h(_164[1].trim());
_162+=d2h(_164[2].trim());
ret=_162.substring(0,_162.length-2);
}else{
ret=colr.substring(0,colr.length-2);
}
return ret;
}
(function(_165,_166){
var _167=_165.document,_168=_165.navigator,_169=_165.location;
var _16a=(function(){
var _16b=function(_16c,_16d){
return new _16b.fn.init(_16c,_16d,_16e);
},_16f=_165.jQuery,_$=_165.$,_16e,_171=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,_172=/\S/,_173=/^\s+/,_174=/\s+$/,_175=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,_176=/^[\],:{}\s]*$/,_177=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,_178=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,_179=/(?:^|:|,)(?:\s*\[)+/g,_17a=/(webkit)[ \/]([\w.]+)/,_17b=/(opera)(?:.*version)?[ \/]([\w.]+)/,_17c=/(msie) ([\w.]+)/,_17d=/(mozilla)(?:.*? rv:([\w.]+))?/,_17e=/-([a-z]|[0-9])/ig,_17f=/^-ms-/,_180=function(all,_182){
return (_182+"").toUpperCase();
},_183=_168.userAgent,_184,_185,_186,_187=Object.prototype.toString,_188=Object.prototype.hasOwnProperty,push=Array.prototype.push,_18a=Array.prototype.slice,trim=String.prototype.trim,_18c=Array.prototype.indexOf,_18d={};
_16b.fn=_16b.prototype={constructor:_16b,init:function(_18e,_18f,_190){
var _191,elem,ret,doc;
if(!_18e){
return this;
}
if(_18e.nodeType){
this.context=this[0]=_18e;
this.length=1;
return this;
}
if(_18e==="body"&&!_18f&&_167.body){
this.context=_167;
this[0]=_167.body;
this.selector=_18e;
this.length=1;
return this;
}
if(typeof _18e==="string"){
if(_18e.charAt(0)==="<"&&_18e.charAt(_18e.length-1)===">"&&_18e.length>=3){
_191=[null,_18e,null];
}else{
_191=_171.exec(_18e);
}
if(_191&&(_191[1]||!_18f)){
if(_191[1]){
_18f=_18f instanceof _16b?_18f[0]:_18f;
doc=(_18f?_18f.ownerDocument||_18f:_167);
ret=_175.exec(_18e);
if(ret){
if(_16b.isPlainObject(_18f)){
_18e=[_167.createElement(ret[1])];
_16b.fn.attr.call(_18e,_18f,true);
}else{
_18e=[doc.createElement(ret[1])];
}
}else{
ret=_16b.buildFragment([_191[1]],[doc]);
_18e=(ret.cacheable?_16b.clone(ret.fragment):ret.fragment).childNodes;
}
return _16b.merge(this,_18e);
}else{
elem=_167.getElementById(_191[2]);
if(elem&&elem.parentNode){
if(elem.id!==_191[2]){
return _190.find(_18e);
}
this.length=1;
this[0]=elem;
}
this.context=_167;
this.selector=_18e;
return this;
}
}else{
if(!_18f||_18f.jquery){
return (_18f||_190).find(_18e);
}else{
return this.constructor(_18f).find(_18e);
}
}
}else{
if(_16b.isFunction(_18e)){
return _190.ready(_18e);
}
}
if(_18e.selector!==_166){
this.selector=_18e.selector;
this.context=_18e.context;
}
return _16b.makeArray(_18e,this);
},selector:"",jquery:"1.7.1",length:0,size:function(){
return this.length;
},toArray:function(){
return _18a.call(this,0);
},get:function(num){
return num==null?this.toArray():(num<0?this[this.length+num]:this[num]);
},pushStack:function(_196,name,_198){
var ret=this.constructor();
if(_16b.isArray(_196)){
push.apply(ret,_196);
}else{
_16b.merge(ret,_196);
}
ret.prevObject=this;
ret.context=this.context;
if(name==="find"){
ret.selector=this.selector+(this.selector?" ":"")+_198;
}else{
if(name){
ret.selector=this.selector+"."+name+"("+_198+")";
}
}
return ret;
},each:function(_19a,args){
return _16b.each(this,_19a,args);
},ready:function(fn){
_16b.bindReady();
_185.add(fn);
return this;
},eq:function(i){
i=+i;
return i===-1?this.slice(i):this.slice(i,i+1);
},first:function(){
return this.eq(0);
},last:function(){
return this.eq(-1);
},slice:function(){
return this.pushStack(_18a.apply(this,arguments),"slice",_18a.call(arguments).join(","));
},map:function(_19e){
return this.pushStack(_16b.map(this,function(elem,i){
return _19e.call(elem,i,elem);
}));
},end:function(){
return this.prevObject||this.constructor(null);
},push:push,sort:[].sort,splice:[].splice};
_16b.fn.init.prototype=_16b.fn;
_16b.extend=_16b.fn.extend=function(){
var _1a1,name,src,copy,_1a5,_1a6,_1a7=arguments[0]||{},i=1,_1a9=arguments.length,deep=false;
if(typeof _1a7==="boolean"){
deep=_1a7;
_1a7=arguments[1]||{};
i=2;
}
if(typeof _1a7!=="object"&&!_16b.isFunction(_1a7)){
_1a7={};
}
if(_1a9===i){
_1a7=this;
--i;
}
for(;i<_1a9;i++){
if((_1a1=arguments[i])!=null){
for(name in _1a1){
src=_1a7[name];
copy=_1a1[name];
if(_1a7===copy){
continue;
}
if(deep&&copy&&(_16b.isPlainObject(copy)||(_1a5=_16b.isArray(copy)))){
if(_1a5){
_1a5=false;
_1a6=src&&_16b.isArray(src)?src:[];
}else{
_1a6=src&&_16b.isPlainObject(src)?src:{};
}
_1a7[name]=_16b.extend(deep,_1a6,copy);
}else{
if(copy!==_166){
_1a7[name]=copy;
}
}
}
}
}
return _1a7;
};
_16b.extend({noConflict:function(deep){
if(_165.$===_16b){
_165.$=_$;
}
if(deep&&_165.jQuery===_16b){
_165.jQuery=_16f;
}
return _16b;
},isReady:false,readyWait:1,holdReady:function(hold){
if(hold){
_16b.readyWait++;
}else{
_16b.ready(true);
}
},ready:function(wait){
if((wait===true&&!--_16b.readyWait)||(wait!==true&&!_16b.isReady)){
if(!_167.body){
return setTimeout(_16b.ready,1);
}
_16b.isReady=true;
if(wait!==true&&--_16b.readyWait>0){
return;
}
_185.fireWith(_167,[_16b]);
if(_16b.fn.trigger){
_16b(_167).trigger("ready").off("ready");
}
}
},bindReady:function(){
if(_185){
return;
}
_185=_16b.Callbacks("once memory");
if(_167.readyState==="complete"){
return setTimeout(_16b.ready,1);
}
if(_167.addEventListener){
_167.addEventListener("DOMContentLoaded",_186,false);
_165.addEventListener("load",_16b.ready,false);
}else{
if(_167.attachEvent){
_167.attachEvent("onreadystatechange",_186);
_165.attachEvent("onload",_16b.ready);
var _1ae=false;
try{
_1ae=_165.frameElement==null;
}
catch(e){
}
if(_167.documentElement.doScroll&&_1ae){
doScrollCheck();
}
}
}
},isFunction:function(obj){
return _16b.type(obj)==="function";
},isArray:Array.isArray||function(obj){
return _16b.type(obj)==="array";
},isWindow:function(obj){
return obj&&typeof obj==="object"&&"setInterval" in obj;
},isNumeric:function(obj){
return !isNaN(parseFloat(obj))&&isFinite(obj);
},type:function(obj){
return obj==null?String(obj):_18d[_187.call(obj)]||"object";
},isPlainObject:function(obj){
if(!obj||_16b.type(obj)!=="object"||obj.nodeType||_16b.isWindow(obj)){
return false;
}
try{
if(obj.constructor&&!_188.call(obj,"constructor")&&!_188.call(obj.constructor.prototype,"isPrototypeOf")){
return false;
}
}
catch(e){
return false;
}
var key;
for(key in obj){
}
return key===_166||_188.call(obj,key);
},isEmptyObject:function(obj){
for(var name in obj){
return false;
}
return true;
},error:function(msg){
throw new Error(msg);
},parseJSON:function(data){
if(typeof data!=="string"||!data){
return null;
}
data=_16b.trim(data);
if(_165.JSON&&_165.JSON.parse){
return _165.JSON.parse(data);
}
if(_176.test(data.replace(_177,"@").replace(_178,"]").replace(_179,""))){
return (new Function("return "+data))();
}
_16b.error("Invalid JSON: "+data);
},parseXML:function(data){
var xml,tmp;
try{
if(_165.DOMParser){
tmp=new DOMParser();
xml=tmp.parseFromString(data,"text/xml");
}else{
xml=new ActiveXObject("Microsoft.XMLDOM");
xml.async="false";
xml.loadXML(data);
}
}
catch(e){
xml=_166;
}
if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){
_16b.error("Invalid XML: "+data);
}
return xml;
},noop:function(){
},globalEval:function(data){
if(data&&_172.test(data)){
(_165.execScript||function(data){
_165["eval"].call(_165,data);
})(data);
}
},camelCase:function(_1bf){
return _1bf.replace(_17f,"ms-").replace(_17e,_180);
},nodeName:function(elem,name){
return elem.nodeName&&elem.nodeName.toUpperCase()===name.toUpperCase();
},each:function(_1c2,_1c3,args){
var name,i=0,_1c7=_1c2.length,_1c8=_1c7===_166||_16b.isFunction(_1c2);
if(args){
if(_1c8){
for(name in _1c2){
if(_1c3.apply(_1c2[name],args)===false){
break;
}
}
}else{
for(;i<_1c7;){
if(_1c3.apply(_1c2[i++],args)===false){
break;
}
}
}
}else{
if(_1c8){
for(name in _1c2){
if(_1c3.call(_1c2[name],name,_1c2[name])===false){
break;
}
}
}else{
for(;i<_1c7;){
if(_1c3.call(_1c2[i],i,_1c2[i++])===false){
break;
}
}
}
}
return _1c2;
},trim:trim?function(text){
return text==null?"":trim.call(text);
}:function(text){
return text==null?"":text.toString().replace(_173,"").replace(_174,"");
},makeArray:function(_1cb,_1cc){
var ret=_1cc||[];
if(_1cb!=null){
var type=_16b.type(_1cb);
if(_1cb.length==null||type==="string"||type==="function"||type==="regexp"||_16b.isWindow(_1cb)){
push.call(ret,_1cb);
}else{
_16b.merge(ret,_1cb);
}
}
return ret;
},inArray:function(elem,_1d0,i){
var len;
if(_1d0){
if(_18c){
return _18c.call(_1d0,elem,i);
}
len=_1d0.length;
i=i?i<0?Math.max(0,len+i):i:0;
for(;i<len;i++){
if(i in _1d0&&_1d0[i]===elem){
return i;
}
}
}
return -1;
},merge:function(_1d3,_1d4){
var i=_1d3.length,j=0;
if(typeof _1d4.length==="number"){
for(var l=_1d4.length;j<l;j++){
_1d3[i++]=_1d4[j];
}
}else{
while(_1d4[j]!==_166){
_1d3[i++]=_1d4[j++];
}
}
_1d3.length=i;
return _1d3;
},grep:function(_1d8,_1d9,inv){
var ret=[],_1dc;
inv=!!inv;
for(var i=0,_1de=_1d8.length;i<_1de;i++){
_1dc=!!_1d9(_1d8[i],i);
if(inv!==_1dc){
ret.push(_1d8[i]);
}
}
return ret;
},map:function(_1df,_1e0,arg){
var _1e2,key,ret=[],i=0,_1e6=_1df.length,_1e7=_1df instanceof _16b||_1e6!==_166&&typeof _1e6==="number"&&((_1e6>0&&_1df[0]&&_1df[_1e6-1])||_1e6===0||_16b.isArray(_1df));
if(_1e7){
for(;i<_1e6;i++){
_1e2=_1e0(_1df[i],i,arg);
if(_1e2!=null){
ret[ret.length]=_1e2;
}
}
}else{
for(key in _1df){
_1e2=_1e0(_1df[key],key,arg);
if(_1e2!=null){
ret[ret.length]=_1e2;
}
}
}
return ret.concat.apply([],ret);
},guid:1,proxy:function(fn,_1e9){
if(typeof _1e9==="string"){
var tmp=fn[_1e9];
_1e9=fn;
fn=tmp;
}
if(!_16b.isFunction(fn)){
return _166;
}
var args=_18a.call(arguments,2),_1ec=function(){
return fn.apply(_1e9,args.concat(_18a.call(arguments)));
};
_1ec.guid=fn.guid=fn.guid||_1ec.guid||_16b.guid++;
return _1ec;
},access:function(_1ed,key,_1ef,exec,fn,pass){
var _1f3=_1ed.length;
if(typeof key==="object"){
for(var k in key){
_16b.access(_1ed,k,key[k],exec,fn,_1ef);
}
return _1ed;
}
if(_1ef!==_166){
exec=!pass&&exec&&_16b.isFunction(_1ef);
for(var i=0;i<_1f3;i++){
fn(_1ed[i],key,exec?_1ef.call(_1ed[i],i,fn(_1ed[i],key)):_1ef,pass);
}
return _1ed;
}
return _1f3?fn(_1ed[0],key):_166;
},now:function(){
return (new Date()).getTime();
},uaMatch:function(ua){
ua=ua.toLowerCase();
var _1f7=_17a.exec(ua)||_17b.exec(ua)||_17c.exec(ua)||ua.indexOf("compatible")<0&&_17d.exec(ua)||[];
return {browser:_1f7[1]||"",version:_1f7[2]||"0"};
},sub:function(){
function jQuerySub(_1f8,_1f9){
return new jQuerySub.fn.init(_1f8,_1f9);
}
_16b.extend(true,jQuerySub,this);
jQuerySub.superclass=this;
jQuerySub.fn=jQuerySub.prototype=this();
jQuerySub.fn.constructor=jQuerySub;
jQuerySub.sub=this.sub;
jQuerySub.fn.init=function init(_1fa,_1fb){
if(_1fb&&_1fb instanceof _16b&&!(_1fb instanceof jQuerySub)){
_1fb=jQuerySub(_1fb);
}
return _16b.fn.init.call(this,_1fa,_1fb,_1fc);
};
jQuerySub.fn.init.prototype=jQuerySub.fn;
var _1fc=jQuerySub(_167);
return jQuerySub;
},browser:{}});
_16b.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(i,name){
_18d["[object "+name+"]"]=name.toLowerCase();
});
_184=_16b.uaMatch(_183);
if(_184.browser){
_16b.browser[_184.browser]=true;
_16b.browser.version=_184.version;
}
if(_16b.browser.webkit){
_16b.browser.safari=true;
}
if(_172.test("\xa0")){
_173=/^[\s\xA0]+/;
_174=/[\s\xA0]+$/;
}
_16e=_16b(_167);
if(_167.addEventListener){
_186=function(){
_167.removeEventListener("DOMContentLoaded",_186,false);
_16b.ready();
};
}else{
if(_167.attachEvent){
_186=function(){
if(_167.readyState==="complete"){
_167.detachEvent("onreadystatechange",_186);
_16b.ready();
}
};
}
}
function doScrollCheck(){
if(_16b.isReady){
return;
}
try{
_167.documentElement.doScroll("left");
}
catch(e){
setTimeout(doScrollCheck,1);
return;
}
_16b.ready();
}
return _16b;
})();
var _1ff={};
function createFlags(_200){
var _201=_1ff[_200]={},i,_203;
_200=_200.split(/\s+/);
for(i=0,_203=_200.length;i<_203;i++){
_201[_200[i]]=true;
}
return _201;
}
_16a.Callbacks=function(_204){
_204=_204?(_1ff[_204]||createFlags(_204)):{};
var list=[],_206=[],_207,_208,_209,_20a,_20b,add=function(args){
var i,_20f,elem,type,_212;
for(i=0,_20f=args.length;i<_20f;i++){
elem=args[i];
type=_16a.type(elem);
if(type==="array"){
add(elem);
}else{
if(type==="function"){
if(!_204.unique||!self.has(elem)){
list.push(elem);
}
}
}
}
},fire=function(_215,args){
args=args||[];
_207=!_204.memory||[_215,args];
_208=true;
_20b=_209||0;
_209=0;
_20a=list.length;
for(;list&&_20b<_20a;_20b++){
if(list[_20b].apply(_215,args)===false&&_204.stopOnFalse){
_207=true;
break;
}
}
_208=false;
if(list){
if(!_204.once){
if(_206&&_206.length){
_207=_206.shift();
self.fireWith(_207[0],_207[1]);
}
}else{
if(_207===true){
self.disable();
}else{
list=[];
}
}
}
},self={add:function(){
if(list){
var _217=list.length;
add(arguments);
if(_208){
_20a=list.length;
}else{
if(_207&&_207!==true){
_209=_217;
fire(_207[0],_207[1]);
}
}
}
return this;
},remove:function(){
if(list){
var args=arguments,_219=0,_21a=args.length;
for(;_219<_21a;_219++){
for(var i=0;i<list.length;i++){
if(args[_219]===list[i]){
if(_208){
if(i<=_20a){
_20a--;
if(i<=_20b){
_20b--;
}
}
}
list.splice(i--,1);
if(_204.unique){
break;
}
}
}
}
}
return this;
},has:function(fn){
if(list){
var i=0,_21e=list.length;
for(;i<_21e;i++){
if(fn===list[i]){
return true;
}
}
}
return false;
},empty:function(){
list=[];
return this;
},disable:function(){
list=_206=_207=_166;
return this;
},disabled:function(){
return !list;
},lock:function(){
_206=_166;
if(!_207||_207===true){
self.disable();
}
return this;
},locked:function(){
return !_206;
},fireWith:function(_21f,args){
if(_206){
if(_208){
if(!_204.once){
_206.push([_21f,args]);
}
}else{
if(!(_204.once&&_207)){
fire(_21f,args);
}
}
}
return this;
},fire:function(){
self.fireWith(this,arguments);
return this;
},fired:function(){
return !!_207;
}};
return self;
};
var _221=[].slice;
_16a.extend({Deferred:function(func){
var _223=_16a.Callbacks("once memory"),_224=_16a.Callbacks("once memory"),_225=_16a.Callbacks("memory"),_226="pending",_227={resolve:_223,reject:_224,notify:_225},_228={done:_223.add,fail:_224.add,progress:_225.add,state:function(){
return _226;
},isResolved:_223.fired,isRejected:_224.fired,then:function(_229,_22a,_22b){
_22c.done(_229).fail(_22a).progress(_22b);
return this;
},always:function(){
_22c.done.apply(_22c,arguments).fail.apply(_22c,arguments);
return this;
},pipe:function(_22d,_22e,_22f){
return _16a.Deferred(function(_230){
_16a.each({done:[_22d,"resolve"],fail:[_22e,"reject"],progress:[_22f,"notify"]},function(_231,data){
var fn=data[0],_234=data[1],_235;
if(_16a.isFunction(fn)){
_22c[_231](function(){
_235=fn.apply(this,arguments);
if(_235&&_16a.isFunction(_235.promise)){
_235.promise().then(_230.resolve,_230.reject,_230.notify);
}else{
_230[_234+"With"](this===_22c?_230:this,[_235]);
}
});
}else{
_22c[_231](_230[_234]);
}
});
}).promise();
},promise:function(obj){
if(obj==null){
obj=_228;
}else{
for(var key in _228){
obj[key]=_228[key];
}
}
return obj;
}},_22c=_228.promise({}),key;
for(key in _227){
_22c[key]=_227[key].fire;
_22c[key+"With"]=_227[key].fireWith;
}
_22c.done(function(){
_226="resolved";
},_224.disable,_225.lock).fail(function(){
_226="rejected";
},_223.disable,_225.lock);
if(func){
func.call(_22c,_22c);
}
return _22c;
},when:function(_239){
var args=_221.call(arguments,0),i=0,_23c=args.length,_23d=new Array(_23c),_23e=_23c,_23f=_23c,_240=_23c<=1&&_239&&_16a.isFunction(_239.promise)?_239:_16a.Deferred(),_241=_240.promise();
function resolveFunc(i){
return function(_243){
args[i]=arguments.length>1?_221.call(arguments,0):_243;
if(!(--_23e)){
_240.resolveWith(_240,args);
}
};
}
function progressFunc(i){
return function(_245){
_23d[i]=arguments.length>1?_221.call(arguments,0):_245;
_240.notifyWith(_241,_23d);
};
}
if(_23c>1){
for(;i<_23c;i++){
if(args[i]&&args[i].promise&&_16a.isFunction(args[i].promise)){
args[i].promise().then(resolveFunc(i),_240.reject,progressFunc(i));
}else{
--_23e;
}
}
if(!_23e){
_240.resolveWith(_240,args);
}
}else{
if(_240!==_239){
_240.resolveWith(_240,_23c?[_239]:[]);
}
}
return _241;
}});
_16a.support=(function(){
var _246,all,a,_249,opt,_24b,_24c,_24d,tds,_24f,_250,i,_252,div=_167.createElement("div"),_254=_167.documentElement;
div.setAttribute("className","t");
div.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";
all=div.getElementsByTagName("*");
a=div.getElementsByTagName("a")[0];
if(!all||!all.length||!a){
return {};
}
_249=_167.createElement("select");
opt=_249.appendChild(_167.createElement("option"));
_24b=div.getElementsByTagName("input")[0];
_246={leadingWhitespace:(div.firstChild.nodeType===3),tbody:!div.getElementsByTagName("tbody").length,htmlSerialize:!!div.getElementsByTagName("link").length,style:/top/.test(a.getAttribute("style")),hrefNormalized:(a.getAttribute("href")==="/a"),opacity:/^0.55/.test(a.style.opacity),cssFloat:!!a.style.cssFloat,checkOn:(_24b.value==="on"),optSelected:opt.selected,getSetAttribute:div.className!=="t",enctype:!!_167.createElement("form").enctype,html5Clone:_167.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>",submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true};
_24b.checked=true;
_246.noCloneChecked=_24b.cloneNode(true).checked;
_249.disabled=true;
_246.optDisabled=!opt.disabled;
try{
delete div.test;
}
catch(e){
_246.deleteExpando=false;
}
if(!div.addEventListener&&div.attachEvent&&div.fireEvent){
div.attachEvent("onclick",function(){
_246.noCloneEvent=false;
});
div.cloneNode(true).fireEvent("onclick");
}
_24b=_167.createElement("input");
_24b.value="t";
_24b.setAttribute("type","radio");
_246.radioValue=_24b.value==="t";
_24b.setAttribute("checked","checked");
div.appendChild(_24b);
_24d=_167.createDocumentFragment();
_24d.appendChild(div.lastChild);
_246.checkClone=_24d.cloneNode(true).cloneNode(true).lastChild.checked;
_246.appendChecked=_24b.checked;
_24d.removeChild(_24b);
_24d.appendChild(div);
div.innerHTML="";
if(_165.getComputedStyle){
_24c=_167.createElement("div");
_24c.style.width="0";
_24c.style.marginRight="0";
div.style.width="2px";
div.appendChild(_24c);
_246.reliableMarginRight=(parseInt((_165.getComputedStyle(_24c,null)||{marginRight:0}).marginRight,10)||0)===0;
}
if(div.attachEvent){
for(i in {submit:1,change:1,focusin:1}){
_250="on"+i;
_252=(_250 in div);
if(!_252){
div.setAttribute(_250,"return;");
_252=(typeof div[_250]==="function");
}
_246[i+"Bubbles"]=_252;
}
}
_24d.removeChild(div);
_24d=_249=opt=_24c=div=_24b=null;
_16a(function(){
var _255,_256,_257,_258,td,_25a,_25b,ptlm,vb,_25e,html,body=_167.getElementsByTagName("body")[0];
if(!body){
return;
}
_25b=1;
ptlm="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;";
vb="visibility:hidden;border:0;";
_25e="style='"+ptlm+"border:5px solid #000;padding:0;'";
html="<div "+_25e+"><div></div></div>"+"<table "+_25e+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>";
_255=_167.createElement("div");
_255.style.cssText=vb+"width:0;height:0;position:static;top:0;margin-top:"+_25b+"px";
body.insertBefore(_255,body.firstChild);
div=_167.createElement("div");
_255.appendChild(div);
div.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";
tds=div.getElementsByTagName("td");
_252=(tds[0].offsetHeight===0);
tds[0].style.display="";
tds[1].style.display="none";
_246.reliableHiddenOffsets=_252&&(tds[0].offsetHeight===0);
div.innerHTML="";
div.style.width=div.style.paddingLeft="1px";
_16a.boxModel=_246.boxModel=div.offsetWidth===2;
if(typeof div.style.zoom!=="undefined"){
div.style.display="inline";
div.style.zoom=1;
_246.inlineBlockNeedsLayout=(div.offsetWidth===2);
div.style.display="";
div.innerHTML="<div style='width:4px;'></div>";
_246.shrinkWrapBlocks=(div.offsetWidth!==2);
}
div.style.cssText=ptlm+vb;
div.innerHTML=html;
_256=div.firstChild;
_257=_256.firstChild;
td=_256.nextSibling.firstChild.firstChild;
_25a={doesNotAddBorder:(_257.offsetTop!==5),doesAddBorderForTableAndCells:(td.offsetTop===5)};
_257.style.position="fixed";
_257.style.top="20px";
_25a.fixedPosition=(_257.offsetTop===20||_257.offsetTop===15);
_257.style.position=_257.style.top="";
_256.style.overflow="hidden";
_256.style.position="relative";
_25a.subtractsBorderForOverflowNotVisible=(_257.offsetTop===-5);
_25a.doesNotIncludeMarginInBodyOffset=(body.offsetTop!==_25b);
body.removeChild(_255);
div=_255=null;
_16a.extend(_246,_25a);
});
return _246;
})();
var _261=/^(?:\{.*\}|\[.*\])$/,_262=/([A-Z])/g;
_16a.extend({cache:{},uuid:0,expando:"jQuery"+(_16a.fn.jquery+Math.random()).replace(/\D/g,""),noData:{"embed":true,"object":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000","applet":true},hasData:function(elem){
elem=elem.nodeType?_16a.cache[elem[_16a.expando]]:elem[_16a.expando];
return !!elem&&!isEmptyDataObject(elem);
},data:function(elem,name,data,pvt){
if(!_16a.acceptData(elem)){
return;
}
var _268,_269,ret,_26b=_16a.expando,_26c=typeof name==="string",_26d=elem.nodeType,_26e=_26d?_16a.cache:elem,id=_26d?elem[_26b]:elem[_26b]&&_26b,_270=name==="events";
if((!id||!_26e[id]||(!_270&&!pvt&&!_26e[id].data))&&_26c&&data===_166){
return;
}
if(!id){
if(_26d){
elem[_26b]=id=++_16a.uuid;
}else{
id=_26b;
}
}
if(!_26e[id]){
_26e[id]={};
if(!_26d){
_26e[id].toJSON=_16a.noop;
}
}
if(typeof name==="object"||typeof name==="function"){
if(pvt){
_26e[id]=_16a.extend(_26e[id],name);
}else{
_26e[id].data=_16a.extend(_26e[id].data,name);
}
}
_268=_269=_26e[id];
if(!pvt){
if(!_269.data){
_269.data={};
}
_269=_269.data;
}
if(data!==_166){
_269[_16a.camelCase(name)]=data;
}
if(_270&&!_269[name]){
return _268.events;
}
if(_26c){
ret=_269[name];
if(ret==null){
ret=_269[_16a.camelCase(name)];
}
}else{
ret=_269;
}
return ret;
},removeData:function(elem,name,pvt){
if(!_16a.acceptData(elem)){
return;
}
var _274,i,l,_277=_16a.expando,_278=elem.nodeType,_279=_278?_16a.cache:elem,id=_278?elem[_277]:_277;
if(!_279[id]){
return;
}
if(name){
_274=pvt?_279[id]:_279[id].data;
if(_274){
if(!_16a.isArray(name)){
if(name in _274){
name=[name];
}else{
name=_16a.camelCase(name);
if(name in _274){
name=[name];
}else{
name=name.split(" ");
}
}
}
for(i=0,l=name.length;i<l;i++){
delete _274[name[i]];
}
if(!(pvt?isEmptyDataObject:_16a.isEmptyObject)(_274)){
return;
}
}
}
if(!pvt){
delete _279[id].data;
if(!isEmptyDataObject(_279[id])){
return;
}
}
if(_16a.support.deleteExpando||!_279.setInterval){
delete _279[id];
}else{
_279[id]=null;
}
if(_278){
if(_16a.support.deleteExpando){
delete elem[_277];
}else{
if(elem.removeAttribute){
elem.removeAttribute(_277);
}else{
elem[_277]=null;
}
}
}
},_data:function(elem,name,data){
return _16a.data(elem,name,data,true);
},acceptData:function(elem){
if(elem.nodeName){
var _27f=_16a.noData[elem.nodeName.toLowerCase()];
if(_27f){
return !(_27f===true||elem.getAttribute("classid")!==_27f);
}
}
return true;
}});
_16a.fn.extend({data:function(key,_281){
var _282,attr,name,data=null;
if(typeof key==="undefined"){
if(this.length){
data=_16a.data(this[0]);
if(this[0].nodeType===1&&!_16a._data(this[0],"parsedAttrs")){
attr=this[0].attributes;
for(var i=0,l=attr.length;i<l;i++){
name=attr[i].name;
if(name.indexOf("data-")===0){
name=_16a.camelCase(name.substring(5));
dataAttr(this[0],name,data[name]);
}
}
_16a._data(this[0],"parsedAttrs",true);
}
}
return data;
}else{
if(typeof key==="object"){
return this.each(function(){
_16a.data(this,key);
});
}
}
_282=key.split(".");
_282[1]=_282[1]?"."+_282[1]:"";
if(_281===_166){
data=this.triggerHandler("getData"+_282[1]+"!",[_282[0]]);
if(data===_166&&this.length){
data=_16a.data(this[0],key);
data=dataAttr(this[0],key,data);
}
return data===_166&&_282[1]?this.data(_282[0]):data;
}else{
return this.each(function(){
var self=_16a(this),args=[_282[0],_281];
self.triggerHandler("setData"+_282[1]+"!",args);
_16a.data(this,key,_281);
self.triggerHandler("changeData"+_282[1]+"!",args);
});
}
},removeData:function(key){
return this.each(function(){
_16a.removeData(this,key);
});
}});
function dataAttr(elem,key,data){
if(data===_166&&elem.nodeType===1){
var name="data-"+key.replace(_262,"-$1").toLowerCase();
data=elem.getAttribute(name);
if(typeof data==="string"){
try{
data=data==="true"?true:data==="false"?false:data==="null"?null:_16a.isNumeric(data)?parseFloat(data):_261.test(data)?_16a.parseJSON(data):data;
}
catch(e){
}
_16a.data(elem,key,data);
}else{
data=_166;
}
}
return data;
}
function isEmptyDataObject(obj){
for(var name in obj){
if(name==="data"&&_16a.isEmptyObject(obj[name])){
continue;
}
if(name!=="toJSON"){
return false;
}
}
return true;
}
function handleQueueMarkDefer(elem,type,src){
var _294=type+"defer",_295=type+"queue",_296=type+"mark",_297=_16a._data(elem,_294);
if(_297&&(src==="queue"||!_16a._data(elem,_295))&&(src==="mark"||!_16a._data(elem,_296))){
setTimeout(function(){
if(!_16a._data(elem,_295)&&!_16a._data(elem,_296)){
_16a.removeData(elem,_294,true);
_297.fire();
}
},0);
}
}
_16a.extend({_mark:function(elem,type){
if(elem){
type=(type||"fx")+"mark";
_16a._data(elem,type,(_16a._data(elem,type)||0)+1);
}
},_unmark:function(_29a,elem,type){
if(_29a!==true){
type=elem;
elem=_29a;
_29a=false;
}
if(elem){
type=type||"fx";
var key=type+"mark",_29e=_29a?0:((_16a._data(elem,key)||1)-1);
if(_29e){
_16a._data(elem,key,_29e);
}else{
_16a.removeData(elem,key,true);
handleQueueMarkDefer(elem,type,"mark");
}
}
},queue:function(elem,type,data){
var q;
if(elem){
type=(type||"fx")+"queue";
q=_16a._data(elem,type);
if(data){
if(!q||_16a.isArray(data)){
q=_16a._data(elem,type,_16a.makeArray(data));
}else{
q.push(data);
}
}
return q||[];
}
},dequeue:function(elem,type){
type=type||"fx";
var _2a5=_16a.queue(elem,type),fn=_2a5.shift(),_2a7={};
if(fn==="inprogress"){
fn=_2a5.shift();
}
if(fn){
if(type==="fx"){
_2a5.unshift("inprogress");
}
_16a._data(elem,type+".run",_2a7);
fn.call(elem,function(){
_16a.dequeue(elem,type);
},_2a7);
}
if(!_2a5.length){
_16a.removeData(elem,type+"queue "+type+".run",true);
handleQueueMarkDefer(elem,type,"queue");
}
}});
_16a.fn.extend({queue:function(type,data){
if(typeof type!=="string"){
data=type;
type="fx";
}
if(data===_166){
return _16a.queue(this[0],type);
}
return this.each(function(){
var _2aa=_16a.queue(this,type,data);
if(type==="fx"&&_2aa[0]!=="inprogress"){
_16a.dequeue(this,type);
}
});
},dequeue:function(type){
return this.each(function(){
_16a.dequeue(this,type);
});
},delay:function(time,type){
time=_16a.fx?_16a.fx.speeds[time]||time:time;
type=type||"fx";
return this.queue(type,function(next,_2af){
var _2b0=setTimeout(next,time);
_2af.stop=function(){
clearTimeout(_2b0);
};
});
},clearQueue:function(type){
return this.queue(type||"fx",[]);
},promise:function(type,_2b3){
if(typeof type!=="string"){
_2b3=type;
type=_166;
}
type=type||"fx";
var _2b4=_16a.Deferred(),_2b5=this,i=_2b5.length,_2b7=1,_2b8=type+"defer",_2b9=type+"queue",_2ba=type+"mark",tmp;
function resolve(){
if(!(--_2b7)){
_2b4.resolveWith(_2b5,[_2b5]);
}
}
while(i--){
if((tmp=_16a.data(_2b5[i],_2b8,_166,true)||(_16a.data(_2b5[i],_2b9,_166,true)||_16a.data(_2b5[i],_2ba,_166,true))&&_16a.data(_2b5[i],_2b8,_16a.Callbacks("once memory"),true))){
_2b7++;
tmp.add(resolve);
}
}
resolve();
return _2b4.promise();
}});
var _2bc=/[\n\t\r]/g,_2bd=/\s+/,_2be=/\r/g,_2bf=/^(?:button|input)$/i,_2c0=/^(?:button|input|object|select|textarea)$/i,_2c1=/^a(?:rea)?$/i,_2c2=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,_2c3=_16a.support.getSetAttribute,_2c4,_2c5,_2c6;
_16a.fn.extend({attr:function(name,_2c8){
return _16a.access(this,name,_2c8,true,_16a.attr);
},removeAttr:function(name){
return this.each(function(){
_16a.removeAttr(this,name);
});
},prop:function(name,_2cb){
return _16a.access(this,name,_2cb,true,_16a.prop);
},removeProp:function(name){
name=_16a.propFix[name]||name;
return this.each(function(){
try{
this[name]=_166;
delete this[name];
}
catch(e){
}
});
},addClass:function(_2cd){
var _2ce,i,l,elem,_2d2,c,cl;
if(_16a.isFunction(_2cd)){
return this.each(function(j){
_16a(this).addClass(_2cd.call(this,j,this.className));
});
}
if(_2cd&&typeof _2cd==="string"){
_2ce=_2cd.split(_2bd);
for(i=0,l=this.length;i<l;i++){
elem=this[i];
if(elem.nodeType===1){
if(!elem.className&&_2ce.length===1){
elem.className=_2cd;
}else{
_2d2=" "+elem.className+" ";
for(c=0,cl=_2ce.length;c<cl;c++){
if(!~_2d2.indexOf(" "+_2ce[c]+" ")){
_2d2+=_2ce[c]+" ";
}
}
elem.className=_16a.trim(_2d2);
}
}
}
}
return this;
},removeClass:function(_2d6){
var _2d7,i,l,elem,_2db,c,cl;
if(_16a.isFunction(_2d6)){
return this.each(function(j){
_16a(this).removeClass(_2d6.call(this,j,this.className));
});
}
if((_2d6&&typeof _2d6==="string")||_2d6===_166){
_2d7=(_2d6||"").split(_2bd);
for(i=0,l=this.length;i<l;i++){
elem=this[i];
if(elem.nodeType===1&&elem.className){
if(_2d6){
_2db=(" "+elem.className+" ").replace(_2bc," ");
for(c=0,cl=_2d7.length;c<cl;c++){
_2db=_2db.replace(" "+_2d7[c]+" "," ");
}
elem.className=_16a.trim(_2db);
}else{
elem.className="";
}
}
}
}
return this;
},toggleClass:function(_2df,_2e0){
var type=typeof _2df,_2e2=typeof _2e0==="boolean";
if(_16a.isFunction(_2df)){
return this.each(function(i){
_16a(this).toggleClass(_2df.call(this,i,this.className,_2e0),_2e0);
});
}
return this.each(function(){
if(type==="string"){
var _2e4,i=0,self=_16a(this),_2e7=_2e0,_2e8=_2df.split(_2bd);
while((_2e4=_2e8[i++])){
_2e7=_2e2?_2e7:!self.hasClass(_2e4);
self[_2e7?"addClass":"removeClass"](_2e4);
}
}else{
if(type==="undefined"||type==="boolean"){
if(this.className){
_16a._data(this,"__className__",this.className);
}
this.className=this.className||_2df===false?"":_16a._data(this,"__className__")||"";
}
}
});
},hasClass:function(_2e9){
var _2ea=" "+_2e9+" ",i=0,l=this.length;
for(;i<l;i++){
if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(_2bc," ").indexOf(_2ea)>-1){
return true;
}
}
return false;
},val:function(_2ed){
var _2ee,ret,_2f0,elem=this[0];
if(!arguments.length){
if(elem){
_2ee=_16a.valHooks[elem.nodeName.toLowerCase()]||_16a.valHooks[elem.type];
if(_2ee&&"get" in _2ee&&(ret=_2ee.get(elem,"value"))!==_166){
return ret;
}
ret=elem.value;
return typeof ret==="string"?ret.replace(_2be,""):ret==null?"":ret;
}
return;
}
_2f0=_16a.isFunction(_2ed);
return this.each(function(i){
var self=_16a(this),val;
if(this.nodeType!==1){
return;
}
if(_2f0){
val=_2ed.call(this,i,self.val());
}else{
val=_2ed;
}
if(val==null){
val="";
}else{
if(typeof val==="number"){
val+="";
}else{
if(_16a.isArray(val)){
val=_16a.map(val,function(_2f5){
return _2f5==null?"":_2f5+"";
});
}
}
}
_2ee=_16a.valHooks[this.nodeName.toLowerCase()]||_16a.valHooks[this.type];
if(!_2ee||!("set" in _2ee)||_2ee.set(this,val,"value")===_166){
this.value=val;
}
});
}});
_16a.extend({valHooks:{option:{get:function(elem){
var val=elem.attributes.value;
return !val||val.specified?elem.value:elem.text;
}},select:{get:function(elem){
var _2f9,i,max,_2fc,_2fd=elem.selectedIndex,_2fe=[],_2ff=elem.options,one=elem.type==="select-one";
if(_2fd<0){
return null;
}
i=one?_2fd:0;
max=one?_2fd+1:_2ff.length;
for(;i<max;i++){
_2fc=_2ff[i];
if(_2fc.selected&&(_16a.support.optDisabled?!_2fc.disabled:_2fc.getAttribute("disabled")===null)&&(!_2fc.parentNode.disabled||!_16a.nodeName(_2fc.parentNode,"optgroup"))){
_2f9=_16a(_2fc).val();
if(one){
return _2f9;
}
_2fe.push(_2f9);
}
}
if(one&&!_2fe.length&&_2ff.length){
return _16a(_2ff[_2fd]).val();
}
return _2fe;
},set:function(elem,_302){
var _303=_16a.makeArray(_302);
_16a(elem).find("option").each(function(){
this.selected=_16a.inArray(_16a(this).val(),_303)>=0;
});
if(!_303.length){
elem.selectedIndex=-1;
}
return _303;
}}},attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attr:function(elem,name,_306,pass){
var ret,_309,_30a,_30b=elem.nodeType;
if(!elem||_30b===3||_30b===8||_30b===2){
return;
}
if(pass&&name in _16a.attrFn){
return _16a(elem)[name](_306);
}
if(typeof elem.getAttribute==="undefined"){
return _16a.prop(elem,name,_306);
}
_30a=_30b!==1||!_16a.isXMLDoc(elem);
if(_30a){
name=name.toLowerCase();
_309=_16a.attrHooks[name]||(_2c2.test(name)?_2c5:_2c4);
}
if(_306!==_166){
if(_306===null){
_16a.removeAttr(elem,name);
return;
}else{
if(_309&&"set" in _309&&_30a&&(ret=_309.set(elem,_306,name))!==_166){
return ret;
}else{
elem.setAttribute(name,""+_306);
return _306;
}
}
}else{
if(_309&&"get" in _309&&_30a&&(ret=_309.get(elem,name))!==null){
return ret;
}else{
ret=elem.getAttribute(name);
return ret===null?_166:ret;
}
}
},removeAttr:function(elem,_30d){
var _30e,_30f,name,l,i=0;
if(_30d&&elem.nodeType===1){
_30f=_30d.toLowerCase().split(_2bd);
l=_30f.length;
for(;i<l;i++){
name=_30f[i];
if(name){
_30e=_16a.propFix[name]||name;
_16a.attr(elem,name,"");
elem.removeAttribute(_2c3?name:_30e);
if(_2c2.test(name)&&_30e in elem){
elem[_30e]=false;
}
}
}
}
},attrHooks:{type:{set:function(elem,_314){
if(_2bf.test(elem.nodeName)&&elem.parentNode){
_16a.error("type property can't be changed");
}else{
if(!_16a.support.radioValue&&_314==="radio"&&_16a.nodeName(elem,"input")){
var val=elem.value;
elem.setAttribute("type",_314);
if(val){
elem.value=val;
}
return _314;
}
}
}},value:{get:function(elem,name){
if(_2c4&&_16a.nodeName(elem,"button")){
return _2c4.get(elem,name);
}
return name in elem?elem.value:null;
},set:function(elem,_319,name){
if(_2c4&&_16a.nodeName(elem,"button")){
return _2c4.set(elem,_319,name);
}
elem.value=_319;
}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(elem,name,_31d){
var ret,_31f,_320,_321=elem.nodeType;
if(!elem||_321===3||_321===8||_321===2){
return;
}
_320=_321!==1||!_16a.isXMLDoc(elem);
if(_320){
name=_16a.propFix[name]||name;
_31f=_16a.propHooks[name];
}
if(_31d!==_166){
if(_31f&&"set" in _31f&&(ret=_31f.set(elem,_31d,name))!==_166){
return ret;
}else{
return (elem[name]=_31d);
}
}else{
if(_31f&&"get" in _31f&&(ret=_31f.get(elem,name))!==null){
return ret;
}else{
return elem[name];
}
}
},propHooks:{tabIndex:{get:function(elem){
var _323=elem.getAttributeNode("tabindex");
return _323&&_323.specified?parseInt(_323.value,10):_2c0.test(elem.nodeName)||_2c1.test(elem.nodeName)&&elem.href?0:_166;
}}}});
_16a.attrHooks.tabindex=_16a.propHooks.tabIndex;
_2c5={get:function(elem,name){
var _326,_327=_16a.prop(elem,name);
return _327===true||typeof _327!=="boolean"&&(_326=elem.getAttributeNode(name))&&_326.nodeValue!==false?name.toLowerCase():_166;
},set:function(elem,_329,name){
var _32b;
if(_329===false){
_16a.removeAttr(elem,name);
}else{
_32b=_16a.propFix[name]||name;
if(_32b in elem){
elem[_32b]=true;
}
elem.setAttribute(name,name.toLowerCase());
}
return name;
}};
if(!_2c3){
_2c6={name:true,id:true};
_2c4=_16a.valHooks.button={get:function(elem,name){
var ret;
ret=elem.getAttributeNode(name);
return ret&&(_2c6[name]?ret.nodeValue!=="":ret.specified)?ret.nodeValue:_166;
},set:function(elem,_330,name){
var ret=elem.getAttributeNode(name);
if(!ret){
ret=_167.createAttribute(name);
elem.setAttributeNode(ret);
}
return (ret.nodeValue=_330+"");
}};
_16a.attrHooks.tabindex.set=_2c4.set;
_16a.each(["width","height"],function(i,name){
_16a.attrHooks[name]=_16a.extend(_16a.attrHooks[name],{set:function(elem,_336){
if(_336===""){
elem.setAttribute(name,"auto");
return _336;
}
}});
});
_16a.attrHooks.contenteditable={get:_2c4.get,set:function(elem,_338,name){
if(_338===""){
_338="false";
}
_2c4.set(elem,_338,name);
}};
}
if(!_16a.support.hrefNormalized){
_16a.each(["href","src","width","height"],function(i,name){
_16a.attrHooks[name]=_16a.extend(_16a.attrHooks[name],{get:function(elem){
var ret=elem.getAttribute(name,2);
return ret===null?_166:ret;
}});
});
}
if(!_16a.support.style){
_16a.attrHooks.style={get:function(elem){
return elem.style.cssText.toLowerCase()||_166;
},set:function(elem,_340){
return (elem.style.cssText=""+_340);
}};
}
if(!_16a.support.optSelected){
_16a.propHooks.selected=_16a.extend(_16a.propHooks.selected,{get:function(elem){
var _342=elem.parentNode;
if(_342){
_342.selectedIndex;
if(_342.parentNode){
_342.parentNode.selectedIndex;
}
}
return null;
}});
}
if(!_16a.support.enctype){
_16a.propFix.enctype="encoding";
}
if(!_16a.support.checkOn){
_16a.each(["radio","checkbox"],function(){
_16a.valHooks[this]={get:function(elem){
return elem.getAttribute("value")===null?"on":elem.value;
}};
});
}
_16a.each(["radio","checkbox"],function(){
_16a.valHooks[this]=_16a.extend(_16a.valHooks[this],{set:function(elem,_345){
if(_16a.isArray(_345)){
return (elem.checked=_16a.inArray(_16a(elem).val(),_345)>=0);
}
}});
});
var _346=/^(?:textarea|input|select)$/i,_347=/^([^\.]*)?(?:\.(.+))?$/,_348=/\bhover(\.\S+)?\b/,_349=/^key/,_34a=/^(?:mouse|contextmenu)|click/,_34b=/^(?:focusinfocus|focusoutblur)$/,_34c=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,_34d=function(_34e){
var _34f=_34c.exec(_34e);
if(_34f){
_34f[1]=(_34f[1]||"").toLowerCase();
_34f[3]=_34f[3]&&new RegExp("(?:^|\\s)"+_34f[3]+"(?:\\s|$)");
}
return _34f;
},_350=function(elem,m){
var _353=elem.attributes||{};
return ((!m[1]||elem.nodeName.toLowerCase()===m[1])&&(!m[2]||(_353.id||{}).value===m[2])&&(!m[3]||m[3].test((_353["class"]||{}).value)));
},_354=function(_355){
return _16a.event.special.hover?_355:_355.replace(_348,"mouseenter$1 mouseleave$1");
};
_16a.event={add:function(elem,_357,_358,data,_35a){
var _35b,_35c,_35d,t,tns,type,_361,_362,_363,_364,_365,_366;
if(elem.nodeType===3||elem.nodeType===8||!_357||!_358||!(_35b=_16a._data(elem))){
return;
}
if(_358.handler){
_363=_358;
_358=_363.handler;
}
if(!_358.guid){
_358.guid=_16a.guid++;
}
_35d=_35b.events;
if(!_35d){
_35b.events=_35d={};
}
_35c=_35b.handle;
if(!_35c){
_35b.handle=_35c=function(e){
return typeof _16a!=="undefined"&&(!e||_16a.event.triggered!==e.type)?_16a.event.dispatch.apply(_35c.elem,arguments):_166;
};
_35c.elem=elem;
}
_357=_16a.trim(_354(_357)).split(" ");
for(t=0;t<_357.length;t++){
tns=_347.exec(_357[t])||[];
type=tns[1];
_361=(tns[2]||"").split(".").sort();
_366=_16a.event.special[type]||{};
type=(_35a?_366.delegateType:_366.bindType)||type;
_366=_16a.event.special[type]||{};
_362=_16a.extend({type:type,origType:tns[1],data:data,handler:_358,guid:_358.guid,selector:_35a,quick:_34d(_35a),namespace:_361.join(".")},_363);
_365=_35d[type];
if(!_365){
_365=_35d[type]=[];
_365.delegateCount=0;
if(!_366.setup||_366.setup.call(elem,data,_361,_35c)===false){
if(elem.addEventListener){
elem.addEventListener(type,_35c,false);
}else{
if(elem.attachEvent){
elem.attachEvent("on"+type,_35c);
}
}
}
}
if(_366.add){
_366.add.call(elem,_362);
if(!_362.handler.guid){
_362.handler.guid=_358.guid;
}
}
if(_35a){
_365.splice(_365.delegateCount++,0,_362);
}else{
_365.push(_362);
}
_16a.event.global[type]=true;
}
elem=null;
},global:{},remove:function(elem,_369,_36a,_36b,_36c){
var _36d=_16a.hasData(elem)&&_16a._data(elem),t,tns,type,_371,_372,_373,j,_375,_376,_377,_378,_379;
if(!_36d||!(_375=_36d.events)){
return;
}
_369=_16a.trim(_354(_369||"")).split(" ");
for(t=0;t<_369.length;t++){
tns=_347.exec(_369[t])||[];
type=_371=tns[1];
_372=tns[2];
if(!type){
for(type in _375){
_16a.event.remove(elem,type+_369[t],_36a,_36b,true);
}
continue;
}
_376=_16a.event.special[type]||{};
type=(_36b?_376.delegateType:_376.bindType)||type;
_378=_375[type]||[];
_373=_378.length;
_372=_372?new RegExp("(^|\\.)"+_372.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;
for(j=0;j<_378.length;j++){
_379=_378[j];
if((_36c||_371===_379.origType)&&(!_36a||_36a.guid===_379.guid)&&(!_372||_372.test(_379.namespace))&&(!_36b||_36b===_379.selector||_36b==="**"&&_379.selector)){
_378.splice(j--,1);
if(_379.selector){
_378.delegateCount--;
}
if(_376.remove){
_376.remove.call(elem,_379);
}
}
}
if(_378.length===0&&_373!==_378.length){
if(!_376.teardown||_376.teardown.call(elem,_372)===false){
_16a.removeEvent(elem,type,_36d.handle);
}
delete _375[type];
}
}
if(_16a.isEmptyObject(_375)){
_377=_36d.handle;
if(_377){
_377.elem=null;
}
_16a.removeData(elem,["events","handle"],true);
}
},customEvent:{"getData":true,"setData":true,"changeData":true},trigger:function(_37a,data,elem,_37d){
if(elem&&(elem.nodeType===3||elem.nodeType===8)){
return;
}
var type=_37a.type||_37a,_37f=[],_380,_381,i,cur,old,_385,_386,_387,_388,_389;
if(_34b.test(type+_16a.event.triggered)){
return;
}
if(type.indexOf("!")>=0){
type=type.slice(0,-1);
_381=true;
}
if(type.indexOf(".")>=0){
_37f=type.split(".");
type=_37f.shift();
_37f.sort();
}
if((!elem||_16a.event.customEvent[type])&&!_16a.event.global[type]){
return;
}
_37a=typeof _37a==="object"?_37a[_16a.expando]?_37a:new _16a.Event(type,_37a):new _16a.Event(type);
_37a.type=type;
_37a.isTrigger=true;
_37a.exclusive=_381;
_37a.namespace=_37f.join(".");
_37a.namespace_re=_37a.namespace?new RegExp("(^|\\.)"+_37f.join("\\.(?:.*\\.)?")+"(\\.|$)"):null;
_385=type.indexOf(":")<0?"on"+type:"";
if(!elem){
_380=_16a.cache;
for(i in _380){
if(_380[i].events&&_380[i].events[type]){
_16a.event.trigger(_37a,data,_380[i].handle.elem,true);
}
}
return;
}
_37a.result=_166;
if(!_37a.target){
_37a.target=elem;
}
data=data!=null?_16a.makeArray(data):[];
data.unshift(_37a);
_386=_16a.event.special[type]||{};
if(_386.trigger&&_386.trigger.apply(elem,data)===false){
return;
}
_388=[[elem,_386.bindType||type]];
if(!_37d&&!_386.noBubble&&!_16a.isWindow(elem)){
_389=_386.delegateType||type;
cur=_34b.test(_389+type)?elem:elem.parentNode;
old=null;
for(;cur;cur=cur.parentNode){
_388.push([cur,_389]);
old=cur;
}
if(old&&old===elem.ownerDocument){
_388.push([old.defaultView||old.parentWindow||_165,_389]);
}
}
for(i=0;i<_388.length&&!_37a.isPropagationStopped();i++){
cur=_388[i][0];
_37a.type=_388[i][1];
_387=(_16a._data(cur,"events")||{})[_37a.type]&&_16a._data(cur,"handle");
if(_387){
_387.apply(cur,data);
}
_387=_385&&cur[_385];
if(_387&&_16a.acceptData(cur)&&_387.apply(cur,data)===false){
_37a.preventDefault();
}
}
_37a.type=type;
if(!_37d&&!_37a.isDefaultPrevented()){
if((!_386._default||_386._default.apply(elem.ownerDocument,data)===false)&&!(type==="click"&&_16a.nodeName(elem,"a"))&&_16a.acceptData(elem)){
if(_385&&elem[type]&&((type!=="focus"&&type!=="blur")||_37a.target.offsetWidth!==0)&&!_16a.isWindow(elem)){
old=elem[_385];
if(old){
elem[_385]=null;
}
_16a.event.triggered=type;
elem[type]();
_16a.event.triggered=_166;
if(old){
elem[_385]=old;
}
}
}
}
return _37a.result;
},dispatch:function(_38a){
_38a=_16a.event.fix(_38a||_165.event);
var _38b=((_16a._data(this,"events")||{})[_38a.type]||[]),_38c=_38b.delegateCount,args=[].slice.call(arguments,0),_38e=!_38a.exclusive&&!_38a.namespace,_38f=[],i,j,cur,_393,ret,_395,_396,_397,_398,sel,_39a;
args[0]=_38a;
_38a.delegateTarget=this;
if(_38c&&!_38a.target.disabled&&!(_38a.button&&_38a.type==="click")){
_393=_16a(this);
_393.context=this.ownerDocument||this;
for(cur=_38a.target;cur!=this;cur=cur.parentNode||this){
_395={};
_397=[];
_393[0]=cur;
for(i=0;i<_38c;i++){
_398=_38b[i];
sel=_398.selector;
if(_395[sel]===_166){
_395[sel]=(_398.quick?_350(cur,_398.quick):_393.is(sel));
}
if(_395[sel]){
_397.push(_398);
}
}
if(_397.length){
_38f.push({elem:cur,matches:_397});
}
}
}
if(_38b.length>_38c){
_38f.push({elem:this,matches:_38b.slice(_38c)});
}
for(i=0;i<_38f.length&&!_38a.isPropagationStopped();i++){
_396=_38f[i];
_38a.currentTarget=_396.elem;
for(j=0;j<_396.matches.length&&!_38a.isImmediatePropagationStopped();j++){
_398=_396.matches[j];
if(_38e||(!_38a.namespace&&!_398.namespace)||_38a.namespace_re&&_38a.namespace_re.test(_398.namespace)){
_38a.data=_398.data;
_38a.handleObj=_398;
ret=((_16a.event.special[_398.origType]||{}).handle||_398.handler).apply(_396.elem,args);
if(ret!==_166){
_38a.result=ret;
if(ret===false){
_38a.preventDefault();
_38a.stopPropagation();
}
}
}
}
}
return _38a.result;
},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(_39b,_39c){
if(_39b.which==null){
_39b.which=_39c.charCode!=null?_39c.charCode:_39c.keyCode;
}
return _39b;
}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(_39d,_39e){
var _39f,doc,body,_3a2=_39e.button,_3a3=_39e.fromElement;
if(_39d.pageX==null&&_39e.clientX!=null){
_39f=_39d.target.ownerDocument||_167;
doc=_39f.documentElement;
body=_39f.body;
_39d.pageX=_39e.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);
_39d.pageY=_39e.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0);
}
if(!_39d.relatedTarget&&_3a3){
_39d.relatedTarget=_3a3===_39d.target?_39e.toElement:_3a3;
}
if(!_39d.which&&_3a2!==_166){
_39d.which=(_3a2&1?1:(_3a2&2?3:(_3a2&4?2:0)));
}
return _39d;
}},fix:function(_3a4){
if(_3a4[_16a.expando]){
return _3a4;
}
var i,prop,_3a7=_3a4,_3a8=_16a.event.fixHooks[_3a4.type]||{},copy=_3a8.props?this.props.concat(_3a8.props):this.props;
_3a4=_16a.Event(_3a7);
for(i=copy.length;i;){
prop=copy[--i];
_3a4[prop]=_3a7[prop];
}
if(!_3a4.target){
_3a4.target=_3a7.srcElement||_167;
}
if(_3a4.target.nodeType===3){
_3a4.target=_3a4.target.parentNode;
}
if(_3a4.metaKey===_166){
_3a4.metaKey=_3a4.ctrlKey;
}
return _3a8.filter?_3a8.filter(_3a4,_3a7):_3a4;
},special:{ready:{setup:_16a.bindReady},load:{noBubble:true},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(data,_3ab,_3ac){
if(_16a.isWindow(this)){
this.onbeforeunload=_3ac;
}
},teardown:function(_3ad,_3ae){
if(this.onbeforeunload===_3ae){
this.onbeforeunload=null;
}
}}},simulate:function(type,elem,_3b1,_3b2){
var e=_16a.extend(new _16a.Event(),_3b1,{type:type,isSimulated:true,originalEvent:{}});
if(_3b2){
_16a.event.trigger(e,null,elem);
}else{
_16a.event.dispatch.call(elem,e);
}
if(e.isDefaultPrevented()){
_3b1.preventDefault();
}
}};
_16a.event.handle=_16a.event.dispatch;
_16a.removeEvent=_167.removeEventListener?function(elem,type,_3b6){
if(elem.removeEventListener){
elem.removeEventListener(type,_3b6,false);
}
}:function(elem,type,_3b9){
if(elem.detachEvent){
elem.detachEvent("on"+type,_3b9);
}
};
_16a.Event=function(src,_3bb){
if(!(this instanceof _16a.Event)){
return new _16a.Event(src,_3bb);
}
if(src&&src.type){
this.originalEvent=src;
this.type=src.type;
this.isDefaultPrevented=(src.defaultPrevented||src.returnValue===false||src.getPreventDefault&&src.getPreventDefault())?returnTrue:returnFalse;
}else{
this.type=src;
}
if(_3bb){
_16a.extend(this,_3bb);
}
this.timeStamp=src&&src.timeStamp||_16a.now();
this[_16a.expando]=true;
};
function returnFalse(){
return false;
}
function returnTrue(){
return true;
}
_16a.Event.prototype={preventDefault:function(){
this.isDefaultPrevented=returnTrue;
var e=this.originalEvent;
if(!e){
return;
}
if(e.preventDefault){
e.preventDefault();
}else{
e.returnValue=false;
}
},stopPropagation:function(){
this.isPropagationStopped=returnTrue;
var e=this.originalEvent;
if(!e){
return;
}
if(e.stopPropagation){
e.stopPropagation();
}
e.cancelBubble=true;
},stopImmediatePropagation:function(){
this.isImmediatePropagationStopped=returnTrue;
this.stopPropagation();
},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};
_16a.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){
_16a.event.special[orig]={delegateType:fix,bindType:fix,handle:function(_3c0){
var _3c1=this,_3c2=_3c0.relatedTarget,_3c3=_3c0.handleObj,_3c4=_3c3.selector,ret;
if(!_3c2||(_3c2!==_3c1&&!_16a.contains(_3c1,_3c2))){
_3c0.type=_3c3.origType;
ret=_3c3.handler.apply(this,arguments);
_3c0.type=fix;
}
return ret;
}};
});
if(!_16a.support.submitBubbles){
_16a.event.special.submit={setup:function(){
if(_16a.nodeName(this,"form")){
return false;
}
_16a.event.add(this,"click._submit keypress._submit",function(e){
var elem=e.target,form=_16a.nodeName(elem,"input")||_16a.nodeName(elem,"button")?elem.form:_166;
if(form&&!form._submit_attached){
_16a.event.add(form,"submit._submit",function(_3c9){
if(this.parentNode&&!_3c9.isTrigger){
_16a.event.simulate("submit",this.parentNode,_3c9,true);
}
});
form._submit_attached=true;
}
});
},teardown:function(){
if(_16a.nodeName(this,"form")){
return false;
}
_16a.event.remove(this,"._submit");
}};
}
if(!_16a.support.changeBubbles){
_16a.event.special.change={setup:function(){
if(_346.test(this.nodeName)){
if(this.type==="checkbox"||this.type==="radio"){
_16a.event.add(this,"propertychange._change",function(_3ca){
if(_3ca.originalEvent.propertyName==="checked"){
this._just_changed=true;
}
});
_16a.event.add(this,"click._change",function(_3cb){
if(this._just_changed&&!_3cb.isTrigger){
this._just_changed=false;
_16a.event.simulate("change",this,_3cb,true);
}
});
}
return false;
}
_16a.event.add(this,"beforeactivate._change",function(e){
var elem=e.target;
if(_346.test(elem.nodeName)&&!elem._change_attached){
_16a.event.add(elem,"change._change",function(_3ce){
if(this.parentNode&&!_3ce.isSimulated&&!_3ce.isTrigger){
_16a.event.simulate("change",this.parentNode,_3ce,true);
}
});
elem._change_attached=true;
}
});
},handle:function(_3cf){
var elem=_3cf.target;
if(this!==elem||_3cf.isSimulated||_3cf.isTrigger||(elem.type!=="radio"&&elem.type!=="checkbox")){
return _3cf.handleObj.handler.apply(this,arguments);
}
},teardown:function(){
_16a.event.remove(this,"._change");
return _346.test(this.nodeName);
}};
}
if(!_16a.support.focusinBubbles){
_16a.each({focus:"focusin",blur:"focusout"},function(orig,fix){
var _3d3=0,_3d4=function(_3d5){
_16a.event.simulate(fix,_3d5.target,_16a.event.fix(_3d5),true);
};
_16a.event.special[fix]={setup:function(){
if(_3d3++===0){
_167.addEventListener(orig,_3d4,true);
}
},teardown:function(){
if(--_3d3===0){
_167.removeEventListener(orig,_3d4,true);
}
}};
});
}
_16a.fn.extend({on:function(_3d6,_3d7,data,fn,one){
var _3db,type;
if(typeof _3d6==="object"){
if(typeof _3d7!=="string"){
data=_3d7;
_3d7=_166;
}
for(type in _3d6){
this.on(type,_3d7,data,_3d6[type],one);
}
return this;
}
if(data==null&&fn==null){
fn=_3d7;
data=_3d7=_166;
}else{
if(fn==null){
if(typeof _3d7==="string"){
fn=data;
data=_166;
}else{
fn=data;
data=_3d7;
_3d7=_166;
}
}
}
if(fn===false){
fn=returnFalse;
}else{
if(!fn){
return this;
}
}
if(one===1){
_3db=fn;
fn=function(_3dd){
_16a().off(_3dd);
return _3db.apply(this,arguments);
};
fn.guid=_3db.guid||(_3db.guid=_16a.guid++);
}
return this.each(function(){
_16a.event.add(this,_3d6,fn,data,_3d7);
});
},one:function(_3de,_3df,data,fn){
return this.on.call(this,_3de,_3df,data,fn,1);
},off:function(_3e2,_3e3,fn){
if(_3e2&&_3e2.preventDefault&&_3e2.handleObj){
var _3e5=_3e2.handleObj;
_16a(_3e2.delegateTarget).off(_3e5.namespace?_3e5.type+"."+_3e5.namespace:_3e5.type,_3e5.selector,_3e5.handler);
return this;
}
if(typeof _3e2==="object"){
for(var type in _3e2){
this.off(type,_3e3,_3e2[type]);
}
return this;
}
if(_3e3===false||typeof _3e3==="function"){
fn=_3e3;
_3e3=_166;
}
if(fn===false){
fn=returnFalse;
}
return this.each(function(){
_16a.event.remove(this,_3e2,fn,_3e3);
});
},bind:function(_3e7,data,fn){
return this.on(_3e7,null,data,fn);
},unbind:function(_3ea,fn){
return this.off(_3ea,null,fn);
},live:function(_3ec,data,fn){
_16a(this.context).on(_3ec,this.selector,data,fn);
return this;
},die:function(_3ef,fn){
_16a(this.context).off(_3ef,this.selector||"**",fn);
return this;
},delegate:function(_3f1,_3f2,data,fn){
return this.on(_3f2,_3f1,data,fn);
},undelegate:function(_3f5,_3f6,fn){
return arguments.length==1?this.off(_3f5,"**"):this.off(_3f6,_3f5,fn);
},trigger:function(type,data){
return this.each(function(){
_16a.event.trigger(type,data,this);
});
},triggerHandler:function(type,data){
if(this[0]){
return _16a.event.trigger(type,data,this[0],true);
}
},toggle:function(fn){
var args=arguments,guid=fn.guid||_16a.guid++,i=0,_400=function(_401){
var _402=(_16a._data(this,"lastToggle"+fn.guid)||0)%i;
_16a._data(this,"lastToggle"+fn.guid,_402+1);
_401.preventDefault();
return args[_402].apply(this,arguments)||false;
};
_400.guid=guid;
while(i<args.length){
args[i++].guid=guid;
}
return this.click(_400);
},hover:function(_403,_404){
return this.mouseenter(_403).mouseleave(_404||_403);
}});
_16a.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){
_16a.fn[name]=function(data,fn){
if(fn==null){
fn=data;
data=null;
}
return arguments.length>0?this.on(name,null,data,fn):this.trigger(name);
};
if(_16a.attrFn){
_16a.attrFn[name]=true;
}
if(_349.test(name)){
_16a.event.fixHooks[name]=_16a.event.keyHooks;
}
if(_34a.test(name)){
_16a.event.fixHooks[name]=_16a.event.mouseHooks;
}
});
(function(){
var _409=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,_40a="sizcache"+(Math.random()+"").replace(".",""),done=0,_40c=Object.prototype.toString,_40d=false,_40e=true,_40f=/\\/g,_410=/\r\n/g,_411=/\W/;
[0,0].sort(function(){
_40e=false;
return 0;
});
var _412=function(_413,_414,_415,seed){
_415=_415||[];
_414=_414||_167;
var _417=_414;
if(_414.nodeType!==1&&_414.nodeType!==9){
return [];
}
if(!_413||typeof _413!=="string"){
return _415;
}
var m,set,_41a,_41b,ret,cur,pop,i,_420=true,_421=_412.isXML(_414),_422=[],_423=_413;
do{
_409.exec("");
m=_409.exec(_423);
if(m){
_423=m[3];
_422.push(m[1]);
if(m[2]){
_41b=m[3];
break;
}
}
}while(m);
if(_422.length>1&&_424.exec(_413)){
if(_422.length===2&&Expr.relative[_422[0]]){
set=_426(_422[0]+_422[1],_414,seed);
}else{
set=Expr.relative[_422[0]]?[_414]:_412(_422.shift(),_414);
while(_422.length){
_413=_422.shift();
if(Expr.relative[_413]){
_413+=_422.shift();
}
set=_426(_413,set,seed);
}
}
}else{
if(!seed&&_422.length>1&&_414.nodeType===9&&!_421&&Expr.match.ID.test(_422[0])&&!Expr.match.ID.test(_422[_422.length-1])){
ret=_412.find(_422.shift(),_414,_421);
_414=ret.expr?_412.filter(ret.expr,ret.set)[0]:ret.set[0];
}
if(_414){
ret=seed?{expr:_422.pop(),set:_427(seed)}:_412.find(_422.pop(),_422.length===1&&(_422[0]==="~"||_422[0]==="+")&&_414.parentNode?_414.parentNode:_414,_421);
set=ret.expr?_412.filter(ret.expr,ret.set):ret.set;
if(_422.length>0){
_41a=_427(set);
}else{
_420=false;
}
while(_422.length){
cur=_422.pop();
pop=cur;
if(!Expr.relative[cur]){
cur="";
}else{
pop=_422.pop();
}
if(pop==null){
pop=_414;
}
Expr.relative[cur](_41a,pop,_421);
}
}else{
_41a=_422=[];
}
}
if(!_41a){
_41a=set;
}
if(!_41a){
_412.error(cur||_413);
}
if(_40c.call(_41a)==="[object Array]"){
if(!_420){
_415.push.apply(_415,_41a);
}else{
if(_414&&_414.nodeType===1){
for(i=0;_41a[i]!=null;i++){
if(_41a[i]&&(_41a[i]===true||_41a[i].nodeType===1&&_412.contains(_414,_41a[i]))){
_415.push(set[i]);
}
}
}else{
for(i=0;_41a[i]!=null;i++){
if(_41a[i]&&_41a[i].nodeType===1){
_415.push(set[i]);
}
}
}
}
}else{
_427(_41a,_415);
}
if(_41b){
_412(_41b,_417,_415,seed);
_412.uniqueSort(_415);
}
return _415;
};
_412.uniqueSort=function(_428){
if(_429){
_40d=_40e;
_428.sort(_429);
if(_40d){
for(var i=1;i<_428.length;i++){
if(_428[i]===_428[i-1]){
_428.splice(i--,1);
}
}
}
}
return _428;
};
_412.matches=function(expr,set){
return _412(expr,null,null,set);
};
_412.matchesSelector=function(node,expr){
return _412(expr,null,null,[node]).length>0;
};
_412.find=function(expr,_430,_431){
var set,i,len,_435,type,left;
if(!expr){
return [];
}
for(i=0,len=Expr.order.length;i<len;i++){
type=Expr.order[i];
if((_435=Expr.leftMatch[type].exec(expr))){
left=_435[1];
_435.splice(1,1);
if(left.substr(left.length-1)!=="\\"){
_435[1]=(_435[1]||"").replace(_40f,"");
set=Expr.find[type](_435,_430,_431);
if(set!=null){
expr=expr.replace(Expr.match[type],"");
break;
}
}
}
}
if(!set){
set=typeof _430.getElementsByTagName!=="undefined"?_430.getElementsByTagName("*"):[];
}
return {set:set,expr:expr};
};
_412.filter=function(expr,set,_43a,not){
var _43c,_43d,type,_43f,item,_441,left,i,pass,old=expr,_446=[],_447=set,_448=set&&set[0]&&_412.isXML(set[0]);
while(expr&&set.length){
for(type in Expr.filter){
if((_43c=Expr.leftMatch[type].exec(expr))!=null&&_43c[2]){
_441=Expr.filter[type];
left=_43c[1];
_43d=false;
_43c.splice(1,1);
if(left.substr(left.length-1)==="\\"){
continue;
}
if(_447===_446){
_446=[];
}
if(Expr.preFilter[type]){
_43c=Expr.preFilter[type](_43c,_447,_43a,_446,not,_448);
if(!_43c){
_43d=_43f=true;
}else{
if(_43c===true){
continue;
}
}
}
if(_43c){
for(i=0;(item=_447[i])!=null;i++){
if(item){
_43f=_441(item,_43c,i,_447);
pass=not^_43f;
if(_43a&&_43f!=null){
if(pass){
_43d=true;
}else{
_447[i]=false;
}
}else{
if(pass){
_446.push(item);
_43d=true;
}
}
}
}
}
if(_43f!==_166){
if(!_43a){
_447=_446;
}
expr=expr.replace(Expr.match[type],"");
if(!_43d){
return [];
}
break;
}
}
}
if(expr===old){
if(_43d==null){
_412.error(expr);
}else{
break;
}
}
old=expr;
}
return _447;
};
_412.error=function(msg){
throw new Error("Syntax error, unrecognized expression: "+msg);
};
var _44a=_412.getText=function(elem){
var i,node,_44e=elem.nodeType,ret="";
if(_44e){
if(_44e===1||_44e===9){
if(typeof elem.textContent==="string"){
return elem.textContent;
}else{
if(typeof elem.innerText==="string"){
return elem.innerText.replace(_410,"");
}else{
for(elem=elem.firstChild;elem;elem=elem.nextSibling){
ret+=_44a(elem);
}
}
}
}else{
if(_44e===3||_44e===4){
return elem.nodeValue;
}
}
}else{
for(i=0;(node=elem[i]);i++){
if(node.nodeType!==8){
ret+=_44a(node);
}
}
}
return ret;
};
var Expr=_412.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(elem){
return elem.getAttribute("href");
},type:function(elem){
return elem.getAttribute("type");
}},relative:{"+":function(_452,part){
var _454=typeof part==="string",_455=_454&&!_411.test(part),_456=_454&&!_455;
if(_455){
part=part.toLowerCase();
}
for(var i=0,l=_452.length,elem;i<l;i++){
if((elem=_452[i])){
while((elem=elem.previousSibling)&&elem.nodeType!==1){
}
_452[i]=_456||elem&&elem.nodeName.toLowerCase()===part?elem||false:elem===part;
}
}
if(_456){
_412.filter(part,_452,true);
}
},">":function(_45a,part){
var elem,_45d=typeof part==="string",i=0,l=_45a.length;
if(_45d&&!_411.test(part)){
part=part.toLowerCase();
for(;i<l;i++){
elem=_45a[i];
if(elem){
var _460=elem.parentNode;
_45a[i]=_460.nodeName.toLowerCase()===part?_460:false;
}
}
}else{
for(;i<l;i++){
elem=_45a[i];
if(elem){
_45a[i]=_45d?elem.parentNode:elem.parentNode===part;
}
}
if(_45d){
_412.filter(part,_45a,true);
}
}
},"":function(_461,part,_463){
var _464,_465=done++,_466=dirCheck;
if(typeof part==="string"&&!_411.test(part)){
part=part.toLowerCase();
_464=part;
_466=dirNodeCheck;
}
_466("parentNode",part,_465,_461,_464,_463);
},"~":function(_467,part,_469){
var _46a,_46b=done++,_46c=dirCheck;
if(typeof part==="string"&&!_411.test(part)){
part=part.toLowerCase();
_46a=part;
_46c=dirNodeCheck;
}
_46c("previousSibling",part,_46b,_467,_46a,_469);
}},find:{ID:function(_46d,_46e,_46f){
if(typeof _46e.getElementById!=="undefined"&&!_46f){
var m=_46e.getElementById(_46d[1]);
return m&&m.parentNode?[m]:[];
}
},NAME:function(_471,_472){
if(typeof _472.getElementsByName!=="undefined"){
var ret=[],_474=_472.getElementsByName(_471[1]);
for(var i=0,l=_474.length;i<l;i++){
if(_474[i].getAttribute("name")===_471[1]){
ret.push(_474[i]);
}
}
return ret.length===0?null:ret;
}
},TAG:function(_477,_478){
if(typeof _478.getElementsByTagName!=="undefined"){
return _478.getElementsByTagName(_477[1]);
}
}},preFilter:{CLASS:function(_479,_47a,_47b,_47c,not,_47e){
_479=" "+_479[1].replace(_40f,"")+" ";
if(_47e){
return _479;
}
for(var i=0,elem;(elem=_47a[i])!=null;i++){
if(elem){
if(not^(elem.className&&(" "+elem.className+" ").replace(/[\t\n\r]/g," ").indexOf(_479)>=0)){
if(!_47b){
_47c.push(elem);
}
}else{
if(_47b){
_47a[i]=false;
}
}
}
}
return false;
},ID:function(_481){
return _481[1].replace(_40f,"");
},TAG:function(_482,_483){
return _482[1].replace(_40f,"").toLowerCase();
},CHILD:function(_484){
if(_484[1]==="nth"){
if(!_484[2]){
_412.error(_484[0]);
}
_484[2]=_484[2].replace(/^\+|\s*/g,"");
var test=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(_484[2]==="even"&&"2n"||_484[2]==="odd"&&"2n+1"||!/\D/.test(_484[2])&&"0n+"+_484[2]||_484[2]);
_484[2]=(test[1]+(test[2]||1))-0;
_484[3]=test[3]-0;
}else{
if(_484[2]){
_412.error(_484[0]);
}
}
_484[0]=done++;
return _484;
},ATTR:function(_486,_487,_488,_489,not,_48b){
var name=_486[1]=_486[1].replace(_40f,"");
if(!_48b&&Expr.attrMap[name]){
_486[1]=Expr.attrMap[name];
}
_486[4]=(_486[4]||_486[5]||"").replace(_40f,"");
if(_486[2]==="~="){
_486[4]=" "+_486[4]+" ";
}
return _486;
},PSEUDO:function(_48d,_48e,_48f,_490,not){
if(_48d[1]==="not"){
if((_409.exec(_48d[3])||"").length>1||/^\w/.test(_48d[3])){
_48d[3]=_412(_48d[3],null,null,_48e);
}else{
var ret=_412.filter(_48d[3],_48e,_48f,true^not);
if(!_48f){
_490.push.apply(_490,ret);
}
return false;
}
}else{
if(Expr.match.POS.test(_48d[0])||Expr.match.CHILD.test(_48d[0])){
return true;
}
}
return _48d;
},POS:function(_493){
_493.unshift(true);
return _493;
}},filters:{enabled:function(elem){
return elem.disabled===false&&elem.type!=="hidden";
},disabled:function(elem){
return elem.disabled===true;
},checked:function(elem){
return elem.checked===true;
},selected:function(elem){
if(elem.parentNode){
elem.parentNode.selectedIndex;
}
return elem.selected===true;
},parent:function(elem){
return !!elem.firstChild;
},empty:function(elem){
return !elem.firstChild;
},has:function(elem,i,_49c){
return !!_412(_49c[3],elem).length;
},header:function(elem){
return (/h\d/i).test(elem.nodeName);
},text:function(elem){
var attr=elem.getAttribute("type"),type=elem.type;
return elem.nodeName.toLowerCase()==="input"&&"text"===type&&(attr===type||attr===null);
},radio:function(elem){
return elem.nodeName.toLowerCase()==="input"&&"radio"===elem.type;
},checkbox:function(elem){
return elem.nodeName.toLowerCase()==="input"&&"checkbox"===elem.type;
},file:function(elem){
return elem.nodeName.toLowerCase()==="input"&&"file"===elem.type;
},password:function(elem){
return elem.nodeName.toLowerCase()==="input"&&"password"===elem.type;
},submit:function(elem){
var name=elem.nodeName.toLowerCase();
return (name==="input"||name==="button")&&"submit"===elem.type;
},image:function(elem){
return elem.nodeName.toLowerCase()==="input"&&"image"===elem.type;
},reset:function(elem){
var name=elem.nodeName.toLowerCase();
return (name==="input"||name==="button")&&"reset"===elem.type;
},button:function(elem){
var name=elem.nodeName.toLowerCase();
return name==="input"&&"button"===elem.type||name==="button";
},input:function(elem){
return (/input|select|textarea|button/i).test(elem.nodeName);
},focus:function(elem){
return elem===elem.ownerDocument.activeElement;
}},setFilters:{first:function(elem,i){
return i===0;
},last:function(elem,i,_4b2,_4b3){
return i===_4b3.length-1;
},even:function(elem,i){
return i%2===0;
},odd:function(elem,i){
return i%2===1;
},lt:function(elem,i,_4ba){
return i<_4ba[3]-0;
},gt:function(elem,i,_4bd){
return i>_4bd[3]-0;
},nth:function(elem,i,_4c0){
return _4c0[3]-0===i;
},eq:function(elem,i,_4c3){
return _4c3[3]-0===i;
}},filter:{PSEUDO:function(elem,_4c5,i,_4c7){
var name=_4c5[1],_4c9=Expr.filters[name];
if(_4c9){
return _4c9(elem,i,_4c5,_4c7);
}else{
if(name==="contains"){
return (elem.textContent||elem.innerText||_44a([elem])||"").indexOf(_4c5[3])>=0;
}else{
if(name==="not"){
var not=_4c5[3];
for(var j=0,l=not.length;j<l;j++){
if(not[j]===elem){
return false;
}
}
return true;
}else{
_412.error(name);
}
}
}
},CHILD:function(elem,_4ce){
var _4cf,last,_4d1,_4d2,_4d3,_4d4,diff,type=_4ce[1],node=elem;
switch(type){
case "only":
case "first":
while((node=node.previousSibling)){
if(node.nodeType===1){
return false;
}
}
if(type==="first"){
return true;
}
node=elem;
case "last":
while((node=node.nextSibling)){
if(node.nodeType===1){
return false;
}
}
return true;
case "nth":
_4cf=_4ce[2];
last=_4ce[3];
if(_4cf===1&&last===0){
return true;
}
_4d1=_4ce[0];
_4d2=elem.parentNode;
if(_4d2&&(_4d2[_40a]!==_4d1||!elem.nodeIndex)){
_4d4=0;
for(node=_4d2.firstChild;node;node=node.nextSibling){
if(node.nodeType===1){
node.nodeIndex=++_4d4;
}
}
_4d2[_40a]=_4d1;
}
diff=elem.nodeIndex-last;
if(_4cf===0){
return diff===0;
}else{
return (diff%_4cf===0&&diff/_4cf>=0);
}
}
},ID:function(elem,_4d9){
return elem.nodeType===1&&elem.getAttribute("id")===_4d9;
},TAG:function(elem,_4db){
return (_4db==="*"&&elem.nodeType===1)||!!elem.nodeName&&elem.nodeName.toLowerCase()===_4db;
},CLASS:function(elem,_4dd){
return (" "+(elem.className||elem.getAttribute("class"))+" ").indexOf(_4dd)>-1;
},ATTR:function(elem,_4df){
var name=_4df[1],_4e1=_412.attr?_412.attr(elem,name):Expr.attrHandle[name]?Expr.attrHandle[name](elem):elem[name]!=null?elem[name]:elem.getAttribute(name),_4e2=_4e1+"",type=_4df[2],_4e4=_4df[4];
return _4e1==null?type==="!=":!type&&_412.attr?_4e1!=null:type==="="?_4e2===_4e4:type==="*="?_4e2.indexOf(_4e4)>=0:type==="~="?(" "+_4e2+" ").indexOf(_4e4)>=0:!_4e4?_4e2&&_4e1!==false:type==="!="?_4e2!==_4e4:type==="^="?_4e2.indexOf(_4e4)===0:type==="$="?_4e2.substr(_4e2.length-_4e4.length)===_4e4:type==="|="?_4e2===_4e4||_4e2.substr(0,_4e4.length+1)===_4e4+"-":false;
},POS:function(elem,_4e6,i,_4e8){
var name=_4e6[2],_4ea=Expr.setFilters[name];
if(_4ea){
return _4ea(elem,i,_4e6,_4e8);
}
}}};
var _424=Expr.match.POS,_4eb=function(all,num){
return "\\"+(num-0+1);
};
for(var type in Expr.match){
Expr.match[type]=new RegExp(Expr.match[type].source+(/(?![^\[]*\])(?![^\(]*\))/.source));
Expr.leftMatch[type]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Expr.match[type].source.replace(/\\(\d+)/g,_4eb));
}
var _427=function(_4ef,_4f0){
_4ef=Array.prototype.slice.call(_4ef,0);
if(_4f0){
_4f0.push.apply(_4f0,_4ef);
return _4f0;
}
return _4ef;
};
try{
Array.prototype.slice.call(_167.documentElement.childNodes,0)[0].nodeType;
}
catch(e){
_427=function(_4f1,_4f2){
var i=0,ret=_4f2||[];
if(_40c.call(_4f1)==="[object Array]"){
Array.prototype.push.apply(ret,_4f1);
}else{
if(typeof _4f1.length==="number"){
for(var l=_4f1.length;i<l;i++){
ret.push(_4f1[i]);
}
}else{
for(;_4f1[i];i++){
ret.push(_4f1[i]);
}
}
}
return ret;
};
}
var _429,_4f6;
if(_167.documentElement.compareDocumentPosition){
_429=function(a,b){
if(a===b){
_40d=true;
return 0;
}
if(!a.compareDocumentPosition||!b.compareDocumentPosition){
return a.compareDocumentPosition?-1:1;
}
return a.compareDocumentPosition(b)&4?-1:1;
};
}else{
_429=function(a,b){
if(a===b){
_40d=true;
return 0;
}else{
if(a.sourceIndex&&b.sourceIndex){
return a.sourceIndex-b.sourceIndex;
}
}
var al,bl,ap=[],bp=[],aup=a.parentNode,bup=b.parentNode,cur=aup;
if(aup===bup){
return _4f6(a,b);
}else{
if(!aup){
return -1;
}else{
if(!bup){
return 1;
}
}
}
while(cur){
ap.unshift(cur);
cur=cur.parentNode;
}
cur=bup;
while(cur){
bp.unshift(cur);
cur=cur.parentNode;
}
al=ap.length;
bl=bp.length;
for(var i=0;i<al&&i<bl;i++){
if(ap[i]!==bp[i]){
return _4f6(ap[i],bp[i]);
}
}
return i===al?_4f6(a,bp[i],-1):_4f6(ap[i],b,1);
};
_4f6=function(a,b,ret){
if(a===b){
return ret;
}
var cur=a.nextSibling;
while(cur){
if(cur===b){
return -1;
}
cur=cur.nextSibling;
}
return 1;
};
}
(function(){
var form=_167.createElement("div"),id="script"+(new Date()).getTime(),root=_167.documentElement;
form.innerHTML="<a name='"+id+"'/>";
root.insertBefore(form,root.firstChild);
if(_167.getElementById(id)){
Expr.find.ID=function(_50a,_50b,_50c){
if(typeof _50b.getElementById!=="undefined"&&!_50c){
var m=_50b.getElementById(_50a[1]);
return m?m.id===_50a[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===_50a[1]?[m]:_166:[];
}
};
Expr.filter.ID=function(elem,_50f){
var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");
return elem.nodeType===1&&node&&node.nodeValue===_50f;
};
}
root.removeChild(form);
root=form=null;
})();
(function(){
var div=_167.createElement("div");
div.appendChild(_167.createComment(""));
if(div.getElementsByTagName("*").length>0){
Expr.find.TAG=function(_512,_513){
var _514=_513.getElementsByTagName(_512[1]);
if(_512[1]==="*"){
var tmp=[];
for(var i=0;_514[i];i++){
if(_514[i].nodeType===1){
tmp.push(_514[i]);
}
}
_514=tmp;
}
return _514;
};
}
div.innerHTML="<a href='#'></a>";
if(div.firstChild&&typeof div.firstChild.getAttribute!=="undefined"&&div.firstChild.getAttribute("href")!=="#"){
Expr.attrHandle.href=function(elem){
return elem.getAttribute("href",2);
};
}
div=null;
})();
if(_167.querySelectorAll){
(function(){
var _518=_412,div=_167.createElement("div"),id="__sizzle__";
div.innerHTML="<p class='TEST'></p>";
if(div.querySelectorAll&&div.querySelectorAll(".TEST").length===0){
return;
}
_412=function(_51b,_51c,_51d,seed){
_51c=_51c||_167;
if(!seed&&!_412.isXML(_51c)){
var _51f=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(_51b);
if(_51f&&(_51c.nodeType===1||_51c.nodeType===9)){
if(_51f[1]){
return _427(_51c.getElementsByTagName(_51b),_51d);
}else{
if(_51f[2]&&Expr.find.CLASS&&_51c.getElementsByClassName){
return _427(_51c.getElementsByClassName(_51f[2]),_51d);
}
}
}
if(_51c.nodeType===9){
if(_51b==="body"&&_51c.body){
return _427([_51c.body],_51d);
}else{
if(_51f&&_51f[3]){
var elem=_51c.getElementById(_51f[3]);
if(elem&&elem.parentNode){
if(elem.id===_51f[3]){
return _427([elem],_51d);
}
}else{
return _427([],_51d);
}
}
}
try{
return _427(_51c.querySelectorAll(_51b),_51d);
}
catch(qsaError){
}
}else{
if(_51c.nodeType===1&&_51c.nodeName.toLowerCase()!=="object"){
var _521=_51c,old=_51c.getAttribute("id"),nid=old||id,_524=_51c.parentNode,_525=/^\s*[+~]/.test(_51b);
if(!old){
_51c.setAttribute("id",nid);
}else{
nid=nid.replace(/'/g,"\\$&");
}
if(_525&&_524){
_51c=_51c.parentNode;
}
try{
if(!_525||_524){
return _427(_51c.querySelectorAll("[id='"+nid+"'] "+_51b),_51d);
}
}
catch(pseudoError){
}
finally{
if(!old){
_521.removeAttribute("id");
}
}
}
}
}
return _518(_51b,_51c,_51d,seed);
};
for(var prop in _518){
_412[prop]=_518[prop];
}
div=null;
})();
}
(function(){
var html=_167.documentElement,_528=html.matchesSelector||html.mozMatchesSelector||html.webkitMatchesSelector||html.msMatchesSelector;
if(_528){
var _529=!_528.call(_167.createElement("div"),"div"),_52a=false;
try{
_528.call(_167.documentElement,"[test!='']:sizzle");
}
catch(pseudoError){
_52a=true;
}
_412.matchesSelector=function(node,expr){
expr=expr.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");
if(!_412.isXML(node)){
try{
if(_52a||!Expr.match.PSEUDO.test(expr)&&!/!=/.test(expr)){
var ret=_528.call(node,expr);
if(ret||!_529||node.document&&node.document.nodeType!==11){
return ret;
}
}
}
catch(e){
}
}
return _412(expr,null,null,[node]).length>0;
};
}
})();
(function(){
var div=_167.createElement("div");
div.innerHTML="<div class='test e'></div><div class='test'></div>";
if(!div.getElementsByClassName||div.getElementsByClassName("e").length===0){
return;
}
div.lastChild.className="e";
if(div.getElementsByClassName("e").length===1){
return;
}
Expr.order.splice(1,0,"CLASS");
Expr.find.CLASS=function(_52f,_530,_531){
if(typeof _530.getElementsByClassName!=="undefined"&&!_531){
return _530.getElementsByClassName(_52f[1]);
}
};
div=null;
})();
function dirNodeCheck(dir,cur,_534,_535,_536,_537){
for(var i=0,l=_535.length;i<l;i++){
var elem=_535[i];
if(elem){
var _53b=false;
elem=elem[dir];
while(elem){
if(elem[_40a]===_534){
_53b=_535[elem.sizset];
break;
}
if(elem.nodeType===1&&!_537){
elem[_40a]=_534;
elem.sizset=i;
}
if(elem.nodeName.toLowerCase()===cur){
_53b=elem;
break;
}
elem=elem[dir];
}
_535[i]=_53b;
}
}
}
function dirCheck(dir,cur,_53e,_53f,_540,_541){
for(var i=0,l=_53f.length;i<l;i++){
var elem=_53f[i];
if(elem){
var _545=false;
elem=elem[dir];
while(elem){
if(elem[_40a]===_53e){
_545=_53f[elem.sizset];
break;
}
if(elem.nodeType===1){
if(!_541){
elem[_40a]=_53e;
elem.sizset=i;
}
if(typeof cur!=="string"){
if(elem===cur){
_545=true;
break;
}
}else{
if(_412.filter(cur,[elem]).length>0){
_545=elem;
break;
}
}
}
elem=elem[dir];
}
_53f[i]=_545;
}
}
}
if(_167.documentElement.contains){
_412.contains=function(a,b){
return a!==b&&(a.contains?a.contains(b):true);
};
}else{
if(_167.documentElement.compareDocumentPosition){
_412.contains=function(a,b){
return !!(a.compareDocumentPosition(b)&16);
};
}else{
_412.contains=function(){
return false;
};
}
}
_412.isXML=function(elem){
var _54b=(elem?elem.ownerDocument||elem:0).documentElement;
return _54b?_54b.nodeName!=="HTML":false;
};
var _426=function(_54c,_54d,seed){
var _54f,_550=[],_551="",root=_54d.nodeType?[_54d]:_54d;
while((_54f=Expr.match.PSEUDO.exec(_54c))){
_551+=_54f[0];
_54c=_54c.replace(Expr.match.PSEUDO,"");
}
_54c=Expr.relative[_54c]?_54c+"*":_54c;
for(var i=0,l=root.length;i<l;i++){
_412(_54c,root[i],_550,seed);
}
return _412.filter(_551,_550);
};
_412.attr=_16a.attr;
_412.selectors.attrMap={};
_16a.find=_412;
_16a.expr=_412.selectors;
_16a.expr[":"]=_16a.expr.filters;
_16a.unique=_412.uniqueSort;
_16a.text=_412.getText;
_16a.isXMLDoc=_412.isXML;
_16a.contains=_412.contains;
})();
var _555=/Until$/,_556=/^(?:parents|prevUntil|prevAll)/,_557=/,/,_558=/^.[^:#\[\.,]*$/,_559=Array.prototype.slice,POS=_16a.expr.match.POS,_55b={children:true,contents:true,next:true,prev:true};
_16a.fn.extend({find:function(_55c){
var self=this,i,l;
if(typeof _55c!=="string"){
return _16a(_55c).filter(function(){
for(i=0,l=self.length;i<l;i++){
if(_16a.contains(self[i],this)){
return true;
}
}
});
}
var ret=this.pushStack("","find",_55c),_561,n,r;
for(i=0,l=this.length;i<l;i++){
_561=ret.length;
_16a.find(_55c,this[i],ret);
if(i>0){
for(n=_561;n<ret.length;n++){
for(r=0;r<_561;r++){
if(ret[r]===ret[n]){
ret.splice(n--,1);
break;
}
}
}
}
}
return ret;
},has:function(_564){
var _565=_16a(_564);
return this.filter(function(){
for(var i=0,l=_565.length;i<l;i++){
if(_16a.contains(this,_565[i])){
return true;
}
}
});
},not:function(_568){
return this.pushStack(winnow(this,_568,false),"not",_568);
},filter:function(_569){
return this.pushStack(winnow(this,_569,true),"filter",_569);
},is:function(_56a){
return !!_56a&&(typeof _56a==="string"?POS.test(_56a)?_16a(_56a,this.context).index(this[0])>=0:_16a.filter(_56a,this).length>0:this.filter(_56a).length>0);
},closest:function(_56b,_56c){
var ret=[],i,l,cur=this[0];
if(_16a.isArray(_56b)){
var _571=1;
while(cur&&cur.ownerDocument&&cur!==_56c){
for(i=0;i<_56b.length;i++){
if(_16a(cur).is(_56b[i])){
ret.push({selector:_56b[i],elem:cur,level:_571});
}
}
cur=cur.parentNode;
_571++;
}
return ret;
}
var pos=POS.test(_56b)||typeof _56b!=="string"?_16a(_56b,_56c||this.context):0;
for(i=0,l=this.length;i<l;i++){
cur=this[i];
while(cur){
if(pos?pos.index(cur)>-1:_16a.find.matchesSelector(cur,_56b)){
ret.push(cur);
break;
}else{
cur=cur.parentNode;
if(!cur||!cur.ownerDocument||cur===_56c||cur.nodeType===11){
break;
}
}
}
}
ret=ret.length>1?_16a.unique(ret):ret;
return this.pushStack(ret,"closest",_56b);
},index:function(elem){
if(!elem){
return (this[0]&&this[0].parentNode)?this.prevAll().length:-1;
}
if(typeof elem==="string"){
return _16a.inArray(this[0],_16a(elem));
}
return _16a.inArray(elem.jquery?elem[0]:elem,this);
},add:function(_574,_575){
var set=typeof _574==="string"?_16a(_574,_575):_16a.makeArray(_574&&_574.nodeType?[_574]:_574),all=_16a.merge(this.get(),set);
return this.pushStack(isDisconnected(set[0])||isDisconnected(all[0])?all:_16a.unique(all));
},andSelf:function(){
return this.add(this.prevObject);
}});
function isDisconnected(node){
return !node||!node.parentNode||node.parentNode.nodeType===11;
}
_16a.each({parent:function(elem){
var _57a=elem.parentNode;
return _57a&&_57a.nodeType!==11?_57a:null;
},parents:function(elem){
return _16a.dir(elem,"parentNode");
},parentsUntil:function(elem,i,_57e){
return _16a.dir(elem,"parentNode",_57e);
},next:function(elem){
return _16a.nth(elem,2,"nextSibling");
},prev:function(elem){
return _16a.nth(elem,2,"previousSibling");
},nextAll:function(elem){
return _16a.dir(elem,"nextSibling");
},prevAll:function(elem){
return _16a.dir(elem,"previousSibling");
},nextUntil:function(elem,i,_585){
return _16a.dir(elem,"nextSibling",_585);
},prevUntil:function(elem,i,_588){
return _16a.dir(elem,"previousSibling",_588);
},siblings:function(elem){
return _16a.sibling(elem.parentNode.firstChild,elem);
},children:function(elem){
return _16a.sibling(elem.firstChild);
},contents:function(elem){
return _16a.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:_16a.makeArray(elem.childNodes);
}},function(name,fn){
_16a.fn[name]=function(_58e,_58f){
var ret=_16a.map(this,fn,_58e);
if(!_555.test(name)){
_58f=_58e;
}
if(_58f&&typeof _58f==="string"){
ret=_16a.filter(_58f,ret);
}
ret=this.length>1&&!_55b[name]?_16a.unique(ret):ret;
if((this.length>1||_557.test(_58f))&&_556.test(name)){
ret=ret.reverse();
}
return this.pushStack(ret,name,_559.call(arguments).join(","));
};
});
_16a.extend({filter:function(expr,_592,not){
if(not){
expr=":not("+expr+")";
}
return _592.length===1?_16a.find.matchesSelector(_592[0],expr)?[_592[0]]:[]:_16a.find.matches(expr,_592);
},dir:function(elem,dir,_596){
var _597=[],cur=elem[dir];
while(cur&&cur.nodeType!==9&&(_596===_166||cur.nodeType!==1||!_16a(cur).is(_596))){
if(cur.nodeType===1){
_597.push(cur);
}
cur=cur[dir];
}
return _597;
},nth:function(cur,_59a,dir,elem){
_59a=_59a||1;
var num=0;
for(;cur;cur=cur[dir]){
if(cur.nodeType===1&&++num===_59a){
break;
}
}
return cur;
},sibling:function(n,elem){
var r=[];
for(;n;n=n.nextSibling){
if(n.nodeType===1&&n!==elem){
r.push(n);
}
}
return r;
}});
function winnow(_5a1,_5a2,keep){
_5a2=_5a2||0;
if(_16a.isFunction(_5a2)){
return _16a.grep(_5a1,function(elem,i){
var _5a6=!!_5a2.call(elem,i,elem);
return _5a6===keep;
});
}else{
if(_5a2.nodeType){
return _16a.grep(_5a1,function(elem,i){
return (elem===_5a2)===keep;
});
}else{
if(typeof _5a2==="string"){
var _5a9=_16a.grep(_5a1,function(elem){
return elem.nodeType===1;
});
if(_558.test(_5a2)){
return _16a.filter(_5a2,_5a9,!keep);
}else{
_5a2=_16a.filter(_5a2,_5a9);
}
}
}
}
return _16a.grep(_5a1,function(elem,i){
return (_16a.inArray(elem,_5a2)>=0)===keep;
});
}
function createSafeFragment(_5ad){
var list=_5af.split("|"),_5b0=_5ad.createDocumentFragment();
if(_5b0.createElement){
while(list.length){
_5b0.createElement(list.pop());
}
}
return _5b0;
}
var _5af="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|"+"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",_5b1=/ jQuery\d+="(?:\d+|null)"/g,_5b2=/^\s+/,_5b3=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,_5b4=/<([\w:]+)/,_5b5=/<tbody/i,_5b6=/<|&#?\w+;/,_5b7=/<(?:script|style)/i,_5b8=/<(?:script|object|embed|option|style)/i,_5b9=new RegExp("<(?:"+_5af+")","i"),_5ba=/checked\s*(?:[^=]|=\s*.checked.)/i,_5bb=/\/(java|ecma)script/i,_5bc=/^\s*<!(?:\[CDATA\[|\-\-)/,_5bd={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},_5be=createSafeFragment(_167);
_5bd.optgroup=_5bd.option;
_5bd.tbody=_5bd.tfoot=_5bd.colgroup=_5bd.caption=_5bd.thead;
_5bd.th=_5bd.td;
if(!_16a.support.htmlSerialize){
_5bd._default=[1,"div<div>","</div>"];
}
_16a.fn.extend({text:function(text){
if(_16a.isFunction(text)){
return this.each(function(i){
var self=_16a(this);
self.text(text.call(this,i,self.text()));
});
}
if(typeof text!=="object"&&text!==_166){
return this.empty().append((this[0]&&this[0].ownerDocument||_167).createTextNode(text));
}
return _16a.text(this);
},wrapAll:function(html){
if(_16a.isFunction(html)){
return this.each(function(i){
_16a(this).wrapAll(html.call(this,i));
});
}
if(this[0]){
var wrap=_16a(html,this[0].ownerDocument).eq(0).clone(true);
if(this[0].parentNode){
wrap.insertBefore(this[0]);
}
wrap.map(function(){
var elem=this;
while(elem.firstChild&&elem.firstChild.nodeType===1){
elem=elem.firstChild;
}
return elem;
}).append(this);
}
return this;
},wrapInner:function(html){
if(_16a.isFunction(html)){
return this.each(function(i){
_16a(this).wrapInner(html.call(this,i));
});
}
return this.each(function(){
var self=_16a(this),_5c9=self.contents();
if(_5c9.length){
_5c9.wrapAll(html);
}else{
self.append(html);
}
});
},wrap:function(html){
var _5cb=_16a.isFunction(html);
return this.each(function(i){
_16a(this).wrapAll(_5cb?html.call(this,i):html);
});
},unwrap:function(){
return this.parent().each(function(){
if(!_16a.nodeName(this,"body")){
_16a(this).replaceWith(this.childNodes);
}
}).end();
},append:function(){
return this.domManip(arguments,true,function(elem){
if(this.nodeType===1){
this.appendChild(elem);
}
});
},prepend:function(){
return this.domManip(arguments,true,function(elem){
if(this.nodeType===1){
this.insertBefore(elem,this.firstChild);
}
});
},before:function(){
if(this[0]&&this[0].parentNode){
return this.domManip(arguments,false,function(elem){
this.parentNode.insertBefore(elem,this);
});
}else{
if(arguments.length){
var set=_16a.clean(arguments);
set.push.apply(set,this.toArray());
return this.pushStack(set,"before",arguments);
}
}
},after:function(){
if(this[0]&&this[0].parentNode){
return this.domManip(arguments,false,function(elem){
this.parentNode.insertBefore(elem,this.nextSibling);
});
}else{
if(arguments.length){
var set=this.pushStack(this,"after",arguments);
set.push.apply(set,_16a.clean(arguments));
return set;
}
}
},remove:function(_5d3,_5d4){
for(var i=0,elem;(elem=this[i])!=null;i++){
if(!_5d3||_16a.filter(_5d3,[elem]).length){
if(!_5d4&&elem.nodeType===1){
_16a.cleanData(elem.getElementsByTagName("*"));
_16a.cleanData([elem]);
}
if(elem.parentNode){
elem.parentNode.removeChild(elem);
}
}
}
return this;
},empty:function(){
for(var i=0,elem;(elem=this[i])!=null;i++){
if(elem.nodeType===1){
_16a.cleanData(elem.getElementsByTagName("*"));
}
while(elem.firstChild){
elem.removeChild(elem.firstChild);
}
}
return this;
},clone:function(_5d9,_5da){
_5d9=_5d9==null?false:_5d9;
_5da=_5da==null?_5d9:_5da;
return this.map(function(){
return _16a.clone(this,_5d9,_5da);
});
},html:function(_5db){
if(_5db===_166){
return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(_5b1,""):null;
}else{
if(typeof _5db==="string"&&!_5b7.test(_5db)&&(_16a.support.leadingWhitespace||!_5b2.test(_5db))&&!_5bd[(_5b4.exec(_5db)||["",""])[1].toLowerCase()]){
_5db=_5db.replace(_5b3,"<$1></$2>");
try{
for(var i=0,l=this.length;i<l;i++){
if(this[i].nodeType===1){
_16a.cleanData(this[i].getElementsByTagName("*"));
this[i].innerHTML=_5db;
}
}
}
catch(e){
this.empty().append(_5db);
}
}else{
if(_16a.isFunction(_5db)){
this.each(function(i){
var self=_16a(this);
self.html(_5db.call(this,i,self.html()));
});
}else{
this.empty().append(_5db);
}
}
}
return this;
},replaceWith:function(_5e0){
if(this[0]&&this[0].parentNode){
if(_16a.isFunction(_5e0)){
return this.each(function(i){
var self=_16a(this),old=self.html();
self.replaceWith(_5e0.call(this,i,old));
});
}
if(typeof _5e0!=="string"){
_5e0=_16a(_5e0).detach();
}
return this.each(function(){
var next=this.nextSibling,_5e5=this.parentNode;
_16a(this).remove();
if(next){
_16a(next).before(_5e0);
}else{
_16a(_5e5).append(_5e0);
}
});
}else{
return this.length?this.pushStack(_16a(_16a.isFunction(_5e0)?_5e0():_5e0),"replaceWith",_5e0):this;
}
},detach:function(_5e6){
return this.remove(_5e6,true);
},domManip:function(args,_5e8,_5e9){
var _5ea,_5eb,_5ec,_5ed,_5ee=args[0],_5ef=[];
if(!_16a.support.checkClone&&arguments.length===3&&typeof _5ee==="string"&&_5ba.test(_5ee)){
return this.each(function(){
_16a(this).domManip(args,_5e8,_5e9,true);
});
}
if(_16a.isFunction(_5ee)){
return this.each(function(i){
var self=_16a(this);
args[0]=_5ee.call(this,i,_5e8?self.html():_166);
self.domManip(args,_5e8,_5e9);
});
}
if(this[0]){
_5ed=_5ee&&_5ee.parentNode;
if(_16a.support.parentNode&&_5ed&&_5ed.nodeType===11&&_5ed.childNodes.length===this.length){
_5ea={fragment:_5ed};
}else{
_5ea=_16a.buildFragment(args,this,_5ef);
}
_5ec=_5ea.fragment;
if(_5ec.childNodes.length===1){
_5eb=_5ec=_5ec.firstChild;
}else{
_5eb=_5ec.firstChild;
}
if(_5eb){
_5e8=_5e8&&_16a.nodeName(_5eb,"tr");
for(var i=0,l=this.length,_5f4=l-1;i<l;i++){
_5e9.call(_5e8?root(this[i],_5eb):this[i],_5ea.cacheable||(l>1&&i<_5f4)?_16a.clone(_5ec,true,true):_5ec);
}
}
if(_5ef.length){
_16a.each(_5ef,evalScript);
}
}
return this;
}});
function root(elem,cur){
return _16a.nodeName(elem,"table")?(elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody"))):elem;
}
function cloneCopyEvent(src,dest){
if(dest.nodeType!==1||!_16a.hasData(src)){
return;
}
var type,i,l,_5fc=_16a._data(src),_5fd=_16a._data(dest,_5fc),_5fe=_5fc.events;
if(_5fe){
delete _5fd.handle;
_5fd.events={};
for(type in _5fe){
for(i=0,l=_5fe[type].length;i<l;i++){
_16a.event.add(dest,type+(_5fe[type][i].namespace?".":"")+_5fe[type][i].namespace,_5fe[type][i],_5fe[type][i].data);
}
}
}
if(_5fd.data){
_5fd.data=_16a.extend({},_5fd.data);
}
}
function cloneFixAttributes(src,dest){
var _601;
if(dest.nodeType!==1){
return;
}
if(dest.clearAttributes){
dest.clearAttributes();
}
if(dest.mergeAttributes){
dest.mergeAttributes(src);
}
_601=dest.nodeName.toLowerCase();
if(_601==="object"){
dest.outerHTML=src.outerHTML;
}else{
if(_601==="input"&&(src.type==="checkbox"||src.type==="radio")){
if(src.checked){
dest.defaultChecked=dest.checked=src.checked;
}
if(dest.value!==src.value){
dest.value=src.value;
}
}else{
if(_601==="option"){
dest.selected=src.defaultSelected;
}else{
if(_601==="input"||_601==="textarea"){
dest.defaultValue=src.defaultValue;
}
}
}
}
dest.removeAttribute(_16a.expando);
}
_16a.buildFragment=function(args,_603,_604){
var _605,_606,_607,doc,_609=args[0];
if(_603&&_603[0]){
doc=_603[0].ownerDocument||_603[0];
}
if(!doc.createDocumentFragment){
doc=_167;
}
if(args.length===1&&typeof _609==="string"&&_609.length<512&&doc===_167&&_609.charAt(0)==="<"&&!_5b8.test(_609)&&(_16a.support.checkClone||!_5ba.test(_609))&&(_16a.support.html5Clone||!_5b9.test(_609))){
_606=true;
_607=_16a.fragments[_609];
if(_607&&_607!==1){
_605=_607;
}
}
if(!_605){
_605=doc.createDocumentFragment();
_16a.clean(args,doc,_605,_604);
}
if(_606){
_16a.fragments[_609]=_607?_605:1;
}
return {fragment:_605,cacheable:_606};
};
_16a.fragments={};
_16a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,_60b){
_16a.fn[name]=function(_60c){
var ret=[],_60e=_16a(_60c),_60f=this.length===1&&this[0].parentNode;
if(_60f&&_60f.nodeType===11&&_60f.childNodes.length===1&&_60e.length===1){
_60e[_60b](this[0]);
return this;
}else{
for(var i=0,l=_60e.length;i<l;i++){
var _612=(i>0?this.clone(true):this).get();
_16a(_60e[i])[_60b](_612);
ret=ret.concat(_612);
}
return this.pushStack(ret,name,_60e.selector);
}
};
});
function getAll(elem){
if(typeof elem.getElementsByTagName!=="undefined"){
return elem.getElementsByTagName("*");
}else{
if(typeof elem.querySelectorAll!=="undefined"){
return elem.querySelectorAll("*");
}else{
return [];
}
}
}
function fixDefaultChecked(elem){
if(elem.type==="checkbox"||elem.type==="radio"){
elem.defaultChecked=elem.checked;
}
}
function findInputs(elem){
var _616=(elem.nodeName||"").toLowerCase();
if(_616==="input"){
fixDefaultChecked(elem);
}else{
if(_616!=="script"&&typeof elem.getElementsByTagName!=="undefined"){
_16a.grep(elem.getElementsByTagName("input"),fixDefaultChecked);
}
}
}
function shimCloneNode(elem){
var div=_167.createElement("div");
_5be.appendChild(div);
div.innerHTML=elem.outerHTML;
return div.firstChild;
}
_16a.extend({clone:function(elem,_61a,_61b){
var _61c,_61d,i,_61f=_16a.support.html5Clone||!_5b9.test("<"+elem.nodeName)?elem.cloneNode(true):shimCloneNode(elem);
if((!_16a.support.noCloneEvent||!_16a.support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!_16a.isXMLDoc(elem)){
cloneFixAttributes(elem,_61f);
_61c=getAll(elem);
_61d=getAll(_61f);
for(i=0;_61c[i];++i){
if(_61d[i]){
cloneFixAttributes(_61c[i],_61d[i]);
}
}
}
if(_61a){
cloneCopyEvent(elem,_61f);
if(_61b){
_61c=getAll(elem);
_61d=getAll(_61f);
for(i=0;_61c[i];++i){
cloneCopyEvent(_61c[i],_61d[i]);
}
}
}
_61c=_61d=null;
return _61f;
},clean:function(_620,_621,_622,_623){
var _624;
_621=_621||_167;
if(typeof _621.createElement==="undefined"){
_621=_621.ownerDocument||_621[0]&&_621[0].ownerDocument||_167;
}
var ret=[],j;
for(var i=0,elem;(elem=_620[i])!=null;i++){
if(typeof elem==="number"){
elem+="";
}
if(!elem){
continue;
}
if(typeof elem==="string"){
if(!_5b6.test(elem)){
elem=_621.createTextNode(elem);
}else{
elem=elem.replace(_5b3,"<$1></$2>");
var tag=(_5b4.exec(elem)||["",""])[1].toLowerCase(),wrap=_5bd[tag]||_5bd._default,_62b=wrap[0],div=_621.createElement("div");
if(_621===_167){
_5be.appendChild(div);
}else{
createSafeFragment(_621).appendChild(div);
}
div.innerHTML=wrap[1]+elem+wrap[2];
while(_62b--){
div=div.lastChild;
}
if(!_16a.support.tbody){
var _62d=_5b5.test(elem),_62e=tag==="table"&&!_62d?div.firstChild&&div.firstChild.childNodes:wrap[1]==="<table>"&&!_62d?div.childNodes:[];
for(j=_62e.length-1;j>=0;--j){
if(_16a.nodeName(_62e[j],"tbody")&&!_62e[j].childNodes.length){
_62e[j].parentNode.removeChild(_62e[j]);
}
}
}
if(!_16a.support.leadingWhitespace&&_5b2.test(elem)){
div.insertBefore(_621.createTextNode(_5b2.exec(elem)[0]),div.firstChild);
}
elem=div.childNodes;
}
}
var len;
if(!_16a.support.appendChecked){
if(elem[0]&&typeof (len=elem.length)==="number"){
for(j=0;j<len;j++){
findInputs(elem[j]);
}
}else{
findInputs(elem);
}
}
if(elem.nodeType){
ret.push(elem);
}else{
ret=_16a.merge(ret,elem);
}
}
if(_622){
_624=function(elem){
return !elem.type||_5bb.test(elem.type);
};
for(i=0;ret[i];i++){
if(_623&&_16a.nodeName(ret[i],"script")&&(!ret[i].type||ret[i].type.toLowerCase()==="text/javascript")){
_623.push(ret[i].parentNode?ret[i].parentNode.removeChild(ret[i]):ret[i]);
}else{
if(ret[i].nodeType===1){
var _631=_16a.grep(ret[i].getElementsByTagName("script"),_624);
ret.splice.apply(ret,[i+1,0].concat(_631));
}
_622.appendChild(ret[i]);
}
}
}
return ret;
},cleanData:function(_632){
var data,id,_635=_16a.cache,_636=_16a.event.special,_637=_16a.support.deleteExpando;
for(var i=0,elem;(elem=_632[i])!=null;i++){
if(elem.nodeName&&_16a.noData[elem.nodeName.toLowerCase()]){
continue;
}
id=elem[_16a.expando];
if(id){
data=_635[id];
if(data&&data.events){
for(var type in data.events){
if(_636[type]){
_16a.event.remove(elem,type);
}else{
_16a.removeEvent(elem,type,data.handle);
}
}
if(data.handle){
data.handle.elem=null;
}
}
if(_637){
delete elem[_16a.expando];
}else{
if(elem.removeAttribute){
elem.removeAttribute(_16a.expando);
}
}
delete _635[id];
}
}
}});
function evalScript(i,elem){
if(elem.src){
_16a.ajax({url:elem.src,async:false,dataType:"script"});
}else{
_16a.globalEval((elem.text||elem.textContent||elem.innerHTML||"").replace(_5bc,"/*$0*/"));
}
if(elem.parentNode){
elem.parentNode.removeChild(elem);
}
}
var _63d=/alpha\([^)]*\)/i,_63e=/opacity=([^)]*)/,_63f=/([A-Z]|^ms)/g,_640=/^-?\d+(?:px)?$/i,rnum=/^-?\d/,_642=/^([\-+])=([\-+.\de]+)/,_643={position:"absolute",visibility:"hidden",display:"block"},_644=["Left","Right"],_645=["Top","Bottom"],_646,_647,_648;
_16a.fn.css=function(name,_64a){
if(arguments.length===2&&_64a===_166){
return this;
}
return _16a.access(this,name,_64a,true,function(elem,name,_64d){
return _64d!==_166?_16a.style(elem,name,_64d):_16a.css(elem,name);
});
};
_16a.extend({cssHooks:{opacity:{get:function(elem,_64f){
if(_64f){
var ret=_646(elem,"opacity","opacity");
return ret===""?"1":ret;
}else{
return elem.style.opacity;
}
}}},cssNumber:{"fillOpacity":true,"fontWeight":true,"lineHeight":true,"opacity":true,"orphans":true,"widows":true,"zIndex":true,"zoom":true},cssProps:{"float":_16a.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,_653,_654){
if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){
return;
}
var ret,type,_657=_16a.camelCase(name),_658=elem.style,_659=_16a.cssHooks[_657];
name=_16a.cssProps[_657]||_657;
if(_653!==_166){
type=typeof _653;
if(type==="string"&&(ret=_642.exec(_653))){
_653=(+(ret[1]+1)*+ret[2])+parseFloat(_16a.css(elem,name));
type="number";
}
if(_653==null||type==="number"&&isNaN(_653)){
return;
}
if(type==="number"&&!_16a.cssNumber[_657]){
_653+="px";
}
if(!_659||!("set" in _659)||(_653=_659.set(elem,_653))!==_166){
try{
_658[name]=_653;
}
catch(e){
}
}
}else{
if(_659&&"get" in _659&&(ret=_659.get(elem,false,_654))!==_166){
return ret;
}
return _658[name];
}
},css:function(elem,name,_65c){
var ret,_65e;
name=_16a.camelCase(name);
_65e=_16a.cssHooks[name];
name=_16a.cssProps[name]||name;
if(name==="cssFloat"){
name="float";
}
if(_65e&&"get" in _65e&&(ret=_65e.get(elem,true,_65c))!==_166){
return ret;
}else{
if(_646){
return _646(elem,name);
}
}
},swap:function(elem,_660,_661){
var old={};
for(var name in _660){
old[name]=elem.style[name];
elem.style[name]=_660[name];
}
_661.call(elem);
for(name in _660){
elem.style[name]=old[name];
}
}});
_16a.curCSS=_16a.css;
_16a.each(["height","width"],function(i,name){
_16a.cssHooks[name]={get:function(elem,_667,_668){
var val;
if(_667){
if(elem.offsetWidth!==0){
return getWH(elem,name,_668);
}else{
_16a.swap(elem,_643,function(){
val=getWH(elem,name,_668);
});
}
return val;
}
},set:function(elem,_66b){
if(_640.test(_66b)){
_66b=parseFloat(_66b);
if(_66b>=0){
return _66b+"px";
}
}else{
return _66b;
}
}};
});
if(!_16a.support.opacity){
_16a.cssHooks.opacity={get:function(elem,_66d){
return _63e.test((_66d&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?(parseFloat(RegExp.$1)/100)+"":_66d?"1":"";
},set:function(elem,_66f){
var _670=elem.style,_648=elem.currentStyle,_671=_16a.isNumeric(_66f)?"alpha(opacity="+_66f*100+")":"",_672=_648&&_648.filter||_670.filter||"";
_670.zoom=1;
if(_66f>=1&&_16a.trim(_672.replace(_63d,""))===""){
_670.removeAttribute("filter");
if(_648&&!_648.filter){
return;
}
}
_670.filter=_63d.test(_672)?_672.replace(_63d,_671):_672+" "+_671;
}};
}
_16a(function(){
if(!_16a.support.reliableMarginRight){
_16a.cssHooks.marginRight={get:function(elem,_674){
var ret;
_16a.swap(elem,{"display":"inline-block"},function(){
if(_674){
ret=_646(elem,"margin-right","marginRight");
}else{
ret=elem.style.marginRight;
}
});
return ret;
}};
}
});
if(_167.defaultView&&_167.defaultView.getComputedStyle){
_647=function(elem,name){
var ret,_679,_67a;
name=name.replace(_63f,"-$1").toLowerCase();
if((_679=elem.ownerDocument.defaultView)&&(_67a=_679.getComputedStyle(elem,null))){
ret=_67a.getPropertyValue(name);
if(ret===""&&!_16a.contains(elem.ownerDocument.documentElement,elem)){
ret=_16a.style(elem,name);
}
}
return ret;
};
}
if(_167.documentElement.currentStyle){
_648=function(elem,name){
var left,_67e,_67f,ret=elem.currentStyle&&elem.currentStyle[name],_681=elem.style;
if(ret===null&&_681&&(_67f=_681[name])){
ret=_67f;
}
if(!_640.test(ret)&&rnum.test(ret)){
left=_681.left;
_67e=elem.runtimeStyle&&elem.runtimeStyle.left;
if(_67e){
elem.runtimeStyle.left=elem.currentStyle.left;
}
_681.left=name==="fontSize"?"1em":(ret||0);
ret=_681.pixelLeft+"px";
_681.left=left;
if(_67e){
elem.runtimeStyle.left=_67e;
}
}
return ret===""?"auto":ret;
};
}
_646=_647||_648;
function getWH(elem,name,_684){
var val=name==="width"?elem.offsetWidth:elem.offsetHeight,_686=name==="width"?_644:_645,i=0,len=_686.length;
if(val>0){
if(_684!=="border"){
for(;i<len;i++){
if(!_684){
val-=parseFloat(_16a.css(elem,"padding"+_686[i]))||0;
}
if(_684==="margin"){
val+=parseFloat(_16a.css(elem,_684+_686[i]))||0;
}else{
val-=parseFloat(_16a.css(elem,"border"+_686[i]+"Width"))||0;
}
}
}
return val+"px";
}
val=_646(elem,name,name);
if(val<0||val==null){
val=elem.style[name]||0;
}
val=parseFloat(val)||0;
if(_684){
for(;i<len;i++){
val+=parseFloat(_16a.css(elem,"padding"+_686[i]))||0;
if(_684!=="padding"){
val+=parseFloat(_16a.css(elem,"border"+_686[i]+"Width"))||0;
}
if(_684==="margin"){
val+=parseFloat(_16a.css(elem,_684+_686[i]))||0;
}
}
}
return val+"px";
}
if(_16a.expr&&_16a.expr.filters){
_16a.expr.filters.hidden=function(elem){
var _68a=elem.offsetWidth,_68b=elem.offsetHeight;
return (_68a===0&&_68b===0)||(!_16a.support.reliableHiddenOffsets&&((elem.style&&elem.style.display)||_16a.css(elem,"display"))==="none");
};
_16a.expr.filters.visible=function(elem){
return !_16a.expr.filters.hidden(elem);
};
}
var r20=/%20/g,_68e=/\[\]$/,_68f=/\r?\n/g,_690=/#.*$/,_691=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,_692=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,_693=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,_694=/^(?:GET|HEAD)$/,_695=/^\/\//,_696=/\?/,_697=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,_698=/^(?:select|textarea)/i,_699=/\s+/,rts=/([?&])_=[^&]*/,rurl=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,_69c=_16a.fn.load,_69d={},_69e={},_69f,_6a0,_6a1=["*/"]+["*"];
try{
_69f=_169.href;
}
catch(e){
_69f=_167.createElement("a");
_69f.href="";
_69f=_69f.href;
}
_6a0=rurl.exec(_69f.toLowerCase())||[];
function addToPrefiltersOrTransports(_6a2){
return function(_6a3,func){
if(typeof _6a3!=="string"){
func=_6a3;
_6a3="*";
}
if(_16a.isFunction(func)){
var _6a5=_6a3.toLowerCase().split(_699),i=0,_6a7=_6a5.length,_6a8,list,_6aa;
for(;i<_6a7;i++){
_6a8=_6a5[i];
_6aa=/^\+/.test(_6a8);
if(_6aa){
_6a8=_6a8.substr(1)||"*";
}
list=_6a2[_6a8]=_6a2[_6a8]||[];
list[_6aa?"unshift":"push"](func);
}
}
};
}
function inspectPrefiltersOrTransports(_6ab,_6ac,_6ad,_6ae,_6af,_6b0){
_6af=_6af||_6ac.dataTypes[0];
_6b0=_6b0||{};
_6b0[_6af]=true;
var list=_6ab[_6af],i=0,_6b3=list?list.length:0,_6b4=(_6ab===_69d),_6b5;
for(;i<_6b3&&(_6b4||!_6b5);i++){
_6b5=list[i](_6ac,_6ad,_6ae);
if(typeof _6b5==="string"){
if(!_6b4||_6b0[_6b5]){
_6b5=_166;
}else{
_6ac.dataTypes.unshift(_6b5);
_6b5=inspectPrefiltersOrTransports(_6ab,_6ac,_6ad,_6ae,_6b5,_6b0);
}
}
}
if((_6b4||!_6b5)&&!_6b0["*"]){
_6b5=inspectPrefiltersOrTransports(_6ab,_6ac,_6ad,_6ae,"*",_6b0);
}
return _6b5;
}
function ajaxExtend(_6b6,src){
var key,deep,_6ba=_16a.ajaxSettings.flatOptions||{};
for(key in src){
if(src[key]!==_166){
(_6ba[key]?_6b6:(deep||(deep={})))[key]=src[key];
}
}
if(deep){
_16a.extend(true,_6b6,deep);
}
}
_16a.fn.extend({load:function(url,_6bc,_6bd){
if(typeof url!=="string"&&_69c){
return _69c.apply(this,arguments);
}else{
if(!this.length){
return this;
}
}
var off=url.indexOf(" ");
if(off>=0){
var _6bf=url.slice(off,url.length);
url=url.slice(0,off);
}
var type="GET";
if(_6bc){
if(_16a.isFunction(_6bc)){
_6bd=_6bc;
_6bc=_166;
}else{
if(typeof _6bc==="object"){
_6bc=_16a.param(_6bc,_16a.ajaxSettings.traditional);
type="POST";
}
}
}
var self=this;
_16a.ajax({url:url,type:type,dataType:"html",data:_6bc,complete:function(_6c2,_6c3,_6c4){
_6c4=_6c2.responseText;
if(_6c2.isResolved()){
_6c2.done(function(r){
_6c4=r;
});
self.html(_6bf?_16a("<div>").append(_6c4.replace(_697,"")).find(_6bf):_6c4);
}
if(_6bd){
self.each(_6bd,[_6c4,_6c3,_6c2]);
}
}});
return this;
},serialize:function(){
return _16a.param(this.serializeArray());
},serializeArray:function(){
return this.map(function(){
return this.elements?_16a.makeArray(this.elements):this;
}).filter(function(){
return this.name&&!this.disabled&&(this.checked||_698.test(this.nodeName)||_692.test(this.type));
}).map(function(i,elem){
var val=_16a(this).val();
return val==null?null:_16a.isArray(val)?_16a.map(val,function(val,i){
return {name:elem.name,value:val.replace(_68f,"\r\n")};
}):{name:elem.name,value:val.replace(_68f,"\r\n")};
}).get();
}});
_16a.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(i,o){
_16a.fn[o]=function(f){
return this.on(o,f);
};
});
_16a.each(["get","post"],function(i,_6cf){
_16a[_6cf]=function(url,data,_6d2,type){
if(_16a.isFunction(data)){
type=type||_6d2;
_6d2=data;
data=_166;
}
return _16a.ajax({type:_6cf,url:url,data:data,success:_6d2,dataType:type});
};
});
_16a.extend({getScript:function(url,_6d5){
return _16a.get(url,_166,_6d5,"script");
},getJSON:function(url,data,_6d8){
return _16a.get(url,data,_6d8,"json");
},ajaxSetup:function(_6d9,_6da){
if(_6da){
ajaxExtend(_6d9,_16a.ajaxSettings);
}else{
_6da=_6d9;
_6d9=_16a.ajaxSettings;
}
ajaxExtend(_6d9,_6da);
return _6d9;
},ajaxSettings:{url:_69f,isLocal:_693.test(_6a0[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":_6a1},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":_165.String,"text html":true,"text json":_16a.parseJSON,"text xml":_16a.parseXML},flatOptions:{context:true,url:true}},ajaxPrefilter:addToPrefiltersOrTransports(_69d),ajaxTransport:addToPrefiltersOrTransports(_69e),ajax:function(url,_6dc){
if(typeof url==="object"){
_6dc=url;
url=_166;
}
_6dc=_6dc||{};
var s=_16a.ajaxSetup({},_6dc),_6de=s.context||s,_6df=_6de!==s&&(_6de.nodeType||_6de instanceof _16a)?_16a(_6de):_16a.event,_6e0=_16a.Deferred(),_6e1=_16a.Callbacks("once memory"),_6e2=s.statusCode||{},_6e3,_6e4={},_6e5={},_6e6,_6e7,_6e8,_6e9,_6ea,_6eb=0,_6ec,i,_6ee={readyState:0,setRequestHeader:function(name,_6f0){
if(!_6eb){
var _6f1=name.toLowerCase();
name=_6e5[_6f1]=_6e5[_6f1]||name;
_6e4[name]=_6f0;
}
return this;
},getAllResponseHeaders:function(){
return _6eb===2?_6e6:null;
},getResponseHeader:function(key){
var _6f3;
if(_6eb===2){
if(!_6e7){
_6e7={};
while((_6f3=_691.exec(_6e6))){
_6e7[_6f3[1].toLowerCase()]=_6f3[2];
}
}
_6f3=_6e7[key.toLowerCase()];
}
return _6f3===_166?null:_6f3;
},overrideMimeType:function(type){
if(!_6eb){
s.mimeType=type;
}
return this;
},abort:function(_6f5){
_6f5=_6f5||"abort";
if(_6e8){
_6e8.abort(_6f5);
}
done(0,_6f5);
return this;
}};
function done(_6f6,_6f7,_6f8,_6f9){
if(_6eb===2){
return;
}
_6eb=2;
if(_6e9){
clearTimeout(_6e9);
}
_6e8=_166;
_6e6=_6f9||"";
_6ee.readyState=_6f6>0?4:0;
var _6fa,_6fb,_6fc,_6fd=_6f7,_6fe=_6f8?ajaxHandleResponses(s,_6ee,_6f8):_166,_6ff,etag;
if(_6f6>=200&&_6f6<300||_6f6===304){
if(s.ifModified){
if((_6ff=_6ee.getResponseHeader("Last-Modified"))){
_16a.lastModified[_6e3]=_6ff;
}
if((etag=_6ee.getResponseHeader("Etag"))){
_16a.etag[_6e3]=etag;
}
}
if(_6f6===304){
_6fd="notmodified";
_6fa=true;
}else{
try{
_6fb=ajaxConvert(s,_6fe);
_6fd="success";
_6fa=true;
}
catch(e){
_6fd="parsererror";
_6fc=e;
}
}
}else{
_6fc=_6fd;
if(!_6fd||_6f6){
_6fd="error";
if(_6f6<0){
_6f6=0;
}
}
}
_6ee.status=_6f6;
_6ee.statusText=""+(_6f7||_6fd);
if(_6fa){
_6e0.resolveWith(_6de,[_6fb,_6fd,_6ee]);
}else{
_6e0.rejectWith(_6de,[_6ee,_6fd,_6fc]);
}
_6ee.statusCode(_6e2);
_6e2=_166;
if(_6ec){
_6df.trigger("ajax"+(_6fa?"Success":"Error"),[_6ee,s,_6fa?_6fb:_6fc]);
}
_6e1.fireWith(_6de,[_6ee,_6fd]);
if(_6ec){
_6df.trigger("ajaxComplete",[_6ee,s]);
if(!(--_16a.active)){
_16a.event.trigger("ajaxStop");
}
}
}
_6e0.promise(_6ee);
_6ee.success=_6ee.done;
_6ee.error=_6ee.fail;
_6ee.complete=_6e1.add;
_6ee.statusCode=function(map){
if(map){
var tmp;
if(_6eb<2){
for(tmp in map){
_6e2[tmp]=[_6e2[tmp],map[tmp]];
}
}else{
tmp=map[_6ee.status];
_6ee.then(tmp,tmp);
}
}
return this;
};
s.url=((url||s.url)+"").replace(_690,"").replace(_695,_6a0[1]+"//");
s.dataTypes=_16a.trim(s.dataType||"*").toLowerCase().split(_699);
if(s.crossDomain==null){
_6ea=rurl.exec(s.url.toLowerCase());
s.crossDomain=!!(_6ea&&(_6ea[1]!=_6a0[1]||_6ea[2]!=_6a0[2]||(_6ea[3]||(_6ea[1]==="http:"?80:443))!=(_6a0[3]||(_6a0[1]==="http:"?80:443))));
}
if(s.data&&s.processData&&typeof s.data!=="string"){
s.data=_16a.param(s.data,s.traditional);
}
inspectPrefiltersOrTransports(_69d,s,_6dc,_6ee);
if(_6eb===2){
return false;
}
_6ec=s.global;
s.type=s.type.toUpperCase();
s.hasContent=!_694.test(s.type);
if(_6ec&&_16a.active++===0){
_16a.event.trigger("ajaxStart");
}
if(!s.hasContent){
if(s.data){
s.url+=(_696.test(s.url)?"&":"?")+s.data;
delete s.data;
}
_6e3=s.url;
if(s.cache===false){
var ts=_16a.now(),ret=s.url.replace(rts,"$1_="+ts);
s.url=ret+((ret===s.url)?(_696.test(s.url)?"&":"?")+"_="+ts:"");
}
}
if(s.data&&s.hasContent&&s.contentType!==false||_6dc.contentType){
_6ee.setRequestHeader("Content-Type",s.contentType);
}
if(s.ifModified){
_6e3=_6e3||s.url;
if(_16a.lastModified[_6e3]){
_6ee.setRequestHeader("If-Modified-Since",_16a.lastModified[_6e3]);
}
if(_16a.etag[_6e3]){
_6ee.setRequestHeader("If-None-Match",_16a.etag[_6e3]);
}
}
_6ee.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+_6a1+"; q=0.01":""):s.accepts["*"]);
for(i in s.headers){
_6ee.setRequestHeader(i,s.headers[i]);
}
if(s.beforeSend&&(s.beforeSend.call(_6de,_6ee,s)===false||_6eb===2)){
_6ee.abort();
return false;
}
for(i in {success:1,error:1,complete:1}){
_6ee[i](s[i]);
}
_6e8=inspectPrefiltersOrTransports(_69e,s,_6dc,_6ee);
if(!_6e8){
done(-1,"No Transport");
}else{
_6ee.readyState=1;
if(_6ec){
_6df.trigger("ajaxSend",[_6ee,s]);
}
if(s.async&&s.timeout>0){
_6e9=setTimeout(function(){
_6ee.abort("timeout");
},s.timeout);
}
try{
_6eb=1;
_6e8.send(_6e4,done);
}
catch(e){
if(_6eb<2){
done(-1,e);
}else{
throw e;
}
}
}
return _6ee;
},param:function(a,_706){
var s=[],add=function(key,_70a){
_70a=_16a.isFunction(_70a)?_70a():_70a;
s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(_70a);
};
if(_706===_166){
_706=_16a.ajaxSettings.traditional;
}
if(_16a.isArray(a)||(a.jquery&&!_16a.isPlainObject(a))){
_16a.each(a,function(){
add(this.name,this.value);
});
}else{
for(var _70b in a){
buildParams(_70b,a[_70b],_706,add);
}
}
return s.join("&").replace(r20,"+");
}});
function buildParams(_70c,obj,_70e,add){
if(_16a.isArray(obj)){
_16a.each(obj,function(i,v){
if(_70e||_68e.test(_70c)){
add(_70c,v);
}else{
buildParams(_70c+"["+(typeof v==="object"||_16a.isArray(v)?i:"")+"]",v,_70e,add);
}
});
}else{
if(!_70e&&obj!=null&&typeof obj==="object"){
for(var name in obj){
buildParams(_70c+"["+name+"]",obj[name],_70e,add);
}
}else{
add(_70c,obj);
}
}
}
_16a.extend({active:0,lastModified:{},etag:{}});
function ajaxHandleResponses(s,_714,_715){
var _716=s.contents,_717=s.dataTypes,_718=s.responseFields,ct,type,_71b,_71c;
for(type in _718){
if(type in _715){
_714[_718[type]]=_715[type];
}
}
while(_717[0]==="*"){
_717.shift();
if(ct===_166){
ct=s.mimeType||_714.getResponseHeader("content-type");
}
}
if(ct){
for(type in _716){
if(_716[type]&&_716[type].test(ct)){
_717.unshift(type);
break;
}
}
}
if(_717[0] in _715){
_71b=_717[0];
}else{
for(type in _715){
if(!_717[0]||s.converters[type+" "+_717[0]]){
_71b=type;
break;
}
if(!_71c){
_71c=type;
}
}
_71b=_71b||_71c;
}
if(_71b){
if(_71b!==_717[0]){
_717.unshift(_71b);
}
return _715[_71b];
}
}
function ajaxConvert(s,_71e){
if(s.dataFilter){
_71e=s.dataFilter(_71e,s.dataType);
}
var _71f=s.dataTypes,_720={},i,key,_723=_71f.length,tmp,_725=_71f[0],prev,_727,conv,_729,_72a;
for(i=1;i<_723;i++){
if(i===1){
for(key in s.converters){
if(typeof key==="string"){
_720[key.toLowerCase()]=s.converters[key];
}
}
}
prev=_725;
_725=_71f[i];
if(_725==="*"){
_725=prev;
}else{
if(prev!=="*"&&prev!==_725){
_727=prev+" "+_725;
conv=_720[_727]||_720["* "+_725];
if(!conv){
_72a=_166;
for(_729 in _720){
tmp=_729.split(" ");
if(tmp[0]===prev||tmp[0]==="*"){
_72a=_720[tmp[1]+" "+_725];
if(_72a){
_729=_720[_729];
if(_729===true){
conv=_72a;
}else{
if(_72a===true){
conv=_729;
}
}
break;
}
}
}
}
if(!(conv||_72a)){
_16a.error("No conversion from "+_727.replace(" "," to "));
}
if(conv!==true){
_71e=conv?conv(_71e):_72a(_729(_71e));
}
}
}
}
return _71e;
}
var jsc=_16a.now(),jsre=/(\=)\?(&|$)|\?\?/i;
_16a.ajaxSetup({jsonp:"callback",jsonpCallback:function(){
return _16a.expando+"_"+(jsc++);
}});
_16a.ajaxPrefilter("json jsonp",function(s,_72e,_72f){
var _730=s.contentType==="application/x-www-form-urlencoded"&&(typeof s.data==="string");
if(s.dataTypes[0]==="jsonp"||s.jsonp!==false&&(jsre.test(s.url)||_730&&jsre.test(s.data))){
var _731,_732=s.jsonpCallback=_16a.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,_733=_165[_732],url=s.url,data=s.data,_736="$1"+_732+"$2";
if(s.jsonp!==false){
url=url.replace(jsre,_736);
if(s.url===url){
if(_730){
data=data.replace(jsre,_736);
}
if(s.data===data){
url+=(/\?/.test(url)?"&":"?")+s.jsonp+"="+_732;
}
}
}
s.url=url;
s.data=data;
_165[_732]=function(_737){
_731=[_737];
};
_72f.always(function(){
_165[_732]=_733;
if(_731&&_16a.isFunction(_733)){
_165[_732](_731[0]);
}
});
s.converters["script json"]=function(){
if(!_731){
_16a.error(_732+" was not called");
}
return _731[0];
};
s.dataTypes[0]="json";
return "script";
}
});
_16a.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(text){
_16a.globalEval(text);
return text;
}}});
_16a.ajaxPrefilter("script",function(s){
if(s.cache===_166){
s.cache=false;
}
if(s.crossDomain){
s.type="GET";
s.global=false;
}
});
_16a.ajaxTransport("script",function(s){
if(s.crossDomain){
var _73b,head=_167.head||_167.getElementsByTagName("head")[0]||_167.documentElement;
return {send:function(_,_73e){
_73b=_167.createElement("script");
_73b.async="async";
if(s.scriptCharset){
_73b.charset=s.scriptCharset;
}
_73b.src=s.url;
_73b.onload=_73b.onreadystatechange=function(_,_740){
if(_740||!_73b.readyState||/loaded|complete/.test(_73b.readyState)){
_73b.onload=_73b.onreadystatechange=null;
if(head&&_73b.parentNode){
head.removeChild(_73b);
}
_73b=_166;
if(!_740){
_73e(200,"success");
}
}
};
head.insertBefore(_73b,head.firstChild);
},abort:function(){
if(_73b){
_73b.onload(0,1);
}
}};
}
});
var _741=_165.ActiveXObject?function(){
for(var key in _743){
_743[key](0,1);
}
}:false,_744=0,_743;
function createStandardXHR(){
try{
return new _165.XMLHttpRequest();
}
catch(e){
}
}
function createActiveXHR(){
try{
return new _165.ActiveXObject("Microsoft.XMLHTTP");
}
catch(e){
}
}
_16a.ajaxSettings.xhr=_165.ActiveXObject?function(){
return !this.isLocal&&createStandardXHR()||createActiveXHR();
}:createStandardXHR;
(function(xhr){
_16a.extend(_16a.support,{ajax:!!xhr,cors:!!xhr&&("withCredentials" in xhr)});
})(_16a.ajaxSettings.xhr());
if(_16a.support.ajax){
_16a.ajaxTransport(function(s){
if(!s.crossDomain||_16a.support.cors){
var _747;
return {send:function(_748,_749){
var xhr=s.xhr(),_74b,i;
if(s.username){
xhr.open(s.type,s.url,s.async,s.username,s.password);
}else{
xhr.open(s.type,s.url,s.async);
}
if(s.xhrFields){
for(i in s.xhrFields){
xhr[i]=s.xhrFields[i];
}
}
if(s.mimeType&&xhr.overrideMimeType){
xhr.overrideMimeType(s.mimeType);
}
if(!s.crossDomain&&!_748["X-Requested-With"]){
_748["X-Requested-With"]="XMLHttpRequest";
}
try{
for(i in _748){
xhr.setRequestHeader(i,_748[i]);
}
}
catch(_){
}
xhr.send((s.hasContent&&s.data)||null);
_747=function(_,_74e){
var _74f,_750,_751,_752,xml;
try{
if(_747&&(_74e||xhr.readyState===4)){
_747=_166;
if(_74b){
xhr.onreadystatechange=_16a.noop;
if(_741){
delete _743[_74b];
}
}
if(_74e){
if(xhr.readyState!==4){
xhr.abort();
}
}else{
_74f=xhr.status;
_751=xhr.getAllResponseHeaders();
_752={};
xml=xhr.responseXML;
if(xml&&xml.documentElement){
_752.xml=xml;
}
_752.text=xhr.responseText;
try{
_750=xhr.statusText;
}
catch(e){
_750="";
}
if(!_74f&&s.isLocal&&!s.crossDomain){
_74f=_752.text?200:404;
}else{
if(_74f===1223){
_74f=204;
}
}
}
}
}
catch(firefoxAccessException){
if(!_74e){
_749(-1,firefoxAccessException);
}
}
if(_752){
_749(_74f,_750,_752,_751);
}
};
if(!s.async||xhr.readyState===4){
_747();
}else{
_74b=++_744;
if(_741){
if(!_743){
_743={};
_16a(_165).unload(_741);
}
_743[_74b]=_747;
}
xhr.onreadystatechange=_747;
}
},abort:function(){
if(_747){
_747(0,1);
}
}};
}
});
}
var _754={},_755,_756,_757=/^(?:toggle|show|hide)$/,_758=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,_759,_75a=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],_75b;
_16a.fn.extend({show:function(_75c,_75d,_75e){
var elem,_760;
if(_75c||_75c===0){
return this.animate(genFx("show",3),_75c,_75d,_75e);
}else{
for(var i=0,j=this.length;i<j;i++){
elem=this[i];
if(elem.style){
_760=elem.style.display;
if(!_16a._data(elem,"olddisplay")&&_760==="none"){
_760=elem.style.display="";
}
if(_760===""&&_16a.css(elem,"display")==="none"){
_16a._data(elem,"olddisplay",defaultDisplay(elem.nodeName));
}
}
}
for(i=0;i<j;i++){
elem=this[i];
if(elem.style){
_760=elem.style.display;
if(_760===""||_760==="none"){
elem.style.display=_16a._data(elem,"olddisplay")||"";
}
}
}
return this;
}
},hide:function(_763,_764,_765){
if(_763||_763===0){
return this.animate(genFx("hide",3),_763,_764,_765);
}else{
var elem,_767,i=0,j=this.length;
for(;i<j;i++){
elem=this[i];
if(elem.style){
_767=_16a.css(elem,"display");
if(_767!=="none"&&!_16a._data(elem,"olddisplay")){
_16a._data(elem,"olddisplay",_767);
}
}
}
for(i=0;i<j;i++){
if(this[i].style){
this[i].style.display="none";
}
}
return this;
}
},_toggle:_16a.fn.toggle,toggle:function(fn,fn2,_76c){
var bool=typeof fn==="boolean";
if(_16a.isFunction(fn)&&_16a.isFunction(fn2)){
this._toggle.apply(this,arguments);
}else{
if(fn==null||bool){
this.each(function(){
var _76e=bool?fn:_16a(this).is(":hidden");
_16a(this)[_76e?"show":"hide"]();
});
}else{
this.animate(genFx("toggle",3),fn,fn2,_76c);
}
}
return this;
},fadeTo:function(_76f,to,_771,_772){
return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:to},_76f,_771,_772);
},animate:function(prop,_774,_775,_776){
var _777=_16a.speed(_774,_775,_776);
if(_16a.isEmptyObject(prop)){
return this.each(_777.complete,[false]);
}
prop=_16a.extend({},prop);
function doAnimation(){
if(_777.queue===false){
_16a._mark(this);
}
var opt=_16a.extend({},_777),_779=this.nodeType===1,_77a=_779&&_16a(this).is(":hidden"),name,val,p,e,_77f,_780,end,unit,_783;
opt.animatedProperties={};
for(p in prop){
name=_16a.camelCase(p);
if(p!==name){
prop[name]=prop[p];
delete prop[p];
}
val=prop[name];
if(_16a.isArray(val)){
opt.animatedProperties[name]=val[1];
val=prop[name]=val[0];
}else{
opt.animatedProperties[name]=opt.specialEasing&&opt.specialEasing[name]||opt.easing||"swing";
}
if(val==="hide"&&_77a||val==="show"&&!_77a){
return opt.complete.call(this);
}
if(_779&&(name==="height"||name==="width")){
opt.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];
if(_16a.css(this,"display")==="inline"&&_16a.css(this,"float")==="none"){
if(!_16a.support.inlineBlockNeedsLayout||defaultDisplay(this.nodeName)==="inline"){
this.style.display="inline-block";
}else{
this.style.zoom=1;
}
}
}
}
if(opt.overflow!=null){
this.style.overflow="hidden";
}
for(p in prop){
e=new _16a.fx(this,opt,p);
val=prop[p];
if(_757.test(val)){
_783=_16a._data(this,"toggle"+p)||(val==="toggle"?_77a?"show":"hide":0);
if(_783){
_16a._data(this,"toggle"+p,_783==="show"?"hide":"show");
e[_783]();
}else{
e[val]();
}
}else{
_77f=_758.exec(val);
_780=e.cur();
if(_77f){
end=parseFloat(_77f[2]);
unit=_77f[3]||(_16a.cssNumber[p]?"":"px");
if(unit!=="px"){
_16a.style(this,p,(end||1)+unit);
_780=((end||1)/e.cur())*_780;
_16a.style(this,p,_780+unit);
}
if(_77f[1]){
end=((_77f[1]==="-="?-1:1)*end)+_780;
}
e.custom(_780,end,unit);
}else{
e.custom(_780,val,"");
}
}
}
return true;
}
return _777.queue===false?this.each(doAnimation):this.queue(_777.queue,doAnimation);
},stop:function(type,_785,_786){
if(typeof type!=="string"){
_786=_785;
_785=type;
type=_166;
}
if(_785&&type!==false){
this.queue(type||"fx",[]);
}
return this.each(function(){
var _787,_788=false,_789=_16a.timers,data=_16a._data(this);
if(!_786){
_16a._unmark(true,this);
}
function stopQueue(elem,data,_78d){
var _78e=data[_78d];
_16a.removeData(elem,_78d,true);
_78e.stop(_786);
}
if(type==null){
for(_787 in data){
if(data[_787]&&data[_787].stop&&_787.indexOf(".run")===_787.length-4){
stopQueue(this,data,_787);
}
}
}else{
if(data[_787=type+".run"]&&data[_787].stop){
stopQueue(this,data,_787);
}
}
for(_787=_789.length;_787--;){
if(_789[_787].elem===this&&(type==null||_789[_787].queue===type)){
if(_786){
_789[_787](true);
}else{
_789[_787].saveState();
}
_788=true;
_789.splice(_787,1);
}
}
if(!(_786&&_788)){
_16a.dequeue(this,type);
}
});
}});
function createFxNow(){
setTimeout(clearFxNow,0);
return (_75b=_16a.now());
}
function clearFxNow(){
_75b=_166;
}
function genFx(type,num){
var obj={};
_16a.each(_75a.concat.apply([],_75a.slice(0,num)),function(){
obj[this]=type;
});
return obj;
}
_16a.each({slideDown:genFx("show",1),slideUp:genFx("hide",1),slideToggle:genFx("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,_793){
_16a.fn[name]=function(_794,_795,_796){
return this.animate(_793,_794,_795,_796);
};
});
_16a.extend({speed:function(_797,_798,fn){
var opt=_797&&typeof _797==="object"?_16a.extend({},_797):{complete:fn||!fn&&_798||_16a.isFunction(_797)&&_797,duration:_797,easing:fn&&_798||_798&&!_16a.isFunction(_798)&&_798};
opt.duration=_16a.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in _16a.fx.speeds?_16a.fx.speeds[opt.duration]:_16a.fx.speeds._default;
if(opt.queue==null||opt.queue===true){
opt.queue="fx";
}
opt.old=opt.complete;
opt.complete=function(_79b){
if(_16a.isFunction(opt.old)){
opt.old.call(this);
}
if(opt.queue){
_16a.dequeue(this,opt.queue);
}else{
if(_79b!==false){
_16a._unmark(this);
}
}
};
return opt;
},easing:{linear:function(p,n,_79e,diff){
return _79e+diff*p;
},swing:function(p,n,_7a2,diff){
return ((-Math.cos(p*Math.PI)/2)+0.5)*diff+_7a2;
}},timers:[],fx:function(elem,_7a5,prop){
this.options=_7a5;
this.elem=elem;
this.prop=prop;
_7a5.orig=_7a5.orig||{};
}});
_16a.fx.prototype={update:function(){
if(this.options.step){
this.options.step.call(this.elem,this.now,this);
}
(_16a.fx.step[this.prop]||_16a.fx.step._default)(this);
},cur:function(){
if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){
return this.elem[this.prop];
}
var _7a7,r=_16a.css(this.elem,this.prop);
return isNaN(_7a7=parseFloat(r))?!r||r==="auto"?0:r:_7a7;
},custom:function(from,to,unit){
var self=this,fx=_16a.fx;
this.startTime=_75b||createFxNow();
this.end=to;
this.now=this.start=from;
this.pos=this.state=0;
this.unit=unit||this.unit||(_16a.cssNumber[this.prop]?"":"px");
function t(_7ae){
return self.step(_7ae);
}
t.queue=this.options.queue;
t.elem=this.elem;
t.saveState=function(){
if(self.options.hide&&_16a._data(self.elem,"fxshow"+self.prop)===_166){
_16a._data(self.elem,"fxshow"+self.prop,self.start);
}
};
if(t()&&_16a.timers.push(t)&&!_759){
_759=setInterval(fx.tick,fx.interval);
}
},show:function(){
var _7af=_16a._data(this.elem,"fxshow"+this.prop);
this.options.orig[this.prop]=_7af||_16a.style(this.elem,this.prop);
this.options.show=true;
if(_7af!==_166){
this.custom(this.cur(),_7af);
}else{
this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());
}
_16a(this.elem).show();
},hide:function(){
this.options.orig[this.prop]=_16a._data(this.elem,"fxshow"+this.prop)||_16a.style(this.elem,this.prop);
this.options.hide=true;
this.custom(this.cur(),0);
},step:function(_7b0){
var p,n,_7b3,t=_75b||createFxNow(),done=true,elem=this.elem,_7b7=this.options;
if(_7b0||t>=_7b7.duration+this.startTime){
this.now=this.end;
this.pos=this.state=1;
this.update();
_7b7.animatedProperties[this.prop]=true;
for(p in _7b7.animatedProperties){
if(_7b7.animatedProperties[p]!==true){
done=false;
}
}
if(done){
if(_7b7.overflow!=null&&!_16a.support.shrinkWrapBlocks){
_16a.each(["","X","Y"],function(_7b8,_7b9){
elem.style["overflow"+_7b9]=_7b7.overflow[_7b8];
});
}
if(_7b7.hide){
_16a(elem).hide();
}
if(_7b7.hide||_7b7.show){
for(p in _7b7.animatedProperties){
_16a.style(elem,p,_7b7.orig[p]);
_16a.removeData(elem,"fxshow"+p,true);
_16a.removeData(elem,"toggle"+p,true);
}
}
_7b3=_7b7.complete;
if(_7b3){
_7b7.complete=false;
_7b3.call(elem);
}
}
return false;
}else{
if(_7b7.duration==Infinity){
this.now=t;
}else{
n=t-this.startTime;
this.state=n/_7b7.duration;
this.pos=_16a.easing[_7b7.animatedProperties[this.prop]](this.state,n,0,1,_7b7.duration);
this.now=this.start+((this.end-this.start)*this.pos);
}
this.update();
}
return true;
}};
_16a.extend(_16a.fx,{tick:function(){
var _7ba,_7bb=_16a.timers,i=0;
for(;i<_7bb.length;i++){
_7ba=_7bb[i];
if(!_7ba()&&_7bb[i]===_7ba){
_7bb.splice(i--,1);
}
}
if(!_7bb.length){
_16a.fx.stop();
}
},interval:13,stop:function(){
clearInterval(_759);
_759=null;
},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(fx){
_16a.style(fx.elem,"opacity",fx.now);
},_default:function(fx){
if(fx.elem.style&&fx.elem.style[fx.prop]!=null){
fx.elem.style[fx.prop]=fx.now+fx.unit;
}else{
fx.elem[fx.prop]=fx.now;
}
}}});
_16a.each(["width","height"],function(i,prop){
_16a.fx.step[prop]=function(fx){
_16a.style(fx.elem,prop,Math.max(0,fx.now)+fx.unit);
};
});
if(_16a.expr&&_16a.expr.filters){
_16a.expr.filters.animated=function(elem){
return _16a.grep(_16a.timers,function(fn){
return elem===fn.elem;
}).length;
};
}
function defaultDisplay(_7c4){
if(!_754[_7c4]){
var body=_167.body,elem=_16a("<"+_7c4+">").appendTo(body),_7c7=elem.css("display");
elem.remove();
if(_7c7==="none"||_7c7===""){
if(!_755){
_755=_167.createElement("iframe");
_755.frameBorder=_755.width=_755.height=0;
}
body.appendChild(_755);
if(!_756||!_755.createElement){
_756=(_755.contentWindow||_755.contentDocument).document;
_756.write((_167.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>");
_756.close();
}
elem=_756.createElement(_7c4);
_756.body.appendChild(elem);
_7c7=_16a.css(elem,"display");
body.removeChild(_755);
}
_754[_7c4]=_7c7;
}
return _754[_7c4];
}
var _7c8=/^t(?:able|d|h)$/i,_7c9=/^(?:body|html)$/i;
if("getBoundingClientRect" in _167.documentElement){
_16a.fn.offset=function(_7ca){
var elem=this[0],box;
if(_7ca){
return this.each(function(i){
_16a.offset.setOffset(this,_7ca,i);
});
}
if(!elem||!elem.ownerDocument){
return null;
}
if(elem===elem.ownerDocument.body){
return _16a.offset.bodyOffset(elem);
}
try{
box=elem.getBoundingClientRect();
}
catch(e){
}
var doc=elem.ownerDocument,_7cf=doc.documentElement;
if(!box||!_16a.contains(_7cf,elem)){
return box?{top:box.top,left:box.left}:{top:0,left:0};
}
var body=doc.body,win=getWindow(doc),_7d2=_7cf.clientTop||body.clientTop||0,_7d3=_7cf.clientLeft||body.clientLeft||0,_7d4=win.pageYOffset||_16a.support.boxModel&&_7cf.scrollTop||body.scrollTop,_7d5=win.pageXOffset||_16a.support.boxModel&&_7cf.scrollLeft||body.scrollLeft,top=box.top+_7d4-_7d2,left=box.left+_7d5-_7d3;
return {top:top,left:left};
};
}else{
_16a.fn.offset=function(_7d8){
var elem=this[0];
if(_7d8){
return this.each(function(i){
_16a.offset.setOffset(this,_7d8,i);
});
}
if(!elem||!elem.ownerDocument){
return null;
}
if(elem===elem.ownerDocument.body){
return _16a.offset.bodyOffset(elem);
}
var _7db,_7dc=elem.offsetParent,_7dd=elem,doc=elem.ownerDocument,_7df=doc.documentElement,body=doc.body,_7e1=doc.defaultView,_7e2=_7e1?_7e1.getComputedStyle(elem,null):elem.currentStyle,top=elem.offsetTop,left=elem.offsetLeft;
while((elem=elem.parentNode)&&elem!==body&&elem!==_7df){
if(_16a.support.fixedPosition&&_7e2.position==="fixed"){
break;
}
_7db=_7e1?_7e1.getComputedStyle(elem,null):elem.currentStyle;
top-=elem.scrollTop;
left-=elem.scrollLeft;
if(elem===_7dc){
top+=elem.offsetTop;
left+=elem.offsetLeft;
if(_16a.support.doesNotAddBorder&&!(_16a.support.doesAddBorderForTableAndCells&&_7c8.test(elem.nodeName))){
top+=parseFloat(_7db.borderTopWidth)||0;
left+=parseFloat(_7db.borderLeftWidth)||0;
}
_7dd=_7dc;
_7dc=elem.offsetParent;
}
if(_16a.support.subtractsBorderForOverflowNotVisible&&_7db.overflow!=="visible"){
top+=parseFloat(_7db.borderTopWidth)||0;
left+=parseFloat(_7db.borderLeftWidth)||0;
}
_7e2=_7db;
}
if(_7e2.position==="relative"||_7e2.position==="static"){
top+=body.offsetTop;
left+=body.offsetLeft;
}
if(_16a.support.fixedPosition&&_7e2.position==="fixed"){
top+=Math.max(_7df.scrollTop,body.scrollTop);
left+=Math.max(_7df.scrollLeft,body.scrollLeft);
}
return {top:top,left:left};
};
}
_16a.offset={bodyOffset:function(body){
var top=body.offsetTop,left=body.offsetLeft;
if(_16a.support.doesNotIncludeMarginInBodyOffset){
top+=parseFloat(_16a.css(body,"marginTop"))||0;
left+=parseFloat(_16a.css(body,"marginLeft"))||0;
}
return {top:top,left:left};
},setOffset:function(elem,_7e9,i){
var _7eb=_16a.css(elem,"position");
if(_7eb==="static"){
elem.style.position="relative";
}
var _7ec=_16a(elem),_7ed=_7ec.offset(),_7ee=_16a.css(elem,"top"),_7ef=_16a.css(elem,"left"),_7f0=(_7eb==="absolute"||_7eb==="fixed")&&_16a.inArray("auto",[_7ee,_7ef])>-1,_7f1={},_7f2={},_7f3,_7f4;
if(_7f0){
_7f2=_7ec.position();
_7f3=_7f2.top;
_7f4=_7f2.left;
}else{
_7f3=parseFloat(_7ee)||0;
_7f4=parseFloat(_7ef)||0;
}
if(_16a.isFunction(_7e9)){
_7e9=_7e9.call(elem,i,_7ed);
}
if(_7e9.top!=null){
_7f1.top=(_7e9.top-_7ed.top)+_7f3;
}
if(_7e9.left!=null){
_7f1.left=(_7e9.left-_7ed.left)+_7f4;
}
if("using" in _7e9){
_7e9.using.call(elem,_7f1);
}else{
_7ec.css(_7f1);
}
}};
_16a.fn.extend({position:function(){
if(!this[0]){
return null;
}
var elem=this[0],_7f6=this.offsetParent(),_7f7=this.offset(),_7f8=_7c9.test(_7f6[0].nodeName)?{top:0,left:0}:_7f6.offset();
_7f7.top-=parseFloat(_16a.css(elem,"marginTop"))||0;
_7f7.left-=parseFloat(_16a.css(elem,"marginLeft"))||0;
_7f8.top+=parseFloat(_16a.css(_7f6[0],"borderTopWidth"))||0;
_7f8.left+=parseFloat(_16a.css(_7f6[0],"borderLeftWidth"))||0;
return {top:_7f7.top-_7f8.top,left:_7f7.left-_7f8.left};
},offsetParent:function(){
return this.map(function(){
var _7f9=this.offsetParent||_167.body;
while(_7f9&&(!_7c9.test(_7f9.nodeName)&&_16a.css(_7f9,"position")==="static")){
_7f9=_7f9.offsetParent;
}
return _7f9;
});
}});
_16a.each(["Left","Top"],function(i,name){
var _7fc="scroll"+name;
_16a.fn[_7fc]=function(val){
var elem,win;
if(val===_166){
elem=this[0];
if(!elem){
return null;
}
win=getWindow(elem);
return win?("pageXOffset" in win)?win[i?"pageYOffset":"pageXOffset"]:_16a.support.boxModel&&win.document.documentElement[_7fc]||win.document.body[_7fc]:elem[_7fc];
}
return this.each(function(){
win=getWindow(this);
if(win){
win.scrollTo(!i?val:_16a(win).scrollLeft(),i?val:_16a(win).scrollTop());
}else{
this[_7fc]=val;
}
});
};
});
function getWindow(elem){
return _16a.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false;
}
_16a.each(["Height","Width"],function(i,name){
var type=name.toLowerCase();
_16a.fn["inner"+name]=function(){
var elem=this[0];
return elem?elem.style?parseFloat(_16a.css(elem,type,"padding")):this[type]():null;
};
_16a.fn["outer"+name]=function(_805){
var elem=this[0];
return elem?elem.style?parseFloat(_16a.css(elem,type,_805?"margin":"border")):this[type]():null;
};
_16a.fn[type]=function(size){
var elem=this[0];
if(!elem){
return size==null?null:this;
}
if(_16a.isFunction(size)){
return this.each(function(i){
var self=_16a(this);
self[type](size.call(this,i,self[type]()));
});
}
if(_16a.isWindow(elem)){
var _80b=elem.document.documentElement["client"+name],body=elem.document.body;
return elem.document.compatMode==="CSS1Compat"&&_80b||body&&body["client"+name]||_80b;
}else{
if(elem.nodeType===9){
return Math.max(elem.documentElement["client"+name],elem.body["scroll"+name],elem.documentElement["scroll"+name],elem.body["offset"+name],elem.documentElement["offset"+name]);
}else{
if(size===_166){
var orig=_16a.css(elem,type),ret=parseFloat(orig);
return _16a.isNumeric(ret)?ret:orig;
}else{
return this.css(type,typeof size==="string"?size:size+"px");
}
}
}
};
});
_165.jQuery=_165.$=_16a;
if(typeof define==="function"&&define.amd&&define.amd.jQuery){
define("jquery",[],function(){
return _16a;
});
}
})(window);
(function($,_810){
$.ui=$.ui||{};
if($.ui.version){
return;
}
$.extend($.ui,{version:"1.8.11",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});
$.fn.extend({_focus:$.fn.focus,focus:function(_811,fn){
return typeof _811==="number"?this.each(function(){
var elem=this;
setTimeout(function(){
$(elem).focus();
if(fn){
fn.call(elem);
}
},_811);
}):this._focus.apply(this,arguments);
},scrollParent:function(){
var _814;
if(($.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){
_814=this.parents().filter(function(){
return (/(relative|absolute|fixed)/).test($.curCSS(this,"position",1))&&(/(auto|scroll)/).test($.curCSS(this,"overflow",1)+$.curCSS(this,"overflow-y",1)+$.curCSS(this,"overflow-x",1));
}).eq(0);
}else{
_814=this.parents().filter(function(){
return (/(auto|scroll)/).test($.curCSS(this,"overflow",1)+$.curCSS(this,"overflow-y",1)+$.curCSS(this,"overflow-x",1));
}).eq(0);
}
return (/fixed/).test(this.css("position"))||!_814.length?$(document):_814;
},zIndex:function(_815){
if(_815!==_810){
return this.css("zIndex",_815);
}
if(this.length){
var elem=$(this[0]),_817,_818;
while(elem.length&&elem[0]!==document){
_817=elem.css("position");
if(_817==="absolute"||_817==="relative"||_817==="fixed"){
_818=parseInt(elem.css("zIndex"),10);
if(!isNaN(_818)&&_818!==0){
return _818;
}
}
elem=elem.parent();
}
}
return 0;
},disableSelection:function(){
return this.bind(($.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(_819){
_819.preventDefault();
});
},enableSelection:function(){
return this.unbind(".ui-disableSelection");
}});
$.each(["Width","Height"],function(i,name){
var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};
function reduce(elem,size,_821,_822){
$.each(side,function(){
size-=parseFloat($.curCSS(elem,"padding"+this,true))||0;
if(_821){
size-=parseFloat($.curCSS(elem,"border"+this+"Width",true))||0;
}
if(_822){
size-=parseFloat($.curCSS(elem,"margin"+this,true))||0;
}
});
return size;
}
$.fn["inner"+name]=function(size){
if(size===_810){
return orig["inner"+name].call(this);
}
return this.each(function(){
$(this).css(type,reduce(this,size)+"px");
});
};
$.fn["outer"+name]=function(size,_825){
if(typeof size!=="number"){
return orig["outer"+name].call(this,size);
}
return this.each(function(){
$(this).css(type,reduce(this,size,true,_825)+"px");
});
};
});
function visible(_826){
return !$(_826).parents().andSelf().filter(function(){
return $.curCSS(this,"visibility")==="hidden"||$.expr.filters.hidden(this);
}).length;
}
$.extend($.expr[":"],{data:function(elem,i,_829){
return !!$.data(elem,_829[3]);
},focusable:function(_82a){
var _82b=_82a.nodeName.toLowerCase(),_82c=$.attr(_82a,"tabindex");
if("area"===_82b){
var map=_82a.parentNode,_82e=map.name,img;
if(!_82a.href||!_82e||map.nodeName.toLowerCase()!=="map"){
return false;
}
img=$("img[usemap=#"+_82e+"]")[0];
return !!img&&visible(img);
}
return (/input|select|textarea|button|object/.test(_82b)?!_82a.disabled:"a"==_82b?_82a.href||!isNaN(_82c):!isNaN(_82c))&&visible(_82a);
},tabbable:function(_830){
var _831=$.attr(_830,"tabindex");
return (isNaN(_831)||_831>=0)&&$(_830).is(":focusable");
}});
$(function(){
var body=document.body,div=body.appendChild(div=document.createElement("div"));
$.extend(div.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});
$.support.minHeight=div.offsetHeight===100;
$.support.selectstart="onselectstart" in div;
body.removeChild(div).style.display="none";
});
$.extend($.ui,{plugin:{add:function(_834,_835,set){
var _837=$.ui[_834].prototype;
for(var i in set){
_837.plugins[i]=_837.plugins[i]||[];
_837.plugins[i].push([_835,set[i]]);
}
},call:function(_839,name,args){
var set=_839.plugins[name];
if(!set||!_839.element[0].parentNode){
return;
}
for(var i=0;i<set.length;i++){
if(_839.options[set[i][0]]){
set[i][1].apply(_839.element,args);
}
}
}},contains:function(a,b){
return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b);
},hasScroll:function(el,a){
if($(el).css("overflow")==="hidden"){
return false;
}
var _842=(a&&a==="left")?"scrollLeft":"scrollTop",has=false;
if(el[_842]>0){
return true;
}
el[_842]=1;
has=(el[_842]>0);
el[_842]=0;
return has;
},isOverAxis:function(x,_845,size){
return (x>_845)&&(x<(_845+size));
},isOver:function(y,x,top,left,_84b,_84c){
return $.ui.isOverAxis(y,top,_84b)&&$.ui.isOverAxis(x,left,_84c);
}});
})(jQuery);
(function($,_84e){
if($.cleanData){
var _84f=$.cleanData;
$.cleanData=function(_850){
for(var i=0,elem;(elem=_850[i])!=null;i++){
$(elem).triggerHandler("remove");
}
_84f(_850);
};
}else{
var _853=$.fn.remove;
$.fn.remove=function(_854,_855){
return this.each(function(){
if(!_855){
if(!_854||$.filter(_854,[this]).length){
$("*",this).add([this]).each(function(){
$(this).triggerHandler("remove");
});
}
}
return _853.call($(this),_854,_855);
});
};
}
$.widget=function(name,base,_858){
var _859=name.split(".")[0],_85a;
name=name.split(".")[1];
_85a=_859+"-"+name;
if(!_858){
_858=base;
base=$.Widget;
}
$.expr[":"][_85a]=function(elem){
return !!$.data(elem,name);
};
$[_859]=$[_859]||{};
$[_859][name]=function(_85c,_85d){
if(arguments.length){
this._createWidget(_85c,_85d);
}
};
var _85e=new base();
_85e.options=$.extend(true,{},_85e.options);
$[_859][name].prototype=$.extend(true,_85e,{namespace:_859,widgetName:name,widgetEventPrefix:$[_859][name].prototype.widgetEventPrefix||name,widgetBaseClass:_85a},_858);
$.widget.bridge(name,$[_859][name]);
};
$.widget.bridge=function(name,_860){
$.fn[name]=function(_861){
var _862=typeof _861==="string",args=Array.prototype.slice.call(arguments,1),_864=this;
_861=!_862&&args.length?$.extend.apply(null,[true,_861].concat(args)):_861;
if(_862&&_861.charAt(0)==="_"){
return _864;
}
if(_862){
this.each(function(){
var _865=$.data(this,name),_866=_865&&$.isFunction(_865[_861])?_865[_861].apply(_865,args):_865;
if(_866!==_865&&_866!==_84e){
_864=_866;
return false;
}
});
}else{
this.each(function(){
var _867=$.data(this,name);
if(_867){
_867.option(_861||{})._init();
}else{
$.data(this,name,new _860(_861,this));
}
});
}
return _864;
};
};
$.Widget=function(_868,_869){
if(arguments.length){
this._createWidget(_868,_869);
}
};
$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(_86a,_86b){
$.data(_86b,this.widgetName,this);
this.element=$(_86b);
this.options=$.extend(true,{},this.options,this._getCreateOptions(),_86a);
var self=this;
this.element.bind("remove."+this.widgetName,function(){
self.destroy();
});
this._create();
this._trigger("create");
this._init();
},_getCreateOptions:function(){
return $.metadata&&$.metadata.get(this.element[0])[this.widgetName];
},_create:function(){
},_init:function(){
},destroy:function(){
this.element.unbind("."+this.widgetName).removeData(this.widgetName);
this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled");
},widget:function(){
return this.element;
},option:function(key,_86e){
var _86f=key;
if(arguments.length===0){
return $.extend({},this.options);
}
if(typeof key==="string"){
if(_86e===_84e){
return this.options[key];
}
_86f={};
_86f[key]=_86e;
}
this._setOptions(_86f);
return this;
},_setOptions:function(_870){
var self=this;
$.each(_870,function(key,_873){
self._setOption(key,_873);
});
return this;
},_setOption:function(key,_875){
this.options[key]=_875;
if(key==="disabled"){
this.widget()[_875?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+"ui-state-disabled").attr("aria-disabled",_875);
}
return this;
},enable:function(){
return this._setOption("disabled",false);
},disable:function(){
return this._setOption("disabled",true);
},_trigger:function(type,_877,data){
var _879=this.options[type];
_877=$.Event(_877);
_877.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();
data=data||{};
if(_877.originalEvent){
for(var i=$.event.props.length,prop;i;){
prop=$.event.props[--i];
_877[prop]=_877.originalEvent[prop];
}
}
this.element.trigger(_877,data);
return !($.isFunction(_879)&&_879.call(this.element[0],_877,data)===false||_877.isDefaultPrevented());
}};
})(jQuery);
(function($,_87d){
$.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){
var self=this;
this.element.bind("mousedown."+this.widgetName,function(_87f){
return self._mouseDown(_87f);
}).bind("click."+this.widgetName,function(_880){
if(true===$.data(_880.target,self.widgetName+".preventClickEvent")){
$.removeData(_880.target,self.widgetName+".preventClickEvent");
_880.stopImmediatePropagation();
return false;
}
});
this.started=false;
},_mouseDestroy:function(){
this.element.unbind("."+this.widgetName);
},_mouseDown:function(_881){
_881.originalEvent=_881.originalEvent||{};
if(_881.originalEvent.mouseHandled){
return;
}
(this._mouseStarted&&this._mouseUp(_881));
this._mouseDownEvent=_881;
var self=this,_883=(_881.which==1),_884=(typeof this.options.cancel=="string"?$(_881.target).parents().add(_881.target).filter(this.options.cancel).length:false);
if(!_883||_884||!this._mouseCapture(_881)){
return true;
}
this.mouseDelayMet=!this.options.delay;
if(!this.mouseDelayMet){
this._mouseDelayTimer=setTimeout(function(){
self.mouseDelayMet=true;
},this.options.delay);
}
if(this._mouseDistanceMet(_881)&&this._mouseDelayMet(_881)){
this._mouseStarted=(this._mouseStart(_881)!==false);
if(!this._mouseStarted){
_881.preventDefault();
return true;
}
}
if(true===$.data(_881.target,this.widgetName+".preventClickEvent")){
$.removeData(_881.target,this.widgetName+".preventClickEvent");
}
this._mouseMoveDelegate=function(_885){
return self._mouseMove(_885);
};
this._mouseUpDelegate=function(_886){
return self._mouseUp(_886);
};
$(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);
_881.preventDefault();
_881.originalEvent.mouseHandled=true;
return true;
},_mouseMove:function(_887){
if($.browser.msie&&!(document.documentMode>=9)&&!_887.button){
return this._mouseUp(_887);
}
if(this._mouseStarted){
this._mouseDrag(_887);
return _887.preventDefault();
}
if(this._mouseDistanceMet(_887)&&this._mouseDelayMet(_887)){
this._mouseStarted=(this._mouseStart(this._mouseDownEvent,_887)!==false);
(this._mouseStarted?this._mouseDrag(_887):this._mouseUp(_887));
}
return !this._mouseStarted;
},_mouseUp:function(_888){
$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);
if(this._mouseStarted){
this._mouseStarted=false;
if(_888.target==this._mouseDownEvent.target){
$.data(_888.target,this.widgetName+".preventClickEvent",true);
}
this._mouseStop(_888);
}
return false;
},_mouseDistanceMet:function(_889){
return (Math.max(Math.abs(this._mouseDownEvent.pageX-_889.pageX),Math.abs(this._mouseDownEvent.pageY-_889.pageY))>=this.options.distance);
},_mouseDelayMet:function(_88a){
return this.mouseDelayMet;
},_mouseStart:function(_88b){
},_mouseDrag:function(_88c){
},_mouseStop:function(_88d){
},_mouseCapture:function(_88e){
return true;
}});
})(jQuery);
(function($,_890){
$.ui=$.ui||{};
var _891=/left|center|right/,_892=/top|center|bottom/,_893="center",_894=$.fn.position,_895=$.fn.offset;
$.fn.position=function(_896){
if(!_896||!_896.of){
return _894.apply(this,arguments);
}
_896=$.extend({},_896);
var _897=$(_896.of),_898=_897[0],_899=(_896.collision||"flip").split(" "),_89a=_896.offset?_896.offset.split(" "):[0,0],_89b,_89c,_89d;
if(_898.nodeType===9){
_89b=_897.width();
_89c=_897.height();
_89d={top:0,left:0};
}else{
if(_898.setTimeout){
_89b=_897.width();
_89c=_897.height();
_89d={top:_897.scrollTop(),left:_897.scrollLeft()};
}else{
if(_898.preventDefault){
_896.at="left top";
_89b=_89c=0;
_89d={top:_896.of.pageY,left:_896.of.pageX};
}else{
_89b=_897.outerWidth();
_89c=_897.outerHeight();
_89d=_897.offset();
}
}
}
$.each(["my","at"],function(){
var pos=(_896[this]||"").split(" ");
if(pos.length===1){
pos=_891.test(pos[0])?pos.concat([_893]):_892.test(pos[0])?[_893].concat(pos):[_893,_893];
}
pos[0]=_891.test(pos[0])?pos[0]:_893;
pos[1]=_892.test(pos[1])?pos[1]:_893;
_896[this]=pos;
});
if(_899.length===1){
_899[1]=_899[0];
}
_89a[0]=parseInt(_89a[0],10)||0;
if(_89a.length===1){
_89a[1]=_89a[0];
}
_89a[1]=parseInt(_89a[1],10)||0;
if(_896.at[0]==="right"){
_89d.left+=_89b;
}else{
if(_896.at[0]===_893){
_89d.left+=_89b/2;
}
}
if(_896.at[1]==="bottom"){
_89d.top+=_89c;
}else{
if(_896.at[1]===_893){
_89d.top+=_89c/2;
}
}
_89d.left+=_89a[0];
_89d.top+=_89a[1];
return this.each(function(){
var elem=$(this),_8a0=elem.outerWidth(),_8a1=elem.outerHeight(),_8a2=parseInt($.curCSS(this,"marginLeft",true))||0,_8a3=parseInt($.curCSS(this,"marginTop",true))||0,_8a4=_8a0+_8a2+(parseInt($.curCSS(this,"marginRight",true))||0),_8a5=_8a1+_8a3+(parseInt($.curCSS(this,"marginBottom",true))||0),_8a6=$.extend({},_89d),_8a7;
if(_896.my[0]==="right"){
_8a6.left-=_8a0;
}else{
if(_896.my[0]===_893){
_8a6.left-=_8a0/2;
}
}
if(_896.my[1]==="bottom"){
_8a6.top-=_8a1;
}else{
if(_896.my[1]===_893){
_8a6.top-=_8a1/2;
}
}
_8a6.left=Math.round(_8a6.left);
_8a6.top=Math.round(_8a6.top);
_8a7={left:_8a6.left-_8a2,top:_8a6.top-_8a3};
$.each(["left","top"],function(i,dir){
if($.ui.position[_899[i]]){
$.ui.position[_899[i]][dir](_8a6,{targetWidth:_89b,targetHeight:_89c,elemWidth:_8a0,elemHeight:_8a1,collisionPosition:_8a7,collisionWidth:_8a4,collisionHeight:_8a5,offset:_89a,my:_896.my,at:_896.at});
}
});
if($.fn.bgiframe){
elem.bgiframe();
}
elem.offset($.extend(_8a6,{using:_896.using}));
});
};
$.ui.position={fit:{left:function(_8aa,data){
var win=$(window),over=data.collisionPosition.left+data.collisionWidth-win.width()-win.scrollLeft();
_8aa.left=over>0?_8aa.left-over:Math.max(_8aa.left-data.collisionPosition.left,_8aa.left);
},top:function(_8ae,data){
var win=$(window),over=data.collisionPosition.top+data.collisionHeight-win.height()-win.scrollTop();
_8ae.top=over>0?_8ae.top-over:Math.max(_8ae.top-data.collisionPosition.top,_8ae.top);
}},flip:{left:function(_8b2,data){
if(data.at[0]===_893){
return;
}
var win=$(window),over=data.collisionPosition.left+data.collisionWidth-win.width()-win.scrollLeft(),_8b6=data.my[0]==="left"?-data.elemWidth:data.my[0]==="right"?data.elemWidth:0,_8b7=data.at[0]==="left"?data.targetWidth:-data.targetWidth,_8b8=-2*data.offset[0];
_8b2.left+=data.collisionPosition.left<0?_8b6+_8b7+_8b8:over>0?_8b6+_8b7+_8b8:0;
},top:function(_8b9,data){
if(data.at[1]===_893){
return;
}
var win=$(window),over=data.collisionPosition.top+data.collisionHeight-win.height()-win.scrollTop(),_8bd=data.my[1]==="top"?-data.elemHeight:data.my[1]==="bottom"?data.elemHeight:0,_8be=data.at[1]==="top"?data.targetHeight:-data.targetHeight,_8bf=-2*data.offset[1];
_8b9.top+=data.collisionPosition.top<0?_8bd+_8be+_8bf:over>0?_8bd+_8be+_8bf:0;
}}};
if(!$.offset.setOffset){
$.offset.setOffset=function(elem,_8c1){
if(/static/.test($.curCSS(elem,"position"))){
elem.style.position="relative";
}
var _8c2=$(elem),_8c3=_8c2.offset(),_8c4=parseInt($.curCSS(elem,"top",true),10)||0,_8c5=parseInt($.curCSS(elem,"left",true),10)||0,_8c6={top:(_8c1.top-_8c3.top)+_8c4,left:(_8c1.left-_8c3.left)+_8c5};
if("using" in _8c1){
_8c1.using.call(elem,_8c6);
}else{
_8c2.css(_8c6);
}
};
$.fn.offset=function(_8c7){
var elem=this[0];
if(!elem||!elem.ownerDocument){
return null;
}
if(_8c7){
return this.each(function(){
$.offset.setOffset(this,_8c7);
});
}
return _895.call(this);
};
}
}(jQuery));
(function($,_8ca){
$.widget("ui.draggable",$.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){
if(this.options.helper=="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){
this.element[0].style.position="relative";
}
(this.options.addClasses&&this.element.addClass("ui-draggable"));
(this.options.disabled&&this.element.addClass("ui-draggable-disabled"));
this._mouseInit();
},destroy:function(){
if(!this.element.data("draggable")){
return;
}
this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable"+" ui-draggable-dragging"+" ui-draggable-disabled");
this._mouseDestroy();
return this;
},_mouseCapture:function(_8cb){
var o=this.options;
if(this.helper||o.disabled||$(_8cb.target).is(".ui-resizable-handle")){
return false;
}
this.handle=this._getHandle(_8cb);
if(!this.handle){
return false;
}
return true;
},_mouseStart:function(_8cd){
var o=this.options;
this.helper=this._createHelper(_8cd);
this._cacheHelperProportions();
if($.ui.ddmanager){
$.ui.ddmanager.current=this;
}
this._cacheMargins();
this.cssPosition=this.helper.css("position");
this.scrollParent=this.helper.scrollParent();
this.offset=this.positionAbs=this.element.offset();
this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};
$.extend(this.offset,{click:{left:_8cd.pageX-this.offset.left,top:_8cd.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});
this.originalPosition=this.position=this._generatePosition(_8cd);
this.originalPageX=_8cd.pageX;
this.originalPageY=_8cd.pageY;
(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));
if(o.containment){
this._setContainment();
}
if(this._trigger("start",_8cd)===false){
this._clear();
return false;
}
this._cacheHelperProportions();
if($.ui.ddmanager&&!o.dropBehaviour){
$.ui.ddmanager.prepareOffsets(this,_8cd);
}
this.helper.addClass("ui-draggable-dragging");
this._mouseDrag(_8cd,true);
return true;
},_mouseDrag:function(_8cf,_8d0){
this.position=this._generatePosition(_8cf);
this.positionAbs=this._convertPositionTo("absolute");
if(!_8d0){
var ui=this._uiHash();
if(this._trigger("drag",_8cf,ui)===false){
this._mouseUp({});
return false;
}
this.position=ui.position;
}
if(!this.options.axis||this.options.axis!="y"){
this.helper[0].style.left=this.position.left+"px";
}
if(!this.options.axis||this.options.axis!="x"){
this.helper[0].style.top=this.position.top+"px";
}
if($.ui.ddmanager){
$.ui.ddmanager.drag(this,_8cf);
}
return false;
},_mouseStop:function(_8d2){
var _8d3=false;
if($.ui.ddmanager&&!this.options.dropBehaviour){
_8d3=$.ui.ddmanager.drop(this,_8d2);
}
if(this.dropped){
_8d3=this.dropped;
this.dropped=false;
}
if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original"){
return false;
}
if((this.options.revert=="invalid"&&!_8d3)||(this.options.revert=="valid"&&_8d3)||this.options.revert===true||($.isFunction(this.options.revert)&&this.options.revert.call(this.element,_8d3))){
var self=this;
$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){
if(self._trigger("stop",_8d2)!==false){
self._clear();
}
});
}else{
if(this._trigger("stop",_8d2)!==false){
this._clear();
}
}
return false;
},cancel:function(){
if(this.helper.is(".ui-draggable-dragging")){
this._mouseUp({});
}else{
this._clear();
}
return this;
},_getHandle:function(_8d5){
var _8d6=!this.options.handle||!$(this.options.handle,this.element).length?true:false;
$(this.options.handle,this.element).find("*").andSelf().each(function(){
if(this==_8d5.target){
_8d6=true;
}
});
return _8d6;
},_createHelper:function(_8d7){
var o=this.options;
var _8d9=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[_8d7])):(o.helper=="clone"?this.element.clone():this.element);
if(!_8d9.parents("body").length){
_8d9.appendTo((o.appendTo=="parent"?this.element[0].parentNode:o.appendTo));
}
if(_8d9[0]!=this.element[0]&&!(/(fixed|absolute)/).test(_8d9.css("position"))){
_8d9.css("position","absolute");
}
return _8d9;
},_adjustOffsetFromHelper:function(obj){
if(typeof obj=="string"){
obj=obj.split(" ");
}
if($.isArray(obj)){
obj={left:+obj[0],top:+obj[1]||0};
}
if("left" in obj){
this.offset.click.left=obj.left+this.margins.left;
}
if("right" in obj){
this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;
}
if("top" in obj){
this.offset.click.top=obj.top+this.margins.top;
}
if("bottom" in obj){
this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;
}
},_getParentOffset:function(){
this.offsetParent=this.helper.offsetParent();
var po=this.offsetParent.offset();
if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&$.ui.contains(this.scrollParent[0],this.offsetParent[0])){
po.left+=this.scrollParent.scrollLeft();
po.top+=this.scrollParent.scrollTop();
}
if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&$.browser.msie)){
po={top:0,left:0};
}
return {top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};
},_getRelativeOffset:function(){
if(this.cssPosition=="relative"){
var p=this.element.position();
return {top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()};
}else{
return {top:0,left:0};
}
},_cacheMargins:function(){
this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)};
},_cacheHelperProportions:function(){
this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};
},_setContainment:function(){
var o=this.options;
if(o.containment=="parent"){
o.containment=this.helper[0].parentNode;
}
if(o.containment=="document"||o.containment=="window"){
this.containment=[(o.containment=="document"?0:$(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,(o.containment=="document"?0:$(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,(o.containment=="document"?0:$(window).scrollLeft())+$(o.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(o.containment=="document"?0:$(window).scrollTop())+($(o.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];
}
if(!(/^(document|window|parent)$/).test(o.containment)&&o.containment.constructor!=Array){
var ce=$(o.containment)[0];
if(!ce){
return;
}
var co=$(o.containment).offset();
var over=($(ce).css("overflow")!="hidden");
this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0),co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0),co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];
}else{
if(o.containment.constructor==Array){
this.containment=o.containment;
}
}
},_convertPositionTo:function(d,pos){
if(!pos){
pos=this.position;
}
var mod=d=="absolute"?1:-1;
var o=this.options,_8e5=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&$.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,_8e6=(/(html|body)/i).test(_8e5[0].tagName);
return {top:(pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(_8e6?0:_8e5.scrollTop()))*mod)),left:(pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():_8e6?0:_8e5.scrollLeft())*mod))};
},_generatePosition:function(_8e7){
var o=this.options,_8e9=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&$.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,_8ea=(/(html|body)/i).test(_8e9[0].tagName);
var _8eb=_8e7.pageX;
var _8ec=_8e7.pageY;
if(this.originalPosition){
if(this.containment){
if(_8e7.pageX-this.offset.click.left<this.containment[0]){
_8eb=this.containment[0]+this.offset.click.left;
}
if(_8e7.pageY-this.offset.click.top<this.containment[1]){
_8ec=this.containment[1]+this.offset.click.top;
}
if(_8e7.pageX-this.offset.click.left>this.containment[2]){
_8eb=this.containment[2]+this.offset.click.left;
}
if(_8e7.pageY-this.offset.click.top>this.containment[3]){
_8ec=this.containment[3]+this.offset.click.top;
}
}
if(o.grid){
var top=this.originalPageY+Math.round((_8ec-this.originalPageY)/o.grid[1])*o.grid[1];
_8ec=this.containment?(!(top-this.offset.click.top<this.containment[1]||top-this.offset.click.top>this.containment[3])?top:(!(top-this.offset.click.top<this.containment[1])?top-o.grid[1]:top+o.grid[1])):top;
var left=this.originalPageX+Math.round((_8eb-this.originalPageX)/o.grid[0])*o.grid[0];
_8eb=this.containment?(!(left-this.offset.click.left<this.containment[0]||left-this.offset.click.left>this.containment[2])?left:(!(left-this.offset.click.left<this.containment[0])?left-o.grid[0]:left+o.grid[0])):left;
}
}
return {top:(_8ec-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(_8ea?0:_8e9.scrollTop())))),left:(_8eb-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():_8ea?0:_8e9.scrollLeft())))};
},_clear:function(){
this.helper.removeClass("ui-draggable-dragging");
if(this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval){
this.helper.remove();
}
this.helper=null;
this.cancelHelperRemoval=false;
},_trigger:function(type,_8f0,ui){
ui=ui||this._uiHash();
$.ui.plugin.call(this,type,[_8f0,ui]);
if(type=="drag"){
this.positionAbs=this._convertPositionTo("absolute");
}
return $.Widget.prototype._trigger.call(this,type,_8f0,ui);
},plugins:{},_uiHash:function(_8f2){
return {helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs};
}});
$.extend($.ui.draggable,{version:"1.8.11"});
$.ui.plugin.add("draggable","connectToSortable",{start:function(_8f3,ui){
var inst=$(this).data("draggable"),o=inst.options,_8f7=$.extend({},ui,{item:inst.element});
inst.sortables=[];
$(o.connectToSortable).each(function(){
var _8f8=$.data(this,"sortable");
if(_8f8&&!_8f8.options.disabled){
inst.sortables.push({instance:_8f8,shouldRevert:_8f8.options.revert});
_8f8.refreshPositions();
_8f8._trigger("activate",_8f3,_8f7);
}
});
},stop:function(_8f9,ui){
var inst=$(this).data("draggable"),_8fc=$.extend({},ui,{item:inst.element});
$.each(inst.sortables,function(){
if(this.instance.isOver){
this.instance.isOver=0;
inst.cancelHelperRemoval=true;
this.instance.cancelHelperRemoval=false;
if(this.shouldRevert){
this.instance.options.revert=true;
}
this.instance._mouseStop(_8f9);
this.instance.options.helper=this.instance.options._helper;
if(inst.options.helper=="original"){
this.instance.currentItem.css({top:"auto",left:"auto"});
}
}else{
this.instance.cancelHelperRemoval=false;
this.instance._trigger("deactivate",_8f9,_8fc);
}
});
},drag:function(_8fd,ui){
var inst=$(this).data("draggable"),self=this;
var _901=function(o){
var _903=this.offset.click.top,_904=this.offset.click.left;
var _905=this.positionAbs.top,_906=this.positionAbs.left;
var _907=o.height,_908=o.width;
var _909=o.top,_90a=o.left;
return $.ui.isOver(_905+_903,_906+_904,_909,_90a,_907,_908);
};
$.each(inst.sortables,function(i){
this.instance.positionAbs=inst.positionAbs;
this.instance.helperProportions=inst.helperProportions;
this.instance.offset.click=inst.offset.click;
if(this.instance._intersectsWith(this.instance.containerCache)){
if(!this.instance.isOver){
this.instance.isOver=1;
this.instance.currentItem=$(self).clone().appendTo(this.instance.element).data("sortable-item",true);
this.instance.options._helper=this.instance.options.helper;
this.instance.options.helper=function(){
return ui.helper[0];
};
_8fd.target=this.instance.currentItem[0];
this.instance._mouseCapture(_8fd,true);
this.instance._mouseStart(_8fd,true,true);
this.instance.offset.click.top=inst.offset.click.top;
this.instance.offset.click.left=inst.offset.click.left;
this.instance.offset.parent.left-=inst.offset.parent.left-this.instance.offset.parent.left;
this.instance.offset.parent.top-=inst.offset.parent.top-this.instance.offset.parent.top;
inst._trigger("toSortable",_8fd);
inst.dropped=this.instance.element;
inst.currentItem=inst.element;
this.instance.fromOutside=inst;
}
if(this.instance.currentItem){
this.instance._mouseDrag(_8fd);
}
}else{
if(this.instance.isOver){
this.instance.isOver=0;
this.instance.cancelHelperRemoval=true;
this.instance.options.revert=false;
this.instance._trigger("out",_8fd,this.instance._uiHash(this.instance));
this.instance._mouseStop(_8fd,true);
this.instance.options.helper=this.instance.options._helper;
this.instance.currentItem.remove();
if(this.instance.placeholder){
this.instance.placeholder.remove();
}
inst._trigger("fromSortable",_8fd);
inst.dropped=false;
}
}
});
}});
$.ui.plugin.add("draggable","cursor",{start:function(_90c,ui){
var t=$("body"),o=$(this).data("draggable").options;
if(t.css("cursor")){
o._cursor=t.css("cursor");
}
t.css("cursor",o.cursor);
},stop:function(_910,ui){
var o=$(this).data("draggable").options;
if(o._cursor){
$("body").css("cursor",o._cursor);
}
}});
$.ui.plugin.add("draggable","iframeFix",{start:function(_913,ui){
var o=$(this).data("draggable").options;
$(o.iframeFix===true?"iframe":o.iframeFix).each(function(){
$("<div class=\"ui-draggable-iframeFix\" style=\"background: #fff;\"></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css($(this).offset()).appendTo("body");
});
},stop:function(_916,ui){
$("div.ui-draggable-iframeFix").each(function(){
this.parentNode.removeChild(this);
});
}});
$.ui.plugin.add("draggable","opacity",{start:function(_918,ui){
var t=$(ui.helper),o=$(this).data("draggable").options;
if(t.css("opacity")){
o._opacity=t.css("opacity");
}
t.css("opacity",o.opacity);
},stop:function(_91c,ui){
var o=$(this).data("draggable").options;
if(o._opacity){
$(ui.helper).css("opacity",o._opacity);
}
}});
$.ui.plugin.add("draggable","scroll",{start:function(_91f,ui){
var i=$(this).data("draggable");
if(i.scrollParent[0]!=document&&i.scrollParent[0].tagName!="HTML"){
i.overflowOffset=i.scrollParent.offset();
}
},drag:function(_922,ui){
var i=$(this).data("draggable"),o=i.options,_926=false;
if(i.scrollParent[0]!=document&&i.scrollParent[0].tagName!="HTML"){
if(!o.axis||o.axis!="x"){
if((i.overflowOffset.top+i.scrollParent[0].offsetHeight)-_922.pageY<o.scrollSensitivity){
i.scrollParent[0].scrollTop=_926=i.scrollParent[0].scrollTop+o.scrollSpeed;
}else{
if(_922.pageY-i.overflowOffset.top<o.scrollSensitivity){
i.scrollParent[0].scrollTop=_926=i.scrollParent[0].scrollTop-o.scrollSpeed;
}
}
}
if(!o.axis||o.axis!="y"){
if((i.overflowOffset.left+i.scrollParent[0].offsetWidth)-_922.pageX<o.scrollSensitivity){
i.scrollParent[0].scrollLeft=_926=i.scrollParent[0].scrollLeft+o.scrollSpeed;
}else{
if(_922.pageX-i.overflowOffset.left<o.scrollSensitivity){
i.scrollParent[0].scrollLeft=_926=i.scrollParent[0].scrollLeft-o.scrollSpeed;
}
}
}
}else{
if(!o.axis||o.axis!="x"){
if(_922.pageY-$(document).scrollTop()<o.scrollSensitivity){
_926=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);
}else{
if($(window).height()-(_922.pageY-$(document).scrollTop())<o.scrollSensitivity){
_926=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);
}
}
}
if(!o.axis||o.axis!="y"){
if(_922.pageX-$(document).scrollLeft()<o.scrollSensitivity){
_926=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);
}else{
if($(window).width()-(_922.pageX-$(document).scrollLeft())<o.scrollSensitivity){
_926=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed);
}
}
}
}
if(_926!==false&&$.ui.ddmanager&&!o.dropBehaviour){
$.ui.ddmanager.prepareOffsets(i,_922);
}
}});
$.ui.plugin.add("draggable","snap",{start:function(_927,ui){
var i=$(this).data("draggable"),o=i.options;
i.snapElements=[];
$(o.snap.constructor!=String?(o.snap.items||":data(draggable)"):o.snap).each(function(){
var $t=$(this);
var $o=$t.offset();
if(this!=i.element[0]){
i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left});
}
});
},drag:function(_92d,ui){
var inst=$(this).data("draggable"),o=inst.options;
var d=o.snapTolerance;
var x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;
for(var i=inst.snapElements.length-1;i>=0;i--){
var l=inst.snapElements[i].left,r=l+inst.snapElements[i].width,t=inst.snapElements[i].top,b=t+inst.snapElements[i].height;
if(!((l-d<x1&&x1<r+d&&t-d<y1&&y1<b+d)||(l-d<x1&&x1<r+d&&t-d<y2&&y2<b+d)||(l-d<x2&&x2<r+d&&t-d<y1&&y1<b+d)||(l-d<x2&&x2<r+d&&t-d<y2&&y2<b+d))){
if(inst.snapElements[i].snapping){
(inst.options.snap.release&&inst.options.snap.release.call(inst.element,_92d,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));
}
inst.snapElements[i].snapping=false;
continue;
}
if(o.snapMode!="inner"){
var ts=Math.abs(t-y2)<=d;
var bs=Math.abs(b-y1)<=d;
var ls=Math.abs(l-x2)<=d;
var rs=Math.abs(r-x1)<=d;
if(ts){
ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top-inst.margins.top;
}
if(bs){
ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top-inst.margins.top;
}
if(ls){
ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left-inst.margins.left;
}
if(rs){
ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left-inst.margins.left;
}
}
var _93f=(ts||bs||ls||rs);
if(o.snapMode!="outer"){
var ts=Math.abs(t-y1)<=d;
var bs=Math.abs(b-y2)<=d;
var ls=Math.abs(l-x1)<=d;
var rs=Math.abs(r-x2)<=d;
if(ts){
ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top-inst.margins.top;
}
if(bs){
ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top-inst.margins.top;
}
if(ls){
ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left-inst.margins.left;
}
if(rs){
ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left-inst.margins.left;
}
}
if(!inst.snapElements[i].snapping&&(ts||bs||ls||rs||_93f)){
(inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,_92d,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));
}
inst.snapElements[i].snapping=(ts||bs||ls||rs||_93f);
}
}});
$.ui.plugin.add("draggable","stack",{start:function(_940,ui){
var o=$(this).data("draggable").options;
var _943=$.makeArray($(o.stack)).sort(function(a,b){
return (parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0);
});
if(!_943.length){
return;
}
var min=parseInt(_943[0].style.zIndex)||0;
$(_943).each(function(i){
this.style.zIndex=min+i;
});
this[0].style.zIndex=min+_943.length;
}});
$.ui.plugin.add("draggable","zIndex",{start:function(_948,ui){
var t=$(ui.helper),o=$(this).data("draggable").options;
if(t.css("zIndex")){
o._zIndex=t.css("zIndex");
}
t.css("zIndex",o.zIndex);
},stop:function(_94c,ui){
var o=$(this).data("draggable").options;
if(o._zIndex){
$(ui.helper).css("zIndex",o._zIndex);
}
}});
})(jQuery);
(function($,_950){
$.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){
var o=this.options,_952=o.accept;
this.isover=0;
this.isout=1;
this.accept=$.isFunction(_952)?_952:function(d){
return d.is(_952);
};
this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};
$.ui.ddmanager.droppables[o.scope]=$.ui.ddmanager.droppables[o.scope]||[];
$.ui.ddmanager.droppables[o.scope].push(this);
(o.addClasses&&this.element.addClass("ui-droppable"));
},destroy:function(){
var drop=$.ui.ddmanager.droppables[this.options.scope];
for(var i=0;i<drop.length;i++){
if(drop[i]==this){
drop.splice(i,1);
}
}
this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");
return this;
},_setOption:function(key,_957){
if(key=="accept"){
this.accept=$.isFunction(_957)?_957:function(d){
return d.is(_957);
};
}
$.Widget.prototype._setOption.apply(this,arguments);
},_activate:function(_959){
var _95a=$.ui.ddmanager.current;
if(this.options.activeClass){
this.element.addClass(this.options.activeClass);
}
(_95a&&this._trigger("activate",_959,this.ui(_95a)));
},_deactivate:function(_95b){
var _95c=$.ui.ddmanager.current;
if(this.options.activeClass){
this.element.removeClass(this.options.activeClass);
}
(_95c&&this._trigger("deactivate",_95b,this.ui(_95c)));
},_over:function(_95d){
var _95e=$.ui.ddmanager.current;
if(!_95e||(_95e.currentItem||_95e.element)[0]==this.element[0]){
return;
}
if(this.accept.call(this.element[0],(_95e.currentItem||_95e.element))){
if(this.options.hoverClass){
this.element.addClass(this.options.hoverClass);
}
this._trigger("over",_95d,this.ui(_95e));
}
},_out:function(_95f){
var _960=$.ui.ddmanager.current;
if(!_960||(_960.currentItem||_960.element)[0]==this.element[0]){
return;
}
if(this.accept.call(this.element[0],(_960.currentItem||_960.element))){
if(this.options.hoverClass){
this.element.removeClass(this.options.hoverClass);
}
this._trigger("out",_95f,this.ui(_960));
}
},_drop:function(_961,_962){
var _963=_962||$.ui.ddmanager.current;
if(!_963||(_963.currentItem||_963.element)[0]==this.element[0]){
return false;
}
var _964=false;
this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){
var inst=$.data(this,"droppable");
if(inst.options.greedy&&!inst.options.disabled&&inst.options.scope==_963.options.scope&&inst.accept.call(inst.element[0],(_963.currentItem||_963.element))&&$.ui.intersect(_963,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance)){
_964=true;
return false;
}
});
if(_964){
return false;
}
if(this.accept.call(this.element[0],(_963.currentItem||_963.element))){
if(this.options.activeClass){
this.element.removeClass(this.options.activeClass);
}
if(this.options.hoverClass){
this.element.removeClass(this.options.hoverClass);
}
this._trigger("drop",_961,this.ui(_963));
return this.element;
}
return false;
},ui:function(c){
return {draggable:(c.currentItem||c.element),helper:c.helper,position:c.position,offset:c.positionAbs};
}});
$.extend($.ui.droppable,{version:"1.8.11"});
$.ui.intersect=function(_967,_968,_969){
if(!_968.offset){
return false;
}
var x1=(_967.positionAbs||_967.position.absolute).left,x2=x1+_967.helperProportions.width,y1=(_967.positionAbs||_967.position.absolute).top,y2=y1+_967.helperProportions.height;
var l=_968.offset.left,r=l+_968.proportions.width,t=_968.offset.top,b=t+_968.proportions.height;
switch(_969){
case "fit":
return (l<=x1&&x2<=r&&t<=y1&&y2<=b);
break;
case "intersect":
return (l<x1+(_967.helperProportions.width/2)&&x2-(_967.helperProportions.width/2)<r&&t<y1+(_967.helperProportions.height/2)&&y2-(_967.helperProportions.height/2)<b);
break;
case "pointer":
var _972=((_967.positionAbs||_967.position.absolute).left+(_967.clickOffset||_967.offset.click).left),_973=((_967.positionAbs||_967.position.absolute).top+(_967.clickOffset||_967.offset.click).top),_974=$.ui.isOver(_973,_972,t,l,_968.proportions.height,_968.proportions.width);
return _974;
break;
case "touch":
return ((y1>=t&&y1<=b)||(y2>=t&&y2<=b)||(y1<t&&y2>b))&&((x1>=l&&x1<=r)||(x2>=l&&x2<=r)||(x1<l&&x2>r));
break;
default:
return false;
break;
}
};
$.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,_976){
var m=$.ui.ddmanager.droppables[t.options.scope]||[];
var type=_976?_976.type:null;
var list=(t.currentItem||t.element).find(":data(droppable)").andSelf();
droppablesLoop:
for(var i=0;i<m.length;i++){
if(m[i].options.disabled||(t&&!m[i].accept.call(m[i].element[0],(t.currentItem||t.element)))){
continue;
}
for(var j=0;j<list.length;j++){
if(list[j]==m[i].element[0]){
m[i].proportions.height=0;
continue droppablesLoop;
}
}
m[i].visible=m[i].element.css("display")!="none";
if(!m[i].visible){
continue;
}
if(type=="mousedown"){
m[i]._activate.call(m[i],_976);
}
m[i].offset=m[i].element.offset();
m[i].proportions={width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight};
}
},drop:function(_97c,_97d){
var _97e=false;
$.each($.ui.ddmanager.droppables[_97c.options.scope]||[],function(){
if(!this.options){
return;
}
if(!this.options.disabled&&this.visible&&$.ui.intersect(_97c,this,this.options.tolerance)){
_97e=_97e||this._drop.call(this,_97d);
}
if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(_97c.currentItem||_97c.element))){
this.isout=1;
this.isover=0;
this._deactivate.call(this,_97d);
}
});
return _97e;
},drag:function(_97f,_980){
if(_97f.options.refreshPositions){
$.ui.ddmanager.prepareOffsets(_97f,_980);
}
$.each($.ui.ddmanager.droppables[_97f.options.scope]||[],function(){
if(this.options.disabled||this.greedyChild||!this.visible){
return;
}
var _981=$.ui.intersect(_97f,this,this.options.tolerance);
var c=!_981&&this.isover==1?"isout":(_981&&this.isover==0?"isover":null);
if(!c){
return;
}
var _983;
if(this.options.greedy){
var _984=this.element.parents(":data(droppable):eq(0)");
if(_984.length){
_983=$.data(_984[0],"droppable");
_983.greedyChild=(c=="isover"?1:0);
}
}
if(_983&&c=="isover"){
_983["isover"]=0;
_983["isout"]=1;
_983._out.call(_983,_980);
}
this[c]=1;
this[c=="isout"?"isover":"isout"]=0;
this[c=="isover"?"_over":"_out"].call(this,_980);
if(_983&&c=="isout"){
_983["isout"]=0;
_983["isover"]=1;
_983._over.call(_983,_980);
}
});
}};
})(jQuery);
(function($,_986){
$.widget("ui.resizable",$.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){
var self=this,o=this.options;
this.element.addClass("ui-resizable");
$.extend(this,{_aspectRatio:!!(o.aspectRatio),aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null});
if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){
if(/relative/.test(this.element.css("position"))&&$.browser.opera){
this.element.css({position:"relative",top:"auto",left:"auto"});
}
this.element.wrap($("<div class=\"ui-wrapper\" style=\"overflow: hidden;\"></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));
this.element=this.element.parent().data("resizable",this.element.data("resizable"));
this.elementIsWrapper=true;
this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});
this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});
this.originalResizeStyle=this.originalElement.css("resize");
this.originalElement.css("resize","none");
this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));
this.originalElement.css({margin:this.originalElement.css("margin")});
this._proportionallyResize();
}
this.handles=o.handles||(!$(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});
if(this.handles.constructor==String){
if(this.handles=="all"){
this.handles="n,e,s,w,se,sw,ne,nw";
}
var n=this.handles.split(",");
this.handles={};
for(var i=0;i<n.length;i++){
var _98b=$.trim(n[i]),_98c="ui-resizable-"+_98b;
var axis=$("<div class=\"ui-resizable-handle "+_98c+"\"></div>");
if(/sw|se|ne|nw/.test(_98b)){
axis.css({zIndex:++o.zIndex});
}
if("se"==_98b){
axis.addClass("ui-icon ui-icon-gripsmall-diagonal-se");
}
this.handles[_98b]=".ui-resizable-"+_98b;
this.element.append(axis);
}
}
this._renderAxis=function(_98e){
_98e=_98e||this.element;
for(var i in this.handles){
if(this.handles[i].constructor==String){
this.handles[i]=$(this.handles[i],this.element).show();
}
if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){
var axis=$(this.handles[i],this.element),_991=0;
_991=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth();
var _992=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");
_98e.css(_992,_991);
this._proportionallyResize();
}
if(!$(this.handles[i]).length){
continue;
}
}
};
this._renderAxis(this.element);
this._handles=$(".ui-resizable-handle",this.element).disableSelection();
this._handles.mouseover(function(){
if(!self.resizing){
if(this.className){
var axis=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);
}
self.axis=axis&&axis[1]?axis[1]:"se";
}
});
if(o.autoHide){
this._handles.hide();
$(this.element).addClass("ui-resizable-autohide").hover(function(){
$(this).removeClass("ui-resizable-autohide");
self._handles.show();
},function(){
if(!self.resizing){
$(this).addClass("ui-resizable-autohide");
self._handles.hide();
}
});
}
this._mouseInit();
},destroy:function(){
this._mouseDestroy();
var _994=function(exp){
$(exp).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove();
};
if(this.elementIsWrapper){
_994(this.element);
var _996=this.element;
_996.after(this.originalElement.css({position:_996.css("position"),width:_996.outerWidth(),height:_996.outerHeight(),top:_996.css("top"),left:_996.css("left")})).remove();
}
this.originalElement.css("resize",this.originalResizeStyle);
_994(this.originalElement);
return this;
},_mouseCapture:function(_997){
var _998=false;
for(var i in this.handles){
if($(this.handles[i])[0]==_997.target){
_998=true;
}
}
return !this.options.disabled&&_998;
},_mouseStart:function(_99a){
var o=this.options,_99c=this.element.position(),el=this.element;
this.resizing=true;
this.documentScroll={top:$(document).scrollTop(),left:$(document).scrollLeft()};
if(el.is(".ui-draggable")||(/absolute/).test(el.css("position"))){
el.css({position:"absolute",top:_99c.top,left:_99c.left});
}
if($.browser.opera&&(/relative/).test(el.css("position"))){
el.css({position:"relative",top:"auto",left:"auto"});
}
this._renderProxy();
var _99e=num(this.helper.css("left")),_9a0=num(this.helper.css("top"));
if(o.containment){
_99e+=$(o.containment).scrollLeft()||0;
_9a0+=$(o.containment).scrollTop()||0;
}
this.offset=this.helper.offset();
this.position={left:_99e,top:_9a0};
this.size=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()};
this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()};
this.originalPosition={left:_99e,top:_9a0};
this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()};
this.originalMousePosition={left:_99a.pageX,top:_99a.pageY};
this.aspectRatio=(typeof o.aspectRatio=="number")?o.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);
var _9a1=$(".ui-resizable-"+this.axis).css("cursor");
$("body").css("cursor",_9a1=="auto"?this.axis+"-resize":_9a1);
el.addClass("ui-resizable-resizing");
this._propagate("start",_99a);
return true;
},_mouseDrag:function(_9a2){
var el=this.helper,o=this.options,_9a5={},self=this,smp=this.originalMousePosition,a=this.axis;
var dx=(_9a2.pageX-smp.left)||0,dy=(_9a2.pageY-smp.top)||0;
var _9ab=this._change[a];
if(!_9ab){
return false;
}
var data=_9ab.apply(this,[_9a2,dx,dy]),ie6=$.browser.msie&&$.browser.version<7,_9ae=this.sizeDiff;
if(this._aspectRatio||_9a2.shiftKey){
data=this._updateRatio(data,_9a2);
}
data=this._respectSize(data,_9a2);
this._propagate("resize",_9a2);
el.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});
if(!this._helper&&this._proportionallyResizeElements.length){
this._proportionallyResize();
}
this._updateCache(data);
this._trigger("resize",_9a2,this.ui());
return false;
},_mouseStop:function(_9af){
this.resizing=false;
var o=this.options,self=this;
if(this._helper){
var pr=this._proportionallyResizeElements,ista=pr.length&&(/textarea/i).test(pr[0].nodeName),_9b4=ista&&$.ui.hasScroll(pr[0],"left")?0:self.sizeDiff.height,_9b5=ista?0:self.sizeDiff.width;
var s={width:(self.helper.width()-_9b5),height:(self.helper.height()-_9b4)},left=(parseInt(self.element.css("left"),10)+(self.position.left-self.originalPosition.left))||null,top=(parseInt(self.element.css("top"),10)+(self.position.top-self.originalPosition.top))||null;
if(!o.animate){
this.element.css($.extend(s,{top:top,left:left}));
}
self.helper.height(self.size.height);
self.helper.width(self.size.width);
if(this._helper&&!o.animate){
this._proportionallyResize();
}
}
$("body").css("cursor","auto");
this.element.removeClass("ui-resizable-resizing");
this._propagate("stop",_9af);
if(this._helper){
this.helper.remove();
}
return false;
},_updateCache:function(data){
var o=this.options;
this.offset=this.helper.offset();
if(_9bb(data.left)){
this.position.left=data.left;
}
if(_9bb(data.top)){
this.position.top=data.top;
}
if(_9bb(data.height)){
this.size.height=data.height;
}
if(_9bb(data.width)){
this.size.width=data.width;
}
},_updateRatio:function(data,_9bd){
var o=this.options,cpos=this.position,_9c0=this.size,a=this.axis;
if(data.height){
data.width=(_9c0.height*this.aspectRatio);
}else{
if(data.width){
data.height=(_9c0.width/this.aspectRatio);
}
}
if(a=="sw"){
data.left=cpos.left+(_9c0.width-data.width);
data.top=null;
}
if(a=="nw"){
data.top=cpos.top+(_9c0.height-data.height);
data.left=cpos.left+(_9c0.width-data.width);
}
return data;
},_respectSize:function(data,_9c3){
var el=this.helper,o=this.options,_9c6=this._aspectRatio||_9c3.shiftKey,a=this.axis,_9c8=_9bb(data.width)&&o.maxWidth&&(o.maxWidth<data.width),_9c9=_9bb(data.height)&&o.maxHeight&&(o.maxHeight<data.height),_9ca=_9bb(data.width)&&o.minWidth&&(o.minWidth>data.width),_9cb=_9bb(data.height)&&o.minHeight&&(o.minHeight>data.height);
if(_9ca){
data.width=o.minWidth;
}
if(_9cb){
data.height=o.minHeight;
}
if(_9c8){
data.width=o.maxWidth;
}
if(_9c9){
data.height=o.maxHeight;
}
var dw=this.originalPosition.left+this.originalSize.width,dh=this.position.top+this.size.height;
var cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);
if(_9ca&&cw){
data.left=dw-o.minWidth;
}
if(_9c8&&cw){
data.left=dw-o.maxWidth;
}
if(_9cb&&ch){
data.top=dh-o.minHeight;
}
if(_9c9&&ch){
data.top=dh-o.maxHeight;
}
var _9d0=!data.width&&!data.height;
if(_9d0&&!data.left&&data.top){
data.top=null;
}else{
if(_9d0&&!data.top&&data.left){
data.left=null;
}
}
return data;
},_proportionallyResize:function(){
var o=this.options;
if(!this._proportionallyResizeElements.length){
return;
}
var _9d2=this.helper||this.element;
for(var i=0;i<this._proportionallyResizeElements.length;i++){
var prel=this._proportionallyResizeElements[i];
if(!this.borderDif){
var b=[prel.css("borderTopWidth"),prel.css("borderRightWidth"),prel.css("borderBottomWidth"),prel.css("borderLeftWidth")],p=[prel.css("paddingTop"),prel.css("paddingRight"),prel.css("paddingBottom"),prel.css("paddingLeft")];
this.borderDif=$.map(b,function(v,i){
var _9d9=parseInt(v,10)||0,_9da=parseInt(p[i],10)||0;
return _9d9+_9da;
});
}
if($.browser.msie&&!(!($(_9d2).is(":hidden")||$(_9d2).parents(":hidden").length))){
continue;
}
prel.css({height:(_9d2.height()-this.borderDif[0]-this.borderDif[2])||0,width:(_9d2.width()-this.borderDif[1]-this.borderDif[3])||0});
}
},_renderProxy:function(){
var el=this.element,o=this.options;
this.elementOffset=el.offset();
if(this._helper){
this.helper=this.helper||$("<div style=\"overflow:hidden;\"></div>");
var ie6=$.browser.msie&&$.browser.version<7,_9de=(ie6?1:0),_9df=(ie6?2:-1);
this.helper.addClass(this._helper).css({width:this.element.outerWidth()+_9df,height:this.element.outerHeight()+_9df,position:"absolute",left:this.elementOffset.left-_9de+"px",top:this.elementOffset.top-_9de+"px",zIndex:++o.zIndex});
this.helper.appendTo("body").disableSelection();
}else{
this.helper=this.element;
}
},_change:{e:function(_9e0,dx,dy){
return {width:this.originalSize.width+dx};
},w:function(_9e3,dx,dy){
var o=this.options,cs=this.originalSize,sp=this.originalPosition;
return {left:sp.left+dx,width:cs.width-dx};
},n:function(_9e9,dx,dy){
var o=this.options,cs=this.originalSize,sp=this.originalPosition;
return {top:sp.top+dy,height:cs.height-dy};
},s:function(_9ef,dx,dy){
return {height:this.originalSize.height+dy};
},se:function(_9f2,dx,dy){
return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[_9f2,dx,dy]));
},sw:function(_9f5,dx,dy){
return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[_9f5,dx,dy]));
},ne:function(_9f8,dx,dy){
return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[_9f8,dx,dy]));
},nw:function(_9fb,dx,dy){
return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[_9fb,dx,dy]));
}},_propagate:function(n,_9ff){
$.ui.plugin.call(this,n,[_9ff,this.ui()]);
(n!="resize"&&this._trigger(n,_9ff,this.ui()));
},plugins:{},ui:function(){
return {originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition};
}});
$.extend($.ui.resizable,{version:"1.8.11"});
$.ui.plugin.add("resizable","alsoResize",{start:function(_a00,ui){
var self=$(this).data("resizable"),o=self.options;
var _a04=function(exp){
$(exp).each(function(){
var el=$(this);
el.data("resizable-alsoresize",{width:parseInt(el.width(),10),height:parseInt(el.height(),10),left:parseInt(el.css("left"),10),top:parseInt(el.css("top"),10),position:el.css("position")});
});
};
if(typeof (o.alsoResize)=="object"&&!o.alsoResize.parentNode){
if(o.alsoResize.length){
o.alsoResize=o.alsoResize[0];
_a04(o.alsoResize);
}else{
$.each(o.alsoResize,function(exp){
_a04(exp);
});
}
}else{
_a04(o.alsoResize);
}
},resize:function(_a08,ui){
var self=$(this).data("resizable"),o=self.options,os=self.originalSize,op=self.originalPosition;
var _a0e={height:(self.size.height-os.height)||0,width:(self.size.width-os.width)||0,top:(self.position.top-op.top)||0,left:(self.position.left-op.left)||0},_a0f=function(exp,c){
$(exp).each(function(){
var el=$(this),_a13=$(this).data("resizable-alsoresize"),_a14={},css=c&&c.length?c:el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];
$.each(css,function(i,prop){
var sum=(_a13[prop]||0)+(_a0e[prop]||0);
if(sum&&sum>=0){
_a14[prop]=sum||null;
}
});
if($.browser.opera&&/relative/.test(el.css("position"))){
self._revertToRelativePosition=true;
el.css({position:"absolute",top:"auto",left:"auto"});
}
el.css(_a14);
});
};
if(typeof (o.alsoResize)=="object"&&!o.alsoResize.nodeType){
$.each(o.alsoResize,function(exp,c){
_a0f(exp,c);
});
}else{
_a0f(o.alsoResize);
}
},stop:function(_a1b,ui){
var self=$(this).data("resizable"),o=self.options;
var _a1f=function(exp){
$(exp).each(function(){
var el=$(this);
el.css({position:el.data("resizable-alsoresize").position});
});
};
if(self._revertToRelativePosition){
self._revertToRelativePosition=false;
if(typeof (o.alsoResize)=="object"&&!o.alsoResize.nodeType){
$.each(o.alsoResize,function(exp){
_a1f(exp);
});
}else{
_a1f(o.alsoResize);
}
}
$(this).removeData("resizable-alsoresize");
}});
$.ui.plugin.add("resizable","animate",{stop:function(_a23,ui){
var self=$(this).data("resizable"),o=self.options;
var pr=self._proportionallyResizeElements,ista=pr.length&&(/textarea/i).test(pr[0].nodeName),_a29=ista&&$.ui.hasScroll(pr[0],"left")?0:self.sizeDiff.height,_a2a=ista?0:self.sizeDiff.width;
var _a2b={width:(self.size.width-_a2a),height:(self.size.height-_a29)},left=(parseInt(self.element.css("left"),10)+(self.position.left-self.originalPosition.left))||null,top=(parseInt(self.element.css("top"),10)+(self.position.top-self.originalPosition.top))||null;
self.element.animate($.extend(_a2b,top&&left?{top:top,left:left}:{}),{duration:o.animateDuration,easing:o.animateEasing,step:function(){
var data={width:parseInt(self.element.css("width"),10),height:parseInt(self.element.css("height"),10),top:parseInt(self.element.css("top"),10),left:parseInt(self.element.css("left"),10)};
if(pr&&pr.length){
$(pr[0]).css({width:data.width,height:data.height});
}
self._updateCache(data);
self._propagate("resize",_a23);
}});
}});
$.ui.plugin.add("resizable","containment",{start:function(_a2f,ui){
var self=$(this).data("resizable"),o=self.options,el=self.element;
var oc=o.containment,ce=(oc instanceof $)?oc.get(0):(/parent/.test(oc))?el.parent().get(0):oc;
if(!ce){
return;
}
self.containerElement=$(ce);
if(/document/.test(oc)||oc==document){
self.containerOffset={left:0,top:0};
self.containerPosition={left:0,top:0};
self.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight};
}else{
var _a36=$(ce),p=[];
$(["Top","Right","Left","Bottom"]).each(function(i,name){
p[i]=num(_a36.css("padding"+name));
});
self.containerOffset=_a36.offset();
self.containerPosition=_a36.position();
self.containerSize={height:(_a36.innerHeight()-p[3]),width:(_a36.innerWidth()-p[1])};
var co=self.containerOffset,ch=self.containerSize.height,cw=self.containerSize.width,_a3d=($.ui.hasScroll(ce,"left")?ce.scrollWidth:cw),_a3e=($.ui.hasScroll(ce)?ce.scrollHeight:ch);
self.parentData={element:ce,left:co.left,top:co.top,width:_a3d,height:_a3e};
}
},resize:function(_a3f,ui){
var self=$(this).data("resizable"),o=self.options,ps=self.containerSize,co=self.containerOffset,cs=self.size,cp=self.position,_a47=self._aspectRatio||_a3f.shiftKey,cop={top:0,left:0},ce=self.containerElement;
if(ce[0]!=document&&(/static/).test(ce.css("position"))){
cop=co;
}
if(cp.left<(self._helper?co.left:0)){
self.size.width=self.size.width+(self._helper?(self.position.left-co.left):(self.position.left-cop.left));
if(_a47){
self.size.height=self.size.width/o.aspectRatio;
}
self.position.left=o.helper?co.left:0;
}
if(cp.top<(self._helper?co.top:0)){
self.size.height=self.size.height+(self._helper?(self.position.top-co.top):self.position.top);
if(_a47){
self.size.width=self.size.height*o.aspectRatio;
}
self.position.top=self._helper?co.top:0;
}
self.offset.left=self.parentData.left+self.position.left;
self.offset.top=self.parentData.top+self.position.top;
var _a4a=Math.abs((self._helper?self.offset.left-cop.left:(self.offset.left-cop.left))+self.sizeDiff.width),_a4b=Math.abs((self._helper?self.offset.top-cop.top:(self.offset.top-co.top))+self.sizeDiff.height);
var _a4c=self.containerElement.get(0)==self.element.parent().get(0),_a4d=/relative|absolute/.test(self.containerElement.css("position"));
if(_a4c&&_a4d){
_a4a-=self.parentData.left;
}
if(_a4a+self.size.width>=self.parentData.width){
self.size.width=self.parentData.width-_a4a;
if(_a47){
self.size.height=self.size.width/self.aspectRatio;
}
}
if(_a4b+self.size.height>=self.parentData.height){
self.size.height=self.parentData.height-_a4b;
if(_a47){
self.size.width=self.size.height*self.aspectRatio;
}
}
},stop:function(_a4e,ui){
var self=$(this).data("resizable"),o=self.options,cp=self.position,co=self.containerOffset,cop=self.containerPosition,ce=self.containerElement;
var _a56=$(self.helper),ho=_a56.offset(),w=_a56.outerWidth()-self.sizeDiff.width,h=_a56.outerHeight()-self.sizeDiff.height;
if(self._helper&&!o.animate&&(/relative/).test(ce.css("position"))){
$(this).css({left:ho.left-cop.left-co.left,width:w,height:h});
}
if(self._helper&&!o.animate&&(/static/).test(ce.css("position"))){
$(this).css({left:ho.left-cop.left-co.left,width:w,height:h});
}
}});
$.ui.plugin.add("resizable","ghost",{start:function(_a5a,ui){
var self=$(this).data("resizable"),o=self.options,cs=self.size;
self.ghost=self.originalElement.clone();
self.ghost.css({opacity:0.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof o.ghost=="string"?o.ghost:"");
self.ghost.appendTo(self.helper);
},resize:function(_a5f,ui){
var self=$(this).data("resizable"),o=self.options;
if(self.ghost){
self.ghost.css({position:"relative",height:self.size.height,width:self.size.width});
}
},stop:function(_a63,ui){
var self=$(this).data("resizable"),o=self.options;
if(self.ghost&&self.helper){
self.helper.get(0).removeChild(self.ghost.get(0));
}
}});
$.ui.plugin.add("resizable","grid",{resize:function(_a67,ui){
var self=$(this).data("resizable"),o=self.options,cs=self.size,os=self.originalSize,op=self.originalPosition,a=self.axis,_a6f=o._aspectRatio||_a67.shiftKey;
o.grid=typeof o.grid=="number"?[o.grid,o.grid]:o.grid;
var ox=Math.round((cs.width-os.width)/(o.grid[0]||1))*(o.grid[0]||1),oy=Math.round((cs.height-os.height)/(o.grid[1]||1))*(o.grid[1]||1);
if(/^(se|s|e)$/.test(a)){
self.size.width=os.width+ox;
self.size.height=os.height+oy;
}else{
if(/^(ne)$/.test(a)){
self.size.width=os.width+ox;
self.size.height=os.height+oy;
self.position.top=op.top-oy;
}else{
if(/^(sw)$/.test(a)){
self.size.width=os.width+ox;
self.size.height=os.height+oy;
self.position.left=op.left-ox;
}else{
self.size.width=os.width+ox;
self.size.height=os.height+oy;
self.position.top=op.top-oy;
self.position.left=op.left-ox;
}
}
}
}});
var num=function(v){
return parseInt(v,10)||0;
};
var _9bb=function(_a73){
return !isNaN(parseInt(_a73,10));
};
})(jQuery);
(function($,_a75){
$.widget("ui.selectable",$.ui.mouse,{options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch"},_create:function(){
var self=this;
this.element.addClass("ui-selectable");
this.dragged=false;
var _a77;
this.refresh=function(){
_a77=$(self.options.filter,self.element[0]);
_a77.each(function(){
var _a78=$(this);
var pos=_a78.offset();
$.data(this,"selectable-item",{element:this,$element:_a78,left:pos.left,top:pos.top,right:pos.left+_a78.outerWidth(),bottom:pos.top+_a78.outerHeight(),startselected:false,selected:_a78.hasClass("ui-selected"),selecting:_a78.hasClass("ui-selecting"),unselecting:_a78.hasClass("ui-unselecting")});
});
};
this.refresh();
this.selectees=_a77.addClass("ui-selectee");
this._mouseInit();
this.helper=$("<div class='ui-selectable-helper'></div>");
},destroy:function(){
this.selectees.removeClass("ui-selectee").removeData("selectable-item");
this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");
this._mouseDestroy();
return this;
},_mouseStart:function(_a7a){
var self=this;
this.opos=[_a7a.pageX,_a7a.pageY];
if(this.options.disabled){
return;
}
var _a7c=this.options;
this.selectees=$(_a7c.filter,this.element[0]);
this._trigger("start",_a7a);
$(_a7c.appendTo).append(this.helper);
this.helper.css({"left":_a7a.clientX,"top":_a7a.clientY,"width":0,"height":0});
if(_a7c.autoRefresh){
this.refresh();
}
this.selectees.filter(".ui-selected").each(function(){
var _a7d=$.data(this,"selectable-item");
_a7d.startselected=true;
if(!_a7a.metaKey){
_a7d.$element.removeClass("ui-selected");
_a7d.selected=false;
_a7d.$element.addClass("ui-unselecting");
_a7d.unselecting=true;
self._trigger("unselecting",_a7a,{unselecting:_a7d.element});
}
});
$(_a7a.target).parents().andSelf().each(function(){
var _a7e=$.data(this,"selectable-item");
if(_a7e){
var _a7f=!_a7a.metaKey||!_a7e.$element.hasClass("ui-selected");
_a7e.$element.removeClass(_a7f?"ui-unselecting":"ui-selected").addClass(_a7f?"ui-selecting":"ui-unselecting");
_a7e.unselecting=!_a7f;
_a7e.selecting=_a7f;
_a7e.selected=_a7f;
if(_a7f){
self._trigger("selecting",_a7a,{selecting:_a7e.element});
}else{
self._trigger("unselecting",_a7a,{unselecting:_a7e.element});
}
return false;
}
});
},_mouseDrag:function(_a80){
var self=this;
this.dragged=true;
if(this.options.disabled){
return;
}
var _a82=this.options;
var x1=this.opos[0],y1=this.opos[1],x2=_a80.pageX,y2=_a80.pageY;
if(x1>x2){
var tmp=x2;
x2=x1;
x1=tmp;
}
if(y1>y2){
var tmp=y2;
y2=y1;
y1=tmp;
}
this.helper.css({left:x1,top:y1,width:x2-x1,height:y2-y1});
this.selectees.each(function(){
var _a88=$.data(this,"selectable-item");
if(!_a88||_a88.element==self.element[0]){
return;
}
var hit=false;
if(_a82.tolerance=="touch"){
hit=(!(_a88.left>x2||_a88.right<x1||_a88.top>y2||_a88.bottom<y1));
}else{
if(_a82.tolerance=="fit"){
hit=(_a88.left>x1&&_a88.right<x2&&_a88.top>y1&&_a88.bottom<y2);
}
}
if(hit){
if(_a88.selected){
_a88.$element.removeClass("ui-selected");
_a88.selected=false;
}
if(_a88.unselecting){
_a88.$element.removeClass("ui-unselecting");
_a88.unselecting=false;
}
if(!_a88.selecting){
_a88.$element.addClass("ui-selecting");
_a88.selecting=true;
self._trigger("selecting",_a80,{selecting:_a88.element});
}
}else{
if(_a88.selecting){
if(_a80.metaKey&&_a88.startselected){
_a88.$element.removeClass("ui-selecting");
_a88.selecting=false;
_a88.$element.addClass("ui-selected");
_a88.selected=true;
}else{
_a88.$element.removeClass("ui-selecting");
_a88.selecting=false;
if(_a88.startselected){
_a88.$element.addClass("ui-unselecting");
_a88.unselecting=true;
}
self._trigger("unselecting",_a80,{unselecting:_a88.element});
}
}
if(_a88.selected){
if(!_a80.metaKey&&!_a88.startselected){
_a88.$element.removeClass("ui-selected");
_a88.selected=false;
_a88.$element.addClass("ui-unselecting");
_a88.unselecting=true;
self._trigger("unselecting",_a80,{unselecting:_a88.element});
}
}
}
});
return false;
},_mouseStop:function(_a8a){
var self=this;
this.dragged=false;
var _a8c=this.options;
$(".ui-unselecting",this.element[0]).each(function(){
var _a8d=$.data(this,"selectable-item");
_a8d.$element.removeClass("ui-unselecting");
_a8d.unselecting=false;
_a8d.startselected=false;
self._trigger("unselected",_a8a,{unselected:_a8d.element});
});
$(".ui-selecting",this.element[0]).each(function(){
var _a8e=$.data(this,"selectable-item");
_a8e.$element.removeClass("ui-selecting").addClass("ui-selected");
_a8e.selecting=false;
_a8e.selected=true;
_a8e.startselected=true;
self._trigger("selected",_a8a,{selected:_a8e.element});
});
this._trigger("stop",_a8a);
this.helper.remove();
return false;
}});
$.extend($.ui.selectable,{version:"1.8.11"});
})(jQuery);
(function($,_a90){
$.widget("ui.sortable",$.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000},_create:function(){
var o=this.options;
this.containerCache={};
this.element.addClass("ui-sortable");
this.refresh();
this.floating=this.items.length?(/left|right/).test(this.items[0].item.css("float"))||(/inline|table-cell/).test(this.items[0].item.css("display")):false;
this.offset=this.element.offset();
this._mouseInit();
},destroy:function(){
this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");
this._mouseDestroy();
for(var i=this.items.length-1;i>=0;i--){
this.items[i].item.removeData("sortable-item");
}
return this;
},_setOption:function(key,_a94){
if(key==="disabled"){
this.options[key]=_a94;
this.widget()[_a94?"addClass":"removeClass"]("ui-sortable-disabled");
}else{
$.Widget.prototype._setOption.apply(this,arguments);
}
},_mouseCapture:function(_a95,_a96){
if(this.reverting){
return false;
}
if(this.options.disabled||this.options.type=="static"){
return false;
}
this._refreshItems(_a95);
var _a97=null,self=this,_a99=$(_a95.target).parents().each(function(){
if($.data(this,"sortable-item")==self){
_a97=$(this);
return false;
}
});
if($.data(_a95.target,"sortable-item")==self){
_a97=$(_a95.target);
}
if(!_a97){
return false;
}
if(this.options.handle&&!_a96){
var _a9a=false;
$(this.options.handle,_a97).find("*").andSelf().each(function(){
if(this==_a95.target){
_a9a=true;
}
});
if(!_a9a){
return false;
}
}
this.currentItem=_a97;
this._removeCurrentsFromItems();
return true;
},_mouseStart:function(_a9b,_a9c,_a9d){
var o=this.options,self=this;
this.currentContainer=this;
this.refreshPositions();
this.helper=this._createHelper(_a9b);
this._cacheHelperProportions();
this._cacheMargins();
this.scrollParent=this.helper.scrollParent();
this.offset=this.currentItem.offset();
this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};
this.helper.css("position","absolute");
this.cssPosition=this.helper.css("position");
$.extend(this.offset,{click:{left:_a9b.pageX-this.offset.left,top:_a9b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});
this.originalPosition=this._generatePosition(_a9b);
this.originalPageX=_a9b.pageX;
this.originalPageY=_a9b.pageY;
(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));
this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};
if(this.helper[0]!=this.currentItem[0]){
this.currentItem.hide();
}
this._createPlaceholder();
if(o.containment){
this._setContainment();
}
if(o.cursor){
if($("body").css("cursor")){
this._storedCursor=$("body").css("cursor");
}
$("body").css("cursor",o.cursor);
}
if(o.opacity){
if(this.helper.css("opacity")){
this._storedOpacity=this.helper.css("opacity");
}
this.helper.css("opacity",o.opacity);
}
if(o.zIndex){
if(this.helper.css("zIndex")){
this._storedZIndex=this.helper.css("zIndex");
}
this.helper.css("zIndex",o.zIndex);
}
if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){
this.overflowOffset=this.scrollParent.offset();
}
this._trigger("start",_a9b,this._uiHash());
if(!this._preserveHelperProportions){
this._cacheHelperProportions();
}
if(!_a9d){
for(var i=this.containers.length-1;i>=0;i--){
this.containers[i]._trigger("activate",_a9b,self._uiHash(this));
}
}
if($.ui.ddmanager){
$.ui.ddmanager.current=this;
}
if($.ui.ddmanager&&!o.dropBehaviour){
$.ui.ddmanager.prepareOffsets(this,_a9b);
}
this.dragging=true;
this.helper.addClass("ui-sortable-helper");
this._mouseDrag(_a9b);
return true;
},_mouseDrag:function(_aa1){
this.position=this._generatePosition(_aa1);
this.positionAbs=this._convertPositionTo("absolute");
if(!this.lastPositionAbs){
this.lastPositionAbs=this.positionAbs;
}
if(this.options.scroll){
var o=this.options,_aa3=false;
if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){
if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-_aa1.pageY<o.scrollSensitivity){
this.scrollParent[0].scrollTop=_aa3=this.scrollParent[0].scrollTop+o.scrollSpeed;
}else{
if(_aa1.pageY-this.overflowOffset.top<o.scrollSensitivity){
this.scrollParent[0].scrollTop=_aa3=this.scrollParent[0].scrollTop-o.scrollSpeed;
}
}
if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-_aa1.pageX<o.scrollSensitivity){
this.scrollParent[0].scrollLeft=_aa3=this.scrollParent[0].scrollLeft+o.scrollSpeed;
}else{
if(_aa1.pageX-this.overflowOffset.left<o.scrollSensitivity){
this.scrollParent[0].scrollLeft=_aa3=this.scrollParent[0].scrollLeft-o.scrollSpeed;
}
}
}else{
if(_aa1.pageY-$(document).scrollTop()<o.scrollSensitivity){
_aa3=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);
}else{
if($(window).height()-(_aa1.pageY-$(document).scrollTop())<o.scrollSensitivity){
_aa3=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);
}
}
if(_aa1.pageX-$(document).scrollLeft()<o.scrollSensitivity){
_aa3=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);
}else{
if($(window).width()-(_aa1.pageX-$(document).scrollLeft())<o.scrollSensitivity){
_aa3=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed);
}
}
}
if(_aa3!==false&&$.ui.ddmanager&&!o.dropBehaviour){
$.ui.ddmanager.prepareOffsets(this,_aa1);
}
}
this.positionAbs=this._convertPositionTo("absolute");
if(!this.options.axis||this.options.axis!="y"){
this.helper[0].style.left=this.position.left+"px";
}
if(!this.options.axis||this.options.axis!="x"){
this.helper[0].style.top=this.position.top+"px";
}
for(var i=this.items.length-1;i>=0;i--){
var item=this.items[i],_aa6=item.item[0],_aa7=this._intersectsWithPointer(item);
if(!_aa7){
continue;
}
if(_aa6!=this.currentItem[0]&&this.placeholder[_aa7==1?"next":"prev"]()[0]!=_aa6&&!$.ui.contains(this.placeholder[0],_aa6)&&(this.options.type=="semi-dynamic"?!$.ui.contains(this.element[0],_aa6):true)){
this.direction=_aa7==1?"down":"up";
if(this.options.tolerance=="pointer"||this._intersectsWithSides(item)){
this._rearrange(_aa1,item);
}else{
break;
}
this._trigger("change",_aa1,this._uiHash());
break;
}
}
this._contactContainers(_aa1);
if($.ui.ddmanager){
$.ui.ddmanager.drag(this,_aa1);
}
this._trigger("sort",_aa1,this._uiHash());
this.lastPositionAbs=this.positionAbs;
return false;
},_mouseStop:function(_aa8,_aa9){
if(!_aa8){
return;
}
if($.ui.ddmanager&&!this.options.dropBehaviour){
$.ui.ddmanager.drop(this,_aa8);
}
if(this.options.revert){
var self=this;
var cur=self.placeholder.offset();
self.reverting=true;
$(this.helper).animate({left:cur.left-this.offset.parent.left-self.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:cur.top-this.offset.parent.top-self.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){
self._clear(_aa8);
});
}else{
this._clear(_aa8,_aa9);
}
return false;
},cancel:function(){
var self=this;
if(this.dragging){
this._mouseUp({target:null});
if(this.options.helper=="original"){
this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");
}else{
this.currentItem.show();
}
for(var i=this.containers.length-1;i>=0;i--){
this.containers[i]._trigger("deactivate",null,self._uiHash(this));
if(this.containers[i].containerCache.over){
this.containers[i]._trigger("out",null,self._uiHash(this));
this.containers[i].containerCache.over=0;
}
}
}
if(this.placeholder){
if(this.placeholder[0].parentNode){
this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
}
if(this.options.helper!="original"&&this.helper&&this.helper[0].parentNode){
this.helper.remove();
}
$.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});
if(this.domPosition.prev){
$(this.domPosition.prev).after(this.currentItem);
}else{
$(this.domPosition.parent).prepend(this.currentItem);
}
}
return this;
},serialize:function(o){
var _aaf=this._getItemsAsjQuery(o&&o.connected);
var str=[];
o=o||{};
$(_aaf).each(function(){
var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||(/(.+)[-=_](.+)/));
if(res){
str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]));
}
});
if(!str.length&&o.key){
str.push(o.key+"=");
}
return str.join("&");
},toArray:function(o){
var _ab3=this._getItemsAsjQuery(o&&o.connected);
var ret=[];
o=o||{};
_ab3.each(function(){
ret.push($(o.item||this).attr(o.attribute||"id")||"");
});
return ret;
},_intersectsWith:function(item){
var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height;
var l=item.left,r=l+item.width,t=item.top,b=t+item.height;
var _abe=this.offset.click.top,_abf=this.offset.click.left;
var _ac0=(y1+_abe)>t&&(y1+_abe)<b&&(x1+_abf)>l&&(x1+_abf)<r;
if(this.options.tolerance=="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"])){
return _ac0;
}else{
return (l<x1+(this.helperProportions.width/2)&&x2-(this.helperProportions.width/2)<r&&t<y1+(this.helperProportions.height/2)&&y2-(this.helperProportions.height/2)<b);
}
},_intersectsWithPointer:function(item){
var _ac2=$.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),_ac3=$.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),_ac4=_ac2&&_ac3,_ac5=this._getDragVerticalDirection(),_ac6=this._getDragHorizontalDirection();
if(!_ac4){
return false;
}
return this.floating?(((_ac6&&_ac6=="right")||_ac5=="down")?2:1):(_ac5&&(_ac5=="down"?2:1));
},_intersectsWithSides:function(item){
var _ac8=$.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+(item.height/2),item.height),_ac9=$.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+(item.width/2),item.width),_aca=this._getDragVerticalDirection(),_acb=this._getDragHorizontalDirection();
if(this.floating&&_acb){
return ((_acb=="right"&&_ac9)||(_acb=="left"&&!_ac9));
}else{
return _aca&&((_aca=="down"&&_ac8)||(_aca=="up"&&!_ac8));
}
},_getDragVerticalDirection:function(){
var _acc=this.positionAbs.top-this.lastPositionAbs.top;
return _acc!=0&&(_acc>0?"down":"up");
},_getDragHorizontalDirection:function(){
var _acd=this.positionAbs.left-this.lastPositionAbs.left;
return _acd!=0&&(_acd>0?"right":"left");
},refresh:function(_ace){
this._refreshItems(_ace);
this.refreshPositions();
return this;
},_connectWith:function(){
var _acf=this.options;
return _acf.connectWith.constructor==String?[_acf.connectWith]:_acf.connectWith;
},_getItemsAsjQuery:function(_ad0){
var self=this;
var _ad2=[];
var _ad3=[];
var _ad4=this._connectWith();
if(_ad4&&_ad0){
for(var i=_ad4.length-1;i>=0;i--){
var cur=$(_ad4[i]);
for(var j=cur.length-1;j>=0;j--){
var inst=$.data(cur[j],"sortable");
if(inst&&inst!=this&&!inst.options.disabled){
_ad3.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);
}
}
}
}
_ad3.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);
for(var i=_ad3.length-1;i>=0;i--){
_ad3[i][0].each(function(){
_ad2.push(this);
});
}
return $(_ad2);
},_removeCurrentsFromItems:function(){
var list=this.currentItem.find(":data(sortable-item)");
for(var i=0;i<this.items.length;i++){
for(var j=0;j<list.length;j++){
if(list[j]==this.items[i].item[0]){
this.items.splice(i,1);
}
}
}
},_refreshItems:function(_adc){
this.items=[];
this.containers=[this];
var _add=this.items;
var self=this;
var _adf=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],_adc,{item:this.currentItem}):$(this.options.items,this.element),this]];
var _ae0=this._connectWith();
if(_ae0){
for(var i=_ae0.length-1;i>=0;i--){
var cur=$(_ae0[i]);
for(var j=cur.length-1;j>=0;j--){
var inst=$.data(cur[j],"sortable");
if(inst&&inst!=this&&!inst.options.disabled){
_adf.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],_adc,{item:this.currentItem}):$(inst.options.items,inst.element),inst]);
this.containers.push(inst);
}
}
}
}
for(var i=_adf.length-1;i>=0;i--){
var _ae5=_adf[i][1];
var _ae6=_adf[i][0];
for(var j=0,_ae7=_ae6.length;j<_ae7;j++){
var item=$(_ae6[j]);
item.data("sortable-item",_ae5);
_add.push({item:item,instance:_ae5,width:0,height:0,left:0,top:0});
}
}
},refreshPositions:function(fast){
if(this.offsetParent&&this.helper){
this.offset.parent=this._getParentOffset();
}
for(var i=this.items.length-1;i>=0;i--){
var item=this.items[i];
var t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item;
if(!fast){
item.width=t.outerWidth();
item.height=t.outerHeight();
}
var p=t.offset();
item.left=p.left;
item.top=p.top;
}
if(this.options.custom&&this.options.custom.refreshContainers){
this.options.custom.refreshContainers.call(this);
}else{
for(var i=this.containers.length-1;i>=0;i--){
var p=this.containers[i].element.offset();
this.containers[i].containerCache.left=p.left;
this.containers[i].containerCache.top=p.top;
this.containers[i].containerCache.width=this.containers[i].element.outerWidth();
this.containers[i].containerCache.height=this.containers[i].element.outerHeight();
}
}
return this;
},_createPlaceholder:function(that){
var self=that||this,o=self.options;
if(!o.placeholder||o.placeholder.constructor==String){
var _af1=o.placeholder;
o.placeholder={element:function(){
var el=$(document.createElement(self.currentItem[0].nodeName)).addClass(_af1||self.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
if(!_af1){
el.style.visibility="hidden";
}
return el;
},update:function(_af3,p){
if(_af1&&!o.forcePlaceholderSize){
return;
}
if(!p.height()){
p.height(self.currentItem.innerHeight()-parseInt(self.currentItem.css("paddingTop")||0,10)-parseInt(self.currentItem.css("paddingBottom")||0,10));
}
if(!p.width()){
p.width(self.currentItem.innerWidth()-parseInt(self.currentItem.css("paddingLeft")||0,10)-parseInt(self.currentItem.css("paddingRight")||0,10));
}
}};
}
self.placeholder=$(o.placeholder.element.call(self.element,self.currentItem));
self.currentItem.after(self.placeholder);
o.placeholder.update(self,self.placeholder);
},_contactContainers:function(_af5){
var _af6=null,_af7=null;
for(var i=this.containers.length-1;i>=0;i--){
if($.ui.contains(this.currentItem[0],this.containers[i].element[0])){
continue;
}
if(this._intersectsWith(this.containers[i].containerCache)){
if(_af6&&$.ui.contains(this.containers[i].element[0],_af6.element[0])){
continue;
}
_af6=this.containers[i];
_af7=i;
}else{
if(this.containers[i].containerCache.over){
this.containers[i]._trigger("out",_af5,this._uiHash(this));
this.containers[i].containerCache.over=0;
}
}
}
if(!_af6){
return;
}
if(this.containers.length===1){
this.containers[_af7]._trigger("over",_af5,this._uiHash(this));
this.containers[_af7].containerCache.over=1;
}else{
if(this.currentContainer!=this.containers[_af7]){
var dist=10000;
var _afa=null;
var base=this.positionAbs[this.containers[_af7].floating?"left":"top"];
for(var j=this.items.length-1;j>=0;j--){
if(!$.ui.contains(this.containers[_af7].element[0],this.items[j].item[0])){
continue;
}
var cur=this.items[j][this.containers[_af7].floating?"left":"top"];
if(Math.abs(cur-base)<dist){
dist=Math.abs(cur-base);
_afa=this.items[j];
}
}
if(!_afa&&!this.options.dropOnEmpty){
return;
}
this.currentContainer=this.containers[_af7];
_afa?this._rearrange(_af5,_afa,null,true):this._rearrange(_af5,null,this.containers[_af7].element,true);
this._trigger("change",_af5,this._uiHash());
this.containers[_af7]._trigger("change",_af5,this._uiHash(this));
this.options.placeholder.update(this.currentContainer,this.placeholder);
this.containers[_af7]._trigger("over",_af5,this._uiHash(this));
this.containers[_af7].containerCache.over=1;
}
}
},_createHelper:function(_afe){
var o=this.options;
var _b00=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[_afe,this.currentItem])):(o.helper=="clone"?this.currentItem.clone():this.currentItem);
if(!_b00.parents("body").length){
$(o.appendTo!="parent"?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(_b00[0]);
}
if(_b00[0]==this.currentItem[0]){
this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};
}
if(_b00[0].style.width==""||o.forceHelperSize){
_b00.width(this.currentItem.width());
}
if(_b00[0].style.height==""||o.forceHelperSize){
_b00.height(this.currentItem.height());
}
return _b00;
},_adjustOffsetFromHelper:function(obj){
if(typeof obj=="string"){
obj=obj.split(" ");
}
if($.isArray(obj)){
obj={left:+obj[0],top:+obj[1]||0};
}
if("left" in obj){
this.offset.click.left=obj.left+this.margins.left;
}
if("right" in obj){
this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;
}
if("top" in obj){
this.offset.click.top=obj.top+this.margins.top;
}
if("bottom" in obj){
this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;
}
},_getParentOffset:function(){
this.offsetParent=this.helper.offsetParent();
var po=this.offsetParent.offset();
if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&$.ui.contains(this.scrollParent[0],this.offsetParent[0])){
po.left+=this.scrollParent.scrollLeft();
po.top+=this.scrollParent.scrollTop();
}
if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&$.browser.msie)){
po={top:0,left:0};
}
return {top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};
},_getRelativeOffset:function(){
if(this.cssPosition=="relative"){
var p=this.currentItem.position();
return {top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()};
}else{
return {top:0,left:0};
}
},_cacheMargins:function(){
this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)};
},_cacheHelperProportions:function(){
this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};
},_setContainment:function(){
var o=this.options;
if(o.containment=="parent"){
o.containment=this.helper[0].parentNode;
}
if(o.containment=="document"||o.containment=="window"){
this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,$(o.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,($(o.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];
}
if(!(/^(document|window|parent)$/).test(o.containment)){
var ce=$(o.containment)[0];
var co=$(o.containment).offset();
var over=($(ce).css("overflow")!="hidden");
this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top];
}
},_convertPositionTo:function(d,pos){
if(!pos){
pos=this.position;
}
var mod=d=="absolute"?1:-1;
var o=this.options,_b0c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&$.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,_b0d=(/(html|body)/i).test(_b0c[0].tagName);
return {top:(pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-($.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(_b0d?0:_b0c.scrollTop()))*mod)),left:(pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-($.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():_b0d?0:_b0c.scrollLeft())*mod))};
},_generatePosition:function(_b0e){
var o=this.options,_b10=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&$.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,_b11=(/(html|body)/i).test(_b10[0].tagName);
if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])){
this.offset.relative=this._getRelativeOffset();
}
var _b12=_b0e.pageX;
var _b13=_b0e.pageY;
if(this.originalPosition){
if(this.containment){
if(_b0e.pageX-this.offset.click.left<this.containment[0]){
_b12=this.containment[0]+this.offset.click.left;
}
if(_b0e.pageY-this.offset.click.top<this.containment[1]){
_b13=this.containment[1]+this.offset.click.top;
}
if(_b0e.pageX-this.offset.click.left>this.containment[2]){
_b12=this.containment[2]+this.offset.click.left;
}
if(_b0e.pageY-this.offset.click.top>this.containment[3]){
_b13=this.containment[3]+this.offset.click.top;
}
}
if(o.grid){
var top=this.originalPageY+Math.round((_b13-this.originalPageY)/o.grid[1])*o.grid[1];
_b13=this.containment?(!(top-this.offset.click.top<this.containment[1]||top-this.offset.click.top>this.containment[3])?top:(!(top-this.offset.click.top<this.containment[1])?top-o.grid[1]:top+o.grid[1])):top;
var left=this.originalPageX+Math.round((_b12-this.originalPageX)/o.grid[0])*o.grid[0];
_b12=this.containment?(!(left-this.offset.click.left<this.containment[0]||left-this.offset.click.left>this.containment[2])?left:(!(left-this.offset.click.left<this.containment[0])?left-o.grid[0]:left+o.grid[0])):left;
}
}
return {top:(_b13-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+($.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(_b11?0:_b10.scrollTop())))),left:(_b12-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+($.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():_b11?0:_b10.scrollLeft())))};
},_rearrange:function(_b16,i,a,_b19){
a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction=="down"?i.item[0]:i.item[0].nextSibling));
this.counter=this.counter?++this.counter:1;
var self=this,_b1b=this.counter;
window.setTimeout(function(){
if(_b1b==self.counter){
self.refreshPositions(!_b19);
}
},0);
},_clear:function(_b1c,_b1d){
this.reverting=false;
var _b1e=[],self=this;
if(!this._noFinalSort&&this.currentItem[0].parentNode){
this.placeholder.before(this.currentItem);
}
this._noFinalSort=null;
if(this.helper[0]==this.currentItem[0]){
for(var i in this._storedCSS){
if(this._storedCSS[i]=="auto"||this._storedCSS[i]=="static"){
this._storedCSS[i]="";
}
}
this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");
}else{
this.currentItem.show();
}
if(this.fromOutside&&!_b1d){
_b1e.push(function(_b21){
this._trigger("receive",_b21,this._uiHash(this.fromOutside));
});
}
if((this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!_b1d){
_b1e.push(function(_b22){
this._trigger("update",_b22,this._uiHash());
});
}
if(!$.ui.contains(this.element[0],this.currentItem[0])){
if(!_b1d){
_b1e.push(function(_b23){
this._trigger("remove",_b23,this._uiHash());
});
}
for(var i=this.containers.length-1;i>=0;i--){
if($.ui.contains(this.containers[i].element[0],this.currentItem[0])&&!_b1d){
_b1e.push((function(c){
return function(_b25){
c._trigger("receive",_b25,this._uiHash(this));
};
}).call(this,this.containers[i]));
_b1e.push((function(c){
return function(_b27){
c._trigger("update",_b27,this._uiHash(this));
};
}).call(this,this.containers[i]));
}
}
}
for(var i=this.containers.length-1;i>=0;i--){
if(!_b1d){
_b1e.push((function(c){
return function(_b29){
c._trigger("deactivate",_b29,this._uiHash(this));
};
}).call(this,this.containers[i]));
}
if(this.containers[i].containerCache.over){
_b1e.push((function(c){
return function(_b2b){
c._trigger("out",_b2b,this._uiHash(this));
};
}).call(this,this.containers[i]));
this.containers[i].containerCache.over=0;
}
}
if(this._storedCursor){
$("body").css("cursor",this._storedCursor);
}
if(this._storedOpacity){
this.helper.css("opacity",this._storedOpacity);
}
if(this._storedZIndex){
this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex);
}
this.dragging=false;
if(this.cancelHelperRemoval){
if(!_b1d){
this._trigger("beforeStop",_b1c,this._uiHash());
for(var i=0;i<_b1e.length;i++){
_b1e[i].call(this,_b1c);
}
this._trigger("stop",_b1c,this._uiHash());
}
return false;
}
if(!_b1d){
this._trigger("beforeStop",_b1c,this._uiHash());
}
this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
if(this.helper[0]!=this.currentItem[0]){
this.helper.remove();
}
this.helper=null;
if(!_b1d){
for(var i=0;i<_b1e.length;i++){
_b1e[i].call(this,_b1c);
}
this._trigger("stop",_b1c,this._uiHash());
}
this.fromOutside=false;
return true;
},_trigger:function(){
if($.Widget.prototype._trigger.apply(this,arguments)===false){
this.cancel();
}
},_uiHash:function(inst){
var self=inst||this;
return {helper:self.helper,placeholder:self.placeholder||$([]),position:self.position,originalPosition:self.originalPosition,offset:self.positionAbs,item:self.currentItem,sender:inst?inst.element:null};
}});
$.extend($.ui.sortable,{version:"1.8.11"});
})(jQuery);
(function($,_b2f){
$.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:true,clearStyle:false,collapsible:false,event:"click",fillSpace:false,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:false,navigationFilter:function(){
return this.href.toLowerCase()===location.href.toLowerCase();
}},_create:function(){
var self=this,_b31=self.options;
self.running=0;
self.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix");
self.headers=self.element.find(_b31.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){
if(_b31.disabled){
return;
}
$(this).addClass("ui-state-hover");
}).bind("mouseleave.accordion",function(){
if(_b31.disabled){
return;
}
$(this).removeClass("ui-state-hover");
}).bind("focus.accordion",function(){
if(_b31.disabled){
return;
}
$(this).addClass("ui-state-focus");
}).bind("blur.accordion",function(){
if(_b31.disabled){
return;
}
$(this).removeClass("ui-state-focus");
});
self.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");
if(_b31.navigation){
var _b32=self.element.find("a").filter(_b31.navigationFilter).eq(0);
if(_b32.length){
var _b33=_b32.closest(".ui-accordion-header");
if(_b33.length){
self.active=_b33;
}else{
self.active=_b32.closest(".ui-accordion-content").prev();
}
}
}
self.active=self._findActive(self.active||_b31.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");
self.active.next().addClass("ui-accordion-content-active");
self._createIcons();
self.resize();
self.element.attr("role","tablist");
self.headers.attr("role","tab").bind("keydown.accordion",function(_b34){
return self._keydown(_b34);
}).next().attr("role","tabpanel");
self.headers.not(self.active||"").attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide();
if(!self.active.length){
self.headers.eq(0).attr("tabIndex",0);
}else{
self.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0});
}
if(!$.browser.safari){
self.headers.find("a").attr("tabIndex",-1);
}
if(_b31.event){
self.headers.bind(_b31.event.split(" ").join(".accordion ")+".accordion",function(_b35){
self._clickHandler.call(self,_b35,this);
_b35.preventDefault();
});
}
},_createIcons:function(){
var _b36=this.options;
if(_b36.icons){
$("<span></span>").addClass("ui-icon "+_b36.icons.header).prependTo(this.headers);
this.active.children(".ui-icon").toggleClass(_b36.icons.header).toggleClass(_b36.icons.headerSelected);
this.element.addClass("ui-accordion-icons");
}
},_destroyIcons:function(){
this.headers.children(".ui-icon").remove();
this.element.removeClass("ui-accordion-icons");
},destroy:function(){
var _b37=this.options;
this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");
this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex");
this.headers.find("a").removeAttr("tabIndex");
this._destroyIcons();
var _b38=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");
if(_b37.autoHeight||_b37.fillHeight){
_b38.css("height","");
}
return $.Widget.prototype.destroy.call(this);
},_setOption:function(key,_b3a){
$.Widget.prototype._setOption.apply(this,arguments);
if(key=="active"){
this.activate(_b3a);
}
if(key=="icons"){
this._destroyIcons();
if(_b3a){
this._createIcons();
}
}
if(key=="disabled"){
this.headers.add(this.headers.next())[_b3a?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled");
}
},_keydown:function(_b3b){
if(this.options.disabled||_b3b.altKey||_b3b.ctrlKey){
return;
}
var _b3c=$.ui.keyCode,_b3d=this.headers.length,_b3e=this.headers.index(_b3b.target),_b3f=false;
switch(_b3b.keyCode){
case _b3c.RIGHT:
case _b3c.DOWN:
_b3f=this.headers[(_b3e+1)%_b3d];
break;
case _b3c.LEFT:
case _b3c.UP:
_b3f=this.headers[(_b3e-1+_b3d)%_b3d];
break;
case _b3c.SPACE:
case _b3c.ENTER:
this._clickHandler({target:_b3b.target},_b3b.target);
_b3b.preventDefault();
}
if(_b3f){
$(_b3b.target).attr("tabIndex",-1);
$(_b3f).attr("tabIndex",0);
_b3f.focus();
return false;
}
return true;
},resize:function(){
var _b40=this.options,_b41;
if(_b40.fillSpace){
if($.browser.msie){
var _b42=this.element.parent().css("overflow");
this.element.parent().css("overflow","hidden");
}
_b41=this.element.parent().height();
if($.browser.msie){
this.element.parent().css("overflow",_b42);
}
this.headers.each(function(){
_b41-=$(this).outerHeight(true);
});
this.headers.next().each(function(){
$(this).height(Math.max(0,_b41-$(this).innerHeight()+$(this).height()));
}).css("overflow","auto");
}else{
if(_b40.autoHeight){
_b41=0;
this.headers.next().each(function(){
_b41=Math.max(_b41,$(this).height("").height());
}).height(_b41);
}
}
return this;
},activate:function(_b43){
this.options.active=_b43;
var _b44=this._findActive(_b43)[0];
this._clickHandler({target:_b44},_b44);
return this;
},_findActive:function(_b45){
return _b45?typeof _b45==="number"?this.headers.filter(":eq("+_b45+")"):this.headers.not(this.headers.not(_b45)):_b45===false?$([]):this.headers.filter(":eq(0)");
},_clickHandler:function(_b46,_b47){
var _b48=this.options;
if(_b48.disabled){
return;
}
if(!_b46.target){
if(!_b48.collapsible){
return;
}
this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(_b48.icons.headerSelected).addClass(_b48.icons.header);
this.active.next().addClass("ui-accordion-content-active");
var _b49=this.active.next(),data={options:_b48,newHeader:$([]),oldHeader:_b48.active,newContent:$([]),oldContent:_b49},_b4b=(this.active=$([]));
this._toggle(_b4b,_b49,data);
return;
}
var _b4c=$(_b46.currentTarget||_b47),_b4d=_b4c[0]===this.active[0];
_b48.active=_b48.collapsible&&_b4d?false:this.headers.index(_b4c);
if(this.running||(!_b48.collapsible&&_b4d)){
return;
}
var _b4e=this.active,_b4b=_b4c.next(),_b49=this.active.next(),data={options:_b48,newHeader:_b4d&&_b48.collapsible?$([]):_b4c,oldHeader:this.active,newContent:_b4d&&_b48.collapsible?$([]):_b4b,oldContent:_b49},down=this.headers.index(this.active[0])>this.headers.index(_b4c[0]);
this.active=_b4d?$([]):_b4c;
this._toggle(_b4b,_b49,data,_b4d,down);
_b4e.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(_b48.icons.headerSelected).addClass(_b48.icons.header);
if(!_b4d){
_b4c.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(_b48.icons.header).addClass(_b48.icons.headerSelected);
_b4c.next().addClass("ui-accordion-content-active");
}
return;
},_toggle:function(_b50,_b51,data,_b53,down){
var self=this,_b56=self.options;
self.toShow=_b50;
self.toHide=_b51;
self.data=data;
var _b57=function(){
if(!self){
return;
}
return self._completed.apply(self,arguments);
};
self._trigger("changestart",null,self.data);
self.running=_b51.size()===0?_b50.size():_b51.size();
if(_b56.animated){
var _b58={};
if(_b56.collapsible&&_b53){
_b58={toShow:$([]),toHide:_b51,complete:_b57,down:down,autoHeight:_b56.autoHeight||_b56.fillSpace};
}else{
_b58={toShow:_b50,toHide:_b51,complete:_b57,down:down,autoHeight:_b56.autoHeight||_b56.fillSpace};
}
if(!_b56.proxied){
_b56.proxied=_b56.animated;
}
if(!_b56.proxiedDuration){
_b56.proxiedDuration=_b56.duration;
}
_b56.animated=$.isFunction(_b56.proxied)?_b56.proxied(_b58):_b56.proxied;
_b56.duration=$.isFunction(_b56.proxiedDuration)?_b56.proxiedDuration(_b58):_b56.proxiedDuration;
var _b59=$.ui.accordion.animations,_b5a=_b56.duration,_b5b=_b56.animated;
if(_b5b&&!_b59[_b5b]&&!$.easing[_b5b]){
_b5b="slide";
}
if(!_b59[_b5b]){
_b59[_b5b]=function(_b5c){
this.slide(_b5c,{easing:_b5b,duration:_b5a||700});
};
}
_b59[_b5b](_b58);
}else{
if(_b56.collapsible&&_b53){
_b50.toggle();
}else{
_b51.hide();
_b50.show();
}
_b57(true);
}
_b51.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur();
_b50.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus();
},_completed:function(_b5d){
this.running=_b5d?0:--this.running;
if(this.running){
return;
}
if(this.options.clearStyle){
this.toShow.add(this.toHide).css({height:"",overflow:""});
}
this.toHide.removeClass("ui-accordion-content-active");
if(this.toHide.length){
this.toHide.parent()[0].className=this.toHide.parent()[0].className;
}
this._trigger("change",null,this.data);
}});
$.extend($.ui.accordion,{version:"1.8.11",animations:{slide:function(_b5e,_b5f){
_b5e=$.extend({easing:"swing",duration:300},_b5e,_b5f);
if(!_b5e.toHide.size()){
_b5e.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},_b5e);
return;
}
if(!_b5e.toShow.size()){
_b5e.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},_b5e);
return;
}
var _b60=_b5e.toShow.css("overflow"),_b61=0,_b62={},_b63={},_b64=["height","paddingTop","paddingBottom"],_b65;
var s=_b5e.toShow;
_b65=s[0].style.width;
s.width(parseInt(s.parent().width(),10)-parseInt(s.css("paddingLeft"),10)-parseInt(s.css("paddingRight"),10)-(parseInt(s.css("borderLeftWidth"),10)||0)-(parseInt(s.css("borderRightWidth"),10)||0));
$.each(_b64,function(i,prop){
_b63[prop]="hide";
var _b69=(""+$.css(_b5e.toShow[0],prop)).match(/^([\d+-.]+)(.*)$/);
_b62[prop]={value:_b69[1],unit:_b69[2]||"px"};
});
_b5e.toShow.css({height:0,overflow:"hidden"}).show();
_b5e.toHide.filter(":hidden").each(_b5e.complete).end().filter(":visible").animate(_b63,{step:function(now,_b6b){
if(_b6b.prop=="height"){
_b61=(_b6b.end-_b6b.start===0)?0:(_b6b.now-_b6b.start)/(_b6b.end-_b6b.start);
}
_b5e.toShow[0].style[_b6b.prop]=(_b61*_b62[_b6b.prop].value)+_b62[_b6b.prop].unit;
},duration:_b5e.duration,easing:_b5e.easing,complete:function(){
if(!_b5e.autoHeight){
_b5e.toShow.css("height","");
}
_b5e.toShow.css({width:_b65,overflow:_b60});
_b5e.complete();
}});
},bounceslide:function(_b6c){
this.slide(_b6c,{easing:_b6c.down?"easeOutBounce":"swing",duration:_b6c.down?1000:200});
}}});
})(jQuery);
(function($,_b6e){
var _b6f=0;
$.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){
var self=this,doc=this.element[0].ownerDocument,_b72;
this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(_b73){
if(self.options.disabled||self.element.attr("readonly")){
return;
}
_b72=false;
var _b74=$.ui.keyCode;
switch(_b73.keyCode){
case _b74.PAGE_UP:
self._move("previousPage",_b73);
break;
case _b74.PAGE_DOWN:
self._move("nextPage",_b73);
break;
case _b74.UP:
self._move("previous",_b73);
_b73.preventDefault();
break;
case _b74.DOWN:
self._move("next",_b73);
_b73.preventDefault();
break;
case _b74.ENTER:
case _b74.NUMPAD_ENTER:
if(self.menu.active){
_b72=true;
_b73.preventDefault();
}
case _b74.TAB:
if(!self.menu.active){
return;
}
self.menu.select(_b73);
break;
case _b74.ESCAPE:
self.element.val(self.term);
self.close(_b73);
break;
default:
clearTimeout(self.searching);
self.searching=setTimeout(function(){
if(self.term!=self.element.val()){
self.selectedItem=null;
self.search(null,_b73);
}
},self.options.delay);
break;
}
}).bind("keypress.autocomplete",function(_b75){
if(_b72){
_b72=false;
_b75.preventDefault();
}
}).bind("focus.autocomplete",function(){
if(self.options.disabled){
return;
}
self.selectedItem=null;
self.previous=self.element.val();
}).bind("blur.autocomplete",function(_b76){
if(self.options.disabled){
return;
}
clearTimeout(self.searching);
self.closing=setTimeout(function(){
self.close(_b76);
self._change(_b76);
},150);
});
this._initSource();
this.response=function(){
return self._response.apply(self,arguments);
};
this.menu=$("<ul></ul>").addClass("ui-autocomplete").appendTo($(this.options.appendTo||"body",doc)[0]).mousedown(function(_b77){
var _b78=self.menu.element[0];
if(!$(_b77.target).closest(".ui-menu-item").length){
setTimeout(function(){
$(document).one("mousedown",function(_b79){
if(_b79.target!==self.element[0]&&_b79.target!==_b78&&!$.ui.contains(_b78,_b79.target)){
self.close();
}
});
},1);
}
setTimeout(function(){
clearTimeout(self.closing);
},13);
}).menu({focus:function(_b7a,ui){
var item=ui.item.data("item.autocomplete");
if(false!==self._trigger("focus",_b7a,{item:item})){
if(/^key/.test(_b7a.originalEvent.type)){
self.element.val(item.value);
}
}
},selected:function(_b7d,ui){
var item=ui.item.data("item.autocomplete"),_b80=self.previous;
if(self.element[0]!==doc.activeElement){
self.element.focus();
self.previous=_b80;
setTimeout(function(){
self.previous=_b80;
self.selectedItem=item;
},1);
}
if(false!==self._trigger("select",_b7d,{item:item})){
self.element.val(item.value);
}
self.term=self.element.val();
self.close(_b7d);
self.selectedItem=item;
},blur:function(_b81,ui){
if(self.menu.element.is(":visible")&&(self.element.val()!==self.term)){
self.element.val(self.term);
}
}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");
if($.fn.bgiframe){
this.menu.element.bgiframe();
}
},destroy:function(){
this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");
this.menu.element.remove();
$.Widget.prototype.destroy.call(this);
},_setOption:function(key,_b84){
$.Widget.prototype._setOption.apply(this,arguments);
if(key==="source"){
this._initSource();
}
if(key==="appendTo"){
this.menu.element.appendTo($(_b84||"body",this.element[0].ownerDocument)[0]);
}
if(key==="disabled"&&_b84&&this.xhr){
this.xhr.abort();
}
},_initSource:function(){
var self=this,_b86,url;
if($.isArray(this.options.source)){
_b86=this.options.source;
this.source=function(_b88,_b89){
_b89($.ui.autocomplete.filter(_b86,_b88.term));
};
}else{
if(typeof this.options.source==="string"){
url=this.options.source;
this.source=function(_b8a,_b8b){
if(self.xhr){
self.xhr.abort();
}
self.xhr=$.ajax({url:url,data:_b8a,dataType:"json",autocompleteRequest:++_b6f,success:function(data,_b8d){
if(this.autocompleteRequest===_b6f){
_b8b(data);
}
},error:function(){
if(this.autocompleteRequest===_b6f){
_b8b([]);
}
}});
};
}else{
this.source=this.options.source;
}
}
},search:function(_b8e,_b8f){
_b8e=_b8e!=null?_b8e:this.element.val();
this.term=this.element.val();
if(_b8e.length<this.options.minLength){
return this.close(_b8f);
}
clearTimeout(this.closing);
if(this._trigger("search",_b8f)===false){
return;
}
return this._search(_b8e);
},_search:function(_b90){
this.pending++;
this.element.addClass("ui-autocomplete-loading");
this.source({term:_b90},this.response);
},_response:function(_b91){
if(!this.options.disabled&&_b91&&_b91.length){
_b91=this._normalize(_b91);
this._suggest(_b91);
this._trigger("open");
}else{
this.close();
}
this.pending--;
if(!this.pending){
this.element.removeClass("ui-autocomplete-loading");
}
},close:function(_b92){
clearTimeout(this.closing);
if(this.menu.element.is(":visible")){
this.menu.element.hide();
this.menu.deactivate();
this._trigger("close",_b92);
}
},_change:function(_b93){
if(this.previous!==this.element.val()){
this._trigger("change",_b93,{item:this.selectedItem});
}
},_normalize:function(_b94){
if(_b94.length&&_b94[0].label&&_b94[0].value){
return _b94;
}
return $.map(_b94,function(item){
if(typeof item==="string"){
return {label:item,value:item};
}
return $.extend({label:item.label||item.value,value:item.value||item.label},item);
});
},_suggest:function(_b96){
var ul=this.menu.element.empty().zIndex(this.element.zIndex()+1);
this._renderMenu(ul,_b96);
this.menu.deactivate();
this.menu.refresh();
ul.show();
this._resizeMenu();
ul.position($.extend({of:this.element},this.options.position));
if(this.options.autoFocus){
this.menu.next(new $.Event("mouseover"));
}
},_resizeMenu:function(){
var ul=this.menu.element;
ul.outerWidth(Math.max(ul.width("").outerWidth(),this.element.outerWidth()));
},_renderMenu:function(ul,_b9a){
var self=this;
$.each(_b9a,function(_b9c,item){
self._renderItem(ul,item);
});
},_renderItem:function(ul,item){
return $("<li></li>").data("item.autocomplete",item).append($("<a></a>").text(item.label)).appendTo(ul);
},_move:function(_ba0,_ba1){
if(!this.menu.element.is(":visible")){
this.search(null,_ba1);
return;
}
if(this.menu.first()&&/^previous/.test(_ba0)||this.menu.last()&&/^next/.test(_ba0)){
this.element.val(this.term);
this.menu.deactivate();
return;
}
this.menu[_ba0](_ba1);
},widget:function(){
return this.menu.element;
}});
$.extend($.ui.autocomplete,{escapeRegex:function(_ba2){
return _ba2.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");
},filter:function(_ba3,term){
var _ba5=new RegExp($.ui.autocomplete.escapeRegex(term),"i");
return $.grep(_ba3,function(_ba6){
return _ba5.test(_ba6.label||_ba6.value||_ba6);
});
}});
}(jQuery));
(function($){
$.widget("ui.menu",{_create:function(){
var self=this;
this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(_ba9){
if(!$(_ba9.target).closest(".ui-menu-item a").length){
return;
}
_ba9.preventDefault();
self.select(_ba9);
});
this.refresh();
},refresh:function(){
var self=this;
var _bab=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");
_bab.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(_bac){
self.activate(_bac,$(this).parent());
}).mouseleave(function(){
self.deactivate();
});
},activate:function(_bad,item){
this.deactivate();
if(this.hasScroll()){
var _baf=item.offset().top-this.element.offset().top,_bb0=this.element.attr("scrollTop"),_bb1=this.element.height();
if(_baf<0){
this.element.attr("scrollTop",_bb0+_baf);
}else{
if(_baf>=_bb1){
this.element.attr("scrollTop",_bb0+_baf-_bb1+item.height());
}
}
}
this.active=item.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();
this._trigger("focus",_bad,{item:item});
},deactivate:function(){
if(!this.active){
return;
}
this.active.children("a").removeClass("ui-state-hover").removeAttr("id");
this._trigger("blur");
this.active=null;
},next:function(_bb2){
this.move("next",".ui-menu-item:first",_bb2);
},previous:function(_bb3){
this.move("prev",".ui-menu-item:last",_bb3);
},first:function(){
return this.active&&!this.active.prevAll(".ui-menu-item").length;
},last:function(){
return this.active&&!this.active.nextAll(".ui-menu-item").length;
},move:function(_bb4,edge,_bb6){
if(!this.active){
this.activate(_bb6,this.element.children(edge));
return;
}
var next=this.active[_bb4+"All"](".ui-menu-item").eq(0);
if(next.length){
this.activate(_bb6,next);
}else{
this.activate(_bb6,this.element.children(edge));
}
},nextPage:function(_bb8){
if(this.hasScroll()){
if(!this.active||this.last()){
this.activate(_bb8,this.element.children(".ui-menu-item:first"));
return;
}
var base=this.active.offset().top,_bba=this.element.height(),_bbb=this.element.children(".ui-menu-item").filter(function(){
var _bbc=$(this).offset().top-base-_bba+$(this).height();
return _bbc<10&&_bbc>-10;
});
if(!_bbb.length){
_bbb=this.element.children(".ui-menu-item:last");
}
this.activate(_bb8,_bbb);
}else{
this.activate(_bb8,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"));
}
},previousPage:function(_bbd){
if(this.hasScroll()){
if(!this.active||this.first()){
this.activate(_bbd,this.element.children(".ui-menu-item:last"));
return;
}
var base=this.active.offset().top,_bbf=this.element.height();
result=this.element.children(".ui-menu-item").filter(function(){
var _bc0=$(this).offset().top-base+_bbf-$(this).height();
return _bc0<10&&_bc0>-10;
});
if(!result.length){
result=this.element.children(".ui-menu-item:first");
}
this.activate(_bbd,result);
}else{
this.activate(_bbd,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"));
}
},hasScroll:function(){
return this.element.height()<this.element.attr("scrollHeight");
},select:function(_bc1){
this._trigger("selected",_bc1,{item:this.active});
}});
}(jQuery));
(function($,_bc3){
var _bc4,_bc5="ui-button ui-widget ui-state-default ui-corner-all",_bc6="ui-state-hover ui-state-active ",_bc7="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",_bc8=function(_bc9){
$(":ui-button",_bc9.target.form).each(function(){
var inst=$(this).data("button");
setTimeout(function(){
inst.refresh();
},1);
});
},_bcb=function(_bcc){
var name=_bcc.name,form=_bcc.form,_bcf=$([]);
if(name){
if(form){
_bcf=$(form).find("[name='"+name+"']");
}else{
_bcf=$("[name='"+name+"']",_bcc.ownerDocument).filter(function(){
return !this.form;
});
}
}
return _bcf;
};
$.widget("ui.button",{options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){
this.element.closest("form").unbind("reset.button").bind("reset.button",_bc8);
if(typeof this.options.disabled!=="boolean"){
this.options.disabled=this.element.attr("disabled");
}
this._determineButtonType();
this.hasTitle=!!this.buttonElement.attr("title");
var self=this,_bd1=this.options,_bd2=this.type==="checkbox"||this.type==="radio",_bd3="ui-state-hover"+(!_bd2?" ui-state-active":""),_bd4="ui-state-focus";
if(_bd1.label===null){
_bd1.label=this.buttonElement.html();
}
if(this.element.is(":disabled")){
_bd1.disabled=true;
}
this.buttonElement.addClass(_bc5).attr("role","button").bind("mouseenter.button",function(){
if(_bd1.disabled){
return;
}
$(this).addClass("ui-state-hover");
if(this===_bc4){
$(this).addClass("ui-state-active");
}
}).bind("mouseleave.button",function(){
if(_bd1.disabled){
return;
}
$(this).removeClass(_bd3);
}).bind("focus.button",function(){
$(this).addClass(_bd4);
}).bind("blur.button",function(){
$(this).removeClass(_bd4);
});
if(_bd2){
this.element.bind("change.button",function(){
self.refresh();
});
}
if(this.type==="checkbox"){
this.buttonElement.bind("click.button",function(){
if(_bd1.disabled){
return false;
}
$(this).toggleClass("ui-state-active");
self.buttonElement.attr("aria-pressed",self.element[0].checked);
});
}else{
if(this.type==="radio"){
this.buttonElement.bind("click.button",function(){
if(_bd1.disabled){
return false;
}
$(this).addClass("ui-state-active");
self.buttonElement.attr("aria-pressed",true);
var _bd5=self.element[0];
_bcb(_bd5).not(_bd5).map(function(){
return $(this).button("widget")[0];
}).removeClass("ui-state-active").attr("aria-pressed",false);
});
}else{
this.buttonElement.bind("mousedown.button",function(){
if(_bd1.disabled){
return false;
}
$(this).addClass("ui-state-active");
_bc4=this;
$(document).one("mouseup",function(){
_bc4=null;
});
}).bind("mouseup.button",function(){
if(_bd1.disabled){
return false;
}
$(this).removeClass("ui-state-active");
}).bind("keydown.button",function(_bd6){
if(_bd1.disabled){
return false;
}
if(_bd6.keyCode==$.ui.keyCode.SPACE||_bd6.keyCode==$.ui.keyCode.ENTER){
$(this).addClass("ui-state-active");
}
}).bind("keyup.button",function(){
$(this).removeClass("ui-state-active");
});
if(this.buttonElement.is("a")){
this.buttonElement.keyup(function(_bd7){
if(_bd7.keyCode===$.ui.keyCode.SPACE){
$(this).click();
}
});
}
}
}
this._setOption("disabled",_bd1.disabled);
},_determineButtonType:function(){
if(this.element.is(":checkbox")){
this.type="checkbox";
}else{
if(this.element.is(":radio")){
this.type="radio";
}else{
if(this.element.is("input")){
this.type="input";
}else{
this.type="button";
}
}
}
if(this.type==="checkbox"||this.type==="radio"){
var _bd8=this.element.parents().filter(":last"),_bd9="label[for="+this.element.attr("id")+"]";
this.buttonElement=_bd8.find(_bd9);
if(!this.buttonElement.length){
_bd8=_bd8.length?_bd8.siblings():this.element.siblings();
this.buttonElement=_bd8.filter(_bd9);
if(!this.buttonElement.length){
this.buttonElement=_bd8.find(_bd9);
}
}
this.element.addClass("ui-helper-hidden-accessible");
var _bda=this.element.is(":checked");
if(_bda){
this.buttonElement.addClass("ui-state-active");
}
this.buttonElement.attr("aria-pressed",_bda);
}else{
this.buttonElement=this.element;
}
},widget:function(){
return this.buttonElement;
},destroy:function(){
this.element.removeClass("ui-helper-hidden-accessible");
this.buttonElement.removeClass(_bc5+" "+_bc6+" "+_bc7).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());
if(!this.hasTitle){
this.buttonElement.removeAttr("title");
}
$.Widget.prototype.destroy.call(this);
},_setOption:function(key,_bdc){
$.Widget.prototype._setOption.apply(this,arguments);
if(key==="disabled"){
if(_bdc){
this.element.attr("disabled",true);
}else{
this.element.removeAttr("disabled");
}
}
this._resetButton();
},refresh:function(){
var _bdd=this.element.is(":disabled");
if(_bdd!==this.options.disabled){
this._setOption("disabled",_bdd);
}
if(this.type==="radio"){
_bcb(this.element[0]).each(function(){
if($(this).is(":checked")){
$(this).button("widget").addClass("ui-state-active").attr("aria-pressed",true);
}else{
$(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",false);
}
});
}else{
if(this.type==="checkbox"){
if(this.element.is(":checked")){
this.buttonElement.addClass("ui-state-active").attr("aria-pressed",true);
}else{
this.buttonElement.removeClass("ui-state-active").attr("aria-pressed",false);
}
}
}
},_resetButton:function(){
if(this.type==="input"){
if(this.options.label){
this.element.val(this.options.label);
}
return;
}
var _bde=this.buttonElement.removeClass(_bc7),_bdf=$("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(_bde.empty()).text(),_be0=this.options.icons,_be1=_be0.primary&&_be0.secondary,_be2=[];
if(_be0.primary||_be0.secondary){
if(this.options.text){
_be2.push("ui-button-text-icon"+(_be1?"s":(_be0.primary?"-primary":"-secondary")));
}
if(_be0.primary){
_bde.prepend("<span class='ui-button-icon-primary ui-icon "+_be0.primary+"'></span>");
}
if(_be0.secondary){
_bde.append("<span class='ui-button-icon-secondary ui-icon "+_be0.secondary+"'></span>");
}
if(!this.options.text){
_be2.push(_be1?"ui-button-icons-only":"ui-button-icon-only");
if(!this.hasTitle){
_bde.attr("title",_bdf);
}
}
}else{
_be2.push("ui-button-text-only");
}
_bde.addClass(_be2.join(" "));
}});
$.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){
this.element.addClass("ui-buttonset");
},_init:function(){
this.refresh();
},_setOption:function(key,_be4){
if(key==="disabled"){
this.buttons.button("option",key,_be4);
}
$.Widget.prototype._setOption.apply(this,arguments);
},refresh:function(){
this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){
return $(this).button("widget")[0];
}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass("ui-corner-left").end().filter(":last").addClass("ui-corner-right").end().end();
},destroy:function(){
this.element.removeClass("ui-buttonset");
this.buttons.map(function(){
return $(this).button("widget")[0];
}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");
$.Widget.prototype.destroy.call(this);
}});
}(jQuery));
(function($,_be6){
var _be7="ui-dialog "+"ui-widget "+"ui-widget-content "+"ui-corner-all ",_be8={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},_be9={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true};
$.widget("ui.dialog",{options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",collision:"fit",using:function(pos){
var _beb=$(this).css(pos).offset().top;
if(_beb<0){
$(this).css("top",pos.top-_beb);
}
}},resizable:true,show:null,stack:true,title:"",width:300,zIndex:1000},_create:function(){
this.originalTitle=this.element.attr("title");
if(typeof this.originalTitle!=="string"){
this.originalTitle="";
}
this.options.title=this.options.title||this.originalTitle;
var self=this,_bed=self.options,_bee=_bed.title||"&#160;",_bef=$.ui.dialog.getTitleId(self.element),_bf0=(self.uiDialog=$("<div></div>")).appendTo(document.body).hide().addClass(_be7+_bed.dialogClass).css({zIndex:_bed.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(_bf1){
if(_bed.closeOnEscape&&_bf1.keyCode&&_bf1.keyCode===$.ui.keyCode.ESCAPE){
self.close(_bf1);
_bf1.preventDefault();
}
}).attr({role:"dialog","aria-labelledby":_bef}).mousedown(function(_bf2){
self.moveToTop(false,_bf2);
}),_bf3=self.element.show().removeAttr("title").addClass("ui-dialog-content "+"ui-widget-content").appendTo(_bf0),_bf4=(self.uiDialogTitlebar=$("<div></div>")).addClass("ui-dialog-titlebar "+"ui-widget-header "+"ui-corner-all "+"ui-helper-clearfix").prependTo(_bf0),_bf5=$("<a href=\"#\"></a>").addClass("ui-dialog-titlebar-close "+"ui-corner-all").attr("role","button").hover(function(){
_bf5.addClass("ui-state-hover");
},function(){
_bf5.removeClass("ui-state-hover");
}).focus(function(){
_bf5.addClass("ui-state-focus");
}).blur(function(){
_bf5.removeClass("ui-state-focus");
}).click(function(_bf6){
self.close(_bf6);
return false;
}).appendTo(_bf4),_bf7=(self.uiDialogTitlebarCloseText=$("<span></span>")).addClass("ui-icon "+"ui-icon-closethick").text(_bed.closeText).appendTo(_bf5),_bf8=$("<span></span>").addClass("ui-dialog-title").attr("id",_bef).html(_bee).prependTo(_bf4);
if($.isFunction(_bed.beforeclose)&&!$.isFunction(_bed.beforeClose)){
_bed.beforeClose=_bed.beforeclose;
}
_bf4.find("*").add(_bf4).disableSelection();
if(_bed.draggable&&$.fn.draggable){
self._makeDraggable();
}
if(_bed.resizable&&$.fn.resizable){
self._makeResizable();
}
self._createButtons(_bed.buttons);
self._isOpen=false;
if($.fn.bgiframe){
_bf0.bgiframe();
}
},_init:function(){
if(this.options.autoOpen){
this.open();
}
},destroy:function(){
var self=this;
if(self.overlay){
self.overlay.destroy();
}
self.uiDialog.hide();
self.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");
self.uiDialog.remove();
if(self.originalTitle){
self.element.attr("title",self.originalTitle);
}
return self;
},widget:function(){
return this.uiDialog;
},close:function(_bfa){
var self=this,maxZ,_bfd;
if(false===self._trigger("beforeClose",_bfa)){
return;
}
if(self.overlay){
self.overlay.destroy();
}
self.uiDialog.unbind("keypress.ui-dialog");
self._isOpen=false;
if(self.options.hide){
self.uiDialog.hide(self.options.hide,function(){
self._trigger("close",_bfa);
});
}else{
self.uiDialog.hide();
self._trigger("close",_bfa);
}
$.ui.dialog.overlay.resize();
if(self.options.modal){
maxZ=0;
$(".ui-dialog").each(function(){
if(this!==self.uiDialog[0]){
_bfd=$(this).css("z-index");
if(!isNaN(_bfd)){
maxZ=Math.max(maxZ,_bfd);
}
}
});
$.ui.dialog.maxZ=maxZ;
}
return self;
},isOpen:function(){
return this._isOpen;
},moveToTop:function(_bfe,_bff){
var self=this,_c01=self.options,_c02;
if((_c01.modal&&!_bfe)||(!_c01.stack&&!_c01.modal)){
return self._trigger("focus",_bff);
}
if(_c01.zIndex>$.ui.dialog.maxZ){
$.ui.dialog.maxZ=_c01.zIndex;
}
if(self.overlay){
$.ui.dialog.maxZ+=1;
self.overlay.$el.css("z-index",$.ui.dialog.overlay.maxZ=$.ui.dialog.maxZ);
}
_c02={scrollTop:self.element.attr("scrollTop"),scrollLeft:self.element.attr("scrollLeft")};
$.ui.dialog.maxZ+=1;
self.uiDialog.css("z-index",$.ui.dialog.maxZ);
self.element.attr(_c02);
self._trigger("focus",_bff);
return self;
},open:function(){
if(this._isOpen){
return;
}
var self=this,_c04=self.options,_c05=self.uiDialog;
self.overlay=_c04.modal?new $.ui.dialog.overlay(self):null;
self._size();
self._position(_c04.position);
_c05.show(_c04.show);
self.moveToTop(true);
if(_c04.modal){
_c05.bind("keypress.ui-dialog",function(_c06){
if(_c06.keyCode!==$.ui.keyCode.TAB){
return;
}
var _c07=$(":tabbable",this),_c08=_c07.filter(":first"),last=_c07.filter(":last");
if(_c06.target===last[0]&&!_c06.shiftKey){
_c08.focus(1);
return false;
}else{
if(_c06.target===_c08[0]&&_c06.shiftKey){
last.focus(1);
return false;
}
}
});
}
$(self.element.find(":tabbable").get().concat(_c05.find(".ui-dialog-buttonpane :tabbable").get().concat(_c05.get()))).eq(0).focus();
self._isOpen=true;
self._trigger("open");
return self;
},_createButtons:function(_c0a){
var self=this,_c0c=false,_c0d=$("<div></div>").addClass("ui-dialog-buttonpane "+"ui-widget-content "+"ui-helper-clearfix"),_c0e=$("<div></div>").addClass("ui-dialog-buttonset").appendTo(_c0d);
self.uiDialog.find(".ui-dialog-buttonpane").remove();
if(typeof _c0a==="object"&&_c0a!==null){
$.each(_c0a,function(){
return !(_c0c=true);
});
}
if(_c0c){
$.each(_c0a,function(name,_c10){
_c10=$.isFunction(_c10)?{click:_c10,text:name}:_c10;
var _c11=$("<button type=\"button\"></button>").attr(_c10,true).unbind("click").click(function(){
_c10.click.apply(self.element[0],arguments);
}).appendTo(_c0e);
if($.fn.button){
_c11.button();
}
});
_c0d.appendTo(self.uiDialog);
}
},_makeDraggable:function(){
var self=this,_c13=self.options,doc=$(document),_c15;
function filteredUi(ui){
return {position:ui.position,offset:ui.offset};
}
self.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(_c17,ui){
_c15=_c13.height==="auto"?"auto":$(this).height();
$(this).height($(this).height()).addClass("ui-dialog-dragging");
self._trigger("dragStart",_c17,filteredUi(ui));
},drag:function(_c19,ui){
self._trigger("drag",_c19,filteredUi(ui));
},stop:function(_c1b,ui){
_c13.position=[ui.position.left-doc.scrollLeft(),ui.position.top-doc.scrollTop()];
$(this).removeClass("ui-dialog-dragging").height(_c15);
self._trigger("dragStop",_c1b,filteredUi(ui));
$.ui.dialog.overlay.resize();
}});
},_makeResizable:function(_c1d){
_c1d=(_c1d===_be6?this.options.resizable:_c1d);
var self=this,_c1f=self.options,_c20=self.uiDialog.css("position"),_c21=(typeof _c1d==="string"?_c1d:"n,e,s,w,se,sw,ne,nw");
function filteredUi(ui){
return {originalPosition:ui.originalPosition,originalSize:ui.originalSize,position:ui.position,size:ui.size};
}
self.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:self.element,maxWidth:_c1f.maxWidth,maxHeight:_c1f.maxHeight,minWidth:_c1f.minWidth,minHeight:self._minHeight(),handles:_c21,start:function(_c23,ui){
$(this).addClass("ui-dialog-resizing");
self._trigger("resizeStart",_c23,filteredUi(ui));
},resize:function(_c25,ui){
self._trigger("resize",_c25,filteredUi(ui));
},stop:function(_c27,ui){
$(this).removeClass("ui-dialog-resizing");
_c1f.height=$(this).height();
_c1f.width=$(this).width();
self._trigger("resizeStop",_c27,filteredUi(ui));
$.ui.dialog.overlay.resize();
}}).css("position",_c20).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se");
},_minHeight:function(){
var _c29=this.options;
if(_c29.height==="auto"){
return _c29.minHeight;
}else{
return Math.min(_c29.minHeight,_c29.height);
}
},_position:function(_c2a){
var myAt=[],_c2c=[0,0],_c2d;
if(_c2a){
if(typeof _c2a==="string"||(typeof _c2a==="object"&&"0" in _c2a)){
myAt=_c2a.split?_c2a.split(" "):[_c2a[0],_c2a[1]];
if(myAt.length===1){
myAt[1]=myAt[0];
}
$.each(["left","top"],function(i,_c2f){
if(+myAt[i]===myAt[i]){
_c2c[i]=myAt[i];
myAt[i]=_c2f;
}
});
_c2a={my:myAt.join(" "),at:myAt.join(" "),offset:_c2c.join(" ")};
}
_c2a=$.extend({},$.ui.dialog.prototype.options.position,_c2a);
}else{
_c2a=$.ui.dialog.prototype.options.position;
}
_c2d=this.uiDialog.is(":visible");
if(!_c2d){
this.uiDialog.show();
}
this.uiDialog.css({top:0,left:0}).position($.extend({of:window},_c2a));
if(!_c2d){
this.uiDialog.hide();
}
},_setOptions:function(_c30){
var self=this,_c32={},_c33=false;
$.each(_c30,function(key,_c35){
self._setOption(key,_c35);
if(key in _be8){
_c33=true;
}
if(key in _be9){
_c32[key]=_c35;
}
});
if(_c33){
this._size();
}
if(this.uiDialog.is(":data(resizable)")){
this.uiDialog.resizable("option",_c32);
}
},_setOption:function(key,_c37){
var self=this,_c39=self.uiDialog;
switch(key){
case "beforeclose":
key="beforeClose";
break;
case "buttons":
self._createButtons(_c37);
break;
case "closeText":
self.uiDialogTitlebarCloseText.text(""+_c37);
break;
case "dialogClass":
_c39.removeClass(self.options.dialogClass).addClass(_be7+_c37);
break;
case "disabled":
if(_c37){
_c39.addClass("ui-dialog-disabled");
}else{
_c39.removeClass("ui-dialog-disabled");
}
break;
case "draggable":
var _c3a=_c39.is(":data(draggable)");
if(_c3a&&!_c37){
_c39.draggable("destroy");
}
if(!_c3a&&_c37){
self._makeDraggable();
}
break;
case "position":
self._position(_c37);
break;
case "resizable":
var _c3b=_c39.is(":data(resizable)");
if(_c3b&&!_c37){
_c39.resizable("destroy");
}
if(_c3b&&typeof _c37==="string"){
_c39.resizable("option","handles",_c37);
}
if(!_c3b&&_c37!==false){
self._makeResizable(_c37);
}
break;
case "title":
$(".ui-dialog-title",self.uiDialogTitlebar).html(""+(_c37||"&#160;"));
break;
}
$.Widget.prototype._setOption.apply(self,arguments);
},_size:function(){
var _c3c=this.options,_c3d,_c3e,_c3f=this.uiDialog.is(":visible");
this.element.show().css({width:"auto",minHeight:0,height:0});
if(_c3c.minWidth>_c3c.width){
_c3c.width=_c3c.minWidth;
}
_c3d=this.uiDialog.css({height:"auto",width:_c3c.width}).height();
_c3e=Math.max(0,_c3c.minHeight-_c3d);
if(_c3c.height==="auto"){
if($.support.minHeight){
this.element.css({minHeight:_c3e,height:"auto"});
}else{
this.uiDialog.show();
var _c40=this.element.css("height","auto").height();
if(!_c3f){
this.uiDialog.hide();
}
this.element.height(Math.max(_c40,_c3e));
}
}else{
this.element.height(Math.max(_c3c.height-_c3d,0));
}
if(this.uiDialog.is(":data(resizable)")){
this.uiDialog.resizable("option","minHeight",this._minHeight());
}
}});
$.extend($.ui.dialog,{version:"1.8.11",uuid:0,maxZ:0,getTitleId:function($el){
var id=$el.attr("id");
if(!id){
this.uuid+=1;
id=this.uuid;
}
return "ui-dialog-title-"+id;
},overlay:function(_c43){
this.$el=$.ui.dialog.overlay.create(_c43);
}});
$.extend($.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:$.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(_c44){
return _c44+".dialog-overlay";
}).join(" "),create:function(_c45){
if(this.instances.length===0){
setTimeout(function(){
if($.ui.dialog.overlay.instances.length){
$(document).bind($.ui.dialog.overlay.events,function(_c46){
if($(_c46.target).zIndex()<$.ui.dialog.overlay.maxZ){
return false;
}
});
}
},1);
$(document).bind("keydown.dialog-overlay",function(_c47){
if(_c45.options.closeOnEscape&&_c47.keyCode&&_c47.keyCode===$.ui.keyCode.ESCAPE){
_c45.close(_c47);
_c47.preventDefault();
}
});
$(window).bind("resize.dialog-overlay",$.ui.dialog.overlay.resize);
}
var $el=(this.oldInstances.pop()||$("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});
if($.fn.bgiframe){
$el.bgiframe();
}
this.instances.push($el);
return $el;
},destroy:function($el){
var _c4a=$.inArray($el,this.instances);
if(_c4a!=-1){
this.oldInstances.push(this.instances.splice(_c4a,1)[0]);
}
if(this.instances.length===0){
$([document,window]).unbind(".dialog-overlay");
}
$el.remove();
var maxZ=0;
$.each(this.instances,function(){
maxZ=Math.max(maxZ,this.css("z-index"));
});
this.maxZ=maxZ;
},height:function(){
var _c4c,_c4d;
if($.browser.msie&&$.browser.version<7){
_c4c=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);
_c4d=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);
if(_c4c<_c4d){
return $(window).height()+"px";
}else{
return _c4c+"px";
}
}else{
return $(document).height()+"px";
}
},width:function(){
var _c4e,_c4f;
if($.browser.msie&&$.browser.version<7){
_c4e=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);
_c4f=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);
if(_c4e<_c4f){
return $(window).width()+"px";
}else{
return _c4e+"px";
}
}else{
return $(document).width()+"px";
}
},resize:function(){
var _c50=$([]);
$.each($.ui.dialog.overlay.instances,function(){
_c50=_c50.add(this);
});
_c50.css({width:0,height:0}).css({width:$.ui.dialog.overlay.width(),height:$.ui.dialog.overlay.height()});
}});
$.extend($.ui.dialog.overlay.prototype,{destroy:function(){
$.ui.dialog.overlay.destroy(this.$el);
}});
}(jQuery));
(function($,_c52){
var _c53=5;
$.widget("ui.slider",$.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){
var self=this,o=this.options;
this._keySliding=false;
this._mouseSliding=false;
this._animateOff=true;
this._handleIndex=null;
this._detectOrientation();
this._mouseInit();
this.element.addClass("ui-slider"+" ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all");
if(o.disabled){
this.element.addClass("ui-slider-disabled ui-disabled");
}
this.range=$([]);
if(o.range){
if(o.range===true){
this.range=$("<div></div>");
if(!o.values){
o.values=[this._valueMin(),this._valueMin()];
}
if(o.values.length&&o.values.length!==2){
o.values=[o.values[0],o.values[0]];
}
}else{
this.range=$("<div></div>");
}
this.range.appendTo(this.element).addClass("ui-slider-range");
if(o.range==="min"||o.range==="max"){
this.range.addClass("ui-slider-range-"+o.range);
}
this.range.addClass("ui-widget-header");
}
if($(".ui-slider-handle",this.element).length===0){
$("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");
}
if(o.values&&o.values.length){
while($(".ui-slider-handle",this.element).length<o.values.length){
$("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");
}
}
this.handles=$(".ui-slider-handle",this.element).addClass("ui-state-default"+" ui-corner-all");
this.handle=this.handles.eq(0);
this.handles.add(this.range).filter("a").click(function(_c56){
_c56.preventDefault();
}).hover(function(){
if(!o.disabled){
$(this).addClass("ui-state-hover");
}
},function(){
$(this).removeClass("ui-state-hover");
}).focus(function(){
if(!o.disabled){
$(".ui-slider .ui-state-focus").removeClass("ui-state-focus");
$(this).addClass("ui-state-focus");
}else{
$(this).blur();
}
}).blur(function(){
$(this).removeClass("ui-state-focus");
});
this.handles.each(function(i){
$(this).data("index.ui-slider-handle",i);
});
this.handles.keydown(function(_c58){
var ret=true,_c5a=$(this).data("index.ui-slider-handle"),_c5b,_c5c,_c5d,step;
if(self.options.disabled){
return;
}
switch(_c58.keyCode){
case $.ui.keyCode.HOME:
case $.ui.keyCode.END:
case $.ui.keyCode.PAGE_UP:
case $.ui.keyCode.PAGE_DOWN:
case $.ui.keyCode.UP:
case $.ui.keyCode.RIGHT:
case $.ui.keyCode.DOWN:
case $.ui.keyCode.LEFT:
ret=false;
if(!self._keySliding){
self._keySliding=true;
$(this).addClass("ui-state-active");
_c5b=self._start(_c58,_c5a);
if(_c5b===false){
return;
}
}
break;
}
step=self.options.step;
if(self.options.values&&self.options.values.length){
_c5c=_c5d=self.values(_c5a);
}else{
_c5c=_c5d=self.value();
}
switch(_c58.keyCode){
case $.ui.keyCode.HOME:
_c5d=self._valueMin();
break;
case $.ui.keyCode.END:
_c5d=self._valueMax();
break;
case $.ui.keyCode.PAGE_UP:
_c5d=self._trimAlignValue(_c5c+((self._valueMax()-self._valueMin())/_c53));
break;
case $.ui.keyCode.PAGE_DOWN:
_c5d=self._trimAlignValue(_c5c-((self._valueMax()-self._valueMin())/_c53));
break;
case $.ui.keyCode.UP:
case $.ui.keyCode.RIGHT:
if(_c5c===self._valueMax()){
return;
}
_c5d=self._trimAlignValue(_c5c+step);
break;
case $.ui.keyCode.DOWN:
case $.ui.keyCode.LEFT:
if(_c5c===self._valueMin()){
return;
}
_c5d=self._trimAlignValue(_c5c-step);
break;
}
self._slide(_c58,_c5a,_c5d);
return ret;
}).keyup(function(_c5f){
var _c60=$(this).data("index.ui-slider-handle");
if(self._keySliding){
self._keySliding=false;
self._stop(_c5f,_c60);
self._change(_c5f,_c60);
$(this).removeClass("ui-state-active");
}
});
this._refreshValue();
this._animateOff=false;
},destroy:function(){
this.handles.remove();
this.range.remove();
this.element.removeClass("ui-slider"+" ui-slider-horizontal"+" ui-slider-vertical"+" ui-slider-disabled"+" ui-widget"+" ui-widget-content"+" ui-corner-all").removeData("slider").unbind(".slider");
this._mouseDestroy();
return this;
},_mouseCapture:function(_c61){
var o=this.options,_c63,_c64,_c65,_c66,self,_c68,_c69,_c6a,_c6b;
if(o.disabled){
return false;
}
this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};
this.elementOffset=this.element.offset();
_c63={x:_c61.pageX,y:_c61.pageY};
_c64=this._normValueFromMouse(_c63);
_c65=this._valueMax()-this._valueMin()+1;
self=this;
this.handles.each(function(i){
var _c6d=Math.abs(_c64-self.values(i));
if(_c65>_c6d){
_c65=_c6d;
_c66=$(this);
_c68=i;
}
});
if(o.range===true&&this.values(1)===o.min){
_c68+=1;
_c66=$(this.handles[_c68]);
}
_c69=this._start(_c61,_c68);
if(_c69===false){
return false;
}
this._mouseSliding=true;
self._handleIndex=_c68;
_c66.addClass("ui-state-active").focus();
_c6a=_c66.offset();
_c6b=!$(_c61.target).parents().andSelf().is(".ui-slider-handle");
this._clickOffset=_c6b?{left:0,top:0}:{left:_c61.pageX-_c6a.left-(_c66.width()/2),top:_c61.pageY-_c6a.top-(_c66.height()/2)-(parseInt(_c66.css("borderTopWidth"),10)||0)-(parseInt(_c66.css("borderBottomWidth"),10)||0)+(parseInt(_c66.css("marginTop"),10)||0)};
if(!this.handles.hasClass("ui-state-hover")){
this._slide(_c61,_c68,_c64);
}
this._animateOff=true;
return true;
},_mouseStart:function(_c6e){
return true;
},_mouseDrag:function(_c6f){
var _c70={x:_c6f.pageX,y:_c6f.pageY},_c71=this._normValueFromMouse(_c70);
this._slide(_c6f,this._handleIndex,_c71);
return false;
},_mouseStop:function(_c72){
this.handles.removeClass("ui-state-active");
this._mouseSliding=false;
this._stop(_c72,this._handleIndex);
this._change(_c72,this._handleIndex);
this._handleIndex=null;
this._clickOffset=null;
this._animateOff=false;
return false;
},_detectOrientation:function(){
this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal";
},_normValueFromMouse:function(_c73){
var _c74,_c75,_c76,_c77,_c78;
if(this.orientation==="horizontal"){
_c74=this.elementSize.width;
_c75=_c73.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0);
}else{
_c74=this.elementSize.height;
_c75=_c73.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0);
}
_c76=(_c75/_c74);
if(_c76>1){
_c76=1;
}
if(_c76<0){
_c76=0;
}
if(this.orientation==="vertical"){
_c76=1-_c76;
}
_c77=this._valueMax()-this._valueMin();
_c78=this._valueMin()+_c76*_c77;
return this._trimAlignValue(_c78);
},_start:function(_c79,_c7a){
var _c7b={handle:this.handles[_c7a],value:this.value()};
if(this.options.values&&this.options.values.length){
_c7b.value=this.values(_c7a);
_c7b.values=this.values();
}
return this._trigger("start",_c79,_c7b);
},_slide:function(_c7c,_c7d,_c7e){
var _c7f,_c80,_c81;
if(this.options.values&&this.options.values.length){
_c7f=this.values(_c7d?0:1);
if((this.options.values.length===2&&this.options.range===true)&&((_c7d===0&&_c7e>_c7f)||(_c7d===1&&_c7e<_c7f))){
_c7e=_c7f;
}
if(_c7e!==this.values(_c7d)){
_c80=this.values();
_c80[_c7d]=_c7e;
_c81=this._trigger("slide",_c7c,{handle:this.handles[_c7d],value:_c7e,values:_c80});
_c7f=this.values(_c7d?0:1);
if(_c81!==false){
this.values(_c7d,_c7e,true);
}
}
}else{
if(_c7e!==this.value()){
_c81=this._trigger("slide",_c7c,{handle:this.handles[_c7d],value:_c7e});
if(_c81!==false){
this.value(_c7e);
}
}
}
},_stop:function(_c82,_c83){
var _c84={handle:this.handles[_c83],value:this.value()};
if(this.options.values&&this.options.values.length){
_c84.value=this.values(_c83);
_c84.values=this.values();
}
this._trigger("stop",_c82,_c84);
},_change:function(_c85,_c86){
if(!this._keySliding&&!this._mouseSliding){
var _c87={handle:this.handles[_c86],value:this.value()};
if(this.options.values&&this.options.values.length){
_c87.value=this.values(_c86);
_c87.values=this.values();
}
this._trigger("change",_c85,_c87);
}
},value:function(_c88){
if(arguments.length){
this.options.value=this._trimAlignValue(_c88);
this._refreshValue();
this._change(null,0);
}
return this._value();
},values:function(_c89,_c8a){
var vals,_c8c,i;
if(arguments.length>1){
this.options.values[_c89]=this._trimAlignValue(_c8a);
this._refreshValue();
this._change(null,_c89);
}
if(arguments.length){
if($.isArray(arguments[0])){
vals=this.options.values;
_c8c=arguments[0];
for(i=0;i<vals.length;i+=1){
vals[i]=this._trimAlignValue(_c8c[i]);
this._change(null,i);
}
this._refreshValue();
}else{
if(this.options.values&&this.options.values.length){
return this._values(_c89);
}else{
return this.value();
}
}
}else{
return this._values();
}
},_setOption:function(key,_c8f){
var i,_c91=0;
if($.isArray(this.options.values)){
_c91=this.options.values.length;
}
$.Widget.prototype._setOption.apply(this,arguments);
switch(key){
case "disabled":
if(_c8f){
this.handles.filter(".ui-state-focus").blur();
this.handles.removeClass("ui-state-hover");
this.handles.attr("disabled","disabled");
this.element.addClass("ui-disabled");
}else{
this.handles.removeAttr("disabled");
this.element.removeClass("ui-disabled");
}
break;
case "orientation":
this._detectOrientation();
this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);
this._refreshValue();
break;
case "value":
this._animateOff=true;
this._refreshValue();
this._change(null,0);
this._animateOff=false;
break;
case "values":
this._animateOff=true;
this._refreshValue();
for(i=0;i<_c91;i+=1){
this._change(null,i);
}
this._animateOff=false;
break;
}
},_value:function(){
var val=this.options.value;
val=this._trimAlignValue(val);
return val;
},_values:function(_c93){
var val,vals,i;
if(arguments.length){
val=this.options.values[_c93];
val=this._trimAlignValue(val);
return val;
}else{
vals=this.options.values.slice();
for(i=0;i<vals.length;i+=1){
vals[i]=this._trimAlignValue(vals[i]);
}
return vals;
}
},_trimAlignValue:function(val){
if(val<=this._valueMin()){
return this._valueMin();
}
if(val>=this._valueMax()){
return this._valueMax();
}
var step=(this.options.step>0)?this.options.step:1,_c99=(val-this._valueMin())%step;
alignValue=val-_c99;
if(Math.abs(_c99)*2>=step){
alignValue+=(_c99>0)?step:(-step);
}
return parseFloat(alignValue.toFixed(5));
},_valueMin:function(){
return this.options.min;
},_valueMax:function(){
return this.options.max;
},_refreshValue:function(){
var _c9a=this.options.range,o=this.options,self=this,_c9d=(!this._animateOff)?o.animate:false,_c9e,_set={},_ca0,_ca1,_ca2,_ca3;
if(this.options.values&&this.options.values.length){
this.handles.each(function(i,j){
_c9e=(self.values(i)-self._valueMin())/(self._valueMax()-self._valueMin())*100;
_set[self.orientation==="horizontal"?"left":"bottom"]=_c9e+"%";
$(this).stop(1,1)[_c9d?"animate":"css"](_set,o.animate);
if(self.options.range===true){
if(self.orientation==="horizontal"){
if(i===0){
self.range.stop(1,1)[_c9d?"animate":"css"]({left:_c9e+"%"},o.animate);
}
if(i===1){
self.range[_c9d?"animate":"css"]({width:(_c9e-_ca0)+"%"},{queue:false,duration:o.animate});
}
}else{
if(i===0){
self.range.stop(1,1)[_c9d?"animate":"css"]({bottom:(_c9e)+"%"},o.animate);
}
if(i===1){
self.range[_c9d?"animate":"css"]({height:(_c9e-_ca0)+"%"},{queue:false,duration:o.animate});
}
}
}
_ca0=_c9e;
});
}else{
_ca1=this.value();
_ca2=this._valueMin();
_ca3=this._valueMax();
_c9e=(_ca3!==_ca2)?(_ca1-_ca2)/(_ca3-_ca2)*100:0;
_set[self.orientation==="horizontal"?"left":"bottom"]=_c9e+"%";
this.handle.stop(1,1)[_c9d?"animate":"css"](_set,o.animate);
if(_c9a==="min"&&this.orientation==="horizontal"){
this.range.stop(1,1)[_c9d?"animate":"css"]({width:_c9e+"%"},o.animate);
}
if(_c9a==="max"&&this.orientation==="horizontal"){
this.range[_c9d?"animate":"css"]({width:(100-_c9e)+"%"},{queue:false,duration:o.animate});
}
if(_c9a==="min"&&this.orientation==="vertical"){
this.range.stop(1,1)[_c9d?"animate":"css"]({height:_c9e+"%"},o.animate);
}
if(_c9a==="max"&&this.orientation==="vertical"){
this.range[_c9d?"animate":"css"]({height:(100-_c9e)+"%"},{queue:false,duration:o.animate});
}
}
}});
$.extend($.ui.slider,{version:"1.8.11"});
}(jQuery));
(function($,_ca7){
var _ca8=0,_ca9=0;
function getNextTabId(){
return ++_ca8;
}
function getNextListId(){
return ++_ca9;
}
$.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:false,cookie:null,collapsible:false,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){
this._tabify(true);
},_setOption:function(key,_cab){
if(key=="selected"){
if(this.options.collapsible&&_cab==this.options.selected){
return;
}
this.select(_cab);
}else{
this.options[key]=_cab;
this._tabify();
}
},_tabId:function(a){
return a.title&&a.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+getNextTabId();
},_sanitizeSelector:function(hash){
return hash.replace(/:/g,"\\:");
},_cookie:function(){
var _cae=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+getNextListId());
return $.cookie.apply(null,[_cae].concat($.makeArray(arguments)));
},_ui:function(tab,_cb0){
return {tab:tab,panel:_cb0,index:this.anchors.index(tab)};
},_cleanup:function(){
this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){
var el=$(this);
el.html(el.data("label.tabs")).removeData("label.tabs");
});
},_tabify:function(init){
var self=this,o=this.options,_cb5=/^#.+/;
this.list=this.element.find("ol,ul").eq(0);
this.lis=$(" > li:has(a[href])",this.list);
this.anchors=this.lis.map(function(){
return $("a",this)[0];
});
this.panels=$([]);
this.anchors.each(function(i,a){
var href=$(a).attr("href");
var _cb9=href.split("#")[0],_cba;
if(_cb9&&(_cb9===location.toString().split("#")[0]||(_cba=$("base")[0])&&_cb9===_cba.href)){
href=a.hash;
a.href=href;
}
if(_cb5.test(href)){
self.panels=self.panels.add(self.element.find(self._sanitizeSelector(href)));
}else{
if(href&&href!=="#"){
$.data(a,"href.tabs",href);
$.data(a,"load.tabs",href.replace(/#.*$/,""));
var id=self._tabId(a);
a.href="#"+id;
var _cbc=self.element.find("#"+id);
if(!_cbc.length){
_cbc=$(o.panelTemplate).attr("id",id).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(self.panels[i-1]||self.list);
_cbc.data("destroy.tabs",true);
}
self.panels=self.panels.add(_cbc);
}else{
o.disabled.push(i);
}
}
});
if(init){
this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");
this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");
this.lis.addClass("ui-state-default ui-corner-top");
this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");
if(o.selected===_ca7){
if(location.hash){
this.anchors.each(function(i,a){
if(a.hash==location.hash){
o.selected=i;
return false;
}
});
}
if(typeof o.selected!=="number"&&o.cookie){
o.selected=parseInt(self._cookie(),10);
}
if(typeof o.selected!=="number"&&this.lis.filter(".ui-tabs-selected").length){
o.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"));
}
o.selected=o.selected||(this.lis.length?0:-1);
}else{
if(o.selected===null){
o.selected=-1;
}
}
o.selected=((o.selected>=0&&this.anchors[o.selected])||o.selected<0)?o.selected:0;
o.disabled=$.unique(o.disabled.concat($.map(this.lis.filter(".ui-state-disabled"),function(n,i){
return self.lis.index(n);
}))).sort();
if($.inArray(o.selected,o.disabled)!=-1){
o.disabled.splice($.inArray(o.selected,o.disabled),1);
}
this.panels.addClass("ui-tabs-hide");
this.lis.removeClass("ui-tabs-selected ui-state-active");
if(o.selected>=0&&this.anchors.length){
self.element.find(self._sanitizeSelector(self.anchors[o.selected].hash)).removeClass("ui-tabs-hide");
this.lis.eq(o.selected).addClass("ui-tabs-selected ui-state-active");
self.element.queue("tabs",function(){
self._trigger("show",null,self._ui(self.anchors[o.selected],self.element.find(self._sanitizeSelector(self.anchors[o.selected].hash))[0]));
});
this.load(o.selected);
}
$(window).bind("unload",function(){
self.lis.add(self.anchors).unbind(".tabs");
self.lis=self.anchors=self.panels=null;
});
}else{
o.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"));
}
this.element[o.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");
if(o.cookie){
this._cookie(o.selected,o.cookie);
}
for(var i=0,li;(li=this.lis[i]);i++){
$(li)[$.inArray(i,o.disabled)!=-1&&!$(li).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");
}
if(o.cache===false){
this.anchors.removeData("cache.tabs");
}
this.lis.add(this.anchors).unbind(".tabs");
if(o.event!=="mouseover"){
var _cc3=function(_cc4,el){
if(el.is(":not(.ui-state-disabled)")){
el.addClass("ui-state-"+_cc4);
}
};
var _cc6=function(_cc7,el){
el.removeClass("ui-state-"+_cc7);
};
this.lis.bind("mouseover.tabs",function(){
_cc3("hover",$(this));
});
this.lis.bind("mouseout.tabs",function(){
_cc6("hover",$(this));
});
this.anchors.bind("focus.tabs",function(){
_cc3("focus",$(this).closest("li"));
});
this.anchors.bind("blur.tabs",function(){
_cc6("focus",$(this).closest("li"));
});
}
var _cc9,_cca;
if(o.fx){
if($.isArray(o.fx)){
_cc9=o.fx[0];
_cca=o.fx[1];
}else{
_cc9=_cca=o.fx;
}
}
function resetStyle($el,fx){
$el.css("display","");
if(!$.support.opacity&&fx.opacity){
$el[0].style.removeAttribute("filter");
}
}
var _ccd=_cca?function(_cce,_ccf){
$(_cce).closest("li").addClass("ui-tabs-selected ui-state-active");
_ccf.hide().removeClass("ui-tabs-hide").animate(_cca,_cca.duration||"normal",function(){
resetStyle(_ccf,_cca);
self._trigger("show",null,self._ui(_cce,_ccf[0]));
});
}:function(_cd0,_cd1){
$(_cd0).closest("li").addClass("ui-tabs-selected ui-state-active");
_cd1.removeClass("ui-tabs-hide");
self._trigger("show",null,self._ui(_cd0,_cd1[0]));
};
var _cd2=_cc9?function(_cd3,_cd4){
_cd4.animate(_cc9,_cc9.duration||"normal",function(){
self.lis.removeClass("ui-tabs-selected ui-state-active");
_cd4.addClass("ui-tabs-hide");
resetStyle(_cd4,_cc9);
self.element.dequeue("tabs");
});
}:function(_cd5,_cd6,_cd7){
self.lis.removeClass("ui-tabs-selected ui-state-active");
_cd6.addClass("ui-tabs-hide");
self.element.dequeue("tabs");
};
this.anchors.bind(o.event+".tabs",function(){
var el=this,$li=$(el).closest("li"),_cda=self.panels.filter(":not(.ui-tabs-hide)"),_cdb=self.element.find(self._sanitizeSelector(el.hash));
if(($li.hasClass("ui-tabs-selected")&&!o.collapsible)||$li.hasClass("ui-state-disabled")||$li.hasClass("ui-state-processing")||self.panels.filter(":animated").length||self._trigger("select",null,self._ui(this,_cdb[0]))===false){
this.blur();
return false;
}
o.selected=self.anchors.index(this);
self.abort();
if(o.collapsible){
if($li.hasClass("ui-tabs-selected")){
o.selected=-1;
if(o.cookie){
self._cookie(o.selected,o.cookie);
}
self.element.queue("tabs",function(){
_cd2(el,_cda);
}).dequeue("tabs");
this.blur();
return false;
}else{
if(!_cda.length){
if(o.cookie){
self._cookie(o.selected,o.cookie);
}
self.element.queue("tabs",function(){
_ccd(el,_cdb);
});
self.load(self.anchors.index(this));
this.blur();
return false;
}
}
}
if(o.cookie){
self._cookie(o.selected,o.cookie);
}
if(_cdb.length){
if(_cda.length){
self.element.queue("tabs",function(){
_cd2(el,_cda);
});
}
self.element.queue("tabs",function(){
_ccd(el,_cdb);
});
self.load(self.anchors.index(this));
}else{
throw "jQuery UI Tabs: Mismatching fragment identifier.";
}
if($.browser.msie){
this.blur();
}
});
this.anchors.bind("click.tabs",function(){
return false;
});
},_getIndex:function(_cdc){
if(typeof _cdc=="string"){
_cdc=this.anchors.index(this.anchors.filter("[href$="+_cdc+"]"));
}
return _cdc;
},destroy:function(){
var o=this.options;
this.abort();
this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");
this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");
this.anchors.each(function(){
var href=$.data(this,"href.tabs");
if(href){
this.href=href;
}
var _cdf=$(this).unbind(".tabs");
$.each(["href","load","cache"],function(i,_ce1){
_cdf.removeData(_ce1+".tabs");
});
});
this.lis.unbind(".tabs").add(this.panels).each(function(){
if($.data(this,"destroy.tabs")){
$(this).remove();
}else{
$(this).removeClass(["ui-state-default","ui-corner-top","ui-tabs-selected","ui-state-active","ui-state-hover","ui-state-focus","ui-state-disabled","ui-tabs-panel","ui-widget-content","ui-corner-bottom","ui-tabs-hide"].join(" "));
}
});
if(o.cookie){
this._cookie(null,o.cookie);
}
return this;
},add:function(url,_ce3,_ce4){
if(_ce4===_ca7){
_ce4=this.anchors.length;
}
var self=this,o=this.options,$li=$(o.tabTemplate.replace(/#\{href\}/g,url).replace(/#\{label\}/g,_ce3)),id=!url.indexOf("#")?url.replace("#",""):this._tabId($("a",$li)[0]);
$li.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);
var _ce9=self.element.find("#"+id);
if(!_ce9.length){
_ce9=$(o.panelTemplate).attr("id",id).data("destroy.tabs",true);
}
_ce9.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");
if(_ce4>=this.lis.length){
$li.appendTo(this.list);
_ce9.appendTo(this.list[0].parentNode);
}else{
$li.insertBefore(this.lis[_ce4]);
_ce9.insertBefore(this.panels[_ce4]);
}
o.disabled=$.map(o.disabled,function(n,i){
return n>=_ce4?++n:n;
});
this._tabify();
if(this.anchors.length==1){
o.selected=0;
$li.addClass("ui-tabs-selected ui-state-active");
_ce9.removeClass("ui-tabs-hide");
this.element.queue("tabs",function(){
self._trigger("show",null,self._ui(self.anchors[0],self.panels[0]));
});
this.load(0);
}
this._trigger("add",null,this._ui(this.anchors[_ce4],this.panels[_ce4]));
return this;
},remove:function(_cec){
_cec=this._getIndex(_cec);
var o=this.options,$li=this.lis.eq(_cec).remove(),_cef=this.panels.eq(_cec).remove();
if($li.hasClass("ui-tabs-selected")&&this.anchors.length>1){
this.select(_cec+(_cec+1<this.anchors.length?1:-1));
}
o.disabled=$.map($.grep(o.disabled,function(n,i){
return n!=_cec;
}),function(n,i){
return n>=_cec?--n:n;
});
this._tabify();
this._trigger("remove",null,this._ui($li.find("a")[0],_cef[0]));
return this;
},enable:function(_cf4){
_cf4=this._getIndex(_cf4);
var o=this.options;
if($.inArray(_cf4,o.disabled)==-1){
return;
}
this.lis.eq(_cf4).removeClass("ui-state-disabled");
o.disabled=$.grep(o.disabled,function(n,i){
return n!=_cf4;
});
this._trigger("enable",null,this._ui(this.anchors[_cf4],this.panels[_cf4]));
return this;
},disable:function(_cf8){
_cf8=this._getIndex(_cf8);
var self=this,o=this.options;
if(_cf8!=o.selected){
this.lis.eq(_cf8).addClass("ui-state-disabled");
o.disabled.push(_cf8);
o.disabled.sort();
this._trigger("disable",null,this._ui(this.anchors[_cf8],this.panels[_cf8]));
}
return this;
},select:function(_cfb){
_cfb=this._getIndex(_cfb);
if(_cfb==-1){
if(this.options.collapsible&&this.options.selected!=-1){
_cfb=this.options.selected;
}else{
return this;
}
}
this.anchors.eq(_cfb).trigger(this.options.event+".tabs");
return this;
},load:function(_cfc){
_cfc=this._getIndex(_cfc);
var self=this,o=this.options,a=this.anchors.eq(_cfc)[0],url=$.data(a,"load.tabs");
this.abort();
if(!url||this.element.queue("tabs").length!==0&&$.data(a,"cache.tabs")){
this.element.dequeue("tabs");
return;
}
this.lis.eq(_cfc).addClass("ui-state-processing");
if(o.spinner){
var span=$("span",a);
span.data("label.tabs",span.html()).html(o.spinner);
}
this.xhr=$.ajax($.extend({},o.ajaxOptions,{url:url,success:function(r,s){
self.element.find(self._sanitizeSelector(a.hash)).html(r);
self._cleanup();
if(o.cache){
$.data(a,"cache.tabs",true);
}
self._trigger("load",null,self._ui(self.anchors[_cfc],self.panels[_cfc]));
try{
o.ajaxOptions.success(r,s);
}
catch(e){
}
},error:function(xhr,s,e){
self._cleanup();
self._trigger("load",null,self._ui(self.anchors[_cfc],self.panels[_cfc]));
try{
o.ajaxOptions.error(xhr,s,_cfc,a);
}
catch(e){
}
}}));
self.element.dequeue("tabs");
return this;
},abort:function(){
this.element.queue([]);
this.panels.stop(false,true);
this.element.queue("tabs",this.element.queue("tabs").splice(-2,2));
if(this.xhr){
this.xhr.abort();
delete this.xhr;
}
this._cleanup();
return this;
},url:function(_d07,url){
this.anchors.eq(_d07).removeData("cache.tabs").data("load.tabs",url);
return this;
},length:function(){
return this.anchors.length;
}});
$.extend($.ui.tabs,{version:"1.8.11"});
$.extend($.ui.tabs.prototype,{rotation:null,rotate:function(ms,_d0a){
var self=this,o=this.options;
var _d0d=self._rotate||(self._rotate=function(e){
clearTimeout(self.rotation);
self.rotation=setTimeout(function(){
var t=o.selected;
self.select(++t<self.anchors.length?t:0);
},ms);
if(e){
e.stopPropagation();
}
});
var stop=self._unrotate||(self._unrotate=!_d0a?function(e){
if(e.clientX){
self.rotate(null);
}
}:function(e){
t=o.selected;
_d0d();
});
if(ms){
this.element.bind("tabsshow",_d0d);
this.anchors.bind(o.event+".tabs",stop);
_d0d();
}else{
clearTimeout(self.rotation);
this.element.unbind("tabsshow",_d0d);
this.anchors.unbind(o.event+".tabs",stop);
delete this._rotate;
delete this._unrotate;
}
return this;
}});
})(jQuery);
(function($,_d14){
$.extend($.ui,{datepicker:{version:"1.8.11"}});
var _d15="datepicker";
var _d16=new Date().getTime();
function Datepicker(){
this.debug=false;
this._curInst=null;
this._keyEvent=false;
this._disabledInputs=[];
this._datepickerShowing=false;
this._inDialog=false;
this._mainDivId="ui-datepicker-div";
this._inlineClass="ui-datepicker-inline";
this._appendClass="ui-datepicker-append";
this._triggerClass="ui-datepicker-trigger";
this._dialogClass="ui-datepicker-dialog";
this._disableClass="ui-datepicker-disabled";
this._unselectableClass="ui-datepicker-unselectable";
this._currentClass="ui-datepicker-current-day";
this._dayOverClass="ui-datepicker-days-cell-over";
this.regional=[];
this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};
this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false};
$.extend(this._defaults,this.regional[""]);
this.dpDiv=$("<div id=\""+this._mainDivId+"\" class=\"ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all\"></div>");
}
$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",log:function(){
if(this.debug){
console.log.apply("",arguments);
}
},_widgetDatepicker:function(){
return this.dpDiv;
},setDefaults:function(_d17){
extendRemove(this._defaults,_d17||{});
return this;
},_attachDatepicker:function(_d18,_d19){
var _d1a=null;
for(var _d1b in this._defaults){
var _d1c=_d18.getAttribute("date:"+_d1b);
if(_d1c){
_d1a=_d1a||{};
try{
_d1a[_d1b]=eval(_d1c);
}
catch(err){
_d1a[_d1b]=_d1c;
}
}
}
var _d1d=_d18.nodeName.toLowerCase();
var _d1e=(_d1d=="div"||_d1d=="span");
if(!_d18.id){
this.uuid+=1;
_d18.id="dp"+this.uuid;
}
var inst=this._newInst($(_d18),_d1e);
inst.settings=$.extend({},_d19||{},_d1a||{});
if(_d1d=="input"){
this._connectDatepicker(_d18,inst);
}else{
if(_d1e){
this._inlineDatepicker(_d18,inst);
}
}
},_newInst:function(_d20,_d21){
var id=_d20[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");
return {id:id,input:_d20,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:_d21,dpDiv:(!_d21?this.dpDiv:$("<div class=\""+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all\"></div>"))};
},_connectDatepicker:function(_d23,inst){
var _d25=$(_d23);
inst.append=$([]);
inst.trigger=$([]);
if(_d25.hasClass(this.markerClassName)){
return;
}
this._attachments(_d25,inst);
_d25.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(_d26,key,_d28){
inst.settings[key]=_d28;
}).bind("getData.datepicker",function(_d29,key){
return this._get(inst,key);
});
this._autoSize(inst);
$.data(_d23,_d15,inst);
},_attachments:function(_d2b,inst){
var _d2d=this._get(inst,"appendText");
var _d2e=this._get(inst,"isRTL");
if(inst.append){
inst.append.remove();
}
if(_d2d){
inst.append=$("<span class=\""+this._appendClass+"\">"+_d2d+"</span>");
_d2b[_d2e?"before":"after"](inst.append);
}
_d2b.unbind("focus",this._showDatepicker);
if(inst.trigger){
inst.trigger.remove();
}
var _d2f=this._get(inst,"showOn");
if(_d2f=="focus"||_d2f=="both"){
_d2b.focus(this._showDatepicker);
}
if(_d2f=="button"||_d2f=="both"){
var _d30=this._get(inst,"buttonText");
var _d31=this._get(inst,"buttonImage");
inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:_d31,alt:_d30,title:_d30}):$("<button type=\"button\"></button>").addClass(this._triggerClass).html(_d31==""?_d30:$("<img/>").attr({src:_d31,alt:_d30,title:_d30})));
_d2b[_d2e?"before":"after"](inst.trigger);
inst.trigger.click(function(){
if($.datepicker._datepickerShowing&&$.datepicker._lastInput==_d2b[0]){
$.datepicker._hideDatepicker();
}else{
$.datepicker._showDatepicker(_d2b[0]);
}
return false;
});
}
},_autoSize:function(inst){
if(this._get(inst,"autoSize")&&!inst.inline){
var date=new Date(2009,12-1,20);
var _d34=this._get(inst,"dateFormat");
if(_d34.match(/[DM]/)){
var _d35=function(_d36){
var max=0;
var maxI=0;
for(var i=0;i<_d36.length;i++){
if(_d36[i].length>max){
max=_d36[i].length;
maxI=i;
}
}
return maxI;
};
date.setMonth(_d35(this._get(inst,(_d34.match(/MM/)?"monthNames":"monthNamesShort"))));
date.setDate(_d35(this._get(inst,(_d34.match(/DD/)?"dayNames":"dayNamesShort")))+20-date.getDay());
}
inst.input.attr("size",this._formatDate(inst,date).length);
}
},_inlineDatepicker:function(_d3a,inst){
var _d3c=$(_d3a);
if(_d3c.hasClass(this.markerClassName)){
return;
}
_d3c.addClass(this.markerClassName).append(inst.dpDiv).bind("setData.datepicker",function(_d3d,key,_d3f){
inst.settings[key]=_d3f;
}).bind("getData.datepicker",function(_d40,key){
return this._get(inst,key);
});
$.data(_d3a,_d15,inst);
this._setDate(inst,this._getDefaultDate(inst),true);
this._updateDatepicker(inst);
this._updateAlternate(inst);
inst.dpDiv.show();
},_dialogDatepicker:function(_d42,date,_d44,_d45,pos){
var inst=this._dialogInst;
if(!inst){
this.uuid+=1;
var id="dp"+this.uuid;
this._dialogInput=$("<input type=\"text\" id=\""+id+"\" style=\"position: absolute; top: -100px; width: 0px; z-index: -10;\"/>");
this._dialogInput.keydown(this._doKeyDown);
$("body").append(this._dialogInput);
inst=this._dialogInst=this._newInst(this._dialogInput,false);
inst.settings={};
$.data(this._dialogInput[0],_d15,inst);
}
extendRemove(inst.settings,_d45||{});
date=(date&&date.constructor==Date?this._formatDate(inst,date):date);
this._dialogInput.val(date);
this._pos=(pos?(pos.length?pos:[pos.pageX,pos.pageY]):null);
if(!this._pos){
var _d49=document.documentElement.clientWidth;
var _d4a=document.documentElement.clientHeight;
var _d4b=document.documentElement.scrollLeft||document.body.scrollLeft;
var _d4c=document.documentElement.scrollTop||document.body.scrollTop;
this._pos=[(_d49/2)-100+_d4b,(_d4a/2)-150+_d4c];
}
this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");
inst.settings.onSelect=_d44;
this._inDialog=true;
this.dpDiv.addClass(this._dialogClass);
this._showDatepicker(this._dialogInput[0]);
if($.blockUI){
$.blockUI(this.dpDiv);
}
$.data(this._dialogInput[0],_d15,inst);
return this;
},_destroyDatepicker:function(_d4d){
var _d4e=$(_d4d);
var inst=$.data(_d4d,_d15);
if(!_d4e.hasClass(this.markerClassName)){
return;
}
var _d50=_d4d.nodeName.toLowerCase();
$.removeData(_d4d,_d15);
if(_d50=="input"){
inst.append.remove();
inst.trigger.remove();
_d4e.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp);
}else{
if(_d50=="div"||_d50=="span"){
_d4e.removeClass(this.markerClassName).empty();
}
}
},_enableDatepicker:function(_d51){
var _d52=$(_d51);
var inst=$.data(_d51,_d15);
if(!_d52.hasClass(this.markerClassName)){
return;
}
var _d54=_d51.nodeName.toLowerCase();
if(_d54=="input"){
_d51.disabled=false;
inst.trigger.filter("button").each(function(){
this.disabled=false;
}).end().filter("img").css({opacity:"1.0",cursor:""});
}else{
if(_d54=="div"||_d54=="span"){
var _d55=_d52.children("."+this._inlineClass);
_d55.children().removeClass("ui-state-disabled");
}
}
this._disabledInputs=$.map(this._disabledInputs,function(_d56){
return (_d56==_d51?null:_d56);
});
},_disableDatepicker:function(_d57){
var _d58=$(_d57);
var inst=$.data(_d57,_d15);
if(!_d58.hasClass(this.markerClassName)){
return;
}
var _d5a=_d57.nodeName.toLowerCase();
if(_d5a=="input"){
_d57.disabled=true;
inst.trigger.filter("button").each(function(){
this.disabled=true;
}).end().filter("img").css({opacity:"0.5",cursor:"default"});
}else{
if(_d5a=="div"||_d5a=="span"){
var _d5b=_d58.children("."+this._inlineClass);
_d5b.children().addClass("ui-state-disabled");
}
}
this._disabledInputs=$.map(this._disabledInputs,function(_d5c){
return (_d5c==_d57?null:_d5c);
});
this._disabledInputs[this._disabledInputs.length]=_d57;
},_isDisabledDatepicker:function(_d5d){
if(!_d5d){
return false;
}
for(var i=0;i<this._disabledInputs.length;i++){
if(this._disabledInputs[i]==_d5d){
return true;
}
}
return false;
},_getInst:function(_d5f){
try{
return $.data(_d5f,_d15);
}
catch(err){
throw "Missing instance data for this datepicker";
}
},_optionDatepicker:function(_d60,name,_d62){
var inst=this._getInst(_d60);
if(arguments.length==2&&typeof name=="string"){
return (name=="defaults"?$.extend({},$.datepicker._defaults):(inst?(name=="all"?$.extend({},inst.settings):this._get(inst,name)):null));
}
var _d64=name||{};
if(typeof name=="string"){
_d64={};
_d64[name]=_d62;
}
if(inst){
if(this._curInst==inst){
this._hideDatepicker();
}
var date=this._getDateDatepicker(_d60,true);
var _d66=this._getMinMaxDate(inst,"min");
var _d67=this._getMinMaxDate(inst,"max");
extendRemove(inst.settings,_d64);
if(_d66!==null&&_d64["dateFormat"]!==_d14&&_d64["minDate"]===_d14){
inst.settings.minDate=this._formatDate(inst,_d66);
}
if(_d67!==null&&_d64["dateFormat"]!==_d14&&_d64["maxDate"]===_d14){
inst.settings.maxDate=this._formatDate(inst,_d67);
}
this._attachments($(_d60),inst);
this._autoSize(inst);
this._setDateDatepicker(_d60,date);
this._updateDatepicker(inst);
}
},_changeDatepicker:function(_d68,name,_d6a){
this._optionDatepicker(_d68,name,_d6a);
},_refreshDatepicker:function(_d6b){
var inst=this._getInst(_d6b);
if(inst){
this._updateDatepicker(inst);
}
},_setDateDatepicker:function(_d6d,date){
var inst=this._getInst(_d6d);
if(inst){
this._setDate(inst,date);
this._updateDatepicker(inst);
this._updateAlternate(inst);
}
},_getDateDatepicker:function(_d70,_d71){
var inst=this._getInst(_d70);
if(inst&&!inst.inline){
this._setDateFromField(inst,_d71);
}
return (inst?this._getDate(inst):null);
},_doKeyDown:function(_d73){
var inst=$.datepicker._getInst(_d73.target);
var _d75=true;
var _d76=inst.dpDiv.is(".ui-datepicker-rtl");
inst._keyEvent=true;
if($.datepicker._datepickerShowing){
switch(_d73.keyCode){
case 9:
$.datepicker._hideDatepicker();
_d75=false;
break;
case 13:
var sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv);
if(sel[0]){
$.datepicker._selectDay(_d73.target,inst.selectedMonth,inst.selectedYear,sel[0]);
}else{
$.datepicker._hideDatepicker();
}
return false;
break;
case 27:
$.datepicker._hideDatepicker();
break;
case 33:
$.datepicker._adjustDate(_d73.target,(_d73.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");
break;
case 34:
$.datepicker._adjustDate(_d73.target,(_d73.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");
break;
case 35:
if(_d73.ctrlKey||_d73.metaKey){
$.datepicker._clearDate(_d73.target);
}
_d75=_d73.ctrlKey||_d73.metaKey;
break;
case 36:
if(_d73.ctrlKey||_d73.metaKey){
$.datepicker._gotoToday(_d73.target);
}
_d75=_d73.ctrlKey||_d73.metaKey;
break;
case 37:
if(_d73.ctrlKey||_d73.metaKey){
$.datepicker._adjustDate(_d73.target,(_d76?+1:-1),"D");
}
_d75=_d73.ctrlKey||_d73.metaKey;
if(_d73.originalEvent.altKey){
$.datepicker._adjustDate(_d73.target,(_d73.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");
}
break;
case 38:
if(_d73.ctrlKey||_d73.metaKey){
$.datepicker._adjustDate(_d73.target,-7,"D");
}
_d75=_d73.ctrlKey||_d73.metaKey;
break;
case 39:
if(_d73.ctrlKey||_d73.metaKey){
$.datepicker._adjustDate(_d73.target,(_d76?-1:+1),"D");
}
_d75=_d73.ctrlKey||_d73.metaKey;
if(_d73.originalEvent.altKey){
$.datepicker._adjustDate(_d73.target,(_d73.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");
}
break;
case 40:
if(_d73.ctrlKey||_d73.metaKey){
$.datepicker._adjustDate(_d73.target,+7,"D");
}
_d75=_d73.ctrlKey||_d73.metaKey;
break;
default:
_d75=false;
}
}else{
if(_d73.keyCode==36&&_d73.ctrlKey){
$.datepicker._showDatepicker(this);
}else{
_d75=false;
}
}
if(_d75){
_d73.preventDefault();
_d73.stopPropagation();
}
},_doKeyPress:function(_d78){
var inst=$.datepicker._getInst(_d78.target);
if($.datepicker._get(inst,"constrainInput")){
var _d7a=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));
var chr=String.fromCharCode(_d78.charCode==_d14?_d78.keyCode:_d78.charCode);
return _d78.ctrlKey||_d78.metaKey||(chr<" "||!_d7a||_d7a.indexOf(chr)>-1);
}
},_doKeyUp:function(_d7c){
var inst=$.datepicker._getInst(_d7c.target);
if(inst.input.val()!=inst.lastVal){
try{
var date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),(inst.input?inst.input.val():null),$.datepicker._getFormatConfig(inst));
if(date){
$.datepicker._setDateFromField(inst);
$.datepicker._updateAlternate(inst);
$.datepicker._updateDatepicker(inst);
}
}
catch(_d7c){
$.datepicker.log(_d7c);
}
}
return true;
},_showDatepicker:function(_d7f){
_d7f=_d7f.target||_d7f;
if(_d7f.nodeName.toLowerCase()!="input"){
_d7f=$("input",_d7f.parentNode)[0];
}
if($.datepicker._isDisabledDatepicker(_d7f)||$.datepicker._lastInput==_d7f){
return;
}
var inst=$.datepicker._getInst(_d7f);
if($.datepicker._curInst&&$.datepicker._curInst!=inst){
$.datepicker._curInst.dpDiv.stop(true,true);
}
var _d81=$.datepicker._get(inst,"beforeShow");
extendRemove(inst.settings,(_d81?_d81.apply(_d7f,[_d7f,inst]):{}));
inst.lastVal=null;
$.datepicker._lastInput=_d7f;
$.datepicker._setDateFromField(inst);
if($.datepicker._inDialog){
_d7f.value="";
}
if(!$.datepicker._pos){
$.datepicker._pos=$.datepicker._findPos(_d7f);
$.datepicker._pos[1]+=_d7f.offsetHeight;
}
var _d82=false;
$(_d7f).parents().each(function(){
_d82|=$(this).css("position")=="fixed";
return !_d82;
});
if(_d82&&$.browser.opera){
$.datepicker._pos[0]-=document.documentElement.scrollLeft;
$.datepicker._pos[1]-=document.documentElement.scrollTop;
}
var _d83={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};
$.datepicker._pos=null;
inst.dpDiv.empty();
inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});
$.datepicker._updateDatepicker(inst);
_d83=$.datepicker._checkOffset(inst,_d83,_d82);
inst.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(_d82?"fixed":"absolute")),display:"none",left:_d83.left+"px",top:_d83.top+"px"});
if(!inst.inline){
var _d84=$.datepicker._get(inst,"showAnim");
var _d85=$.datepicker._get(inst,"duration");
var _d86=function(){
$.datepicker._datepickerShowing=true;
var _d87=inst.dpDiv.find("iframe.ui-datepicker-cover");
if(!!_d87.length){
var _d88=$.datepicker._getBorders(inst.dpDiv);
_d87.css({left:-_d88[0],top:-_d88[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()});
}
};
inst.dpDiv.zIndex($(_d7f).zIndex()+1);
if($.effects&&$.effects[_d84]){
inst.dpDiv.show(_d84,$.datepicker._get(inst,"showOptions"),_d85,_d86);
}else{
inst.dpDiv[_d84||"show"]((_d84?_d85:null),_d86);
}
if(!_d84||!_d85){
_d86();
}
if(inst.input.is(":visible")&&!inst.input.is(":disabled")){
inst.input.focus();
}
$.datepicker._curInst=inst;
}
},_updateDatepicker:function(inst){
var self=this;
var _d8b=$.datepicker._getBorders(inst.dpDiv);
inst.dpDiv.empty().append(this._generateHTML(inst));
var _d8c=inst.dpDiv.find("iframe.ui-datepicker-cover");
if(!!_d8c.length){
_d8c.css({left:-_d8b[0],top:-_d8b[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()});
}
inst.dpDiv.find("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a").bind("mouseout",function(){
$(this).removeClass("ui-state-hover");
if(this.className.indexOf("ui-datepicker-prev")!=-1){
$(this).removeClass("ui-datepicker-prev-hover");
}
if(this.className.indexOf("ui-datepicker-next")!=-1){
$(this).removeClass("ui-datepicker-next-hover");
}
}).bind("mouseover",function(){
if(!self._isDisabledDatepicker(inst.inline?inst.dpDiv.parent()[0]:inst.input[0])){
$(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");
$(this).addClass("ui-state-hover");
if(this.className.indexOf("ui-datepicker-prev")!=-1){
$(this).addClass("ui-datepicker-prev-hover");
}
if(this.className.indexOf("ui-datepicker-next")!=-1){
$(this).addClass("ui-datepicker-next-hover");
}
}
}).end().find("."+this._dayOverClass+" a").trigger("mouseover").end();
var _d8d=this._getNumberOfMonths(inst);
var cols=_d8d[1];
var _d8f=17;
if(cols>1){
inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",(_d8f*cols)+"em");
}else{
inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");
}
inst.dpDiv[(_d8d[0]!=1||_d8d[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");
inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");
if(inst==$.datepicker._curInst&&$.datepicker._datepickerShowing&&inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&inst.input[0]!=document.activeElement){
inst.input.focus();
}
if(inst.yearshtml){
var _d90=inst.yearshtml;
setTimeout(function(){
if(_d90===inst.yearshtml){
inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml);
}
_d90=inst.yearshtml=null;
},0);
}
},_getBorders:function(elem){
var _d92=function(_d93){
return {thin:1,medium:2,thick:3}[_d93]||_d93;
};
return [parseFloat(_d92(elem.css("border-left-width"))),parseFloat(_d92(elem.css("border-top-width")))];
},_checkOffset:function(inst,_d95,_d96){
var _d97=inst.dpDiv.outerWidth();
var _d98=inst.dpDiv.outerHeight();
var _d99=inst.input?inst.input.outerWidth():0;
var _d9a=inst.input?inst.input.outerHeight():0;
var _d9b=document.documentElement.clientWidth+$(document).scrollLeft();
var _d9c=document.documentElement.clientHeight+$(document).scrollTop();
_d95.left-=(this._get(inst,"isRTL")?(_d97-_d99):0);
_d95.left-=(_d96&&_d95.left==inst.input.offset().left)?$(document).scrollLeft():0;
_d95.top-=(_d96&&_d95.top==(inst.input.offset().top+_d9a))?$(document).scrollTop():0;
_d95.left-=Math.min(_d95.left,(_d95.left+_d97>_d9b&&_d9b>_d97)?Math.abs(_d95.left+_d97-_d9b):0);
_d95.top-=Math.min(_d95.top,(_d95.top+_d98>_d9c&&_d9c>_d98)?Math.abs(_d98+_d9a):0);
return _d95;
},_findPos:function(obj){
var inst=this._getInst(obj);
var _d9f=this._get(inst,"isRTL");
while(obj&&(obj.type=="hidden"||obj.nodeType!=1||$.expr.filters.hidden(obj))){
obj=obj[_d9f?"previousSibling":"nextSibling"];
}
var _da0=$(obj).offset();
return [_da0.left,_da0.top];
},_hideDatepicker:function(_da1){
var inst=this._curInst;
if(!inst||(_da1&&inst!=$.data(_da1,_d15))){
return;
}
if(this._datepickerShowing){
var _da3=this._get(inst,"showAnim");
var _da4=this._get(inst,"duration");
var _da5=function(){
$.datepicker._tidyDialog(inst);
this._curInst=null;
};
if($.effects&&$.effects[_da3]){
inst.dpDiv.hide(_da3,$.datepicker._get(inst,"showOptions"),_da4,_da5);
}else{
inst.dpDiv[(_da3=="slideDown"?"slideUp":(_da3=="fadeIn"?"fadeOut":"hide"))]((_da3?_da4:null),_da5);
}
if(!_da3){
_da5();
}
var _da6=this._get(inst,"onClose");
if(_da6){
_da6.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():""),inst]);
}
this._datepickerShowing=false;
this._lastInput=null;
if(this._inDialog){
this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});
if($.blockUI){
$.unblockUI();
$("body").append(this.dpDiv);
}
}
this._inDialog=false;
}
},_tidyDialog:function(inst){
inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar");
},_checkExternalClick:function(_da8){
if(!$.datepicker._curInst){
return;
}
var _da9=$(_da8.target);
if(_da9[0].id!=$.datepicker._mainDivId&&_da9.parents("#"+$.datepicker._mainDivId).length==0&&!_da9.hasClass($.datepicker.markerClassName)&&!_da9.hasClass($.datepicker._triggerClass)&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)){
$.datepicker._hideDatepicker();
}
},_adjustDate:function(id,_dab,_dac){
var _dad=$(id);
var inst=this._getInst(_dad[0]);
if(this._isDisabledDatepicker(_dad[0])){
return;
}
this._adjustInstDate(inst,_dab+(_dac=="M"?this._get(inst,"showCurrentAtPos"):0),_dac);
this._updateDatepicker(inst);
},_gotoToday:function(id){
var _db0=$(id);
var inst=this._getInst(_db0[0]);
if(this._get(inst,"gotoCurrent")&&inst.currentDay){
inst.selectedDay=inst.currentDay;
inst.drawMonth=inst.selectedMonth=inst.currentMonth;
inst.drawYear=inst.selectedYear=inst.currentYear;
}else{
var date=new Date();
inst.selectedDay=date.getDate();
inst.drawMonth=inst.selectedMonth=date.getMonth();
inst.drawYear=inst.selectedYear=date.getFullYear();
}
this._notifyChange(inst);
this._adjustDate(_db0);
},_selectMonthYear:function(id,_db4,_db5){
var _db6=$(id);
var inst=this._getInst(_db6[0]);
inst._selectingMonthYear=false;
inst["selected"+(_db5=="M"?"Month":"Year")]=inst["draw"+(_db5=="M"?"Month":"Year")]=parseInt(_db4.options[_db4.selectedIndex].value,10);
this._notifyChange(inst);
this._adjustDate(_db6);
},_clickMonthYear:function(id){
var _db9=$(id);
var inst=this._getInst(_db9[0]);
if(inst.input&&inst._selectingMonthYear){
setTimeout(function(){
inst.input.focus();
},0);
}
inst._selectingMonthYear=!inst._selectingMonthYear;
},_selectDay:function(id,_dbc,year,td){
var _dbf=$(id);
if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(_dbf[0])){
return;
}
var inst=this._getInst(_dbf[0]);
inst.selectedDay=inst.currentDay=$("a",td).html();
inst.selectedMonth=inst.currentMonth=_dbc;
inst.selectedYear=inst.currentYear=year;
this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear));
},_clearDate:function(id){
var _dc2=$(id);
var inst=this._getInst(_dc2[0]);
this._selectDate(_dc2,"");
},_selectDate:function(id,_dc5){
var _dc6=$(id);
var inst=this._getInst(_dc6[0]);
_dc5=(_dc5!=null?_dc5:this._formatDate(inst));
if(inst.input){
inst.input.val(_dc5);
}
this._updateAlternate(inst);
var _dc8=this._get(inst,"onSelect");
if(_dc8){
_dc8.apply((inst.input?inst.input[0]:null),[_dc5,inst]);
}else{
if(inst.input){
inst.input.trigger("change");
}
}
if(inst.inline){
this._updateDatepicker(inst);
}else{
this._hideDatepicker();
this._lastInput=inst.input[0];
if(typeof (inst.input[0])!="object"){
inst.input.focus();
}
this._lastInput=null;
}
},_updateAlternate:function(inst){
var _dca=this._get(inst,"altField");
if(_dca){
var _dcb=this._get(inst,"altFormat")||this._get(inst,"dateFormat");
var date=this._getDate(inst);
var _dcd=this.formatDate(_dcb,date,this._getFormatConfig(inst));
$(_dca).each(function(){
$(this).val(_dcd);
});
}
},noWeekends:function(date){
var day=date.getDay();
return [(day>0&&day<6),""];
},iso8601Week:function(date){
var _dd1=new Date(date.getTime());
_dd1.setDate(_dd1.getDate()+4-(_dd1.getDay()||7));
var time=_dd1.getTime();
_dd1.setMonth(0);
_dd1.setDate(1);
return Math.floor(Math.round((time-_dd1)/86400000)/7)+1;
},parseDate:function(_dd3,_dd4,_dd5){
if(_dd3==null||_dd4==null){
throw "Invalid arguments";
}
_dd4=(typeof _dd4=="object"?_dd4.toString():_dd4+"");
if(_dd4==""){
return null;
}
var _dd6=(_dd5?_dd5.shortYearCutoff:null)||this._defaults.shortYearCutoff;
_dd6=(typeof _dd6!="string"?_dd6:new Date().getFullYear()%100+parseInt(_dd6,10));
var _dd7=(_dd5?_dd5.dayNamesShort:null)||this._defaults.dayNamesShort;
var _dd8=(_dd5?_dd5.dayNames:null)||this._defaults.dayNames;
var _dd9=(_dd5?_dd5.monthNamesShort:null)||this._defaults.monthNamesShort;
var _dda=(_dd5?_dd5.monthNames:null)||this._defaults.monthNames;
var year=-1;
var _ddc=-1;
var day=-1;
var doy=-1;
var _ddf=false;
var _de0=function(_de1){
var _de2=(_de3+1<_dd3.length&&_dd3.charAt(_de3+1)==_de1);
if(_de2){
_de3++;
}
return _de2;
};
var _de4=function(_de5){
var _de6=_de0(_de5);
var size=(_de5=="@"?14:(_de5=="!"?20:(_de5=="y"&&_de6?4:(_de5=="o"?3:2))));
var _de8=new RegExp("^\\d{1,"+size+"}");
var num=_dd4.substring(_dea).match(_de8);
if(!num){
throw "Missing number at position "+_dea;
}
_dea+=num[0].length;
return parseInt(num[0],10);
};
var _deb=function(_dec,_ded,_dee){
var _def=(_de0(_dec)?_dee:_ded);
for(var i=0;i<_def.length;i++){
if(_dd4.substr(_dea,_def[i].length).toLowerCase()==_def[i].toLowerCase()){
_dea+=_def[i].length;
return i+1;
}
}
throw "Unknown name at position "+_dea;
};
var _df1=function(){
if(_dd4.charAt(_dea)!=_dd3.charAt(_de3)){
throw "Unexpected literal at position "+_dea;
}
_dea++;
};
var _dea=0;
for(var _de3=0;_de3<_dd3.length;_de3++){
if(_ddf){
if(_dd3.charAt(_de3)=="'"&&!_de0("'")){
_ddf=false;
}else{
_df1();
}
}else{
switch(_dd3.charAt(_de3)){
case "d":
day=_de4("d");
break;
case "D":
_deb("D",_dd7,_dd8);
break;
case "o":
doy=_de4("o");
break;
case "m":
_ddc=_de4("m");
break;
case "M":
_ddc=_deb("M",_dd9,_dda);
break;
case "y":
year=_de4("y");
break;
case "@":
var date=new Date(_de4("@"));
year=date.getFullYear();
_ddc=date.getMonth()+1;
day=date.getDate();
break;
case "!":
var date=new Date((_de4("!")-this._ticksTo1970)/10000);
year=date.getFullYear();
_ddc=date.getMonth()+1;
day=date.getDate();
break;
case "'":
if(_de0("'")){
_df1();
}else{
_ddf=true;
}
break;
default:
_df1();
}
}
}
if(year==-1){
year=new Date().getFullYear();
}else{
if(year<100){
year+=new Date().getFullYear()-new Date().getFullYear()%100+(year<=_dd6?0:-100);
}
}
if(doy>-1){
_ddc=1;
day=doy;
do{
var dim=this._getDaysInMonth(year,_ddc-1);
if(day<=dim){
break;
}
_ddc++;
day-=dim;
}while(true);
}
var date=this._daylightSavingAdjust(new Date(year,_ddc-1,day));
if(date.getFullYear()!=year||date.getMonth()+1!=_ddc||date.getDate()!=day){
throw "Invalid date";
}
return date;
},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(_df4,date,_df6){
if(!date){
return "";
}
var _df7=(_df6?_df6.dayNamesShort:null)||this._defaults.dayNamesShort;
var _df8=(_df6?_df6.dayNames:null)||this._defaults.dayNames;
var _df9=(_df6?_df6.monthNamesShort:null)||this._defaults.monthNamesShort;
var _dfa=(_df6?_df6.monthNames:null)||this._defaults.monthNames;
var _dfb=function(_dfc){
var _dfd=(_dfe+1<_df4.length&&_df4.charAt(_dfe+1)==_dfc);
if(_dfd){
_dfe++;
}
return _dfd;
};
var _dff=function(_e00,_e01,len){
var num=""+_e01;
if(_dfb(_e00)){
while(num.length<len){
num="0"+num;
}
}
return num;
};
var _e04=function(_e05,_e06,_e07,_e08){
return (_dfb(_e05)?_e08[_e06]:_e07[_e06]);
};
var _e09="";
var _e0a=false;
if(date){
for(var _dfe=0;_dfe<_df4.length;_dfe++){
if(_e0a){
if(_df4.charAt(_dfe)=="'"&&!_dfb("'")){
_e0a=false;
}else{
_e09+=_df4.charAt(_dfe);
}
}else{
switch(_df4.charAt(_dfe)){
case "d":
_e09+=_dff("d",date.getDate(),2);
break;
case "D":
_e09+=_e04("D",date.getDay(),_df7,_df8);
break;
case "o":
_e09+=_dff("o",(date.getTime()-new Date(date.getFullYear(),0,0).getTime())/86400000,3);
break;
case "m":
_e09+=_dff("m",date.getMonth()+1,2);
break;
case "M":
_e09+=_e04("M",date.getMonth(),_df9,_dfa);
break;
case "y":
_e09+=(_dfb("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100);
break;
case "@":
_e09+=date.getTime();
break;
case "!":
_e09+=date.getTime()*10000+this._ticksTo1970;
break;
case "'":
if(_dfb("'")){
_e09+="'";
}else{
_e0a=true;
}
break;
default:
_e09+=_df4.charAt(_dfe);
}
}
}
}
return _e09;
},_possibleChars:function(_e0b){
var _e0c="";
var _e0d=false;
var _e0e=function(_e0f){
var _e10=(_e11+1<_e0b.length&&_e0b.charAt(_e11+1)==_e0f);
if(_e10){
_e11++;
}
return _e10;
};
for(var _e11=0;_e11<_e0b.length;_e11++){
if(_e0d){
if(_e0b.charAt(_e11)=="'"&&!_e0e("'")){
_e0d=false;
}else{
_e0c+=_e0b.charAt(_e11);
}
}else{
switch(_e0b.charAt(_e11)){
case "d":
case "m":
case "y":
case "@":
_e0c+="0123456789";
break;
case "D":
case "M":
return null;
case "'":
if(_e0e("'")){
_e0c+="'";
}else{
_e0d=true;
}
break;
default:
_e0c+=_e0b.charAt(_e11);
}
}
}
return _e0c;
},_get:function(inst,name){
return inst.settings[name]!==_d14?inst.settings[name]:this._defaults[name];
},_setDateFromField:function(inst,_e15){
if(inst.input.val()==inst.lastVal){
return;
}
var _e16=this._get(inst,"dateFormat");
var _e17=inst.lastVal=inst.input?inst.input.val():null;
var date,_e19;
date=_e19=this._getDefaultDate(inst);
var _e1a=this._getFormatConfig(inst);
try{
date=this.parseDate(_e16,_e17,_e1a)||_e19;
}
catch(event){
this.log(event);
_e17=(_e15?"":_e17);
}
inst.selectedDay=date.getDate();
inst.drawMonth=inst.selectedMonth=date.getMonth();
inst.drawYear=inst.selectedYear=date.getFullYear();
inst.currentDay=(_e17?date.getDate():0);
inst.currentMonth=(_e17?date.getMonth():0);
inst.currentYear=(_e17?date.getFullYear():0);
this._adjustInstDate(inst);
},_getDefaultDate:function(inst){
return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date()));
},_determineDate:function(inst,date,_e1e){
var _e1f=function(_e20){
var date=new Date();
date.setDate(date.getDate()+_e20);
return date;
};
var _e22=function(_e23){
try{
return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),_e23,$.datepicker._getFormatConfig(inst));
}
catch(e){
}
var date=(_e23.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date();
var year=date.getFullYear();
var _e26=date.getMonth();
var day=date.getDate();
var _e28=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g;
var _e29=_e28.exec(_e23);
while(_e29){
switch(_e29[2]||"d"){
case "d":
case "D":
day+=parseInt(_e29[1],10);
break;
case "w":
case "W":
day+=parseInt(_e29[1],10)*7;
break;
case "m":
case "M":
_e26+=parseInt(_e29[1],10);
day=Math.min(day,$.datepicker._getDaysInMonth(year,_e26));
break;
case "y":
case "Y":
year+=parseInt(_e29[1],10);
day=Math.min(day,$.datepicker._getDaysInMonth(year,_e26));
break;
}
_e29=_e28.exec(_e23);
}
return new Date(year,_e26,day);
};
var _e2a=(date==null||date===""?_e1e:(typeof date=="string"?_e22(date):(typeof date=="number"?(isNaN(date)?_e1e:_e1f(date)):new Date(date.getTime()))));
_e2a=(_e2a&&_e2a.toString()=="Invalid Date"?_e1e:_e2a);
if(_e2a){
_e2a.setHours(0);
_e2a.setMinutes(0);
_e2a.setSeconds(0);
_e2a.setMilliseconds(0);
}
return this._daylightSavingAdjust(_e2a);
},_daylightSavingAdjust:function(date){
if(!date){
return null;
}
date.setHours(date.getHours()>12?date.getHours()+2:0);
return date;
},_setDate:function(inst,date,_e2e){
var _e2f=!date;
var _e30=inst.selectedMonth;
var _e31=inst.selectedYear;
var _e32=this._restrictMinMax(inst,this._determineDate(inst,date,new Date()));
inst.selectedDay=inst.currentDay=_e32.getDate();
inst.drawMonth=inst.selectedMonth=inst.currentMonth=_e32.getMonth();
inst.drawYear=inst.selectedYear=inst.currentYear=_e32.getFullYear();
if((_e30!=inst.selectedMonth||_e31!=inst.selectedYear)&&!_e2e){
this._notifyChange(inst);
}
this._adjustInstDate(inst);
if(inst.input){
inst.input.val(_e2f?"":this._formatDate(inst));
}
},_getDate:function(inst){
var _e34=(!inst.currentYear||(inst.input&&inst.input.val()=="")?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));
return _e34;
},_generateHTML:function(inst){
var _e36=new Date();
_e36=this._daylightSavingAdjust(new Date(_e36.getFullYear(),_e36.getMonth(),_e36.getDate()));
var _e37=this._get(inst,"isRTL");
var _e38=this._get(inst,"showButtonPanel");
var _e39=this._get(inst,"hideIfNoPrevNext");
var _e3a=this._get(inst,"navigationAsDateFormat");
var _e3b=this._getNumberOfMonths(inst);
var _e3c=this._get(inst,"showCurrentAtPos");
var _e3d=this._get(inst,"stepMonths");
var _e3e=(_e3b[0]!=1||_e3b[1]!=1);
var _e3f=this._daylightSavingAdjust((!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));
var _e40=this._getMinMaxDate(inst,"min");
var _e41=this._getMinMaxDate(inst,"max");
var _e42=inst.drawMonth-_e3c;
var _e43=inst.drawYear;
if(_e42<0){
_e42+=12;
_e43--;
}
if(_e41){
var _e44=this._daylightSavingAdjust(new Date(_e41.getFullYear(),_e41.getMonth()-(_e3b[0]*_e3b[1])+1,_e41.getDate()));
_e44=(_e40&&_e44<_e40?_e40:_e44);
while(this._daylightSavingAdjust(new Date(_e43,_e42,1))>_e44){
_e42--;
if(_e42<0){
_e42=11;
_e43--;
}
}
}
inst.drawMonth=_e42;
inst.drawYear=_e43;
var _e45=this._get(inst,"prevText");
_e45=(!_e3a?_e45:this.formatDate(_e45,this._daylightSavingAdjust(new Date(_e43,_e42-_e3d,1)),this._getFormatConfig(inst)));
var prev=(this._canAdjustMonth(inst,-1,_e43,_e42)?"<a class=\"ui-datepicker-prev ui-corner-all\" onclick=\"DP_jQuery_"+_d16+".datepicker._adjustDate('#"+inst.id+"', -"+_e3d+", 'M');\""+" title=\""+_e45+"\"><span class=\"ui-icon ui-icon-circle-triangle-"+(_e37?"e":"w")+"\">"+_e45+"</span></a>":(_e39?"":"<a class=\"ui-datepicker-prev ui-corner-all ui-state-disabled\" title=\""+_e45+"\"><span class=\"ui-icon ui-icon-circle-triangle-"+(_e37?"e":"w")+"\">"+_e45+"</span></a>"));
var _e47=this._get(inst,"nextText");
_e47=(!_e3a?_e47:this.formatDate(_e47,this._daylightSavingAdjust(new Date(_e43,_e42+_e3d,1)),this._getFormatConfig(inst)));
var next=(this._canAdjustMonth(inst,+1,_e43,_e42)?"<a class=\"ui-datepicker-next ui-corner-all\" onclick=\"DP_jQuery_"+_d16+".datepicker._adjustDate('#"+inst.id+"', +"+_e3d+", 'M');\""+" title=\""+_e47+"\"><span class=\"ui-icon ui-icon-circle-triangle-"+(_e37?"w":"e")+"\">"+_e47+"</span></a>":(_e39?"":"<a class=\"ui-datepicker-next ui-corner-all ui-state-disabled\" title=\""+_e47+"\"><span class=\"ui-icon ui-icon-circle-triangle-"+(_e37?"w":"e")+"\">"+_e47+"</span></a>"));
var _e49=this._get(inst,"currentText");
var _e4a=(this._get(inst,"gotoCurrent")&&inst.currentDay?_e3f:_e36);
_e49=(!_e3a?_e49:this.formatDate(_e49,_e4a,this._getFormatConfig(inst)));
var _e4b=(!inst.inline?"<button type=\"button\" class=\"ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all\" onclick=\"DP_jQuery_"+_d16+".datepicker._hideDatepicker();\">"+this._get(inst,"closeText")+"</button>":"");
var _e4c=(_e38)?"<div class=\"ui-datepicker-buttonpane ui-widget-content\">"+(_e37?_e4b:"")+(this._isInRange(inst,_e4a)?"<button type=\"button\" class=\"ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all\" onclick=\"DP_jQuery_"+_d16+".datepicker._gotoToday('#"+inst.id+"');\""+">"+_e49+"</button>":"")+(_e37?"":_e4b)+"</div>":"";
var _e4d=parseInt(this._get(inst,"firstDay"),10);
_e4d=(isNaN(_e4d)?0:_e4d);
var _e4e=this._get(inst,"showWeek");
var _e4f=this._get(inst,"dayNames");
var _e50=this._get(inst,"dayNamesShort");
var _e51=this._get(inst,"dayNamesMin");
var _e52=this._get(inst,"monthNames");
var _e53=this._get(inst,"monthNamesShort");
var _e54=this._get(inst,"beforeShowDay");
var _e55=this._get(inst,"showOtherMonths");
var _e56=this._get(inst,"selectOtherMonths");
var _e57=this._get(inst,"calculateWeek")||this.iso8601Week;
var _e58=this._getDefaultDate(inst);
var html="";
for(var row=0;row<_e3b[0];row++){
var _e5b="";
for(var col=0;col<_e3b[1];col++){
var _e5d=this._daylightSavingAdjust(new Date(_e43,_e42,inst.selectedDay));
var _e5e=" ui-corner-all";
var _e5f="";
if(_e3e){
_e5f+="<div class=\"ui-datepicker-group";
if(_e3b[1]>1){
switch(col){
case 0:
_e5f+=" ui-datepicker-group-first";
_e5e=" ui-corner-"+(_e37?"right":"left");
break;
case _e3b[1]-1:
_e5f+=" ui-datepicker-group-last";
_e5e=" ui-corner-"+(_e37?"left":"right");
break;
default:
_e5f+=" ui-datepicker-group-middle";
_e5e="";
break;
}
}
_e5f+="\">";
}
_e5f+="<div class=\"ui-datepicker-header ui-widget-header ui-helper-clearfix"+_e5e+"\">"+(/all|left/.test(_e5e)&&row==0?(_e37?next:prev):"")+(/all|right/.test(_e5e)&&row==0?(_e37?prev:next):"")+this._generateMonthYearHeader(inst,_e42,_e43,_e40,_e41,row>0||col>0,_e52,_e53)+"</div><table class=\"ui-datepicker-calendar\"><thead>"+"<tr>";
var _e60=(_e4e?"<th class=\"ui-datepicker-week-col\">"+this._get(inst,"weekHeader")+"</th>":"");
for(var dow=0;dow<7;dow++){
var day=(dow+_e4d)%7;
_e60+="<th"+((dow+_e4d+6)%7>=5?" class=\"ui-datepicker-week-end\"":"")+">"+"<span title=\""+_e4f[day]+"\">"+_e51[day]+"</span></th>";
}
_e5f+=_e60+"</tr></thead><tbody>";
var _e63=this._getDaysInMonth(_e43,_e42);
if(_e43==inst.selectedYear&&_e42==inst.selectedMonth){
inst.selectedDay=Math.min(inst.selectedDay,_e63);
}
var _e64=(this._getFirstDayOfMonth(_e43,_e42)-_e4d+7)%7;
var _e65=(_e3e?6:Math.ceil((_e64+_e63)/7));
var _e66=this._daylightSavingAdjust(new Date(_e43,_e42,1-_e64));
for(var dRow=0;dRow<_e65;dRow++){
_e5f+="<tr>";
var _e68=(!_e4e?"":"<td class=\"ui-datepicker-week-col\">"+this._get(inst,"calculateWeek")(_e66)+"</td>");
for(var dow=0;dow<7;dow++){
var _e69=(_e54?_e54.apply((inst.input?inst.input[0]:null),[_e66]):[true,""]);
var _e6a=(_e66.getMonth()!=_e42);
var _e6b=(_e6a&&!_e56)||!_e69[0]||(_e40&&_e66<_e40)||(_e41&&_e66>_e41);
_e68+="<td class=\""+((dow+_e4d+6)%7>=5?" ui-datepicker-week-end":"")+(_e6a?" ui-datepicker-other-month":"")+((_e66.getTime()==_e5d.getTime()&&_e42==inst.selectedMonth&&inst._keyEvent)||(_e58.getTime()==_e66.getTime()&&_e58.getTime()==_e5d.getTime())?" "+this._dayOverClass:"")+(_e6b?" "+this._unselectableClass+" ui-state-disabled":"")+(_e6a&&!_e55?"":" "+_e69[1]+(_e66.getTime()==_e3f.getTime()?" "+this._currentClass:"")+(_e66.getTime()==_e36.getTime()?" ui-datepicker-today":""))+"\""+((!_e6a||_e55)&&_e69[2]?" title=\""+_e69[2]+"\"":"")+(_e6b?"":" onclick=\"DP_jQuery_"+_d16+".datepicker._selectDay('#"+inst.id+"',"+_e66.getMonth()+","+_e66.getFullYear()+", this);return false;\"")+">"+(_e6a&&!_e55?"&#xa0;":(_e6b?"<span class=\"ui-state-default\">"+_e66.getDate()+"</span>":"<a class=\"ui-state-default"+(_e66.getTime()==_e36.getTime()?" ui-state-highlight":"")+(_e66.getTime()==_e3f.getTime()?" ui-state-active":"")+(_e6a?" ui-priority-secondary":"")+"\" href=\"#\">"+_e66.getDate()+"</a>"))+"</td>";
_e66.setDate(_e66.getDate()+1);
_e66=this._daylightSavingAdjust(_e66);
}
_e5f+=_e68+"</tr>";
}
_e42++;
if(_e42>11){
_e42=0;
_e43++;
}
_e5f+="</tbody></table>"+(_e3e?"</div>"+((_e3b[0]>0&&col==_e3b[1]-1)?"<div class=\"ui-datepicker-row-break\"></div>":""):"");
_e5b+=_e5f;
}
html+=_e5b;
}
html+=_e4c+($.browser.msie&&parseInt($.browser.version,10)<7&&!inst.inline?"<iframe src=\"javascript:false;\" class=\"ui-datepicker-cover\" frameborder=\"0\"></iframe>":"");
inst._keyEvent=false;
return html;
},_generateMonthYearHeader:function(inst,_e6d,_e6e,_e6f,_e70,_e71,_e72,_e73){
var _e74=this._get(inst,"changeMonth");
var _e75=this._get(inst,"changeYear");
var _e76=this._get(inst,"showMonthAfterYear");
var html="<div class=\"ui-datepicker-title\">";
var _e78="";
if(_e71||!_e74){
_e78+="<span class=\"ui-datepicker-month\">"+_e72[_e6d]+"</span>";
}else{
var _e79=(_e6f&&_e6f.getFullYear()==_e6e);
var _e7a=(_e70&&_e70.getFullYear()==_e6e);
_e78+="<select class=\"ui-datepicker-month\" "+"onchange=\"DP_jQuery_"+_d16+".datepicker._selectMonthYear('#"+inst.id+"', this, 'M');\" "+"onclick=\"DP_jQuery_"+_d16+".datepicker._clickMonthYear('#"+inst.id+"');\""+">";
for(var _e7b=0;_e7b<12;_e7b++){
if((!_e79||_e7b>=_e6f.getMonth())&&(!_e7a||_e7b<=_e70.getMonth())){
_e78+="<option value=\""+_e7b+"\""+(_e7b==_e6d?" selected=\"selected\"":"")+">"+_e73[_e7b]+"</option>";
}
}
_e78+="</select>";
}
if(!_e76){
html+=_e78+(_e71||!(_e74&&_e75)?"&#xa0;":"");
}
inst.yearshtml="";
if(_e71||!_e75){
html+="<span class=\"ui-datepicker-year\">"+_e6e+"</span>";
}else{
var _e7c=this._get(inst,"yearRange").split(":");
var _e7d=new Date().getFullYear();
var _e7e=function(_e7f){
var year=(_e7f.match(/c[+-].*/)?_e6e+parseInt(_e7f.substring(1),10):(_e7f.match(/[+-].*/)?_e7d+parseInt(_e7f,10):parseInt(_e7f,10)));
return (isNaN(year)?_e7d:year);
};
var year=_e7e(_e7c[0]);
var _e82=Math.max(year,_e7e(_e7c[1]||""));
year=(_e6f?Math.max(year,_e6f.getFullYear()):year);
_e82=(_e70?Math.min(_e82,_e70.getFullYear()):_e82);
inst.yearshtml+="<select class=\"ui-datepicker-year\" "+"onchange=\"DP_jQuery_"+_d16+".datepicker._selectMonthYear('#"+inst.id+"', this, 'Y');\" "+"onclick=\"DP_jQuery_"+_d16+".datepicker._clickMonthYear('#"+inst.id+"');\""+">";
for(;year<=_e82;year++){
inst.yearshtml+="<option value=\""+year+"\""+(year==_e6e?" selected=\"selected\"":"")+">"+year+"</option>";
}
inst.yearshtml+="</select>";
if(!$.browser.mozilla){
html+=inst.yearshtml;
inst.yearshtml=null;
}else{
html+="<select class=\"ui-datepicker-year\"><option value=\""+_e6e+"\" selected=\"selected\">"+_e6e+"</option></select>";
}
}
html+=this._get(inst,"yearSuffix");
if(_e76){
html+=(_e71||!(_e74&&_e75)?"&#xa0;":"")+_e78;
}
html+="</div>";
return html;
},_adjustInstDate:function(inst,_e84,_e85){
var year=inst.drawYear+(_e85=="Y"?_e84:0);
var _e87=inst.drawMonth+(_e85=="M"?_e84:0);
var day=Math.min(inst.selectedDay,this._getDaysInMonth(year,_e87))+(_e85=="D"?_e84:0);
var date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,_e87,day)));
inst.selectedDay=date.getDate();
inst.drawMonth=inst.selectedMonth=date.getMonth();
inst.drawYear=inst.selectedYear=date.getFullYear();
if(_e85=="M"||_e85=="Y"){
this._notifyChange(inst);
}
},_restrictMinMax:function(inst,date){
var _e8c=this._getMinMaxDate(inst,"min");
var _e8d=this._getMinMaxDate(inst,"max");
var _e8e=(_e8c&&date<_e8c?_e8c:date);
_e8e=(_e8d&&_e8e>_e8d?_e8d:_e8e);
return _e8e;
},_notifyChange:function(inst){
var _e90=this._get(inst,"onChangeMonthYear");
if(_e90){
_e90.apply((inst.input?inst.input[0]:null),[inst.selectedYear,inst.selectedMonth+1,inst]);
}
},_getNumberOfMonths:function(inst){
var _e92=this._get(inst,"numberOfMonths");
return (_e92==null?[1,1]:(typeof _e92=="number"?[1,_e92]:_e92));
},_getMinMaxDate:function(inst,_e94){
return this._determineDate(inst,this._get(inst,_e94+"Date"),null);
},_getDaysInMonth:function(year,_e96){
return 32-this._daylightSavingAdjust(new Date(year,_e96,32)).getDate();
},_getFirstDayOfMonth:function(year,_e98){
return new Date(year,_e98,1).getDay();
},_canAdjustMonth:function(inst,_e9a,_e9b,_e9c){
var _e9d=this._getNumberOfMonths(inst);
var date=this._daylightSavingAdjust(new Date(_e9b,_e9c+(_e9a<0?_e9a:_e9d[0]*_e9d[1]),1));
if(_e9a<0){
date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()));
}
return this._isInRange(inst,date);
},_isInRange:function(inst,date){
var _ea1=this._getMinMaxDate(inst,"min");
var _ea2=this._getMinMaxDate(inst,"max");
return ((!_ea1||date.getTime()>=_ea1.getTime())&&(!_ea2||date.getTime()<=_ea2.getTime()));
},_getFormatConfig:function(inst){
var _ea4=this._get(inst,"shortYearCutoff");
_ea4=(typeof _ea4!="string"?_ea4:new Date().getFullYear()%100+parseInt(_ea4,10));
return {shortYearCutoff:_ea4,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")};
},_formatDate:function(inst,day,_ea7,year){
if(!day){
inst.currentDay=inst.selectedDay;
inst.currentMonth=inst.selectedMonth;
inst.currentYear=inst.selectedYear;
}
var date=(day?(typeof day=="object"?day:this._daylightSavingAdjust(new Date(year,_ea7,day))):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));
return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst));
}});
function extendRemove(_eaa,_eab){
$.extend(_eaa,_eab);
for(var name in _eab){
if(_eab[name]==null||_eab[name]==_d14){
_eaa[name]=_eab[name];
}
}
return _eaa;
}
function isArray(a){
return (a&&(($.browser.safari&&typeof a=="object"&&a.length)||(a.constructor&&a.constructor.toString().match(/\Array\(\)/))));
}
$.fn.datepicker=function(_eae){
if(!this.length){
return this;
}
if(!$.datepicker.initialized){
$(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv);
$.datepicker.initialized=true;
}
var _eaf=Array.prototype.slice.call(arguments,1);
if(typeof _eae=="string"&&(_eae=="isDisabled"||_eae=="getDate"||_eae=="widget")){
return $.datepicker["_"+_eae+"Datepicker"].apply($.datepicker,[this[0]].concat(_eaf));
}
if(_eae=="option"&&arguments.length==2&&typeof arguments[1]=="string"){
return $.datepicker["_"+_eae+"Datepicker"].apply($.datepicker,[this[0]].concat(_eaf));
}
return this.each(function(){
typeof _eae=="string"?$.datepicker["_"+_eae+"Datepicker"].apply($.datepicker,[this].concat(_eaf)):$.datepicker._attachDatepicker(this,_eae);
});
};
$.datepicker=new Datepicker();
$.datepicker.initialized=false;
$.datepicker.uuid=new Date().getTime();
$.datepicker.version="1.8.11";
window["DP_jQuery_"+_d16]=$;
})(jQuery);
(function($,_eb1){
$.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){
this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});
this.valueDiv=$("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);
this.oldValue=this._value();
this._refreshValue();
},destroy:function(){
this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");
this.valueDiv.remove();
$.Widget.prototype.destroy.apply(this,arguments);
},value:function(_eb2){
if(_eb2===_eb1){
return this._value();
}
this._setOption("value",_eb2);
return this;
},_setOption:function(key,_eb4){
if(key==="value"){
this.options.value=_eb4;
this._refreshValue();
if(this._value()===this.options.max){
this._trigger("complete");
}
}
$.Widget.prototype._setOption.apply(this,arguments);
},_value:function(){
var val=this.options.value;
if(typeof val!=="number"){
val=0;
}
return Math.min(this.options.max,Math.max(this.min,val));
},_percentage:function(){
return 100*this._value()/this.options.max;
},_refreshValue:function(){
var _eb6=this.value();
var _eb7=this._percentage();
if(this.oldValue!==_eb6){
this.oldValue=_eb6;
this._trigger("change");
}
this.valueDiv.toggleClass("ui-corner-right",_eb6===this.options.max).width(_eb7.toFixed(0)+"%");
this.element.attr("aria-valuenow",_eb6);
}});
$.extend($.ui.progressbar,{version:"1.8.11"});
})(jQuery);
jQuery.effects||(function($,_eb9){
$.effects={};
$.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(i,attr){
$.fx.step[attr]=function(fx){
if(!fx.colorInit){
fx.start=getColor(fx.elem,attr);
fx.end=getRGB(fx.end);
fx.colorInit=true;
}
fx.elem.style[attr]="rgb("+Math.max(Math.min(parseInt((fx.pos*(fx.end[0]-fx.start[0]))+fx.start[0],10),255),0)+","+Math.max(Math.min(parseInt((fx.pos*(fx.end[1]-fx.start[1]))+fx.start[1],10),255),0)+","+Math.max(Math.min(parseInt((fx.pos*(fx.end[2]-fx.start[2]))+fx.start[2],10),255),0)+")";
};
});
function getRGB(_ebd){
var _ebe;
if(_ebd&&_ebd.constructor==Array&&_ebd.length==3){
return _ebd;
}
if(_ebe=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(_ebd)){
return [parseInt(_ebe[1],10),parseInt(_ebe[2],10),parseInt(_ebe[3],10)];
}
if(_ebe=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(_ebd)){
return [parseFloat(_ebe[1])*2.55,parseFloat(_ebe[2])*2.55,parseFloat(_ebe[3])*2.55];
}
if(_ebe=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(_ebd)){
return [parseInt(_ebe[1],16),parseInt(_ebe[2],16),parseInt(_ebe[3],16)];
}
if(_ebe=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(_ebd)){
return [parseInt(_ebe[1]+_ebe[1],16),parseInt(_ebe[2]+_ebe[2],16),parseInt(_ebe[3]+_ebe[3],16)];
}
if(_ebe=/rgba\(0, 0, 0, 0\)/.exec(_ebd)){
return _ebf["transparent"];
}
return _ebf[$.trim(_ebd).toLowerCase()];
}
function getColor(elem,attr){
var _ec2;
do{
_ec2=$.curCSS(elem,attr);
if(_ec2!=""&&_ec2!="transparent"||$.nodeName(elem,"body")){
break;
}
attr="backgroundColor";
}while(elem=elem.parentNode);
return getRGB(_ec2);
}
var _ebf={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]};
var _ec3=["add","remove","toggle"],_ec4={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};
function getElementStyles(){
var _ec5=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,_ec6={},key,_ec8;
if(_ec5&&_ec5.length&&_ec5[0]&&_ec5[_ec5[0]]){
var len=_ec5.length;
while(len--){
key=_ec5[len];
if(typeof _ec5[key]=="string"){
_ec8=key.replace(/\-(\w)/g,function(all,_ecb){
return _ecb.toUpperCase();
});
_ec6[_ec8]=_ec5[key];
}
}
}else{
for(key in _ec5){
if(typeof _ec5[key]==="string"){
_ec6[key]=_ec5[key];
}
}
}
return _ec6;
}
function filterStyles(_ecc){
var name,_ece;
for(name in _ecc){
_ece=_ecc[name];
if(_ece==null||$.isFunction(_ece)||name in _ec4||(/scrollbar/).test(name)||(!(/color/i).test(name)&&isNaN(parseFloat(_ece)))){
delete _ecc[name];
}
}
return _ecc;
}
function styleDifference(_ecf,_ed0){
var diff={_:0},name;
for(name in _ed0){
if(_ecf[name]!=_ed0[name]){
diff[name]=_ed0[name];
}
}
return diff;
}
$.effects.animateClass=function(_ed3,_ed4,_ed5,_ed6){
if($.isFunction(_ed5)){
_ed6=_ed5;
_ed5=null;
}
return this.queue("fx",function(){
var that=$(this),_ed8=that.attr("style")||" ",_ed9=filterStyles(getElementStyles.call(this)),_eda,_edb=that.attr("className");
$.each(_ec3,function(i,_edd){
if(_ed3[_edd]){
that[_edd+"Class"](_ed3[_edd]);
}
});
_eda=filterStyles(getElementStyles.call(this));
that.attr("className",_edb);
that.animate(styleDifference(_ed9,_eda),_ed4,_ed5,function(){
$.each(_ec3,function(i,_edf){
if(_ed3[_edf]){
that[_edf+"Class"](_ed3[_edf]);
}
});
if(typeof that.attr("style")=="object"){
that.attr("style").cssText="";
that.attr("style").cssText=_ed8;
}else{
that.attr("style",_ed8);
}
if(_ed6){
_ed6.apply(this,arguments);
}
});
var _ee0=$.queue(this),anim=_ee0.splice(_ee0.length-1,1)[0];
_ee0.splice(1,0,anim);
$.dequeue(this);
});
};
$.fn.extend({_addClass:$.fn.addClass,addClass:function(_ee2,_ee3,_ee4,_ee5){
return _ee3?$.effects.animateClass.apply(this,[{add:_ee2},_ee3,_ee4,_ee5]):this._addClass(_ee2);
},_removeClass:$.fn.removeClass,removeClass:function(_ee6,_ee7,_ee8,_ee9){
return _ee7?$.effects.animateClass.apply(this,[{remove:_ee6},_ee7,_ee8,_ee9]):this._removeClass(_ee6);
},_toggleClass:$.fn.toggleClass,toggleClass:function(_eea,_eeb,_eec,_eed,_eee){
if(typeof _eeb=="boolean"||_eeb===_eb9){
if(!_eec){
return this._toggleClass(_eea,_eeb);
}else{
return $.effects.animateClass.apply(this,[(_eeb?{add:_eea}:{remove:_eea}),_eec,_eed,_eee]);
}
}else{
return $.effects.animateClass.apply(this,[{toggle:_eea},_eeb,_eec,_eed]);
}
},switchClass:function(_eef,add,_ef1,_ef2,_ef3){
return $.effects.animateClass.apply(this,[{add:add,remove:_eef},_ef1,_ef2,_ef3]);
}});
$.extend($.effects,{version:"1.8.11",save:function(_ef4,set){
for(var i=0;i<set.length;i++){
if(set[i]!==null){
_ef4.data("ec.storage."+set[i],_ef4[0].style[set[i]]);
}
}
},restore:function(_ef7,set){
for(var i=0;i<set.length;i++){
if(set[i]!==null){
_ef7.css(set[i],_ef7.data("ec.storage."+set[i]));
}
}
},setMode:function(el,mode){
if(mode=="toggle"){
mode=el.is(":hidden")?"show":"hide";
}
return mode;
},getBaseline:function(_efc,_efd){
var y,x;
switch(_efc[0]){
case "top":
y=0;
break;
case "middle":
y=0.5;
break;
case "bottom":
y=1;
break;
default:
y=_efc[0]/_efd.height;
}
switch(_efc[1]){
case "left":
x=0;
break;
case "center":
x=0.5;
break;
case "right":
x=1;
break;
default:
x=_efc[1]/_efd.width;
}
return {x:x,y:y};
},createWrapper:function(_f00){
if(_f00.parent().is(".ui-effects-wrapper")){
return _f00.parent();
}
var _f01={width:_f00.outerWidth(true),height:_f00.outerHeight(true),"float":_f00.css("float")},_f02=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0});
_f00.wrap(_f02);
_f02=_f00.parent();
if(_f00.css("position")=="static"){
_f02.css({position:"relative"});
_f00.css({position:"relative"});
}else{
$.extend(_f01,{position:_f00.css("position"),zIndex:_f00.css("z-index")});
$.each(["top","left","bottom","right"],function(i,pos){
_f01[pos]=_f00.css(pos);
if(isNaN(parseInt(_f01[pos],10))){
_f01[pos]="auto";
}
});
_f00.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"});
}
return _f02.css(_f01).show();
},removeWrapper:function(_f05){
if(_f05.parent().is(".ui-effects-wrapper")){
return _f05.parent().replaceWith(_f05);
}
return _f05;
},setTransition:function(_f06,list,_f08,_f09){
_f09=_f09||{};
$.each(list,function(i,x){
unit=_f06.cssUnit(x);
if(unit[0]>0){
_f09[x]=unit[0]*_f08+unit[1];
}
});
return _f09;
}});
function _normalizeArguments(_f0c,_f0d,_f0e,_f0f){
if(typeof _f0c=="object"){
_f0f=_f0d;
_f0e=null;
_f0d=_f0c;
_f0c=_f0d.effect;
}
if($.isFunction(_f0d)){
_f0f=_f0d;
_f0e=null;
_f0d={};
}
if(typeof _f0d=="number"||$.fx.speeds[_f0d]){
_f0f=_f0e;
_f0e=_f0d;
_f0d={};
}
if($.isFunction(_f0e)){
_f0f=_f0e;
_f0e=null;
}
_f0d=_f0d||{};
_f0e=_f0e||_f0d.duration;
_f0e=$.fx.off?0:typeof _f0e=="number"?_f0e:_f0e in $.fx.speeds?$.fx.speeds[_f0e]:$.fx.speeds._default;
_f0f=_f0f||_f0d.complete;
return [_f0c,_f0d,_f0e,_f0f];
}
function standardSpeed(_f10){
if(!_f10||typeof _f10==="number"||$.fx.speeds[_f10]){
return true;
}
if(typeof _f10==="string"&&!$.effects[_f10]){
return true;
}
return false;
}
$.fn.extend({effect:function(_f11,_f12,_f13,_f14){
var args=_normalizeArguments.apply(this,arguments),_f16={options:args[1],duration:args[2],callback:args[3]},mode=_f16.options.mode,_f18=$.effects[_f11];
if($.fx.off||!_f18){
if(mode){
return this[mode](_f16.duration,_f16.callback);
}else{
return this.each(function(){
if(_f16.callback){
_f16.callback.call(this);
}
});
}
}
return _f18.call(this,_f16);
},_show:$.fn.show,show:function(_f19){
if(standardSpeed(_f19)){
return this._show.apply(this,arguments);
}else{
var args=_normalizeArguments.apply(this,arguments);
args[1].mode="show";
return this.effect.apply(this,args);
}
},_hide:$.fn.hide,hide:function(_f1b){
if(standardSpeed(_f1b)){
return this._hide.apply(this,arguments);
}else{
var args=_normalizeArguments.apply(this,arguments);
args[1].mode="hide";
return this.effect.apply(this,args);
}
},__toggle:$.fn.toggle,toggle:function(_f1d){
if(standardSpeed(_f1d)||typeof _f1d==="boolean"||$.isFunction(_f1d)){
return this.__toggle.apply(this,arguments);
}else{
var args=_normalizeArguments.apply(this,arguments);
args[1].mode="toggle";
return this.effect.apply(this,args);
}
},cssUnit:function(key){
var _f20=this.css(key),val=[];
$.each(["em","px","%","pt"],function(i,unit){
if(_f20.indexOf(unit)>0){
val=[parseFloat(_f20),unit];
}
});
return val;
}});
$.easing.jswing=$.easing.swing;
$.extend($.easing,{def:"easeOutQuad",swing:function(x,t,b,c,d){
return $.easing[$.easing.def](x,t,b,c,d);
},easeInQuad:function(x,t,b,c,d){
return c*(t/=d)*t+b;
},easeOutQuad:function(x,t,b,c,d){
return -c*(t/=d)*(t-2)+b;
},easeInOutQuad:function(x,t,b,c,d){
if((t/=d/2)<1){
return c/2*t*t+b;
}
return -c/2*((--t)*(t-2)-1)+b;
},easeInCubic:function(x,t,b,c,d){
return c*(t/=d)*t*t+b;
},easeOutCubic:function(x,t,b,c,d){
return c*((t=t/d-1)*t*t+1)+b;
},easeInOutCubic:function(x,t,b,c,d){
if((t/=d/2)<1){
return c/2*t*t*t+b;
}
return c/2*((t-=2)*t*t+2)+b;
},easeInQuart:function(x,t,b,c,d){
return c*(t/=d)*t*t*t+b;
},easeOutQuart:function(x,t,b,c,d){
return -c*((t=t/d-1)*t*t*t-1)+b;
},easeInOutQuart:function(x,t,b,c,d){
if((t/=d/2)<1){
return c/2*t*t*t*t+b;
}
return -c/2*((t-=2)*t*t*t-2)+b;
},easeInQuint:function(x,t,b,c,d){
return c*(t/=d)*t*t*t*t+b;
},easeOutQuint:function(x,t,b,c,d){
return c*((t=t/d-1)*t*t*t*t+1)+b;
},easeInOutQuint:function(x,t,b,c,d){
if((t/=d/2)<1){
return c/2*t*t*t*t*t+b;
}
return c/2*((t-=2)*t*t*t*t+2)+b;
},easeInSine:function(x,t,b,c,d){
return -c*Math.cos(t/d*(Math.PI/2))+c+b;
},easeOutSine:function(x,t,b,c,d){
return c*Math.sin(t/d*(Math.PI/2))+b;
},easeInOutSine:function(x,t,b,c,d){
return -c/2*(Math.cos(Math.PI*t/d)-1)+b;
},easeInExpo:function(x,t,b,c,d){
return (t==0)?b:c*Math.pow(2,10*(t/d-1))+b;
},easeOutExpo:function(x,t,b,c,d){
return (t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b;
},easeInOutExpo:function(x,t,b,c,d){
if(t==0){
return b;
}
if(t==d){
return b+c;
}
if((t/=d/2)<1){
return c/2*Math.pow(2,10*(t-1))+b;
}
return c/2*(-Math.pow(2,-10*--t)+2)+b;
},easeInCirc:function(x,t,b,c,d){
return -c*(Math.sqrt(1-(t/=d)*t)-1)+b;
},easeOutCirc:function(x,t,b,c,d){
return c*Math.sqrt(1-(t=t/d-1)*t)+b;
},easeInOutCirc:function(x,t,b,c,d){
if((t/=d/2)<1){
return -c/2*(Math.sqrt(1-t*t)-1)+b;
}
return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b;
},easeInElastic:function(x,t,b,c,d){
var s=1.70158;
var p=0;
var a=c;
if(t==0){
return b;
}
if((t/=d)==1){
return b+c;
}
if(!p){
p=d*0.3;
}
if(a<Math.abs(c)){
a=c;
var s=p/4;
}else{
var s=p/(2*Math.PI)*Math.asin(c/a);
}
return -(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;
},easeOutElastic:function(x,t,b,c,d){
var s=1.70158;
var p=0;
var a=c;
if(t==0){
return b;
}
if((t/=d)==1){
return b+c;
}
if(!p){
p=d*0.3;
}
if(a<Math.abs(c)){
a=c;
var s=p/4;
}else{
var s=p/(2*Math.PI)*Math.asin(c/a);
}
return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b;
},easeInOutElastic:function(x,t,b,c,d){
var s=1.70158;
var p=0;
var a=c;
if(t==0){
return b;
}
if((t/=d/2)==2){
return b+c;
}
if(!p){
p=d*(0.3*1.5);
}
if(a<Math.abs(c)){
a=c;
var s=p/4;
}else{
var s=p/(2*Math.PI)*Math.asin(c/a);
}
if(t<1){
return -0.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;
}
return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*0.5+c+b;
},easeInBack:function(x,t,b,c,d,s){
if(s==_eb9){
s=1.70158;
}
return c*(t/=d)*t*((s+1)*t-s)+b;
},easeOutBack:function(x,t,b,c,d,s){
if(s==_eb9){
s=1.70158;
}
return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b;
},easeInOutBack:function(x,t,b,c,d,s){
if(s==_eb9){
s=1.70158;
}
if((t/=d/2)<1){
return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b;
}
return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b;
},easeInBounce:function(x,t,b,c,d){
return c-$.easing.easeOutBounce(x,d-t,0,c,d)+b;
},easeOutBounce:function(x,t,b,c,d){
if((t/=d)<(1/2.75)){
return c*(7.5625*t*t)+b;
}else{
if(t<(2/2.75)){
return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b;
}else{
if(t<(2.5/2.75)){
return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b;
}else{
return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b;
}
}
}
},easeInOutBounce:function(x,t,b,c,d){
if(t<d/2){
return $.easing.easeInBounce(x,t*2,0,c,d)*0.5+b;
}
return $.easing.easeOutBounce(x,t*2-d,0,c,d)*0.5+c*0.5+b;
}});
})(jQuery);
(function($,_fcc){
$.effects.blind=function(o){
return this.queue(function(){
var el=$(this),_fcf=["position","top","bottom","left","right"];
var mode=$.effects.setMode(el,o.options.mode||"hide");
var _fd1=o.options.direction||"vertical";
$.effects.save(el,_fcf);
el.show();
var _fd2=$.effects.createWrapper(el).css({overflow:"hidden"});
var ref=(_fd1=="vertical")?"height":"width";
var _fd4=(_fd1=="vertical")?_fd2.height():_fd2.width();
if(mode=="show"){
_fd2.css(ref,0);
}
var _fd5={};
_fd5[ref]=mode=="show"?_fd4:0;
_fd2.animate(_fd5,o.duration,o.options.easing,function(){
if(mode=="hide"){
el.hide();
}
$.effects.restore(el,_fcf);
$.effects.removeWrapper(el);
if(o.callback){
o.callback.apply(el[0],arguments);
}
el.dequeue();
});
});
};
})(jQuery);
(function($,_fd7){
$.effects.bounce=function(o){
return this.queue(function(){
var el=$(this),_fda=["position","top","bottom","left","right"];
var mode=$.effects.setMode(el,o.options.mode||"effect");
var _fdc=o.options.direction||"up";
var _fdd=o.options.distance||20;
var _fde=o.options.times||5;
var _fdf=o.duration||250;
if(/show|hide/.test(mode)){
_fda.push("opacity");
}
$.effects.save(el,_fda);
el.show();
$.effects.createWrapper(el);
var ref=(_fdc=="up"||_fdc=="down")?"top":"left";
var _fe1=(_fdc=="up"||_fdc=="left")?"pos":"neg";
var _fdd=o.options.distance||(ref=="top"?el.outerHeight({margin:true})/3:el.outerWidth({margin:true})/3);
if(mode=="show"){
el.css("opacity",0).css(ref,_fe1=="pos"?-_fdd:_fdd);
}
if(mode=="hide"){
_fdd=_fdd/(_fde*2);
}
if(mode!="hide"){
_fde--;
}
if(mode=="show"){
var _fe2={opacity:1};
_fe2[ref]=(_fe1=="pos"?"+=":"-=")+_fdd;
el.animate(_fe2,_fdf/2,o.options.easing);
_fdd=_fdd/2;
_fde--;
}
for(var i=0;i<_fde;i++){
var _fe4={},_fe5={};
_fe4[ref]=(_fe1=="pos"?"-=":"+=")+_fdd;
_fe5[ref]=(_fe1=="pos"?"+=":"-=")+_fdd;
el.animate(_fe4,_fdf/2,o.options.easing).animate(_fe5,_fdf/2,o.options.easing);
_fdd=(mode=="hide")?_fdd*2:_fdd/2;
}
if(mode=="hide"){
var _fe2={opacity:0};
_fe2[ref]=(_fe1=="pos"?"-=":"+=")+_fdd;
el.animate(_fe2,_fdf/2,o.options.easing,function(){
el.hide();
$.effects.restore(el,_fda);
$.effects.removeWrapper(el);
if(o.callback){
o.callback.apply(this,arguments);
}
});
}else{
var _fe4={},_fe5={};
_fe4[ref]=(_fe1=="pos"?"-=":"+=")+_fdd;
_fe5[ref]=(_fe1=="pos"?"+=":"-=")+_fdd;
el.animate(_fe4,_fdf/2,o.options.easing).animate(_fe5,_fdf/2,o.options.easing,function(){
$.effects.restore(el,_fda);
$.effects.removeWrapper(el);
if(o.callback){
o.callback.apply(this,arguments);
}
});
}
el.queue("fx",function(){
el.dequeue();
});
el.dequeue();
});
};
})(jQuery);
(function($,_fe7){
$.effects.clip=function(o){
return this.queue(function(){
var el=$(this),_fea=["position","top","bottom","left","right","height","width"];
var mode=$.effects.setMode(el,o.options.mode||"hide");
var _fec=o.options.direction||"vertical";
$.effects.save(el,_fea);
el.show();
var _fed=$.effects.createWrapper(el).css({overflow:"hidden"});
var _fee=el[0].tagName=="IMG"?_fed:el;
var ref={size:(_fec=="vertical")?"height":"width",position:(_fec=="vertical")?"top":"left"};
var _ff0=(_fec=="vertical")?_fee.height():_fee.width();
if(mode=="show"){
_fee.css(ref.size,0);
_fee.css(ref.position,_ff0/2);
}
var _ff1={};
_ff1[ref.size]=mode=="show"?_ff0:0;
_ff1[ref.position]=mode=="show"?0:_ff0/2;
_fee.animate(_ff1,{queue:false,duration:o.duration,easing:o.options.easing,complete:function(){
if(mode=="hide"){
el.hide();
}
$.effects.restore(el,_fea);
$.effects.removeWrapper(el);
if(o.callback){
o.callback.apply(el[0],arguments);
}
el.dequeue();
}});
});
};
})(jQuery);
(function($,_ff3){
$.effects.drop=function(o){
return this.queue(function(){
var el=$(this),_ff6=["position","top","bottom","left","right","opacity"];
var mode=$.effects.setMode(el,o.options.mode||"hide");
var _ff8=o.options.direction||"left";
$.effects.save(el,_ff6);
el.show();
$.effects.createWrapper(el);
var ref=(_ff8=="up"||_ff8=="down")?"top":"left";
var _ffa=(_ff8=="up"||_ff8=="left")?"pos":"neg";
var _ffb=o.options.distance||(ref=="top"?el.outerHeight({margin:true})/2:el.outerWidth({margin:true})/2);
if(mode=="show"){
el.css("opacity",0).css(ref,_ffa=="pos"?-_ffb:_ffb);
}
var _ffc={opacity:mode=="show"?1:0};
_ffc[ref]=(mode=="show"?(_ffa=="pos"?"+=":"-="):(_ffa=="pos"?"-=":"+="))+_ffb;
el.animate(_ffc,{queue:false,duration:o.duration,easing:o.options.easing,complete:function(){
if(mode=="hide"){
el.hide();
}
$.effects.restore(el,_ff6);
$.effects.removeWrapper(el);
if(o.callback){
o.callback.apply(this,arguments);
}
el.dequeue();
}});
});
};
})(jQuery);
(function($,_ffe){
$.effects.explode=function(o){
return this.queue(function(){
var rows=o.options.pieces?Math.round(Math.sqrt(o.options.pieces)):3;
var cells=o.options.pieces?Math.round(Math.sqrt(o.options.pieces)):3;
o.options.mode=o.options.mode=="toggle"?($(this).is(":visible")?"hide":"show"):o.options.mode;
var el=$(this).show().css("visibility","hidden");
var _1003=el.offset();
_1003.top-=parseInt(el.css("marginTop"),10)||0;
_1003.left-=parseInt(el.css("marginLeft"),10)||0;
var width=el.outerWidth(true);
var _1005=el.outerHeight(true);
for(var i=0;i<rows;i++){
for(var j=0;j<cells;j++){
el.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-j*(width/cells),top:-i*(_1005/rows)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:width/cells,height:_1005/rows,left:_1003.left+j*(width/cells)+(o.options.mode=="show"?(j-Math.floor(cells/2))*(width/cells):0),top:_1003.top+i*(_1005/rows)+(o.options.mode=="show"?(i-Math.floor(rows/2))*(_1005/rows):0),opacity:o.options.mode=="show"?0:1}).animate({left:_1003.left+j*(width/cells)+(o.options.mode=="show"?0:(j-Math.floor(cells/2))*(width/cells)),top:_1003.top+i*(_1005/rows)+(o.options.mode=="show"?0:(i-Math.floor(rows/2))*(_1005/rows)),opacity:o.options.mode=="show"?1:0},o.duration||500);
}
}
setTimeout(function(){
o.options.mode=="show"?el.css({visibility:"visible"}):el.css({visibility:"visible"}).hide();
if(o.callback){
o.callback.apply(el[0]);
}
el.dequeue();
$("div.ui-effects-explode").remove();
},o.duration||500);
});
};
})(jQuery);
(function($,_1009){
$.effects.fade=function(o){
return this.queue(function(){
var elem=$(this),mode=$.effects.setMode(elem,o.options.mode||"hide");
elem.animate({opacity:mode},{queue:false,duration:o.duration,easing:o.options.easing,complete:function(){
(o.callback&&o.callback.apply(this,arguments));
elem.dequeue();
}});
});
};
})(jQuery);
(function($,_100e){
$.effects.fold=function(o){
return this.queue(function(){
var el=$(this),props=["position","top","bottom","left","right"];
var mode=$.effects.setMode(el,o.options.mode||"hide");
var size=o.options.size||15;
var _1014=!(!o.options.horizFirst);
var _1015=o.duration?o.duration/2:$.fx.speeds._default/2;
$.effects.save(el,props);
el.show();
var _1016=$.effects.createWrapper(el).css({overflow:"hidden"});
var _1017=((mode=="show")!=_1014);
var ref=_1017?["width","height"]:["height","width"];
var _1019=_1017?[_1016.width(),_1016.height()]:[_1016.height(),_1016.width()];
var _101a=/([0-9]+)%/.exec(size);
if(_101a){
size=parseInt(_101a[1],10)/100*_1019[mode=="hide"?0:1];
}
if(mode=="show"){
_1016.css(_1014?{height:0,width:size}:{height:size,width:0});
}
var _101b={},_101c={};
_101b[ref[0]]=mode=="show"?_1019[0]:size;
_101c[ref[1]]=mode=="show"?_1019[1]:0;
_1016.animate(_101b,_1015,o.options.easing).animate(_101c,_1015,o.options.easing,function(){
if(mode=="hide"){
el.hide();
}
$.effects.restore(el,props);
$.effects.removeWrapper(el);
if(o.callback){
o.callback.apply(el[0],arguments);
}
el.dequeue();
});
});
};
})(jQuery);
(function($,_101e){
$.effects.highlight=function(o){
return this.queue(function(){
var elem=$(this),props=["backgroundImage","backgroundColor","opacity"],mode=$.effects.setMode(elem,o.options.mode||"show"),_1023={backgroundColor:elem.css("backgroundColor")};
if(mode=="hide"){
_1023.opacity=0;
}
$.effects.save(elem,props);
elem.show().css({backgroundImage:"none",backgroundColor:o.options.color||"#ffff99"}).animate(_1023,{queue:false,duration:o.duration,easing:o.options.easing,complete:function(){
(mode=="hide"&&elem.hide());
$.effects.restore(elem,props);
(mode=="show"&&!$.support.opacity&&this.style.removeAttribute("filter"));
(o.callback&&o.callback.apply(this,arguments));
elem.dequeue();
}});
});
};
})(jQuery);
(function($,_1025){
$.effects.pulsate=function(o){
return this.queue(function(){
var elem=$(this),mode=$.effects.setMode(elem,o.options.mode||"show");
times=((o.options.times||5)*2)-1;
duration=o.duration?o.duration/2:$.fx.speeds._default/2,isVisible=elem.is(":visible"),animateTo=0;
if(!isVisible){
elem.css("opacity",0).show();
animateTo=1;
}
if((mode=="hide"&&isVisible)||(mode=="show"&&!isVisible)){
times--;
}
for(var i=0;i<times;i++){
elem.animate({opacity:animateTo},duration,o.options.easing);
animateTo=(animateTo+1)%2;
}
elem.animate({opacity:animateTo},duration,o.options.easing,function(){
if(animateTo==0){
elem.hide();
}
(o.callback&&o.callback.apply(this,arguments));
});
elem.queue("fx",function(){
elem.dequeue();
}).dequeue();
});
};
})(jQuery);
(function($,_102b){
$.effects.puff=function(o){
return this.queue(function(){
var elem=$(this),mode=$.effects.setMode(elem,o.options.mode||"hide"),_102f=parseInt(o.options.percent,10)||150,_1030=_102f/100,_1031={height:elem.height(),width:elem.width()};
$.extend(o.options,{fade:true,mode:mode,percent:mode=="hide"?_102f:100,from:mode=="hide"?_1031:{height:_1031.height*_1030,width:_1031.width*_1030}});
elem.effect("scale",o.options,o.duration,o.callback);
elem.dequeue();
});
};
$.effects.scale=function(o){
return this.queue(function(){
var el=$(this);
var _1034=$.extend(true,{},o.options);
var mode=$.effects.setMode(el,o.options.mode||"effect");
var _1036=parseInt(o.options.percent,10)||(parseInt(o.options.percent,10)==0?0:(mode=="hide"?0:100));
var _1037=o.options.direction||"both";
var _1038=o.options.origin;
if(mode!="effect"){
_1034.origin=_1038||["middle","center"];
_1034.restore=true;
}
var _1039={height:el.height(),width:el.width()};
el.from=o.options.from||(mode=="show"?{height:0,width:0}:_1039);
var _103a={y:_1037!="horizontal"?(_1036/100):1,x:_1037!="vertical"?(_1036/100):1};
el.to={height:_1039.height*_103a.y,width:_1039.width*_103a.x};
if(o.options.fade){
if(mode=="show"){
el.from.opacity=0;
el.to.opacity=1;
}
if(mode=="hide"){
el.from.opacity=1;
el.to.opacity=0;
}
}
_1034.from=el.from;
_1034.to=el.to;
_1034.mode=mode;
el.effect("size",_1034,o.duration,o.callback);
el.dequeue();
});
};
$.effects.size=function(o){
return this.queue(function(){
var el=$(this),props=["position","top","bottom","left","right","width","height","overflow","opacity"];
var _103e=["position","top","bottom","left","right","overflow","opacity"];
var _103f=["width","height","overflow"];
var _1040=["fontSize"];
var _1041=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];
var _1042=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"];
var mode=$.effects.setMode(el,o.options.mode||"effect");
var _1044=o.options.restore||false;
var scale=o.options.scale||"both";
var _1046=o.options.origin;
var _1047={height:el.height(),width:el.width()};
el.from=o.options.from||_1047;
el.to=o.options.to||_1047;
if(_1046){
var _1048=$.effects.getBaseline(_1046,_1047);
el.from.top=(_1047.height-el.from.height)*_1048.y;
el.from.left=(_1047.width-el.from.width)*_1048.x;
el.to.top=(_1047.height-el.to.height)*_1048.y;
el.to.left=(_1047.width-el.to.width)*_1048.x;
}
var _1049={from:{y:el.from.height/_1047.height,x:el.from.width/_1047.width},to:{y:el.to.height/_1047.height,x:el.to.width/_1047.width}};
if(scale=="box"||scale=="both"){
if(_1049.from.y!=_1049.to.y){
props=props.concat(_1041);
el.from=$.effects.setTransition(el,_1041,_1049.from.y,el.from);
el.to=$.effects.setTransition(el,_1041,_1049.to.y,el.to);
}
if(_1049.from.x!=_1049.to.x){
props=props.concat(_1042);
el.from=$.effects.setTransition(el,_1042,_1049.from.x,el.from);
el.to=$.effects.setTransition(el,_1042,_1049.to.x,el.to);
}
}
if(scale=="content"||scale=="both"){
if(_1049.from.y!=_1049.to.y){
props=props.concat(_1040);
el.from=$.effects.setTransition(el,_1040,_1049.from.y,el.from);
el.to=$.effects.setTransition(el,_1040,_1049.to.y,el.to);
}
}
$.effects.save(el,_1044?props:_103e);
el.show();
$.effects.createWrapper(el);
el.css("overflow","hidden").css(el.from);
if(scale=="content"||scale=="both"){
_1041=_1041.concat(["marginTop","marginBottom"]).concat(_1040);
_1042=_1042.concat(["marginLeft","marginRight"]);
_103f=props.concat(_1041).concat(_1042);
el.find("*[width]").each(function(){
child=$(this);
if(_1044){
$.effects.save(child,_103f);
}
var _104a={height:child.height(),width:child.width()};
child.from={height:_104a.height*_1049.from.y,width:_104a.width*_1049.from.x};
child.to={height:_104a.height*_1049.to.y,width:_104a.width*_1049.to.x};
if(_1049.from.y!=_1049.to.y){
child.from=$.effects.setTransition(child,_1041,_1049.from.y,child.from);
child.to=$.effects.setTransition(child,_1041,_1049.to.y,child.to);
}
if(_1049.from.x!=_1049.to.x){
child.from=$.effects.setTransition(child,_1042,_1049.from.x,child.from);
child.to=$.effects.setTransition(child,_1042,_1049.to.x,child.to);
}
child.css(child.from);
child.animate(child.to,o.duration,o.options.easing,function(){
if(_1044){
$.effects.restore(child,_103f);
}
});
});
}
el.animate(el.to,{queue:false,duration:o.duration,easing:o.options.easing,complete:function(){
if(el.to.opacity===0){
el.css("opacity",el.from.opacity);
}
if(mode=="hide"){
el.hide();
}
$.effects.restore(el,_1044?props:_103e);
$.effects.removeWrapper(el);
if(o.callback){
o.callback.apply(this,arguments);
}
el.dequeue();
}});
});
};
})(jQuery);
(function($,_104c){
$.effects.shake=function(o){
return this.queue(function(){
var el=$(this),props=["position","top","bottom","left","right"];
var mode=$.effects.setMode(el,o.options.mode||"effect");
var _1051=o.options.direction||"left";
var _1052=o.options.distance||20;
var times=o.options.times||3;
var speed=o.duration||o.options.duration||140;
$.effects.save(el,props);
el.show();
$.effects.createWrapper(el);
var ref=(_1051=="up"||_1051=="down")?"top":"left";
var _1056=(_1051=="up"||_1051=="left")?"pos":"neg";
var _1057={},_1058={},_1059={};
_1057[ref]=(_1056=="pos"?"-=":"+=")+_1052;
_1058[ref]=(_1056=="pos"?"+=":"-=")+_1052*2;
_1059[ref]=(_1056=="pos"?"-=":"+=")+_1052*2;
el.animate(_1057,speed,o.options.easing);
for(var i=1;i<times;i++){
el.animate(_1058,speed,o.options.easing).animate(_1059,speed,o.options.easing);
}
el.animate(_1058,speed,o.options.easing).animate(_1057,speed/2,o.options.easing,function(){
$.effects.restore(el,props);
$.effects.removeWrapper(el);
if(o.callback){
o.callback.apply(this,arguments);
}
});
el.queue("fx",function(){
el.dequeue();
});
el.dequeue();
});
};
})(jQuery);
(function($,_105c){
$.effects.slide=function(o){
return this.queue(function(){
var el=$(this),props=["position","top","bottom","left","right"];
var mode=$.effects.setMode(el,o.options.mode||"show");
var _1061=o.options.direction||"left";
$.effects.save(el,props);
el.show();
$.effects.createWrapper(el).css({overflow:"hidden"});
var ref=(_1061=="up"||_1061=="down")?"top":"left";
var _1063=(_1061=="up"||_1061=="left")?"pos":"neg";
var _1064=o.options.distance||(ref=="top"?el.outerHeight({margin:true}):el.outerWidth({margin:true}));
if(mode=="show"){
el.css(ref,_1063=="pos"?(isNaN(_1064)?"-"+_1064:-_1064):_1064);
}
var _1065={};
_1065[ref]=(mode=="show"?(_1063=="pos"?"+=":"-="):(_1063=="pos"?"-=":"+="))+_1064;
el.animate(_1065,{queue:false,duration:o.duration,easing:o.options.easing,complete:function(){
if(mode=="hide"){
el.hide();
}
$.effects.restore(el,props);
$.effects.removeWrapper(el);
if(o.callback){
o.callback.apply(this,arguments);
}
el.dequeue();
}});
});
};
})(jQuery);
(function($,_1067){
$.effects.transfer=function(o){
return this.queue(function(){
var elem=$(this),_106a=$(o.options.to),_106b=_106a.offset(),_106c={top:_106b.top,left:_106b.left,height:_106a.innerHeight(),width:_106a.innerWidth()},_106d=elem.offset(),_106e=$("<div class=\"ui-effects-transfer\"></div>").appendTo(document.body).addClass(o.options.className).css({top:_106d.top,left:_106d.left,height:elem.innerHeight(),width:elem.innerWidth(),position:"absolute"}).animate(_106c,o.duration,o.options.easing,function(){
_106e.remove();
(o.callback&&o.callback.apply(elem[0],arguments));
elem.dequeue();
});
});
};
})(jQuery);
(function($){
window.zoho={color:{darken:function(rgb,_1071){
_1071=zoho.math.limit(_1071,0,1);
var a=[{"mode":"MODIFY","value":1-_1071}];
return this.hsl(rgb,{"luminance":a});
},lighten:function(rgb,_1074){
_1074=zoho.math.limit(_1074,0,1);
var a=[{"mode":"MODIFY","value":1-_1074},{"mode":"OFFSET","value":_1074}];
return this.hsl(rgb,{"luminance":a});
},shade:function(rgb,_1077){
_1077=zoho.math.limit(_1077,0,1);
var a=[{"mode":"MODIFY","value":_1077}];
return this.rgb(rgb,{"red":a,"green":a,"blue":a});
},tint:function(rgb,_107a){
_107a=zoho.math.limit(_107a,0,1);
var a=[{"mode":"MODIFY","value":_107a},{"mode":"OFFSET","value":1-_107a}];
return this.rgb(rgb,{"red":a,"green":a,"blue":a});
},blue:2,green:1,red:0,rgb:function(rgb,_107d){
return this.modify(rgb,_107d,"scRGB");
},luminance:2,saturation:1,hue:0,modify:function(rgb,_107f,mode){
var value=this["to"+mode].call(this,rgb);
var t=this;
$.each(_107f,function(k,_1084){
var num=t[k];
$.each(_1084,function(l,val){
value[num]=modifyValue(value[num],val);
value[num]=zoho.math.limit(value[num],0,1);
});
});
return this[mode+"toRGB"].call(this,value);
},hsl:function(rgb,_1089){
return this.modify(rgb,_1089,"HSL");
},tweak:function(rgb,o){
if(!$.isArray(rgb)){
var t=rgb;
rgb=[t[0],t[1],t[2]];
}
rgb=zoho.array.toNum(rgb);
var t=this;
$.each(o,function(i,val){
if(t[i]){
rgb=t[i].call(t,rgb,val);
}
});
return rgb;
},toscRGB:function(rgb){
rgb=$.map(rgb,function(val,i){
val=val/255;
if(val<0){
return 0;
}else{
if(val<=0.0405){
return val/12.92;
}else{
if(val<=1){
var x=((val+0.055)/1.055);
return Math.pow(x,2.4);
}
}
}
return 1;
});
return rgb;
},scRGBtoRGB:function(scrgb){
scrgb=$.map(scrgb,function(val,i){
if(val<0){
val=0;
}else{
if(val<=0.0031308){
val*=12.92;
}else{
if(val<=1){
var y=1/2.4;
val=1.055*(Math.pow(val,y))-0.055;
}else{
val=1;
}
}
}
return Math.round(val*=255);
});
return scrgb;
},toHSL:function(rgb){
var r=rgb[0];
var g=rgb[1];
var b=rgb[2];
var max=Math.max(r,g,b);
var min=Math.min(r,g,b);
var h=0;
if(max==min){
}else{
if(max==r){
var n=(g-b)/(max-min);
h=((60*n)+360)%360;
}else{
if(max==g){
var n=(b-r)/(max-min);
h=60*n+120;
}else{
var n=(r-g)/(max-min);
h=60*n+240;
}
}
}
h/=360;
var l=(max+min)/(255*2);
var s=0;
if(max==min){
}else{
if(l<=0.5){
s=(max-min)/(2*l);
}else{
s=(max-min)/(2-2*l);
}
}
s/=255;
return [h,s,l];
},HSLtoRGB:function(hsl){
var h=hsl[0];
var s=hsl[1];
var l=hsl[2];
var q;
if(l<0.5){
q=l*(1+s);
}else{
q=l+s-(l*s);
}
var p=2*l-q;
var hk=h;
var tr=hk+(1/3);
var tg=hk;
var tb=hk-(1/3);
var rgb=[tr,tg,tb];
rgb=$.map(rgb,function(val,i){
if(val<0){
val+=1;
}else{
if(val>1){
val-=1;
}
}
val=val%1;
if(val<(1/6)){
val=p+((q-p)*6*val);
}else{
if(val>=(1/6)&&val<0.5){
val=q;
}else{
if(val>=0.5&&val<(2/3)){
val=p+((q-p)*6*((2/3)-val));
}else{
val=p;
}
}
}
var value=Math.round(val*255);
value=zoho.math.limit(value,0,255);
return value;
});
return rgb;
},isDark:function(rgb){
return (this.brightness(rgb)<(0.5*255));
},rgbToHex:function(rgb){
if(typeof rgb!="object"){
var _10b1=/rgb\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*\)/;
if(rgb.match(_10b1)!=null){
var _10b2=/\d{1,3}/g;
rgb=rgb.match(_10b2);
}
}
var hex="#";
$.each(rgb,function(i,val){
var num=zoho.color.numToHex(val);
if(isNaN(zoho.color.hexToNum(num))){
num="00";
}
hex+=num;
});
return hex;
},RGBToHSV:function(rgb){
var r=rgb[0]/255;
var g=rgb[1]/255;
var b=rgb[2]/255;
var min=Math.min(r,g,b);
var max=Math.max(r,g,b);
var v=max*100;
var h=s=0;
var delta=max-min;
if(max!=0){
s=(delta/max)*100;
}else{
s=h=0;
return [h,s,v];
}
var _10c0=0;
if(delta){
if(r==max){
_10c0=(g-b)/delta;
}else{
if(g==max){
_10c0=2+(b-r)/delta;
}else{
_10c0=4+(r-g)/delta;
}
}
}
h=_10c0*60;
if(h<0){
h+=360;
}
var _r=Math.round;
h=_r(h);
s=_r(s);
v=_r(v);
return [h,s,v];
},HSVToRGB:function(hsv){
var h=hsv[0];
var s=hsv[1];
var v=hsv[2];
var _s=s/100;
var _v=v/100;
var r=g=b=0;
var set=function(_r,_g,_b){
var _rd=Math.round;
r=_rd(_r*255);
g=_rd(_g*255);
b=_rd(_b*255);
};
if(_s==0){
set(_v,_v,_v);
return [r,g,b];
}
if(h==360){
h=0;
}
var _10ce=h/60;
var _10cf=Math.floor(_10ce);
var _10d0=_10ce-_10cf;
var p=_v*(1-_s);
var q=_v*(1-_s*_10d0);
var t=_v*(1-_s*(1-_10d0));
switch(_10cf){
case 0:
set(_v,t,p);
break;
case 1:
set(q,_v,p);
break;
case 2:
set(p,_v,t);
break;
case 3:
set(p,q,_v);
break;
case 4:
set(t,p,_v);
break;
default:
set(_v,p,q);
}
return [r,g,b];
},hexToRgb:function(hex,_10d5){
hex=hex.replace("#","");
if(hex.length==3){
hex=hex+hex;
}
if(hex.length!=6){
if(!_10d5){
return "rgb(0, 0, 0)";
}
hex=_10d5;
}
var rgb="rgb(";
var r="";
$.each(hex.split(""),function(i,val){
r=(!i%2)?val:r+val;
if(i%2){
_v=zoho.color.hexToNum(r);
if(isNaN(_v)){
_v=0;
}
rgb+=_v;
if(i<=4){
rgb+=",";
}
r="";
}
});
rgb+=")";
return rgb;
},numToHex:function(num){
var _10db=parseInt(num).toString(16);
return (_10db.length==1)?"0"+_10db:_10db;
},hexToNum:function(hex){
return parseInt(hex,16);
},brightness:function(rgb){
var r=rgb[0];
var g=rgb[1];
var b=rgb[2];
var _10e1=r*0.299+g*0.587+b*0.114;
return _10e1;
}},math:{limit:function(val,min,max){
var a=Math.min(val,max);
return Math.max(a,min);
},maxLimit:function(val,max){
return Math.min(val,max);
},minLimit:function(val,min){
return Math.max(val,min);
},toRadians:function(angle){
return angle*(Math.PI/180);
},toDegrees:function(angle){
return angle*(180/Math.PI);
},getRotatedValue:function(angle,x,y,cX,cY){
var _10f1={};
var _10f2=zoho.math.toRadians(angle);
_10f1.a=Math.cos(_10f2);
_10f1.c=(-1)*Math.sin(_10f2);
_10f1.b=Math.sin(_10f2);
_10f1.d=Math.cos(_10f2);
_10f1.e=(cY*_10f1.b)-(cX*_10f1.d)+cX;
_10f1.f=cY-(cX*_10f1.b)-(cY*_10f1.d);
var finX=(x*_10f1.a)+(y*_10f1.c)+_10f1.e;
var finY=(x*_10f1.b)+(y*_10f1.d)+_10f1.f;
return {"x":finX,"y":finY};
},getAngle:function(x,y,wR,hR,midX,midY){
var rad1=2*Math.PI;
midX=(midX)?midX:wR;
midY=(midY)?midY:hR;
var n1=(y-midY)*wR;
var n2=(x-midX)*hR;
var angle=Math.atan2(n1,n2);
angle+=rad1;
angle%=rad1;
return angle;
},bezierPoint:function(start,cp1,cp2,end,_1103){
var B=((Math.pow((1-_1103),3)*start)+(3*Math.pow((1-_1103),2)*_1103*cp1)+(3*(1-_1103)*Math.pow(_1103,2)*cp2)+(Math.pow(_1103,3)*end));
return B;
},length:function(x1,y1,x2,y2){
return Math.sqrt(Math.pow((x2-x1),2)+Math.pow((y2-y1),2));
},getPointAtDistance:function(line,_110a){
var start=line.start;
var end=line.end;
var D=zoho.math.length(start.x,start.y,end.x,end.y);
return {"x":start.x+(_110a/D)*(end.x-start.x),"y":start.y+(_110a/D)*(end.y-start.y)};
},distanceOf:function(val1,val2,diffX,diffY,isY){
var a=val2.y-val1.y;
if(isY){
a*=-1;
}
var b=val1.x-val2.x;
if(isY){
b*=-1;
}
var c=(((-1)*b)*val1.y)-a*val1.x;
var _1116=(Math.sqrt(Math.pow(a,2)+Math.pow(b,2)));
var d=(_1116)?(a*diffX+b*diffY+c)/_1116:0;
return d;
},toCubicControlPoints:function(x1,y1,cx1,cy1,x2,y2){
var val1=2/3;
var val2=1/3;
var ccx1=val1*cx1+val2*x1;
var ccy1=val1*cy1+val2*y1;
var ccx2=val1*cx1+val2*x2;
var ccy2=val1*cy1+val2*y2;
return [ccx1,ccy1,ccx2,ccy2];
},ifElse:function(x,y,z){
if(x>0){
return y;
}
return z;
},cosTan:function(x,y,z){
return x*Math.cos(Math.atan2(z,y));
},sinTan:function(x,y,z){
return x*Math.sin(Math.atan2(z,y));
},roundDecimal:function(_112d,_112e){
var _112f=Math.pow(10,_112e);
var _1130=Math.round(_112d*_112f)/_112f;
return _1130;
},modulo:function(num,_1132){
num=parseFloat(num);
_1132=parseFloat(_1132);
var f=zoho.math._getFloatingPointLength;
var pow=Math.pow(10,Math.max(f(num),f(_1132)));
return (num*pow)%(_1132*pow)/pow;
},_getFloatingPointLength:function(_1135){
var f=_1135.toString().split(".")[1];
return f?f.length:0;
},midPoint:function(p1,p2){
return {"x":(p1.x+p2.x)*0.5,"y":(p1.y+p2.y)*0.5};
},getDiff:function(p1,p2,t){
if(!t){
t=1;
}
return {"x":(p1.x-p2.x)*t,"y":(p1.y-p2.y)*t};
}},array:{toNum:function(a){
return $.map(a,function(val,i){
return val*1;
});
},sort:function(val,type){
val.sort(zoho.array.sortnum);
if(type){
val.reverse();
}
return val;
},sortnum:function(a,b){
return a-b;
},compareXY:function(a,b){
if(a.small){
return a.small-b.small;
}else{
if(a.big){
return a.big-b.big;
}
}
},compareZindex:function(a,b){
return a.zindex-b.zindex;
},diff:function(a,b){
var diff=[];
for(var i=0;a.length>i;i++){
if(b.indexOf(a[i])==-1){
diff.push(a[i]);
}
}
return diff;
},unique:function(b){
var a=[],i,l=b.length;
for(i=0;i<l;i++){
if($.inArray(b[i],a)<0){
a.push(b[i]);
}
}
return a;
},clear:function(a){
a.splice(0,a.length);
}},string:{removeSpace:function(s){
return s.replace(/\s+/g,"");
}},customMerge:function(){
var _1151=arguments[0]||{},i=1,_1153=arguments.length,deep=false,_1155,name,src,copy,_1159,_115a;
if((typeof _1151==="boolean")||($.isObject(_1151)&&(_1151.deep||_1151.overwrite))){
deep=(_1151.deep)?_1151.deep:_1151;
_1159=(_1151.overwrite)?_1151.overwrite:[];
_115a=_1151;
_1151=arguments[1]||{};
i=2;
}
if(typeof _1151!=="object"&&!$.isFunction(_1151)){
_1151={};
}
if(_1153===i){
return _1151;
}
for(;i<_1153;i++){
if((_1155=arguments[i])!=null){
for(name in _1155){
src=_1151[name];
copy=_1155[name];
if(_1151===copy){
continue;
}
if(deep&&copy&&($.isPlainObject(copy)||$.isArray(copy))){
var clone=src&&($.isPlainObject(src)||$.isArray(src))?src:$.isArray(copy)?[]:{};
var skip=(src&&_115a.skip&&$.inArray(name,_115a.skip)!=-1)?true:false;
if(skip){
continue;
}
if($.inArray(name,_1159)==-1){
_1151[name]=zoho.customMerge(_115a,clone,copy);
}else{
_1151[name]=$.extend(deep,$.isArray(copy)?[]:{},copy);
}
}else{
if(copy!==undefined){
_1151[name]=copy;
}
}
}
}
}
return _1151;
}};
function modifyValue(value,o){
if(o.mode=="MODIFY"){
value*=parseFloat(o.value);
}else{
if(o.mode=="OFFSET"){
value+=parseFloat(o.value);
}else{
if(o.mode=="ABSOLUTE"){
value=parseFloat(o.value);
}
}
}
return value;
}
})(jQuery);
(function($){
$.extend({metadata:{defaults:{type:"class",name:"metadata",cre:/({.*})/,single:"metadata"},setType:function(type,name){
this.defaults.type=type;
this.defaults.name=name;
},get:function(elem,opts){
var _1164=$.extend({},this.defaults,opts);
if(!_1164.single.length){
_1164.single="metadata";
}
var data=$.data(elem,_1164.single);
if(data){
return data;
}
data="{}";
var _1166=function(data){
if(typeof data!="string"){
return data;
}
if(data.indexOf("{")<0){
data=eval("("+data+")");
}
};
var _1168=function(data){
if(typeof data!="string"){
return data;
}
data=eval("("+data+")");
return data;
};
if(_1164.type=="html5"){
var _116a={};
$(elem.attributes).each(function(){
var name=this.nodeName;
if(name.match(/^data-/)){
name=name.replace(/^data-/,"");
}else{
return true;
}
_116a[name]=_1168(this.nodeValue);
});
}else{
if(_1164.type=="class"){
var m=_1164.cre.exec(elem.className);
if(m){
data=m[1];
}
}else{
if(_1164.type=="elem"){
if(!elem.getElementsByTagName){
return;
}
var e=elem.getElementsByTagName(_1164.name);
if(e.length){
data=$.trim(e[0].innerHTML);
}
}else{
if(elem.getAttribute!=undefined){
var attr=elem.getAttribute(_1164.name);
if(attr){
data=attr;
}
}
}
}
_116a=_1168(data.indexOf("{")<0?"{"+data+"}":data);
}
$.data(elem,_1164.single,_116a);
return _116a;
}}});
$.fn.metadata=function(opts){
return $.metadata.get(this[0],opts);
};
})(jQuery);
(function($){
$.ui.utils={colorpalette:undefined,addFocusElement:function(ele){
var _1172=$("<button>").css({"height":1,"width":1,"position":"absolute","top":"1px","border":"none"});
_1172.addClass("ui-focus-element");
ele.append(_1172.fadeTo(0,0));
return _1172;
},invokeAction:function(ele){
var _1174=ele.attr("action");
if(!_1174){
return;
}
var _1175=_1174.split("(");
var obj=_1175[0];
var pars=obj.split(".");
var robj=window;
var proto=undefined;
for(var i=0;i<pars.length;i++){
if(i==pars.length-1){
proto=robj;
}
robj=robj[pars[i]];
}
var _117b=_1175[1].split(")")[0].split(",");
robj.apply(proto,_117b);
},displayColorPallet:function(ele,_117d,_117e){
if(!this.colorpalette){
this.colorpalette=$("<div>");
$("body").append(this.colorpalette);
$(this.colorpalette).zcolorpalette(_117e.createoptions);
}
(_117d!="hide")?($(this.colorpalette).zcolorpalette("show",$(ele),_117e.showoptions)):($(this.colorpalette).zcolorpalette("hide"));
},initDeferredComponents:function(_117f,_1180){
var base=this;
setTimeout(function(){
$.each(_117f,function(ctype,_1183){
$(_1183).each(function(i,_1185){
base._initComponent($(_1185),ctype);
});
});
},(_1180?_1180:10000));
},_initComponent:function(_1186,ctype,attr){
attr=attr?attr:"ctype";
var ele=$(_1186);
var _118a=undefined;
if(ele.is(":hidden")){
_118a=ele.parentsUntil(":visible").last().show();
}
ctype=!ctype?ele.attr(attr):ctype;
var data=ele.attr("data");
var _118c=ele.metadata();
if(data){
ele[ctype](_118c.componentOptions?_118c.componentOptions:_118c);
}else{
ele[ctype]();
}
if(_118a){
_118a.hide();
}
},initComponents:function(_118d,_118e,attr){
var _1190="["+(attr?attr:"ctype")+"]";
var _1191=$(_1190,_118d);
if(_118d.is(_1190)){
_1191=$(_118d).add(_1191);
}
var base=this;
if(_1191.length){
$.eachAsync(_1191,{delay:20,loop:function(i,ele){
base._initComponent(ele,undefined,attr);
},end:function(){
base._end(_118d,_1191,_118e);
}});
}else{
base._end(_118d,_1191,_118e);
}
},_end:function(_1195,_1196,_1197){
$(document).trigger("componentinitialized",_1195);
if(_1197){
_1197(_1196);
}
},_getCtype:function(ele){
return ele.attr("ctype");
},getValue:function(ele){
return ele[this._getCtype(ele)]("getValue");
},setValue:function(ele,value){
return ele[this._getCtype(ele)]("setValue",value);
},invokeMethodByCtype:function(ele,_119d,_119e){
return ele[this._getCtype(ele)](_119d,_119e);
},getAsFunction:function(_119f){
if(_119f){
var _11a0=_119f.split(".");
var fn=window;
var base="";
$(_11a0).each(function(i,_11a4){
fn=fn[_11a4];
if(i==_11a0.length-2){
base=fn;
}
});
return {"fn":fn,"base":base,"callable":function(){
fn.call(base);
}};
}
},getPositionFromDirection:function(_11a5,_11a6,dir){
var _11a8=$(_11a5).offset();
var _11a9=(dir=="northeast"||dir=="southeast"||dir=="east")?(_11a8.left+$(_11a5).outerWidth(true))-(_11a6.outerWidth(true)):(dir=="north"||dir=="south"||dir=="center")?(_11a8.left+$(_11a5).width()/2)-(_11a6.outerWidth(true)/2):_11a8.left;
var _11aa=(dir=="south"||dir=="southeast"||dir=="southwest")?(_11a8.top+$(_11a5).outerHeight(true)):(dir=="west"||dir=="east"||dir=="center")?(_11a8.top+$(_11a5).outerHeight(true)/2)-(_11a6.outerHeight(true)/2):_11a8.top;
return {"left":_11a9+"px","top":_11aa+"px"};
}};
})(jQuery);
(function($){
var _11ac={_spinning:false,_input:undefined,_timeout:undefined,_uiSpinner:undefined,_hasValidValue:true,_millisecsForAnHour:60*60*1000,_millisecsForAMinute:60*1000,_millisecsForASecond:1000,widgetEventPrefix:"spinner",_timeFormats:["hh:mm:ss:ms","hh:mm:ss","hh:mm","hh","mm:ss:ms","mm.ss","mm","ss:ms","ss","ms"],_create:function(){
this.options=$.extend({},$.ui.zspinner.defaults,this.options);
this._parseOptions();
this._initSpinner();
},_EVENTS:{"ONSTART":"start","ONSPIN":"spin","ONCHANGE":"change","ONSTOP":"stop"},_parseOptions:function(){
this.options.max=$(this.element).attr("max");
this.options.min=$(this.element).attr("min");
this.options.step=$(this.element).attr("step");
var base=this;
$(["min","max","step","quickstep"]).each(function(i,opt){
base.options[opt]=parseFloat(base.options[opt]);
});
},getFormatFromTime:function(_11b0){
var hrs=mins=secs=msecs=0;
if(_11b0>0){
hrs=parseInt(_11b0/(this._millisecsForAnHour));
mins=parseInt((_11b0%this._millisecsForAnHour)/this._millisecsForAMinute);
secs=parseInt((_11b0%this._millisecsForAMinute)/this._millisecsForASecond);
msecs=parseInt((_11b0%this._millisecsForAMinute)%this._millisecsForASecond);
}
var _11b2=this._convertToFormat(_11b0,hrs,mins,secs,msecs);
return _11b2;
},_convertToFormat:function(_11b3,hrs,mins,secs,msecs){
var unit=this.options.timeunit;
var _11b9=this.options.timeFormat;
var _11ba=_11b3;
var _11bb=_11b9.split(":");
var _11bc="";
$.each(_11bb,function(i,_11be){
var end=(i+1==_11bb.length);
unit=end?"":unit;
switch(_11be){
case "hh":
_11bc=_11bc+hrs;
break;
case "mm":
_11bc=_11bc+mins;
break;
case "ss":
_11bc=_11bc+secs;
break;
case "ms":
_11bc=_11bc+msecs;
break;
}
_11bc=_11bc+unit;
});
_11ba=_11bc;
return _11ba;
},getTimeFromFormat:function(_11c0){
var unit=this.options.timeunit;
var _11c2=0;
var _11c3=_11c0.toString().split(unit);
if(_11c3.length==4){
var hrs=_11c3[0]*this._millisecsForAnHour;
var mins=_11c3[1]*this._millisecsForAMinute;
var secs=_11c3[2]*this._millisecsForASecond;
var msecs=parseInt(_11c3[3]);
_11c2=hrs+mins+secs+msecs;
}else{
_11c2=this.options.value;
}
return _11c2;
},_initSpinner:function(){
var base=this;
var _11c9=$(this.element)[base.options.editable?"val":"text"]();
if(this.options.type!="time"){
if(!_11c9.match("[0-9]")){
if(!isNaN(this.options.defaultValue)){
_11c9=(this.options.defaultValue+this.options.unit);
}else{
if(this.options.nullValue){
_11c9=this.options.nullValue;
}else{
_11c9=this.options.min+this.options.unit;
}
}
}
this.options.value=base.options.unit?_11c9.toString().split(base.options.unit)[0]:_11c9;
}else{
_11c9=this.getFormatFromTime(this.options.value);
}
var _11ca=(this.element.width()>=50)?this.element.width():50;
this._baseElement=$("<div>").css({"width":_11ca,"display":"inline-block"});
this._input=(base.options.editable?$("<input>"):$("<div>")).attr((base.options.editable?"type":"contentEditable"),(this.options.editable)?"text":false).css({"width":_11ca-16});
this._baseElement.append(this._input);
var up=$("<span>").addClass("ui-state-default");
up.hover(function(e){
up.addClass("ui-state-hover");
},function(e){
up.removeClass("ui-state-hover");
});
var _11ce=$("<span>").addClass("ui-icon ui-components-icon ui-icon-arrow-n");
_11ce.appendTo(up);
var down=$("<span>").addClass("ui-state-default");
down.hover(function(e){
down.addClass("ui-state-hover");
},function(e){
down.removeClass("ui-state-hover");
});
var _11d2=$("<span>").addClass("ui-icon ui-components-icon ui-icon-arrow-s");
_11d2.appendTo(down);
var _11d3=$("<div>").addClass("ui-zspinner-controls").append(up).append(down);
if(this.options.unit.match("[0-9]")){
this.options.unit="";
}
this._input.addClass("ui-zspinner-content ui-widget-content")[base.options.editable?"val":"text"](_11c9);
if(!this.options.editable){
this._input.addClass("ui-noneditable-spinner");
}
this._baseElement.insertAfter(this.element);
_11d3.insertAfter(this._input);
this._initEvents();
if(this.element.is(":disabled")){
this.disable();
}
this.element.hide();
},_initEvents:function(){
var base=this;
if(!this.options.editable){
this._input.bind("mousedown",function(ev){
base._input.attr("tabindex",0);
});
}
this._input.bind("keydown."+this.widgetName,function(ev){
if(base._isDisabled(base.element)){
return false;
}
var _11d7=undefined;
switch(ev.keyCode){
case $.ui.keyCode.UP:
_11d7=false;
break;
case $.ui.keyCode.DOWN:
_11d7=true;
break;
}
if(_11d7!=undefined){
base._setSpinning(_11d7,ev.shiftKey);
}
var val=base._input[base.options.editable?"val":"text"]();
if(base.options.editable){
if(val!=base.options.nullValue){
base._checkValue(ev);
}else{
base.options.value=base.options.nullValue;
return false;
}
}else{
return false;
}
}).keyup(function(ev){
if(base._isDisabled(base.element)){
return false;
}
base._stopSpinning();
}).bind("focus"+"."+this.widgetName,function(ev){
if(base._isDisabled(base.element)){
return false;
}
}).bind("blur."+this.widgetName,function(ev){
var val=base._input[base.options.editable?"val":"text"]();
val=base.options.unit?val.toString().split(base.options.unit)[0]:val;
if(isNaN(parseFloat(val))){
base._input.val(base.options.nullValue?base.options.nullValue:(base.element.val()+base.options.unit));
base.options.value=base.options.nullValue?base.options.nullValue:base.options.min;
}else{
if(base.options.unit){
base._input.val(val+base.options.unit);
}
}
});
var _11dd=this._baseElement.children(".ui-zspinner-controls");
var _11de=_11dd.children(".ui-state-default");
_11de.find("span").bind("mousedown"+"."+this.widgetName,function(ev){
if(base._isDisabled(base.element)){
return false;
}
this._mousedown=true;
if(ev.which>1){
return false;
}
var _11e0=$(ev.target).parent();
_11e0.addClass("ui-state-active");
var _11e1=$(ev.target).hasClass("ui-icon-arrow-s");
base._setSpinning(_11e1,ev.shiftKey);
$(document).bind("mouseup."+this.widgetName,function(ev){
if(base._isDisabled(base.element)){
return false;
}
_11e0.removeClass("ui-state-active");
base._stopSpinning(ev);
base._input.attr("tabindex",0);
base._input.focus();
$(document).unbind("mouseup");
});
});
},_setSpinning:function(_11e3,_11e4){
this._triggerEvent(this._EVENTS.ONSTART);
this._spinning=true;
this._startSpinning(_11e3?"down":"up",_11e4);
},_startSpinning:function(spin,_11e6){
var val=(!isNaN(this.options.value))?this.options.value:this.options.min;
if(val==this.options.nullValue||isNaN(val)){
val=(spin=="up")?this.options.min-1:((this.options.rotate)?(this.options.max+1):this.options.nullValue);
}else{
val=parseFloat(val);
if(val==this.options.min&&this.options.nullValue){
val=((spin=="up")?val:this.options.nullValue);
}
}
if(val.toString().indexOf(this.options.unit)!=-1){
this.options.unit="";
}
var base=this;
if(this._spinning){
var step=this.options[_11e6?"quickstep":"step"];
switch(spin){
case "up":
val+=step;
if(this.options.max!=undefined&&!isNaN(this.options.max)){
if(val>this.options.max&&this.options.rotate){
val=this.options.nullValue?this.options.nullValue:this.options.min;
}
if(val>this.options.max||val<this.options.min){
this._input[base.options.editable?"val":"text"](((this.options.type=="time")?this.getFormatFromTime(this.options.max):this.options.max)+this.options.unit);
}
if(val<=this.options.max||isNaN(val)){
this._spinValue("up",val,step,_11e6);
}
}else{
this._spinValue("up",val,step,_11e6);
}
break;
case "down":
val-=step;
if(this.options.min!=undefined&&!isNaN(this.options.min)){
if(val<this.options.min&&this.options.rotate){
val=this.options.nullValue?this.options.nullValue:this.options.max;
}
if(val<this.options.min||val>this.options.max){
this._input[base.options.editable?"val":"text"](((this.options.type=="time")?this.getFormatFromTime(this.options.min):this.options.min)+this.options.unit);
}
if(val>=this.options.min||isNaN(val)){
this._spinValue("down",val,step,_11e6);
}
}else{
this._spinValue("down",val,step,_11e6);
}
break;
}
this.options.value=val;
if(!isNaN(val)){
this.options.value=base._checkAndReturnValue();
}else{
this.options.value=this.options.nullValue;
}
this._callOnChange();
if(this.options.onchangeEvent){
$(this.element).trigger(this.options.onchangeEvent,{"value":this.getValue()});
}
if(this.options.quickTrigger){
this._triggerEvent(this._EVENTS.ONCHANGE);
}else{
this._triggerEvent(this._EVENTS.ONSPIN);
}
}
},_callOnChange:function(){
if(this.options.onchange){
if(isNaN(parseFloat(this.options.value))&&this.options.type!="time"){
this.options.value=parseFloat(this.element.val());
}
this.options.onchange(this.getValue());
}
},_spinValue:function(dir,val,step,_11ed){
var base=this;
this.options.floatLength=this.options.floatLength?this.options.floatLength:this._getDecimalPointLength(this.options.step);
var value=(this.options.type!="time")?((isNaN(val)||val==this.options.nullValue)?this.options.nullValue:(val.toFixed(this.options.floatLength)+this.options.unit)):this.getFormatFromTime(val);
this._input[base.options.editable?"val":"text"](value).focus();
this._timeout=setTimeout(function(){
base._startSpinning(dir,_11ed);
},150);
},_checkValue:function(ev){
var key=String.fromCharCode(ev.keyCode).toLowerCase();
var base=this;
var _11f3=$(ev.target)[base.options.editable?"val":"text"]();
var _11f4=this.options.floatLength;
var _11f5=undefined;
if(ev.keyCode==190&&_11f3.indexOf(".")==-1){
key=".";
}
if(_11f4){
_11f5=((ev.keyCode>=48&&ev.keyCode<=57)||(ev.keyCode>=96&&ev.keyCode<=105)||ev.keyCode==190||ev.keyCode==110);
}else{
_11f5=((ev.keyCode>=48&&ev.keyCode<=57)||(ev.keyCode>=96&&ev.keyCode<=105));
}
if(base.options.min.toString().indexOf("-")!=-1){
_11f5=(_11f5||ev.keyCode==189);
}
var _11f6=(base.options.type!="time")?$(ev.target)[base.options.editable?"val":"text"]():base.getTimeFromFormat($(ev.target)[base.options.editable?"val":"text"]());
_11f6=(base.options.unit)?parseFloat(_11f6.toString().split(base.options.unit)[0]):parseFloat(_11f6);
if(_11f5&&!ev.shiftKey){
window.setTimeout(function(){
var _11f7=base._input[base.options.editable?"val":"text"]();
var _11f8=false;
_11f6=(base.options.type!="time")?_11f7:_11f6;
_11f7=parseFloat(_11f7);
if(base.options.unit){
var _11f9=_11f7.toString().split(base.options.unit);
if((_11f9[0]>base.options.max||_11f7<base.options.min||(_11f9[1]))){
_11f6=_11f3;
_11f8=true;
}
}else{
if(_11f7>base.options.max||_11f7<base.options.min){
_11f6=_11f3;
_11f8=true;
}
}
if(_11f8){
$(ev.target)[base.options.editable?"val":"text"](_11f6);
}
base.options.value=base.options.unit?_11f6.toString().split(base.options.unit)[0]:_11f6;
base._hasValidValue=true;
base._callOnChange();
},1);
}else{
if(ev.keyCode!=40&&ev.keyCode!=38&&ev.keyCode!=46&&ev.keyCode!=8){
if(ev.keyCode!=37&&ev.keyCode!=39&&ev.keyCode!=9){
base._stopEvent(ev);
}
base._hasValidValue=false;
}else{
base._hasValidValue=true;
window.setTimeout(function(){
var _11fa=base._input[base.options.editable?"val":"text"]();
_11fa=(base.options.type!="time")?_11fa:_11f6;
base.options.value=base.options.unit?_11fa.toString().split(base.options.unit)[0]:_11fa;
base._callOnChange();
},1);
}
}
},_stopEvent:function(ev){
if(jQuery.browser.msie){
window.event.cancelBubble=true;
window.event.returnValue=false;
}else{
ev.preventDefault();
ev.stopPropagation();
}
},_checkAndReturnValue:function(){
var value=this.options.value;
if(value>this.options.max){
value=this.options.max;
}
if(value<this.options.min){
value=this.options.min;
}
return value;
},_getDecimalPointLength:function(_11fd){
var _11fe=(_11fd.toString().indexOf(".")!=-1)?true:false;
var f=0;
if(_11fe){
f=_11fd.toString().split(".")[1];
f=(f&&f.length>=2)?2:f.length;
}
return f;
},_isDisabled:function(ele){
var _1201=$(ele).attr("disabled");
if(_1201){
return true;
}
return false;
},_triggerEvent:function(event){
var base=this;
var value=base.getValue();
var ui={"spinner":$(base.element),"value":parseFloat(value)};
this.element.val(value);
return base._trigger(event,event,ui);
},_stopSpinning:function(ev){
this._timeout=clearTimeout(this._timeout);
this._spinning=false;
if(!this.options.quickTrigger&&this._hasValidValue){
if(isNaN(parseFloat(this.options.value))&&this.options.type!="time"){
this.options.value=parseFloat(this.element.val());
}
this._triggerEvent(this._EVENTS.ONCHANGE);
this._triggerEvent(this._EVENTS.ONSTOP);
}
},getValue:function(){
return !isNaN(parseFloat(this.options.value))?this.options.value:(this.options.min?this.options.min:0);
},setValue:function(val){
if(!this._isDisabled(this.element)){
if(isNaN(parseFloat(val))){
if(this.options.nullValue){
val=this.options.nullValue;
this.options.value=val;
}else{
if(val===null){
val="";
if(this.options.hiddenValue){
this.options.value=this.options.hiddenValue;
}else{
this.options.value=!isNaN(this.options.defaultValue)?this.options.defaultValue:this.options.min;
}
}else{
val=!isNaN(this.options.defaultValue)?this.options.defaultValue:this.options.min;
this.options.value=val;
val=val+this.options.unit;
}
}
this._input[this.options.editable?"val":"text"](val);
}else{
val=(val>this.options.max)?this.options.max:(val<this.options.min)?this.options.min:parseFloat(val);
val=val.toString().match("[0-9.]")?val:this.options.min;
var value=(this.options.type!="time")?parseFloat(val).toFixed(this.options.floatLength):this.getFormatFromTime(val);
this.options.value=(this.options.type!="time")?value:val;
this._input[this.options.editable?"val":"text"](value+this.options.unit);
this.element.val(value);
}
}
},setMinValue:function(val){
$(this.element).attr("min",val);
this.options.min=val;
},setMaxValue:function(val){
$(this.element).attr("max",val);
this.options.max=val;
},setStepValue:function(val){
$(this.element).attr("step",val);
this.options.step=val;
},setUnit:function(unit){
if(unit){
this.options.unit=unit.toString();
}
},disable:function(){
$(this.element).attr("disabled","true");
this._baseElement.addClass("ui-state-disabled");
this._baseElement.find("input").attr("disabled","true");
},enable:function(){
if(this._isDisabled(this.element)){
$(this.element).removeAttr("disabled");
this._baseElement.removeClass("ui-state-disabled");
this._baseElement.find("input").removeAttr("disabled");
}
},widget:function(){
return this._baseElement;
},destroy:function(){
this._baseElement.unbind("."+this.widgetName).remove();
$(this.element).show();
$.Widget.prototype.destroy.apply(this,arguments);
}};
$.widget("ui.zspinner",_11ac);
$.ui.zspinner.defaults={"quickstep":5,"rotate":false,"onchange":undefined,"onchangeEvent":undefined,"quickTrigger":false,"unit":"","decimalAllowed":true,"floatLength":0,"nullValue":undefined,"editable":true,"timeFormat":"mm:ss:ms"};
})(jQuery);
(function($){
$.whileAsync=function(opts){
var delay=Math.abs(opts.delay)||10,bulk=isNaN(opts.bulk)?500:Math.abs(opts.bulk),test=opts.test||function(){
return true;
},loop=opts.loop||function(){
},end=opts.end||function(){
};
(function(){
var t=false,begin=new Date();
while(t=test()){
loop();
if(bulk===0||(new Date()-begin)>bulk){
break;
}
}
if(t){
setTimeout(arguments.callee,delay);
}else{
end();
}
})();
};
$.eachAsync=function(array,opts){
var i=0,l=array.length,loop=opts.loop||function(){
};
$.whileAsync($.extend(opts,{test:function(){
return i<l;
},loop:function(){
var val=array[i];
return loop.call(val,i++,val);
}}));
};
$.fn.eachAsync=function(opts){
$.eachAsync(this,opts);
return this;
};
})(jQuery);
var add="yes";
var fname="";
var browsername="IE";
var isNewVersion=false;
var versionLabelName="";
var lastSavedTime=null;
if(navigator.appName=="Netscape"){
browsername="MOZ";
}
var is_shared=false;
var panelOpenedFor="";
var agt=navigator.userAgent.toLowerCase();
var is_ie=((agt.indexOf("msie")!=-1)&&(agt.indexOf("opera")==-1));
var image_urls="";
var updatedSaveTime="";
function invoke(){
var w=495;
var h=515;
var jsp="feedback.do";
var _1220=findDocDim();
left=((_1220.width-w)/2);
atop=((_1220.height-h)/2)+65;
win=window.open(ctxpath+jsp,"_blank","width="+w+",height="+h+",left="+left+",top="+atop+",resizable=yes");
win.focus();
}
function createRequestObject(){
var _1221;
var _1222=navigator.appName;
if(_1222=="Microsoft Internet Explorer"){
try{
_1221=null;
}
catch(e){
}
if(_1221==null){
_1221=new ActiveXObject("Microsoft.XMLHTTP");
}
}else{
_1221=new XMLHttpRequest();
}
return _1221;
}
function stopEvent(ev){
if(is_ie){
ev.cancelBubble=true;
ev.returnValue=false;
}else{
ev.preventDefault();
ev.stopPropagation();
}
}
function autosave(_1224){
if((jsTRASH_VIEW)||(SAVED)||NOAUTOSAVE){
return;
}else{
if(jsREMOTE_SAVE_VIEW){
saveremoteGEdoc("autosave");
}else{
if(noOfUpdateRequestInProgress>0){
doAutoSave=true;
return;
}else{
AUTOSAVE=true;
savefile("autosave",_1224);
}
}
}
}
function errorAlert(_1225,_1226,_1227,_1228){
if(showErrorPanelMsg==_1226||_1228=="error"){
if(_1225!=null&&_1225!=""){
_1225=jsTitleMsg.Error+" "+_1225+": ";
}
handleServerError("ERROR",_1225+_1226,true);
}else{
if(_1227=="true"){
showBannerMessage(_1228.toUpperCase(),_1226);
}else{
if(cookieEnabled){
handleServerError("ERROR",jsMsg["ErrorPanel.MainContent"]+" "+jsTitleMsg.KindlyReopenFileAndTryAgain,true);
}
}
}
}
function openFileDialog(){
if(DOCUMENT_ID=="doc_id"){
FILEDIALOG.showOpenFileDialog("zohosheet","_self",allowToCreateNewDoc);
}else{
FILEDIALOG.showOpenFileDialog("zohosheet","_blank",allowToCreateNewDoc);
}
}
var noOfDigits=18;
function trimNameWithDots(name,_122a){
if(BAIHUIMODE){
noOfDigits=10;
}
if(typeof _122a=="undefined"){
_122a=noOfDigits;
}
if(typeof name!="undefined"&&name!=null){
if(name.length>_122a){
return name.substring(0,_122a-3)+"...";
}else{
return name;
}
}
}
function OpenRecDoc(docid){
if(DOCUMENT_ID=="doc_id"){
document.location.href=ctxpath+"open.do?docid="+docid;
}else{
window.open(ctxpath+"open.do?docid="+docid);
}
}
function saved(_122c,_122d,_122e,_122f,_1230){
savedFlag=true;
if(_122d>12000||_122d==0){
handleServerError("ERROR","ConnectionLost",true,true);
return;
}
if(_122d>=300){
errorAlert(_122d,_122e);
return;
}
if(_122c==null){
showAlertDialog(jsTitleMsg.UnabletoSaveDocuemnt+". "+jsTitleMsg.RefreshthePageAndTryAgain+".");
return;
}
if(!_122c.hasChildNodes()){
return;
}
var url=document.location.href;
if(url.lastIndexOf("?")>0){
var _1232=url.substring(url.lastIndexOf("/")+1,url.lastIndexOf("?"));
var _1233=url.substring(url.lastIndexOf("=")+1);
if(url.lastIndexOf("&")>0){
var _1234=url.substring(url.lastIndexOf("=")+1);
}
}else{
_1232=url.substring(url.lastIndexOf("/")+1);
}
var _1235;
var _1236;
var param="";
var _1238;
var _1239=false;
var _123a="";
if(_122c.firstChild.hasChildNodes()){
var _123b=_122c.firstChild.childNodes;
for(var x=0;x<_123b.length;x++){
node=_123b.item(x);
if(node.nodeName=="tagerror"){
if(node.firstChild.nodeValue!=""){
showAlertDialog(node.firstChild.nodeValue);
}
loadoff();
return;
}
if(node.nodeName=="error"&&showErrorPanelMsg==node.firstChild.nodeValue){
handleServerError("ERROR",node.firstChild.nodeValue,true);
loadoff();
return;
}else{
if(node.nodeName=="error"||node.nodeName=="warning"||node.nodeName=="info"){
var attrs=node.attributes;
var _123e="";
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="showInBanner"){
_123e=attr.nodeValue;
}
}
}
errorAlert("",node.firstChild.nodeValue,_123e,node.nodeName);
loadoff();
return;
}
}
if(node.nodeName=="ct"){
var _1241=node.firstChild.nodeValue;
if(_1241!=CURRENTTIME){
return;
}
}
if(node.nodeName=="document"){
_1236=node.firstChild.nodeValue;
if(_1236!=DOCUMENT_NAME&&_1230!="closeButton"){
_1239=true;
$("#fileName").text(_1236);
}
lastSavedTime=new Date();
DOCUMENT_NAME=_1236;
var attrs=node.attributes;
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="id"){
_1235=attr.nodeValue;
if(!isEditorClosed){
DOCUMENT_ID=attr.nodeValue;
}
PREV_DOCUMENT_ID=DOCUMENT_ID;
}else{
if(attr.nodeName=="sheetname"){
_1238=attr.nodeValue;
}else{
if(attr.nodeName=="docURL"){
DOCUMENT_NAME_URL=attr.nodeValue;
}else{
if(attr.nodeName=="bridgeNum"){
if(attr.nodeValue!=""&&attr.nodeValue!="null"){
bridgeNumber=attr.nodeValue;
}
}else{
if(attr.nodeName=="fileFormat"){
FILE_FORMAT=attr.nodeValue;
}else{
if(attr.nodeName=="lastModifiedDateTime"&&ENABLE_SAVE_MESSAGE){
updatedSaveTime=attr.nodeValue;
showSaveMessage("disable");
}
}
}
}
}
}
if(attr.nodeName=="isTemplateFlag"){
_123a=attr.nodeValue;
}
}
}
if(window.parentSandboxBridge){
window.parentSandboxBridge.SavedSuccessfully(DOCUMENT_ID);
}
}
if(node.nodeName=="param"){
var attrs=node.attributes;
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="val"){
param=attr.nodeValue;
}
}
}
}
}
}
if(_1230!="closeButton"&&!cdview){
updateDocTitle(_1236);
}
btn_disabled();
if(showPrevMessage){
var _1242=PREVIOUS_MESSAGE;
if(PREVIOUS_MESSAGE.indexOf(".")){
_1242=PREVIOUS_MESSAGE.split(".")[0];
}
if(_1242!=jsMsg.UpdatingWebdata){
setProgressMessage(PREVIOUS_MESSAGE,true);
}
}else{
if(ENABLE_SAVE_MESSAGE){
loadoff();
}
}
if(!ENABLE_SAVE_MESSAGE){
loadoff();
}
if(param=="autosave"||param=="importdoc"||param==""){
}else{
if(_1230=="closeButton"){
}else{
if(_1230=="sidebarDuplicate"){
sbduplicate();
closeDocumentInstance(false);
}else{
if(param=="unload"||param=="saveas"){
if(DOCUMENT_ID=="doc_id"){
loadDocument("ajaxnew.do");
}else{
NEWDOCNAME=_1236;
loadDocument(DOCUMENT_ID,NEWDOCNAME);
document.location.href=ctxpath+"open.do?docid="+DOCUMENT_ID;
}
}else{
if(param=="logout"){
document.location.href=ctxpath+"logout.do";
}else{
if(param!="org"&&param!="external"){
loadDocument(param,NEWDOCNAME);
}
}
}
}
}
}
if(!isEdit){
if(saveForward=="comments"){
showSheetComments();
saveForward="";
}else{
if(saveForward=="makepublishdialog"){
saveForward="";
makepublishdialog();
}else{
if(saveForward=="makepublicdialog"){
saveForward="";
makepublicdialog(param);
}else{
if(saveForward=="makepublic"){
saveForward="";
makepublic("Make Public","url");
}else{
if(saveForward=="showVersionDetails"){
saveForward="";
showVersionDetails();
}else{
if(saveForward=="showVersionDialog"){
saveForward="";
showVersionDialog("td_save");
}else{
if(saveForward=="viewVersion"){
saveForward="";
viewVersion();
}else{
if(saveForward=="rangepublish"){
saveForward="";
rangePublish();
}else{
if(saveForward=="showWebDataDialog"){
saveForward="";
showWebDataDialog();
}else{
if(saveForward=="showWebDataDetails"){
saveForward="";
showWebDataDetails();
}else{
if(saveForward=="showShare"){
saveForward="";
showShareDialog();
}else{
if(saveForward=="submitCell"){
saveForward="";
submitCell();
}else{
if(saveForward=="pasteCellsFromTextArea"){
saveForward="";
pasteCellsFromTextArea();
}else{
if(saveForward=="createPivot"){
saveForward="";
createPivot(createtype);
}else{
if(saveForward=="managePivot"){
saveForward="";
managePivot();
}else{
if(saveForward=="showRecordMacro"){
saveForward="";
showManageMacros("record");
}else{
if(saveForward=="showCreateMacro"){
saveForward="";
showManageMacros("create");
}else{
if(saveForward=="saveImage"){
saveForward="";
saveImage(ole.getCurrObj().id);
}else{
if(saveForward=="showVBAEditor"){
saveForward="";
showMacroEditorDialog(VBAEDITORMODULENAME,VBAEDITORLINENO,VBAEDITORMODULETYPE,VBAEDITORSHOW);
}else{
if(saveForward=="showShareSheet"){
saveForward="";
shareSheet();
}else{
if(saveForward=="Button.addButton"){
saveForward="";
Button.addButton();
}else{
if(saveForward=="insertHTML"){
saveForward="";
snippet.showEditor();
}else{
if(saveForward=="formatCells"){
saveForward="";
showFormatCellsDialog();
}else{
if(saveForward=="showDocsShare"){
saveForward="";
openShareDialog();
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
if(NOTIFY=="true"){
NOTIFY="false";
message(jsMsg.Loading,"block","...");
sheetopen("open");
}
if(INSERTIMAGE){
insertOrUploadImage(IMAGEOBJECT,XPOSITION,YPOSITION);
}
if(SET_LASTEDITED_DOCID&&DOCUMENT_ID!="doc_id"){
var dmn=document.domain;
dmn=dmn.substring(dmn.indexOf(".")+1,dmn.length);
set_cookie("ZS_DID",DOCUMENT_ID,null,null,dmn);
}
if(FROMEXPORT){
exportDoc(EXPORTTYPE,TEMPPRTVAR);
}
if(freezeStatus["saveBeforeFreeze"]){
var row=freezeStatus["ROW"];
var col=freezeStatus["COL"];
freezeStatus={};
freeze(row,col);
}
}
function btn_disabled(){
SAVED=true;
if(getObj("save")!=null){
$("#save").disable();
window.clearInterval(AUTO_SAVED);
}
if(ENABLE_SAVE_MESSAGE){
$("#save").disable();
showSaveMessage("disable");
}
if(jsREMOTE_SAVE_VIEW||isEdit){
if(getObj("save")!=null){
$("#save").disable();
}
if(ENABLE_SAVE_MESSAGE){
var _1246=getObj("save_message_display");
if(_1246){
_1246.style.display="";
}
}
window.clearInterval(AUTO_SAVED);
AUTO_SAVED=null;
}
$("#save").disable();
if(typeof ZohoMockup!="undefined"){
ZohoMockup.__sendRequest("onDocumentChange",{"result":!SAVED});
}
}
function btn_enabled(){
if(SAVED){
lastSavedTime=new Date();
}
if(isDocSaved()&&!isEditorClosed&&ALLOW_TO_WRITE){
AUTO_SAVED=window.setInterval("autosave()",60000);
if(getObj("save")!=null){
$("#save").enable();
}
SAVED=false;
if(!pivotSheet){
$("#save").enable();
}
if(typeof ZohoMockup!="undefined"){
ZohoMockup.__sendRequest("onDocumentChange",{"result":!SAVED});
}
}
isChangeMadeAfterScroll=true;
}
function save_enter(evt){
var code;
if(evt.which){
code=evt.which;
}else{
code=evt.keyCode;
}
if(code==13){
savefile_widget();
return false;
}else{
btn_enabled();
}
}
function savecsv(url,_124a){
var _124b=encodeURIComponent(CURRENTSHEETNAME);
var obj=document.forms.utilFORM;
obj.method="post";
obj.action=ctxpath+"export.do?csvmash=true&posturl="+url+"&module="+_124a+"&ftype=.csv"+"&docid="+DOCUMENT_ID+"&cursheet="+_124b+"&curtime="+CURRENTTIME;
getObj("utilFORMContainer").innerHTML="<input type='hidden' name='"+csrfParamName+"' value='"+csrfToken+"'>";
if(!isPublished){
obj.target="hid_imp_doc";
}
obj.submit();
}
var doSave=false;
var savingInProgress=false;
var saveParam=null;
function savefile(param,_124e,_124f){
if(savingInProgress){
return;
}
if(checkMacroTriggerObj["isMacroTrigger"]){
checkMacroTriggerObj["isAutoSaveForMacro"]=true;
return;
}
var _1250;
var _1251;
if(param=="template"){
_1250=param;
param="";
}else{
if(TEMPLATE_FLAG=="true"&&param=="autosave"){
_1250="template";
param="autosave";
}
}
try{
ZDBClientUI.saveAll();
}
catch(e){
}
if(!freezeStatus["saveBeforeFreeze"]&&getObj("openmessage").style.display!="none"){
return;
}
versionLabelName="";
if(!ALLOW_TO_WRITE){
return;
}
if(hasOleMoved){
var _1252={"method":savefile,"param1":param,"param2":_124e,"param3":_124f};
try{
ole.conf.onPositionChange(ole.getObjects(),"","","",_1252);
return;
}
catch(e){
hasOleMoved=false;
}
}
if(param!="autosave"&&(exprFieldKeyPressed||isCellEdited())){
doSave=true;
saveParam=param;
submitCell();
return;
}
if(param=="newVersion"){
SAVED=false;
isNewVersion=true;
param="";
versionLabelName=encodeURIComponent(getObj("versionLabel").value);
InfoBanner.showBanner(jsMsg["Version.infoMessage"],true,"info");
}else{
isNewVersion=false;
}
if(SAVED&&typeof param!="undefined"){
if(param==null||param==""){
return;
}
if(param=="importdoc"){
showImportDialog();
}else{
if(param=="unload"){
if(DOCUMENT_ID=="doc_id"){
loadDocument("ajaxnew.do");
}else{
loadDocument(DOCUMENT_ID,NEWDOCNAME);
}
}else{
if(param=="logout"){
document.location.href=ctxpath+"logout.do";
}else{
loadDocument(param,NEWDOCNAME);
}
}
}
return;
}
if(DEFAULT_FILENAME_FLAG&&param!="autosave"){
if($("#fileName").text()==jsMsg.BlankTemplateFilename&&TEMPLATE_FLAG=="true"){
var _1253=showPromptDialog(jsTitleMsg.NewTemplatePromptMsg,$("#fileName").text());
if(_1253!=null&&_1253!=""){
$("#fileName").text(_1253);
DEFAULT_FILENAME_FLAG=false;
_1250="template";
}
}
if($("#fileName").text()==DOC_NAME){
var _1253=showPromptDialog(jsTitleMsg["PromptMsg.SpreadsheetName"],$("#fileName").text());
if(_1253!=null&&_1253!=""){
$("#fileName").attr("value",_1253);
$("#fileName").text(_1253);
DEFAULT_FILENAME_FLAG=false;
}else{
return;
}
}
}
_1251=getObj("isDocTemplate").value;
if(_1251=="true"){
_1250="template";
}
var _1254=$("#fileName");
var _1255=_1254.text().trim();
if(cdview){
_1255=DOCUMENT_NAME;
}
if(_1254.length==0){
_1255=DOCUMENT_NAME;
}
if(_1254.length!=0&&(_1255==null||_1255=="")){
if(_1255==""){
showAlertDialog(jsTitleMsg["Rename.DocumentNameCannotBeEmpty"]);
}else{
showAlertDialog(jsTitleMsg["Rename.InvalidDocumentName"]);
}
$("#fileName").text(DOC_NAME);
if(!jsOPEN_DOC_VIEW){
DEFAULT_FILENAME_FLAG=true;
return;
}
}else{
if(jsTRASH_VIEW){
return;
}
var ftype=getObj("fileExt").value;
var _1257;
if(DOCUMENT_ID=="doc_id"||DOCUMENT_ID==null||DOCUMENT_ID=="undefined"){
add="yes";
_1257="doc_id";
}else{
add="no";
_1257=DOCUMENT_ID;
}
if(param==null){
param="";
}
if(isEdit&&!docView&&!cdview){
filename=$("#tempFileName").text();
}else{
filename=_1255;
}
var _1258="no";
if(DOCUMENT_ID!="doc_id"&&DOCUMENT_NAME!=filename){
_1258="yes";
}
if(_1258=="yes"||add=="yes"){
filename=replaceDisallowedCharsInDocName(filename);
}
filename=encodeURIComponent(filename.trim());
var _1259=getObj("loading");
if(_1259!=null){
if(showPrevMessage){
PREVIOUS_MESSAGE=_1259.innerHTML;
}
}
var _125a=currRow;
var _125b=currCol;
var _125c=getXYPositions();
var _125d=_125c.firstRow;
var _125e=_125c.firstCol;
var _125f=encodeURIComponent(CURRSHEETNAME);
var nvp="fname="+filename+"&fname1="+filename+"&ftype="+ftype+"&doc_id="+_1257+"&add="+add+"&param="+param+"&activesheet="+_125f+"&curtime="+CURRENTTIME+"&newVersion="+isNewVersion+"&versionLabel="+versionLabelName+"&reName="+_1258+"&docowner="+CURR_DOC_OWNERNAME+"&DOCUMENT_NAME_URL="+DOCUMENT_NAME_URL+"&isDocSaved="+SAVED;
if(_125a){
nvp+="&cursorRowIndex="+_125a;
}
if(_125b){
nvp+="&cursorColIndex="+_125b;
}
if(_125d){
nvp+="&positionBottom="+_125d;
}
if(_125e){
nvp+="&positionLeft="+_125e;
}
if(ISCOLLAB=="true"){
nvp+="&iscollab="+ISCOLLAB+"&currentuser="+CURRENTUSER;
}
nvp+="&collabid="+COLLAB_ID+"&afterRTC=false"+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING;
if(add=="yes"&&isEdit){
nvp+="&editorTags="+getObj("editorTags").value;
}
if(INTERNAL_VIEW){
nvp+="&view=internalView&serviceDocId="+serviceDocId+"&serviceDocVersion="+serviceDocVersion+"&servicePushFormat="+servicePushFormat;
}
if(_124e=="unload"){
nvp+="&isUnload=true";
}
ISCOLLAB="false";
if(jsSHARE_VIEW&&(SendModifyFeedMessage||isVersionPending)){
autoVersionDocument();
}
var _1261=new getXmlhttp();
if(isEdit&&_124e=="unload"){
_1261.open("POST",ctxpath+"save.do",false);
}else{
_1261.open("POST",ctxpath+"save.do",true);
}
_1261.onreadystatechange=function(){
if(_1261.readyState==4){
if(DOCUMENT_ID=="doc_id"){
filemenuwidget.showfilemenuoptions();
}
savingInProgress=false;
checkMacroTriggerObj["isAutoSaveForMacro"]=false;
var _1262="No";
if(_1258=="yes"||add=="yes"){
_1262="yes";
}
noOfUpdateRequestInProgress--;
saved(_1261.responseXML,_1261.status,_1261.statusText,_1262,param);
if(MACRO_DOC_SAVED){
MACROSAVED=true;
}
if(jsNEW_DOC_VIEW&&(docView||displayAll)){
if(Menu.newOptionsMenu!=undefined){
Menu.newOptionsMenu.data[20].disabled="false";
Menu.newOptionsMenu.data[21].disabled="false";
}
}
}
};
_1261.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
if(COLLAB_ID!=""){
is_shared=true;
}else{
is_shared=false;
}
var _1263=(zoid==-1&&isDocumentPublic)?!isDocumentSemiPublic:isDocumentPublic;
if(_1250=="template"){
nvp+="&is_public="+_1263+"&doc_url="+DOCUMENT_NAME_URL+"&is_shared=false&is_template=true";
}else{
nvp+="&is_public="+_1263+"&doc_url="+DOCUMENT_NAME_URL+"&is_shared="+is_shared;
}
nvp+="&rowHeight="+encodeURIComponent(getAryMetadata(rowHeightAry));
if(jsPUBLIC_VIEW){
nvp+="&isPublicEditDoc="+isPublicEditDoc;
}
if(_124f){
nvp+="&fromOpenDoc="+_124f;
}
if(savedFlag){
if(param!="autosave"&&savingInProgress){
return;
}
noOfUpdateRequestInProgress++;
sendXMLHTTPRequest(_1261,nvp,true);
savingInProgress=true;
if(ENABLE_SAVE_MESSAGE){
if(jsREMOTE_SAVE_VIEW){
getObj("loading").style.display="block";
showProgressMessage(jsMsg.Saving);
}else{
showProgressMessage(jsMsg.Saving);
}
}else{
getObj("loading").style.display="block";
}
}
IS_UNSAVED_SHEET=false;
}
}
function getAryMetadata(ary){
var ary=ary;
var _1265=ary[0];
var _1266=0;
var len=ary.length;
var _1268="[";
for(var i=1;i<len;i++){
if(_1265!=ary[i]){
_1268=_1268+"{ sr: "+_1266+", er:"+(i-1)+", v:"+_1265+"},";
_1265=ary[i];
_1266=i;
}
}
_1268=_1268+"{ sr: "+_1266+", er:"+(len-1)+", v:"+_1265+"}]";
return _1268;
}
function formatCell(_126a,_126b,_126c){
window.clearInterval(userpresenceintvl);
var _126d=getObj("formattedCellValue");
var _126e=0;
var _126f=0;
var _1270=0;
var _1271=0;
var _1272="";
_126d.value="";
if(READ_WRITE){
btn_enabled();
}
if(_126b>=300){
errorAlert(_126b,_126c);
return;
}
if(_126a==null||typeof _126a=="undefined"){
return;
}
if(!_126a.hasChildNodes()){
return;
}
if(_126a.firstChild.hasChildNodes()){
var _1273=_126a.firstChild.childNodes;
for(var x=0;x<_1273.length;x++){
node=_1273.item(x);
if(node.nodeName=="undo"){
updateUndoRangeJson(node.childNodes[0].nodeValue);
}else{
if(node.nodeName=="sheet"){
var _1275=node.attributes;
if(_1275!=null&&_1275.length>0){
for(var cnt=0;cnt<_1275.length;cnt++){
var _1277=_1275.item(cnt);
if(_1277.nodeName=="bridgeNum"){
if(_1277.nodeValue!=""&&_1277.nodeValue!="null"){
bridgeNumber=_1277.nodeValue;
}
}
}
}
if(node.hasChildNodes){
var _1278=node.childNodes;
for(var cnt=0;cnt<_1278.length;cnt++){
var cells=_1278.item(cnt);
if(cells.nodeName=="height"){
setRowsHeightAndModifyDOM(cells.childNodes[0].nodeValue);
focusSheet();
}
}
}
}else{
if(node.nodeName=="lock"){
var attrs=node.attributes;
var len=attrs.length;
var lock=false;
for(var i=0;i<len;i++){
var _1277=attrs.item(i);
switch(_1277.nodeName){
case "lock":
lock=_1277.nodeValue;
break;
case "username":
if(lock){
var _127e=replaceParams(jsMsg["Sorting.lock"],new Array(_1277.nodeValue));
showAlertDialog(_127e);
}
break;
}
}
}else{
if(node.nodeName=="conditionalformat"){
var robj=parseJSON(node.childNodes[0].nodeValue);
for(var y in robj){
updateCFChangesInHtmlClient(robj[y],false,encodeURIComponent(CURRSHEETNAME));
}
}
}
}
}
}
}
enableUNDO();
}
function restore(_1281){
var _1282=new getXmlhttp();
_1282.onreadystatechange=function(){
if(DOCUMENT_ID==_1281||_1281==0){
loadDocument(_1281);
}
};
sendXMLHTTPRequest(_1282,"docs="+_1281,true,true,ctxpath+"restore.do");
if(jsTRASH_VIEW&&(docView&&displayAll)){
window.location.reload();
}
}
function confirmTrashDelete(){
if(getObj("trashspan").innerHTML.trim()=="(0)"){
showAlertDialog(jsTitleMsg.TrashIsEmpty);
return;
}else{
var a=showConfirmDialog(jsTitleMsg.AreYouSureToEmptyTrash);
if(a){
trashdel(0);
}else{
return;
}
}
}
function confirmTrashRestore(){
if(getObj("trashspan").innerHTML.trim()=="(0)"){
showAlertDialog(jsTitleMsg.TrashIsEmpty);
return;
}else{
var a=showConfirmDialog(jsTitleMsg.AreYouSureToRestoreTrash);
if(a){
restoretrash("all");
}else{
return;
}
}
}
function restoretrash(docs){
var _1286=0;
var _1287=0;
var _1288=false;
if(docs=="all"){
var i=0;
while(getObj("trashdocs_"+i)){
var _128a=getObj("trashdocs_"+i);
if(_128a.value==DOCUMENT_ID){
_1288=true;
}
if(docs=="all"){
docs=_128a.value;
if(getObj("isTemplate-"+_128a.value).value==0){
_1286++;
}else{
_1287++;
}
}else{
docs=docs+","+_128a.value;
if(getObj("isTemplate-"+_128a.value).value==0){
_1286++;
}else{
_1287++;
}
}
i++;
}
}else{
if(docs="select"){
var i=0;
while(getObj("trashdocs_"+i)){
var _128a=getObj("trashdocs_"+i);
if(_128a.checked){
if(_128a.value==DOCUMENT_ID){
_1288=true;
}
if(docs=="select"){
docs=_128a.value;
if(getObj("isTemplate-"+_128a.value).value==0){
_1286++;
}else{
_1287++;
}
}else{
docs=docs+","+_128a.value;
if(getObj("isTemplate-"+_128a.value).value==0){
_1286++;
}else{
_1287++;
}
}
}
i++;
}
}
}
if(docs=="select"){
showAlertDialog(jsTitleMsg.SelectAtleastOneDocument);
return;
}
var _128b=new getXmlhttp();
_128b.onreadystatechange=function(){
if(_128b.readyState==4){
showTrashedSheets();
var _128c=getObj("mysheetspan");
var _128d=_128c.innerHTML;
var _128e=_128d.substring(_128d.indexOf("(")+1,_128d.length-1);
_128e=parseInt(_128e)+_1286;
_128c.innerHTML="("+_128e+")";
var _128f=getObj("mytemplatespan");
var _1290=_128f.innerHTML;
var _1291=_1290.substring(_1290.indexOf("(")+1,_1290.length-1);
_1291=parseInt(_1291)+_1287;
_128f.innerHTML="("+_1291+")";
if(_1288){
loadDocument(DOCUMENT_ID);
}
}
};
sendXMLHTTPRequest(_128b,"docs="+docs,true,true,ctxpath+"restore.do");
}
function selecttrashdel(){
var i=0,docs="";
while(getObj("trashdocs_"+i)){
if(getObj("trashdocs_"+i).checked){
if(docs=="select"){
docs=getObj("trashdocs_"+i).value;
}else{
docs=docs+","+getObj("trashdocs_"+i).value;
}
}
i++;
}
if(docs==""){
showAlertDialog(jsTitleMsg.SelectAtleastOneDocument);
return;
}
var _1294=new getXmlhttp();
_1294.onreadystatechange=function(){
if(_1294.readyState==4){
showTrashedSheets();
}
};
sendXMLHTTPRequest(_1294,"docs="+docs,true,true,ctxpath+"trashdel.do");
}
function trashdel(_1295){
var _1296=new getXmlhttp();
_1296.onreadystatechange=function(){
if(_1296.readyState==4){
var _1297=getObj("trashspan");
var _1298=_1297.innerHTML;
var _1299=_1298.substring(_1298.indexOf("(")+1,_1298.length-1);
_1299=parseInt(_1299)-1;
_1297.innerHTML="("+_1299+")";
showTrashedSheets();
if(DOCUMENT_ID==_1295||jsTRASH_VIEW){
loadDocument("ajaxnew.do");
}
}
};
sendXMLHTTPRequest(_1296,"docs="+_1295,true,true,ctxpath+"trashdel.do");
if(jsTRASH_VIEW&&(docView&&displayAll)){
loadDocument("ajaxnew.do");
}
}
function showDocName(_129a){
var fname;
if(_129a.lastIndexOf("/")!=-1){
fname=_129a.substring(_129a.lastIndexOf("/")+1,_129a.length);
}else{
fname=_129a.substring(_129a.lastIndexOf("\\")+1,_129a.length);
}
if(fname.indexOf(".")!=-1){
fname=fname.substring(0,fname.indexOf("."));
}
document.importDoc.docname.value=fname;
}
var xfile=null;
var importSubmitObj=null;
function importdoc(param,_129d,xurl){
if(!xurl){
var _129f=false;
importSubmitObj=getObj("importsubmit");
importSubmitObj.disabled=true;
importSubmitObj.className="button-disabled";
if((param!=null&&getObj("import").checked==true)||param=="import"){
xfile=getObj("xfile").value;
}else{
if(param!=null&&getObj("import_url").checked==true){
_129f=true;
xfile=encodeURIComponent(getObj("urlfile").value);
}
}
var _12a0="";
if(getObj("impfileName")){
_12a0=getObj("impfileName").value;
_12a0=replaceDisallowedCharsInDocName(_12a0);
_12a0=encodeURIComponent(_12a0);
}
if(xfile!=null){
xfile=xfile.trim();
}
if(xfile==null||xfile==""||xfile.indexOf(".")==-1){
showAlertDialog(jsTitleMsg.SelectAValidFile);
importSubmitObj.disabled=false;
importSubmitObj.className="button";
return false;
}else{
var ftype="";
var _12a2="";
if(xfile.indexOf("?")!=-1){
ftype=xfile.substring(xfile.lastIndexOf("."),xfile.lastIndexOf("?"));
_12a2="&"+xfile.substring(xfile.lastIndexOf("?")+1);
}else{
ftype=xfile.substring(xfile.lastIndexOf("."));
}
ftype=ftype.toLowerCase();
if(_129f||ftype==".ods"||ftype==".xls"||ftype==".sxc"||ftype==".csv"||ftype==".tsv"||ftype==".xlsx"){
document.importDoc.curtime.value=CURRENTTIME;
getObj("importdiv").style.display="inline";
}else{
showAlertDialog(replaceParams(jsTitleMsg.Wecurrentlydonotsupportfiles,new Array("'"+ftype+"'")));
importSubmitObj.disabled=false;
importSubmitObj.className="button";
return false;
}
var mode="normal";
importId=Math.floor(Math.random()*10001);
if((param!=null&&getObj("import").checked==true)||param=="import"){
obj=document.forms.importDoc;
obj.action=ctxpath+"import.do?doctimeinfo="+CURRENTTIME+"@"+DOCUMENT_ID+"&impdocName="+_12a0+"&mode="+mode+_12a2+"&importId="+importId;
message(jsMsg["Indication.Importing"],"block","...");
obj.submit();
}else{
if(param!=null&&getObj("import_url").checked==true){
obj=document.forms.importDoc;
obj.action=ctxpath+"import.do?doctimeinfo="+CURRENTTIME+"@"+DOCUMENT_ID+"&type=url&url="+xfile+"&impdocName="+_12a0+"&mode="+mode+_12a2+"&importId="+importId;
message(jsMsg["Indication.Importing"],"block","...");
obj.submit();
}
}
var _12a4=importId;
setTimeout(function(){
importTimeLimiter(_12a4);
},120000);
}
}else{
if(_129d!=""&&_129d!=null){
fileName=_129d;
}
importId=Math.floor(Math.random()*10001);
obj=document.forms.importDoc;
if(obj=="undefined"){
closeDialog();
}
obj.enctype="application/x-www-form-urlencoded";
obj.action=ctxpath+"import.do?doctimeinfo="+CURRENTTIME+"@"+DOCUMENT_ID+"&type=url&gurl="+encodeURIComponent(xurl)+"&name="+encodeURIComponent(fileName)+"&importId="+importId;
message(jsMsg["Indication.Importing"],"block","...");
closeDialog();
obj.submit();
}
}
function importTimeLimiter(param){
if(param==importId){
importId=null;
showAlertDialog(jsTitleMsg["Import.ExceedsLimit"]+jsTitleMsg.KindlyRefreshThePageAndTryAgain);
message("","none");
}
}
function proceedCsvImport(){
getObj("csvimportsubmit").disabled=true;
obj=document.forms.importDoc;
xfile=obj.xfile.value;
urltype=false;
if(obj.import_url.checked){
urltype=true;
xfile=encodeURIComponent(obj.urlfile.value);
}
var mode="normal";
var _12a7=getObj("tabular_data");
if(_12a7.checked){
mode="pivot";
}
if(urltype){
obj.action=ctxpath+"import.do?doctimeinfo="+CURRENTTIME+"@"+DOCUMENT_ID+"&type="+urltype+"&url="+xfile+"&mode="+mode;
}else{
obj.action=ctxpath+"import.do?doctimeinfo="+CURRENTTIME+"@"+DOCUMENT_ID+"&mode="+mode;
}
obj.submit();
}
function importfile(_12a8){
if(!_12a8){
return;
}
if(_12a8=="IMPORTDOC"){
return;
}
if(!isEdit){
getObj("importdiv").style.display="none";
closeDialog();
IMPORTDOC="IMPORTDOC";
loadDocument(_12a8,DOCUMENT_NAME);
}else{
loadDocument(_12a8,DOCUMENT_NAME);
}
}
function checksaved(param){
if(COLLAB_ID!=""&&COLLAB_ID!="null"){
Collaboration.quit(COLLAB_ID);
}
var _12aa=false;
if(jsSHARE_VIEW&&!ALLOW_TO_WRITE){
SAVED=true;
MACROSAVED=true;
RECORDINGMACRO=false;
}
if(!SAVED||!MACROSAVED||RECORDINGMACRO){
if(RECORDINGMACRO){
if(dottedProgressIntvl!=null){
clearTimeout(dottedProgressIntvl);
}
}
var _12ab;
if(pivotSheet){
_12ab=$("fileName").getAttribute("value");
}else{
_12ab=$("#fileName").text();
}
var a=showConfirmDialog(replaceParams(jsTitleMsg["Document.Save.ConfirmMessage"],new Array("'"+_12ab+"'")));
if(a){
savedFlag=true;
if(RECORDINGMACRO){
stopRecording("save",param);
}else{
if(!MACROSAVED&&!MACRO_DOC_SAVED){
saveMacro(false,"","",param);
}else{
MACROSAVED=true;
MACRO_DOC_SAVED=true;
DEFAULT_FILENAME_FLAG=false;
savefile(param);
}
}
_12aa=true;
}else{
SAVED=true;
MACROSAVED=true;
RECORDINGMACRO=false;
if(param=="importdoc"){
}else{
if(param=="unload"){
if(DOCUMENT_ID=="doc_id"){
loadDocument("ajaxnew.do");
}else{
loadDocument(DOCUMENT_ID,NEWDOCNAME);
}
}else{
if(param=="closeButton"){
}else{
if(param=="sidebarDuplicate"){
sbduplicate();
}else{
if(param=="logout"){
document.location.href=ctxpath+"logout.do";
}else{
loadDocument(param,NEWDOCNAME);
}
}
}
}
}
}
}else{
if(param=="logout"){
document.location.href=ctxpath+"logout.do";
}
}
}
function pausecomp(_12ad){
var date=(new Date()).getTime();
var _12af=null;
do{
_12af=(new Date()).getTime();
}while(_12af-date<_12ad);
}
function savefile_widget(){
if(TEMPLATE_FLAG=="true"){
savefile("template");
}else{
savefile();
}
return;
}
function resetPageDim(_12b0){
if(browser_ie&&IETRIDIENTVERSION<5){
return;
}
resetEditorDim(_12b0);
}
function resetEditorDim(_12b1){
var _12b2=(arguments[0]!=null)?arguments[0]:"";
resetHScrollDim(_12b1);
resetSheetsTabDim();
resetWorkSheetDim();
Print.resetPrintDim();
if(jsTHROWAWAY_VIEW){
return;
}
setTimeout(function(){
if(_12b2!="ONLY_WIDTH"){
DOC_PANEL.resetDocPanelDim();
}
},150);
}
function resetWorkSheetDim(){
var _12b3=getObj("sheetdiv");
if(isSSActive){
if(!isEditorClosed){
showHScrollbar();
}
if(!jsGADGET_VIEW&&getObj("eP").style.display=="none"){
hidePivotToolbars();
showSheetToolbars();
}
_12b3.style.width="";
_12b3.style.height="";
resetSheetDim();
}else{
if(pivotSheet){
resetAutoFormulas();
hideHScrollbar();
var _12b4=findClientDim();
_12b3.style.overflow="hidden";
_12b3.style.width=document.body.offsetWidth+"px";
_12b3.style.height=document.body.offsetHeight+"px";
var _12b5=18;
var width=_12b3.parentNode.offsetWidth;
var _12b7=_12b4.height-findPosY(_12b3)-_12b5-wmsBarHt-getObj("bottomBand").offsetHeight;
_12b3.style.width=width+"px";
_12b3.style.height=_12b7+"px";
_12b3.style.overflow="";
ZDBClientUI.resizeAllDInst();
}
}
}
function showSheetToolbars(){
getObj("eP").style.display="";
}
function registerIconEvents(_12b8){
for(var i=0;i<_12b8.length;i++){
var _12ba=_12b8[i].className;
if(_12ba=="icon"||_12ba=="iconText"||_12ba=="iconDropDown"||_12ba=="iconMore"){
_12b8[i].onmouseover=function(){
iconMouseOver(this);
};
_12b8[i].onmouseout=function(){
iconMouseOut(this);
};
_12b8[i].onmousedown=function(){
iconMouseDown(this);
};
_12b8[i].onmouseup=function(){
iconMouseUp(this);
};
}
}
}
function getIconBaseClass(icon){
if(jsGADGET_VIEW){
return;
}
if(typeof icon=="string"){
icon=getObj(icon);
}
if(icon!=null){
var _12bc=icon.className;
if(_12bc.indexOf(" ")>-1){
_12bc=_12bc.substr(0,_12bc.indexOf(" "));
}
return _12bc;
}
return "";
}
function getIconText(icon){
var span=icon.getElementsByTagName("SPAN");
if(span==0){
return "";
}else{
return span[0];
}
}
function getIconImg(icon){
var img=icon.getElementsByTagName("IMG");
if(img.length==0){
return "";
}else{
return img[0];
}
}
function iconMouseOver(icon){
if(icon==null){
return;
}
var _12c2=icon.getAttribute("iconType");
if(_12c2=="button"&&icon.getAttribute("iconDisabled")=="true"){
return;
}
var _12c3=getIconBaseClass(icon);
if(icon.className==_12c3+" pressed"){
return;
}
icon.className=_12c3+" hover";
if(_12c2=="dropdown"){
var _12c4=getObj(icon.getAttribute("relId"));
if(_12c4!=null){
_12c4.className=getIconBaseClass(_12c4)+" hover";
}
if(icon.getAttribute("displayState")!=null){
var _12c5=icon;
}else{
if(_12c4!=null&&_12c4.getAttribute("displayState")!=null){
var _12c5=_12c4;
}
}
}else{
if(icon.getAttribute("displayState")!=null){
var _12c5=icon;
}
}
if(typeof _12c5!="undefined"&&_12c5.getAttribute("displayState")=="disabled"){
var _12c6=getIconImg(_12c5);
if(_12c6!=""){
_12c6.src=IMAGE_PATH+_12c5.getAttribute("imgName")+".gif";
}
var _12c7=getIconText(_12c5);
if(typeof _12c7!="undefined"&&_12c7!=null&&_12c7!=""){
_12c7.className="";
}
}
}
function iconMouseOut(icon){
var _12c9=icon.getAttribute("iconType");
var _12ca=getIconBaseClass(icon);
if(icon.className==_12ca+" pressed"){
return;
}
icon.className=_12ca;
if(_12c9=="dropdown"){
var _12cb=getObj(icon.getAttribute("relId"));
if(_12cb!=null){
_12cb.className=getIconBaseClass(_12cb);
}
if(icon.getAttribute("displayState")!=null){
var _12cc=icon;
}else{
if(_12cb!=null&&_12cb.getAttribute("displayState")!=null){
var _12cc=_12cb;
}
}
}else{
if(icon.getAttribute("displayState")!=null){
var _12cc=icon;
}
}
if(typeof _12cc!="undefined"&&_12cc.getAttribute("displayState")=="disabled"){
var _12cd=getIconImg(_12cc);
if(_12cd!=""){
_12cd.src=IMAGE_PATH+_12cc.getAttribute("imgName")+"_disabled.gif";
}
var _12ce=getIconText(_12cc);
if(typeof _12ce!="undefined"&&_12ce!=null&&_12ce!=""){
_12ce.className="disabled";
}
}
}
function iconMouseDown(icon){
var _12d0=icon.getAttribute("iconType");
if(icon.id!="formatbrush"){
exitFormatPainter();
}
if(_12d0=="button"&&icon.getAttribute("iconDisabled")=="true"){
return;
}
var _12d1=getIconBaseClass(icon);
if(icon.className==_12d1+" pressed"){
return;
}
icon.className=_12d1+" mouseDown";
}
function iconMouseUp(icon){
var _12d3=icon.getAttribute("iconType");
if(_12d3=="button"&&icon.getAttribute("iconDisabled")=="true"){
return;
}
var _12d3=icon.getAttribute("iconType");
if(_12d3=="check"){
var _12d4=getIconBaseClass(icon);
if(icon.className!=_12d4+" pressed"){
icon.className=_12d4+" pressed";
}else{
icon.className=_12d4;
}
}
}
function saveas(_12d5,folid){
if($("#fileName")!=null){
var _12d7=getObj("saveAsFileName");
var _12d8=_12d7.value;
add="yes";
doc_id="doc_id";
param="saveas";
if(_12d8==null||_12d8.trim()=="null"||_12d8.trim()=="undefined"||_12d8.trim()==""){
showAlertDialog(jsTitleMsg["InvalidMsg.SpreadsheetName"]);
_12d7.focus();
return false;
}
_12d8=replaceDisallowedCharsInDocName(_12d8);
_12d8=encodeURIComponent(_12d8.trim());
var _12d9=encodeURIComponent(DOCUMENT_NAME);
var _12da=getObj("loading");
if(_12da!=null){
if(showPrevMessage){
PREVIOUS_MESSAGE=_12da.innerHTML;
}
}
setProgressMessage(jsMsg.Saving);
getObj("loading").style.display="block";
var nvp="fname="+_12d8+"&ftype="+getObj("fileExt").value+"&doc_id="+doc_id+"&add="+add+"&param="+param+"&activesheet="+CURRSHEETNAME+"&curtime="+CURRENTTIME+"&unlock="+DOCUMENT_ID+"&oldname="+_12d9+"&docowner="+CURR_DOC_OWNERNAME;
if(!isUndefined(folid)){
nvp+="&selectedFolderId="+folid;
}
var _12dc=new getXmlhttp();
_12dc.open("POST",ctxpath+"save.do",true);
_12dc.onreadystatechange=function(){
if(_12dc.readyState==4){
saved(_12dc.responseXML,_12dc.status,_12dc.statusText,add);
}
};
nvp+="&is_public=false&doc_url="+DOCUMENT_NAME_URL+"&is_shared=false&rowHeight="+encodeURIComponent(getAryMetadata(rowHeightAry));
_12dc.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
sendXMLHTTPRequest(_12dc,nvp,true);
closeDialog();
}
}
function saveas_enter(evt){
if(ALL_SHEET_SHARED){
if(window.event){
evt=window.event;
}
if(evt.keyCode==13){
saveas();
}
}
}
function markVersion_enter(evt){
var key;
if(window.event){
key=window.event.keyCode;
}else{
if(evt){
key=evt.which;
}
}
if(key==13){
savefile("newVersion");
$.sheetdialog.close("#sheetdialog");
}
}
var saveAsDialog="";
function showSaveAsDialog(srcEl,_12e1){
if(ALL_SHEET_SHARED){
if(saveAsDialog.length==0){
saveAsDialog=getObj("saveasdiv").innerHTML;
getObj("saveasdiv").innerHTML="";
}
showDialog(saveAsDialog,"position=absolute,srcElement="+srcEl+", title="+jsTitleMsg.SaveasDialogSpreadsheetTitle+",width=300, modal=yes",positionDialog);
if(getObj("saveAsFileName")){
getObj("saveAsFileName").value=(!_12e1)?$("#fileName").attr("value"):DOCUMENT_NAME;
getObj("saveAsFileName").focus();
getObj("saveAsFileName").select();
}
}
}
var versionDialog="";
function showVersionDialog(srcEl){
if(DOCUMENT_ID!="doc_id"){
if(!ALL_SHEET_SHARED){
showAlertDialog(jsTitleMsg.permissionToVersionDocumentMsg);
return;
}
if(versionDialog.length==0){
versionDialog=getObj("markeversiondiv").innerHTML;
}
getObj("markeversiondiv").innerHTML="";
$("#sheetdialog").html(versionDialog);
$.sheetdialog.open("#sheetdialog",{autoOpen:false,width:348,modal:true,resizable:false,title:jsTitleMsg["VersionDialog.CreateVersion"],buttons:[{text:jsMsg["VersionDialog.Create"],click:function(){
savefile("newVersion");
$.sheetdialog.close(this);
}},{text:jsTitleMsg["Cancel"],click:function(){
$.sheetdialog.close(this);
}}]});
fillVersionLabel();
}else{
saveForward="showVersionDialog";
savefilessamp();
}
}
function fillVersionLabel(){
if(getObj("versionLabel")){
getObj("versionLabel").value=$("#fileName").text();
getObj("versionLabel").focus();
getObj("versionLabel").select();
}
positionDialog();
}
function showVersionDetails(){
if(DOCUMENT_ID!="doc_id"){
if(ALL_SHEET_SHARED){
message(jsMsg.Loading,"block","...");
versionDetailsNo++;
var pos="absolute";
closeDialog();
$.sheetdialog.openURL(ctxpath+"pages/dialogs/versionviewdialog.jsp?docid="+DOCUMENT_ID+"&versionDetailsNo="+versionDetailsNo+"&allowRevert="+IS_REVERT_ALLOWED,{height:"auto",minWidth:700,minHeight:100,modal:true,title:jsTitleMsg.VersionHistory,maxHeight:$(window).height()/2,resizable:false});
}
}else{
saveForward="showVersionDetails";
savefilessamp();
}
}
function revertVersion(_12e4){
if(!ALL_SHEET_SHARED){
showAlertDialog(jsTitleMsg.permissionToRevertDocument);
return;
}
if(_12e4!="0"){
var a=showConfirmDialog(jsTitleMsg.TheDocumentWillRevertedTo+" '"+_12e4+"' "+jsTitleMsg.version+".\n"+jsTitleMsg.DoYouWantToContinueReversion);
if(!a){
return;
}
}
var nvp=("doc_id="+DOCUMENT_ID+"&docname="+DOCUMENT_NAME+"&version="+_12e4+"&mode=revert&docowner="+CURR_DOC_OWNERNAME+"&afterRTC=false&collabId="+COLLAB_ID+"&curtime="+CURRENTTIME);
if(_12e4=="0"||parseError){
nvp+="&parseerror=true";
}
importxml(ctxpath+"version.do",openRevertDocument,true,"POST",nvp);
$.sheetdialog.close("#sheetdialog");
}
function openRevertDocument(_12e7,_12e8,_12e9,val){
if(_12e7!=null&&_12e7.hasChildNodes()){
var _12eb=_12e7.childNodes;
if(_12eb.item(0).nodeName=="error"){
if(_12eb.item(0).childNodes[0].nodeValue=="INVALID_VERSION"){
showAlertDialog(jsMsg["Version.RevertVersionConflict"]);
}
}
}else{
btn_disabled();
loadDocument(DOCUMENT_ID,DOCUMENT_NAME);
}
}
function viewVersion(_12ec){
if(!ALL_SHEET_SHARED){
showAlertDialog(jsTitleMsg.permissionToViewVersionHistory);
return;
}
if(!_12ec){
_12ec=selVersion;
}else{
selVersion=_12ec;
}
if(!SAVED){
saveForward="viewVersion";
savefilessamp();
}else{
jsVERSION_VIEW=true;
$("#sp_docName").text($("#fileName").text());
if(_12ec!="currentversion"){
$("#filedetails .txtField").attr("id","sp_docName");
$("#filedetails .txtField").attr("onclick","");
loadDocument(DOCUMENT_ID,DOCUMENT_NAME,_12ec);
}else{
$("#filedetails .txtField").attr("id","fileName");
$("#filedetails .txtField").attr("onclick","setDocumentName");
document.location.href=ctxpath+"open.do?docid="+DOCUMENT_ID;
}
toolbarinited=false;
}
$.sheetdialog.close("#sheetdialog");
}
var selVersion;
function deleteVersion(_12ed){
if(!ALL_SHEET_SHARED){
showAlertDialog(jsTitleMsg.permissionToDeleteAVersion);
return;
}
var a=showConfirmDialog(" '"+_12ed+"' "+jsTitleMsg.versionDocumentWillDeleted+" \n"+jsTitleMsg.DoYouWantToContinueDeletion);
if(!a){
return;
}
if(jsVERSION_VIEW){
var _12ef=document.getElementById("versionSelect").selectedIndex;
var _12f0=document.getElementById("versionSelect").item(_12ef).value;
if(_12f0==_12ed){
selVersion=document.getElementById("versionSelect").item(_12ef-1).value;
var nvp=("doc_id="+DOCUMENT_ID+"&docname="+DOCUMENT_NAME+"&version="+_12ed+"&mode=delete&docowner="+CURR_DOC_OWNERNAME+"&curtime="+CURRENTTIME);
importxml(ctxpath+"version.do",viewVersion,true,"POST",nvp);
}else{
var nvp=("doc_id="+DOCUMENT_ID+"&docname="+DOCUMENT_NAME+"&version="+_12ed+"&mode=delete&docowner="+CURR_DOC_OWNERNAME+"&curtime="+CURRENTTIME);
importxml(ctxpath+"version.do",showVersionDetails,true,"POST",nvp);
}
}else{
var nvp=("doc_id="+DOCUMENT_ID+"&docname="+DOCUMENT_NAME+"&version="+_12ed+"&mode=delete&docowner="+CURR_DOC_OWNERNAME+"&curtime="+CURRENTTIME);
importxml(ctxpath+"version.do",showVersionDetails,true,"POST",nvp);
}
}
var importDialog="";
var exportOptions="";
var versionOptions="";
function showImportDialog(_12f2,_12f3,docId){
if((!SAVED||!MACROSAVED||RECORDINGMACRO)&&ALLOW_TO_WRITE){
checksaved("importdoc");
}
if((transMode==true)&&(messagetranslated==true)){
showURLInDialog(ctxpath+"pages/importdiv.jsp?csvmashup="+_12f2+"&currenttime="+_12f3+"&DOCUMENT_ID="+docId,"srcElement=td_import, position=absolute,title="+jsTitleMsg.Import+", modal=yes",positionDialog);
}else{
if(importDialog.length==0){
importDialog=getObj("importdiv").innerHTML;
getObj("importdiv").innerHTML="";
}
showDialog(importDialog,"position=absolute,width=500, title="+jsTitleMsg.Import+", modal=yes",positionDialog);
getObj("xfile").focus();
}
}
function initFormatOptions(){
try{
registerIconEvents(getObj("moreFormatOptions").getElementsByTagName("TD"));
}
catch(e){
}
}
function initDecimalOptions(){
try{
registerIconEvents(getObj("decimalOptions").getElementsByTagName("TD"));
}
catch(e){
}
}
var iconStyleOptions="";
function toogleIconStyle(type){
if(type=="icons"){
getObj("toolbar_icons").href="/styles/green/toolbar_icons_only.css?"+zs_version;
}else{
if(type=="text"){
getObj("toolbar_icons").href="/styles/green/toolbar_text_only.css?"+zs_version;
}else{
getObj("toolbar_icons").href="";
}
}
}
function blindDown(elId,_12f7,_12f8){
var el=getObj(elId);
el.style.overflow="hidden";
el.style.display="";
el.style.height="100%";
var elHt=el.offsetHeight;
el.style.height="1px";
el.style.display="";
if(typeof blindUpIntvl!="undefined"){
window.clearInterval(blindUpIntvl);
}
if(typeof blindDownIntvl!="undefined"){
window.clearInterval(blindDownIntvl);
}
if(typeof _12f8=="undefined"){
_12f8=1;
}
blindDownIntvl=window.setInterval("doBlindDown(\""+elId+"\", "+elHt+", "+_12f7+")",_12f8);
}
function doBlindDown(elId,elHt,_12fd){
var el=getObj(elId);
var ht=parseInt(el.style.height)+5;
if(ht>elHt-5){
ht=parseInt(el.style.height)+1;
}
if(ht<=elHt){
el.style.height=ht+"px";
}else{
el.style.height=elHt+"px";
window.clearInterval(blindDownIntvl);
if(typeof _12fd!="undefined"){
_12fd();
}
}
}
function blindUp(elId,_1301){
var el=getObj(elId);
el.style.display="";
if(typeof blindUpIntvl!="undefined"){
window.clearInterval(blindUpIntvl);
}
if(typeof blindDownIntvl!="undefined"){
window.clearInterval(blindDownIntvl);
}
blindUpIntvl=window.setInterval("doBlindUp(\""+elId+"\", "+_1301+")",1);
}
function doBlindUp(elId,_1304){
var el=getObj(elId);
var ht=parseInt(el.style.height)-4;
if(ht<4){
ht=parseInt(el.style.height)-1;
}
if(ht>0){
el.style.height=ht+"px";
}else{
el.style.height="0px";
el.style.display="none";
window.clearInterval(blindUpIntvl);
if(typeof _1304!="undefined"){
_1304();
}
}
}
var alphaVal=0;
function fadeIn(elId,intvl,_1309){
alphaVal=0;
var el=getObj(elId);
el.style.opacity=alphaVal;
el.style.filter="alpha(opacity="+alphaVal+")";
el.style.display="";
fadeInIntvl=window.setInterval("doFadeIn(\""+elId+"\", "+_1309+")",intvl);
}
function doFadeIn(elId,_130c){
var el=getObj(elId);
if(alphaVal<10){
el.style.filter="alpha(opacity="+(alphaVal*10)+")";
el.style.opacity=alphaVal/10;
alphaVal++;
}else{
el.style.filter="alpha(opacity=100)";
el.style.opacity=0.99;
window.clearInterval(fadeInIntvl);
if(typeof _130c!="undefined"){
_130c();
}
}
}
function fadeOut(elId,intvl,_1310){
alphaVal=9;
fadeOutIntvl=window.setInterval("doFadeOut(\""+elId+"\", "+_1310+")",intvl);
}
function doFadeOut(elId,_1312){
var el=getObj(elId);
if(alphaVal>0){
el.style.filter="alpha(opacity="+(alphaVal*10)+")";
el.style.opacity=(alphaVal/10);
alphaVal--;
}else{
alphaVal=0;
el.style.filter="alpha(opacity=0)";
el.style.opacity=0.01;
el.style.display="none";
window.clearInterval(fadeOutIntvl);
if(typeof _1312!="undefined"){
_1312();
}
}
}
function rate(){
var w=350;
var h=250;
var jsp="rate.jsp";
rateflag=true;
if(document.all){
left=(screen.width/2)-200;
atop=(screen.height/2)-200;
var rt="width="+w+",height="+h+",left="+left+",top="+atop+",resizable=yes";
win=window.open(ctxpath+"pages/"+jsp,"_blank",rt);
win.focus();
}else{
if(document.getElementById){
win=window.open(ctxpath+"pages/"+jsp,"_blank","width="+w+",height="+h+",resizable=yes");
win.focus();
win.moveTo((document.width/2)-235,(document.height/2)-130);
}
}
}
function viewExcelByURL(){
document.importUrl.action=ctxpath+"view.do?url="+document.importUrl.xurl.value;
}
var funcFocusFld="",currFocusFld="",isFuncDlgOpen=false;
var currFunValue;
function showFuncList(ev){
if(!isCellEdited()){
currFocusFld==exprField;
if(!browser_safari&&!browser_opera){
exprField.focus();
}
exprField.value="=";
if(currCell){
setCellContent(currCell,"=");
}
if(isEditingInExprField){
setCellContent(cellField,"=");
}
if(browser_safari||browser_opera){
setCaretPos(exprField,1);
}
funcFocusFld=exprField;
}else{
focusCellField("=");
funcFocusFld=currFocusFld;
}
if(funcFocusFld==exprField){
showURLInDialog(ctxpath+"pages/functions.jsp?viewType="+getObj("VIEW").value,"position=absolute, srcElement=Tv, title="+jsTitleMsg.InsertFunction+", width=290",positionDialog,"",closeFunctionDialog);
}else{
if(isCellEdited()){
var info=ActiveCellInfo;
var row=info.getEndRow();
var col=info.getEndCol();
var pos=getCellPosInPage(row,col);
showURLInDialog(ctxpath+"pages/functions.jsp?viewType="+getObj("VIEW").value,"position=absolute,left = "+pos.left+",top = "+pos.top+",title="+jsTitleMsg.InsertFunction+", width=290",positionDialog,"",closeFunctionDialog);
}else{
showURLInDialog(ctxpath+"pages/functions.jsp?viewType="+getObj("VIEW").value,"position=absolute, srcElement=Tv, title="+jsTitleMsg.InsertFunction+", width=290",positionDialog,"",closeFunctionDialog);
}
}
isFuncDlgOpen=true;
}
var prevFuncRow;
function hoverFunc(el){
if(typeof prevFuncRow=="undefined"){
prevFuncRow=el;
}else{
prevFuncRow.className="";
}
el.className="hover";
prevFuncRow=el;
}
function houtFunc(el){
el.className="";
}
function deSelectFunc(el){
getObj("funcSyntax").innerHTML="";
}
function selectFunc(el){
getObj("funcSyntax").innerHTML=el.getAttribute("funcSyntax");
var _1321=el.innerHTML;
}
function insertFunc(el){
if(isCellEdited()&&cellField.value.indexOf("=")==0){
if(!isUndefined(editedFormulaCellInfo.cellFieldDetails.CF_VALUE)){
var _1323=el.getAttribute("funcName")+"("+CURRSHEETNAME+"!)";
editedFormulaCellInfo.cellFieldDetails.appendSheetName=false;
}else{
var _1323=el.getAttribute("funcName")+"()";
}
var _1324=insertText(cellField,_1323);
var _1325=_1324+(_1323.length-1);
tempPos=_1325;
exprField.value=cellField.value;
var _1326="setCaretPos(cellField, "+_1325+")";
setTimeout(_1326,1);
setCellFieldWidth();
}else{
if(funcFocusFld==cellField&&isCellFieldSPANHided()){
funcFocusFld=exprField;
}
if(!isUndefined(editedFormulaCellInfo.cellFieldDetails.CF_VALUE)){
var _1323=el.getAttribute("funcName")+"("+CURRSHEETNAME+"!)";
editedFormulaCellInfo.cellFieldDetails.appendSheetName=false;
}else{
var _1323=el.getAttribute("funcName")+"()";
}
var _1324=insertText(exprField,_1323);
exprFieldKeyPressed=true;
isEditingInExprField=true;
var _1325=_1324+(_1323.length-1);
tempPos=_1325;
if(currCell&&!editedFormulaCellInfo.isOtherSheet){
setCellContent(currCell,exprField.value);
}
if(!isCellFieldSPANHided()&&!editedFormulaCellInfo.isOtherSheet){
setCellContent(cellField,exprField.value);
}
var _1326="setCaretPos(exprField, "+_1325+")";
setTimeout(_1326,1);
}
hideDialog();
resetFillRanges();
}
function savefilessamp(param){
var _1328=$("#fileName");
if(_1328!=null){
var _1329=$("#fileName").text();
if(_1329==null||_1329.trim()=="null"||_1329.trim()=="undefined"||_1329.trim()==""){
$("#fileName").text(DOC_NAME);
if(!jsOPEN_DOC_VIEW&&!(jsSHARE_VIEW&&!READ_WRITE)){
DEFAULT_FILENAME_FLAG=true;
}
}
if(DEFAULT_FILENAME_FLAG){
if($("#fileName").text()==DOC_NAME){
var _132a=showPromptDialog(jsTitleMsg.TheSpreadsheetIsNotYetSaved+" "+jsTitleMsg.KindlySaveAndContinue,$("#fileName").text());
if(_132a==null||_132a==""){
saveForward="";
return;
}
$("#fileName").text(_132a);
DEFAULT_FILENAME_FLAG=false;
}
}
if((jsSHARE_VIEW&&!READ_WRITE)||(jsTRASH_VIEW)){
return;
}
var ftype=getObj("fileExt").value;
var _132c;
if(DOCUMENT_ID=="doc_id"||DOCUMENT_ID==null||DOCUMENT_ID=="undefined"){
add="yes";
_132c="doc_id";
}else{
add="no";
_132c=DOCUMENT_ID;
}
if(param==null||param=="undefined"){
param="";
}
filename=encodeURIComponent($("#fileName").text());
showProgressMessage(jsMsg.Saving);
var nvp="fname="+filename+"&ftype="+ftype+"&doc_id="+_132c+"&add="+add+"&param="+param+"&activesheet="+CURRSHEETNAME+"&curtime="+CURRENTTIME+"&docowner="+CURR_DOC_OWNERNAME;
var _132e=new getXmlhttp();
_132e.open("POST",ctxpath+"save.do",true);
_132e.onreadystatechange=function(){
if(_132e.readyState==4){
saved(_132e.responseXML,_132e.status,_132e.statusText,add);
}
};
if(COLLAB_ID!=""){
is_shared=true;
}else{
is_shared=false;
}
var _132f=(zoid==-1&&isDocumentPublic)?!isDocumentSemiPublic:isDocumentPublic;
nvp+="&is_public="+_132f+"&doc_url="+DOCUMENT_NAME_URL+"&is_shared="+is_shared+"&rowHeight="+encodeURIComponent(getAryMetadata(rowHeightAry));
_132e.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
sendXMLHTTPRequest(_132e,nvp,true);
_1328=null;
}else{
return 0;
}
}
function initBottomBand(){
if(jsGADGET_VIEW){
return;
}
if(browser_ie||browser_ff3){
resetSheetsTabDim();
}else{
setSheetsTabDim();
}
registerStatusBarTools();
}
function import_check(id){
if(id=="import_url"){
getObj("xfile").disabled=true;
getObj("urlfile").disabled=false;
setCaretPos(getObj("urlfile"),"END");
}else{
if(id=="import"){
getObj("urlfile").disabled=true;
getObj("xfile").disabled=false;
setCaretPos(getObj("xfile"),"END");
}else{
if(id=="remote_url"){
getObj("xfile").disabled=true;
getObj("urlfile").disabled=true;
getObj("content").disabled=false;
setCaretPos(getObj("content"),"END");
}
}
}
}
function remove_sharing(id,owner,_1333,_1334){
bool=showConfirmDialog(jsTitleMsg.AreYouSureToRemoveSharedDocument);
if(bool){
var _1335=new getXmlhttp();
_1335.onreadystatechange=function(){
if(_1335.readyState==4){
if(_1333==DOCUMENT_ID){
loadDocument("ajaxnew.do");
}
}
};
sendXMLHTTPRequest(_1335,"id="+id+"&owner="+owner+"&doc_id="+_1333+"&docname="+encodeURIComponent(DOCUMENT_NAME),true,true,ctxpath+"removeshare.do");
}
}
function autoVersionDocument(){
var nvp=("doc_id="+DOCUMENT_ID+"&docname="+DOCUMENT_NAME+"&mode=autoVersion&docowner="+CURR_DOC_OWNERNAME+"&viewType="+getViewType());
importxml(ctxpath+"version.do",dummy,true,"POST",nvp);
SendModifyFeedMessage=false;
isVersionPending=false;
}
function dummy(){
}
function getCurrentDocumentId(){
return DOCUMENT_ID;
}
function getCurrentDocumentName(){
return DOCUMENT_NAME;
}
function getCurrentSheetName(){
return CURRSHEETNAME;
}
function saveDocument(_1337){
if(!SAVED){
if(typeof _1337=="undefined"){
_1337=getCurrentDocumentName();
}
if(_1337.indexOf("Untitled")!=-1||_1337==""){
if(jsNEW_DOC_VIEW){
_1337=showPromptDialog(jsTitleMsg["PromptMsg.SpreadsheetName"],_1337);
}
}
if(_1337==null||_1337.trim()=="null"||_1337.trim()=="undefined"||_1337.trim()==""){
_1337="";
}
if(_1337!=""){
getObj("tempFileName").value=_1337;
savefile();
}
}
}
var IS_SAVEAS=false;
function saveremoteGEdoc(param,_1339,_133a){
if(!ALLOW_TO_WRITE||savingInProgress){
return;
}
if(hasOleMoved){
var _133b={"method":saveremoteGEdoc,"param1":param,"param2":_1339,"param3":_133a};
try{
ole.conf.onPositionChange(ole.getObjects(),"","","",_133b);
return;
}
catch(e){
hasOleMoved=false;
}
}
if(param!="autosave"&&(exprFieldKeyPressed||isCellEdited())){
submitCell();
doAutoSave=true;
return;
}
if(jsREMOTE_SAVE_VIEW){
ENABLE_SAVE_MESSAGE=false;
}
if(param!="autosave"&&forceSaveAs&&forceSaveAs!="null"){
saveAsRemoteDoc();
return;
}
var _133c=false;
if(typeof _1339=="undefined"||_1339==null){
_133c=SAVED;
}else{
IS_SAVEAS=true;
_133c=false;
}
if(!savingInProgress||_133a){
if(DOCUMENT_NAME.trim()==""&&param!="autosave"){
if(ISGEEDITOR){
showURLInDialog(ctxpath+"pages/gesavepopup.jsp?&handbackId="+HANDBACK_ID,"width = 450, height = 425, position=absmiddle, top = 15, closeOnEscKey=yes, modal=yes,title=Save");
return;
}else{
showDialog(getSaveDialogHTML(),"position=absmiddle,top=-100,title=Save,width=300, modal=yes");
var _133d=getObj("save_docName");
if(_133d!=null){
_133d.focus();
_133d.select();
}
return false;
}
}
var nvp="doc="+DOCUMENT_ID+"&uname="+RMUSER+"&autosave="+param;
if(USERSTATEID!=""){
nvp+="&userStateId="+USERSTATEID;
}
if(_133a){
nvp+="&action=saveas";
}
if(param!="autosave"){
if(IS_SAVEAS){
showProgressMessage(replaceParams(jsMsg["RemoteEditor.SaveAs.StatusMessage"],new Array(_1339.toUpperCase())));
nvp+="&pushFormat="+_1339;
}else{
if(ENABLE_SAVE_MESSAGE){
showSaveMessage("enable");
}else{
setProgressMessage(jsMsg.Saving,false);
showProgressMessage();
}
}
}
nvp+="&isDocSaved="+isDocSaved();
var _133f=new getXmlhttp();
_133f.open("POST",ctxpath+"remotedocSave.do",true);
_133f.onreadystatechange=function(){
if(_133f.readyState==4){
noOfUpdateRequestInProgress--;
savingInProgress=false;
if(param=="autosave"){
switchRemoteSheet();
return;
}else{
var resp=_133f.responseText;
if(resp!=null&&resp.trim()!=""){
if(resp.trim()!="AgentSave"){
if(_133f.responseXML&&_133f.responseXML.hasChildNodes()){
var _1341=_133f.responseXML.firstChild.childNodes;
for(var x=0;x<_1341.length;x++){
node=_1341.item(x);
if(node.nodeName=="error"&&showErrorPanelMsg==node.firstChild.nodeValue){
handleServerError("ERROR",node.firstChild.nodeValue,true);
loadoff();
return;
}else{
if(node.nodeName=="error"||node.nodeName=="warning"||node.nodeName=="info"){
var attrs=node.attributes;
var _1344="";
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="showInBanner"){
_1344=attr.nodeValue;
}
}
}
errorAlert("",node.firstChild.nodeValue,_1344,node.nodeName);
loadoff();
return;
}
}
}
}
try{
if(resp.indexOf("error.jsp")!=-1){
showURLInDialog(resp,"position=absmiddle, closeOnEscKey=yes, modal=yes",positionDialog);
setTimeout("hideProgressMessage()",0);
}else{
var _1347=eval("({"+resp+"})");
if(_1347.msg!=null&&_1347.msg.trim()!=""&&_1347.msg.trim()!="null"){
if(ENABLE_SAVE_MESSAGE){
var _1348=getObj("save_message_display");
if(_1348){
_1348.innerHTML=_1347.msg+"...";
_1348.style.display="block";
}
}else{
setProgressMessage(_1347.msg,true);
showProgressMessage();
}
setTimeout("hideProgressMessage()",2000);
setTimeout(function(){
if(_1347.status=="success"){
btn_disabled();
}
},500);
}else{
setTimeout("hideProgressMessage()",0);
}
if(typeof ZohoMockup!="undefined"){
if(intercomSaveProgress){
sendSaveConfirmation(((_1347.status=="success")?"200":"500"),_1347.msg);
intercomSaveProgress=false;
}
}
}
}
catch(e){
hideProgressMessage();
}
}
}else{
hideProgressMessage();
}
}
}
};
noOfUpdateRequestInProgress++;
_133f.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
savingInProgress=true;
_133f.send(nvp);
}
}
function saveremoteDraft(){
Collaboration.quit(COLLAB_ID);
var _1349=new getXmlhttp();
_1349.open("POST",ctxpath+"remotedraftSave.do",false);
_1349.onreadystatechange=function(){
if(_1349.readyState==4){
}
};
_1349.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var _134a="doc="+DOCUMENT_ID+"&uname="+RMUSER+"&autosave=savedraft";
if(USERSTATEID!=""){
_134a+="&userStateId="+USERSTATEID;
}
_1349.send(_134a);
}
function switchRemoteSheet(){
if(NOTIFY=="true"){
NOTIFY="false";
message(jsMsg.Loading,"block","...");
sheetopen("open");
}
window.clearInterval(AUTO_SAVED);
AUTO_SAVED=null;
if(freezeStatus["saveBeforeFreeze"]){
var row=freezeStatus["ROW"];
var col=freezeStatus["COL"];
freezeStatus={};
freeze(row,col);
}
}
function deleteremotedoc(){
if(!jsREMOTE_SAVE_VIEW&&!jsREMOTE_VIEW){
return;
}
var _134d=new getXmlhttp();
var _134e="doc="+DOCUMENT_ID;
if(RMUSER!=null){
_134e+="&uname="+RMUSER;
}
if(USERSTATEID!=""){
_134e+="&userStateId="+USERSTATEID;
}
if(COLLAB_ID!=""){
_134e+="&collabId="+COLLAB_ID;
}
_134d.open("GET",ctxpath+"remotestatedelete.do?"+_134e,false);
_134d.onreadystatechange=function(){
if(_134d.readyState==4){
var msg=_134d.responseText;
}
};
_134d.send(null);
}
function validateEmail(email,_1351){
if(typeof _1351=="undefined"){
_1351=true;
}
email=trimString(email);
if(email==""){
return jsTitleMsg.PleaseEnterEmailAddress;
}
var ef=/^.+@.+\..{2,4}$/;
if(!_1351){
ef=/^.+@.+\..{2,200}$/;
}
if(!(ef.test(email))){
return jsTitleMsg.PleaseEnterValidEmailAddress;
}
var ic=/[\(\)\<\>\,\;\:\\\/\"\[\]]/;
if(email.match(ic)){
return jsTitleMsg.PleaseEnterValidEmailAddress;
}
return null;
}
function trimString(str){
str=str.replace(/^\s+/g,"");
return str.replace(/\s+$/g,"");
}
function isNotificationAllowed(){
if(cdview){
return false;
}
return true;
}
var notifierHTML="";
function notify(_1355,msg,_1357,_1358,left,top,_135b){
if(isNotificationAllowed()){
if(typeof _1357=="undefined"||DISABLECHAT){
_1357="";
}
if(typeof _1355=="undefined"){
_1355="info";
}
if(notifierHTML==""){
var _135c=new getXmlhttp();
var _135d="msg="+msg+"&moreInfo="+escape(_1357)+"&msgType="+_1355;
_135c.open("POST",ctxpath+"pages/notifier.jsp",true);
_135c.onreadystatechange=function(){
if(_135c.readyState==4){
notifierHTML=_135c.responseText;
var dv=document.createElement("DIV");
dv.id="notifierContainer";
dv.position="absolute";
dv.top="-3000px";
dv.left="-3000px";
dv.innerHTML=notifierHTML;
document.body.appendChild(dv);
getObj("notifyMessage").innerHTML=msg;
getObj("notifyMoreInfo").innerHTML=_1357;
showNotifier(_1358,left,top,_135b);
}
};
_135c.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
sendXMLHTTPRequest(_135c,_135d,true,false);
}else{
var _135f=true;
var _1360=getObj("notifier");
if(_1360!=null&&_1360.style.display=="none"){
_135f=false;
_1360.style.display="";
}
getObj("notifyMessage").innerHTML=msg;
getObj("notifyMoreInfo").innerHTML=_1357;
if(_1355=="chat"){
_1355="chat_big";
}
if(!_135f){
showNotifier(_1358,left,top,_135b);
}
}
}
}
var isNotifierFocussed;
function showNotifier(_1361,left,top,_1364){
var _1365=getObj("notifierPtr");
if(_1365!=null){
_1365.style.display="none";
}
var _1366=getObj("notifier");
var _1367=_1366.offsetHeight;
var _1368=_1366.offsetWidth;
if(typeof _1361=="undefined"){
notifierTop=findPosY(getObj("bottomBand"))-_1367;
_1366.style.left=(findDocDim().width-_1368-20)+"px";
_1366.style.top=(findDocDim().height+5)+"px";
}else{
var _1369=getObj(_1361);
var _136a=findPosX(_1369);
if(typeof left!="undefined"){
if(browser_ie){
left=parseInt(left)+2;
}
_136a=(_136a+parseInt(left));
}
notifierTop=findPosY(_1369)-_1367-10;
if(typeof top!="undefined"){
notifierTop=(notifierTop+parseInt(top));
}
_1366.style.left=_136a+"px";
_1366.style.top=(findDocDim().height+5)+"px";
}
if(slideInNotifierIntvl){
window.clearInterval(slideInNotifierIntvl);
}
slideInNotifierIntvl=window.setInterval("slideInNotifier("+_1361+", "+_1364+")",1);
}
var notifierTop=0;
var slideInNotifierIntvl;
function slideInNotifier(_136b,_136c){
var _136d=getObj("notifier");
if(_136d!=null){
var _136e=getObj("notifierPtr");
var top=parseInt(_136d.style.top);
var diff=top-notifierTop;
var _1371=(diff<5)?1:5;
if(top>notifierTop){
_136d.style.top=(top-_1371)+"px";
}else{
window.clearInterval(slideInNotifierIntvl);
_136d.style.top=(notifierTop)+"px";
if(typeof _136b!="undefined"&&_136e!=null){
_136e.style.display="";
}
if(typeof _136c!="undefined"){
_136c();
}
window.setTimeout("hideNotifier()",10000);
}
}
}
function hideNotifier(){
var _1372=findDocDim().height;
if(slideDownNotifierIntvl){
window.clearInterval(slideDownNotifierIntvl);
}
slideDownNotifierIntvl=window.setInterval("slideDownNotifier("+_1372+")",1);
}
var slideDownNotifierIntvl;
function slideDownNotifier(_1373){
if(!isNotifierFocussed){
var _1374=getObj("notifierPtr");
if(_1374!=null&&_1374.style.display==""){
_1374.style.display="none";
}
var _1375=getObj("notifier");
var top=parseInt(_1375.style.top);
if(top<_1373){
_1375.style.top=(top+2)+"px";
}else{
window.clearInterval(slideDownNotifierIntvl);
closeNotifier();
}
}
}
function closeNotifier(){
var _1377=getObj("notifier");
if(_1377!=null){
_1377.style.display="none";
}
}
function recalculate(nvp,_1379){
if(typeof _1379=="undefined"){
_1379="false";
}
if(typeof nvp=="undefined"){
nvp="";
}else{
nvp+="&";
}
showProgressMessage(jsMsg.Recalculating);
var url=ctxpath+"getFormulas.do";
var _137b=new getXmlhttp();
_137b.open("POST",url,true);
_137b.onreadystatechange=function(){
if(_137b.readyState==4){
loadFormulas(_137b.responseText,"RECALCULATE");
}
};
var _137c=encodeURIComponent(CURRSHEETNAME);
_137b.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var _137d=true;
if(jsPUBLIC_VIEW){
nvp+="&loadObject="+LOAD_OBJECT_IN_PUBLIC;
if(!showFormulas){
_137d=false;
}
}
nvp+="&docid="+DOCUMENT_ID+"&curtime="+CURRENTTIME+"&sheetname="+_137c+"&action=RECALCULATE"+"&docowner="+CURR_DOC_OWNERNAME;
nvp+="&bridgeNo="+bridgeNumber+"&isStockConfigured="+isStockConfigured+"&isDocSaved="+SAVED+"&viewType="+getViewType()+"&showFormulas="+_137d;
nvp+="&usedCursRow="+usedCursRow+"&usedCursCol="+usedCursCol;
nvp+="&collabid="+COLLAB_ID+"&afterRTC="+_1379+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING;
if(jsREMOTE_SAVE_VIEW){
nvp+="&RMLOGINNAME="+RMUSER;
}
nvp+="&availableStartRow="+getAvailableStartRow();
nvp+="&availableEndRow="+getAvailableEndRow();
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols;
sendXMLHTTPRequest(_137b,nvp,true,false);
if(_1379=="false"){
closeDialog();
}
}
function isCellEdited(){
return (!isEditingInExprField&&!isCellFieldSPANHided());
}
function addSelectOptions(_137e,text,value,id,title){
if(typeof _137e=="undefined"||_137e==null){
return;
}
var _1383=document.createElement("OPTION");
if(typeof text!="undefined"){
_1383.text=text;
}
if(typeof value!="undefined"){
_1383.value=value;
}
if(typeof id!="undefined"){
_1383.id=id;
}
if(typeof title!="undefined"){
_1383.title=title;
}
if(typeof _137e!="undefined"){
_137e.options.add(_1383);
}
}
function removeSelectOptions(_1384,index){
if(typeof _1384=="undefined"||_1384==null){
return;
}
if(index=="ALL"){
for(i=_1384.length-1;i>=0;i--){
_1384.remove(i);
}
}else{
if(typeof index!="undefined"){
_1384.remove(index);
}
}
}
function encodeHtml(str){
str=replace(str,"<","&lt;");
str=replace(str,">","&gt;");
return str;
}
function initSwitchOptions(){
try{
registerIconEvents(getObj("switchMenuOptions").getElementsByTagName("TD"));
}
catch(e){
}
}
function toggleSwitchTo(id,disp){
getObj(id).style.display=disp;
}
var exportmydocsOptions="";
var exportsrchdocsOptions="";
var exportshrdocsOptions="";
function showExportDocOptions(val){
if(val=="mydocs"){
if(exportmydocsOptions.length==0){
exportmydocsOptions=getObj("exportmydocsdiv").innerHTML;
getObj("exportmydocsdiv").innerHTML="";
}
showDialog(exportmydocsOptions,"position=relative, closeButton=no, closeOnBodyClick=yes");
}
if(val=="srchdocs"){
if(exportsrchdocsOptions.length==0){
exportsrchdocsOptions=getObj("exportsrchdocsdiv").innerHTML;
getObj("exportsrchdocsdiv").innerHTML="";
}
showDialog(exportsrchdocsOptions,"position=relative, closeButton=no, closeOnBodyClick=yes");
}
if(val=="shrdocs"){
if(exportshrdocsOptions.length==0){
exportshrdocsOptions=getObj("exportshrdocsdiv").innerHTML;
getObj("exportshrdocsdiv").innerHTML="";
}
showDialog(exportshrdocsOptions,"position=relative, closeButton=no, closeOnBodyClick=yes");
}
}
function deleteDocs(){
var val="";
var _138b="";
var i=0,_138d=false;
docids="";
while(true){
var elm=document.getElementById(val+"_"+i);
if(elm==null){
break;
}
if(elm.checked){
_138d=true;
if(docids==""){
docids=elm.value;
}else{
docids=docids+","+elm.value;
}
}
i++;
}
closeDialog();
if(!_138d){
showAlertDialog(jsTitleMsg.SelectAtleastOneDocument);
return;
}
if(del){
var _138f=docids.split(",");
deletedoc(docids,_138b);
}
}
var bgarr=new Array();
var elemsarr=new Object();
var elemsarrIndex=0;
var fadeStatus=true;
function fadeCells(_1390,_1391,_1392){
var cid=parseInt(_1390);
var _1394=_1391;
var _1395=new Array();
if(cid==StartFadeAt&&!fadeStatus){
elemsarr[_1394]=null;
if(elemsarrIndex>_1394){
elemsarrIndex=_1394;
}
return;
}
if(cid<=StartFadeAt){
fadeStatus=false;
}
if(cid==0){
fadeStatus=true;
}
var _1396=elemsarr[_1394];
if(typeof _1396!="undefined"&&typeof _1392=="undefined"){
for(i=0;i<_1396.length;i++){
var bgclr=_1396[i].style.backgroundColor;
if(!bgclr){
bgclr="rgb(255,255,255)";
}
_1395[i]=bgclr;
bgarr[_1394]=_1395;
}
}else{
_1395=bgarr[_1394];
}
if(cid>=1){
if(typeof _1396!="undefined"){
for(i=0;i<_1396.length;i++){
if(_1396[i]!=null&&_1396[i]!=""){
elem=_1396[i];
elem.style.backgroundColor=getColor(_1395[i])+FadeSteps[cid];
if(cid==1){
elem.style.backgroundColor="";
if(_1395[i]!="rgb(255,255,255)"){
elem.style.backgroundColor=_1395[i];
}else{
elem.style.backgroundColor="";
}
}
}
}
}
cid--;
setTimeout("fadeCells("+cid+","+_1394+","+_1394+")",FadeInterval);
}else{
elemsarr[_1394]=null;
if(elemsarrIndex>_1394){
elemsarrIndex=_1394;
}
}
}
getCellPosInPage=function(row,col){
var left=findPosX(sheet);
var top=findPosY(sheet);
left+=getColLeft(col);
top+=getRowTop(row)+getRowHeight(row);
if(col>=FREEZED_COL){
left-=getSheetScrollLeft();
}
if(row>=FREEZED_ROW){
top-=getSheetScrollTop();
}
return {left:left,top:top};
};
function getCurrentSelection(){
if(isCellRange()){
var _139c=getCellRange();
if(isWholeSheetSelected()){
return getCellLabel(0,0)+":"+getCellLabel((getRowMax()-1),(getColMax()-1));
}else{
if(isRowSelected()){
return getCellLabel(_139c.startRow,0)+":"+getCellLabel(_139c.endRow,(getColMax()-1));
}else{
if(isColSelected()){
return getCellLabel(0,_139c.startCol)+":"+getCellLabel((getRowMax()-1),_139c.endCol);
}else{
return getCellLabel(_139c.startRow,_139c.startCol)+":"+getCellLabel(_139c.endRow,_139c.endCol);
}
}
}
}else{
var info=ActiveCellInfo;
if(info){
var row=info.getStartRow();
var col=info.getStartCol();
if(!info.isMerged()){
if(!isUndefined(row)&&!isUndefined(col)){
return getCellLabel(row,col);
}
}else{
var _13a0=info.getEndRow();
var _13a1=info.getEndCol();
if(!isUndefined(_13a0)&&!isUndefined(_13a1)){
return getCellLabel(row,col)+":"+getCellLabel(_13a0,_13a1);
}
}
}
}
return "";
}
function menuClose(ev){
var el=(browser_ie)?window.event.srcElement:ev.target;
if(el.title=="Click and translate..."){
return false;
}
}
function scrollToView(id){
var el=document.getElementById(id);
var top=parseInt(findPosY(el));
var _13a7=el.offsetHeight;
var _13a8=document.body.clientHeight;
var _13a9=document.body.scrollTop;
if(top-_13a9<0){
scrollUpCnt=top;
scrollUpIntvl=window.setInterval("scrollUp()",1);
}else{
if(top+_13a7-_13a9>_13a8){
scrollDownCnt=(top+_13a7)-_13a8;
scrollDownIntvl=window.setInterval("scrollDown()",1);
}
}
}
var scrollUpCnt=0;
function scrollUp(){
var _13aa=document.body.scrollTop;
if(_13aa>scrollUpCnt){
document.body.scrollTop-=10;
}else{
scrollUpCnt=0;
window.clearInterval(scrollUpIntvl);
}
}
var scrollDownCnt=0;
function scrollDown(){
var _13ab=document.body.scrollTop;
if(_13ab<scrollDownCnt){
document.body.scrollTop+=10;
}else{
scrollDownCnt=0;
window.clearInterval(scrollDownIntvl);
}
}
function replaceParams(msg,args){
if(typeof args!="undefined"&&args.length>0&&!transMode){
for(i=0;i<args.length;i++){
msg=replace(msg,"{"+i+"}",args[i]);
}
}
return msg;
}
var myAccountsMenuStatus=false;
function showMyAccountsMenu(id){
if((transMode==true)&&(messagetranslated==true)&&(myAccountsMenuStatus==true)){
myAccountsMenuStatus=false;
Menu.myAccountsMenu.cachedContent="";
}
if(typeof id=="undefined"){
id="myAccountLink";
}
if(!myAccountsMenuStatus){
myAccountsMenuStatus=true;
var _13af="";
_13af="<menu id='myAccountsMenu' forElement='"+id+"'  onBeforeUnload='menuClose(ev)'>";
_13af+=" <item onclick='window.open(\"IAMMyAccount\")'><![CDATA["+jsMsg.MyAccount+"]]></item>";
_13af+=" <item onclick='window.open(\""+CONTACT_SERVER_URL+"\")'><![CDATA["+jsMsg.MyContacts+"]]></item>";
_13af+=" <item onclick='window.open(\"IAMMyAccount#groups/allgroups\")'><![CDATA["+jsMsg.MyGroups+"]]></item>";
_13af+="<sep></sep>";
_13af+=" <item onclick='checksaved("+"\"logout"+"\""+");return false;'><![CDATA["+jsMsg.SignOut+"]]></item>";
_13af+="</menu>";
Menu.create(_13af,{inputType:"xml"});
}
showMenu("myAccountsMenu");
}
var showSheetOptionsStatus=false;
function showSheetOptions(_13b0){
if((transMode==true)&&(messagetranslated==true)&&(showSheetOptionsStatus==true)){
showSheetOptionsStatus=false;
Menu.sheetOptionsMenu.cachedContent="";
}
if(typeof id=="undefined"){
id="sheetOptions";
}
if(!showSheetOptionsStatus){
showSheetOptionsStatus=true;
var _13b1="";
_13b1="<menu id='sheetOptionsMenu' forElement='"+id+"'  onBeforeUnload='menuClose(ev)'>";
if(!jsPUBLIC_VIEW&&!jsGUEST_VIEW&&!jsREMOTE_VIEW){
if(_13b0.indexOf("Languages")!=-1){
_13b1+=" <item onclick='showSettingDialog();return false;'><![CDATA["+jsMsg.Languages+"]]></item>";
_13b1+="<sep></sep>";
}
}
if(_13b0.indexOf("KeyboardShortcuts")!=-1){
_13b1+=" <item href='"+jsTitleMsg.KeyboardShortcutsURL+"' target='_blank'><![CDATA[<span>"+jsMsg.KeyboardShortcuts+" <img src='"+IMAGE_PATH+"spacer.gif' class='mainBgImg'></span>]]></item>";
}
if(_13b0.indexOf("NewFeatures")!=-1){
_13b1+=" <item href='"+ctxpath+"features' target='_blank'><![CDATA[<span>"+jsMsg.NewFeatures+" <img src='"+IMAGE_PATH+"spacer.gif' class='mainBgImg'></span>]]></item>";
}
if(_13b0.indexOf("WhatsNewInSheet3")!=-1){
_13b1+=" <item  id='whatsnew' onclick='Feature.fileMenuOpen();return false;'>"+jsMsg.WhatsNewInSheet3v+"</item>";
}
if(_13b0.indexOf("TranslationTool")!=-1){
_13b1+=" <item href='https://translate.sheet.zoho.com/' target='_blank'><![CDATA[<span>"+jsMsg.TranslationTool+" <img src='"+IMAGE_PATH+"spacer.gif' class='mainBgImg'></span>]]></item>";
}
if(_13b0.indexOf("Forums")!=-1&&_13b0.indexOf("Blogs")!=-1&&_13b0.indexOf("Blogs")!=-1&&_13b0.indexOf("Blogs")!=-1){
_13b1+="<sep></sep>";
}
if(_13b0.indexOf("Forums")!=-1){
_13b1+=" <item href='"+jsTitleMsg.ForumsURL+"' target='_blank'><![CDATA[<span>"+jsMsg.Forums+" <img src='"+IMAGE_PATH+"spacer.gif' class='mainBgImg'></span>]]></item>";
}
if(_13b0.indexOf("Blogs")!=-1){
_13b1+=" <item href='"+jsTitleMsg.BlogsURL+"' target='_blank'><![CDATA[<span>"+jsMsg.Blogs+" <img src='"+IMAGE_PATH+"spacer.gif' class='mainBgImg'></span>]]></item>";
}
if(_13b0.indexOf("Feedback")!=-1){
_13b1+=" <item href='' title='"+jsTitleMsg.Feedback+"' onclick='invoke();return false;'>"+jsMsg.Feedback+"</item>";
}
_13b1+="</menu>";
Menu.create(_13b1,{inputType:"xml"});
}
showMenu("sheetOptionsMenu");
}
var sbFname;
var sbRenameDocumentOrTemplateDialog="";
function sbRenameDocumentOrTemplate(arg){
sbFname=arg;
if(sbRenameDocumentOrTemplateDialog.length==0){
sbRenameDocumentOrTemplateDialog=getObj("renameDocOrTemplateDIV").innerHTML;
getObj("renameDocOrTemplateDIV").innerHTML="";
}
$("#sheetdialog").html(sbRenameDocumentOrTemplateDialog);
$.sheetdialog.open("#sheetdialog",{autoOpen:false,width:300,modal:true,resizable:false,title:jsTitleMsg.Rename,buttons:[{text:jsTitleMsg["OK"],click:function(){
sbRenameDocumentOrTemplateSubmit();
$.sheetdialog.close(this);
}},{text:jsTitleMsg["Cancel"],click:function(){
$.sheetdialog.close(this);
}}]});
sbRenameDocumentOrTemplateCallback();
}
function sbRenameDocumentOrTemplateCallback(){
positionDialog();
if(getObj("saveAsDocOrTempFileName")){
if(getObj(sbFname)!=null){
getObj("saveAsDocOrTempFileName").value=getObj(sbFname).value;
}else{
getObj("saveAsDocOrTempFileName").value=DOCUMENT_NAME;
}
getObj("saveAsDocOrTempFileName").focus();
getObj("saveAsDocOrTempFileName").select();
}
sbFname="";
}
function sbRenameDocumentOrTemplateSubmit(){
var _13b3=getObj("saveAsDocOrTempFileName").value;
if(_13b3==null||_13b3.trim()==""){
if(_13b3==""){
showAlertDialog(jsTitleMsg["Rename.DocumentNameCannotBeEmpty"]);
}else{
showAlertDialog(jsTitleMsg["Rename.InvalidDocumentName"]);
}
return;
}
filename=_13b3.trim();
filename=replaceDisallowedCharsInDocName(filename);
filename=encodeURIComponent(filename);
if(sbDocId==""){
sbDocId=DOCUMENT_ID;
}
var nvp="fname="+filename+"&fname1="+filename+"&doc_id="+sbDocId+"&curtime="+CURRENTTIME+"&docowner="+LOGINNAME;
nvp+="&collabid="+COLLAB_ID+"&afterRTC=false"+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING;
var _13b5=createRequestObject();
var _13b6=true;
_13b5.onreadystatechange=function(){
if(_13b5.readyState==4){
if(_13b5.status==200){
var _13b7=_13b5.responseXML;
if(_13b7!=null){
if(_13b7.firstChild&&_13b7.firstChild.hasChildNodes()){
var _13b8=_13b7.firstChild.childNodes;
for(var x=0;x<_13b8.length;x++){
node=_13b8.item(x);
if(node.nodeName=="tagerror"){
showAlertDialog(node.firstChild.nodeValue);
_13b6=false;
}
}
}
}
}
var _13ba=_13b5.responseText;
if(_13ba){
var obj=parseJSON(_13b5.responseText);
if(obj){
filename=obj.fname;
}
}
filename=decodeURIComponent(filename);
updateDocName(filename);
if(_13b6){
$.sheetdialog.close("#sheetdialog");
savefile();
}
}
};
_13b5.open("POST","renameDocumentOrTemplate.do",true);
_13b5.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
sendXMLHTTPRequest(_13b5,nvp,true);
return false;
}
function updateDocName(_13bc){
$("#fileName").text(_13bc);
$("#sp_docName").text(_13bc);
updateDocTitle(_13bc);
DOCUMENT_NAME=_13bc;
}
function renameTemplateShowHideToggle(_13bd,_13be){
var id=document.getElementById(_13bd);
var id2=document.getElementById(_13be);
if(id.style.display=="none"){
id.style.display="inline";
id2.style.display="none";
}else{
id.style.display="none";
id2.style.display="inline";
}
}
function show(_13c1){
var id=document.getElementById(_13c1);
id.style.display="inline";
}
function hide(divId){
var id=document.getElementById(divId);
id.style.display="none";
}
var dottedProgressEl;
var dottedProgressIdx=0;
var dottedProgressTimer=250;
var dottedProgressIntvl;
function addDottedProgress(forEl,intvl){
var _13c7=document.createElement("SPAN");
_13c7.id=(forEl.id!="")?forEl.id+"_dottedProgress":"_dottedProgress";
_13c7.innerHTML="<span style=\"visibility:hidden;\">.</span><span style=\"visibility:hidden;\">.</span><span style=\"visibility:hidden;\">.</span>";
forEl.appendChild(_13c7);
return _13c7.id;
}
function showDottedProgress(id){
dottedProgressEl=getObj(id);
if(dottedProgressIntvl!=null){
clearTimeout(dottedProgressIntvl);
}
animateProgressDots();
}
function stopDottedProgress(id){
if(dottedProgressIntvl!=null){
clearTimeout(dottedProgressIntvl);
}
var _13ca=getObj(id);
var dots=_13ca.getElementsByTagName("SPAN");
dots[0].style.visibility="visible";
dots[1].style.visibility="visible";
dots[2].style.visibility="visible";
}
function animateProgressDots(){
if(dottedProgressIdx==4){
dottedProgressIdx=0;
}
var dots=dottedProgressEl.getElementsByTagName("SPAN");
var visi;
if(dottedProgressIdx==0){
visi="hidden;hidden;hidden";
}else{
if(dottedProgressIdx==1){
visi="visible;hidden;hidden";
}else{
if(dottedProgressIdx==2){
visi="visible;visible;hidden";
}else{
if(dottedProgressIdx==3){
visi="visible;visible;visible";
}
}
}
}
var _13ce=visi.split(";");
dots[0].style.visibility=_13ce[0];
dots[1].style.visibility=_13ce[1];
dots[2].style.visibility=_13ce[2];
dottedProgressIdx++;
dottedProgressIntvl=setTimeout("animateProgressDots()",dottedProgressTimer);
}
function getUsrName(usr){
var dname="";
if(SHAREDUSERSLIST.length==0){
dname=LOGINNAME;
return dname;
}
for(var i=0;i<SHAREDUSERSLIST.length;i++){
var _13d2=SHAREDUSERSLIST[i];
var uname=_13d2["zuid"];
if(uname==null||uname==""||uname==-1){
uname=_13d2["uname"];
}
if(usr==uname){
dname=_13d2["dname"];
break;
}
}
return dname;
}
function isusrname(usr){
var _13d5=false;
if(usr!=null&&usr!=""){
usr=usr.trim();
if(SHAREDUSERSLIST.length==0&&usr==LOGINNAME){
_13d5=true;
}
for(var i=0;i<SHAREDUSERSLIST.length;i++){
var _13d7=SHAREDUSERSLIST[i];
var dname=_13d7["dname"];
if(usr==dname){
_13d5=true;
break;
}
}
}
return _13d5;
}
function isNewSave(param,_13da,_13db,_13dc,_13dd){
var nvp="remoteBookId="+DOCUMENT_ID;
if(_13dd){
nvp+="&action=saveAs";
}else{
nvp+="&action=isNewSave";
}
if(_13db==null||_13db.trim()==""){
return false;
}
nvp+="&bookName="+encodeURIComponent(_13db);
if(typeof _13dc!="undefined"&&_13dc!=null){
nvp+="&handbackId="+_13dc;
}
var _13df=new getXmlhttp();
_13df.open("POST",ctxpath+"remoteAction.do",true);
_13df.onreadystatechange=function(){
if(_13df.readyState==4){
if(_13df.status==200){
var resp=_13df.responseXML;
if(resp){
var _13e1=resp.firstChild.childNodes[0].childNodes[0].nodeValue;
var _13e2=resp.firstChild.childNodes[1].childNodes[0].nodeValue;
if(_13dd){
updateRemoteDocName(_13e1,param,_13e2,true,true);
}else{
updateRemoteDocName(_13e1,param,_13e2,true);
}
}
}
}
};
_13df.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_13df.send(nvp);
}
function updateRemoteDocName(_13e3,param,_13e5,_13e6,_13e7){
DOCUMENT_NAME=_13e3;
if($("#topBand").length>0){
$("#sp_docName").text(_13e3);
if($("#toplinkspart ul").offset()!=null){
toplinksleft=$("#toplinkspart").children().offset().left;
}
var _13e8=($("#docnamepart").offset())?$("#docnamepart").offset().left+$("#docnamepart").width()+$("#ellipsis").width():0;
var _13e9=0;
if($("#topBand").find("ul").length>0){
_13e9=$("#topBand").find("ul").first().offset().left-($("#docnamepart").offset().left+$("#docnamepart").width());
}
if(480<_13e9){
$("#ellipsis").removeClass("ellipsis");
}else{
$("#ellipsis").addClass("ellipsis");
}
var _13ea=getObj("sp_docName");
if(_13ea!=null){
_13ea.innerHTML=revertSplChrs(_13e3)+((_13e5.indexOf(".")==0)?_13e5:("."+_13e5));
_13ea.setAttribute("docname",_13e3);
_13ea.title=_13e3;
}
var _13eb=$("#docnamepart").children().children().first();
$("#docstausicons").css({left:$(_13eb).parent().parent().offset().left+$("#docnamepart").width(),position:"absolute"});
if($("#docnamepart").width()<130){
$("#docnamepart").css({minWidth:$(_13eb).width()+5});
}
_13ea=null;
}
updateDocTitle(DOCUMENT_NAME.trim(),_13e5);
_13e5=null;
if(_13e6){
if(_13e7){
saveremoteGEdoc(param,_13e5,true);
}else{
saveremoteGEdoc(param,_13e5);
}
}
if(ISGEEDITOR){
doFileNameUpdatePost();
}
}
function getSaveDialogHTML(){
var html="";
html+="<form onsubmit='saveNewDoc();return false;' name='SaveForm' action=''><table width='100%' border='0' cellspacing='0' cellpadding='0'><tr><td style='padding:10px;'>";
html+="<table width='100%' border='0' cellspacing='0' cellpadding='0'><tr><td style='padding-bottom: 5px;'><b>"+jsTitleMsg["PromptMsg.SpreadsheetName"]+"</b><td></tr>";
html+="<tr><td><input id='save_docName' class='textField' type='text' style='width:100%' maxlength='650' value='"+jsTitleMsg.UntitledSpreadsheet+"'></td></tr>";
html+="<tr><td style='padding-top: 8px;text-align: right;'>";
html+="<div><input id='saveDialog_save' class='button' type='button' onclick='saveNewDoc()' value='Save'/>&nbsp;";
html+="<input class='button' type='button' onclick='closeDialog()' value='Cancel'/></div></td></tr></table></td></tr></table></form>";
return html;
}
function saveNewDoc(_13ed){
var _13ee=getObj("save_docName");
if(_13ed){
_13ee=getObj("saveAsFileName");
}
var _13ef=_13ee.value;
if(_13ef.trim()==""||_13ef==null){
showAlertDialog(jsTitleMsg["InvalidMsg.SpreadsheetName"]);
if(_13ed){
_13ee.value=DOCUMENT_NAME;
}
_13ee.focus();
_13ee.select();
return false;
}else{
closeDialog();
if(_13ed){
isNewSave(null,null,_13ef,null,true);
}else{
isNewSave(null,null,_13ef);
}
}
}
function updateSidebarCount(view,_13f1,_13f2,_13f3){
var _13f4=null;
if(view=="mydocs"){
_13f4=getObj("mysheetspan");
}else{
if(view=="mytemplates"){
_13f4=getObj("mytemplatespan");
}
}
if(_13f4!=null){
var _13f5=_13f4.innerHTML;
_13f5=_13f5.replace("(","");
_13f5=_13f5.replace(")","");
if(_13f1){
_13f4.innerHTML="("+(parseInt(_13f5)+1)+")";
}else{
if(_13f2){
_13f4.innerHTML="("+(parseInt(_13f5)-1)+")";
}else{
if(typeof _13f3!="undefined"&&parseInt(_13f3)){
_13f4.innerHTML="("+parseInt(_13f3)+")";
}
}
}
_13f4=null;
}
}
var btnState=null;
function editMode_disableButtons(){
var _13f6=getObj("td_redo");
btnState=(_13f6!=null)?_13f6.getAttribute("icondisabled"):false;
disableREDO();
}
function editMode_enableButtons(){
if(btnState!=null){
if(btnState=="false"){
enableREDO();
}
}
btnState=null;
}
function isDocSaved(){
if(SAVED||AUTO_SAVED==null){
return true;
}else{
return false;
}
}
var cellCommentContent;
var defaultCalloutContentWidth;
var defaultCalloutContentMinheight;
function getCommentCalloutPropertyValues(){
cellCommentContent=getObj("cellCommentCalloutContent");
if(cellCommentContent!=null){
defaultCalloutContentWidth=getCurrentStyle(cellCommentContent,"width");
defaultCalloutContentMinheight=getCurrentStyle(cellCommentContent,"minHeight");
}
}
function getColorCode(usr){
if(usercolorcode[usr]){
return usercolorcode[usr];
}else{
if(colorcodeidx>=colorcodes.length){
colorcodeidx=0;
}
usercolorcode[usr]=colorcodes[colorcodeidx++];
return usercolorcode[usr];
}
}
function getUserPositionStr(usr,_13f9,key){
if(usr&&!isSheetBasedShare){
var _13fb=usercell[usr];
if(_13fb){
var val=_13fb.split("-");
if(_13f9){
val[0]="\""+trimNameWithDots(val[0])+"\"";
}
var _13fd=val[0]+"."+getCellLabel(parseInt(val[1]),parseInt(val[2]));
if(typeof key!="undefined"){
_13fd=replaceParams(jsTitleMsg[key],new Array(_13fd));
}
return "."+_13fd;
}
}
return "";
}
function setProgressMessage(msg,_13ff){
var _1400=getObj("loading");
if(_1400){
if(msg){
if($("#loading").hasClass("updatingmsg")){
$("#loading").removeClass("updatingmsg");
}
$("#loading").addClass("savingmsg");
if(typeof isLogoAvailableForRemote!=="undefined"&&!isLogoAvailableForRemote){
$("#loading").css("margin-right","0px");
}else{
$("#loading").css("margin-right","121px");
}
if(_13ff){
_1400.innerHTML=msg;
}else{
_1400.innerHTML=msg+"...";
}
}else{
$("#loading").css("margin-right","0px");
_1400.innerHTML=jsMsg["Updating"]+"...";
}
}
}
function showProgressMessage(msg,_1402){
var _1403=getObj("loading");
if(ENABLE_SAVE_MESSAGE){
if(msg!="Saving"){
if(_1403){
_1403.style.display="block";
if(msg){
_1403.innerHTML=msg+"...";
}
if(_1402){
setTimeout(function(){
hideProgressMessage();
},3000);
}
showPrevMessage=true;
PREVIOUS_MESSAGE=_1403.innerHTML;
}
}else{
showSaveMessage("enable");
}
}else{
if(_1403){
_1403.style.display="block";
if(msg){
_1403.innerHTML=msg+"...";
}
if(_1402){
setTimeout(function(){
hideProgressMessage();
},3000);
}
showPrevMessage=true;
PREVIOUS_MESSAGE=_1403.innerHTML;
}
}
}
function hideProgressMessage(){
var _1404=getObj("loading");
if(_1404){
if(!pivotSheet){
if($("#loading").hasClass("savingmsg")){
$("#loading").removeClass("savingmsg");
}
$("#loading").addClass("updatingmsg");
}
_1404.style.display="none";
_1404.innerHTML=jsMsg["Updating"]+"...";
PREVIOUS_MESSAGE="";
showPrevMessage=false;
}
if(ENABLE_SAVE_MESSAGE){
showSaveMessage("disable");
}
}
function loadRemoteDocument(){
message(jsMsg.Loading,"block","...");
var _1405=new getXmlhttp();
_1405.onreadystatechange=function(){
if(_1405.readyState==4){
var imgs,i;
imgs=sheetObjectsPane.getElementsByTagName("IMG");
for(i in imgs){
if(/ExcelGraph.*/gi.test(imgs[i].id)){
sheetObjectsPane.removeChild(imgs[i]);
}
}
removeXTiles(getAvailableStartRow(),getAvailableEndRow(),"UNLOADED_PAGE");
loadXTileIfVacantInViewPort();
getCharts(DOCUMENT_ID,CURRSHEETNAME);
hideBannerMessage();
isErrorDoc=false;
READ_WRITE=true;
ALLOW_TO_WRITE=true;
message(jsMsg.Loading,"none");
}
};
var nvp="&doc="+remoteAPIParam+"&reconnect=true";
postAjax(_1405,ctxpath+"editor.do",nvp);
}
var isErrorDoc=false;
var allowSheetSwitch=false;
function handleServerError(_1409,msg,_140b,_140c){
var _140d="";
var _140e="";
var _140f="";
if(typeof msg=="undefined"){
msg="";
}
message("","none");
if(msg==showErrorPanelMsg){
msg=jsMsg["ErrorPanel.MainContent"]+" ";
if(lastSavedTime!=null&&DOCUMENT_ID!="doc_id"&&ALLOW_TO_WRITE){
var _1410=returnTimeElaspsedinString(new Date(),lastSavedTime);
if(_1410.unit.indexOf("second")!=-1){
_140d=replaceParams(jsMsg["ErrorPanel.LastSavedInfo.LastSavedTimeinSeconds"],new Array(_1410.count));
}else{
if(_1410.unit=="minutes"){
_140d=replaceParams(jsMsg["ErrorPanel.LastSavedInfo.LastSavedTimeinMinutes"],new Array(_1410.count));
}else{
if(_1410.unit=="hours"){
_140d=replaceParams(jsMsg["ErrorPanel.LastSavedInfo.LastSavedTimeinHours"],new Array(_1410.count));
}else{
if(_1410.unit=="days"){
_140d=replaceParams(jsMsg["ErrorPanel.LastSavedInfo.LastSavedTimeinDays"],new Array(_1410.count));
}
}
}
}
_140d="<b>"+_140d+"</b>";
}else{
}
if(DOCUMENT_ID!="doc_id"){
if(jsREMOTE_SAVE_VIEW){
_140e="<br>"+replaceParams(jsMsg["ErrorPanel.AdviseToBackupandReloadwithLink"],new Array("<a onclick='javascript:loadRemoteDocument();' href='#'>","</a>"));
}else{
if(INTERNAL_VIEW){
_140e="<br>"+jsMsg["ErrorPanel.AdviseToBackupandReloadwithoutLink"];
}else{
if(jsPUBLIC_VIEW||jsGUEST_VIEW||jsTHROWAWAY_VIEW){
_140e="<br>"+jsMsg["ErrorPanel.AdviseToBackupandReloadwithoutLink"];
}else{
if(ALLOW_TO_WRITE){
_140e="<br>"+replaceParams(jsMsg["ErrorPanel.AdviseToBackupandReloadwithLink"],new Array("<a onclick='javascript:loadDocument(\""+DOCUMENT_ID+"\");' href='#'>","</a>"));
}else{
_140e="<br>"+replaceParams(jsMsg["ErrorPanel.AdviseToBackupandReloadwithLink"],new Array("<a onclick='javascript:loadDocument(\""+DOCUMENT_ID+"\");' href='#'>","</a>"));
}
}
}
}
}else{
if(!jsNEW_DOC_VIEW){
_140e="<br>"+jsMsg["ErrorPanel.AdviseToBackupandReloadwithoutLink"];
}else{
_140e="<br>"+jsMsg["ErrorPanel.CreateNewDocumentandTryAgain"];
}
}
}else{
if(msg=="ConnectionLost"){
msg=replaceParams(jsMsg["ErrorPanel.ServerConnectionLost"],"","");
if(lastSavedTime!=null&&DOCUMENT_ID!="doc_id"&&ALLOW_TO_WRITE){
var _1410=returnTimeElaspsedinString(new Date(),lastSavedTime);
if(_1410.unit.indexOf("second")!=-1){
_140d=replaceParams(jsMsg["ErrorPanel.LastSavedInfo.LastSavedTimeinSeconds"],new Array(_1410.count));
}else{
if(_1410.unit=="minutes"){
_140d=replaceParams(jsMsg["ErrorPanel.LastSavedInfo.LastSavedTimeinMinutes"],new Array(_1410.count));
}else{
if(_1410.unit=="hours"){
_140d=replaceParams(jsMsg["ErrorPanel.LastSavedInfo.LastSavedTimeinHours"],new Array(_1410.count));
}else{
if(_1410.unit=="days"){
_140d=replaceParams(jsMsg["ErrorPanel.LastSavedInfo.LastSavedTimeinDays"],new Array(_1410.count));
}
}
}
}
if((jsNEW_DOC_VIEW||jsSHARE_VIEW||jsOPEN_DOC_VIEW)&&(DOCUMENT_ID&&DOCUMENT_ID!=""&&DOCUMENT_ID!="doc_id")){
_140f=replaceParams(jsMsg["ErrorPanel.reopen"],new Array("<a onclick='javascript:loadDocument(\""+DOCUMENT_ID+"\", \"\", \"\", \"fcl\");' href='#'>","</a>"));
}else{
_140f=replaceParams(jsMsg["ErrorPanel.reopen"],new Array("",""));
}
_140d=_140d+" "+_140f;
}else{
if((jsNEW_DOC_VIEW||jsSHARE_VIEW||jsOPEN_DOC_VIEW)&&(DOCUMENT_ID&&DOCUMENT_ID!=""&&DOCUMENT_ID!="doc_id")){
msg=replaceParams(jsMsg["ErrorPanel.ConnectionLost"],new Array("<a onclick='javascript:loadDocument(\""+DOCUMENT_ID+"\", \"\", \"\", \"fcl\");' href='#'>","</a>"));
}else{
msg=replaceParams(jsMsg["ErrorPanel.ConnectionLost"],new Array("",""));
}
}
}
}
msg=msg+_140d+_140e;
if(msg!=""){
btn_disabled();
if(typeof _1409=="undefined"){
_1409="ERROR";
}
showBannerMessage(_1409,msg);
}
if(_140b){
READ_WRITE=false;
}
ALLOW_TO_WRITE=false;
if(_1409=="ERROR"){
isErrorDoc=true;
if(document.getElementById("menutabs")){
errorDocMenutab();
}
var _1411=getObj("addSheetBtn");
if(_1411){
_1411.style.visibility="hidden";
}
if(ole){
ole.setObjectProperties("button",{permissions:{isDraggable:false,isResizable:false,isEditable:false}});
}
if(COLLAB_ID!=""&&COLLAB_ID!="null"){
Collaboration.quit(COLLAB_ID);
var _1412=COLLAB_ID;
resetRTCvariables();
if(jsSHARE_VIEW){
COLLAB_ID=_1412;
}
}
}
if(typeof _140c!="undefined"){
allowSheetSwitch=_140c;
}else{
allowSheetSwitch=false;
}
}
openErrorPanelCallBack=function(){
resetPageDim();
};
function returnTimeElaspsedinString(_1413,_1414){
_1414=(_1414==null)?new Date():_1414;
_1414=_1413-_1414;
var _1415=(((_1414/1000)/60)/60)/24;
_1415=_1415.toFixed(0);
if(_1415>=2){
return {count:_1415,unit:"days"};
}
_1415=((_1414/1000)/60)/60;
_1415=_1415.toFixed(0);
if(_1415>=2){
return {count:_1415,unit:"hours"};
}
_1415=(_1414/1000)/60;
_1415=_1415.toFixed(0);
if(_1415>=2){
return {count:_1415,unit:"minutes"};
}
_1415=_1414/1000;
_1415=_1415.toFixed(0);
return {count:_1415,unit:"seconds"};
}
function showBannerMessage(_1416,msg,_1418,_1419,_141a){
if(typeof _1418!="undefined"){
if(_1418){
getObj("bannerCloseBtn").style.display="";
}else{
getObj("bannerCloseBtn").style.display="none";
}
}else{
if(_1416=="WARNING"||_1416=="INFO"){
getObj("bannerCloseBtn").style.display="";
}else{
getObj("bannerCloseBtn").style.display="none";
}
}
var _141b=getObj("msgBannerPanel");
_141b.style.height="100%";
getObj("bannerMessage").innerHTML=msg;
var _141c=getObj("msgBanner");
var _141d=getObj("bannerErrorIcon");
var _141e=getObj("bannerWarningIcon");
var _141f=getObj("bannerInfoIcon");
_141d.style.display="none";
_141e.style.display="none";
_141f.style.display="none";
if(_1416=="ERROR"){
_141d.style.display="";
_141c.className="error";
}else{
if(_1416=="WARNING"){
_141e.style.display="";
_141c.className="warning";
}else{
if(_1416=="INFO"){
_141f.style.display="";
_141c.className="info";
}
}
}
if(_141b.style.display=="none"){
if(typeof _1419=="undefined"||_1419>0){
blindDown("msgBannerPanel",openErrorPanelCallBack,_1419);
}else{
_141b.style.display="";
}
}else{
fadeIn(_141c.id,50);
}
if(typeof _141a!="undefined"){
_141a();
}
}
function showConnectionLostError(_1420){
if(COLLAB_ID&&COLLAB_ID!=""){
var msg;
if((jsNEW_DOC_VIEW||jsSHARE_VIEW||jsOPEN_DOC_VIEW)&&(DOCUMENT_ID&&DOCUMENT_ID!=""&&DOCUMENT_ID!="doc_id")){
msg=replaceParams(jsMsg["ErrorPanel.ConnectionLost"],new Array("<a onclick='javascript:loadDocument(\""+DOCUMENT_ID+"\", \"\", \"\", \"fsm\");' href='#'>","</a>"));
}else{
msg=replaceParams(jsMsg["ErrorPanel.ConnectionLost"],new Array("",""));
}
isRegistered=false;
if(_1420){
handleServerError("ERROR",msg,true,false);
}else{
handleServerError("ERROR","ConnectionLost",true,false);
}
}
}
function hideBannerMessage(){
getObj("bannerCloseBtn").style.display="none";
getObj("msgBannerPanel").style.display="none";
resetWorkSheetDim();
}
function copyPublicDocumentToMyAccount(_1422){
location.href=_1422;
}
function bodyClick(ev){
if(browser_ie){
var srcEl=window.event.srcElement;
}else{
if(browser_nn6){
var srcEl=ev.target;
}
}
if(srcEl==exprField){
currFocusFld=exprField;
}else{
if(srcEl.id!="td_function"&&srcEl.id!="td_function_icon"&&srcEl.id!="td_sum"&&srcEl.id!="td_sum_icon"){
currFocusFld="";
}
}
if(isCellFieldSPANHided()){
activateCellField();
}
var _1425=$(".ui-zcolorpalette");
if(_1425.is(":visible")){
var _1426=$(srcEl).parent().attr("class");
if(_1426.indexOf("ui-")==-1){
_1425.click();
}
}
}
function bodyMousedown(ev){
var el;
if(browser_ie){
ev=window.event;
el=ev.srcElement;
}else{
el=ev.target;
}
if(isFilterOptionsDIVOpened){
var id=el.id;
if(id&&!(browser_safari||browser_firefox||browser_ie&&id&&id.indexOf("fo")!=-1)&&id.indexOf("fVal")===-1&&el.className.indexOf("zspinner")==-1&&el.id.indexOf("filterSearch")==-1){
Filter.hideFilterOptions();
}
}
var _142a=document.activeElement;
var _142b=el.className;
if(_142b.match(/ui-autocomplete/g)){
var tag=el.nodeName;
if(tag=="UL"){
_142a.focus();
stopEvt(ev);
}
}
if(isVScrollFaceClicked){
if(el!==ssVScrollbar){
if(rowInfoBoxTimeout){
window.clearTimeout(rowInfoBoxTimeout);
}
clearTileLoadTimeout();
hideRowInfoBox();
hideRowInfoLoaderBox();
isVScrollFaceClicked=false;
}
}
(typeof snippet!=="undefined")&&snippet.hideDesignModeCue();
}
function updateDocTitle(_142d,_142e,type){
dollarToggle();
if(jsGADGET_VIEW){
return;
}
var _1430=jsMsg.ZohoSheet;
if(!_142d){
_142d="";
}
if(_142e&&_142e!="null"){
_142d+=((_142e.indexOf(".")==0)?_142e:("."+_142e));
}
if(type=="NEW_DOC"){
_142d=jsMsg.UntitledSpreadsheet;
}
if($("#topBand").length>0){
var obj=(jsREMOTE_SAVE_VIEW)?$("#sp_docName"):$("#fileName");
obj.attr("title",_142d);
obj.text(_142d);
var _1432=0;
if($("#toplinkspart").length>0){
_1432=$("#toplinkspart").children().offset().left;
}
var _1433=($("#docnamepart").offset())?$("#docnamepart").offset().left+$("#docnamepart").width()+$("#ellipsis").width():0;
var _1434=0;
if($("#topBand").find("ul").length>0){
_1434=$("#topBand").find("ul").first().offset().left-($("#docnamepart").offset().left+$("#docnamepart").width());
}
if(480<_1434){
$("#ellipsis").removeClass("ellipsis");
}else{
$("#ellipsis").addClass("ellipsis");
}
if(_142d!=""){
_142d+=" - ";
}
document.title=_142d+_1430;
var _1435=$("#docnamepart").children().children().first();
$("#docstausicons").css({left:$(_1435).parent().parent().offset().left+$("#docnamepart").width(),position:"absolute"});
if($("#docnamepart").width()<130){
$("#docnamepart").css({minWidth:$(_1435).width()+5});
}
}
}
function showSettingDialog(){
autosave();
showURLInDialog("pages/settings.jsp","position=absmiddle,top=-100,title="+jsTitleMsg.Languages);
}
function saveAsRemoteDoc(){
if(typeof ZohoMockup!="undefined"){
autosave();
var _1436={};
_1436["olddocid"]=remoteUserDocId;
_1436["oldfilename"]=DOCUMENT_NAME;
_1436["docid"]=DOCUMENT_ID;
ZohoMockup.__sendRequest("onSaveAs",_1436);
}else{
var _1437=window.open(ctxpath+"pages/blank.html","saveas operation redirect page","width=500,height=500,scrollbars=yes,toolbar=no,menubar=no");
_1437.moveTo(250,150);
_1437.focus();
var _1438=new getXmlhttp();
_1438.onreadystatechange=function(){
if(_1438.readyState==4){
var resp=_1438.responseText;
if(resp!=null&&resp.trim()!=""){
var _143a=eval("({"+resp+"})");
var error=_143a.ERROR;
if(error){
_1437.close();
showAlertDialog(error);
return false;
}
var _143c=_143a.ZDOCID;
var _143c=_143a.PDOCID;
var _143d=_143a.SAVE_AS_URL;
_1437.location.href=_143d;
}
}
};
var nvp="remoteBookId="+DOCUMENT_ID+"&isDocSaved="+isDocSaved();
postAjax(_1438,ctxpath+"remoteduplicate.do",nvp);
}
}
function importGSheet(){
if((!SAVED||!MACROSAVED||RECORDINGMACRO)&&ALLOW_TO_WRITE){
checksaved("importdoc");
}
var _143f="https://"+document.getElementById("ZohoGadgetsURL").value;
var _1440=["EDF3FD","BFCAFF","4A6295"];
for(var i=0;i<_1440.length;i++){
_1440[i]=_1440[i];
}
var _1442=getServerPath();
_1442+="/pages/importGDoc.jsp";
srcURL=_143f+"/gdocs/sheets?border=no&bgcolor="+_1440[0]+"&brcolor="+_1440[1]+"&searchColor="+_1440[2]+"&serURL="+_1442;
htmlStr="<iframe src="+srcURL+" scrolling=no id=ifm height=100% width=100% marginheight=0 marginwidth=0 frameborder=0></iframe>";
showDialog(htmlStr,"width=509,height=409,modal=yes,title="+jsMsg["Import.Menu.GoogleSpreadSheets"],positionDialog);
}
function isValidURL(url){
var _1444="^(?:ht|f)tp(s?)://[0-9a-zA-Z]([-.w]*[0-9a-zA-Z])*(:(0-9)*)*(/?)([a-zA-Z0-9-.?,:'/\\+=&amp;%$#_]*)?$";
var _1445=url.match(_1444);
if(_1445==null){
return false;
}
return true;
}
function verifySaveToMyAccount(_1446,mode){
if(!allowExport){
return false;
}
if(_1446=="true"){
var _1448=jsMsg["ConfirmationMessage1"];
var _1449="";
var _144a=true;
var _144b=false;
var chk=false;
if(!isReadOnlyViewMode){
chk=true;
_1449=jsMsg["ConfirmationMessage2"];
}
ConfirmBox.showDialog(jsMsg.SaveToMyAccount,verifySaveToMyAccount,jsTitleMsg["OK"],jsTitleMsg["Cancel"]);
ConfirmBox.setInfoMsg(_1448,_1449,_144b,_144a,chk);
}else{
isConfirmation=false;
var _144d=new getXmlhttp();
var _144e;
_144d.onreadystatechange=function(){
if(_144d.readyState==4){
var _144f=_144d.responseText;
saveToMyAccount(_144f,mode);
}
};
var nvp="action=verify&"+csrfParamName+"="+csrfToken;
postAjax(_144d,ctxpath+"copyDoc.do",nvp);
}
if(_1446=="true"){
closeDialog();
}
}
function saveAccountCallBack(){
positionDialog();
getObj("publicok").onclick=function(){
verifySaveToMyAccount();
};
}
function saveToMyAccount(_1451,mode){
var _1453=getViewType();
var _1454=new getXmlhttp();
if(_1451==undefined||_1451==null){
verifySaveToMyAccount(false);
return false;
}
_1451=_1451.toBoolean();
if(_1451){
_1454.open("POST",ctxpath+"copyDoc.do",true);
if(_1453=="SHARE_VIEW"){
var _1455=getObj("chkBox")?getObj("chkBox").checked:false;
var nvp="action=duplicate&docid="+DOCUMENT_ID+"&"+csrfParamName+"="+csrfToken+"&savechanges="+_1455+"&currenttime="+CURRENTTIME;
_1454.onreadystatechange=function(){
if(_1454.readyState==4){
var url="/open.do?docid="+_1454.responseText;
location.href=url;
}
};
}else{
if(_1453==="PUBLIC_VIEW"){
var _1455=getObj("chkBox")?getObj("chkBox").checked:false;
var nvp="action=saveToMyAccount&viewType="+_1453+"&docid="+DOCUMENT_ID;
nvp+="&"+csrfParamName+"="+csrfToken+"&savechanges="+_1455+"&currenttime="+CURRENTTIME;
_1454.onreadystatechange=function(){
if(_1454.readyState==4){
var url="/open.do?docid="+_1454.responseText;
location.href=url;
}
};
}else{
if(_1453==="THROWAWAY_VIEW"||_1453==="REMOTE_VIEW"){
if(_1453==="THROWAWAY_VIEW"||(_1453==="REMOTE_VIEW"&&DOCUMENT_NAME=="")){
var _1459=showPromptDialog(jsTitleMsg.SpecifyNameForSpreadsheet,(DOCUMENT_NAME=="")?jsMsg.UntitledSpreadsheet:DOCUMENT_NAME);
if(_1459==null){
if($("#_DIALOG_LAYER").is(":visible")){
closeDialog();
}
return false;
}
if(_1459!=""){
DOCUMENT_NAME=_1459;
}else{
showAlertDialog(jsTitleMsg["Rename.DocumentNameCannotBeEmpty"]);
return false;
}
}
var nvp="action=saveToMyAccount&viewType="+_1453;
nvp+="&"+csrfParamName+"="+csrfToken+"&activesheet="+encodeURIComponent(CURRSHEETNAME)+"&currenttime="+CURRENTTIME+"&docowner="+CURR_DOC_OWNERNAME+"&add=yes"+"&ftype=sxc&filename="+encodeURIComponent(DOCUMENT_NAME)+"&savechanges="+true;
if(jsREMOTE_VIEW){
jsREMOTE_VIEW_SAVE_CALLED=true;
nvp+="&caller=remoteEditor&remoteBookId="+DOCUMENT_ID+"&docid=doc_id";
}else{
nvp+="&docid="+DOCUMENT_ID;
}
_1454.onreadystatechange=function(){
if(_1454.readyState==4){
if(jsGADGET_VIEW){
window.open("/open.do?docid="+_1454.responseText);
}else{
location.href=ctxpath+"open.do?docid="+_1454.responseText;
}
}
};
}
}
}
_1454.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_1454.send(nvp);
}else{
if(_1453==="PUBLIC_VIEW"){
var url=ctxpath+"savetomyaccount.do?action=saveToMyAccount&viewType="+_1453+"&doc_id="+DOCUMENT_ID+"&activesheet="+CURRSHEETNAME+"&currenttime="+CURRENTTIME+"&savechanges="+PUBLIC_EDIT_MODE;
location.href=url;
}else{
if(_1453==="THROWAWAY_VIEW"||_1453==="REMOTE_VIEW"){
var _145b=DOCUMENT_NAME;
_145b=showPromptDialog(jsTitleMsg.SpecifyNameForSpreadsheet,_145b);
if(jsREMOTE_VIEW){
DOCUMENT_NAME=_145b;
}
_145b=encodeURIComponent(_145b);
if(_145b&&DOCUMENT_NAME){
var _145c;
var add="no";
var _145c=DOCUMENT_ID;
if(jsREMOTE_VIEW||!DOCUMENT_ID){
add="yes";
_145c="doc_id";
remoteBookId=DOCUMENT_ID;
}
}else{
return;
}
var _145e="filename="+_145b+"&ftype=sxc&doc_id="+_145c+"&add="+"yes"+"&activesheet="+CURRSHEETNAME+"&currenttime="+CURRENTTIME+"&docowner="+CURR_DOC_OWNERNAME+"&viewType="+getViewType()+"&savechanges="+true;
if(jsREMOTE_VIEW){
jsREMOTE_VIEW_SAVE_CALLED=true;
_145e+="&caller=remoteEditor&remoteBookId="+remoteBookId;
}
var url=ctxpath+"savetomyaccount.do?"+_145e;
if(jsGADGET_VIEW){
window.open(url,jsMsg.ZohoSheet);
}else{
location.href=url;
}
}
}
}
}
function getServerPath(){
var _145f=location.protocol+"//"+location.hostname;
var port=location.port;
if(port!=""&&port!=443){
_145f+=(":"+port);
}
}
function deleteDoc(_1461){
if(_1461){
var _1462=jsMsg["DocDeleteConfirmation1"];
var _1463=false;
var _1464=false;
if(!COLLAB_ID&&(isDocumentPublic||isDocumentSemiPublic)){
_1462=(isDocumentSemiPublic&&!isDocumentPublic)?jsMsg["TrashConfirm.PublishWithOrg"]:jsMsg["TrashConfirm.PublishedToExternal"];
_1462+=" "+jsMsg["TrashConfirm.commonMsg"];
_1463=true;
_1464=true;
}else{
if(COLLAB_ID){
_1462=(isDocumentPublic||isDocumentSemiPublic)?jsMsg["TrashConfirm.ShareAndPublish"]:jsMsg["TrashConfirm.SharedDoc"];
_1462+=" "+jsMsg["TrashConfirm.commonMsg"];
_1463=true;
_1464=true;
}
}
ConfirmBox.showDialog(jsTitleMsg.MoveToTrash,deleteDoc,jsMsg["Dialog.confirm.Yes"],jsMsg["Dialog.confirm.No"]);
ConfirmBox.setWarningMsg(_1462,_1464,_1463);
return true;
}else{
var _1465=DOCUMENT_NAME;
if(_1465.length>50){
_1465=_1465.substring(0,47)+"...";
}
var _1466=replaceParams(jsMsg["Trash.InfoBannerMsg"],new Array(_1465,"<b>","</b>"));
sessionStorage.setItem("banner","true");
sessionStorage.setItem("message",_1466);
var _1467=new getXMLHttpRequest();
var url=ctxpath+"delete.do";
_1467.open("POST",url,true);
_1467.onreadystatechange=function(){
if(_1467.readyState==4){
}
};
_1467.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
sendXMLHTTPRequest(_1467,"doc_id="+DOCUMENT_ID+"&docname="+encodeURIComponent(DOCUMENT_NAME),true,false,url);
loadDocument("open.do");
closeDocument();
}
}
function deleteCallBack(){
positionDialog();
getObj("publicok").onclick=function(){
deleteDoc();
};
}
function updateSaveToolTip(_1469,_146a,_146b){
var _146c=getObj("save_message_display");
if(ENABLE_SAVE_MESSAGE&&_146c){
var _146d;
var _146e=_146c.getAttribute("lastUpdatedTime");
if(_146b!="false"){
if(_146a!=undefined&&LOGINNAME!=_146a){
_146d=replaceParams(jsMsg["Save.Message.LastModifiedBy"],new Array(_146a,"at",_1469));
}else{
_146d=replaceParams(jsMsg["Save.Message.LastModifiedByYou"],new Array("at",_1469));
}
}else{
_146d=replaceParams(jsMsg["Save.Message.LastModifiedByYou"],new Array("at",updatedSaveTime));
}
var _146f=_146c.getElementsByTagName("img");
if(!(_146f.length>0)){
_146c.innerHTML+="<img alt='im' src='"+IMAGE_PATH+"info_save.png' style='margin-left:6px' title='"+_146d+"'"+"/>";
}else{
_146f[0].title=_146d;
}
}
}
function createNewDocument(type){
var url=document.location.href;
if(url.lastIndexOf("?")>0){
var _1472=url.substring(url.lastIndexOf("/")+1,url.lastIndexOf("?"));
var _1473=url.substring(url.lastIndexOf("=")+1);
if(url.lastIndexOf("&")>0){
var _1474=url.substring(url.lastIndexOf("=")+1);
}
}else{
_1472=url.substring(url.lastIndexOf("/")+1);
}
if(type=="template"){
TEMPLATE_FLAG="true";
createNewTemplate();
}else{
TEMPLATE_FLAG="false";
if(SAVED&&DOCUMENT_ID=="doc_id"){
document.location.href=ctxpath+"home.do?selectedFolderId=folder";
}else{
if(_1472=="open.do"||_1472=="home.do"){
window.open(ctxpath+"home.do?selectedFolderId=folder","_blank");
}
}
}
}
function setDocumentName(type){
if(ISAPP_READONLYMODE){
return;
}else{
if(type=="copy"&&DOCUMENT_ID!="doc_id"){
showSaveAsDialog();
}else{
if(type=="save"&&DOCUMENT_ID!="doc_id"){
savefile();
}else{
sbRenameDocumentOrTemplate();
}
}
}
}
function openPublicView(){
window.open(publicURL);
}
function setFileNameMaxWidth(_1476){
if($("#topBand").length>0){
var _1477=$(window).width()-$("#toplinkspart ul").width()-$("#logopart").width()-$("#docstausicons").width()-$("#ellipsis").width()-$("#topdocsep").width()-Math.round(screen.width/5)-$("#loading").width();
var _1478=0;
if($("#toplinkspart ul").offset()!=null){
_1478=$("#toplinkspart ul").offset().left;
}
if(jsPUBLIC_VIEW){
$("#sp_docName").css("max-width",_1477-$("#pubdoc").width()-$("#ellipsis").width());
}
$("#docnamepart").css("max-width",_1477);
$("#docnamepart").width(_1477-_1478-$("#ellipsis").offset().left);
var _1479=$("#docnamepart").children().children().first();
$("#docstausicons").css({left:$(_1479).parent().parent().offset().left+$("#docnamepart").width(),position:"absolute"});
if($("#docnamepart").width()<130){
$("#docnamepart").css({minWidth:$(_1479).width()+5});
}
}
}
function insertdefault(_147a){
if(_147a=="rows"){
if(insertCopyRows){
insertCopiedRows("above");
}else{
if(insertCutRows){
insertCutRow("above");
}else{
insertRow("above");
}
}
}else{
if(_147a=="cols"){
if(insertCopyCols){
insertCopiedCols("before");
}else{
if(insertCutCols){
insertCutColumns("before");
}else{
insertCol("before");
}
}
}
}
}
function showSaveMessage(type){
var _147c=getObj("save_message_display");
if(ENABLE_SAVE_MESSAGE&&_147c&&ALLOW_TO_WRITE){
var _147d=getObj("loading");
_147d.style.display="none";
var _147e=_147c.getElementsByTagName("img");
var _147f="";
if((_147e.length>0)){
_147f=_147e[0];
}
_147c.style.display="block";
if(type=="disable"&&DOCUMENT_ID!="doc_id"){
if(updatedSaveTime==""){
_147c.innerHTML=getObj("lastSavedDateTime").value;
}else{
_147c.innerHTML=replaceParams(jsMsg["Save.Message.SavedAt"],new Array(" "+updatedSaveTime));
if(SHAREDUSERSLIST!=""&&COLLAB_ID!=""){
updateSaveToolTip(updatedSaveTime);
}else{
if(_147f!=""){
_147c.innerHTML+=_147f;
}
}
}
}else{
if(type=="enable"){
_147c.innerHTML=jsMsg.Saving+"...";
}else{
_147c.style.display="none";
}
}
}else{
if(!_147c){
if(type=="enable"){
setProgressMessage(jsMsg.Saving);
getObj("loading").style.display="block";
}else{
if(type==" disable"){
setProgressMessage(PREVIOUS_MESSAGE);
getObj("loading").style.display="none";
}
}
}
}
}
function showFBTopBand(){
if(window.top!=window.self){
var _1480=getObj("topPanel");
_1480.style.display="none";
}else{
var _1481=getObj("showfbbanneriframe");
if(_1481){
_1481.src=docs_url;
}
}
var _1482=getObj("topBand");
if(_1482){
$("#sheetOptions").parent().css({"padding-top":"2px"});
_1482.style.marginTop="1px";
_1482.style.marginRight="0px";
_1482.style.marginBottom="-1px";
$("#sheetOptions").css({marginTop:"0px"});
_1482.style.marginLeft="0px";
$("#docnamepart").css({marginLeft:"1px"});
}
}
function doCollabprocess(){
if(COLLAB_ID!=""){
isCollabJoined=false;
var _1483=new getXmlhttp();
_1483.onreadystatechange=function(){
if(_1483.readyState==4){
var _1484=_1483.responseText;
if(_1484!=null&&_1484.trim()!=""){
if(_1484=="WMS_COMMUNICATION_FAILURE"){
handleServerError("ERROR",replaceParams(jsMsg["Banner.ReadOnly.Info.DueToWMSCommunicationException"],new Array("<a onclick='javascript:loadDocument(\""+DOCUMENT_ID+"\");' href='#'>","</a>")),true,true);
return;
}else{
if(_1484=="COLLABORATORS_LIMIT_EXCEEDED"){
handleServerError("ERROR",jsMsg["Public.Collaborators.Limit.Exceeded"],true,true);
return;
}
}
}
if(!isCollabJoined){
setTimeout(handleWMSJoinError,25000);
}
}
};
var _1485="docId="+DOCUMENT_ID+"&viewType="+getViewType()+"&collabid="+COLLAB_ID;
if(jsREMOTE_SAVE_VIEW){
_1485+="&RMLOGINNAME="+RMUSER;
}
sendXMLHTTPRequest(_1483,_1485,true,true,ctxpath+"joinCollab.do");
}
}
function handleWMSJoinError(){
if(!isCollabJoined){
var _1486="collabId="+COLLAB_ID;
if(jsREMOTE_SAVE_VIEW){
handleServerError("ERROR",replaceParams(jsMsg["Banner.ReadOnly.Info.DueToWMSCommunicationException.WithOutRetryOption"]),true,true);
}else{
handleServerError("ERROR",replaceParams(jsMsg["Banner.ReadOnly.Info.DueToWMSCommunicationException"],new Array("<a onclick='javascript:loadDocument(\""+DOCUMENT_ID+"\");' href='#'>","</a>")),true,true);
}
var _1487=new getXmlhttp();
_1487.onreadystatechange=function(){
if(_1487.readyState==4){
}
};
sendXMLHTTPRequest(_1487,_1486,true,true,ctxpath+"quitCollab.do");
}
}
function removeDocOpenLock(){
var _1488="docId="+DOCUMENT_ID+"&docOwner="+CURR_DOC_OWNERNAME;
var _1489=new getXmlhttp();
_1489.onreadystatechange=function(){
if(_1489.readyState==4){
}
};
sendXMLHTTPRequest(_1489,_1488,true,true,ctxpath+"removeLock.do");
}
function setResponseWaitingTime(){
if(!isUndefined(responseWaitingTime)){
clearTimeout(responseWaitingTime);
}
responseWaitingTime=setTimeout(showLoadOn,2000);
}
function clearResponseWaitingTime(){
if(!isUndefined(responseWaitingTime)){
clearTimeout(responseWaitingTime);
}
loadoff();
}
function showLoadOn(){
if(noOfUpdateRequestInProgress>0){
loadon();
}
}
var count=15;
function startCountDown(){
$("#cntDwn").html(count);
if(count==0){
$.sheetdialog.close("#notifyDlgContainer");
document.location.href=location.href;
}
count--;
setTimeout("startCountDown()",1000);
}
function saveasdialog(type){
$.sheetdialog.open(type);
$("#"+type+" :input").val(DOCUMENT_NAME);
if(type=="saveasdialog"){
$("#saveAsFileName").select();
}else{
if(type=="saveastempdialog"){
$("#saveAsTemplateMenuFileName").select();
}
}
}
function savAs(e){
var key;
if(window.event){
key=window.event.keyCode;
}else{
key=e.which;
}
if(key!=13){
return true;
}else{
return saveas();
}
}
function saveAsTemp(e){
var key;
if(window.event){
key=window.event.keyCode;
}else{
key=e.which;
}
if(key!=13){
return true;
}else{
return saveasTemplate();
}
}
InfoBanner={showBanner:function(_148f,_1490,type){
if(!_148f){
return;
}
$("#notifyMsg").html(_148f);
var _1492=(findClientDim().width-$("#notifyContainer").width())/2;
$("#notifyContainer").css("left",_1492);
$("#notifyContainer").css("position","absolute");
$("#notifyContainer").css("top","-2px");
$("#notifyContainer").show();
InfoBanner.setClasses(type);
if(_1490){
setTimeout("InfoBanner.hideBanner()",5000);
}
},setClasses:function(type){
if(!type){
return;
}
$("#notifyContainer").removeClass();
$("#notifyIcon").removeClass();
var bgCls="ui-corner-all ui-znotifier";
var _1495="ui-components-icon";
var brClr="";
switch(type){
case "error":
bgCls+=" ui-state-error";
_1495+=" ui-state-error-icon";
break;
case "info":
bgCls+=" ui-state-info";
_1495+=" ui-state-info-icon";
brClr+="#AFE1FF";
break;
case "success":
bgCls+=" ui-state-status";
_1495+=" ui-state-status-icon";
brClr+="#D2E9C5";
break;
case "warning":
bgCls+=" ui-state-warning";
_1495+=" ui-state-warning-icon";
break;
}
$("#notifyContainer").addClass(bgCls);
$("#notifyIcon").addClass(_1495);
$("#notifyClose").css("border","1px solid "+brClr);
},hideBanner:function(){
$("#notifyContainer").fadeOut();
}};
ConfirmBox={showDialog:function(title,_1498,but1,but2){
$.sheetdialog.open("#confirmDialog",{height:"auto",width:"440px",modal:true,title:title,resizable:false,buttons:[{text:but1,click:function(){
_1498();
$.sheetdialog.close(this);
}},{text:but2,click:function(){
$.sheetdialog.close(this);
}}]});
var elem=$(".ui-dialog").filter(":visible");
elem.keydown(function(e){
if((e.which&&e.which==13)||(e.keyCode&&e.keyCode==13)){
_1498();
$.sheetdialog.close(this);
}
});
},setInfoMsg:function(mess1,mess2,bg,icon,ischk){
if(mess1){
$("#msgBox").html(mess1);
}
if(mess2){
$("#infoChkBox").show();
$("#msgBox2").html(mess2);
if(ischk){
$("#chkBox").attr("checked",true);
}
}
if(bg){
$("#dialogCtnr").addClass("thumbnailView");
}
if(icon){
$("#iconBox").addClass("infoIcon");
$("#msgCtnr").css("marginLeft","40px");
}
},setWarningMsg:function(mess,bg,icon){
if(mess){
$("#msgBox").html(mess);
}
if(bg){
$("#dialogCtnr").addClass("warning");
}
if(icon){
$("#iconBox").addClass("warningSmallIcon");
$("#iconBox").css("marginTop","3px");
$("#msgCtnr").css("marginLeft","30px");
}
return;
}};
ErrorDialog={showdialog:function(data,_14a6,_14a7){
var _14a8=data.substring(data.indexOf("<style"),data.indexOf("</style>")+8);
data=data.replace(_14a8,"");
$.sheetdialog.opendialog(data,_14a6,_14a7);
$("#dialogdesign").show();
var _14a9=$("#sheetdialog");
_14a9.children("link").remove();
_14a9.children("meta").remove();
_14a9.children("title").remove();
_14a9.children("div #pagedesign").remove();
}};
var OLE={};
function _ole(id){
this.el=getObj(id);
this.type=this.el.objType;
this.sheet=CURRSHEETNAME;
this.document=DOCUMENT_ID;
this.id=id;
this.height=parseInt(this.el.offsetHeight,10);
this.width=parseInt(this.el.offsetWidth,10);
this.top=parseInt(this.el.style.top,10);
this.left=parseInt(this.el.style.left,10);
this.zIndex=this.el.style.zIndex=ole.iniZIndex;
this.isExposed=false;
this.isSynchronized=true;
this.permitToDesign=true;
this.isResizedOnce=false;
this.isDraggedOnce=false;
this.isEnabled=true;
this.isResizeSidesChecked=false;
this.isMovedOrResizedAfterClone=false;
this.cloneCountSinceLastDragOrResize=0;
this.el.onmouseover=function(ev){
if(!ole.onDrag&&!ole.onResize&&ole.objects[this.objType].onmouseover){
ole.objects[this.objType].onmouseover(this.id,ev);
}
OLE[id].focus(ev);
};
this.el.onmouseout=function(ev){
if(!ole.onDrag&&!ole.onResize&&ole.objects[this.objType].onmouseout){
if(!ole(this.id).permitToDesign){
}
ole.objects[this.objType].onmouseout(this.id,ev);
}
};
}
ole=function(){
var _14ad;
if(OLE[arguments[0]]==null){
_14ad=ole.init(arguments[0]);
}else{
_14ad=OLE[arguments[0]];
}
return _14ad;
};
ole.objectsSubHeader={};
ole.typesRegistered=[];
ole.init=function(id){
OLE[id]=new _ole(id);
var type=OLE[id].type;
if(ole.typesRegistered.indexOf(type)===-1){
ole.constructSubHeader(type);
ole.typesRegistered.push(type);
}
return OLE[id];
};
ole.currObjLeft=0;
ole.currObjTop=0;
ole.alpha=0;
ole.alphaValue=0;
ole.onDrag=false;
ole.onResize=false;
ole.cloneCount=0;
ole.isDragged=false;
ole.isResized=false;
ole.count=-1;
ole.editModeTDs=0;
ole.iniZIndex=100;
ole.isCalledOnce=false;
ole.contextMenuStatus=false;
ole.isActionBarLocked=false;
ole.isBlurredOnLayerSwitch=false;
ole.isObjContextMenuCreated=false;
ole.isFirstClickOutsideOLECompleted=false;
ole.objects={defaultObjectProperties:{focusLayer:"OLEFocusLayer",selectLayer:"OLESelectLayer",menuData:"",minHeight:10,minWidth:10,actionBar:"",contextMenu:"",permissions:{isDraggable:true,isResizable:true,isEditable:false},resizeCorners:"",resizeCornersBehaviour:"",onActionBarMouseDown:undefined,onAfterFocus:undefined,onBeforeLoadActionBar:undefined,onClone:undefined,onCtrlKeyDown:undefined,onCtrlKeyUp:undefined,onCtrlKeyPress:undefined,onDbClick:undefined,onDragStart:undefined,onDrag:undefined,onDragEnd:undefined,onFocusLayerMouseDown:undefined,onExpose:undefined,onFirstMouseDownOutsideOLEElements:undefined,onMask:undefined,onMouseDownOutsideOLEElements:undefined,onMouseDownOverOLEElements:undefined,onmouseover:undefined,onmouseout:undefined,onRemove:undefined,onOLEObjMouseDown:undefined,onObjectSwitch:undefined,onObjectTypeSwitch:undefined,onResizeStart:undefined,onResize:undefined,onResizeEnd:undefined,onSelectLayerMouseDown:undefined,onSync:undefined}};
_ole.prototype={focus:function(ev){
var _14b1=ole.getObjectPermissions(this.id,["isDraggable","isResizable"]);
if((_14b1.isDraggable||_14b1.isResizable)&&this.isEnabled){
if(this.permitToDesign&&!ole.onDrag&&!ole.onResize&&!this.isExposed){
if(ole.currFocusObj&&ole.currFocusObj!==this&&ole.currFocusObj!==ole.currObj){
ole.currFocusObj.getFocusLayer().style.display="none";
}
ole.currFocusObj=this;
this.setFocusLayer();
this.getFocusLayer().style.filter="alpha(opacity=0)";
ole.isBlurredOnLayerSwitch=false;
var _14b2=this.getFocusLayer();
_14b2.style.filter="alpha(opacity=100)";
_14b2.style.opacity=0.99;
if(ole.objects[this.type].onAfterFocus){
ole.objects[this.type].onAfterFocus(this.id,ev);
}
}
}
return this;
},blur:function(ev){
if(isUndefined(this)){
return false;
}
if(browser_ie){
ev=window.event;
}
var _14b4=this.getFocusLayer();
var x=ev.clientX+getSheetScrollLeft()-sheetLeft;
var y=ev.clientY+getSheetScrollTop()-sheetTop;
var x1=parseInt(_14b4.style.left,10);
var y1=parseInt(_14b4.style.top,10);
var x2=x1+parseInt(_14b4.style.width,10);
var y2=y1+parseInt(_14b4.style.height,10);
if(x<(x1+3)||x>(x2-4)||y<(y1+3)||y>(y2-4)){
_14b4.style.filter="alpha(opacity=1)";
_14b4.style.opacity=0.01;
_14b4.style.display="none";
this.sendToBack();
}
stopEvt(ev);
return this;
},fadeIn:function(){
var _14bb=this.getFocusLayer();
if(ole.alpha<10){
_14bb.style.opacity=ole.alpha/10;
_14bb.style.filter="alpha(opacity="+(ole.alpha*10)+")";
ole.alpha++;
}else{
_14bb.style.opacity=0.99;
_14bb.style.filter="alpha(opacity=100)";
window.clearInterval(OLEFadeInIntvl);
}
return this;
},fadeOut:function(){
if(ole.alpha>0){
focusLayer.style.opacity=(ole.alpha/10);
focusLayer.style.filter="alpha(opacity="+(ole.alpha*10)+")";
ole.alpha--;
}else{
ole.alpha=0;
focusLayer.style.opacity=0.01;
focusLayer.style.filter="alpha(opacity=0)";
focusLayer.style.display="none";
window.clearInterval(OLEFadeOutIntvl);
}
return this;
},getLeft:function(){
return this.left;
},getTop:function(){
return this.top;
},getHeight:function(){
return this.height;
},getWidth:function(){
return this.width;
},getPos:function(){
return {left:this.getLeft(),top:this.getTop()};
},getRearPos:function(){
return {x:this.getRearX(),y:this.getRearY()};
},getDim:function(){
return {width:this.getWidth(),height:this.getHeight()};
},getZIndex:function(){
return this.zIndex;
},getRearX:function(){
return (parseInt(this.left,10)+parseInt(this.width,10));
},getRearY:function(){
return (parseInt(this.top,10)+parseInt(this.height,10));
},setRearX:function(x){
var left=x-this.width;
if(left>0){
this.setLeft(left);
}
return this;
},setRearY:function(y){
var top=y-this.height;
if(top>0){
this.setTop(top);
}
return this;
},calcMaxHeight:function(_14c0){
this.maxHeight=_14c0-this.maxHeight;
return this;
},getMaxHeight:function(){
return this.maxHeight;
},getMaxWidth:function(){
},getMinLeft:function(){
},getMaxLeft:function(){
},getMinTop:function(){
},getMaxTop:function(){
},setLeft:function(left){
this.left=left;
this.el.style.left=left+"px";
ole.clearObjectsPositionCache();
return this;
},setTop:function(top){
this.top=top;
this.el.style.top=top+"px";
ole.clearObjectsPositionCache();
return this;
},setHeight:function(_14c3){
if(_14c3>0){
this.height=_14c3;
this.el.style.height=_14c3+"px";
}
return this;
},setWidth:function(width){
this.width=width;
this.el.style.width=width+"px";
return this;
},switchLayers:function(ev){
ole.isBlurredOnLayerSwitch=true;
if(ole.currObj){
ole.prevObj=ole.currObj;
}
ole.currObj=this;
if(ole.objects[this.type].onFocusLayerMouseDown){
ole.objects[this.type].onFocusLayerMouseDown(this.id,ev);
}
this.setSelectLayer().displayAssociativeElements("","none").positionActionBar();
stopEvt(ev);
return this;
},getSelectLayer:function(){
var type=this.type;
subHeader=ole.objectsSubHeader[type];
if(!subHeader.selectLayer){
ole.createSelectAndFocusLayer(type);
}
return subHeader.selectLayer;
},setSelectLayer:function(_14c7,_14c8){
var _14c9=ole.getObjectPermissions(this.id,["isDraggable","isResizable"]);
if((_14c9.isDraggable||_14c9.isResizable)&&this.isEnabled){
ole.currObj=this;
ole.conf.onfocus();
if(isUndefined(ole.tempObj)){
ole.tempObj=this;
}else{
if(ole.tempObj!==ole.currObj){
ole.prevObj=ole.tempObj;
}
}
var _14ca=ole.currObj.getSelectLayer();
this.bringToFront();
if(ole.prevObj){
if(ole.prevObj!==this){
if(!ole.onDrag&&!ole.onResize){
this.cloneCountSinceLastDragOrResize=0;
if(ole.prevObj.type!==ole.currObj.type){
ole.prevObj.displayAssociativeElements("none","none","none");
if(ole.objects[this.type].onObjectTypeSwitch){
ole.objects[this.type].onObjectTypeSwitch(this.id);
}
}
if(OLE[ole.prevObj.id]&&ole.objects[ole.prevObj.type].onObjectSwitch){
ole.objects[ole.prevObj.type].onObjectSwitch(ole.prevObj.id);
}
}
}
}
ole.tempObj=this;
ole.activeState=true;
var diffX=ole.objectsSubHeader[this.type].selectLayerDiffX;
var diffY=ole.objectsSubHeader[this.type].selectLayerDiffY;
_14ca.style.left=parseInt(this.el.style.left,10)-diffX+"px";
_14ca.style.top=parseInt(this.el.style.top,10)-diffY+"px";
_14ca.style.height=parseInt(this.el.offsetHeight,10)+(2*diffY)+"px";
_14ca.style.width=parseInt(this.el.offsetWidth,10)+(2*diffX)+"px";
if(!browser_ie){
$(_14ca).children().first().find(".select").height($(this.el).height()+(2*diffY));
}else{
$(_14ca).children().first().find(".select").height($(this.el).height());
}
$(_14ca).children().first().find(".select").width($(this.el).width()+(2*diffX));
_14ca.style.zIndex=this.zIndex+1;
_14ca.style.display="block";
ole.isFirstClickOutsideOLECompleted=false;
}
return this;
},getFocusLayer:function(){
var type=this.type;
subHeader=ole.objectsSubHeader[type];
if(!subHeader.focusLayer){
ole.createSelectAndFocusLayer(type);
}
return subHeader.focusLayer;
},setFocusLayer:function(){
ole.currFocusObj=this;
var diffX=ole.objectsSubHeader[this.type].focusLayerDiffX;
var diffY=ole.objectsSubHeader[this.type].focusLayerDiffY;
var _14d0=this.getFocusLayer();
_14d0.style.left=parseInt(this.el.style.left,10)-diffX+"px";
_14d0.style.top=parseInt(this.el.style.top,10)-diffY+"px";
_14d0.style.height=parseInt(this.el.offsetHeight,10)+(2*diffY)+"px";
_14d0.style.width=parseInt(this.el.offsetWidth,10)+(2*diffX)+"px";
if(!browser_ie){
$(_14d0).children().first().find(".focusGrid").height($(this.el).height()+(2*diffY));
}else{
$(_14d0).children().first().find(".focusGrid").height($(this.el).height());
}
$(_14d0).children().first().find(".focusGrid").width($(this.el).width()+(2*diffX));
_14d0.style.zIndex=this.zIndex+1;
_14d0.style.display="block";
return this;
},getActionBar:function(){
var _14d1=ole.objectsSubHeader[this.type];
if(_14d1.hasActionBar){
return _14d1.actionBar;
}
},displayAssociativeElements:function(_14d2,_14d3,_14d4){
var _14d5=this.getSelectLayer();
var _14d6=this.getFocusLayer();
if(!isUndefined(_14d2)){
_14d5.style.display=_14d2;
}
if(!isUndefined(_14d3)){
_14d6.style.display=_14d3;
}
if(!isUndefined(_14d4)&&ole.objectsSubHeader[this.type].hasActionBar){
this.getActionBar().style.display=_14d4;
}
return this;
},deSelect:function(){
this.displayAssociativeElements("none","none","none").hideContextMenu();
if(this.isExposed){
this.mask().isExposed=false;
}
ole.conf.onblur();
ole.currObj=null;
ole.activeState=false;
return this;
},showContextMenu:function(ev){
var _14d8=ole.getObjectPermissions(this.id,["isDraggable","isResizable"]);
if(ole.objectsSubHeader[this.type].hasContextMenu&&(_14d8.isDraggable||_14d8.isResizable)&&this.isEnabled){
ole.isObjContextMenuCreated=false;
if(!ole.isObjContextMenuCreated){
if(browser_ie){
Menu._getCursorPos();
}else{
if(browser_nn6){
Menu._getCursorPos(ev);
}
}
var _14d9=ole.objects[this.type];
createContextMenu(_14d9.menuData,{inputType:"xml"});
showMenu(_14d9.contextMenu);
ole.isObjContextMenuCreated=true;
}
if(browser_ie){
ev=window.event;
}
stopEvent(ev);
ole.contextMenuStatus=true;
}else{
stopEvent(ev);
stopEvt(ev);
}
return this;
},hideContextMenu:function(){
if(ole.contextMenuStatus){
hideMenu(ole.objects[this.type].contextMenu);
ole.contextMenuStatus=false;
return this;
}
},moveTo:function(left,top){
this.setLeft(left).setTop(top);
return this;
},resizeTo:function(width,_14dd){
this.setWidth(width).setHeight(_14dd);
return this;
},expose:function(){
this.isExposed=true;
if(ole.objects[this.type].onExpose){
ole.objects[this.type].onExpose(this.id);
}
return this;
},mask:function(){
this.el.style.zIndex=this.zIndex;
this.isExposed=false;
if(ole.objects[this.type].onMask){
ole.objects[this.type].onMask(this.id);
}
return this;
},setZIndex:function(_14de){
this.el.style.zIndex=_14de;
this.zIndex=_14de;
return this;
},bringToFront:function(){
if(!ole.getObjectProperty(this.type,"hasOrdering")){
ole.resetZIndex();
this.setZIndex(105);
if(ole.isSelected(this.id)){
this.getSelectLayer().style.zIndex=106;
}else{
if(ole.currObj){
ole.currObj.setZIndex(103);
ole.currObj.getSelectLayer().style.zIndex=104;
}
}
if(ole.isFocussed(this.id)){
this.getFocusLayer().style.zIndex=106;
}else{
currFocusObj=ole.currFocusObj;
if(currFocusObj){
currFocusObj.setZIndex(103);
currFocusObj.getFocusLayer().style.zIndex=104;
}
}
}else{
var _14df=ole.sortByZIndex();
for(var i=_14df.length-1;i>0;i--){
if(_14df[i][0]===this.id){
break;
}else{
var temp=ole(_14df[i][0]).zIndex;
ole(_14df[i][0]).setZIndex(ole(_14df[i-1][0]).zIndex);
ole(_14df[i-1][0]).setZIndex(temp);
}
}
var _14e2=this.getSelectLayer();
if(_14e2.style.display!=="none"){
_14e2.style.zIndex=parseInt(this.zIndex,10)+1;
}
}
return this;
},sendToBack:function(){
if(ole.isBlurredOnLayerSwitch){
return this;
}
if(!ole.getObjectProperty(this.type,"hasOrdering")){
ole.resetZIndex();
this.setZIndex(99);
if(ole.isSelected(this.id)){
this.getSelectLayer().style.zIndex=100;
}else{
if(ole.currObj){
ole.currObj.setZIndex(103);
ole.currObj.getSelectLayer().style.zIndex=104;
}
}
if(ole.isFocussed(this.id)){
this.getFocusLayer().style.zIndex=100;
}else{
currFocusObj=ole.currFocusObj;
if(currFocusObj){
currFocusObj.setZIndex(103);
currFocusObj.getFocusLayer().style.zIndex=104;
}
}
}else{
var _14e3=ole.sortByZIndex();
for(var i=0;i<_14e3.length-1;i++){
if(_14e3[i][0]===this.id){
break;
}else{
var temp=ole(_14e3[i][0]).zIndex;
ole(_14e3[i][0]).setZIndex(ole(_14e3[i+1][0]).zIndex);
ole(_14e3[i+1][0]).setZIndex(temp);
}
}
if(selectLayer.style.display!=="none"){
selectLayer.style.zIndex=parseInt(this.zIndex,10)+1;
focusLayer.style.zIndex=parseInt(ole.currFocusObj.zIndex,10)+1;
}
}
return this;
},positionActionBar:function(_14e6){
var _14e7=ole.getObjectPermissions(this.id,["isDraggable","isResizable"]);
if(_14e7.isDraggable||_14e7.isResizable){
var _14e8=ole.objectsSubHeader[this.type];
if(_14e8.hasActionBar&&!ole.isActionBarLocked){
if(ole.objects[this.type].onBeforeLoadActionBar){
ole.objects[this.type].onBeforeLoadActionBar(this.id);
}
var _14e9=this.getSelectLayer();
var _14ea=screen.width;
var _14eb=screen.height;
var y=parseInt(_14e8.actionBarHt,10);
var x=parseInt(_14e8.actionBar.offsetWidth,10);
var _14ee=sheetTop-y-_14e8.actionBarDiffX;
var left=(parseInt(_14e9.style.left,10)+sheetLeft-getSheetScrollLeft())+"px";
var top=(parseInt(_14e9.style.top,10)-(y+_14e8.actionBarDiffX)+sheetTop-getSheetScrollTop())+"px";
var _14f1=this.getActionBar();
var _14f2=_14f1.style.left;
var _14f3=_14f1.style.top;
_14f1.style.left=((parseInt(left,10)+x)>=_14ea)?(_14ea-x-2):parseInt(left,10)+"px";
_14f1.style.left=(parseInt(_14f1.style.left,10)<0)?0:parseInt(_14f1.style.left,10)+"px";
_14f1.style.top=((parseInt(top,10)+y)>=_14eb)?(_14eb-y-2):parseInt(top,10)+"px";
_14f1.style.top=(parseInt(_14f1.style.top,10)<_14ee)?_14ee:parseInt(_14f1.style.top,10)+"px";
if(isUndefined(_14e6)){
_14e6=true;
}
ole.focusActionBar(_14e6);
}
}
return this;
},setDesignMode:function(mode){
this.permitToDesign=mode;
return this;
},clone:function(_14f5,_14f6,_14f7,ht,wd){
var _14fa=ole.cloneElement(this.el.id);
ole.constructOLEObj(_14fa);
if(isUndefined(_14f6)){
_14f6=20;
}
if(isUndefined(_14f7)){
_14f7=20;
}
if(isUndefined(ht)){
ht=this.height;
}
if(isUndefined(wd)){
wd=this.width;
}
if(_14f5==1){
OLE[_14fa].setLeft(_14f6+parseInt(this.left,10)).setTop(_14f7+parseInt(this.top,10)).setHeight(ht).setWidth(wd);
ole.sendServerRequestOnClone(_14fa,1);
this.cloneCountSinceLastDragOrResize+=1;
}else{
if(_14f5==2){
ole.setElementStyleProps(_14fa,true,true,true,_14f6+parseInt(this.left,10),_14f7+parseInt(this.top,10),ht,wd,"none",0.99);
ole.sendServerRequestOnClone(_14fa,2);
}
}
return this;
},synchronizeClones:function(_14fb,_14fc,id){
if(_14fb==1){
}
if(_14fb==2){
ole(_14fc).style.display="";
if(!isUndefined(arguments[3])){
ole(_14fc).setLeft(parseInt(arguments[3],10));
}
if(!isUndefined(arguments[4])){
ole(_14fc).setTop(parseInt(arguments[4],10));
}
if(!isUndefined(arguments[5])){
ole(_14fc).setHeight(parseInt(arguments[5],10));
}
if(!isUndefined(arguments[6])){
ole(_14fc).setWidth(parseInt(arguments[6],10));
}
}
OLE[id]=OLE[_14fc];
OLE[id].id=OLE[id].el.id=id;
if(_14fb==2){
ole.prevObj=ole.currObj;
ole.currObj=OLE[id];
}
OLE[_14fc]=null;
delete OLE[_14fc];
var _14fe=OLE[id];
_14fe.el.onmouseover=function(ev){
if(ole.objects[this.objType].onmouseover){
ole.objects[this.objType].onmouseover(this.id,ev);
}
OLE[id].focus(ev);
};
if(ole.objects[this.type].onSync){
ole.objects[this.type].onSync(id,_14fc,_14fe.left,_14fe.top,_14fe.height,_14fe.width);
}
ole(id).isSynchronized=true;
return OLE[id];
},resetActionBarState:function(){
var _1500=this.getActionBar().getElementsByTagName("TD");
for(var i=0;i<_1500.length;i++){
if((_1500[i].className==="iconText pressed")){
_1500[i].className="iconText";
}
}
return this;
},getActionBarButtonStateByTitle:function(_1502){
var _1503=this.getActionBar().getElementsByTagName("TD");
for(var i=0;i<_1503.length;i++){
if((_1503[i].title===_1502)){
var _1505=_1503[i].className;
if(_1505==="iconText pressed"){
return {classValue:_1505,state:"pressed"};
}else{
if(_1505==="iconText"){
return {classValue:_1505,state:"notpressed"};
}else{
if(_1505==="iconText hover"){
return {classValue:_1505,state:"hover"};
}
}
}
}
}
},setActionBarButtonStateByTitle:function(_1506,_1507,_1508){
var _1509=this.getActionBar().getElementsByTagName("TD");
for(var i=0;i<_1509.length;i++){
if((_1509[i].title===_1506)){
_1509[i].className=_1507;
}
}
if(_1508){
for(var i=0;i<_1509.length;i++){
if((_1509[i].title!==_1506)&&((_1509[i].className==="iconText pressed")||(_1509[i].className==="iconText hover"))){
_1509[i].className="iconText";
}
}
}
return this;
},overrideProperties:function(map){
this.isPermissionsOverridden=true;
this.overriddenPermissions=map;
return this;
},deOverrideProperties:function(){
this.isPermissionsOverridden=false;
this.overriddenPermissions=undefined;
return this;
},lockActionBar:function(){
ole.isActionBarLocked=true;
return this;
},unlockActionBar:function(){
ole.isActionBarLocked=false;
return this;
},brightenActionBar:function(){
this.getActionBar().className="toolbar mouseOver";
return this;
},dimDownActionBar:function(){
this.getActionBar().className="toolbar";
return this;
},enable:function(){
this.isEnabled=true;
return this;
},disable:function(){
this.isEnabled=false;
return this;
}};
ole.createObjectProperties=function(obj,map){
if(isUndefined(ole.objects[obj])){
ole.objects[obj]={};
}
ole.objects[obj]=map;
};
ole.extentProperty=function(_150e,value){
_ole.prototype[_150e]=value;
};
ole.removeObjectProperties=function(obj,_1511){
if(!_1511){
ole.objects[obj]={};
}else{
if(!isUndefined(ole.objects[obj])){
for(var i=0,len=_1511.length;i<len;i++){
ole.objects[obj][key]=undefined;
}
}
}
};
ole.removeObjectProperty=function(obj,key){
if(!isUndefined(ole.objects[obj])){
if(!isUndefined(ole.objects[obj].key)){
ole.objects[obj][key]=undefined;
}
}
};
ole.setObjectProperties=function(obj,map){
if(!isUndefined(ole.objects[obj])){
for(x in map){
ole.objects[obj][x]=map[x];
}
}
};
ole.setObjectProperty=function(obj,key,value){
if(!isUndefined(ole.objects[obj])){
ole.objects[obj][key]=value;
}
};
ole.setObjectsLeft=function(left,_151c,_151d,_151e){
var _151f=[];
if(typeof _151c=="undefined"){
_151c=ole.getObjects();
}
for(var i=0;i<_151c.length;i++){
if(_151c[i].left+(left)<0){
_151f[i]=0;
_151c[i].setLeft(0);
}else{
if(typeof _151d=="undefined"){
_151f[i]=_151c[i].left+(left);
_151c[i].setLeft(_151c[i].left+(left));
}else{
_151f[i]=left[i];
_151c[i].setLeft(left[i]);
}
}
}
if(typeof _151e=="undefined"||_151e==true){
ole.conf.onPositionChange(_151c,_151f);
}
if(ole.getCurrObj()){
ole.getCurrObj().setSelectLayer().positionActionBar();
}
};
ole.getObjectsLeft=function(_1521){
var _1522=[];
if(typeof _1521=="undefined"){
_1521=ole.getObjects();
}
for(var i=0;i<_1521.length;i++){
_1522[i]=_1521[i].left;
}
return _1522;
};
ole.setObjectsTop=function(top,_1525,_1526,_1527){
var _1528=[];
if(typeof _1525=="undefined"){
_1525=ole.getObjects();
}
for(var i=0;i<_1525.length;i++){
if(_1525[i].top+(top)<0){
_1528[i]=0;
_1525[i].setTop(0);
}else{
if(typeof _1526=="undefined"){
_1528[i]=_1525[i].top+(top);
_1525[i].setTop(_1525[i].top+(top));
}else{
_1528[i]=top[i];
_1525[i].setTop(top[i]);
}
}
}
if(typeof _1527=="undefined"||_1527==true){
ole.conf.onPositionChange(_1525,_1528);
}
if(ole.getCurrObj()){
ole.getCurrObj().setSelectLayer().positionActionBar();
}
};
ole.getObjectsTop=function(_152a){
var _152b=[];
if(typeof _152a=="undefined"){
_152a=ole.getObjects();
}
for(var i=0;i<_152a.length;i++){
_152b[i]=_152a[i].top;
}
return _152b;
};
ole.setObjectsWidth=function(width,_152e){
if(typeof _152e=="undefined"){
_152e=ole.getObjects();
}
for(var i=0;i<_152e.length;i++){
_152e[i].setWidth(_152e[i].width+(width)).setSelectLayer().setFocusLayer();
ole.getObjectProperty(_152e[i].type,"onResizeEnd")(_152e[i].id,_152e[i].width+(width),_152e[i].height);
}
};
ole.setObjectsHeight=function(_1530,_1531){
if(typeof _1531=="undefined"){
_1531=ole.getObjects();
}
for(var i=0;i<_1531.length;i++){
_1531[i].setHeight(_1531[i].height+(_1530)).setSelectLayer().setFocusLayer();
ole.getObjectProperty(_1531[i].type,"onResizeEnd")(_1531[i].id,_1531[i].width,_1531[i].height+(_1530));
}
};
ole.getObjectsByPositionX=function(from,to){
var obj=[];
var i=0;
for(x in OLE){
var _1537=OLE[x].left;
var _1538=OLE[x].left+OLE[x].width;
if(typeof to=="undefined"){
if(OLE[x]&&from<=_1537){
obj[i++]=OLE[x];
}
}else{
if(typeof from=="undefined"){
from=0;
}
if(OLE[x]&&((from<=_1537&&to>=_1537)||(from<=_1538&&to>=_1538))){
obj[i++]=OLE[x];
}else{
if(OLE[x]&&(_1537<from&&_1538>to)){
obj[i++]=OLE[x];
}
}
}
}
return obj;
};
ole.getObjectsByPositionY=function(from,to){
var obj=[];
var i=0;
for(x in OLE){
var _153d=OLE[x].top;
var _153e=OLE[x].top+OLE[x].height;
var _153f=_153e;
if(typeof to=="undefined"){
if(OLE[x]&&from<=_153d){
obj[i++]=OLE[x];
}
}else{
if(typeof from=="undefined"){
from=0;
}
if(OLE[x]&&((from<=_153d&&to>=_153d)||(from<=_153e&&to>=_153e))){
obj[i++]=OLE[x];
}else{
if(OLE[x]&&(_153d<from&&_153e>to)){
obj[i++]=OLE[x];
}
}
}
}
return obj;
};
ole.getElement=function(obj,key){
if(getObj(ole.getObjectProperty(obj,key))){
getObj(ole.getObjectProperty(obj,key));
}
};
ole.getObjectProperty=function(obj,key){
if(!isUndefined(ole.objects[obj][key])){
return ole.objects[obj][key];
}
};
ole.getObjectProperties=function(obj){
if(!isUndefined(ole.objects[obj])){
return ole.objects[obj];
}
};
ole.onOpenNewDoc=function(ev){
if(ole.currObj){
ole.currObj.deSelect();
}
};
ole.reset=function(){
OLE={};
var types=ole.typesRegistered;
for(var x=0,len=types.length;x<len;x++){
var _1549=ole.objectsSubHeader[types[x]];
_1549.selectLayer=undefined;
_1549.focusLayer=undefined;
}
};
ole.copy=function(){
};
ole.paste=function(){
};
ole.cut=function(){
};
ole.onCtrlKeyDown=function(ev,el){
for(x in ole.objects){
if(ole.objects[x].onCtrlKeyDown){
ole.objects[x].onCtrlKeyDown(ev);
}
}
};
ole.onCtrlKeyUp=function(ev,el){
for(x in ole.objects){
if(ole.objects[x].onCtrlKeyUp){
ole.objects[x].onCtrlKeyUp(ev);
}
}
};
ole.onCtrlKeyUp=function(ev,el){
for(x in ole.objects){
if(ole.objects[x].onCtrlKeyUp){
ole.objects[x].onCtrlKeyUp(ev);
}
}
};
ole.onCtrlKeyPress=function(ev,el){
for(x in ole.objects){
if(ole.objects[x].onCtrlKeyPress){
ole.objects[x].onCtrlKeyPress(ev);
}
}
};
ole.getObjects=function(type,_1553){
var obj=[];
var i=0;
if(typeof _1553=="undefined"||_1553==null){
_1553=OLE;
}
for(x in _1553){
if(_1553[x]&&(_1553[x].type===type)){
obj[i++]=_1553[x];
}else{
if(typeof type=="undefined"||type==null){
obj[i++]=_1553[x];
}
}
}
return obj;
};
ole.isSelected=function(id){
return ((ole.currObj&&ole.currObj.id===id)?true:false);
};
ole.isFocussed=function(id){
return ((ole.currFocusObj&&ole.currFocusObj.id===id)?true:false);
};
ole.getCurrObj=function(){
return ole.currObj;
};
ole.getObjectPermissions=function(id,_1559){
var obj={};
for(var i=0;i<_1559.length;i++){
if(ole(id).isOverridden){
if(!isUndefined(ole(id).overriddenPermissions[ole.objects[ole(id).type]["permissions"][_1559[i]]])){
obj[_1559[i]]=ole(id).overriddenPermissions[_1559[i]];
}else{
obj[_1559[i]]=ole.objects[ole(id).type]["permissions"][_1559[i]];
}
}else{
if(!isUndefined(ole.objects[ole(id).type]["permissions"][_1559[i]])){
obj[_1559[i]]=ole.objects[ole(id).type]["permissions"][_1559[i]];
}
}
}
return obj;
};
ole.createSelectAndFocusLayer=function(type){
header=ole.objects[type];
subHeader=ole.objectsSubHeader[type];
if(!subHeader.selectLayer||!subHeader.focusLayer){
var count=ole.cloneCount++;
var _155e=getObj(header.selectLayer||ole.objects.defaultObjectProperties.selectLayer).cloneNode(true);
_155e.id=_155e.id+count;
var _155f=getObj(header.focusLayer||ole.objects.defaultObjectProperties.focuslayer).cloneNode(true);
_155f.id=_155f.id+count;
ole.getWorkSpace().appendChild(_155e);
ole.getWorkSpace().appendChild(_155f);
subHeader.selectLayer=_155e;
subHeader.focusLayer=_155f;
ole.setResizeCorners(type).setSelectAndFocusLayerEvents(type);
}
};
ole.constructSubHeader=function(type){
if(isUndefined(ole.objectsSubHeader[type])){
var obj=ole.objectsSubHeader[type]={};
ole.createSelectAndFocusLayer(type);
obj.selectLayerDiffX=7;
obj.selectLayerDiffY=7;
obj.focusLayerDiffX=7;
obj.focusLayerDiffY=7;
obj.X1=0;
obj.Y1=0;
obj.X2=1000;
obj.Y2=1000;
obj.hasActionBar=ole.inspectActionBar(type);
obj.hasContextMenu=ole.inspectContextMenu(type);
if(obj.hasActionBar){
obj.actionBar=getObj(ole.objects[type].actionBar);
obj.actionBarDiffX=3;
obj.actionBarHt=obj.actionBar.offsetHeight;
obj.actionBarWd=obj.actionBar.offsetWidth;
}
ole.setResizeCorners(type).setSelectAndFocusLayerEvents(type);
}
};
ole.fadeInActionBar=function(){
if(ole.currObj&&ole.objectsSubHeader[ole.currObj.type].hasActionBar&&!ole.isActionBarLocked){
var _1562=ole.currObj.getActionBar();
if(ole.alphaValue<10){
_1562.style.opacity=ole.alphaValue/10;
_1562.style.filter="alpha(opacity="+(ole.alphaValue*10)+")";
ole.alphaValue++;
}else{
_1562.style.opacity=1;
_1562.style.filter="alpha(opacity=100)";
window.clearInterval(ActnFadeInIntvl);
}
}
};
ole.focusActionBar=function(_1563){
if(!ole.currObj){
return;
}
if(ole.objectsSubHeader[ole.currObj.type].hasActionBar){
if(typeof ActnFadeInIntvl!=="undefined"){
window.clearInterval(ActnFadeInIntvl);
}
if(typeof ActnFadeOutIntvl!=="undefined"){
window.clearInterval(ActnFadeOutIntvl);
}
var intvl;
if(browser_ie){
intvl=15;
}else{
if(browser_nn6){
intvl=20;
}
}
var _1565=ole.currObj.getActionBar();
if(_1563){
if((parseInt(_1565.style.opacity,10)>=0)||(_1565.style.opacity==="")){
_1565.style.opacity=0;
_1565.style.filter="alpha(opacity=0)";
}
if(_1565.style.display==="none"){
_1565.style.display="";
}
ActnFadeInIntvl=window.setInterval(function(){
ole.fadeInActionBar();
},intvl);
ole.alphaValue=0;
}else{
if(_1565.style.display==="none"){
_1565.style.display="";
}
_1565.style.opacity=1;
_1565.style.filter="alpha(opacity=100)";
}
}
};
ole.remove=function(id,_1567){
if(!(isUndefined(OLE[id])||OLE[id]===null)){
if(isUndefined(arguments[2])||arguments[2]===true){
OLE[id].displayAssociativeElements("none","none","none").hideContextMenu();
}
if(_1567){
if(ole.objects[OLE[id].type].onRemove){
ole.objects[OLE[id].type].onRemove(OLE[id].id);
}
}
var _1568=getObj(id).parentNode;
ole.currObj=null;
delete OLE[id];
if(_1568!==null){
_1568.removeChild(getObj(id));
}
ole.clearObjectsPositionCache();
}
};
ole.inspectActionBar=function(type){
var _156a=ole.objects[type];
return _156a.actionBar?true:false;
};
ole.inspectContextMenu=function(type){
var _156c=ole.objects[type];
return _156c.contextMenu?true:false;
};
ole.cloneElement=function(elId){
ole.cloneCount++;
var _156e=getObj(elId).cloneNode(true);
_156e.id="clone"+ole.cloneCount;
if(ole.currObj.type!=="undefined"){
_156e.objType=ole.currObj.type;
}
ole.getWorkSpace().appendChild(_156e);
return _156e.id;
};
ole.setElementStyleProps=function(elId,_1570,_1571,_1572){
var _1573,el;
el=getObj(elId);
if(_1570){
el.style.left=arguments[4];
el.style.top=arguments[5];
}
if(_1571){
if(_1570){
el.style.height=arguments[6];
el.style.width=arguments[7];
}else{
if(!_1570){
el.style.height=arguments[4];
el.style.width=arguments[5];
}
}
}
if(_1572){
if(_1570&&_1571){
_1573=8;
}else{
if(!_1570&&!_1571){
_1573=4;
}else{
if((!_1570&&_1571)||(_1570&&!_1571)){
_1573=6;
}
}
}
if(typeof (arguments[_1573])!=="undefined"){
el.style.display=arguments[_1573];
el.style.opacity=arguments[_1573+1];
el.style.filter="alpha(opacity = "+el.style.opacity*100+")";
if(!(isUndefined(arguments[_1573+2])||arguments[_1573+2]===null)){
el.style.zIndex=parseInt(arguments[_1573+2],10);
}
}
}
};
ole.setMaxHeight=function(_1575){
ole.maxHeight=_1575;
return this;
};
ole.setMaxWidth=function(width){
ole.maxWidth=width;
};
ole.getMaxHeight=function(){
return ole.maxHeight;
};
ole.getMaxWidth=function(){
return ole.maxWidth;
};
ole.setMaxTopAndMaxHeight=function(_1577){
relativeY=ole.getMaxHeight()-_1577;
for(x in OLE){
}
return this;
};
ole.setMaxLeftAndMaxWidth=function(_1578){
relativeX=ole.getMaxHeight()-_1578;
for(x in OLE){
}
return this;
};
ole.constructOLEObj=function(elId){
ole(elId);
OLE[elId].parentId=ole.currObj.id;
this.isSynchronized=false;
};
ole.setAsCurrObj=function(elId){
ole.prevObj=ole.currObj;
ole.currObj=OLE[elId];
return ole.currObj;
};
ole.sendServerRequestOnClone=function(elId,_157c){
if(ole.objects[ole.currObj.type].onClone){
var _157d=OLE[elId];
var type=_157d.type;
ole.objects[type].onClone(_157c,elId,_157d.getLeft(),_157d.getTop(),_157d.getWidth(),_157d.getHeight(),_157d.parentId);
}
OLE[elId].isSynchronized=false;
};
ole.isActive=function(){
return ole.activeState;
};
ole.startDrag=function(ev,_1580){
var _1581=ole.currObj;
if(!_1581){
return;
}
var _1582=ole.getObjectPermissions(_1581.id,["isDraggable"]);
var _1583;
if(!(!_1582.isDraggable||_1581.isExposed||!_1581.isEnabled)){
if(ole.onDrag){
ole.endDrag(ev);
}else{
if(!ole.onDrag&&!ole.onResize){
var _1584=_1581.getSelectLayer();
var _1585=ole.cloneElement(_1584.id);
ole.lastClonedSelectLayer=_1585;
ole.setElementStyleProps(_1585,true,true,true,_1584.style.left,_1584.style.top,_1584.style.height,_1584.style.width,"block",0.99,_1584.style.zIndex-1);
getObj(_1585).onmousedown=function(){
ole.endDrag(ev,_1585,undefined);
ole.currObj.setSelectLayer().positionActionBar();
};
document["OLEMouseMoveLis"]=document["OLEMouseUpLis"]=this;
document["OLEMouseMoveFunc"]=function(ev){
return document["OLEMouseMoveLis"].drag(ev,_1585);
};
document["OLEMouseUpFunc"]=function(ev){
return document["OLEMouseUpLis"].endDrag(ev,_1585,_1580);
};
if(browser_ie){
ev=window.event;
_1583=ev.button;
}else{
if(browser_nn6){
_1583=ev.which;
}
}
var type=_1581.type;
var diffX=ole.objectsSubHeader[type].selectLayerDiffX;
var diffY=ole.objectsSubHeader[type].selectLayerDiffY;
ole.diffX=ev.clientX+getSheetScrollLeft()-_1581.left+diffX-sheetLeft;
ole.diffY=ev.clientY+getSheetScrollTop()-_1581.top+diffY-sheetTop;
ole.onDrag=true;
if(browser_ie){
document.attachEvent("onmousemove",document["OLEMouseMoveFunc"]);
document.attachEvent("onmouseup",document["OLEMouseUpFunc"]);
}else{
if(browser_nn6){
window.addEventListener("mousemove",document["OLEMouseMoveFunc"],false);
window.addEventListener("mouseup",document["OLEMouseUpFunc"],false);
}
}
ole.onDragStart=true;
}
}
}
return false;
};
ole.drag=function(ev,id){
clearTextSelection();
if(browser_ie){
ev=window.event;
}
var _158d=ole.currObj;
if(_158d){
var left=ev.clientX+getSheetScrollLeft()-sheetLeft-ole.diffX;
var top=ev.clientY+getSheetScrollTop()-sheetTop-ole.diffY;
var diffX=ole.objectsSubHeader[ole.currObj.type].selectLayerDiffX;
var diffY=ole.objectsSubHeader[ole.currObj.type].selectLayerDiffY;
left=(left+diffX>=0)?left:-diffY;
top=(top+diffY>=0)?top:-diffY;
var type=_158d.type;
if(ole.onDragStart){
if(ole.objects[type].onDragStart){
ole.objects[type].onDragStart(_158d.id,left,top);
}
ole.onDragStart=false;
}
getObj(id).style.left=left+"px";
getObj(id).style.top=top+"px";
if(ole.objects[type].onDrag){
ole.objects[type].onDrag(_158d.id,left,top);
}
if(!ole.isCalledOnce){
ole.isDragged=true;
_158d.isDraggedOnce=true;
_158d.displayAssociativeElements("","none");
var _1593=ole.currObj.getActionBar();
_1593.style.visibility="hidden";
ole.isCalledOnce=true;
ole.contextMenuStatus=false;
ole.isActionBarLocked=true;
_158d.isMovedOrResizedAfterClone=true;
_158d.cloneCountSinceLastDragOrResize=0;
}
}
};
ole.endDrag=function(ev,id,_1596){
var _1597;
var _1598;
if(ev){
_1598=ev.ctrlKey;
}
if(ole.isDragged){
_1596=false;
}
var _1599=ole.currObj;
if(_1599){
var type=_1599.type;
var _159b=ole.getObjectProperty(type,"cloneOnCTRLDrag");
if(isUndefined(_159b)){
_159b=false;
}
if(_1598&&!_1596&&_159b){
_1597=ole.cloneElement(_1599.el.id);
ole.constructOLEObj(_1597);
_1599=ole.setAsCurrObj(_1597);
}
var _159c=getObj(id);
if(_159c&&ole.isDragged){
var diffX=ole.objectsSubHeader[type].selectLayerDiffX;
var diffY=ole.objectsSubHeader[type].selectLayerDiffY;
_1599.setLeft(parseInt(_159c.style.left,10)+diffX).setTop(parseInt(_159c.style.top,10)+diffY).setSelectLayer(false,true);
}
if(_159c){
var _159f=_159c.parentNode;
_159f.removeChild(_159c);
}
if(_1598&&!_1596&&_159b){
ole.sendServerRequestOnClone(_1597,3);
}
if(browser_ie){
document.detachEvent("onmousemove",document["OLEMouseMoveFunc"]);
document.detachEvent("onmouseup",document["OLEMouseUpFunc"]);
}else{
if(browser_nn6){
window.removeEventListener("mousemove",document["OLEMouseMoveFunc"],false);
window.removeEventListener("mouseup",document["OLEMouseUpFunc"],false);
}
}
ole.onDrag=false;
if(ole.isDragged){
var _15a0=ole.currObj.getActionBar();
_15a0.style.visibility="visible";
ole.isActionBarLocked=false;
_1599.positionActionBar(true);
ole.isDragged=false;
ole.isCalledOnce=false;
if(_1599.isSynchronized){
if(ole.objects[type].onDragEnd){
ole.objects[type].onDragEnd(_1599.id,_1599.left,_1599.top);
}
}
}
}
};
ole.resizeProportionally=function(width,_15a2,_15a3,_15a4){
var _15a5;
if("undefined"!==typeof width){
_15a5=Math.round()?Math.round(width/(_15a3/_15a4)):width/(_15a3/_15a4);
}else{
if("undefined"!==typeof _15a2){
_15a5=Math.round()?Math.round(_15a2*(_15a3/_15a4)):_15a2*(_15a3/_15a4);
}
}
return _15a5;
};
ole.startResize=function(type,ev){
var _15a8=ole.currObj;
var _15a9=ole.getObjectPermissions(_15a8.id,["isResizable"]);
if(!(!_15a9.isResizable||_15a8.isExposed||!_15a8.isEnabled)){
if(ole.onResize){
ole.endResize(ev);
}else{
if(!ole.onDrag&&!ole.onResize){
ole.resizeType=type;
ole.currObjLeft=_15a8.left;
ole.currObjTop=_15a8.top;
ole.currObjWd=_15a8.width;
ole.currObjHt=_15a8.height;
ole.onResize=true;
document["OLEMouseMoveLis"]=document["OLEMouseUpLis"]=this;
document["OLEMouseMoveFunc"]=function(ev){
return document["OLEMouseMoveLis"].resize(ev);
};
document["OLEMouseUpFunc"]=function(ev){
document["OLEMouseUpLis"].endResize(ev);
};
if(browser_ie){
document.attachEvent("onmousemove",document["OLEMouseMoveFunc"]);
document.attachEvent("onmouseup",document["OLEMouseUpFunc"]);
window.event.cancelBubble=true;
}else{
if(browser_nn6){
window.addEventListener("mousemove",document["OLEMouseMoveFunc"],false);
window.addEventListener("mouseup",document["OLEMouseUpFunc"],false);
ev.stopPropagation();
}
}
ole.onResizeStart=true;
}
}
}
return false;
};
ole.resize=function(ev){
clearTextSelection();
if(browser_ie){
ev=window.event;
}
var pgX=ev.clientX;
var pgY=ev.clientY;
var _15af=ole.currObj;
var _15b0=_15af.width;
var _15b1=_15af.height;
var type=_15af.type;
var _15b3=ole.objects[type].minWidth||10;
var _15b4=ole.objects[type].minHeight||10;
var _15b5=ole.objects[type].resizeCornersBehaviour;
if(ole.onResizeStart){
ole.onResizeStart=false;
if(ole.objects[type].onResizeStart){
ole.objects[type].onResizeStart(_15af.id,_15af.width,_15af.height,ev);
}
}
var _15b6=getSheetScrollLeft();
var _15b7=getSheetScrollTop();
if(ole.resizeType.indexOf("E")>=0){
var width=(pgX+_15b6-sheetLeft)-ole.currObjLeft;
width=(width<_15b3)?_15b3:width;
_15af.setWidth(width).setSelectLayer();
}else{
if(ole.resizeType.indexOf("W")>=0){
var left=pgX+_15b6-sheetLeft;
left=(left<0)?0:left;
maxMovableLeft=ole.currObjLeft+ole.currObjWd-_15b3;
left=(left<maxMovableLeft)?left:maxMovableLeft;
var width=ole.currObjWd+(ole.currObjLeft-left);
width=(width<_15b3)?_15b3:width;
if(left<_15af.left||(_15af.width>_15b3)){
_15af.setLeft(left).setWidth(width).setSelectLayer();
}
}
}
if(ole.resizeType.indexOf("S")>=0){
var _15ba=(pgY+_15b7-sheetTop)-ole.currObjTop;
_15ba=(_15ba<_15b4)?_15b4:_15ba;
if(_15b5=="Proportional"&&(ole.resizeType=="SE"||ole.resizeType=="SW")){
_15af.setHeight(ole.resizeProportionally(width,_15ba,_15b0,_15b1)).setSelectLayer();
}else{
_15af.setHeight(_15ba).setSelectLayer();
}
}else{
if(ole.resizeType.indexOf("N")>=0){
var top=(pgY+_15b7-sheetTop);
top=(top<0)?0:top;
maxMovableTop=ole.currObjTop+ole.currObjHt-_15b4;
top=(top<maxMovableTop)?top:maxMovableTop;
var _15ba=ole.currObjHt+(ole.currObjTop-top);
_15ba=(_15ba<_15b4)?_15b4:_15ba;
if(top<_15af.top||(_15af.height>_15b4)){
if(_15b5=="Proportional"&&(ole.resizeType=="NE"||ole.resizeType=="NW")){
var _15bc=_15af.top+-(ole.resizeProportionally(width,_15ba,_15b0,_15b1)-_15b1);
_15af.setTop(_15bc).setHeight(ole.resizeProportionally(width,_15ba,_15b0,_15b1)).setSelectLayer();
}else{
_15af.setTop(top).setHeight(_15ba).setSelectLayer();
}
}
}
}
if(ole.objects[type].onResize){
ole.objects[type].onResize(_15af.id,_15af.getWidth(),_15af.getHeight());
}
if(!ole.isCalledOnce){
_15af.displayAssociativeElements("","none","none");
ole.isResized=true;
ole.isCalledOnce=true;
ole.contextMenuStatus=false;
ole.isActionBarLocked=true;
_15af.isResizedOnce=true;
_15af.isMovedOrResizedAfterClone=true;
_15af.cloneCountSinceLastDragOrResize=0;
}
return false;
};
ole.endResize=function(ev){
if(browser_ie){
document.detachEvent("onmousemove",document["OLEMouseMoveFunc"]);
document.detachEvent("onmouseup",document["OLEMouseUpFunc"]);
}else{
if(browser_nn6){
window.removeEventListener("mousemove",document["OLEMouseMoveFunc"],false);
window.removeEventListener("mouseup",document["OLEMouseUpFunc"],false);
}
}
ole.onResize=false;
if(ole.isResized){
ole.isResized=false;
ole.isCalledOnce=false;
ole.isActionBarLocked=false;
var _15be=ole.currObj;
var type=_15be.type;
_15be.positionActionBar(true);
if(_15be.isSynchronized){
if(ole.objects[type].onResizeEnd){
ole.objects[type].onResizeEnd(_15be.id,_15be.getWidth(),_15be.getHeight());
}
}
}
};
ole.resetZIndex=function(type){
for(x in OLE){
if(OLE[x]){
OLE[x].setZIndex(101);
}
}
};
ole.sortByZIndex=function(){
var _15c1=[];
var i=-1;
for(x in OLE){
if(OLE[x]){
i++;
_15c1[i]=new Array(2);
_15c1[i][0]=OLE[x].id;
_15c1[i][1]=OLE[x].zIndex;
}
}
_15c1.sort(function(a,b){
numA=a[1];
numB=b[1];
if(isNaN(numA)){
return 0;
}else{
if(isNaN(numB)){
return 0;
}else{
return numA-numB;
}
}
});
return _15c1;
};
ole.sortByPosition=function(){
var _15c5=[];
var i=-1;
for(x in OLE){
if(OLE[x]){
i++;
_15c5[i]=new Array(3);
_15c5[i][0]=OLE[x].id;
_15c5[i][1]=OLE[x].top;
_15c5[i][2]=OLE[x].left;
}
}
_15c5.sort(function(a,b){
numA=a[1];
numB=b[1];
if(numA===numB){
return a[2]-b[2];
}else{
return numA-numB;
}
});
return _15c5;
};
ole.clearObjectsPositionCache=function(){
if(typeof ole.objectsSortedByPos!=="undefined"){
ole.objectsSortedByPos=undefined;
ole.pointer=undefined;
}
};
ole.getObjectsSortedByPos=function(){
if(typeof ole.objectsSortedByPos==="undefined"){
ole.objectsSortedByPos=ole.sortByPosition();
}
return ole.objectsSortedByPos;
};
ole.setSelectAndFocusLayerEvents=function(type){
var _15ca=ole.objectsSubHeader[type].selectLayer;
var _15cb=ole.objectsSubHeader[type].focusLayer;
_15ca.oncontextmenu=function(ev){
ole.currObj.showContextMenu(ev).positionActionBar(false);
};
if(ole.objects[type].onDbClick){
_15ca.ondblclick=function(ev){
ole.objects[type].onDbClick();
};
}
_15cb.oncontextmenu=function(ev){
ole.currFocusObj.switchLayers(ev);
ole.currObj.showContextMenu(ev);
};
_15cb.onmouseout=function(ev){
ole.currFocusObj.blur(ev);
};
return this;
};
ole.setResizeCorners=function(type){
var _15d1=ole.objects[type].resizeCorners;
var _15d2=ole.objectsSubHeader[type];
var _15d3=_15d2.selectLayer;
var _15d4=_15d2.focusLayer;
selectLayerTDs=_15d3.getElementsByTagName("TD");
focusLayerTDs=_15d4.getElementsByTagName("TD");
if(_15d1==="none"){
_15d1=[];
}else{
if(!_15d1||_15d1==="all"){
_15d1=["NW","N","NE","W","E","SW","S","SE"];
}
}
function registerDragEvents(){
var TDIdx=[2,5,7,8,11];
for(var i=0,len=TDIdx.length;i<len;i++){
selectLayerTDs[TDIdx[i]].onmousedown=function(ev){
ole.currObj.hideContextMenu();
return ole.startDrag(ev);
};
focusLayerTDs[TDIdx[i]].onmousedown=function(ev){
ole.currFocusObj.switchLayers(ev);
return ole.startDrag(ev,true);
};
}
}
function registerResizeEvents(_15da){
var TDIdx=[1,3,4,6,9,10,12,13];
var _15dc=["NW","N","NE","W","E","SW","S","SE"];
for(var i=0,len=_15dc.length;i<len;i++){
if(_15da.indexOf(_15dc[i])!==-1){
selectLayerTDs[TDIdx[i]].resizeType=_15dc[i];
focusLayerTDs[TDIdx[i]].resizeType=_15dc[i];
selectLayerTDs[TDIdx[i]].className=_15dc[i]+"-Resize";
selectLayerTDs[TDIdx[i]].onmousedown=function(ev){
ole.currObj.hideContextMenu();
return ole.startResize(this.resizeType,ev);
};
focusLayerTDs[TDIdx[i]].className=_15dc[i]+"-Resize";
focusLayerTDs[TDIdx[i]].onmousedown=function(ev){
ole.currFocusObj.switchLayers(ev);
return ole.startResize(this.resizeType,ev);
};
}else{
selectLayerTDs[TDIdx[i]].onmousedown=function(ev){
ole.currObj.hideContextMenu();
return ole.startDrag(ev);
};
focusLayerTDs[TDIdx[i]].onmousedown=function(ev){
ole.currFocusObj.switchLayers(ev);
return ole.startDrag(ev,true);
};
}
}
}
registerDragEvents();
registerResizeEvents(_15d1);
return this;
};
ole.isOLEElementClicked=function(ev){
var el;
if(browser_ie){
el=ev.srcElement;
}else{
if(browser_nn6){
el=ev.target;
}
}
var _15e5=ole.currObj;
var _15e6=_15e5.getSelectLayer();
var _15e7=_15e5.getFocusLayer();
var _15e8=_15e5.getActionBar();
var type=_15e5.type;
var _15ea=ole.objects[type];
var id=ole.currObj.id;
if((el===_15e6)||isChild(el,_15e6)){
ole.isCursorOverOLEObj=true;
if(_15ea.onSelectLayerMouseDown){
_15ea.onSelectLayerMouseDown(id,ev);
}
}else{
if((el===_15e8)||isChild(el,_15e8)){
ole.isCursorOverOLEObj=true;
if(_15ea.onActionBarMouseDown){
_15ea.onActionBarMouseDown(id,ev);
}
}else{
if((el===_15e5.el)||isChild(el,_15e5.el)){
ole.isCursorOverOLEObj=true;
if(_15ea.onOLEObjMouseDown){
_15ea.onOLEObjMouseDown(id,ev);
}
}else{
if((el===_15e7)||isChild(el,_15e7)){
ole.isCursorOverOLEObj=true;
if(_15ea.onFocusLayerMouseDown){
_15ea.onFocusLayerMouseDown(id,ev);
}
}else{
if(Menu._isCursorInsideMenu(ev)){
ole.isCursorOverOLEObj=true;
}
}
}
}
}
};
ole._onmousedown=function(ev){
if(dialogEl&&dialog_modal=="yes"){
return;
}
if(ole.currObj){
ole.isCursorOverOLEObj=false;
ole.isOLEElementClicked(ev);
var _15ed,_15ee;
if(browser_ie){
_15ed=ev.button;
_15ee=ev.srcElement;
}else{
if(browser_nn6){
_15ed=ev.which;
_15ee=ev.target;
}
}
var _15ef=ole.getObjectProperty(ole.currObj.type,"dependantsIdAry");
if(_15ef&&_15ef.indexOf(_15ee.id)!==-1){
return;
}
if(_15ed!==1){
if(ole.onDrag){
return false;
}
}
if(!ole.isCursorOverOLEObj){
if(ole.objects[ole.currObj.type].onMouseDownOutsideOLEElements){
ole.objects[ole.currObj.type].onMouseDownOutsideOLEElements(ole.currObj.id,ev);
}
if(!ole.isFirstClickOutsideOLECompleted){
if(ole.objects[ole.currObj.type].onFirstMouseDownOutsideOLEElements){
ole.objects[ole.currObj.type].onFirstMouseDownOutsideOLEElements(ole.currObj.id,ev);
}
ole.isFirstClickOutsideOLECompleted=true;
}
ole.currObj.deSelect();
var _15f0=getObj(ole.lastClonedSelectLayer);
if(_15f0){
getObj(_15f0).parentNode.removeChild(_15f0);
}
ole.endDrag(undefined,ole.lastClonedSelectLayer,undefined);
}else{
ole.isFirstClickOutsideOLECompleted=false;
if(ole.objects[ole.currObj.type].onMouseDownOverOLEElements){
ole.objects[ole.currObj.type].onMouseDownOverOLEElements(ole.currObj.id,ev);
}
}
}else{
if(ole.currFocusObj){
ole.currFocusObj.getFocusLayer().style.display="none";
ole.currFocusObj=null;
}
}
};
if(browser_ie){
document.attachEvent("onmousedown",function(ev){
ole._onmousedown(ev);
});
}else{
if(browser_nn6){
window.addEventListener("mousedown",function(ev){
ole._onmousedown(ev);
},false);
}
}
ole.handleKeyDownEvents=function(ev){
if(ole.currObj){
if(browser_ie){
var ev=window.event;
}
return ole.conf.onKeyDown(ev);
if(ole.objects[type].onkeyDown){
ole.objects[type].onkeyDown(ev);
}
}
};
ole.handleKeyUpEvents=function(ev){
if(ole.currObj){
if(browser_ie){
var ev=window.event;
}
return ole.conf.onKeyUp(ev);
}
};
ole.getWorkSpace=function(){
return ole.workSpace;
};
ole.setWorkSpace=function(_15f5){
ole.workSpace=_15f5;
};
ole.focus=function(){
var _15f6=ole.conf.focusElement;
if(_15f6&&document.activeElement.id!==_15f6){
getObj(_15f6).focus();
}
};
ole.blur=function(){
var _15f7=ole.conf.focusElement;
if(_15f7&&document.activeElement.id===_15f7){
getObj(_15f7).blur();
}
};
ole.dispatchEvents=function(){
var _15f8=ole.eventBuffer;
var _15f9=ole.eventBuffer.length;
for(var i=0;i<_15f9;i++){
ole.objects[_15f8[i][1]][_15f8[i][2]](_15f8[i][0],_15f8[i][3],_15f8[i][4]);
}
ole.eventBuffer=[];
};
ole.addToEventBuffer=function(_15fb){
var _15fc=ole.eventBuffer.length;
if(_15fc===0){
ole.lastUpdatedEventInfo=ole.eventBuffer[0]=_15fb;
return;
}else{
var id;
var _15fe;
id=_15fb[0];
_15fe=_15fb[2];
if(ole.lastUpdatedEventInfo[0]===id&&ole.lastUpdatedEventInfo[2]===_15fe){
ole.lastUpdatedEventInfo=ole.eventBuffer[_15fc-1]=_15fb;
return;
}
for(var i=0;i<_15fc;i++){
if(ole.eventBuffer[0]===id&&ole.eventBuffer[2]===_15fe){
ole.lastUpdatedEventInfo=ole.eventBuffer[i]=_15fb;
return;
}
}
ole.lastUpdatedEventInfo=ole.eventBuffer[_15fc]=_15fb;
}
};
ole.getDependants=function(){
var _1600=[];
var type;
for(var i=0,len=ole.typesRegistered.length;i<len;i++){
type=ole.typesRegistered[i];
_1600=_1600.concat(ole.objects[type].dependantsIdAry);
}
return _1600;
};
ole.eventBuffer=[];
var Range=function(_1604,_1605,_1606,_1607){
this.startRow=_1604;
this.startCol=_1605;
this.endRow=_1606;
this.endCol=_1607;
};
Range.prototype={isSingle:function(){
return !((this.endRow-this.startRow)|(this.endCol-this.startCol));
},isRow:function(){
return (this.startCol==0)&&(this.endCol==255);
},isCol:function(){
return (this.startRow==0)&&(this.endRow==65535);
},isWhole:function(){
return this.isRow()&&this.isCol();
},getAddress:function(){
return this.startRow+"R"+":"+this.startCol+"C";
},getFirstLabel:function(){
return;
},getLastLabel:function(){
return;
},getPrimal:function(){
return this.startRow+":"+this.startCol;
},getIterator:function(){
var oR=this.getOrderedRange();
return new Iterator(oR.sR,oR.sC,oR.eR,oR.eC);
},getRealRange:function(){
return {"sR":this.startRow,"eR":this.endRow,"sC":this.startCol,"eC":this.endCol};
},equals:function(range){
var a=this.startRow-range.startRow;
var b=this.startCol-range.startCol;
var c=this.endRow-range.endRow;
var d=this.endCol-range.endCol;
return !(a&b&c&d);
},intersects:function(range){
return !(range.startRow>this.endRow||range.startCol>this.endCol||range.endRow<this.startRow||range.endCol<this.startCol);
},subset:function(range){
return (this.startRow<=range.startRow&&range.endRow<=this.endRow&&this.startCol<=range.startCol&&range.endCol<=this.endCol);
},union:function(range){
this.startRow=(this.startRow>range.startRow)?range.startRow:this.startRow;
this.startCol=(this.startCol>range.startCol)?range.startCol:this.startCol;
this.endRow=(this.endRow<range.endRow)?range.endRow:this.endRow;
this.endCol=(this.endCol<range.endCol)?range.endCol:this.endCol;
},getOrderedRange:function(){
var objct={};
if(this.startRow<=this.endRow){
objct["sR"]=this.startRow;
objct["eR"]=this.endRow;
}else{
objct["sR"]=this.endRow;
objct["eR"]=this.startRow;
}
if(this.startCol<=this.endCol){
objct["sC"]=this.startCol;
objct["eC"]=this.endCol;
}else{
objct["sC"]=this.endCol;
objct["eC"]=this.startCol;
}
return objct;
},getVisibleRowsCount:function(){
if(isUndefined(this.visibleRowsCount)){
this.visibleRowsCount=this.endRow-this.startRow+1-Row.getHiddenRowCount(this.startRow,this.endRow);
}
return this.visibleRowsCount;
}};
Range.getOrderedRange=function(_1612,_1613,_1614,_1615){
var objct={};
if(_1612<=_1614){
objct["sR"]=_1612;
objct["eR"]=_1614;
}else{
objct["sR"]=_1614;
objct["eR"]=_1612;
}
if(_1613<=_1615){
objct["sC"]=_1613;
objct["eC"]=_1615;
}else{
objct["sC"]=_1615;
objct["eC"]=_1613;
}
return objct;
};
Range.getPrimal=function(row,col){
return row+":"+col;
};
Range.getIterator=function(_1619,_161a,_161b,_161c){
return new Range(_1619,_161a,_161b,_161c).getIterator();
};
var _merge=function(){
Range.apply(this,arguments);
};
_merge.prototype=new Range();
_merge.prototype.getColSpan=function(){
return this.endCol-this.startCol+1;
};
_merge.prototype.getRowSpan=function(){
return this.endRow-this.startRow+1;
};
_merge.prototype.getIterator=function(){
var oR=this.getOrderedRange();
return new MergeIterator(oR.sR,oR.sC,oR.eR,oR.eC);
};
_merge.prototype.getDOM=function(){
return mergeDOMInfo[this.getPrimal()];
};
_merge.prototype.getHeight=function(){
return getRowTop(this.endRow)+getRowHeight(this.endRow)-getRowTop(this.startRow);
};
_merge.prototype.getWidth=function(){
return getColLeft(this.endCol)+getColWidth(this.endCol)-getColLeft(this.startCol);
};
_merge.prototype.getTop=function(){
return getRowTop(this.startRow);
};
_merge.prototype.getLeft=function(){
return getColLeft(this.startCol);
};
var Merge={getWhole:function(){
if(!this["_mergeAll"]){
this["_mergeAll"]=new _merge(0,0,65535,255);
}
return this._mergeAll;
},resizeDOM:function(start,end,_1620){
switch(_1620){
case "COLS":
var merge=new _merge(0,start,totRows-1,end);
merge.getIterator().iterateNNotifyAboveStartCol(this._resizeDOMByCol);
break;
case "ROWS":
var merge=new _merge(start,0,end,totCols-1);
merge.getIterator().iterateNNotifyAboveStartRow(this._resizeDOMByRow);
break;
}
},_resizeDOMByCol:function(row,col,objct){
var obj=objct.getDOM();
if(!obj){
return;
}
var width=objct.getWidth();
var left=objct.getLeft();
obj["mC"].style.width=width+"px";
obj["mC"].style.left=left+"px";
setCellWidthForVAlignedCell(obj["mC"]);
if(ISFREEZED){
if(obj["mC1"]){
obj["mC1"].style.width=width+"px";
obj["mC1"].style.left=left+"px";
setCellWidthForVAlignedCell(obj["mC1"]);
}
if(obj["mC2"]){
obj["mC2"].style.width=width+"px";
obj["mC2"].style.left=left+"px";
setCellWidthForVAlignedCell(obj["mC2"]);
}
if(obj["mC3"]){
obj["mC3"].style.width=width+"px";
obj["mC3"].style.left=left+"px";
setCellWidthForVAlignedCell(obj["mC3"]);
}
}
},_resizeDOMByRow:function(row,col,objct){
var obj=objct.getDOM();
if(!obj){
return;
}
var _162c=objct.getHeight();
var top=objct.getTop();
obj["mC"].style.height=_162c+"px";
obj["mC"].style.top=top+"px";
setCellHeightForVAlignedCell(obj["mC"]);
if(ISFREEZED){
if(obj["mC1"]){
obj["mC1"].style.height=_162c+"px";
obj["mC1"].style.top=top+"px";
setCellHeightForVAlignedCell(obj["mC1"]);
}
if(obj["mC2"]){
obj["mC2"].style.height=_162c+"px";
obj["mC2"].style.top=top+"px";
setCellHeightForVAlignedCell(obj["mC2"]);
}
if(obj["mC3"]){
obj["mC3"].style.height=_162c+"px";
obj["mC3"].style.top=top+"px";
setCellHeightForVAlignedCell(obj["mC3"]);
}
}
},update:function(ary,row){
var iter=ary.length;
if(iter){
do{
iter--;
var _1631,_1632;
_1631=row+ary[iter].STARTROW;
_1632=row+ary[iter].ENDROW;
var _1633=ary[iter].STARTCOL;
var _1634=ary[iter].ENDCOL;
var objct=this.add(_1631,_1633,_1632,_1634);
}while(iter);
}
},add:function(_1636,_1637,_1638,_1639){
var range=new Range(_1636,_1637,_1638,_1639);
var _163b=range.getOrderedRange();
var _163c=_163b.sR;
var endR=_163b.eR;
var _163e=_163b.sC;
var endC=_163b.eC;
var key=Range.getPrimal(_163c,_163e);
if(mergeDOMInfo[key]){
return;
}
clearCoveredCells(_1636,_1637,_1638,_1639);
var objct=new _merge(_163c,_163e,endR,endC);
mergeInfo["mergeList"][key]=objct;
if(objct.isWhole()){
mergeInfo["_mergeAll"]=true;
}else{
if(objct.isCol()){
for(var col=_163e;col<=endC;col++){
mergeInfo["colMerge"][col]=objct;
}
}else{
if(objct.isRow()){
for(var row=_163c;row<=endR;row++){
mergeInfo["rowMerge"][row]=objct;
}
}else{
for(var row=_163c;row<=endR;row++){
for(var col=_163e;col<=endC;col++){
mergeInfo["cellMerge"][Range.getPrimal(row,col)]=objct;
}
}
}
}
}
this.addDOM(_163c,_163e,endR,endC);
return objct;
},addDOM:function(_1644,_1645,_1646,_1647){
doMergeCells(_1644,_1645,_1646,_1647);
},remove:function(_1648,_1649,_164a,_164b,_164c){
var merge=new _merge(_1648,_1649,_164a,_164b);
if(_164c){
merge.getIterator().iterate(this.removeDOM);
}else{
merge.getIterator().iterate(this._remove);
}
},removeDOM:function(row,col,objct){
if(objct){
var _1651=getAvailableStartRow();
var _1652=getAvailableStartCol();
var _1653=getAvailableEndRow();
var _1654=getAvailableEndCol();
var range=new Range(_1651,_1652,_1653,_1654);
if(range.intersects(objct)||objct["startRow"]<FREEZED_ROW){
return;
}
if(_1651==-1||_1653==-1){
var _1651=lastRequestedTileInfo["startRow"];
var _1653=lastRequestedTileInfo["endRow"];
range=new Range(_1651,_1652,_1653,_1654);
if(range.intersects(objct)){
return;
}
}
}
var key=Range.getPrimal(row,col);
var _1657=mergeDOMInfo[key];
if(!_1657){
return;
}
var obj=_1657["mC"];
if(obj&&obj.parentNode){
obj.parentNode.removeChild(obj);
if(ISFREEZED){
if(FREEZED_ROW>0){
var obj=_1657["mC2"];
if(obj&&obj.parentNode){
obj.parentNode.removeChild(obj);
}
}
if(FREEZED_COL>0){
var obj=_1657["mC3"];
if(obj&&obj.parentNode){
obj.parentNode.removeChild(obj);
}
}
if(FREEZED_COL>0&&FREEZED_ROW>0){
var obj=_1657["mC1"];
if(obj&&obj.parentNode){
obj.parentNode.removeChild(obj);
}
}
}
}
delete mergeDOMInfo[key];
},getIterator:function(_1659,_165a,_165b,_165c){
return new _merge(_1659,_165a,_165b,_165c).getIterator();
},_remove:function(row,col,objct){
if(objct.isWhole()){
Merge._removeAll();
}else{
if(objct.isRow()){
Merge._removeRow(objct.startRow,objct.endRow);
}else{
if(objct.isCol()){
Merge._removeCol(objct.startCol,objct.endCol);
}else{
Merge._removeCell(objct.startRow,objct.startCol,objct.endRow,objct.endCol);
}
}
}
Merge.removeDOM(objct.startRow,objct.startCol);
},_removeCell:function(_1660,_1661,_1662,_1663){
var _1664=_1662-_1660;
var _1665=_1663-_1661;
do{
var row=_1662-_1664;
var _1667=_1665;
do{
var col=_1663-_1667;
delete mergeInfo["cellMerge"][Range.getPrimal(row,col)];
_1667--;
}while(_1667>=0);
_1664--;
}while(_1664>=0);
delete mergeInfo["mergeList"][Range.getPrimal(_1660,_1661)];
},_removeCol:function(_1669,_166a){
var _166b=_166a-_1669;
do{
var col=_166a-_166b;
delete mergeInfo["colMerge"][col];
--_166b;
}while(_166b>=0);
delete mergeInfo["mergeList"][Range.getPrimal(0,_1669)];
},_removeRow:function(_166d,_166e){
var _166f=_166e-_166d;
do{
var row=_166e-_166f;
delete mergeInfo["rowMerge"][row];
--_166f;
}while(_166f>=0);
delete mergeInfo["mergeList"][Range.getPrimal(_166d,0)];
},_removeAll:function(){
mergeInfo["_mergeAll"]=false;
delete mergeInfo["mergeList"][Range.getPrimal(0,0)];
},bindDOMObjcts:function(_1671){
var info=mergeDOMInfo;
for(var prop in info){
var objct=info[prop];
var _1675=objct["mC"];
if(_1675){
var _1676=parseInt(_1675.style.top);
var _1677=parseInt(_1675.style.left);
var _1678=findMergedCell(_1676,_1677,_1671);
switch(_1671){
case sheetPane1Id:
objct["mC1"]=_1678;
break;
case sheetPane2Id:
objct["mC2"]=_1678;
break;
case sheetPane3Id:
objct["mC3"]=_1678;
break;
}
}
}
},unBindDOMObjcts:function(){
var info=mergeDOMInfo;
for(var prop in info){
var objct=info[prop];
var _167c=objct["mC"];
if(objct["mC1"]){
delete objct["mC1"];
}
if(objct["mC2"]){
delete objct["mC2"];
}
if(objct["mC3"]){
delete objct["mC3"];
}
}
},getCellInfo:function(row,col){
if(mergeInfo["_mergeAll"]){
return Merge.getWhole();
}else{
if(mergeInfo["colMerge"]&&mergeInfo["colMerge"][col]){
return mergeInfo["colMerge"][col];
}else{
if(mergeInfo["rowMerge"]&&mergeInfo["rowMerge"][row]){
return mergeInfo["rowMerge"][row];
}else{
if(mergeInfo["cellMerge"]){
return mergeInfo["cellMerge"][row+":"+col];
}
}
}
}
},getRootCellInfo:function(row,col){
var key=Range.getPrimal(row,col);
return mergeInfo["mergeList"][key];
},isCovered:function(row,col){
var info=this.getCellInfo(row,col);
if(info){
return (row!=info["startRow"]||col!=info["startCol"]);
}
return !!info;
},isRowMergeXists:function(){
var _1685=false;
if(mergeInfo["_mergeAll"]){
_1685=true;
}else{
var info=mergeInfo["rowMerge"];
for(var prop in info){
_1685=true;
break;
}
}
return _1685;
},isColMergeXists:function(){
var _1688=false;
if(mergeInfo["_mergeAll"]){
_1688=true;
}else{
var info=mergeInfo["colMerge"];
for(var prop in info){
_1688=true;
break;
}
}
return _1688;
},isSheetMergeXists:function(){
return this.isRowMergeXists()&&this.isColMergeXists();
},extendRange:function(rng){
var _168c=mergeInfo["mergeList"];
for(var key in _168c){
var objct=_168c[key];
if(rng.intersects(objct)&&!rng.subset(objct)){
rng.union(objct);
this.extendRange(rng);
break;
}
}
},extendCol:function(rng){
if(!rng.isCol()){
return;
}
var _1690=mergeInfo["mergeList"];
for(var key in _1690){
var objct=_1690[key];
if(objct.isCol()){
if(rng.intersects(objct)&&!rng.subset(objct)){
rng.union(objct);
this.extendRange(rng);
break;
}
}
}
},extendRow:function(rng){
if(!rng.isRow()){
return;
}
var _1694=mergeInfo["mergeList"];
for(var key in _1694){
var objct=_1694[key];
if(objct.isRow()){
if(rng.intersects(objct)&&!rng.subset(objct)){
rng.union(objct);
this.extendRange(rng);
break;
}
}
}
},reset:function(){
mergeInfo["mergeList"]={};
mergeInfo["rowMerge"]={};
mergeInfo["colMerge"]={};
mergeInfo["cellMerge"]={};
mergeInfo["_mergeAll"]=false;
mergeDOMInfo={};
},shiftRow:function(_1697,cnt,toAdd){
if(toAdd){
Merge._insertRow(_1697,cnt);
}else{
Merge._deleteRow(_1697,cnt);
}
},_insertRow:function(_169a,cnt){
var _169c;
var _169d;
var endR;
var endC;
var _16a0=mergeInfo["mergeList"];
var _16a1=mergeInfo["cellMerge"];
var _16a2={};
for(var key in _16a0){
var _16a4=_16a0[key].startRow;
var _16a5=_16a0[key].startCol;
var _16a6=_16a0[key].endCol;
var _16a7=_16a0[key].endRow;
var _16a8=_16a0[key].getRowSpan();
if(_169a<=_16a4){
var _16a9=getRowTop(_16a4);
var _16aa=getColLeft(_16a5);
var dom=_16a0[key].getDOM();
_169c=mergeInfo["mergeList"][key].startRow=_16a0[key].startRow=_16a0[key].startRow+cnt;
_169d=_16a0[key].startCol;
endR=mergeInfo["mergeList"][key].endRow=_16a0[key].endRow=_16a0[key].endRow+cnt;
endC=_16a0[key].endCol;
_16a2[Range.getPrimal(_169c,_169d)]=_16a0[key];
if(_16a0[key].isRow()){
var _16ac=(cnt>_16a8)?_16a8:cnt;
var _16ad=_16ac;
for(var i=_16a4,len=_16a4+_16ac;i<len;i++){
delete mergeInfo["rowMerge"][i];
}
var start=_16a7+1;
var t1=cnt-_16a8;
if(t1>0){
start+=t1;
}
for(var i=start,len=start+_16ad;i<len;i++){
mergeInfo["rowMerge"][i]=_16a0[key];
}
}else{
var _16ac=(cnt>_16a8)?_16a8:cnt;
var _16ad=_16ac;
for(var i=_16a4,len=_16a4+_16ac;i<len;i++){
for(var j=_16a5;j<=_16a6;j++){
delete _16a1[Range.getPrimal(i,j)];
}
}
var start=_16a7+1;
var t1=cnt-_16a8;
if(t1>0){
start+=t1;
}
for(var i=start,len=start+_16ad;i<len;i++){
for(var j=_16a5;j<=_16a6;j++){
_16a1[Range.getPrimal(i,j)]=_16a0[key];
}
}
}
if(dom){
var cell=dom["mC"];
var top=_16a0[key].getTop();
if(cell){
mergeDOMInfo[Range.getPrimal(_169c,_169d)]=mergeDOMInfo[key];
delete mergeDOMInfo[key];
cell.style.top=top+"px";
}
if(ISFREEZED){
if(dom["mC1"]){
dom["mC1"].style.top=top+"px";
}
if(dom["mC2"]){
dom["mC2"].style.top=top+"px";
}
if(dom["mC3"]){
dom["mC3"].style.top=top+"px";
}
}
}
}else{
if((!(_169a>=_16a4+_16a8))&&(_16a4<_169a)&&((_16a4+_16a8)>=_169a)){
var _16a9=getRowTop(_16a4);
var _16aa=getColLeft(_16a5);
var dom=_16a0[key].getDOM();
_169c=_16a0[key].startRow;
_169d=_16a0[key].startCol;
endR=mergeInfo["mergeList"][key].endRow=_16a0[key].endRow=_16a0[key].endRow+cnt;
endC=_16a0[key].endCol;
_16a2[Range.getPrimal(_169c,_169d)]=_16a0[key];
if(_16a0[key].isRow()){
for(var i=_16a7+1,len=i+cnt;i<len;i++){
mergeInfo["rowMerge"][i]=_16a0[key];
}
}else{
for(var i=_16a7+1,len=i+cnt;i<len;i++){
for(var j=_16a5;j<=_16a6;j++){
_16a1[Range.getPrimal(i,j)]=_16a0[key];
}
}
}
if(dom){
var cell=dom["mC"];
var _16b5=_16a0[key].getHeight();
if(cell){
cell.style.height=_16b5+"px";
}
if(ISFREEZED){
if(dom["mC1"]){
dom["mC1"].style.height=_16b5+"px";
}
if(dom["mC2"]){
dom["mC2"].style.height=_16b5+"px";
}
if(dom["mC3"]){
dom["mC3"].style.height=_16b5+"px";
}
}
}
}else{
_169c=_16a0[key].startRow;
_169d=_16a0[key].startCol;
_16a2[Range.getPrimal(_169c,_169d)]=_16a0[key];
}
}
}
mergeInfo["mergeList"]=_16a2;
},_deleteRow:function(_16b6,cnt){
var _16b8;
var _16b9;
var endR;
var endC;
var _16bc;
var _16bd=mergeInfo["mergeList"];
var _16be=mergeInfo["cellMerge"];
var _16bf={};
var _16c0={};
for(var key in _16bd){
var _16c2=_16bd[key].startRow;
var _16c3=_16bd[key].startCol;
var _16c4=_16bd[key].endRow;
var _16c5=_16bd[key].endCol;
var _16c6=_16bd[key].getRowSpan();
if(_16b6<=_16c2&&_16c2<(_16b6+cnt)){
var _16c7=getRowTop(_16c2);
var _16c8=getColLeft(_16c3);
var dom=_16bd[key].getDOM();
if(_16bd[key].isRow()){
for(var i=_16c2;i<=_16c4;i++){
delete mergeInfo["rowMerge"][i];
}
}else{
if(_16bd[key].isCol()){
for(var i=_16c3;i<=_16c5;i++){
delete mergeInfo["colMerge"][i];
}
}else{
for(var i=_16c2;i<=_16c4;i++){
for(var j=_16c3;j<=_16c5;j++){
if(_16be[Range.getPrimal(i,j)]===_16bd[key]){
delete _16be[Range.getPrimal(i,j)];
}
}
}
}
}
if(dom){
var cell=dom["mC"];
if(cell){
delete mergeDOMInfo[key];
var mC=getObj("mCC");
mC.removeChild(cell);
}
if(ISFREEZED){
if(dom["mC1"]){
var cell1=dom["mC1"];
var mCC1=getObj("mCC1");
mCC1.removeChild(cell1);
}
if(dom["mC2"]){
var cell2=dom["mC2"];
var mCC2=getObj("mCC2");
mCC2.removeChild(cell2);
}
if(dom["mC3"]){
var cell3=dom["mC3"];
var mCC3=getObj("mCC3");
mCC3.removeChild(cell3);
}
}
}
}else{
if((!(_16b6>=_16c2+_16c6))&&(_16c2<_16b6)&&(_16c2+_16c6)>=_16b6&&!_16bd[key].isCol()){
var _16c7=getRowTop(_16c2);
var _16c8=getColLeft(_16c3);
var dom=_16bd[key].getDOM();
if((_16b6+cnt)<(_16c6+_16c2)){
_16bc=cnt;
}else{
_16bc=_16c4-_16b6+1;
}
if(_16bc>=1){
_16b8=_16bd[key].startRow;
_16b9=_16bd[key].startCol;
endR=_16bd[key].endRow=_16c4-_16bc;
endC=_16bd[key].endCol;
_16bf[Range.getPrimal(_16b8,_16b9)]=_16bd[key];
if(_16bd[key].isRow()){
for(var i=_16c4,len=_16c4-_16bc;i>len;i--){
delete mergeInfo["rowMerge"][i];
}
}else{
for(var i=_16c4,len=_16c4-_16bc;i>len;i--){
for(var j=_16c3;j<=_16c5;j++){
delete _16be[Range.getPrimal(i,j)];
}
}
}
if(dom){
_16c0[key]=mergeDOMInfo[key];
var cell=dom["mC"];
var _16d5=_16bd[key].getHeight();
if(cell){
cell.style.height=_16d5+"px";
}
if(ISFREEZED){
if(dom["mC1"]){
dom["mC1"].style.height=_16d5+"px";
}
if(dom["mC2"]){
dom["mC2"].style.height=_16d5+"px";
}
if(dom["mC3"]){
dom["mC3"].style.height=_16d5+"px";
}
}
}
}
}else{
if((_16b6+cnt)<=_16c2){
var _16c7=getRowTop(_16c2);
var _16c8=getColLeft(_16c3);
var dom=_16bd[key].getDOM();
_16b8=_16bd[key].startRow=_16bd[key].startRow-cnt;
_16b9=_16bd[key].startCol;
endR=_16bd[key].endRow=_16bd[key].endRow-cnt;
endC=_16bd[key].endCol;
_16bf[Range.getPrimal(_16b8,_16b9)]=_16bd[key];
if(_16bd[key].isRow()){
var start=_16c4-cnt+1;
start=(start<_16c2)?_16c2:start;
for(var i=start;i<=_16c4;i++){
delete mergeInfo["rowMerge"][i];
}
var end=_16c2;
end=(cnt>_16c6)?_16c2-(cnt-_16c6):_16c2;
for(var i=_16c2-cnt;i<end;i++){
mergeInfo["rowMerge"][i]=_16bd[key];
}
}else{
var start=_16c4-cnt+1;
start=(start<_16c2)?_16c2:start;
for(var i=start;i<=_16c4;i++){
for(var j=_16c3;j<=_16c5;j++){
delete _16be[Range.getPrimal(i,j)];
}
}
var end=_16c2;
end=(cnt>_16c6)?_16c2-(cnt-_16c6):_16c2;
for(var i=_16c2-cnt;i<end;i++){
for(var j=_16c3;j<=_16c5;j++){
_16be[Range.getPrimal(i,j)]=_16bd[key];
}
}
}
if(dom){
var cell=dom["mC"];
var top=_16bd[key].getTop();
if(cell){
_16c0[Range.getPrimal(_16b8,_16b9)]=mergeDOMInfo[key];
delete mergeDOMInfo[key];
cell.style.top=top+"px";
}
if(ISFREEZED){
if(dom["mC1"]){
dom["mC1"].style.top=top+"px";
}
if(dom["mC2"]){
dom["mC2"].style.top=top+"px";
}
if(dom["mC3"]){
dom["mC3"].style.top=top+"px";
}
}
}
}else{
_16b8=mergeInfo["mergeList"][key].startRow=_16bd[key].startRow;
_16b9=_16bd[key].startCol;
_16bf[Range.getPrimal(_16b8,_16b9)]=_16bd[key];
_16c0[Range.getPrimal(_16b8,_16b9)]=mergeDOMInfo[key];
}
}
}
}
mergeInfo["mergeList"]=_16bf;
mergeDOMInfo=_16c0;
},shiftColumn:function(_16d9,cnt,toAdd){
var _16dc;
var _16dd;
var endR;
var endC;
if(toAdd){
this._insertCol(_16d9,cnt);
}else{
this._deleteCol(_16d9,cnt);
}
},_insertCol:function(_16e0,cnt){
var _16e2;
var _16e3;
var endR;
var endC;
var _16e6=mergeInfo["mergeList"];
var _16e7=mergeInfo["cellMerge"];
var _16e8={};
for(var key in _16e6){
var _16ea=_16e6[key].startRow;
var _16eb=_16e6[key].startCol;
var _16ec=_16e6[key].endCol;
var _16ed=_16e6[key].endRow;
var _16ee=_16e6[key].getColSpan();
if(_16e0<=_16eb){
var _16ef=getRowTop(_16ea);
var _16f0=getColLeft(_16eb);
var dom=_16e6[key].getDOM();
_16e2=_16e6[key].startRow;
_16e3=_16e6[key].startCol=_16e6[key].startCol+cnt;
endR=_16e6[key].endRow;
endC=_16e6[key].endCol=_16e6[key].endCol+cnt;
_16e8[Range.getPrimal(_16e2,_16e3)]=_16e6[key];
if(_16e6[key].isCol()){
var _16f2=(cnt>_16ee)?_16ee:cnt;
var _16f3=_16f2;
for(var i=_16eb,len=_16eb+_16f2;i<len;i++){
delete mergeInfo["colMerge"][i];
}
var start=_16ec+1;
var t1=cnt-_16ee;
if(t1>0){
start+=t1;
}
for(var i=start,len=start+_16f3;i<len;i++){
mergeInfo["colMerge"][i]=_16e6[key];
}
}else{
var _16f2=(cnt>_16ee)?_16ee:cnt;
var _16f3=_16f2;
for(var i=_16ea;i<=_16ed;i++){
for(var j=_16eb,len=_16eb+_16f2;j<len;j++){
delete _16e7[Range.getPrimal(i,j)];
}
}
var start=_16ec+1;
var t1=cnt-_16ee;
if(t1>0){
start+=t1;
}
for(var i=_16ea;i<=_16ed;i++){
for(var j=start,len=start+_16f3;j<len;j++){
_16e7[Range.getPrimal(i,j)]=_16e6[key];
}
}
}
if(dom){
var cell=dom["mC"];
var left=_16e6[key].getLeft();
if(cell){
mergeDOMInfo[Range.getPrimal(_16e2,_16e3)]=mergeDOMInfo[key];
delete mergeDOMInfo[key];
cell.style.left=left+"px";
}
if(ISFREEZED){
if(dom["mC1"]){
dom["mC1"].style.left=left+"px";
}
if(dom["mC2"]){
dom["mC2"].style.left=left+"px";
}
if(dom["mC3"]){
dom["mC3"].style.left=left+"px";
}
}
}
}else{
if((!(_16e0>=_16eb+_16ee))&&(_16eb<_16e0)&&((_16eb+_16ee)>=_16e0)){
var _16ef=getRowTop(_16ea);
var _16f0=getColLeft(_16eb);
var dom=_16e6[key].getDOM();
_16e2=_16e6[key].startRow;
_16e3=_16e6[key].startCol;
endR=_16e6[key].endRow;
endC=_16e6[key].endCol=_16e6[key].endCol+cnt;
_16e8[Range.getPrimal(_16e2,_16e3)]=_16e6[key];
if(_16e6[key].isCol()){
for(var i=_16ec+1,len=i+cnt;i<len;i++){
mergeInfo["colMerge"][i]=_16e6[key];
}
}else{
for(var i=_16ea;i<=_16ed;i++){
for(var j=_16ec+1,len=j+cnt;j<len;j++){
_16e7[Range.getPrimal(i,j)]=_16e6[key];
}
}
}
if(dom){
var cell=dom["mC"];
var width=_16e6[key].getWidth();
if(cell){
cell.style.width=width+"px";
}
if(ISFREEZED){
if(dom["mC1"]){
dom["mC1"].style.width=width+"px";
}
if(dom["mC2"]){
dom["mC2"].style.width=width+"px";
}
if(dom["mC3"]){
dom["mC3"].style.width=width+"px";
}
}
}
}else{
_16e2=_16e6[key].startRow;
_16e3=_16e6[key].startCol;
_16e8[Range.getPrimal(_16e2,_16e3)]=_16e6[key];
}
}
}
mergeInfo["mergeList"]=_16e8;
},_deleteCol:function(_16fc,cnt){
var _16fe;
var _16ff;
var endR;
var endC;
var _1702;
var _1703=mergeInfo["mergeList"];
var _1704=mergeInfo["cellMerge"];
var _1705={};
var _1706={};
for(var key in _1703){
var _1708=_1703[key].startRow;
var _1709=_1703[key].startCol;
var _170a=_1703[key].endRow;
var _170b=_1703[key].endCol;
var _170c=_1703[key].getColSpan();
if(_16fc<=_1709&&_1709<(_16fc+cnt)){
var _170d=getRowTop(_1708);
var _170e=getColLeft(_1709);
var dom=_1703[key].getDOM();
if(_1703[key].isCol()){
for(var i=_1709;i<=_170b;i++){
delete mergeInfo["colMerge"][i];
}
}else{
if(_1703[key].isRow()){
for(var i=_1708;i<=_170a;i++){
delete mergeInfo["rowMerge"][i];
}
}else{
for(var i=_1708;i<=_170a;i++){
for(var j=_1709;j<=_170b;j++){
if(_1704[Range.getPrimal(i,j)]===_1703[key]){
delete _1704[Range.getPrimal(i,j)];
}
}
}
}
}
if(dom){
var cell=dom["mC"];
if(cell){
delete mergeDOMInfo[key];
var mC=getObj("mCC");
mC.removeChild(cell);
}
if(ISFREEZED){
if(dom["mC1"]){
var cell1=dom["mC1"];
var mCC1=getObj("mCC1");
mCC1.removeChild(cell1);
}
if(dom["mC2"]){
var cell2=dom["mC2"];
var mCC2=getObj("mCC2");
mCC2.removeChild(cell2);
}
if(dom["mC3"]){
var cell3=dom["mC3"];
var mCC3=getObj("mCC3");
mCC3.removeChild(cell3);
}
}
}
}else{
if((!(_16fc>=_1709+_170c))&&(_1709<_16fc)&&(_1709+_170c)>=_16fc&&!_1703[key].isRow()){
var _170d=getRowTop(_1708);
var _170e=getColLeft(_1709);
var dom=_1703[key].getDOM();
if((_16fc+cnt)<(_170c+_1709)){
_1702=cnt;
}else{
_1702=_170b-_16fc+1;
}
if(_1702>=1){
_16fe=_1703[key].startRow;
_16ff=_1703[key].startCol;
endR=_1703[key].endRow;
endC=_1703[key].endCol=_170b-_1702;
_1705[Range.getPrimal(_1708,_1709)]=_1703[key];
if(_1703[key].isCol()){
for(var i=_170b,len=_170b-_1702;i>len;i--){
delete mergeInfo["colMerge"][i];
}
}else{
for(var i=_1708;i<=_170a;i++){
for(var j=_170b,len=_170b-_1702;j>len;j--){
delete _1704[Range.getPrimal(i,j)];
}
}
}
if(dom){
_1706[key]=mergeDOMInfo[key];
var cell=dom["mC"];
var width=_1703[key].getWidth();
if(cell){
cell.style.width=width+"px";
}
if(ISFREEZED){
if(dom["mC1"]){
dom["mC1"].style.width=width+"px";
}
if(dom["mC2"]){
dom["mC2"].style.width=width+"px";
}
if(dom["mC3"]){
dom["mC3"].style.width=width+"px";
}
}
}
}
}else{
if((_16fc+cnt)<=_1709){
var _170d=getRowTop(_1708);
var _170e=getColLeft(_1709);
var dom=_1703[key].getDOM();
_16fe=_1703[key].startRow;
_16ff=_1703[key].startCol=_1703[key].startCol-cnt;
endR=_1703[key].endRow;
endC=_1703[key].endCol=_1703[key].endCol-cnt;
_1705[Range.getPrimal(_16fe,_16ff)]=_1703[key];
if(_1703[key].isCol()){
var start=_170b-cnt+1;
start=(start<_1709)?_1709:start;
for(var i=start;i<=_170b;i++){
delete mergeInfo["colMerge"][i];
}
var end=_1709;
end=(cnt>_170c)?_1709-(cnt-_170c):_1709;
for(var i=_1709-cnt;i<end;i++){
mergeInfo["colMerge"][i]=_1703[key];
}
}else{
var start=_170b-cnt+1;
start=(start<_1709)?_1709:start;
for(var i=_1708;i<=_170a;i++){
for(var j=start;j<=_170b;j++){
delete _1704[Range.getPrimal(i,j)];
}
}
var end=_1709;
end=(cnt>_170c)?_1709-(cnt-_170c):_1709;
for(var i=_1708;i<=_170a;i++){
for(var j=_1709-cnt;j<end;j++){
_1704[Range.getPrimal(i,j)]=_1703[key];
}
}
}
if(dom){
var cell=dom["mC"];
var left=_1703[key].getLeft();
if(cell){
_1706[Range.getPrimal(_16fe,_16ff)]=mergeDOMInfo[key];
delete mergeDOMInfo[key];
cell.style.left=left+"px";
}
if(ISFREEZED){
if(dom["mC1"]){
dom["mC1"].style.left=left+"px";
}
if(dom["mC2"]){
dom["mC2"].style.left=left+"px";
}
if(dom["mC3"]){
dom["mC3"].style.left=left+"px";
}
}
}
}else{
_16fe=_1703[key].startRow;
_16ff=_1703[key].startCol;
_1705[Range.getPrimal(_16fe,_16ff)]=_1703[key];
_1706[Range.getPrimal(_16fe,_16ff)]=mergeDOMInfo[key];
}
}
}
}
mergeInfo["mergeList"]=_1705;
mergeDOMInfo=_1706;
}};
var mergeInfo={};
var mergeDOMInfo={};
Merge.reset();
var ActiveFormulaInfo={_activeFormulaInfo:{},set:function(row,col){
var rng=Merge.getCellInfo(row,col);
this._activeFormulaInfo["activeRow"]=row;
this._activeFormulaInfo["activeCol"]=col;
this._activeFormulaInfo["startRow"]=row;
this._activeFormulaInfo["startCol"]=col;
this._activeFormulaInfo["endRow"]=row;
this._activeFormulaInfo["endCol"]=col;
this._activeFormulaInfo["isMerged"]=false;
this._activeFormulaInfo["isSetted"]=true;
if(rng){
this._activeFormulaInfo["isMerged"]=true;
this._activeFormulaInfo["startRow"]=rng.startRow;
this._activeFormulaInfo["startCol"]=rng.startCol;
this._activeFormulaInfo["endRow"]=rng.endRow;
this._activeFormulaInfo["endCol"]=rng.endCol;
this._activeFormulaInfo["rng"]=rng;
}
},reset:function(){
this._activeFormulaInfo["isSetted"]=false;
},isAvailable:function(){
return !!this._activeFormulaInfo["isSetted"];
},getActiveRow:function(){
return this._activeFormulaInfo["activeRow"];
},getActiveCol:function(){
return this._activeFormulaInfo["activeCol"];
},getStartRow:function(){
return this._activeFormulaInfo["startRow"];
},getStartCol:function(){
return this._activeFormulaInfo["startCol"];
},getEndRow:function(){
return this._activeFormulaInfo["endRow"];
},getEndCol:function(){
return this._activeFormulaInfo["endCol"];
},getRange:function(){
return this._activeFormulaInfo["rng"];
},isMerged:function(){
return this._activeFormulaInfo["isMerged"];
},getTop:function(){
return getRowTop(this.getStartRow());
},getLeft:function(){
return getColLeft(this.getStartCol());
},getHeight:function(){
return getRowTop(this.getEndRow())+getRowHeight(this.getEndRow())-getRowTop(this.getStartRow());
},getWidth:function(){
return getColLeft(this.getEndCol())+getColWidth(this.getEndCol())-getColLeft(this.getStartCol());
},getColSpan:function(){
return this._activeFormulaInfo["endCol"]-this._activeFormulaInfo["startCol"]+1;
},getRowSpan:function(){
return this._activeFormulaInfo["endRow"]-this._activeFormulaInfo["startRow"]+1;
}};
var ActiveCellInfo={_activeCellInfo:{},reset:function(row,col){
row=~~row;
col=~~col;
var rng=Merge.getCellInfo(row,col);
this._activeCellInfo["activeRow"]=row;
this._activeCellInfo["activeCol"]=col;
this._activeCellInfo["startRow"]=row;
this._activeCellInfo["startCol"]=col;
this._activeCellInfo["endRow"]=row;
this._activeCellInfo["endCol"]=col;
this._activeCellInfo["isMerged"]=false;
if(rng){
this._activeCellInfo["isMerged"]=true;
this._activeCellInfo["startRow"]=rng.startRow;
this._activeCellInfo["startCol"]=rng.startCol;
this._activeCellInfo["endRow"]=rng.endRow;
this._activeCellInfo["endCol"]=rng.endCol;
this._activeCellInfo["rng"]=rng;
}
},getActiveRow:function(){
return this._activeCellInfo["activeRow"];
},getActiveCol:function(){
return this._activeCellInfo["activeCol"];
},getStartRow:function(){
return this._activeCellInfo["startRow"];
},getStartCol:function(){
return this._activeCellInfo["startCol"];
},getEndRow:function(){
return this._activeCellInfo["endRow"];
},getEndCol:function(){
return this._activeCellInfo["endCol"];
},getRange:function(){
return this._activeCellInfo["rng"];
},isMerged:function(){
return this._activeCellInfo["isMerged"];
},getTop:function(){
return getRowTop(this.getStartRow());
},getLeft:function(){
return getColLeft(this.getStartCol());
},getHeight:function(){
return getRowTop(this.getEndRow())+getRowHeight(this.getEndRow())-getRowTop(this.getStartRow());
},getWidth:function(){
return getColLeft(this.getEndCol())+getColWidth(this.getEndCol())-getColLeft(this.getStartCol());
},getColSpan:function(){
return this._activeCellInfo["endCol"]-this._activeCellInfo["startCol"]+1;
},getRowSpan:function(){
return this._activeCellInfo["endRow"]-this._activeCellInfo["startRow"]+1;
},getDOM:function(){
}};
var Selection={changeInPosition:function(_1725,_1726,start,end){
var _1729=[];
var _172a=[];
var objct={};
if(start>_1726||end<_1725){
_1729[0]={"start":_1725,"end":_1726};
_172a[0]={"start":start,"end":end};
}else{
if(_1725<start&&_1726<=end){
_1729[0]={"start":_1725,"end":start-1};
_172a[0]={"start":_1726,"end":end};
}else{
if(_1725>=start&&end<_1726){
_1729[0]={"start":end+1,"end":_1726};
_172a[0]={"start":start,"end":_1725-1};
}else{
if(start>_1725&&end<_1726){
_1729[0]={"start":_1725,"end":start-1};
_1729[1]={"start":end+1,"end":_1726};
}else{
if(start<=_1725&&end>=_1726){
_172a[0]={"start":start,"end":_1725-1};
_172a[1]={"start":_1726+1,"end":end};
}
}
}
}
}
var _172c=false;
if(_1729.length>0){
_172c=true;
objct["reset"]=_1729;
}
if(_172a.length>0){
_172c=true;
objct["set"]=_172a;
}
if(_172c){
return objct;
}
}};
var Iterator=function(_172d,_172e,_172f,_1730){
this.startRow=_172d;
this.startCol=_172e;
this.endRow=_172f;
this.endCol=_1730;
this.listenAll=true;
this.stopper=false;
this.eventHandler={};
this.rowsAry=!isUndefined(this.startRow)?Row.getAvailableRowsInRange(_172d,_172f):[];
this.resultHandler;
};
Iterator.prototype={iterate:function(methd){
if(mergeInfo["_mergeAll"]){
this.invoke(methd,0,0,this.args);
return;
}
this.args=Array.prototype.slice.call(arguments,1);
this.stack={};
this.colStack={};
this.cellMerge=mergeInfo["cellMerge"];
this.rowMerge=mergeInfo["rowMerge"];
this.colMerge=mergeInfo["colMerge"];
var _1732=this.rowsAry.length;
this.rowIter=_1732-1;
var _1733=this.endCol-this.startCol;
do{
if(this.stopper){
break;
}
this.colIter=_1733;
var row=this.rowsAry[(_1732-1)-this.rowIter];
this.triggerListener("onRowBefore",row,col);
this.assureNExecuteRowMerge(row,col);
do{
if(this.stopper){
break;
}
var col=this.endCol-this.colIter;
if(this._isColMerged(col)){
this._skipColumn(this._getColSpan(col));
}else{
var info=this.stack[col];
if(info){
var _1737=info["rS"];
_1737-=1;
this.stack[col]["rS"]=_1737;
if(!_1737){
delete this.stack[col];
}
this._skipColumn(info["cS"]);
}else{
var objct=this.cellMerge[Range.getPrimal(row,col)];
var _1739=this.colMerge[col];
var _173a=this.rowMerge[row];
var _173b=false;
if(objct){
var sRow=objct["startRow"];
var sCol=objct["startCol"];
var _173e=(row-sRow);
var _173f=(col-sCol);
var rSpan=objct.getRowSpan()-1-_173e;
var info={};
info["rS"]=rSpan;
info["cS"]=objct.getColSpan()-1-_173f;
if(rSpan){
this.stack[col]=info;
}
this._skipColumn(info["cS"]);
if(!_173e&&!_173f){
this.setMergeInThread(objct);
this.triggerListener("onMergeEncounter",row,col);
this.resetThreadLocal();
}else{
_173b=true;
}
}else{
if(_1739){
var sRow=_1739["startRow"];
var rDiff=(row-sRow);
this.colStack[col]=_1739.getColSpan()-1;
if(rDiff){
_173b=true;
}
this._skipColumn(this.colStack[col]);
}else{
if(_173a){
var sCol=_173a["startCol"];
var cDiff=(col-sCol);
if(cDiff){
_173b=true;
}
}
}
}
if(this.listenAll){
if(methd&&!_173b){
this.invoke(methd,row,col,this.args);
}
}
}
}
}while(this.colIter--);
this.triggerListener("onRowAfter",row,col);
}while(this.rowIter-->0);
this.reset();
return this["returnVal"];
},initData:function(_1743){
this["result"]=_1743;
},addEventListener:function(event,fn,_1746){
switch(event){
case "onRowBefore":
case "onRowAfter":
case "onMergeEncounter":
break;
default:
showAlertDialog("Please Give the valid param");
return;
}
var _1747=Array.prototype.slice.call(arguments,2);
this.eventHandler[event]={};
this.eventHandler[event]["handler"]=fn;
this.eventHandler[event]["params"]=_1747;
},triggerListener:function(event,row,col){
var _174b=this.eventHandler[event];
if(_174b){
this.invoke(_174b.handler,row,col,_174b.params);
}
},setDataProcessor:function(fn){
if(typeof this.result!="undefined"){
this["resultHandler"]=fn;
}else{
showAlertDialog("Please Init The Data");
}
},processData:function(args){
if(this["resultHandler"]){
this["result"]=this.resultHandler.apply(this,arguments);
}else{
showAlertDialog("Set Result Handler");
}
},getData:function(){
return this.result;
},invoke:function(methd,row,col,args){
var _1752=[row,col];
_1752=_1752.concat(args);
this["returnVal"]=methd.apply(this,_1752);
},setMergeInThread:function(obj){
this.setThreadLocal("MERGE",obj);
},setThreadLocal:function(prop,val){
this["_threadLocalObjct"]=this["_threadLocalObjct"]||{};
switch(prop){
case "MERGE":
this["_threadLocalObjct"][prop]=val;
break;
}
},resetThreadLocal:function(){
delete this["_threadLocalObjct"];
},getThreadLocal:function(){
return this["_threadLocalObjct"];
},getMerge:function(){
return (this.getThreadLocal())?this.getThreadLocal()["MERGE"]:undefined;
},interrupt:function(){
this.stopper=true;
},_skipRow:function(count){
this.rowIter-=count;
this.rowIter=this._assertPositive(this.rowIter);
},_skipColumn:function(count){
this.colIter-=count;
this.colIter=this._assertPositive(this.colIter);
},_isColMerged:function(col){
return (typeof this.colStack[col]!="undefined");
},_getColSpan:function(col){
return this.colStack[col];
},_assertPositive:function(iter){
iter=(iter<0)?0:iter;
return iter;
},assureNExecuteRowMerge:function(row,col){
var _175d=this.rowMerge[row];
if(_175d){
this.colIter=0;
this._skipRow(_175d.getRowSpan()-1);
}
},reset:function(){
delete this.cellMerge;
delete this.rowMerge;
delete this.colMerge;
delete this.colStack;
delete this.stack;
}};
var MergeIterator=function(){
Iterator.apply(this,arguments);
};
MergeIterator.prototype=new Iterator();
MergeIterator.prototype.iterate=function(methd){
if(mergeInfo["_mergeAll"]){
var _175f=Merge.getWhole();
this.invoke(methd,0,0,_175f);
return;
}
var rng=new Range(this.startRow,this.startCol,this.endRow,this.endCol);
var _1761=mergeInfo["mergeList"];
for(var key in _1761){
if(this.stopper){
break;
}
var objct=_1761[key];
if(rng.intersects(objct)){
var row=objct.startRow;
var col=objct.startCol;
this.setMergeInThread(objct);
this.invoke(methd,row,col,objct);
this.resetThreadLocal();
}
}
};
MergeIterator.prototype.iterateNNotifyAboveStartRow=function(methd){
if(mergeInfo["_mergeAll"]){
var _1767=Merge.getWhole();
this.invoke(methd,0,0,_1767);
return;
}
var rng=new Range(this.startRow,this.startCol,this.endRow,this.endCol);
var _1769=mergeInfo["mergeList"];
for(var key in _1769){
if(this.stopper){
break;
}
var objct=_1769[key];
if(rng.startRow<objct.startRow||rng.intersects(objct)){
var row=objct.startRow;
var col=objct.startCol;
this.invoke(methd,row,col,objct);
}
}
};
MergeIterator.prototype.iterateNNotifyAboveStartCol=function(methd){
if(mergeInfo["_mergeAll"]){
this.invoke(methd,0,0);
return;
}
var rng=new Range(this.startRow,this.startCol,this.endRow,this.endCol);
var _1770=mergeInfo["mergeList"];
for(var key in _1770){
if(this.stopper){
break;
}
var objct=_1770[key];
if(rng.startCol<objct.startCol||rng.intersects(objct)){
var row=objct.startRow;
var col=objct.startCol;
this.invoke(methd,row,col,objct);
}
}
};
MergeIterator.prototype.invoke=function(methd,row,col,args){
var _1779=methd.call(this,row,col,args);
if(_1779){
this.stopper=true;
}
};
ole.extentProperty("sCol",0);
ole.extentProperty("sRow",0);
ole.extentProperty("sColDiff",0);
ole.extentProperty("sRowDiff",0);
ole.getObjectsByColumn=function(_177a,objs){
var obj=[];
var i=0;
if(typeof objs=="undefined"){
objs=ole.getObjects();
}
for(x in objs){
if(objs[x].sCol==_177a){
obj[i++]=objs[x];
}
}
return obj;
};
ole.conf={enableKeyBoardShortcuts:true,focusElement:"OLETextarea",onPositionChange:function(_177e,left,top,_1781,_1782){
var _1783=[];
var _1784=[];
for(var i=0;i<_177e.length;i++){
_1783[i]=_177e[i].type;
}
_1784=unique(_1783);
var _1786=_1784.length;
var _1787=[];
var _1788=[];
var _1789=[];
var left=[];
var top=[];
var width=[];
var _178b=[];
var sCol=[];
var _178d=[];
var sRow=[];
var _178f=[];
var id=[];
var mode="MOVE";
var _1792="";
var _1793="";
var _1794="";
var _1795="";
for(var i=0;i<_1784.length;i++){
if(_1784[i]=="img"){
_1787=ole.getObjects("img",_177e);
}else{
if(_1784[i]=="button"){
_1789=ole.getObjects("button",_177e);
}else{
if(_1784[i]=="chart"){
_1788=ole.getObjects("chart",_177e);
}
}
}
}
if(_1784.contains("img")){
var _1796=[];
var _1797=[];
var _1798=getObj("loadtype");
for(var i=0;i<_1787.length;i++){
_1796[i]=parseInt(_1787[i].id.substring(4,_1787[i].id.length));
id[i]=parseInt(_1787[i].el.getAttribute("imgid").substring(0,_1787[i].el.getAttribute("imgid").length));
_1797[i]=encodeURIComponent(_1787[i].el.getAttribute("src"));
left[i]=_1787[i].left;
top[i]=_1787[i].top;
sCol[i]=_1787[i].sCol;
_178d[i]=_1787[i].sColDiff;
sRow[i]=_1787[i].sRow;
_178f[i]=_1787[i].sRowDiff;
var data={"imgid":id,"left":left,"top":top,"seqnum":_1796,"imgurl":_1797,"loadtype":_1798,"sCol":sCol,"sRow":sRow,"sColDiff":_178d,"sRowDiff":_178f};
_1792=JSON.stringify(data);
}
}
if(_1784.contains("button")){
for(var i=0;i<_1789.length;i++){
id[i]=_1789[i].id;
left[i]=_1789[i].left;
top[i]=_1789[i].top;
width[i]=_1789[i].width;
_178b[i]=_1789[i].height;
}
var data={"NAME":id,"LEFT":left,"TOP":top,"WIDTH":width,"HEIGHT":_178b};
_1794=JSON.stringify(data);
}
if(_1784.contains("chart")){
var _179a=[];
var types=[];
var range=[];
var dbID=[];
for(var i=0;i<_1788.length;i++){
id[i]=_1788[i].id;
sCol[i]=_1788[i].sCol;
_178d[i]=_1788[i].sColDiff;
sRow[i]=_1788[i].sRow;
_178f[i]=_1788[i].sRowDiff;
left[i]=parseInt(_1788[i].left);
top[i]=parseInt(_1788[i].top);
_179a[i]=ExcelGraph.getInstance(id[i]);
types[i]=_179a[i]["CP_GRAPHTYPE"];
range[i]=_179a[i]["CP_DATARANGE"];
dbID[i]=_179a[i]["CP_CHART_DBID"];
var data={"NAME":id,"LEFT":left,"TOP":top,"GRAPHTYPE":types,"DATARANGE":range,"CHART_DBID":dbID,"SCOL":sCol,"SROW":sRow,"SCOL_DIFF":_178d,"SROW_DIFF":_178f};
if(_1788.length==1){
data={"NAME":[id[0]],"LEFT":[left[0]],"TOP":[top[0]],"GRAPHTYPE":[types[0]],"DATARANGE":[range[0]],"CHART_DBID":[dbID[i]],"SCOL":[sCol[0]],"SROW":[sRow[0]],"SCOL_DIFF":[_178d[0]],"SROW_DIFF":[_178f[0]]};
}
}
_1793=JSON.stringify(data);
}
if(!_1781){
_1781=false;
}
if(_1792!=""&&_1787.length>=1){
_1795+="&img="+_1792+"&hasImages="+true;
}
if(_1794!=""&&_1789.length>=1){
_1795+="&button="+_1794+"&hasButtons="+true;
}
if(_1793!=""&&_1788.length>=1){
_1795+="&chart="+_1793+"&hasCharts="+true;
}
if(_1795!=""){
var _179e="&MODE="+mode+"&ACTION=move&docid="+DOCUMENT_ID+"&sheetname="+encodeURIComponent(CURRSHEETNAME)+"&curtime="+CURRENTTIME;
_179e+="&docowner="+CURR_DOC_OWNERNAME+"&collabid="+COLLAB_ID+"&collabEditing="+COLLABORATIVE_EDITING+"&SHEETNAME="+encodeURIComponent(CURRSHEETNAME);
_179e+="&afterRTC="+_1781+"&readwrite="+ALLOW_TO_WRITE+"&isSameSheet="+ISSAMESHEET+"&DOCID="+DOCUMENT_ID+"&bridgeNumber="+bridgeNumber;
_179e+="&rtcSheetName="+encodeURIComponent(RTCSHEETNAME)+"&viewType="+getViewType()+"&docname="+encodeURIComponent(DOCUMENT_NAME);
_179e+="&isRemoteView="+jsREMOTE_VIEW+"&SHOW_LEGEND=true"+"&CP_CHART_TITLE=true";
var _179f=new getXmlhttp();
_179f.open("POST",ctxpath+"OleUpdateAction.do",true);
_179f.onreadystatechange=function(){
if(_179f.readyState===4){
hasOleMoved=false;
if(_1782){
_1782.method(_1782.param1,_1782.param2,_1782.param3);
}
}
};
_179f.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_179f.send(_1795+_179e);
}else{
hasOleMoved=false;
if(_1782){
_1782.method(_1782.param1,_1782.param2,_1782.param3);
}
}
},onblur:function(){
getObj("fD").style.visibility="";
setFocusInCellField();
if(isCellRange()){
var _17a0=getCellRange();
selectRowHead(_17a0.startRow,_17a0.endRow);
selectColHead(_17a0.startCol,_17a0.endCol);
}else{
selectRowHead(currRow,currRow);
selectColHead(currCol,currCol);
}
},onfocus:function(){
getObj("fD").style.visibility="hidden";
if(isCellRange()){
var _17a1=getCellRange();
blurRowHead(_17a1.startRow,_17a1.endRow);
blurColHead(_17a1.startCol,_17a1.endCol);
}else{
blurRowHead(currRow,currRow);
blurColHead(currCol,currCol);
}
ole.focus();
},onKeyDown:function(ev){
var _17a3=!os_mac&&(ev.ctrlKey&&!ev.metaKey)||os_mac&&(ev.metaKey||ev.ctrlKey);
var _17a4=ev.shiftKey;
var _17a5=false;
var _17a6=false;
var _17a7=ole.getCurrObj();
var left=_17a7.getLeft();
var top=_17a7.getTop();
var id=_17a7.id;
var type=_17a7.type;
var el=(browser_ie)?ev.srcElement:ev.target;
if(_17a3){
ole.onCtrlKeyDown(ev,el);
}
switch(ev.keyCode){
case 9:
if(!_17a3){
var _17ad=ole.getObjectsSortedByPos();
var len=_17ad.length;
if(typeof ole.pointer==="undefined"){
for(var i=0;i<len;i++){
if(_17ad[i][0]===id){
ole.pointer=i;
break;
}
}
}
if(_17a4){
if(ole.pointer===0){
ole.pointer=len-1;
}else{
ole.pointer--;
}
if(ole(_17ad[ole.pointer][0])===ole.currFocusObj){
ole.currFocusObj.displayAssociativeElements("","none");
}
ole(_17ad[ole.pointer][0]).setSelectLayer().positionActionBar(false);
}else{
if(ole.pointer===(len-1)){
ole.pointer=0;
}else{
ole.pointer++;
}
if(ole(_17ad[ole.pointer][0])===ole.currFocusObj){
ole.currFocusObj.displayAssociativeElements("","none");
}
ole(_17ad[ole.pointer][0]).setSelectLayer().positionActionBar(false);
}
_17a6=true;
}
break;
case 27:
if(ole.onDrag){
ole.onDrag=false;
if(ole.isDragged){
var _17b0=ole.currObj.getActionBar();
_17b0.style.visibility="visible";
ole.isActionBarLocked=false;
_17a7.positionActionBar(true);
ole.isDragged=false;
ole.isCalledOnce=false;
if(ole.lastClonedSelectLayer){
var _17b1=getObj(ole.lastClonedSelectLayer);
var _17b2=_17b1.parentNode;
if(_17b2){
_17b2.removeChild(_17b1);
}
}
}
}else{
_17a7.deSelect();
ole.conf.onblur();
_17a5=true;
}
break;
case 37:
if(_17a4&&_17a3){
if(ole.isFocusOnResizeCorners){
}else{
_17a7.setRearX(getColLeft(findColInXPos(_17a7.getRearX()))).setSelectLayer().positionActionBar(false);
}
}else{
if(_17a3){
if(ole.isFocusOnResizeCorners){
}else{
_17a7.setLeft(getColLeft(findColInXPos(left))).setSelectLayer().positionActionBar(false);
}
}else{
if(ole.isFocusOnResizeCorners){
if(left>0){
var width=_17a7.width;
_17a7.setLeft(left-1).setWidth(width+1).setSelectLayer().positionActionBar(false);
}
}else{
if(left>0){
_17a7.setLeft(left-1).setSelectLayer().positionActionBar(false);
}
}
}
}
_17a5=true;
break;
case 38:
if(_17a4&&_17a3){
_17a7.setRearY(getRowTop(findRowInYPos(_17a7.getRearY()))).setSelectLayer().positionActionBar(false);
}else{
if(_17a3){
_17a7.setTop(getRowTop(findRowInYPos(top))).setSelectLayer().positionActionBar(false);
}else{
if(top>0){
_17a7.setTop(top-1).setSelectLayer().positionActionBar(false);
}
}
}
_17a5=true;
break;
case 39:
if(_17a4&&_17a3){
_17a7.setRearX(getColLeft(findColInXPos(_17a7.getRearX()+1)+1)).setSelectLayer().positionActionBar(false);
}else{
if(_17a3){
_17a7.setLeft(getColLeft(findColInXPos(left+1)+1)).setSelectLayer().positionActionBar(false);
}else{
if(left<getSheetTableWidth()){
_17a7.setLeft(left+1).setSelectLayer().positionActionBar(false);
}
}
}
_17a5=true;
break;
case 40:
if(_17a4&&_17a3){
_17a7.setRearY(getRowTop(findRowInYPos(_17a7.getRearY()+1)+1)).setSelectLayer().positionActionBar(false);
}else{
if(_17a3){
_17a7.setTop(getRowTop(findRowInYPos(top+1)+1)).setSelectLayer().positionActionBar(false);
}else{
if(top<getSheetTableHeight()){
_17a7.setTop(top+1).setSelectLayer().positionActionBar(false);
}
}
}
_17a5=true;
break;
case 46:
ole.remove(ole.currObj.id,true);
ole.conf.onblur();
break;
case 78:
if(!jsDOCS_VIEW){
ole.onOpenNewDoc();
TEMPLATE_FLAG="false";
loadDocument("ajaxnew.do");
}
if(ole.objects[type].onDocOpen){
ole.objects[type].onDocOpen(id);
}
_17a6=true;
break;
case 82:
if(!ole.isFocusOnResizeCorners){
ole.isFocusOnResizeCorners=true;
}else{
ole.isFocusOnResizeCorners=false;
}
break;
case 83:
if(_17a3){
savefile();
}
_17a6=true;
break;
case 113:
if(ole.objects[type].onedit){
ole.objects[type].onedit(id);
}
break;
}
if(_17a5&&ole.objects[type].onMove){
ole.objects[type].onMove(id,_17a7.getLeft(),_17a7.getTop());
if(os_mac&&ole.objects[type].onMoveEnd){
ole.addToEventBuffer([id,type,"onMoveEnd",left,top]);
if(ole.eventDispatchTimeout){
window.clearTimeout(ole.eventDispatchTimeout);
}
ole.eventDispatchTimeout=window.setTimeout("ole.dispatchEvents()",1000);
_17a6=true;
}
}
if(_17a6){
return false;
}
},onKeyUp:function(ev){
var _17b5=!os_mac&&(ev.ctrlKey&&!ev.metaKey)||os_mac&&(ev.metaKey||ev.ctrlKey);
var _17b6=ev.shiftKey;
var _17b7=ole.getCurrObj();
var type=_17b7.type;
var left=_17b7.getLeft();
var top=_17b7.getTop();
var id=_17b7.id;
var el=(browser_ie)?ev.srcElement:ev.target;
var _17bd=false;
if(_17b5||ev.keyCode===17){
ole.onCtrlKeyUp(ev,el);
}
switch(ev.keyCode){
case 37:
case 38:
case 39:
case 40:
if(ole.objects[type].onMoveEnd){
ole.addToEventBuffer([id,type,"onMoveEnd",left,top]);
if(ole.eventDispatchTimeout){
window.clearTimeout(ole.eventDispatchTimeout);
}
ole.eventDispatchTimeout=window.setTimeout("ole.dispatchEvents()",1000);
}
_17bd=true;
break;
case 82:
break;
case 83:
}
if(_17bd){
return false;
}
}};
ole.shiftObjects=function(_17be,_17bf,_17c0){
switch(_17be){
case "INSERT":
return;
var _17c1=_17bf;
var _17c2=_17c0;
var _17c3=[];
var _17c4=ole.getObjects();
for(var i=0;i<_17c4.length;i++){
if(pos!="after"){
if(_17c2<OLE[_17c4[i].id].sRow){
OLE[_17c4[i].id].sRow=parseInt(OLE[_17c4[i].id].sRow)+parseInt(cnt);
}
}else{
OLE[_17c4[i].id].sRow=parseInt(OLE[_17c4[i].id].sRow)+parseInt(cnt);
}
var diff=parseInt(OLE[_17c4[i].id].sRowDiff);
var row=parseInt(OLE[_17c4[i].id].sRow);
var _17c8=parseInt(getRowHeight(row));
var top=parseInt(getRowTop(row));
if(diff>_17c8){
_17c3[i]=top+_17c8;
}else{
_17c3[i]=top+diff;
}
OLE[_17c4[i].id].setTop(_17c3[i]);
if(ole.getCurrObj()){
ole.getCurrObj().setSelectLayer().positionActionBar();
}
}
ole.conf.onPositionChange(_17c4);
case "DeleteRow":
return;
var _17c1=getCellRange().startRow;
var _17c2=getCellRange().endRow;
var _17c3=[];
var _17ca=[];
var _17ca=ole.getObjectsByPositionY(getRowTop(_17c1),getRowTop(_17c2+1));
var _17cb=ole.getObjectsByPositionY(getRowTop(_17c2+1));
if(_17ca.length!=0){
for(var i=0;i<=_17ca.length-1;i++){
OLE[_17ca[i].id].sRowDiff=0;
OLE[_17ca[i].id].sRow=_17c1;
OLE[_17ca[i].id].setTop(getRowTop(_17c1));
}
}
for(var i=0;i<_17cb.length;i++){
OLE[_17cb[i].id].sRow=OLE[_17cb[i].id].sRow-cnt;
var diff=parseInt(OLE[_17cb[i].id].sRowDiff);
var row=parseInt(OLE[_17cb[i].id].sRow);
var _17c8=parseInt(getRowHeight(row));
var top=parseInt(getRowTop(row));
if(diff>_17c8){
_17c3[i]=top+_17c8;
}else{
_17c3[i]=top+diff;
}
OLE[_17cb[i].id].setTop(_17c3[i]);
if(ole.getCurrObj()){
ole.getCurrObj().setSelectLayer().positionActionBar();
}
}
var _17c4=ole.getObjects();
ole.conf.onPositionChange(_17c4);
setFocusInCellField();
break;
case "HEIGHT":
var _17ca=ole.getObjectsByPositionY(getRowTop(_17bf));
var _17c3=[];
if(_17ca.length>0){
for(var i=0;i<_17ca.length;i++){
var diff=parseInt(OLE[_17ca[i].id].sRowDiff);
var row=parseInt(OLE[_17ca[i].id].sRow);
var _17c8=parseInt(getRowHeight(row));
var top=parseInt(getRowTop(row));
if(diff>_17c8){
_17c3[i]=top+_17c8;
}else{
_17c3[i]=top+diff;
}
OLE[_17ca[i].id].setTop(_17c3[i]);
if(ole.getCurrObj()){
ole.getCurrObj().setSelectLayer().positionActionBar();
}
}
hasOleMoved=true;
}
}
};
function General(){
}
General.isLoggedIn=false;
var isIE=navigator.appName=="Microsoft Internet Explorer"&&navigator.userAgent.indexOf("Opera")<1?1:0;
var isOp=navigator.userAgent.indexOf("Opera")>-1?1:0;
var isGe=navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("Safari")<1?1:0;
var rq=new Array();
function HttpCommunication(){
this.callback=onDemandResponse;
this.ieCallbackForIFrame=ieCallbackForIFrame;
this.iframecallback=callOnLoadOfIFrame;
this.request=request;
this.submitForm=submitForm;
this.handleRequest1=handleRequest1;
this.modules=null;
this.targetObj=null;
this.setTargetObj=setTargetObj;
this.setModules=setModules;
this.createAndSubmitForm=createAndSubmitForm;
}
function setModules(_17cc){
this.modules=_17cc;
}
function addModule(_17cd){
this.modules.push(_17cd);
}
function setTargetObj(_17ce){
this.targetObj=_17ce;
}
function request(url){
if(isIE){
var tmp=url.indexOf("?");
var time=(new Date()).getTime();
if(tmp!=-1){
url=url+"&DATE="+time;
}else{
url=url+"?DATE="+time;
}
}
return this.handleRequest1(url,this.callback);
}
function submit(url){
}
function submitForm(_17d3){
return this.handleRequest1(_17d3.action,this.callback,_17d3);
}
function getObject(_17d4,_17d5){
if(_17d4=="do"){
var dobj=new DataObject();
for(i=0;i<_17d5.length;i++){
var table=_17d5[i];
var _17d8=table.tname;
var cols=table.cols;
var rows=table.rows;
for(j=0;j<rows.length;j++){
var row=rows[j];
var _17dc=new Array();
for(k=0;k<row.length;k++){
_17dc[k]=[cols[k],row[k]];
}
dobj.addRowsForTable(_17d8,_17dc);
}
}
return dobj;
}
return _17d5;
}
function onDemandResponse(_17dd){
var list=eval(_17dd);
var len=list.length;
for(var i=0;i<len;i++){
var _17e1=list[i];
var _17e2=this.modules[_17e1.module];
if(_17e2){
_17e2(this.targetObj,_17e1.objType,getObject(_17e1.objType,_17e1.objString));
}
}
}
function handleRequest1(rurl,_17e4,_17e5){
var _17e6=this;
var _17e7=new getXmlhttp();
_17e7.onreadystatechange=function(){
if(_17e7.readyState==4&&_17e7.status<300){
var _17e8=_17e7.responseText;
try{
_17e6.callback(_17e8);
}
catch(e){
openSheet(_17e8);
}
}
};
if(_17e5){
handleForm(_17e7,rurl,_17e5);
}else{
_17e7.open("GET",rurl,true);
_17e7.send(null);
}
return true;
}
function handleForm(req,u,_17eb){
var cn=_17eb.elements;
var nvp="";
for(i=0;i<cn.length;i++){
try{
nvp+=cn.item(i).name+"="+cn.item(i).value+"&";
}
catch(e){
showAlertDialog(e);
}
}
nvp=encodeURI(nvp);
req.open("POST",u,true);
req.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");
req.setRequestHeader("Content-length",nvp.length);
req.send(nvp);
}
function createAndSubmitForm(_17ee,_17ef,_17f0,_17f1){
var _17f2=document.getElementById("submitForm");
if(_17f2){
var pNode=_17f2.parentNode;
pNode.removeChild(_17f2);
}
_17f2=document.createElement("form");
_17f2.action=_17ee;
_17f2.method="POST";
_17f2.id="submitform";
_17f2.encoding=_17f0;
_17f2.enctype=_17f0;
for(var k=0;k<_17ef.length;k++){
var ele=_17ef[k];
var _17f6=document.createElement("input");
_17f6.type="hidden";
_17f6.name=ele.PARAM_NAME;
_17f6.value=ele.PARAM_VALUE;
_17f2.appendChild(_17f6);
}
if(isIE){
var _17f6=document.createElement("input");
_17f6.type="hidden";
_17f6.name="DATE";
_17f6.value=(new Date()).getTime();
_17f2.appendChild(_17f6);
}
if(!_17f1){
if(_17f2.childNodes.length>0){
document.body.appendChild(_17f2);
this.submitForm(_17f2);
}
}else{
if(_17f2.childNodes.length>0){
var _17f7=document.getElementById("saveTempIFrame");
_17f2.target="saveTempIFrame";
document.body.appendChild(_17f2);
var _17f8=this;
if(isIE){
_17f2.submit();
setTimeout(function(){
_17f8.ieCallbackForIFrame(_17f7);
},100);
}else{
_17f7.onload=function(){
_17f8.iframecallback(_17f7.contentWindow);
};
_17f2.submit();
}
}
}
}
function ieCallbackForIFrame(_17f9){
var _17fa=this;
var _17fb=_17f9.contentWindow.document.readyState;
if(_17fb=="complete"){
this.iframecallback(_17f9.contentWindow);
}else{
setTimeout(function(){
_17fa.ieCallbackForIFrame(_17f9);
},100);
}
}
function callOnLoadOfIFrame(_17fc){
if(!_17fc||!_17fc.resp){
return;
}
var _17fd=_17fc.resp;
this.callback(_17fd);
}
function getLayoutResponse(_17fe,_17ff,_1800){
_17fe.getLayoutResponse(_17ff,_1800);
}
function sheetSaved(_1801,_1802,_1803){
_1801.sheetSaved(_1802,_1803);
}
var cellRange;
var startR;
var startC;
var endR;
var endC;
var checkTextDeco=false;
function fillCellRange(){
if(isCellRange()){
cellRange=getCellRange();
startR=cellRange.startRow;
startC=cellRange.startCol;
endR=cellRange.endRow;
endC=cellRange.endCol;
}else{
startR=endR=ActiveCellInfo.getStartRow();
startC=endC=ActiveCellInfo.getStartCol();
}
}
function fetchRowHeights(_1804,_1805){
var _1806="";
return _1806;
}
function clearFormatting(_1807,_1808,_1809,_180a){
clearBorder(_1807,_1808,_1809,_180a);
clearFormat(_1807,_1808,_1809,_180a);
}
function clearFormat(_180b,_180c,_180d,_180e){
var range=new Range(_180b,_180c,_180d,_180e);
var iter=range.getIterator();
iter.iterate(function(_1811,_1812){
var _1813=getCell(_1811,_1812);
if(_1813!=null){
setDefaultFormatForCell(_1813);
}
if(ISFREEZED){
if(FREEZED_ROW>0){
_1813=getCell(_1811,_1812,sheetPane2Id);
if(_1813!=null){
setDefaultFormatForCell(_1813);
}
}
if(FREEZED_COL>0){
_1813=getCell(_1811,_1812,sheetPane3Id);
if(_1813!=null){
setDefaultFormatForCell(_1813);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_1813=getCell(_1811,_1812,sheetPane1Id);
if(_1813!=null){
setDefaultFormatForCell(_1813);
}
}
}
});
}
function applyNumberFormat(_1814,endR,_1816,endC,_1818,obj){
var _181a=Row.getAvailableRowsInRange(_1814,_1816);
for(var i=0,len=_181a.length;i<len;i++){
rowIndex=_181a[i];
for(var _181d=_1816;_181d<=endC;_181d++){
selectedCell=getCell(rowIndex,_181d);
setOrRemoveFormatAttr(selectedCell,_1818,obj);
if(ISFREEZED){
if(FREEZED_ROW>0){
selectedCell=getCell(rowIndex,_181d,sheetPane2Id);
setOrRemoveFormatAttr(selectedCell,_1818,obj);
}
if(FREEZED_COL>0){
selectedCell=getCell(rowIndex,_181d,sheetPane3Id);
setOrRemoveFormatAttr(selectedCell,_1818,obj);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
selectedCell=getCell(rowIndex,_181d,sheetPane1Id);
setOrRemoveFormatAttr(selectedCell,_1818,obj);
}
}
}
}
}
function setFormatforCell(_181e,_181f,_1820,_1821,_1822){
if(_181e!=null&&isObject(_181e)&&isStr(_181f)&&isBoolean(_1820)&&isStr(_1821)){
if(_1820){
_181e.className=_181e.className.replace(_181f,"");
}else{
var _1823=_181e.className;
if(_1823.indexOf(_181f)==-1){
_1823=_1823+_181f;
_181e.className=_1823;
if(isUndefined(_1822)){
_1822="";
}
if(_1821=="verticalAlign"){
alignCellVertically(_181e,_181f,_1822);
}else{
if(_1821=="textAlign"){
if(_181e.className.indexOf(" vab")!=-1){
alignCellVertically(_181e," vab",_1822);
}else{
if(_181e.className.indexOf(" vam")!=-1){
alignCellVertically(_181e," vam",_1822);
}else{
if(_181e.className.indexOf(" vat")!=-1){
alignCellVertically(_181e," vat",_1822);
}
}
}
}
}
}
}
}
}
function setOrRemoveFormatAttr(_1824,_1825,obj){
if(_1824){
if(_1825=="STANDARD"){
_1824.removeAttribute("format");
}else{
if(_1825=="PERCENT"){
(obj.is(":checked"))?_1824.setAttribute("format",_1825):_1824.setAttribute;
}else{
_1824.setAttribute("format",_1825);
}
}
}
}
function setStyleValue(_1827,_1828){
if($("#"+_1827).metadata().appData.status=="true"){
_1828=0;
}else{
_1828=1;
}
format_new(_1827,_1828);
}
function format_new(_1829,_182a,sR,sC,eR,eC,_182f){
if(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE){
return;
}
if(typeof _182f=="undefined"){
_182f="false";
}
if(typeof sR=="undefined"){
fillCellRange();
}else{
startR=sR;
startC=sC;
endR=eR;
endC=eC;
}
var _1830;
if(_1829=="userFormat"){
_1829=$("#"+_1829).zcombo("getValue");
}else{
if(_1829=="currency"){
_1829=$("#"+_1829).attr("currencyType");
}
}
if(_1829=="DOLLAR"||_1829=="CURRENCY"||_1829=="PERCENT"||_1829=="STANDARD"||_1829=="YEN"||_1829=="EURO"||_1829=="POUND"||_1829=="RUPEE"||_1829=="NONE"||_1829=="TEXT"||_1829=="RMB"){
var _1831;
var _1832=["CURRENCY","DOLLAR","YEN","EURO","POUND","RUPEE","PERCENT","TEXT","RMB","STANDARD"];
for(var i=0;i<_1832.length;i++){
if(_1829==_1832[i]){
_1831=USERCURRENCY=_1832[i];
}
}
var _1834=getObj("currency");
var _1835=_1834.getAttribute("currencyType");
if(!isUndefined(_182a)){
$("#currency").children("span:first").text($(_182a).children("span:first").text());
_1834.setAttribute("currencyType",USERCURRENCY);
changetooltip(_1834,$(_182a).data().metadata.label);
}
var obj=$("#"+_1829);
if(_1829=="NONE"||!obj.next().hasClass("ui-state-active")&&_1829=="PERCENT"){
_1831="STANDARD";
}
if(!obj.next().hasClass("ui-state-active")&&_1829=="PERCENT"){
if(_1829=="PERCENT"){
$("#PERCENT").next().removeClass("ui-state-active");
}
}else{
if(_1829=="PERCENT"){
$("#PERCENT").next().addClass("ui-state-active");
}
}
var _1837=getViewPortRoundedDetails(startR,endR);
if(_1837.isInViewPort){
applyNumberFormat(_1837.startRowIdx,_1837.endRowIdx,startC,endC,_1831,obj);
}
if(_1837.isInFreezedRange){
applyNumberFormat(_1837.freezedStartRowIdx,_1837.freezedEndRowIdx,startC,endC,_1831,obj);
}
submitCellValueFormat(_1831,startR,startC,endR,endC,_182f);
return;
}
var _1830=getCell(startR,startC);
var style="";
var _1839="";
var value=0;
var _183b=false;
if(!jsGADGET_VIEW){
switch(_1829){
case "bold":
case "italic":
case "strike":
case "underline":
}
}
switch(_1829){
case "bold":
_1839="BOLD";
style=" fwb";
if(_182a==1){
_183b=false;
value=1;
}else{
_183b=true;
value=0;
}
if(jsGADGET_VIEW){
if(_1830&&_1830.className.indexOf(" fwb")!=-1){
_183b=true;
value=0;
}else{
_183b=false;
value=1;
}
}
updateRangeFormat(startR,startC,endR,endC,"fontWeight",value);
break;
case "italic":
_1839="ITALIC";
style=" fsi";
if(_182a==1){
_183b=false;
value=1;
}else{
_183b=true;
value=0;
}
if(jsGADGET_VIEW){
if(_1830&&_1830.className.indexOf(" fsi")!=-1){
_183b=true;
value=0;
}else{
_183b=false;
value=1;
}
}
updateRangeFormat(startR,startC,endR,endC,"fontStyle",value);
break;
case "strike":
_1839="STRIKETHROUGH";
style=" tdst";
if(_182a==1){
_183b=false;
value=1;
}else{
_183b=true;
value=0;
}
if(jsGADGET_VIEW){
if(_1830&&_1830.className.indexOf(" tdst")!=-1){
_183b=true;
value=0;
}else{
_183b=false;
value=1;
}
}
updateRangeFormat(startR,startC,endR,endC,"strikeThrough",value);
break;
case "underline":
_1839="UNDERLINE";
style=" tdu";
if(_182a==1){
_183b=false;
value=1;
}else{
_183b=true;
value=0;
}
if(jsGADGET_VIEW){
if(_1830&&_1830.className.indexOf(" tdu")!=-1){
_183b=true;
value=0;
}else{
_183b=false;
value=1;
}
}
updateRangeFormat(startR,startC,endR,endC,"textDecoration",value);
break;
case "fontFace":
_1839="FONTFAMILY";
if(typeof _182a=="undefined"){
value=$("#"+_1829).zcombo("getValue");
}else{
value=_182a;
}
updateRangeFormat(startR,startC,endR,endC,"fontFamily",value);
break;
case "fontSize":
_1839="FONTSIZE";
if(typeof _182a=="undefined"){
value=$("#"+_1829).zcombo("getValue");
}else{
value=_182a;
}
updateRangeFormat(startR,startC,endR,endC,"fontSize",value);
break;
case "vtop":
_1839="VALIGN";
value="top";
updateRangeFormat(startR,startC,endR,endC,"verticalAlign",value);
break;
case "vcenter":
_1839="VALIGN";
value="middle";
updateRangeFormat(startR,startC,endR,endC,"verticalAlign",value);
break;
case "vbottom":
_1839="VALIGN";
value="bottom";
updateRangeFormat(startR,startC,endR,endC,"verticalAlign",value);
break;
case "left":
_1839="HALIGN";
var _183c="";
if(_183c.indexOf("chked")==-1){
value="left";
updateRangeFormat(startR,startC,endR,endC,"textAlign",value);
}else{
alignText(obj,sR,sC,eR,eC,_182f);
return;
}
break;
case "center":
_1839="HALIGN";
var _183c="";
if(_183c.indexOf("chked")==-1){
value="center";
updateRangeFormat(startR,startC,endR,endC,"textAlign",value);
}else{
alignText(obj,sR,sC,eR,eC,_182f);
return;
}
break;
case "right":
_1839="HALIGN";
var _183c="";
if(_183c.indexOf("chked")==-1){
value="right";
updateRangeFormat(startR,startC,endR,endC,"textAlign",value);
}else{
alignText(obj,sR,sC,eR,eC,_182f);
return;
}
break;
case "bgcolor":
var _183d=getObj(_1829).childNodes[0];
_1839="BACKGROUNDCOLOR";
if(typeof _182a=="undefined"){
var value=_183d.style.borderBottomColor;
}else{
var value=_182a;
}
BACKGROUNDCOLOR=value;
if(_182f=="false"){
_183d.style.borderBottomColor=value;
if(!isUndefined(value)){
_183d.style.borderBottomColor=value;
}
}
updateRangeFormat(startR,startC,endR,endC,"backgroundColor",value);
break;
case "fontcolor":
_1839="TEXTCOLOR";
if(isUndefined(_182a)){
var value=$("#"+_1829).children("span:first").css("border-bottom-color");
}else{
var value=_182a;
}
FONTCOLOR=value;
if(_182f=="false"){
$("#"+_1829).children("span:first").css({"border-bottom-color":value});
if(!isUndefined(value)){
$("#"+_1829).children("span:first").css({"border-bottom-color":value});
}
}
updateRangeFormat(startR,startC,endR,endC,"color",value);
break;
}
var _183e=startR;
var _183f=startC;
var _1840=endR;
var _1841=endC;
if(startR==endR&&startC==endC){
var info=ActiveCellInfo;
var sRow=info.getStartRow();
var sCol=info.getStartCol();
var eRow=info.getEndRow();
var eCol=info.getEndCol();
if(sRow==startR&&sCol==startC){
_183e=sRow;
_183f=sCol;
_1840=eRow;
_1841=eCol;
}
}
var _1847=fetchRowHeights(startR,endR);
var _1848=getAvailableStartRow();
var _1849=getAvailableEndRow();
document.cellform.actionMode.value="Format";
document.cellform.startColumn.value=_183f;
document.cellform.endColumn.value=_1841;
document.cellform.startRow.value=_183e;
document.cellform.endRow.value=_1840;
document.cellform.formattedCellValue.value=_1839;
document.cellform.textAreaValue.value=value;
document.cellform.tmpData.value=_1847;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_182f;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.availableStartRow.value=_1848;
document.cellform.availableEndRow.value=_1849;
if(_182f=="false"){
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
}else{
if(startR==0&&endR==65535){
document.cellform.isColSelected.value=true;
}else{
document.cellform.isColSelected.value=false;
}
if(startC==0&&endC==255){
document.cellform.isRowSelected.value=true;
}else{
document.cellform.isRowSelected.value=false;
}
}
document.cellform.totCols.value=totCols;
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _184a=getObj("apiKey");
if(_184a!=null){
document.cellform.apiKeyId.value=_184a.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
if(getCellContent(currCell,"fn")=="hide"&&jsPUBLIC_VIEW&&!showFormulas){
resetGlobalVariables();
return;
}
document.cellform.bridgeNo.value=bridgeNumber;
if(_1839=="TEXTCOLOR"){
importxmlForForm(document.cellform,updateCell,true);
}else{
importxmlForForm(document.cellform,formatCell,true);
}
if(_182f=="false"){
closeDialog();
if(_1839=="FONTFAMILY"){
$("#fontFace").blur();
}
if(_1839=="FONTSIZE"){
$("#fontSize").blur();
}
focusSheet();
}
}
function alignText(obj,sR,sC,eR,eC,_1850){
if(typeof _1850=="undefined"){
_1850="false";
}
if(typeof sR=="undefined"){
fillCellRange();
}else{
startR=sR;
startC=sC;
endR=eR;
endC=eC;
}
var _1851="";
var xml="";
var _1853=Row.getAvailableRowsinRange(sR,sC);
for(var k=0,len=_1853.length;k<len;k++){
i=_1853[k];
for(var j=startC;j<=endC;j++){
var sCell=getCell(i,j);
var cV=sCell.getAttribute("cV");
if(cV==null||cV=="null"){
cV="";
}
var _1859=false;
var _185a=false;
if(cV!=""){
if(cV.indexOf("$")==0){
_1859=true;
}
if(cV.indexOf("%")==(cV.length-1)){
_185a=true;
}
}
var _185b="";
if(cV==""){
_185b="left";
}else{
if(!isNaN(cV)||_1859||_185a){
_185b="right";
}else{
_185b="left";
}
}
setCSSStyleForTextAlign(sCell,_185b);
if(ISFREEZED){
if(FREEZED_ROW>0){
sCell=getCell(i,j,sheetPane2Id);
setCSSStyleForTextAlign(sCell,_185b);
}
if(FREEZED_COL>0){
sCell=getCell(i,j,sheetPane3Id);
setCSSStyleForTextAlign(sCell,_185b);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
sCell=getCell(i,j,sheetPane1Id);
setCSSStyleForTextAlign(sCell,_185b);
}
}
if(i==startR&&j==startC){
_1851=_185b;
}
xml+=i+"-"+j+"-"+_185b+":";
}
}
if(xml!=""){
xml=xml.substring(0,xml.length-1);
}
var _185c=startR;
var _185d=startC;
var _185e=endR;
var _185f=endC;
if(startR==endR&&startC==endC){
var info=ActiveCellInfo;
var sRow=info.getStartRow();
var sCol=info.getStartCol();
var eRow=info.getEndRow();
var eCol=info.getEndCol();
if(sRow==startR&&sCol==startC){
_185c=sRow;
_185d=sCol;
_185e=eRow;
_185f=eCol;
}
}
var _1865=getAvailableStartRow();
var _1866=getAvailableEndRow();
document.cellform.actionMode.value="AlignText";
document.cellform.startColumn.value=_185d;
document.cellform.endColumn.value=_185f;
document.cellform.startRow.value=_185c;
document.cellform.endRow.value=_185e;
document.cellform.formattedCellValue.value=xml;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_1850;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_1865;
document.cellform.availableEndRow.value=_1866;
if(_1850=="false"){
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
}else{
if(sR==0&&eR==65535){
document.cellform.isColSelected.value=true;
}else{
document.cellform.isColSelected.value=false;
}
if(sC==0&&eC==255){
document.cellform.isRowSelected.value=true;
}else{
document.cellform.isRowSelected.value=false;
}
}
document.cellform.totCols.value=totCols;
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _1867=getObj("apiKey");
if(_1867!=null){
document.cellform.apiKeyId.value=_1867.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,formatCell,true);
}
function setCSSStyleForTextAlign(sCell,_1869){
if(sCell){
if(_1869=="right"){
removeCSSStyle("textAlign",sCell);
if(sCell.className.indexOf(" tar")==-1){
sCell.className+=" tar";
}
}else{
removeCSSStyle("textAlign",sCell);
}
}
}
function removeStyle(_186a,sR,sC,eR,eC){
var range=new Range(sR,sC,eR,eC);
var iter=range.getIterator();
iter.iterate(function(_1871,_1872){
var _1873=getCell(_1871,_1872);
if(_1873){
removeStyle1(_186a,_1873);
}
if(ISFREEZED){
if(FREEZED_ROW>0){
_1873=getCell(_1871,_1872,sheetPane2Id);
if(_1873){
removeStyle1(_186a,_1873);
}
}
if(FREEZED_COL>0){
_1873=getCell(_1871,_1872,sheetPane3Id);
if(_1873){
removeStyle1(_186a,_1873);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_1873=getCell(_1871,_1872,sheetPane1Id);
if(_1873){
removeStyle1(_186a,_1873);
}
}
}
});
}
function removeStyle1(_1874,_1875){
if(_1875!=null&&_1875!="null"){
_1875.style[_1874]="";
}
}
function fill_colors(obj){
format_new(getObj(obj));
}
function applyLastColor(obj){
if(obj.id=="bg_fill_options"){
format_new(getObj("bg_fill_div"));
}else{
if(obj.id=="text_color_options"){
format_new(getObj("text_color_div"));
}
}
}
var colordiv="";
function showColorDialog(obj){
if(colordiv.length==0){
colordiv=getObj("color_div").innerHTML;
colordiv=colordiv.replace("onsubmit=\"\"","onsubmit=\"return Set(this.ColorHex.value);\"");
getObj("color_div").innerHTML="";
}
if(obj.id=="bg_fill"){
COLOR_DIV_ID="bg_fill_div";
showDialog(colordiv,"position=relative, srcElement=bg_fill_div, closeButton=no, closeOnBodyClick=yes");
}else{
if(obj.id=="text_color"){
COLOR_DIV_ID="text_color_div";
showDialog(colordiv,"position=relative, srcElement=text_color_div, closeButton=no, closeOnBodyClick=yes");
}else{
if(obj.id=="format_foreColor"){
showDialog(colordiv,"position=relative, srcElement=format_foreColor, closeButton=no, closeOnBodyClick=yes");
}else{
if(obj.id=="format_backColor"){
showDialog(colordiv,"position=relative, srcElement=format_backColor, closeButton=no, closeOnBodyClick=yes");
}
}
}
}
currentCellPreview(obj);
}
function currentCellPreview(obj){
var _187a="";
var _187b=currCell;
if(currCell){
if(obj.id=="bg_fill"){
if(_187b.style["backgroundColor"]==null||_187b.style["backgroundColor"]==""||_187b.style["backgroundColor"]=="transparent"){
document.getElementById("ColorPreview").style["backgroundColor"]="rgb(255,255,255)";
}else{
document.getElementById("ColorPreview").style["backgroundColor"]=_187b.style["backgroundColor"];
}
}else{
if(obj.id=="text_color"){
if(_187b.style["color"]==null||_187b.style["color"]==""){
document.getElementById("ColorPreview").style["backgroundColor"]="rgb(0,0,0)";
}else{
if(_187b.style["color"]=="transparent"){
document.getElementById("ColorPreview").style["backgroundColor"]="rgb(255,255,255)";
}else{
document.getElementById("ColorPreview").style["backgroundColor"]=_187b.style["color"];
}
}
}
}
}
var _187c=document.getElementById("ColorPreview").style["backgroundColor"];
if(_187c.indexOf("#")==-1){
var colr=_187c.substring(_187c.indexOf("(")+1,_187c.indexOf(")"));
var _187e=colr.split(",");
_187a=d2h(_187e[0].trim());
_187a+=d2h(_187e[1].trim());
_187a+=d2h(_187e[2].trim());
document.getElementById("ColorHex").value="#"+_187a;
document.getElementById("ColorPreview").style.backgroundColor="#"+_187a;
}else{
document.getElementById("ColorHex").value=_187c;
document.getElementById("ColorPreview").style.backgroundColor=_187c;
}
}
function d2h(d){
var hD="0123456789ABCDEF";
var h=hD.substr(d&15,1);
while(d>15){
d>>=4;
h=hD.substr(d&15,1)+h;
}
if(h.length==1){
h="0"+h;
}
return h;
}
function init_format(cell){
if(jsGADGET_VIEW){
return;
}
var _1883="";
var _1884=cell;
if(!isPublished&&currCell){
_1883=currCell.className;
var _1885=$("#formatData");
if(TOOLBARS.FORMAT.is(":visible")){
if(_1883.indexOf("fwb")!=-1){
WIDGET.BOLD.metadata().appData.status="true";
_1885.zbutton("check","#bold");
}else{
WIDGET.BOLD.metadata().appData.status="false";
_1885.zbutton("uncheck","#bold");
}
if(_1883.indexOf("fsi")!=-1){
WIDGET.ITALIC.metadata().appData.status="true";
_1885.zbutton("check","#italic");
}else{
WIDGET.ITALIC.metadata().appData.status="false";
_1885.zbutton("uncheck","#italic");
}
if(_1883.indexOf("tdu")!=-1||_1883.indexOf("tdsu")!=-1){
WIDGET.UNDERLINE.metadata().appData.status="true";
_1885.zbutton("check","#underline");
}else{
WIDGET.UNDERLINE.metadata().appData.status="false";
_1885.zbutton("uncheck","#underline");
}
if(_1883.indexOf("tdst")!=-1||_1883.indexOf("tdsu")!=-1){
WIDGET.STRIKE.metadata().appData.status="true";
_1885.zbutton("check","#strike");
}else{
WIDGET.STRIKE.metadata().appData.status="false";
_1885.zbutton("uncheck","#strike");
}
if($(currCell).attr("format")=="PERCENT"){
WIDGET.PERCENT.metadata().appData.status="true";
$("#formatCellsNumber").zbutton("check","#PERCENT");
}else{
WIDGET.PERCENT.metadata().appData.status="false";
$("#formatCellsNumber").zbutton("uncheck","#PERCENT");
}
if(_1883.indexOf(" tac")!=-1){
WIDGET.WRAP.metadata().appData.status=true;
$("#formatCells").zbutton("check","#wraptext");
}else{
WIDGET.WRAP.metadata().appData.status=false;
$("#formatCells").zbutton("check","#wraptext");
}
checkFont($("#fontFace"),currCell);
checkFont($("#fontSize"),currCell);
if(isCellWrapped(_1884)){
WIDGET.WRAP.metadata().appData.status=true;
$("#formatCells").zbutton("check","#wraptext");
}else{
WIDGET.WRAP.metadata().appData.status=false;
$("#formatCells").zbutton("uncheck","#wraptext");
}
}
if($(currCell).attr("comment")!=null){
$("#addcomment").hide();
}
var attr=(currCell)?currCell.getAttribute("comment"):null;
var _1887=TOOLBARS.REVIEW.is(":visible");
if(attr==null){
GRID_DETAILS.CURRCELL_HAS_COMMENT=false;
if(_1887){
toggleElements(["editcomment","removecomment"],["addcomment"],false,"cellComment");
}
}else{
GRID_DETAILS.CURRCELL_HAS_COMMENT=true;
if(_1887){
toggleElements(["editcomment","removecomment"],["addcomment"],true,"cellComment");
}
}
}
}
function setTitleForFontFaceObj(_1888,_1889,_188a){
if(_1888!=null&&_1889!=null){
_1888.title=jsTitleMsg.Font+": "+_1889.options[_1889.selectedIndex].text;
_1889.title=_1888.title;
}
}
function setTitleForFontSizeObj(_188b,_188c){
if(_188b!=null&&_188c!=null){
_188b.title=jsTitleMsg.FontSize+": "+_188c.options[_188c.selectedIndex].text+"pt";
_188c.title=_188b.title;
}
}
function getDDIndex(obj,val){
var index=-1;
$(obj.selector).each(function(){
$("option",this).each(function(i){
if((this.value.toLowerCase()==val.toLowerCase())){
index=i;
}
});
});
if(index==-1){
check($(obj.selector),val);
index=$(obj.selector+" option").length-1;
}
return index;
}
function check(obj,val){
var _1893=$(obj.selector).children();
var _1894="";
var _1895=1;
var _1896=false;
if(obj.attr("id")=="fontSize"){
val=getOnlyNumber(val);
}
for(var i=0;i<=_1893.length;i++){
_1894=$(_1893[i]).text();
if(_1894==val){
_1895=i;
_1896=true;
break;
}
}
if(obj.attr("id")=="fontSize"){
$(obj.selector).zcombo("setSelectedIndex",_1895);
}
if(!_1896){
var opt=new Option(val,val,true,true);
opt.selected=true;
if(obj.attr("id")=="fontSize"){
$(opt).css("fontSize",val);
}else{
$(opt).css("fontFamily",val);
}
$(obj).append(opt);
zscombo.sortComboOptions(obj.attr("id"));
$(obj).zcombo("refresh");
}
}
function checkFont(obj,_189a){
var _189b=_189a.className;
var _189c=false;
var _189d;
var _189e=[" f8"," f9"," f10"," f11"," f12"," f14"," f16"," f18"," f20"," f24"," f22"," f26"];
switch(obj.attr("id")){
case "fontSize":
var regex=new RegExp(getCSSStyleRegex("fontSize")).exec(_189b);
if(regex!=null){
_189d=regex[0];
}
var _18a0=$(obj).children();
if(!isUndefined(_189d)){
var _18a1;
for(var i=0,len=_189e.length;i<len;i++){
if(getOnlyNumber(_189d)==$(_18a0[i]).text()){
$(obj.selector).zcombo("setSelectedIndex",i);
break;
}
}
}else{
if(_189a.style["fontSize"]==null||_189a.style["fontSize"]==""){
$(obj.selector).zcombo("setValue",defultFontSize);
}else{
check(obj,_189a.style["fontSize"]);
}
}
break;
case "fontFace":
var regex=new RegExp(getCSSStyleRegex("fontFamily")).exec(_189b);
if(regex!=null){
_189d=regex[0];
}
if(_189d){
obj.zcombo("setSelectedIndex",getDDIndex(obj,UI.CSSClassFontNamesMap[_189d.Ltrim()]));
}else{
if(_189a.style["fontFamily"]==null||_189a.style["fontFamily"]==""){
$(obj.selector).zcombo("setSelectedIndex",getDDIndex(obj,defultFontName));
}else{
if(getDDIndex(obj,_189a.style["fontFamily"])!=-1){
$(obj.selector).zcombo("setSelectedIndex",getDDIndex(obj,_189a.style["fontFamily"]));
}else{
check(obj,_189a.style["fontFamily"]);
}
}
}
break;
}
}
function h2d(colr){
if(colr.indexOf("#")!=-1){
var red=parseInt(colr.substring(1,3),16);
var grn=parseInt(colr.substring(3,5),16);
var blu=parseInt(colr.substring(5,7),16);
return "rgb("+red+","+grn+","+blu+")";
}else{
return colr;
}
}
function wraptext(id,sR,sC,eR,eC,_18ad,_18ae){
var obj=$("#"+id);
if(typeof _18ad=="undefined"){
_18ad="false";
}
if(typeof sR=="undefined"){
fillCellRange();
}else{
startR=sR;
startC=sC;
endR=eR;
endC=eC;
}
var wrap;
if($("#wraptext").metadata().appData.status){
wrap=0;
}else{
wrap=1;
}
applyWrap(startR,startC,endR,endC,wrap,_18ad);
}
function applyWrap(_18b1,_18b2,endR,endC,wrap,_18b6){
setWrapPropertyForCellRange(_18b1,endR,_18b2,endC,wrap);
var _18b7=_18b1;
var _18b8=_18b2;
var _18b9=endR;
var _18ba=endC;
if(_18b1==endR&&_18b2==endC){
var info=ActiveCellInfo;
var sRow=info.getStartRow();
var sCol=info.getStartCol();
var eRow=info.getEndRow();
var eCol=info.getEndCol();
if(sRow==_18b1&&sCol==_18b2){
_18b7=sRow;
_18b8=sCol;
_18b9=eRow;
_18ba=eCol;
}
}
var _18c0=getAvailableStartRow();
var _18c1=getAvailableEndRow();
document.cellform.actionMode.value="Format";
document.cellform.startColumn.value=_18b8;
document.cellform.endColumn.value=_18ba;
document.cellform.startRow.value=_18b7;
document.cellform.endRow.value=_18b9;
document.cellform.formattedCellValue.value="IsTextWrapped";
document.cellform.textAreaValue.value=wrap;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_18b6;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_18c0;
document.cellform.availableEndRow.value=_18c1;
if(_18b6=="false"){
document.cellform.isColSelected.value=isColSelected();
}else{
if(_18b1==0&&endR==65535){
document.cellform.isColSelected.value=true;
}else{
document.cellform.isColSelected.value=false;
}
}
document.cellform.totCols.value=totCols;
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _18c2=getObj("apiKey");
if(_18c2!=null){
document.cellform.apiKeyId.value=_18c2.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,formatCell,true);
}
function setWrapPropertyForCellRange(_18c3,_18c4,_18c5,_18c6,wrap){
var _18c8=Row.getAvailableRowsInRange(_18c3,_18c4);
for(var i=0,len=_18c8.length;i<len;i++){
rowIndex=_18c8[i];
for(var _18cb=_18c5;_18cb<=_18c6;_18cb++){
var _18cc=getCell(rowIndex,_18cb);
setWrapPropertyForCellRange1(_18cc,wrap);
if(ISFREEZED){
if(FREEZED_ROW>0){
_18cc=getCell(rowIndex,_18cb,sheetPane2Id);
setWrapPropertyForCellRange1(_18cc,wrap);
}
if(FREEZED_COL>0){
_18cc=getCell(rowIndex,_18cb,sheetPane3Id);
setWrapPropertyForCellRange1(_18cc,wrap);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_18cc=getCell(rowIndex,_18cb,sheetPane1Id);
setWrapPropertyForCellRange1(_18cc,wrap);
}
}
}
}
}
function setWrapPropertyForCellRange1(_18cd,wrap){
if(_18cd!=null&&_18cd!="null"){
if(wrap==1){
if(!isCellWrapped(_18cd)){
wrapCell(_18cd);
}
}else{
if(isCellWrapped(_18cd)){
unWrapCell(_18cd);
}
}
}
}
function resetTableLayOut(){
}
function setTableLayOut(){
if(sheetTable!=null){
sheetTable.style.tableLayout="fixed";
}else{
if(sheetTable1!=null){
sheetTable1.style.tableLayout="fixed";
}
if(sheetTable2!=null){
sheetTable2.style.tableLayout="fixed";
}
if(sheetTable3!=null){
sheetTable3.style.tableLayout="fixed";
}
if(sheetTable4!=null){
sheetTable4.style.tableLayout="fixed";
}
}
}
function setWidthThroughJson(_18cf){
if(isStr(_18cf)&&_18cf!=""){
var _18d0=eval("("+_18cf+")");
updateWidthJson(_18d0);
}
}
function updateWidthJson(_18d1){
for(var x in _18d1){
if(typeof _18d1[x]!="undefined"){
if(typeof _18d1[x].sc!="undefined"){
setSheetColumnsWidth(_18d1[x].sc,_18d1[x].ec,parseInt(_18d1[x].v));
}
}
}
if(!isCellFieldSPANHided()){
resetCellFieldPosition();
setCellFieldSPANWidth(getColWidth(currCol));
}
}
function getActualWidthHeight(val,which){
var dpi=100;
if(which=="Column"){
dpi=90;
}
var _18d6=parseFloat(val)/dpi;
var inmm=_18d6*25.4;
var _18d8=inmm*100;
_18d8=Math.round(_18d8);
return _18d8;
}
function clearBorder(_18d9,_18da,_18db,_18dc){
if(typeof _18d9=="undefined"||typeof _18db=="undefined"||typeof _18da=="undefined"||typeof _18dc=="undefined"){
fillCellRange();
}else{
startR=_18d9;
endR=_18db;
startC=_18da;
endC=_18dc;
}
clearBorder1();
if(ISFREEZED){
if(FREEZED_ROW>0){
clearBorder1(sheetPane2Id);
}
if(FREEZED_COL>0){
clearBorder1(sheetPane3Id);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
clearBorder1(sheetPane1Id);
}
}
}
function clearBorder1(_18dd){
if(isUndefined(_18dd)){
_18dd=sheetPaneId;
}
var _18de;
var _18df;
var _18e0;
var range=new Range(startR,startC,endR,endC);
var iter=range.getIterator();
iter.addEventListener("onRowBefore",function(row,col,_18e5,_18e6,endC){
var _18e8=getCell(row,_18e6-1,_18e5);
var _18e9=getCell(row,endC+1,_18e5);
if(_18e8){
if(!is_ie){
_18e8.style["borderRight"]="";
}else{
_18e8.style["borderRightColor"]="";
_18e8.style["borderRightWidth"]="";
_18e8.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_18e8);
}
if(_18e9){
if(!is_ie){
_18e9.style["borderLeft"]="";
}else{
_18e9.style["borderLeftColor"]="";
_18e9.style["borderLeftWidth"]="";
_18e9.style["borderLeftStyle"]="";
}
}
},_18dd,startC,endC);
iter.iterate(function(_18ea,_18eb,_18ec){
_18de=getCell(_18ea,_18eb,_18dd);
if(_18de!=null&&_18de!="null"){
if(!is_ie){
_18de.style["borderLeft"]="";
_18de.style["borderRight"]="";
_18de.style["borderTop"]="";
_18de.style["borderBottom"]="";
}else{
_18de.style["borderLeftColor"]="";
_18de.style["borderRightColor"]="";
_18de.style["borderTopColor"]="";
_18de.style["borderBottomColor"]="";
_18de.style["borderLeftWidth"]="";
_18de.style["borderRightWidth"]="";
_18de.style["borderTopWidth"]="";
_18de.style["borderBottomWidth"]="";
_18de.style["borderLeftStyle"]="";
_18de.style["borderRightStyle"]="";
_18de.style["borderTopStyle"]="";
_18de.style["borderBottomStyle"]="";
}
removeCSSStyle("borderRight",_18de);
removeCSSStyle("borderBottom",_18de);
}
_18df=getCell(startR-1,_18eb,_18dd);
_18e0=getCell(endR+1,_18eb,_18dd);
if(_18df!=null&&_18df!="null"){
if(!is_ie){
_18df.style["borderBottom"]="";
}else{
_18df.style["borderBottomColor"]="";
_18df.style["borderBottomWidth"]="";
_18df.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_18df);
}
if(_18e0!=null&&_18e0!="null"){
if(!is_ie){
_18e0.style["borderTop"]="";
}else{
_18e0.style["borderTopColor"]="";
_18e0.style["borderTopWidth"]="";
_18e0.style["borderTopStyle"]="";
}
}
},_18dd);
}
function drawBorder(_18ed,_18ee){
var obj=$(_18ed);
if(obj.attr("id")!="borderBtn"){
$("#borderBtn").children("span:first").removeAttr("class");
$("#borderBtn").children("span:first").addClass(obj.children("span:first").children("span:first").attr("class"));
}
$("#menuitem_borderBtn").children("span:first").children("span:first").attr("class",obj.children("span:first").children("span:first").attr("class"));
if(obj.attr("id")!="borderBtn"){
$("#borderBtn").attr("bt",obj.attr("bt"));
}
if(isUndefined(_18ee)){
_18ee=$("#borderBtn").attr("bt");
}
setBorder(_18ee);
}
function setBorder(_18f0,_18f1,_18f2,sR,sC,eR,eC,_18f7){
if(typeof _18f7=="undefined"){
_18f7="false";
}
if(typeof sR=="undefined"){
fillCellRange();
}else{
startR=sR;
startC=sC;
endR=eR;
endC=eC;
}
var _18f8=startR;
var _18f9=startC;
var _18fa=endR;
var _18fb=endC;
if(startR==endR&&startC==endC){
var info=ActiveCellInfo;
var sRow=info.getStartRow();
var sCol=info.getStartCol();
var eRow=info.getEndRow();
var eCol=info.getEndCol();
if(sRow==startR&&sCol==startC){
_18f8=sRow;
_18f9=sCol;
_18fa=eRow;
_18fb=eCol;
}
}
applyBorder(_18f0,_18f1,_18f2,_18f8,_18f9,_18fa,_18fb);
closeDialog();
var _1901=getAvailableStartRow();
var _1902=getAvailableEndRow();
document.cellform.actionMode.value="Border";
document.cellform.startColumn.value=_18f9;
document.cellform.endColumn.value=_18fb;
document.cellform.startRow.value=_18f8;
document.cellform.endRow.value=_18fa;
document.cellform.formattedCellValue.value=_18f0;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_18f7;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_1901;
document.cellform.availableEndRow.value=_1902;
if(_18f7=="false"){
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
}else{
if(startR==0&&endR==65535){
document.cellform.isColSelected.value=true;
}else{
document.cellform.isColSelected.value=false;
}
if(startC==0&&endC==255){
document.cellform.isRowSelected.value=true;
}else{
document.cellform.isRowSelected.value=false;
}
}
document.cellform.totCols.value=totCols;
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _1903=getObj("apiKey");
if(_1903!=null){
document.cellform.apiKeyId.value=_1903.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,formatCell,true);
return false;
}
function applyBorder(_1904,_1905,_1906,sR,sC,eR,eC){
if(typeof _1905=="undefined"||_1905==""){
_1905="1px solid";
}
if(typeof _1906=="undefined"||_1906==""){
_1906="#000";
}
var _190b=getViewPortRoundedDetails(sR,eR);
if(_190b.isInViewPort){
setBorder1(_1904,_1905,_1906,_190b.startRowIdx,sC,_190b.endRowIdx,eC);
if(FREEZED_COL>0){
setBorder1(_1904,_1905,_1906,_190b.startRowIdx,sC,_190b.endRowIdx,eC,sheetPane3Id);
}
}
if(_190b.isInFreezedRange){
if(_1904==17||_1904==26||_1904==29){
if(eR<FREEZED_ROW){
if(FREEZED_ROW>0){
setBorder1(_1904,_1905,_1906,_190b.freezedStartRowIdx,sC,_190b.freezedEndRowIdx,eC,sheetPane2Id);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
setBorder1(_1904,_1905,_1906,_190b.freezedStartRowIdx,sC,_190b.freezedEndRowIdx,eC,sheetPane1Id);
}
}
}else{
if(_1904==18||_1904==27||_1904==28||_1904==19){
var _190c=_190b.freezedEndRowIdx;
if(eR>=FREEZED_ROW){
_190c=FREEZED_ROW;
}
if(FREEZED_ROW>0){
setBorder1(_1904,_1905,_1906,_190b.freezedStartRowIdx,sC,_190c,eC,sheetPane2Id);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
setBorder1(_1904,_1905,_1906,_190b.freezedStartRowIdx,sC,_190c,eC,sheetPane1Id);
}
}else{
if(FREEZED_ROW>0){
setBorder1(_1904,_1905,_1906,_190b.freezedStartRowIdx,sC,_190b.freezedEndRowIdx,eC,sheetPane2Id);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
setBorder1(_1904,_1905,_1906,_190b.freezedStartRowIdx,sC,_190b.freezedEndRowIdx,eC,sheetPane1Id);
}
setBorder1(_1904,_1905,_1906,_190b.freezedStartRowIdx,sC,_190b.freezedEndRowIdx,eC);
}
}
}
}
function setBorder1(_190d,_190e,_190f,_1910,_1911,_1912,_1913,_1914){
if(isUndefined(_1914)){
_1914=sheetPaneId;
}
var _1915="1px solid #000";
var _1916="3px double #000";
var _1917="2px solid #000";
var _1918=_190e+" "+_190f;
var _1919="1px solid #E4E3C9";
var _191a="0px solid #FFF";
var _191b;
var _191c;
var _191d;
var _191e;
var _191f;
var _1920;
var _1921="";
var _1922="";
if(_190d==ActionConstants.BORDER_NONE){
var _1923=Row.findNextNonHiddenRow(_1910,false);
var _1924=Row.findNextNonHiddenRow(_1912,true);
for(var _1925=_1910;_1925<=_1912;_1925++){
_191c=getCell(_1925,_1911-1,_1914);
_191d=getCell(_1925,_1913+1,_1914);
if(_191c!=null&&_191c!="null"){
if(!is_ie){
_191c.style["borderRight"]="";
}else{
_191c.style["borderRightColor"]="";
_191c.style["borderRightWidth"]="";
_191c.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_191c);
}
if(_191d!=null&&_191d!="null"){
if(!is_ie){
_191d.style["borderLeft"]="";
}else{
_191d.style["borderLeftColor"]="";
_191d.style["borderLeftWidth"]="";
_191d.style["borderLeftStyle"]="";
}
}
for(var _1926=_1911;_1926<=_1913;_1926++){
_191b=getCell(_1925,_1926,_1914);
if(_191b!=null&&_191b!="null"){
if(!is_ie){
_191b.style["borderLeft"]="";
_191b.style["borderRight"]="";
_191b.style["borderTop"]="";
_191b.style["borderBottom"]="";
}else{
_191b.style["borderLeftColor"]="";
_191b.style["borderRightColor"]="";
_191b.style["borderTopColor"]="";
_191b.style["borderBottomColor"]="";
_191b.style["borderLeftWidth"]="";
_191b.style["borderRightWidth"]="";
_191b.style["borderTopWidth"]="";
_191b.style["borderBottomWidth"]="";
_191b.style["borderLeftStyle"]="";
_191b.style["borderRightStyle"]="";
_191b.style["borderTopStyle"]="";
_191b.style["borderBottomStyle"]="";
}
removeCSSStyle("borderRight",_191b);
removeCSSStyle("borderBottom",_191b);
}
_191e=getCell(_1923,_1926,_1914);
_191f=getCell(_1924,_1926,_1914);
if(_191e!=null&&_191e!="null"){
if(!is_ie){
_191e.style["borderBottom"]="";
}else{
_191e.style["borderBottomColor"]="";
_191e.style["borderBottomWidth"]="";
_191e.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191e);
}
if(_191f!=null&&_191f!="null"){
if(!is_ie){
_191f.style["borderTop"]="";
}else{
_191f.style["borderTopColor"]="";
_191f.style["borderTopWidth"]="";
_191f.style["borderTopStyle"]="";
}
}
}
}
}else{
if(_190d==ActionConstants.BORDER_LEFT){
for(var i=_1910;i<=_1912;i++){
_191c=getCell(i,_1911-1,_1914);
if(_191c!=null&&_191c!="null"){
if(!is_ie){
_191c.style["borderRight"]="";
}else{
_191c.style["borderRightColor"]="";
_191c.style["borderRightWidth"]="";
_191c.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_191c);
if(_1918==_1915){
if(_191c.className.indexOf(" br1")==-1){
_191c.className+=" br1";
}
}else{
_191c.style["borderRight"]=_1918;
}
}
}
}else{
if(_190d==ActionConstants.BORDER_RIGHT){
for(var i=_1910;i<=_1912;i++){
_191b=getCell(i,_1913,_1914);
if(_191b!=null&&_191b!="null"){
if(!is_ie){
_191b.style["borderRight"]="";
}else{
_191b.style["borderRightColor"]="";
_191b.style["borderRightWidth"]="";
_191b.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_191b);
if(_1918==_1915){
if(_191b.className.indexOf(" br1")==-1){
_191b.className+=" br1";
}
}else{
_191b.style["borderRight"]=_1918;
}
}
}
}else{
if(_190d==ActionConstants.BORDER_LEFT_RIGHT){
for(var i=_1910;i<=_1912;i++){
_1920=getCell(i,_1913,_1914);
_191c=getCell(i,_1911-1,_1914);
if(_1920!=null&&_1920!="null"){
if(!is_ie){
_1920.style["borderRight"]="";
}else{
_1920.style["borderRightColor"]="";
_1920.style["borderRightWidth"]="";
_1920.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_1920);
if(_1918==_1915){
if(_1920.className.indexOf(" br1")==-1){
_1920.className+=" br1";
}
}else{
_1920.style["borderRight"]=_1918;
}
}
if(_191c!=null&&_191c!="null"){
if(!is_ie){
_191c.style["borderRight"]="";
}else{
_191c.style["borderRightColor"]="";
_191c.style["borderRightWidth"]="";
_191c.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_191c);
if(_1918==_1915){
if(_191c.className.indexOf(" br1")==-1){
_191c.className+=" br1";
}
}else{
_191c.style["borderRight"]=_1918;
}
}
}
}else{
if(_190d==ActionConstants.BORDER_TOP){
var _1923=Row.findNextNonHiddenRow(_1910,false);
for(var i=_1911;i<=_1913;i++){
_191e=getCell(_1923,i,_1914);
if(_191e!=null&&_191e!="null"){
if(!is_ie){
_191e.style["borderBottom"]="";
}else{
_191e.style["borderBottomColor"]="";
_191e.style["borderBottomWidth"]="";
_191e.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191e);
if(_1918==_1915){
if(_191e.className.indexOf(" bb1")==-1){
_191e.className+=" bb1";
}
}else{
_191e.style["borderBottom"]=_1918;
}
}
}
}else{
if(_190d==ActionConstants.BORDER_BOTTOM){
for(var i=_1911;i<=_1913;i++){
_191b=getCell(_1912,i,_1914);
if(_191b!=null&&_191b!="null"){
if(!is_ie){
_191b.style["borderBottom"]="";
}else{
_191b.style["borderBottomColor"]="";
_191b.style["borderBottomWidth"]="";
_191b.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191b);
if(_1918==_1915){
if(_191b.className.indexOf(" bb1")==-1){
_191b.className+=" bb1";
}
}else{
_191b.style["borderBottom"]=_1918;
}
}
}
}else{
if(_190d==ActionConstants.BORDER_TOP_BOTTOM){
var _1923=Row.findNextNonHiddenRow(_1910,false);
for(var i=_1911;i<=_1913;i++){
_1920=getCell(_1912,i,_1914);
_191e=getCell(_1923,i,_1914);
if(_1920!=null&&_1920!="null"){
if(!is_ie){
_1920.style["borderBottom"]="";
}else{
_1920.style["borderBottomColor"]="";
_1920.style["borderBottomWidth"]="";
_1920.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_1920);
if(_1918==_1915){
if(_1920.className.indexOf(" bb1")==-1){
_1920.className+=" bb1";
}
}else{
_1920.style["borderBottom"]=_1918;
}
}
if(_191e!=null&&_191e!="null"){
if(!is_ie){
_191e.style["borderBottom"]="";
}else{
_191e.style["borderBottomColor"]="";
_191e.style["borderBottomWidth"]="";
_191e.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191e);
if(_1918==_1915){
if(_191e.className.indexOf(" bb1")==-1){
_191e.className+=" bb1";
}
}else{
_191e.style["borderBottom"]=_1918;
}
}
}
}else{
if(_190d==ActionConstants.BORDER_OUTSIDE){
var _1923=Row.findNextNonHiddenRow(_1910,false);
for(var i=_1910;i<=_1912;i++){
_1920=getCell(i,_1913,_1914);
_191c=getCell(i,_1911-1,_1914);
if(_1920!=null&&_1920!="null"){
if(!is_ie){
_1920.style["borderRight"]="";
}else{
_1920.style["borderRightColor"]="";
_1920.style["borderRightWidth"]="";
_1920.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_1920);
if(_1918==_1915){
if(_1920.className.indexOf(" br1")==-1){
_1920.className+=" br1";
}
}else{
_1920.style["borderRight"]=_1918;
}
}
if(_191c!=null&&_191c!="null"){
if(!is_ie){
_191c.style["borderRight"]="";
}else{
_191c.style["borderRightColor"]="";
_191c.style["borderRightWidth"]="";
_191c.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_191c);
if(_1918==_1915){
if(_191c.className.indexOf(" br1")==-1){
_191c.className+=" br1";
}
}else{
_191c.style["borderRight"]=_1918;
}
}
for(var j=_1911;j<=_1913;j++){
_1920=getCell(_1912,j,_1914);
_191e=getCell(_1923,j,_1914);
if(_1920!=null&&_1920!="null"){
if(!is_ie){
_1920.style["borderBottom"]="";
}else{
_1920.style["borderBottomColor"]="";
_1920.style["borderBottomWidth"]="";
_1920.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_1920);
if(_1918==_1915){
if(_1920.className.indexOf(" bb1")==-1){
_1920.className+=" bb1";
}
}else{
_1920.style["borderBottom"]=_1918;
}
}
if(_191e!=null&&_191e!="null"){
if(!is_ie){
_191e.style["borderBottom"]="";
}else{
_191e.style["borderBottomColor"]="";
_191e.style["borderBottomWidth"]="";
_191e.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191e);
if(_1918==_1915){
if(_191e.className.indexOf(" bb1")==-1){
_191e.className+=" bb1";
}
}else{
_191e.style["borderBottom"]=_1918;
}
}
}
}
}else{
if(_190d==ActionConstants.BORDER_VERTICAL){
for(var i=_1910;i<=_1912;i++){
_191c=getCell(i,_1911-1,_1914);
if(_191c!=null&&_191c!="null"){
if(!is_ie){
_191c.style["borderRight"]="";
}else{
_191c.style["borderRightColor"]="";
_191c.style["borderRightWidth"]="";
_191c.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_191c);
if(_1918==_1915){
if(_191c.className.indexOf(" br1")==-1){
_191c.className+=" br1";
}
}else{
_191c.style["borderRight"]=_1918;
}
}
for(var j=_1911;j<=_1913;j++){
_191b=getCell(i,j,_1914);
if(_191b!=null&&_191b!="null"){
if(!is_ie){
_191b.style["borderRight"]="";
}else{
_191b.style["borderRightColor"]="";
_191b.style["borderRightWidth"]="";
_191b.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_191b);
if(_1918==_1915){
if(_191b.className.indexOf(" br1")==-1){
_191b.className+=" br1";
}
}else{
_191b.style["borderRight"]=_1918;
}
}
}
}
}else{
if(_190d==ActionConstants.BORDER_VERTICAL_OUTSIDE){
var _1923=Row.findNextNonHiddenRow(_1910,false);
for(var i=_1910;i<=_1912;i++){
for(var j=_1911;j<=_1913;j++){
_191c=getCell(i,j-1,_1914);
if(_191c!=null&&_191c!="null"){
if(!is_ie){
_191c.style["borderRight"]="";
}else{
_191c.style["borderRightColor"]="";
_191c.style["borderRightWidth"]="";
_191c.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_191c);
if(_1918==_1915){
if(_191c.className.indexOf(" br1")==-1){
_191c.className+=" br1";
}
}else{
_191c.style["borderRight"]=_1918;
}
}
if(j==_1913){
_191b=getCell(i,j,_1914);
if(_191b!=null&&_191b!="null"){
if(!is_ie){
_191b.style["borderRight"]="";
}else{
_191b.style["borderRightColor"]="";
_191b.style["borderRightWidth"]="";
_191b.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_191b);
if(_1918==_1915){
if(_191b.className.indexOf(" br1")==-1){
_191b.className+=" br1";
}
}else{
_191b.style["borderRight"]=_1918;
}
}
}
if(i==_1910){
_191e=getCell(_1923,j,_1914);
if(_191e!=null&&_191e!="null"){
if(!is_ie){
_191e.style["borderBottom"]="";
}else{
_191e.style["borderBottomColor"]="";
_191e.style["borderBottomWidth"]="";
_191e.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191e);
if(_1918==_1915){
if(_191e.className.indexOf(" bb1")==-1){
_191e.className+=" bb1";
}
}else{
_191e.style["borderBottom"]=_1918;
}
}
}
if(i==_1912){
_1920=getCell(i,j,_1914);
if(_1920!=null&&_1920!="null"){
if(!is_ie){
_1920.style["borderBottom"]="";
}else{
_1920.style["borderBottomColor"]="";
_1920.style["borderBottomWidth"]="";
_1920.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_1920);
if(_1918==_1915){
if(_1920.className.indexOf(" bb1")==-1){
_1920.className+=" bb1";
}
}else{
_1920.style["borderBottom"]=_1918;
}
}
}
}
}
}else{
if(_190d==ActionConstants.BORDER_HORIZONTAL){
var _1923=Row.findNextNonHiddenRow(_1910,false);
for(var i=_1910;i<=_1912;i++){
for(var j=_1911;j<=_1913;j++){
_191b=getCell(i,j,_1914);
if(_191b!=null&&_191b!="null"){
if(!is_ie){
_191b.style["borderBottom"]="";
}else{
_191b.style["borderBottomColor"]="";
_191b.style["borderBottomWidth"]="";
_191b.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191b);
if(_1918==_1915){
if(_191b.className.indexOf(" bb1")==-1){
_191b.className+=" bb1";
}
}else{
_191b.style["borderBottom"]=_1918;
}
}
if(i==_1910){
_191e=getCell(_1923,j,_1914);
if(_191e!=null&&_191e!="null"){
if(!is_ie){
_191e.style["borderBottom"]="";
}else{
_191e.style["borderBottomColor"]="";
_191e.style["borderBottomWidth"]="";
_191e.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191e);
if(_1918==_1915){
if(_191e.className.indexOf(" bb1")==-1){
_191e.className+=" bb1";
}
}else{
_191e.style["borderBottom"]=_1918;
}
}
}
}
}
}else{
if(_190d==ActionConstants.BORDER_HORIZONTAL_OUTSIDE){
for(var i=_1910;i<=_1912;i++){
var _1923=Row.findNextNonHiddenRow(i,false);
for(var j=_1911;j<=_1913;j++){
_191e=getCell(_1923,j,_1914);
if(_191e!=null&&_191e!="null"){
if(!is_ie){
_191e.style["borderBottom"]="";
}else{
_191e.style["borderBottomColor"]="";
_191e.style["borderBottomWidth"]="";
_191e.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191e);
if(_1918==_1915){
if(_191e.className.indexOf(" bb1")==-1){
_191e.className+=" bb1";
}
}else{
_191e.style["borderBottom"]=_1918;
}
}
if(i==_1912){
_1920=getCell(i,j,_1914);
if(_1920!=null&&_1920!="null"){
if(!is_ie){
_1920.style["borderBottom"]="";
}else{
_1920.style["borderBottomColor"]="";
_1920.style["borderBottomWidth"]="";
_1920.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_1920);
if(_1918==_1915){
if(_1920.className.indexOf(" bb1")==-1){
_1920.className+=" bb1";
}
}else{
_1920.style["borderBottom"]=_1918;
}
}
}
if(j==_1913){
_191b=getCell(i,j,_1914);
if(_191b!=null&&_191b!="null"){
if(!is_ie){
_191b.style["borderRight"]="";
}else{
_191b.style["borderRightColor"]="";
_191b.style["borderRightWidth"]="";
_191b.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_191b);
if(_1918==_1915){
if(_191b.className.indexOf(" br1")==-1){
_191b.className+=" br1";
}
}else{
_191b.style["borderRight"]=_1918;
}
}
}
if(j==_1911){
_191c=getCell(i,j-1,_1914);
if(_191c!=null&&_191c!="null"){
if(!is_ie){
_191c.style["borderRight"]="";
}else{
_191c.style["borderRightColor"]="";
_191c.style["borderRightWidth"]="";
_191c.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_191c);
if(_1918==_1915){
if(_191c.className.indexOf(" br1")==-1){
_191c.className+=" br1";
}
}else{
_191c.style["borderRight"]=_1918;
}
}
}
}
}
}else{
if(_190d==ActionConstants.BORDER_INSIDE){
for(var i=_1910;i<=_1912;i++){
for(var j=_1911;j<=_1913;j++){
if(i!=_1912){
_191b=getCell(i,j,_1914);
if(_191b!=null&&_191b!="null"){
if(!is_ie){
_191b.style["borderBottom"]="";
}else{
_191b.style["borderBottomColor"]="";
_191b.style["borderBottomWidth"]="";
_191b.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191b);
if(_1918==_1915){
if(_191b.className.indexOf(" bb1")==-1){
_191b.className+=" bb1";
}
}else{
_191b.style["borderBottom"]=_1918;
}
}
}
if(j!=_1913){
_191b=getCell(i,j,_1914);
if(_191b!=null&&_191b!="null"){
if(!is_ie){
_191b.style["borderRight"]="";
}else{
_191b.style["borderRightColor"]="";
_191b.style["borderRightWidth"]="";
_191b.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_191b);
if(_1918==_1915){
if(_191b.className.indexOf(" br1")==-1){
_191b.className+=" br1";
}
}else{
_191b.style["borderRight"]=_1918;
}
}
}
}
}
}else{
if(_190d==ActionConstants.BORDER_ALL){
for(var i=_1910;i<=_1912;i++){
var _1923=Row.findNextNonHiddenRow(i,false);
for(var j=_1911;j<=_1913;j++){
_191e=getCell(_1923,j,_1914);
if(_191e!=null&&_191e!="null"){
if(!is_ie){
_191e.style["borderBottom"]="";
}else{
_191e.style["borderBottomColor"]="";
_191e.style["borderBottomWidth"]="";
_191e.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191e);
if(_1918==_1915){
if(_191e.className.indexOf(" bb1")==-1){
_191e.className+=" bb1";
}
}else{
_191e.style["borderBottom"]=_1918;
}
}
_191c=getCell(i,j-1,_1914);
if(_191c!=null&&_191c!="null"){
if(!is_ie){
_191c.style["borderRight"]="";
}else{
_191c.style["borderRightColor"]="";
_191c.style["borderRightWidth"]="";
_191c.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_191c);
if(_1918==_1915){
if(_191c.className.indexOf(" br1")==-1){
_191c.className+=" br1";
}
}else{
_191c.style["borderRight"]=_1918;
}
}
if(i==_1912){
_1920=getCell(i,j,_1914);
if(_1920!=null&&_1920!="null"){
if(!is_ie){
_1920.style["borderBottom"]="";
}else{
_1920.style["borderBottomColor"]="";
_1920.style["borderBottomWidth"]="";
_1920.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_1920);
if(_1918==_1915){
if(_1920.className.indexOf(" bb1")==-1){
_1920.className+=" bb1";
}
}else{
_1920.style["borderBottom"]=_1918;
}
}
}
if(j==_1913){
_1920=getCell(i,j,_1914);
if(_1920!=null&&_1920!="null"){
if(!is_ie){
_1920.style["borderRight"]="";
}else{
_1920.style["borderRightColor"]="";
_1920.style["borderRightWidth"]="";
_1920.style["borderRightStyle"]="";
}
removeCSSStyle("borderRight",_1920);
if(_1918==_1915){
if(_1920.className.indexOf(" br1")==-1){
_1920.className+=" br1";
}
}else{
_1920.style["borderRight"]=_1918;
}
}
}
}
}
}else{
if(_190d==ActionConstants.BORDER_BOTTOM_DOUBLE){
for(var i=_1911;i<=_1913;i++){
_191b=getCell(_1912,i,_1914);
if(_191b!=null&&_191b!="null"){
if(!is_ie){
_191b.style["borderBottom"]="";
}else{
_191b.style["borderBottomColor"]="";
_191b.style["borderBottomWidth"]="";
_191b.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191b);
if(_191b.className.indexOf(" bbd")==-1){
_191b.className+=" bbd";
}
}
}
}else{
if(_190d==ActionConstants.BORDER_TOP_BOTTOM_DOUBLE){
var _1923=Row.findNextNonHiddenRow(_1910,false);
for(var i=_1911;i<=_1913;i++){
_1920=getCell(_1912,i,_1914);
_191e=getCell(_1923,i,_1914);
if(_1920!=null&&_1920!="null"){
if(!is_ie){
_1920.style["borderBottom"]="";
}else{
_1920.style["borderBottomColor"]="";
_1920.style["borderBottomWidth"]="";
_1920.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_1920);
if(_1920.className.indexOf(" bbd")==-1){
_1920.className+=" bbd";
}
}
if(_191e!=null&&_191e!="null"){
if(!is_ie){
_191e.style["borderBottom"]="";
}else{
_191e.style["borderBottomColor"]="";
_191e.style["borderBottomWidth"]="";
_191e.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191e);
if(_1918==_1915){
if(_191e.className.indexOf(" bb1")==-1){
_191e.className+=" bb1";
}
}else{
_191e.style["borderBottom"]=_1918;
}
}
}
}else{
if(_190d==ActionConstants.BORDER_TOP_BOTTOM_THICK){
var _1923=Row.findNextNonHiddenRow(_1910,false);
for(var i=_1911;i<=_1913;i++){
_1920=getCell(_1912,i,_1914);
_191e=getCell(_1923,i,_1914);
if(_1920!=null&&_1920!="null"){
if(!is_ie){
_1920.style["borderBottom"]="";
}else{
_1920.style["borderBottomColor"]="";
_1920.style["borderBottomWidth"]="";
_1920.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_1920);
if(_1920.className.indexOf(" bb2")==-1){
_1920.className+=" bb2";
}
}
if(_191e!=null&&_191e!="null"){
if(!is_ie){
_191e.style["borderBottom"]="";
}else{
_191e.style["borderBottomColor"]="";
_191e.style["borderBottomWidth"]="";
_191e.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191e);
if(_1918==_1915){
if(_191e.className.indexOf(" bb1")==-1){
_191e.className+=" bb1";
}
}else{
_191e.style["borderBottom"]=_1918;
}
}
}
}else{
if(_190d==ActionConstants.BORDER_BOTTOM_THICK){
for(var i=_1911;i<=_1913;i++){
_191b=getCell(_1912,i,_1914);
if(_191b!=null&&_191b!="null"){
if(!is_ie){
_191b.style["borderBottom"]="";
}else{
_191b.style["borderBottomColor"]="";
_191b.style["borderBottomWidth"]="";
_191b.style["borderBottomStyle"]="";
}
removeCSSStyle("borderBottom",_191b);
if(_191b.className.indexOf(" bb2")==-1){
_191b.className+=" bb2";
}
}
}
}else{
if(_190d==ActionConstants.BORDER_ALL_LEFT){
setBorder1(ActionConstants.BORDER_VERTICAL,_190e,_190f,_1910,_1911,_1912,_1913-1,_1914);
}else{
if(_190d==ActionConstants.BORDER_ALL_RIGHT){
setBorder1(ActionConstants.BORDER_VERTICAL,_190e,_190f,_1910,_1911+1,_1912,_1913,_1914);
}else{
if(_190d==ActionConstants.BORDER_ALL_TOP){
setBorder1(ActionConstants.BORDER_HORIZONTAL,_190e,_190f,_1910,_1911,_1912-1,_1913,_1914);
}else{
if(_190d==ActionConstants.BORDER_ALL_BOTTOM){
setBorder1(ActionConstants.BORDER_HORIZONTAL,_190e,_190f,_1910+1,_1911,_1912,_1913,_1914);
}else{
if(_190d==ActionConstants.BORDER_INSIDE_VERTICAL){
setBorder1(ActionConstants.BORDER_VERTICAL,_190e,_190f,_1910,_1911+1,_1912,_1913-1,_1914);
}else{
if(_190d==ActionConstants.BORDER_INSIDE_HORIZONTAL){
setBorder1(ActionConstants.BORDER_HORIZONTAL,_190e,_190f,_1910+1,_1911,_1912-1,_1913,_1914);
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
return _1922;
}
function insertDateOrTime(val){
var date=new Date();
var _192b=parseInt(date.getMonth())+1;
var _192c=date.getDate();
var _192d=date.getFullYear().toString();
var _192e=date.getHours();
var _192f=date.getMinutes();
var _1930=date.getSeconds();
var prd=" AM";
if(parseInt(_192b)<10){
_192b="0"+_192b;
}
if(parseInt(_192c)<10){
_192c="0"+_192c;
}
if(parseInt(_192f)<10){
_192f="0"+_192f;
}
if(parseInt(_1930)<10){
_1930="0"+_1930;
}
if(parseInt(_192e)>=12){
prd=" PM";
}
if(parseInt(_192e)>12){
_192e=parseInt(_192e)-12;
}
_192d=_192d.substring(2,4);
if(parseInt(_192e)<10){
_192e="0"+_192e.toString();
}
if(val=="date"){
var _1932=_192b+"/"+_192c+"/"+_192d;
}else{
var _1932=_192e+":"+_192f+":"+_1930+prd;
}
focusCellField(cellField.value+_1932);
}
function setSheetColumnsWidth(_1933,_1934,size){
var _1936=0,left=0,_1938=0;
var _1939;
var det=getColMergeDetails();
if(_1934<FREEZED_COL){
return;
}
_1933=(_1933<FREEZED_COL)?FREEZED_COL:_1933;
var endC=_1934;
if(_1934>totCols-1){
_1934=totCols-1;
}
for(var i=_1933;i<=_1934;i++){
var _193d=getColHead(i);
var width=getColWidth(i);
_1936+=(size-width);
_193d.style.width=size+"px";
if(i!=_1933){
left=_1939+size;
shiftColHead(_193d,{mode:"CONST",val:left});
_1939=left;
}else{
_1939=getColLeft(i);
}
}
setColDetails("RANGE",_1933,endC,size);
Merge.resizeDOM(_1933,endC,"COLS");
if(_1933>_1934){
return;
}
for(var i=_1933;i<=_1934;i++){
var _193f=getColHead(i);
var left=getColLeft(i);
_193f.style.left=left+"px";
_193f.style.width=getColWidth(i)+"px";
}
shiftColHeads(_1934+1,totCols-1,{mode:"DIFF",val:0});
var _1940=0;
var _1941=getCellsInCols(_1933,_1934);
doSetSheetColumnsWidth(_1941,_1933,_1934);
if(ISFREEZED){
if(FREEZED_ROW>0){
_1941=getCellsInCols(_1933,_1934,sheetPane2Id);
doSetSheetColumnsWidth(_1941,_1933,_1934);
}
if(FREEZED_COL>0){
_1941=getCellsInCols(_1933,_1934,sheetPane3Id);
doSetSheetColumnsWidth(_1941,_1933,_1934);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_1941=getCellsInCols(_1933,_1934,sheetPane1Id);
doSetSheetColumnsWidth(_1941,_1933,_1934);
}
}
shiftCellsHorizontally(_1934+1,totCols-1,{mode:"DIFF",val:0});
if(ISFREEZED){
if(FREEZED_ROW>0){
shiftCellsHorizontally(_1934+1,totCols-1,{mode:"DIFF",val:0},sheetPane2Id);
}
if(FREEZED_COL>0){
shiftCellsHorizontally(_1934+1,totCols-1,{mode:"DIFF",val:0},sheetPane3Id);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
shiftCellsHorizontally(_1934+1,totCols-1,{mode:"DIFF",val:0},sheetPane1Id);
}
}
var _1942=getColWidth(totCols-1)+getColLeft(totCols-1);
var _1943=ole.getObjectsByPositionX(getColLeft(_1933));
var _1944=[];
if(_1943.length>0){
for(var i=0;i<_1943.length;i++){
var _1945=parseInt(OLE[_1943[i].id].sColDiff);
var col=parseInt(OLE[_1943[i].id].sCol);
var width=parseInt(getColWidth(col));
var left=parseInt(getColLeft(col));
if(_1945>width){
_1944[i]=left+width;
}else{
_1944[i]=left+_1945;
}
OLE[_1943[i].id].setLeft(_1944[i]);
if(ole.getCurrObj()){
ole.getCurrObj().setSelectLayer().positionActionBar();
}
}
hasOleMoved=true;
}
focusSheet();
setSheetTableWidth(_1942);
Filter.hasFilter&&Filter.getInstance().reconstructIcons();
}
function doSetSheetColumnsWidth(_1947,_1948,_1949){
for(var i=0,j=_1948;i<_1947.length;i++){
var cell=_1947[i];
if(j!=_1948){
var left=getColLeft(j);
cell.style.left=left+"px";
}
cell.style.width=getColWidth(j)+"px";
if(!browser_ie&&!browser_ie6){
var cls=cell.className;
if(cls.indexOf(" vab")!=-1||cls.indexOf(" vam")!=-1){
if(!featureSupport.boxAlign){
cell.childNodes[0].style.width=getColWidth(j)+"px";
}
}
}
j=(j==_1949)?_1948:j+1;
}
}
function setSheetColumnWidth(_194f,_1950){
if(isNumber(_194f)&&isNumber(_1950)){
setSheetColumnsWidth(_194f,_194f,_1950);
}
}
function wrapCell(_1951){
if(_1951){
removeCSSStyle("wrapText",_1951);
var _1952=_1951.className;
_1952+=" W";
_1951.className=_1952;
}
}
function unWrapCell(_1953){
if(_1953){
removeCSSStyle("wrapText",_1953);
var _1954=_1953.className;
_1954+=" nW";
_1953.className=_1954;
}
}
function getMatchedCSSFontStyle(_1955){
var value;
var _1957=(_1955&&(value=UI.fontNamesCSSClassMap[_1955]))?" "+value:"";
return _1957;
}
function getMatchedCSSFontSize(index){
var _1959="";
if(isNumber(index)){
switch(index){
case 0:
_1959=" f8";
break;
case 1:
_1959=" f9";
break;
case 2:
_1959=" f10";
break;
case 3:
_1959=" f11";
break;
case 4:
_1959=" f12";
break;
case 5:
_1959=" f14";
break;
case 6:
_1959=" f16";
break;
case 7:
_1959=" f18";
break;
case 8:
_1959=" f20";
break;
case 9:
_1959=" f22";
break;
case 10:
_1959=" f24";
break;
case 11:
_1959=" f26";
break;
}
}
return _1959;
}
function removeCSSStyle(_195a,_195b){
if(_195b!=null&&isStr(_195a)&&isObject(_195b)){
switch(_195a){
case "fontSize":
case "fontFamily":
case "fontWeight":
case "textDecoration":
case "verticalAlign":
case "textAlign":
case "fontStyle":
case "borderRight":
case "borderBottom":
case "borderLeft":
case "borderTop":
case "wrapText":
case "cellComment":
case "strikeThrough":
case "underlineStrikethrough":
var regex=getCSSStyleRegex(_195a);
if(!isUndefined(regex)){
_195b.className=_195b.className.replace(regex,"");
}
break;
}
}
}
function getCSSStyleRegex(_195d){
if(isStr(_195d)){
var regex={};
switch(_195d){
case "fontSize":
regex=/( f[0-9]{1,2})(\b)/gi;
break;
case "fontFamily":
regex=/( fn[A-Za-z0-9]{1,5})(\b)/gi;
break;
case "fontWeight":
regex=/( fwb)(\b)/gi;
break;
case "textDecoration":
regex=/( tdu)(\b)/gi;
break;
case "verticalAlign":
regex=/( va[mbt])(\b)/gi;
break;
case "textAlign":
regex=/( ta[rc])(\b)/gi;
break;
case "fontStyle":
regex=/( fsi)(\b)/gi;
break;
case "borderRight":
regex=/( br[12d])(\b)/gi;
break;
case "borderBottom":
regex=/( bb[12d])(\b)/gi;
break;
case "borderLeft":
regex=/( bl[123])(\b)/gi;
break;
case "borderTop":
regex=/( bt[123])(\b)/gi;
break;
case "wrapText":
regex=/( nW| W)(\b)/gi;
break;
case "cellComment":
regex=/( cC)(\b)/gi;
break;
case "strikeThrough":
regex=/( tdst)(\b)/gi;
break;
case "underlineStrikethrough":
regex=/( tdsu)(\b)/gi;
break;
}
return regex;
}
}
function revertSplChrsForCellValue(str){
str=replace(str,"&","&amp;");
return str;
}
function revertQuote(str){
return replace(str,"&apos;","'");
}
function clearAll(_1961,_1962,_1963,_1964,_1965,_1966){
if(_1965==true){
clearFormatting(_1961,_1962,_1963,_1964);
}
if(_1966==true){
clearContents(_1961,_1962,_1963,_1964);
}
}
function inittextformatsstatus(_1967){
if($(_1967).hasClass("fwb")){
$("#formatData").zbutton("check","#bold");
}else{
$("#formatData").zbutton("uncheck","#bold");
}
if($(_1967).hasClass("fsi")){
$("#formatData").zbutton("check","#italic");
}else{
$("#formatData").zbutton("uncheck","#italic");
}
if($(_1967).hasClass("tdu")||$(_1967).hasClass("tdsu")){
$("#formatData").zbutton("check","#underline");
}else{
$("#formatData").zbutton("uncheck","#underline");
}
if($(_1967).hasClass("tdst")||$(_1967).hasClass("tdsu")){
$("#formatData").zbutton("check","#strike");
}else{
$("#formatData").zbutton("uncheck","#strike");
}
if($(_1967).attr("format")=="PERCENT"){
$("#formatCellsNumber").zbutton("check","#PERCENT");
}else{
$("#formatCellsNumber").zbutton("uncheck","#PERCENT");
}
}
var copyFormatRange=new Object();
var fPainter=new Object();
fPainter.fPaintersingleclick=false;
fPainter.fPainterdoubleclick=false;
var xRange=new Object();
var sourceSheetname;
function getSourceRangeForCopyFormat(){
copyCells("formatPainter");
if(isCellRange()){
copyFormatRange=getCellRange();
}else{
copyFormatRange.startRow=ActiveCellInfo.getStartRow();
copyFormatRange.endRow=ActiveCellInfo.getEndRow();
copyFormatRange.startCol=ActiveCellInfo.getStartCol();
copyFormatRange.endCol=ActiveCellInfo.getEndCol();
}
if(isRowSelected()){
copyFormatRange.endCol=getColMax()-1;
}
copyFormatRange.sheetName=sourceSheetname=CURRSHEETNAME;
focusCellRangeFill(copyFormatRange.startRow,copyFormatRange.startCol,copyFormatRange.endRow,copyFormatRange.endCol);
}
var firing=false;
fPainter.singleclickpress=false;
function singleClickfunction(){
fPainter.fPainterdoubleclick=false;
fPainter.fPaintersingleclick=true;
}
function doubleClickfunction(){
fPainter.fPainterdoubleclick=true;
fPainter.fPaintersingleclick=false;
}
function formatbrush(){
var fbObj=getObj("formatbrush");
fbObj.onclick=function(){
if(fPainter.fPaintersingleclick||fPainter.fPainterdoubleclick){
fPainter.fPaintersingleclick=false;
fPainter.fPainterdoubleclick=false;
hideCellRangeFillDIV();
cursorchange();
firing=false;
}else{
if(!firing){
firing=true;
fPainter.fPaintersingleclick=true;
cursorchange();
getSourceRangeForCopyFormat();
}
}
if(fPainter.singleclickpress){
return;
}
if(!fPainter.singleclickpress){
fPainter.singleclickpress=true;
fPainter.fPainterdoubleclick=false;
setTimeout(function(){
if(!(fPainter.fPainterdoubleclick||fPainter.fPaintersingleclick)){
}
fPainter.singleclickpress=false;
},500);
}
};
fbObj.ondblclick=function(){
fPainter.fPainterdoubleclick=true;
fPainter.fPaintersingleclick=false;
cursorchange();
};
if(!firing){
firing=true;
fPainter.fPaintersingleclick=true;
getSourceRangeForCopyFormat();
}
}
function copyFormatting(){
firing=false;
if(isCellRange()){
xRange=getCellRange();
document.cellform.tmpData.value="ToRange";
document.cellform.column.value=xRange.startCol;
document.cellform.row.value=xRange.startRow;
document.cellform.textAreaValue.value=xRange.endRow;
document.cellform.formattedCellValue.value=xRange.endCol;
if(ActiveCellInfo.getStartRow()>0&&ActiveCellInfo.getStartCol()>0){
if(cellRangeContainsMergeCells(xRange.startRow,xRange.startCol,xRange.endRow,xRange.endCol)){
showAlertDialog(jsTitleMsg.CannotPasteIntoMergedCell);
return false;
}else{
if(ActiveCellInfo.isMerged()){
showAlertDialog(jsTitleMsg.CannotPasteIntoMergedCell);
return false;
}
}
}
if(isPartOfArray(xRange.startRow,xRange.startCol,xRange.endRow,xRange.endCol)||containsAnyArray(xRange.startRow,xRange.startCol,xRange.endRow,xRange.endCol)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return false;
}
}else{
document.cellform.tmpData.value="ToCell";
document.cellform.row.value=ActiveCellInfo.getStartRow();
document.cellform.column.value=ActiveCellInfo.getStartCol();
var _1969=(ActiveCellInfo.getStartRow()+(copyFormatRange.endRow-copyFormatRange.startRow));
var _196a=(ActiveCellInfo.getStartCol()+(copyFormatRange.endCol-copyFormatRange.startCol));
if(isPartOfArray(ActiveCellInfo.getStartRow(),ActiveCellInfo.getStartCol(),_1969,_196a)||containsAnyArray(ActiveCellInfo.getStartRow(),ActiveCellInfo.getStartCol(),_1969,_196a)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return false;
}
if(ActiveCellInfo.getStartRow()>0&&ActiveCellInfo.getStartCol()>0){
if(cellRangeContainsMergeCells(ActiveCellInfo.getStartRow(),ActiveCellInfo.getStartCol(),ActiveCellInfo.getStartRow(),ActiveCellInfo.getStartCol())){
showAlertDialog(jsTitleMsg.CannotPasteIntoMergedCell);
return false;
}
}
}
var _196b=getAvailableStartRow();
var _196c=getAvailableEndRow();
document.cellform.actionMode.value="CopyFormat";
document.cellform.startColumn.value=copyFormatRange.startCol;
document.cellform.endColumn.value=copyFormatRange.endCol;
document.cellform.startRow.value=copyFormatRange.startRow;
document.cellform.endRow.value=copyFormatRange.endRow;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.tmpSheet.value=sourceSheetname;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_196b;
document.cellform.availableEndRow.value=_196c;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
document.cellform.totCols.value=totCols;
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
if(fPainter.fPaintersingleclick){
hideCellRangeFillDIV();
}else{
if(copyFormatRange.sheetName==CURRSHEETNAME){
focusCellRangeFill(copyFormatRange.startRow,copyFormatRange.startCol,copyFormatRange.endRow,copyFormatRange.endCol,true);
}
}
if(fPainter.fPaintersingleclick){
fPainter.fPaintersingleclick=false;
cursorchange();
}
}
function applyFormatting(){
if(fPainter.fPaintersingleclick||fPainter.fPainterdoubleclick){
copyFormatting();
cursorchange();
}
}
function cursorchange(){
if(fPainter.fPaintersingleclick||fPainter.fPainterdoubleclick){
$("#formatbrush").addClass("zbactive");
$("#sheet").removeClass("sheet").addClass("fpCur");
}else{
$("#formatbrush").removeClass("zbactive");
$("#sheet").removeClass("fpCur").addClass("sheet");
}
}
function exitFormatPainter(){
if(fPainter.fPainterdoubleclick||fPainter.fPaintersingleclick){
hideCellRangeFillDIV();
fPainter.fPainterdoubleclick=false;
fPainter.fPaintersingleclick=false;
cursorchange();
firing=false;
}
}
function contextmenu(obj,ev){
hideCellComment(obj);
if(browser_ie&&obj.id=="sT"){
}
getContextMenuHtml(obj,ev);
return false;
}
var comntaction="";
function showcomment(obj,_1970){
var attr=(obj)?obj.getAttribute("comment"):null;
if(isCellSelection||attr==null){
return false;
}
var _1972=obj.getAttribute("comment");
showCommentDialog(_1970,_1972,obj);
}
var commentShown=false;
function showCommentDialog(_1973,value,_1975){
var _1976="";
comntaction=_1973;
var _1977=currCell;
if(_1977){
if(_1973=="add"){
value="";
if(LOGINNAME!=null&&LOGINNAME!=""){
value=LOGINNAME+":\n";
}
}else{
if(_1973=="edit"){
if(currCell){
value=currCell.getAttribute("comment");
}
}
}
var title="";
if(_1973=="add"||_1973=="edit"||_1973=="readonly"){
_1976=getCommenthtml(_1973,value);
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
var _197c=getCellLabel(row,col);
var _197d="yes";
var top=0;
var left=20;
if(_1973=="add"){
title=jsTitleMsg["Review.Comment.AddCommentFor"]+" "+_197c;
}else{
if(_1973=="edit"){
title=jsTitleMsg.EditCommentIn+" "+_197c;
}else{
if(_1973=="readonly"){
_1977=_1975;
_197d="no";
}
}
}
var left=getColLeft(currCol);
if(_1973=="readonly"){
showDialog(_1976,"position=absmiddle, closeOnEscKey=yes, closeButton="+_197d+", title="+title);
commentShown=true;
}else{
showDialog(_1976,"position=absmiddle, width=350, closeOnBodyClick=yes, closeOnEscKey=yes, closeButton="+_197d+", title="+title,focusCommentArea);
}
if(_1973=="add"||_1973=="edit"){
setTimeout("getObj('comment_tip').focus()",1);
}
}
}
}
function focusCommentArea(){
if(browser_ie||browser_safari||browser_chrome){
var _1980=getObj("comment_tip");
var _1981=_1980.value.length;
setCaretPos(_1980,_1981);
}
}
function commentaction(act,row,col,_1985,_1986,name){
if(typeof _1986=="undefined"){
_1986="false";
}
var _1988="";
if(_1986=="false"){
var info=ActiveCellInfo;
row=info.getStartRow();
col=info.getStartCol();
if(act=="remove"){
comntaction=act;
}else{
_1988=getObj("comment_tip").value;
_1988=encodeURIComponent(_1988);
}
}else{
comntaction=act;
if(act!="remove"){
_1988=_1985;
_1988=encodeURIComponent(_1988);
}
}
var _198a=new getXmlhttp();
_198a.onreadystatechange=function(){
if(_198a.readyState==4){
if(_198a.responseText==showErrorPanelMsg){
handleServerError("ERROR",_198a.responseText,true);
closeDialog();
return;
}
if(ISSAMESHEET=="true"){
var _198b=filterComment(_198a.responseXML);
addcomment(comntaction,row,col,_198b);
closeDialog();
}
if(READ_WRITE){
btn_enabled();
}
ISSAMESHEET="true";
}
};
if(_1986=="true"){
var _198c=CURRSHEETNAME;
}else{
var _198c=encodeURIComponent(CURRSHEETNAME);
}
nvp="action="+comntaction+"&comment="+_1988+"&sheetname="+_198c+"&curtime="+CURRENTTIME+"&row="+row+"&column="+col;
nvp+="&docowner="+CURR_DOC_OWNERNAME+"&collabid="+COLLAB_ID+"&docid="+DOCUMENT_ID+"&isDocSaved="+isDocSaved()+"&afterRTC="+_1986;
nvp+="&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING+"&viewType="+getViewType()+"&bridgeNo="+bridgeNumber;
if(_1986=="true"){
var _198e=encodeURIComponent(RTCSHEETNAME);
nvp+="&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+_198e;
nvp+="&uname="+getUsrName(name);
}
if(jsREMOTE_SAVE_VIEW){
nvp+="&RMLOGINNAME="+RMUSER;
nvp+="&userStateId="+USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _198f=getObj("apiKey");
if(_198f!=null){
nvp+="&apiKeyId="+_198f.value;
}
}
nvp+="&commentOwner="+LOGINNAME;
var nvp=appendCSRFToURL(nvp);
postAjax(_198a,ctxpath+"annot.do",nvp);
}
function filterComment(_1990){
if(_1990==null||typeof _1990=="undefined"||!_1990.hasChildNodes()){
return;
}
var _1991="";
if(_1990.firstChild.hasChildNodes()){
var _1992=_1990.firstChild.childNodes;
for(var x=0;x<_1992.length;x++){
node=_1992.item(x);
if(node.nodeName=="comment"){
var _1994=node.childNodes;
for(var i=0;i<_1994.length;i++){
_1991=_1994[i].nodeValue;
}
}
if(node.nodeName=="undo"){
updateUndoRangeJson(node.childNodes[0].nodeValue);
}
if(node.nodeName=="sheet"){
if(node.attributes){
var _1996=node.attributes;
var _1997=_1996.item(0);
if(_1997.nodeName=="bridgeNo"){
if(_1997.nodeValue!=""&&_1997.nodeValue!="null"){
bridgeNumber=_1997.nodeValue;
}
}
}
}
}
}
return _1991;
}
function addcomment(_1998,row,col,_199b){
var cell=getCell(row,col);
addcomment1(cell,_1998,row,col,_199b);
if(ISFREEZED){
cell=getCell(row,col,sheetPane2Id);
addcomment1(cell,_1998,row,col,_199b);
cell=getCell(row,col,sheetPane3Id);
addcomment1(cell,_1998,row,col,_199b);
cell=getCell(row,col,sheetPane1Id);
addcomment1(cell,_1998,row,col,_199b);
}
}
function addcomment1(cell,_199e,row,col,_19a1){
if(cell!=null){
cell.removeAttribute("comment");
var _19a2=getHyperLinkInCell(cell).childTag;
if(_199e=="add"||_199e=="edit"){
if(_199e=="edit"){
cell.setAttribute("comment",_19a1);
}else{
cell.className+=" cC";
cell.setAttribute("comment",_19a1);
toggleElements(["editcomment","removecomment"],["addcomment"]);
if(browser_ie){
cell.attachEvent("onmouseover",showCellComment);
cell.attachEvent("onmouseout",hideCellComment);
cell.setAttribute("onmouseover","showCellComment(event, this)");
cell.setAttribute("onmouseout","hideCellComment()");
}else{
cell.setAttribute("onmouseover","showCellComment(event, this)");
cell.setAttribute("onmouseout","hideCellComment()");
}
}
if(_19a2!=null){
setCellTooltip(_19a2,"");
}
}else{
if(_199e=="remove"){
removeCSSStyle("cellComment",cell);
toggleElements(["editcomment","removecomment"],["addcomment"],false);
if(_19a2!=null){
setCellTooltip(_19a2,_19a2.href);
}
}
}
}
}
function removeRangeComments(_19a3,_19a4,_19a5,_19a6){
for(var row=_19a3;row<=_19a5;row++){
for(var col=_19a4;col<=_19a6;col++){
var _19a9=getCell(row,col);
removeCellComment(_19a9);
if(ISFREEZED){
if(FREEZED_ROW>0){
_19a9=getCell(row,col,sheetPane2Id);
removeCellComment(_19a9);
}
if(FREEZED_COL>0){
_19a9=getCell(row,col,sheetPane3Id);
removeCellComment(_19a9);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_19a9=getCell(row,col,sheetPane1Id);
removeCellComment(_19a9);
}
}
}
}
}
function removeCellComment(cell){
if(cell){
cell.removeAttribute("comment");
removeCSSStyle("cellComment",cell);
}
}
function getComments(_19ab){
var url=ctxpath+"getComments.do";
var _19ad=new getXmlhttp();
_19ad.open("POST",url,true);
_19ad.onreadystatechange=function(){
if(_19ad.readyState==4){
gridListener.listen(7);
addCommentEvents(_19ad.responseText);
if(typeof _19ab=="undefined"){
if(!SHEETSWITCH&&General.isLoggedIn&&!jsVERSION_VIEW&&CANREADWRITE&&((jsSHARE_VIEW&&!ALLOW_TO_WRITE)||ALLOW_TO_WRITE)&&ENTEREDPERFCHECK){
getObj("waitmsg").style.display="none";
disableToolBar(READ_WRITE);
}
}
}
};
_19ad.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_19ad.send("docid="+DOCUMENT_ID+"&curtime="+CURRENTTIME+"&sheetname="+encodeURIComponent(CURRSHEETNAME)+"&viewType="+getViewType()+"&docowner="+CURR_DOC_OWNERNAME);
}
function addCommentEvents(resp){
var ret=eval(resp);
var len=ret.length;
for(var x=0;x<len;x++){
var _19b2=ret[x];
var docid=_19b2.DOCUMENT;
var _19b4=_19b2.SHEET;
if(docid!=DOCUMENT_ID||_19b4!=CURRSHEETNAME){
break;
}
var elem=getObj(_19b2.ELEM);
if(elem!=null&&elem!="null"){
elem.onmouseover=function(ev){
showCellComment(ev,this);
};
elem.onmouseout=function(){
hideCellComment();
};
}
}
if(jsREMOTE_SAVE_VIEW){
message("","none");
}
}
function getCommenthtml(_19b7,value){
var html="<div id="+"\""+"commentdialog"+"\""+">";
html+="<table align='center' width='100%' cellspacing="+"\""+"0"+"\""+" cellpadding="+"\""+"10"+"\""+">";
html+="<tr>";
if(_19b7!="setrowheight"&&_19b7!="setcolumnwidth"){
if(_19b7!="readonly"){
html+="<td><textarea id="+"\""+"comment_tip"+"\""+" rows="+"\""+"7"+"\""+"class="+"\""+"textArea"+"\""+" style='width:100%'>"+value+"</textarea></td>";
html+="</tr>";
html+="<tr>";
html+="<td"+" align="+"\""+"right"+"\""+" style='padding-top:0px'>";
html+="<input type="+"\""+"button"+"\""+" class="+"\""+"button"+"\""+" value="+"\""+jsTitleMsg.OK+"\""+" onclick="+"\""+"commentaction(); "+"\""+">";
html+="  <input type="+"\""+"button"+"\""+" class="+"\""+"button"+"\""+" value="+"\""+jsTitleMsg.Cancel+"\""+" onclick="+"\""+"closeDialog(); "+"\""+">";
html+="</td>";
html+="</tr>";
}else{
html+="<td class='comment_info'><pre id="+"\""+"comment_tip"+"\""+" style='width:100%'>"+value+"</pre></td>";
html+="</tr>";
}
}else{
if(_19b7=="setrowheight"){
html+="<td align='center'><input id="+"\""+"row_height"+"\""+" maxlength='4' width='100%' onKeyPress='return onlyNumber(this, event)' value="+value+"></td>";
html+="</tr>";
html+="<tr>";
html+="<td"+" align="+"\""+"center"+"\""+">";
html+="<input type="+"\""+"button"+"\""+" class="+"\""+"button"+"\""+" value="+"\""+jsTitleMsg.OK+"\""+" onclick="+"\""+"width_height_action('height'); "+"\""+">";
html+="  <input type="+"\""+"button"+"\""+" class="+"\""+"button"+"\""+" value="+"\""+jsTitleMsg.Cancel+"\""+" onclick="+"\""+"closeDialog(); "+"\""+">";
html+="</td>";
html+="</tr>";
}else{
if(_19b7=="setcolumnwidth"){
html+="<td align='center'><input id="+"\""+"col_width"+"\""+" maxlength='4' width='100%' onKeyPress='return onlyNumber(this, event)' value="+value+"></td>";
html+="</tr>";
html+="<tr>";
html+="<td"+" align="+"\""+"center"+"\""+">";
html+="<input type="+"\""+"button"+"\""+" class="+"\""+"button"+"\""+" value="+"\""+jsTitleMsg.OK+"\""+" onclick="+"\""+"width_height_action('width'); "+"\""+">";
html+="  <input type="+"\""+"button"+"\""+" class="+"\""+"button"+"\""+" value="+"\""+jsTitleMsg.Cancel+"\""+" onclick="+"\""+"closeDialog(); "+"\""+">";
html+="</td>";
html+="</tr>";
}
}
}
html+="</table>";
html+="</div>";
return html;
}
function copytoclip(_19ba){
var _19bb="";
var _19bc=getCellRange();
if(getAvailableStartRow()<=_19bc.startRow&&getAvailableEndRow()>=_19bc.endRow){
var _19bd=_19bc.endRow-_19bc.startRow;
var _19be=_19bc.endCol-_19bc.startCol;
var range=new Range(_19bc.startRow,_19bc.startCol,_19bc.endRow,_19bc.endCol);
var iter=range.getIterator();
iter.initData(_19bb);
iter.setDataProcessor(function(val){
var data=this.getData();
data+=val;
return data;
});
iter.addEventListener("onRowAfter",function(row,col){
this.processData("\n");
});
iter.iterate(function(row,col,_19c7,_19c8){
var cell=getCell(row,col);
if(cell){
var cV=getCellValue(cell);
if(_19c7=="Link"){
cV=getHyperLinkInCell(cell).childTag.href;
}
if(cV==null){
cV="";
}
this.processData(cV);
if(col!=_19c8.endCol){
this.processData("\t");
}
}
},_19ba,_19bc);
var value=iter.getData();
showClipBoard(value,_19ba);
}else{
submitCopytoClip(_19bc);
}
}
function showClipBoard(value,_19cd){
var html="<div id='copytoclip'>";
html+="<table align='center' width='100%' style='padding:5px;' cellspacing=''0' cellpadding='1'>";
html+="<tr>";
html+="<td>"+jsMsg.CopyTheContentShownBelow+" "+"</td>";
html+="</tr>";
html+="<tr>";
html+="<td align='center'><textarea id='txt_copytoclip' rows='6' style='width:100%'>"+escapeSpecialCharacters(value)+"</textarea></td>";
html+="</tr>";
html+="<tr>";
html+="<td align='right'><input type='button' class='button' value='"+jsTitleMsg.Close+"' onclick='closeDialog();'></td>";
html+="</tr>";
html+="</table>";
html+="</div>";
if(_19cd=="Link"){
title=jsTitleMsg.CopyLinkLocation;
}else{
title=jsTitleMsg.CopyToClipboard;
}
showDialog(html,"position=absmiddle, width=350, closeOnEscKey=yes, title="+title+", closeButton=yes");
var _19cf=getObj("txt_copytoclip");
_19cf.focus();
_19cf.select();
}
var rHTcontextMenuStatus=false;
var cHTcontextMenuStatus=false;
var contextMenuStatus=false;
var ROcontextMenuStatus=false;
var currContextMenuFor="";
var isRangeContextMenu=false;
var sTcontextMenuStatus=false;
var prevRowCnt=0;
var prevColCnt=0;
var rangeChanged=false;
var reservedContextMenuInfo={prevRowIdx:undefined,prevColIdx:undefined,target:undefined};
function getContextMenuHtml(obj,ev){
var _19d2=false;
if(isCellRange()){
_19d2=true;
var _19d3=getCellRange();
var _19d4=_19d3.endRow-_19d3.startRow+1;
if(Filter.isApplied()){
_19d4=_19d4-Row.getHiddenRowCount(_19d3.startRow,_19d3.endRow);
}
var _19d5=_19d3.endCol-_19d3.startCol+1;
var _19d6=_19d3.startRow;
var _19d7=_19d3.startCol;
}else{
_19d2=false;
var _19d4=ActiveCellInfo.getRowSpan();
var _19d5=ActiveCellInfo.getColSpan();
var _19d6=ActiveCellInfo.getStartRow();
var _19d7=ActiveCellInfo.getStartCol();
}
var attr=(currCell)?currCell.getAttribute("comment"):null;
var _19d9=true;
if(attr==null){
_19d9=false;
}
attr=(currCell)?currCell.getAttribute("hyper"):null;
var _19da=null;
if(attr==null||attr=="null"){
_19da=null;
}else{
if(attr=="multi"){
_19da="multi";
}else{
_19da="full";
}
}
var _19db=jsMsg.FreezePanes;
var _19dc=jsMsg.UnfreezePanes;
if((transMode==true)&&(messagetranslated==true)&&(ROcontextMenuStatus||cHTcontextMenuStatus||rHTcontextMenuStatus||contextMenuStatus)){
if(ROcontextMenuStatus){
Menu.ROcontextMenu.cachedContent="";
ROcontextMenuStatus=false;
}
if(cHTcontextMenuStatus){
Menu.cHTcontextMenu.cachedContent="";
cHTcontextMenuStatus=false;
}
if(rHTcontextMenuStatus){
Menu.rHTcontextMenu.cachedContent="";
rHTcontextMenuStatus=false;
}
if(contextMenuStatus){
Menu.contextMenu.cachedContent="";
contextMenuStatus=false;
}
if(sTcontextMenuStatus){
Menu.sTcontextMenu.cachedContent="";
sTcontextMenuStatus=false;
}
}
currContextMenuFor=obj.id;
var _19dd="";
if(currContextMenuFor==""&&browser_opera){
currContextMenuFor="sT";
}
if(!browser_opera){
_19dd=" forElement='"+currContextMenuFor+"'";
}
if(!READ_WRITE||!isServerComponentLoaded(true)){
if(!ROcontextMenuStatus){
var _19de="<menu id='ROcontextMenu' onLoad = 'contextLoad();' onUnload = 'contextUnLoad();'"+_19dd+">";
_19de+=" <item onclick='copytoclip();return false;'><![CDATA["+jsMsg.CopyToClipboard+"]]></item>";
if((jsPUBLIC_VIEW&&!isReadOnlyViewMode)||jsGUEST_VIEW){
_19de+=" <sep></sep>";
_19de+=" <item imgclass='freezePanes'><![CDATA["+_19db+"]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item imgclass='freezePanes' onclick='freeze()'><![CDATA["+_19db+"]]></item>";
_19de+=" <item imgclass='freezeTopRow' onclick='freezeTopRow();'><![CDATA["+jsMsg["FreezePanes.FreezeTopRow"]+"]]></item>";
_19de+=" <item imgclass='freezeFirstColumn' onclick='freezeFirstColumn();'><![CDATA["+jsMsg["FreezePanes.FreezeFirstColumn"]+"]]></item>";
_19de+=" </menu></item>";
_19de+=" <item imgclass='unfreezePanes' onclick='unFreezePanes()'><![CDATA["+_19dc+"]]></item>";
}
_19de+="</menu>";
createContextMenu(_19de,{inputType:"xml"});
if(Menu.ROcontextMenu.data.length>2){
if(ISFREEZED){
Menu.ROcontextMenu.data[3].hidden="true";
Menu.ROcontextMenu.data[4].hidden="false";
}else{
Menu.ROcontextMenu.data[4].hidden="true";
Menu.ROcontextMenu.data[3].hidden="false";
}
}
if(Menu.ROcontextMenu.data.length>1){
Menu.ROcontextMenu.data[1].hidden="true";
}
if(!ISFREEZED){
ROcontextMenuStatus=true;
}
if(browser_ie){
Menu._getCursorPos();
showMenu("ROcontextMenu");
}else{
if(browser_nn6){
Menu._getCursorPos(ev);
showMenu("ROcontextMenu");
}
}
}
showMenu("ROcontextMenu");
return;
}
if(browser_ie&&contextMenuStatus){
}
if(currContextMenuFor=="cHT"||currContextMenuFor=="cHT1"){
if(prevColCnt!=_19d5){
rangeChanged=true;
prevColCnt=_19d5;
}
if(!cHTcontextMenuStatus){
var _19de="<menu id='cHTcontextMenu'  onLoad = 'contextLoad();' onUnload = 'contextUnLoad();' forElement='"+currContextMenuFor+"'>";
_19de+=" <item onclick='setColumnWidth();return false;'><![CDATA["+jsMsg.ColumnWidth+"...]]></item>";
_19de+=" <item imgclass='sort_cust' ><![CDATA["+jsMsg.Sort+"]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item imgclass='sort_asc'  onclick='sortheader(\"asc\");return false;'><![CDATA["+jsMsg.SortAscending+"]]></item>";
_19de+=" <item imgclass='sort_desc'  onclick='sortheader(\"desc\");return false;'><![CDATA["+jsMsg.SortDescending+"]]></item>";
if(!jsGADGET_VIEW){
_19de+=" <item  imgclass='sort_cust' onclick='constructSortDialog();return false;'><![CDATA["+jsMsg.CustomSort+"...]]></item>";
}
_19de+=" </menu></item>";
_19de+=" <sep></sep>";
_19de+=" <label imgclass='menuLabelBg'><![CDATA["+jsMsg.Insert+":]]></label>";
_19de+=" <item\timgclass='inscol_before' onclick='insertCol(\"before\");'><![CDATA["+replaceParams(jsMsg.NoofColumnsBefore,new Array(""+_19d5+""))+"]]></item>";
_19de+=" <item\timgclass='inscol_after' onclick='insertCol(\"after\");'><![CDATA["+replaceParams(jsMsg.NoofColumnsAfter,new Array(""+_19d5+""))+"]]></item>";
_19de+=" <item  imgclass='inscol_before' onclick='insertCopiedCols(\"before\");'><![CDATA["+jsMsg["Insert.Copied.Column.Before"]+"]]></item>";
_19de+=" <item  imgclass='inscol_after' onclick='insertCopiedCols(\"after\");'><![CDATA["+jsMsg["Insert.Copied.Column.After"]+"]]></item>";
_19de+=" <item  imgclass='inscol_before' onclick='insertCutColumns(\"before\");'><![CDATA["+jsMsg["Insert.Cut.Column.Before"]+"]]></item>";
_19de+=" <item imgclass='inscol_after'  onclick='insertCutColumns(\"after\");'><![CDATA["+jsMsg["Insert.Cut.Column.After"]+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item onclick='deleteCol();'><![CDATA["+replaceParams(jsMsg.DeleteNoofColumns,new Array(""+_19d5+""))+"]]></item>";
_19de+=" <item onclick='deleteCell();closeDialog();return false;'><![CDATA["+jsMsg.ClearContents+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item imgclass='formatCells' onclick='showFormatCellsDialog();closeDialog();return false;' shortcut='Ctrl+Shift+1'><![CDATA["+jsMsg.FormatCells+"...]]></item>";
_19de+=" <item onclick='deleteCell(\"ClearStyles\");closeDialog();return false;'><![CDATA["+jsMsg.ClearFormatting+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item onclick='cutCells();closeDialog();setCutStatus();return false;' imgclass='cutIcon_contextmenu' shortcut='Ctrl+X'><![CDATA["+jsMsg.Cut+"]]></item>";
_19de+=" <item id = 'contextCopyRow' onclick='copyCells();closeDialog();setCopyStatus();return false;' imgclass='copyIcon_contextmenu' shortcut='Ctrl+C'><![CDATA["+jsMsg.Copy+"]]></item>";
_19de+=" <item onclick='copytoclip();return false;'><![CDATA["+jsMsg.CopyToClipboard+"]]></item>";
_19de+=" <item onclick='pasteCells();closeDialog();setPasteStatus();return false;' imgclass='pasteIcon_contextmenu' shortcut='Ctrl+V'><![CDATA["+jsMsg.Paste+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item imgclass='cellName' onclick='showNameDialog(\"add\");return false;' shortcut='Ctrl+F3'><![CDATA["+jsMsg.NamethisRange+"...]]></item>";
_19de+=" <item imgclass='cellName' onclick='showNameDialog(\"add\");return false;' shortcut='Ctrl+F3'><![CDATA["+jsMsg.NamethisCell+"...]]></item>";
if(jsSHARE_VIEW==false&&jsTRASH_VIEW==false&&jsGUEST_VIEW==false&&jsPUBLIC_VIEW==false&&jsREMOTE_VIEW==false&&jsTHROWAWAY_VIEW==false&&jsVERSION_VIEW==false&&jsREMOTE_SAVE_VIEW==false&&!HIDE_PUBLISH_OPTION){
if(zoid!=-1){
_19de+=" <item imgclass='publishIcon_contextmenu'><![CDATA["+jsMsg.PublishThisRangeIn+"...]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item onclick='rangePublish(\"org\", true);return false;'><![CDATA["+jsMsg.IntranetBlogSite+"]]></item>";
_19de+=" <item onclick='rangePublish(\"external\", true);return false;'><![CDATA["+jsMsg.ExternalBlogSite+"]]></item>";
_19de+=" </menu></item>";
}else{
_19de+=" <item imgclass='publishIcon_contextmenu' onclick='rangePublish(\"external\", true);return false;'><![CDATA["+jsMsg.PublishThisRange+"...]]></item>";
}
}
_19de+=" <sep></sep>";
_19de+=" <item imgclass='freezePanes' ><![CDATA["+_19db+"]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item imgclass='freezePanes' onclick='freeze()'><![CDATA["+_19db+"]]></item>";
_19de+=" <item imgclass='freezeTopRow' onclick='freezeTopRow();'><![CDATA["+jsMsg["FreezePanes.FreezeTopRow"]+"]]></item>";
_19de+=" <item imgclass='freezeFirstColumn' onclick='freezeFirstColumn();'><![CDATA["+jsMsg["FreezePanes.FreezeFirstColumn"]+"]]></item>";
_19de+=" </menu></item>";
_19de+=" <item imgclass='unfreezePanes' onclick='unFreezePanes()'><![CDATA["+_19dc+"]]></item>";
_19de+=" <item hidden='true' onclick='setCustomFormat()'><![CDATA["+jsMsg.FormatCells+"]]></item>";
_19de+="</menu>";
if(!browser_opera){
createContextMenu(_19de,{inputType:"xml"});
}else{
Menu.create(_19de,{inputType:"xml"});
}
}
Menu.cHTcontextMenu.data[19].hidden="true";
if(insertCopyCols||insertCutCols){
Menu.cHTcontextMenu.data[4].hidden="true";
Menu.cHTcontextMenu.data[5].hidden="true";
}else{
Menu.cHTcontextMenu.data[4].hidden="false";
Menu.cHTcontextMenu.data[5].hidden="false";
}
Menu.cHTcontextMenu.data[6].hidden=insertCopyCols?"false":"true";
Menu.cHTcontextMenu.data[7].hidden=insertCopyCols?"false":"true";
Menu.cHTcontextMenu.data[8].hidden=insertCutCols?"false":"true";
Menu.cHTcontextMenu.data[9].hidden=insertCutCols?"false":"true";
var _19df=(Filter.hasFilteredCols()&&Row.hasHiddenRows());
Menu.cHTcontextMenu.data[8].disabled=(insertCutCols&&_19df)?"true":"false";
Menu.cHTcontextMenu.data[9].disabled=(insertCutCols&&_19df)?"true":"false";
if(copyRangeEndCol-copyRangeStartCol==0){
if(insertCopyCols){
Menu.cHTcontextMenu.data[6].content=replace(jsMsg["Insert.Copied.Column.Before"],jsMsg["Insert.Copied.Columns.Before"]);
Menu.cHTcontextMenu.data[7].content=replace(jsMsg["Insert.Copied.Column.After"],jsMsg["Insert.Copied.Columns.After"]);
}
if(insertCutCols){
Menu.cHTcontextMenu.data[8].content=replace(jsMsg["Insert.Cut.Column.Before"],jsMsg["Insert.Cut.Columns.Before"]);
Menu.cHTcontextMenu.data[9].content=replace(jsMsg["Insert.Cut.Column.After"],jsMsg["Insert.Cut.Columns.After"]);
}
}else{
if(insertCopyCols){
Menu.cHTcontextMenu.data[6].content=replace(jsMsg["Insert.Copied.Columns.Before"],jsMsg["Insert.Copied.Column.Before"]);
Menu.cHTcontextMenu.data[7].content=replace(jsMsg["Insert.Copied.Columns.After"],jsMsg["Insert.Copied.Column.After"]);
}
if(insertCutCols){
Menu.cHTcontextMenu.data[8].content=replace(jsMsg["Insert.Cut.Columns.Before"],jsMsg["Insert.Cut.Column.Before"]);
Menu.cHTcontextMenu.data[9].content=replace(jsMsg["Insert.Cut.Columns.After"],jsMsg["Insert.Cut.Column.After"]);
}
}
if(copyStatus||cutStatus||(cellRangeFillDIV&&cellRangeFillDIV.style.display!="none")){
Menu.cHTcontextMenu.data[20].disabled="false";
}else{
Menu.cHTcontextMenu.data[20].disabled="true";
}
if(Menu.cHTcontextMenu.data.length>28){
if(jsGADGET_VIEW){
Menu.cHTcontextMenu.data[19].hidden="true";
Menu.cHTcontextMenu.data[21].hidden="true";
Menu.cHTcontextMenu.data[16].hidden="true";
Menu.cHTcontextMenu.data[25].hidden="true";
Menu.cHTcontextMenu.data[26].hidden="true";
Menu.cHTcontextMenu.data[27].hidden="true";
}else{
if(ISFREEZED){
Menu.cHTcontextMenu.data[26].hidden="true";
Menu.cHTcontextMenu.data[27].hidden="false";
}else{
Menu.cHTcontextMenu.data[27].hidden="true";
Menu.cHTcontextMenu.data[26].hidden="false";
}
}
}else{
if(jsGADGET_VIEW){
Menu.cHTcontextMenu.data[19].hidden="true";
Menu.cHTcontextMenu.data[21].hidden="true";
Menu.cHTcontextMenu.data[16].hidden="true";
Menu.cHTcontextMenu.data[24].hidden="true";
Menu.cHTcontextMenu.data[25].hidden="true";
Menu.cHTcontextMenu.data[26].hidden="true";
}else{
if(ISFREEZED){
Menu.cHTcontextMenu.data[25].hidden="true";
Menu.cHTcontextMenu.data[26].hidden="false";
}else{
Menu.cHTcontextMenu.data[26].hidden="true";
Menu.cHTcontextMenu.data[25].hidden="false";
}
}
}
if(jsGADGET_VIEW){
Menu.cHTcontextMenu.data[12].hidden="true";
Menu.cHTcontextMenu.data[13].hidden="true";
Menu.cHTcontextMenu.data[14].hidden="true";
Menu.cHTcontextMenu.data[15].hidden="true";
Menu.cHTcontextMenu.data[17].hidden="true";
Menu.cHTcontextMenu.data[18].hidden="true";
Menu.cHTcontextMenu.data[20].hidden="true";
}
if(rangeChanged){
if(!jsGADGET_VIEW){
if(_19d2){
Menu.cHTcontextMenu.data[22].hidden="false";
Menu.cHTcontextMenu.data[23].hidden="true";
}else{
Menu.cHTcontextMenu.data[22].hidden="true";
Menu.cHTcontextMenu.data[23].hidden="false";
}
}else{
Menu.cHTcontextMenu.data[22].hidden="true";
Menu.cHTcontextMenu.data[23].hidden="true";
Menu.cHTcontextMenu.data[24].hidden="true";
}
if(_19d5>1){
Menu.cHTcontextMenu.data[4].content=replaceParams(jsMsg.NoofColumnsBefore,new Array(""+_19d5+""));
Menu.cHTcontextMenu.data[5].content=replaceParams(jsMsg.NoofColumnsAfter,new Array(""+_19d5+""));
Menu.cHTcontextMenu.data[11].content=replaceParams(jsMsg.DeleteNoofColumns,new Array(""+_19d5+""));
}else{
Menu.cHTcontextMenu.data[4].content=jsMsg.ColumnBefore;
Menu.cHTcontextMenu.data[5].content=jsMsg.ColumnAfter;
Menu.cHTcontextMenu.data[11].content=jsMsg.DeleteColumn;
}
if(!browser_opera){
if(!cHTcontextMenuStatus){
if(browser_ie){
Menu._getCursorPos();
showMenu("cHTcontextMenu");
}else{
if(browser_nn6){
Menu._getCursorPos(ev);
showMenu("cHTcontextMenu");
}
}
if(!ISFREEZED){
cHTcontextMenuStatus=true;
}
}else{
Menu.cHTcontextMenu.cachedContent="";
}
}else{
Menu.cHTcontextMenu.cachedContent="";
var _19e0=getCursorPos(ev);
showMenu("cHTcontextMenu",{position:"absolute",top:_19e0.y,left:_19e0.x});
}
}
}else{
if(currContextMenuFor=="rHT"||currContextMenuFor=="rHT1"){
if(prevRowCnt!=_19d4){
rangeChanged=true;
prevRowCnt=_19d4;
}
if(!rHTcontextMenuStatus){
var _19de="<menu id='rHTcontextMenu' onLoad = 'contextLoad();' onUnload = 'contextUnLoad();' forElement='"+currContextMenuFor+"'>";
_19de+=" <item onclick='setRowHeight();return false;'><![CDATA["+jsMsg.RowHeight+"...]]></item>";
_19de+=" <item imgclass='sort_cust' ><![CDATA["+jsMsg.Sort+"]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item imgclass='sort_asc' onclick='sortheader(\"asc\");return false;'><![CDATA["+jsMsg.SortAscending+"]]></item>";
_19de+=" <item imgclass='sort_desc' onclick='sortheader(\"desc\");return false;'><![CDATA["+jsMsg.SortDescending+"]]></item>";
if(!jsGADGET_VIEW){
_19de+=" <item imgclass='sort_cust' onclick='constructSortDialog();return false;'><![CDATA["+jsMsg.CustomSort+"...]]></item>";
}
_19de+=" </menu></item>";
_19de+=" <sep></sep>";
_19de+=" <label imgclass='menuLabelBg'><![CDATA["+jsMsg.Insert+":]]></label>";
_19de+=" <item imgclass='mainBgImg insrow_above' onclick='Row.executeShiftOperation(\"INSERT\",\"above\");'><![CDATA["+replaceParams(jsMsg.NoofRowsAbove,new Array(""+_19d4+""))+"]]></item>";
_19de+=" <item imgclass='mainBgImg insrow_below' onclick='Row.executeShiftOperation(\"INSERT\",\"below\");'><![CDATA["+replaceParams(jsMsg.NoofRowsBelow,new Array(""+_19d4+""))+"]]></item>";
_19de+=" <item imgclass='mainBgImg insrow_above' onclick='Row.executeShiftOperation(\"INSERT_COPIED_ROWS\",\"above\");'><![CDATA["+jsMsg["Insert.Copied.Row.Above"]+"]]></item>";
_19de+=" <item imgclass='mainBgImg insrow_below' onclick='Row.executeShiftOperation(\"INSERT_COPIED_ROWS\",\"below\");'><![CDATA["+jsMsg["Insert.Copied.Row.Below"]+"]]></item>";
_19de+=" <item imgclass='mainBgImg insrow_above' onclick='Row.executeShiftOperation(\"INSERT_CUT_ROWS\",\"above\");closeDialog();'><![CDATA["+jsMsg["Insert.Cut.Row.Above"]+"]]></item>";
_19de+=" <item imgclass='mainBgImg insrow_below' onclick='Row.executeShiftOperation(\"INSERT_CUT_ROWS\",\"below\");closeDialog();'><![CDATA["+jsMsg["Insert.Cut.Row.Below"]+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item onclick='Row.executeShiftOperation(\"DELETE\")'><![CDATA["+replaceParams(jsMsg.DeleteNoofRows,new Array(""+_19d4+""))+"]]></item>";
_19de+=" <item onclick='deleteCell();closeDialog();return false;'><![CDATA["+jsMsg.ClearContents+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item imgclass='formatCells' onclick='showFormatCellsDialog();closeDialog();return false;' shortcut='Ctrl+Shift+1'><![CDATA["+jsMsg.FormatCells+"...]]></item>";
_19de+=" <item onclick='deleteCell(\"ClearStyles\");closeDialog();return false;'><![CDATA["+jsMsg.ClearFormatting+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item onclick='cutCells();closeDialog();setCutStatus();return false;' imgclass='cutIcon_contextmenu' shortcut='Ctrl+X'><![CDATA["+jsMsg.Cut+"]]></item>";
_19de+=" <item id='contextCopyRow' onclick='copyCells();closeDialog();setCopyStatus();return false;' imgclass='copyIcon_contextmenu' shortcut='Ctrl+C'><![CDATA["+jsMsg.Copy+"]]></item>";
_19de+=" <item onclick='copytoclip();return false;'><![CDATA["+jsMsg.CopyToClipboard+"]]></item>";
_19de+=" <item onclick='pasteCells();closeDialog();setPasteStatus();return false;' imgclass='pasteIcon_contextmenu' shortcut='Ctrl+V'><![CDATA["+jsMsg.Paste+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item imgclass='cellName' onclick='showNameDialog(\"add\");return false;' shortcut='Ctrl+F3'><![CDATA["+jsMsg.NamethisRange+"...]]></item>";
_19de+=" <item imgclass='cellName' onclick='showNameDialog(\"add\");return false;' shortcut='Ctrl+F3'><![CDATA["+jsMsg.NamethisCell+"...]]></item>";
if(jsSHARE_VIEW==false&&jsTRASH_VIEW==false&&jsGUEST_VIEW==false&&jsPUBLIC_VIEW==false&&jsREMOTE_VIEW==false&&jsTHROWAWAY_VIEW==false&&jsVERSION_VIEW==false&&jsREMOTE_SAVE_VIEW==false&&!HIDE_PUBLISH_OPTION){
if(zoid!=-1){
_19de+=" <item imgclass='publishIcon_contextmenu'><![CDATA["+jsMsg.PublishThisRangeIn+"...]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item onclick='rangePublish(\"org\", true);return false;'><![CDATA["+jsMsg.IntranetBlogSite+"]]></item>";
_19de+=" <item onclick='rangePublish(\"external\", true);return false;'><![CDATA["+jsMsg.ExternalBlogSite+"]]></item>";
_19de+=" </menu></item>";
}else{
_19de+=" <item imgclass='publishIcon_contextmenu' onclick='rangePublish(\"external\", true);return false;'><![CDATA["+jsMsg.PublishThisRange+"...]]></item>";
}
}
_19de+=" <sep></sep>";
_19de+=" <item imgclass='freezePanes' ><![CDATA["+_19db+"]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item imgclass='freezePanes' onclick='freeze()'><![CDATA["+_19db+"]]></item>";
_19de+=" <item imgclass='freezeTopRow' onclick='freezeTopRow();'><![CDATA["+jsMsg["FreezePanes.FreezeTopRow"]+"]]></item>";
_19de+=" <item imgclass='freezeFirstColumn' onclick='freezeFirstColumn();'><![CDATA["+jsMsg["FreezePanes.FreezeFirstColumn"]+"]]></item>";
_19de+=" </menu></item>";
_19de+=" <item imgclass='unfreezePanes' onclick='unFreezePanes()'><![CDATA["+_19dc+"]]></item>";
_19de+=" <item hidden='true' onclick='setCustomFormat()'><![CDATA["+jsMsg.FormatCells+"]]></item>";
_19de+="</menu>";
if(!browser_opera){
createContextMenu(_19de,{inputType:"xml"});
}else{
Menu.create(_19de,{inputType:"xml"});
}
}
Menu.rHTcontextMenu.data[19].hidden="true";
if(insertCopyRows||insertCutRows){
Menu.rHTcontextMenu.data[4].hidden="true";
Menu.rHTcontextMenu.data[5].hidden="true";
}else{
Menu.rHTcontextMenu.data[4].hidden="false";
Menu.rHTcontextMenu.data[5].hidden="false";
}
Menu.rHTcontextMenu.data[6].hidden=insertCopyRows?"false":"true";
Menu.rHTcontextMenu.data[7].hidden=insertCopyRows?"false":"true";
Menu.rHTcontextMenu.data[6].disabled=(insertCopyRows&&!isCopiedRowRangeHasFilteredRows)?"false":"true";
Menu.rHTcontextMenu.data[7].disabled=(insertCopyRows&&!isCopiedRowRangeHasFilteredRows)?"false":"true";
Menu.rHTcontextMenu.data[8].hidden=insertCutRows?"false":"true";
Menu.rHTcontextMenu.data[9].hidden=insertCutRows?"false":"true";
Menu.rHTcontextMenu.data[8].disabled=(insertCutRows&&!isCopiedRowRangeHasFilteredRows)?"false":"true";
Menu.rHTcontextMenu.data[9].disabled=(insertCutRows&&!isCopiedRowRangeHasFilteredRows)?"false":"true";
if(copyRangeEndRow-copyRangeStartRow==0){
if(insertCopyRows){
Menu.rHTcontextMenu.data[6].content=replace(jsMsg["Insert.Copied.Row.Above"],jsMsg["Insert.Copied.Rows.Above"]);
Menu.rHTcontextMenu.data[7].content=replace(jsMsg["Insert.Copied.Row.Below"],jsMsg["Insert.Copied.Rows.Below"]);
}
if(insertCutRows){
Menu.rHTcontextMenu.data[8].content=replace(jsMsg["Insert.Cut.Row.Above"],jsMsg["Insert.Cut.Rows.Above"]);
Menu.rHTcontextMenu.data[9].content=replace(jsMsg["Insert.Cut.Row.Below"],jsMsg["Insert.Cut.Rows.Below"]);
}
}else{
if(insertCopyRows){
Menu.rHTcontextMenu.data[6].content=replace(jsMsg["Insert.Copied.Rows.Above"],jsMsg["Insert.Copied.Row.Above"]);
Menu.rHTcontextMenu.data[7].content=replace(jsMsg["Insert.Copied.Rows.Below"],jsMsg["Insert.Copied.Row.Below"]);
}
if(insertCutRows){
Menu.rHTcontextMenu.data[8].content=replace(jsMsg["Insert.Cut.Rows.Above"],jsMsg["Insert.Cut.Row.Above"]);
Menu.rHTcontextMenu.data[9].content=replace(jsMsg["Insert.Cut.Rows.Below"],jsMsg["Insert.Cut.Row.Below"]);
}
}
if(copyStatus||cutStatus||(cellRangeFillDIV&&cellRangeFillDIV.style.display!="none")){
Menu.rHTcontextMenu.data[20].disabled="false";
}else{
Menu.rHTcontextMenu.data[20].disabled="true";
}
if(Menu.rHTcontextMenu.data.length>28){
if(jsGADGET_VIEW){
Menu.rHTcontextMenu.data[19].hidden="true";
Menu.rHTcontextMenu.data[21].hidden="true";
Menu.rHTcontextMenu.data[16].hidden="true";
Menu.rHTcontextMenu.data[25].hidden="true";
Menu.rHTcontextMenu.data[26].hidden="true";
Menu.rHTcontextMenu.data[27].hidden="true";
}else{
if(ISFREEZED){
Menu.rHTcontextMenu.data[26].hidden="true";
Menu.rHTcontextMenu.data[27].hidden="false";
}else{
Menu.rHTcontextMenu.data[27].hidden="true";
Menu.rHTcontextMenu.data[26].hidden="false";
}
}
}else{
if(jsGADGET_VIEW){
Menu.rHTcontextMenu.data[19].hidden="true";
Menu.rHTcontextMenu.data[21].hidden="true";
Menu.rHTcontextMenu.data[16].hidden="true";
Menu.rHTcontextMenu.data[24].hidden="true";
Menu.rHTcontextMenu.data[25].hidden="true";
Menu.rHTcontextMenu.data[26].hidden="true";
}else{
if(ISFREEZED){
Menu.rHTcontextMenu.data[25].hidden="true";
Menu.rHTcontextMenu.data[26].hidden="false";
}else{
Menu.rHTcontextMenu.data[26].hidden="true";
Menu.rHTcontextMenu.data[25].hidden="false";
}
}
}
if(jsGADGET_VIEW){
Menu.rHTcontextMenu.data[12].hidden="true";
Menu.rHTcontextMenu.data[13].hidden="true";
Menu.rHTcontextMenu.data[14].hidden="true";
Menu.rHTcontextMenu.data[15].hidden="true";
Menu.rHTcontextMenu.data[17].hidden="true";
Menu.rHTcontextMenu.data[18].hidden="true";
Menu.rHTcontextMenu.data[20].hidden="true";
}
if(rangeChanged){
if(!jsGADGET_VIEW){
if(_19d2){
Menu.rHTcontextMenu.data[22].hidden="false";
Menu.rHTcontextMenu.data[23].hidden="true";
}else{
Menu.rHTcontextMenu.data[22].hidden="true";
Menu.rHTcontextMenu.data[23].hidden="false";
}
}else{
Menu.rHTcontextMenu.data[22].hidden="true";
Menu.rHTcontextMenu.data[23].hidden="true";
Menu.rHTcontextMenu.data[24].hidden="true";
}
if(_19d4>1){
Menu.rHTcontextMenu.data[4].content=replaceParams(jsMsg.NoofRowsAbove,new Array(""+_19d4+""));
Menu.rHTcontextMenu.data[5].content=replaceParams(jsMsg.NoofRowsBelow,new Array(""+_19d4+""));
Menu.rHTcontextMenu.data[11].content=replaceParams(jsMsg.DeleteNoofRows,new Array(""+_19d4+""));
}else{
Menu.rHTcontextMenu.data[4].content=jsMsg.RowAbove;
Menu.rHTcontextMenu.data[5].content=jsMsg.RowBelow;
Menu.rHTcontextMenu.data[11].content=jsMsg.DeleteRow;
}
if(!browser_opera){
if(!rHTcontextMenuStatus){
if(browser_ie){
Menu._getCursorPos();
showMenu("rHTcontextMenu");
}else{
if(browser_nn6){
Menu._getCursorPos(ev);
showMenu("rHTcontextMenu");
}
}
if(!ISFREEZED){
rHTcontextMenuStatus=true;
}
}else{
Menu.rHTcontextMenu.cachedContent="";
}
}else{
Menu.rHTcontextMenu.cachedContent="";
var _19e0=getCursorPos(ev);
showMenu("rHTcontextMenu",{position:"absolute",top:_19e0.y,left:_19e0.x});
}
}
}else{
if(isFocusDIV(currContextMenuFor)||(browser_opera&&currContextMenuFor=="tS")){
if(reservedContextMenuInfo.prevRowIdx!=_19d6||reservedContextMenuInfo.prevColIdx!=_19d7){
reservedContextMenuInfo.prevRowIdx=_19d6;
reservedContextMenuInfo.prevColIdx=_19d7;
rangeChanged=true;
contextMenuStatus=false;
}
if(!contextMenuStatus){
var _19de="<menu id='contextMenu' onLoad = 'contextLoad();' onUnload = 'contextUnLoad();'"+_19dd+">";
_19de+=" <item onclick='cutCells();closeDialog();setCutStatus();return false;' imgclass='cutIcon_contextmenu' shortcut='Ctrl+X'><![CDATA["+jsMsg.Cut+"]]></item>";
_19de+=" <item id='contextCopyRow' onclick='copyCells();closeDialog();setCopyStatus();return false;' imgclass='copyIcon_contextmenu' shortcut='Ctrl+C'><![CDATA["+jsMsg.Copy+"]]></item>";
_19de+=" <item onclick='copytoclip(\"Link\");return false;'><![CDATA["+jsMsg.CopyEmailAddress+"]]></item>";
_19de+=" <item onclick='copytoclip(\"Link\");return false;'><![CDATA["+jsMsg.CopyLinkLocation+"]]></item>";
_19de+=" <item onclick='copytoclip();return false;'><![CDATA["+jsMsg.CopyToClipboard+"]]></item>";
_19de+=" <item onclick='pasteCells();closeDialog();setPasteStatus();return false;' imgclass='pasteIcon_contextmenu' shortcut='Ctrl+V'><![CDATA["+jsMsg.Paste+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item onclick='cellwrap();return false;' imgclass='wrapText'><![CDATA["+jsMsg.WrapText+"]]></item>";
_19de+=" <item onclick='showHyperlink(\"add\");return false;' imgclass='mainBgImg hyperlinkIcon_contextmenu' shortcut='Ctrl+K'><![CDATA["+jsMsg.Hyperlink+"...]]></item>";
_19de+=" <item onclick='showHyperlink(\"edit\");return false' shortcut='Ctrl+K'><![CDATA["+jsMsg.EditHyperlink+"...]]></item>";
_19de+=" <item onclick='setHyperlink(\"remove\");return false;'><![CDATA["+jsMsg.RemoveHyperlink+"]]></item>";
_19de+=" <item onclick='pickFromList();return false;' shortcut='Alt+Down'><![CDATA["+jsMsg.PickFromList+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item imgclass='insert_row_below'><![CDATA["+jsMsg["GridContextMenu.Insert"]+"]]><menu onBeforeUnload='menuClose(ev)'>";
_19de+=" <item onclick='Row.executeShiftOperation(\"INSERT\", \"above\");'><![CDATA["+replaceParams(jsMsg.NoofRowsAbove,new Array(""+_19d4+""))+"]]></item>";
_19de+=" <item onclick='Row.executeShiftOperation(\"INSERT\",\"below\");'><![CDATA["+replaceParams(jsMsg.NoofRowsBelow,new Array(""+_19d4+""))+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item onclick='insertCol(\"before\","+_19d7+","+_19d5+");' imgclass='insert_col_before'><![CDATA["+replaceParams(jsMsg.NoofColumnsBefore,new Array(""+_19d5+""))+"]]></item>";
_19de+=" <item onclick='insertCol(\"after\","+(_19d7+_19d5)+","+_19d5+");' imgclass='insert_col_after'><![CDATA["+replaceParams(jsMsg.NoofColumnsAfter,new Array(""+_19d5+""))+"]]></item>";
_19de+=" </menu></item>";
_19de+=" <item imgclass='delete_row'><![CDATA["+jsMsg["GridContextMenu.Delete"]+"]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item onclick='Row.executeShiftOperation(\"DELETE\");'><![CDATA["+replaceParams(jsMsg.NoofRows,new Array(""+_19d4+""))+"]]></item>";
_19de+=" <item onclick='deleteCol();'><![CDATA["+replaceParams(jsMsg.NoofColumns,new Array(""+_19d5+""))+"]]></item>";
_19de+=" </menu></item>";
_19de+=" <sep></sep>";
_19de+=" <item imgclass='formatCells' onclick='showFormatCellsDialog();closeDialog();return false;'  shortcut='Ctrl+Shift+1'><![CDATA["+jsMsg.FormatCells+"...]]></item>";
_19de+=" <item onclick='deleteCell();closeDialog();return false;'><![CDATA["+jsMsg.ClearContents+"]]></item>";
_19de+=" <item onclick='deleteCell(\"ClearStyles\");closeDialog();return false;'><![CDATA["+jsMsg.ClearFormatting+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item imgclass='sort_cust' ><![CDATA["+jsMsg.Sort+"]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item imgclass='sort_asc' onclick='sortheader(\"asc\");return false;'><![CDATA["+jsMsg.SortAscending+"]]></item>";
_19de+=" <item imgclass='sort_desc' onclick='sortheader(\"desc\");return false;'><![CDATA["+jsMsg.SortDescending+"]]></item>";
if(!jsGADGET_VIEW){
_19de+=" <item imgclass='sort_cust' onclick='constructSortDialog();return false;'><![CDATA["+jsMsg.CustomSort+"...]]></item>";
}
_19de+=" </menu></item>";
_19de+=" <item onclick='showCommentDialog(\"edit\");return false;' imgclass='editCmntIcon_contextmenu' shortcut='Shift+F2'><![CDATA["+jsMsg.EditComment+"...]]></item>";
_19de+=" <item onclick='commentaction(\"remove\");return false;' imgclass='rmvCmntIcon_contextmenu'><![CDATA["+jsMsg.RemoveComment+"]]></item>";
_19de+=" <item onclick='showCommentDialog(\"add\");return false;' imgclass='insrtCmntIcon_contextmenu' shortcut='Shift+F2'><![CDATA["+jsMsg.InsertComment+"...]]></item>";
_19de+=" <item imgclass='cellName' onclick='showNameDialog(\"add\");return false;' shortcut='Ctrl+F3'><![CDATA["+jsMsg.NamethisRange+"...]]></item>";
_19de+=" <item imgclass='cellName' onclick='showNameDialog(\"add\");return false;' shortcut='Ctrl+F3'><![CDATA["+jsMsg.NamethisCell+"...]]></item>";
_19de+=" <item onclick='showNameDialog(\"view\");return false;' shortcut='Ctrl+F3'><![CDATA["+jsMsg.ViewDefinedNames+"...]]></item>";
if(jsSHARE_VIEW==false&&jsTRASH_VIEW==false&&jsGUEST_VIEW==false&&jsPUBLIC_VIEW==false&&jsREMOTE_VIEW==false&&jsTHROWAWAY_VIEW==false&&jsVERSION_VIEW==false&&jsREMOTE_SAVE_VIEW==false&&!HIDE_PUBLISH_OPTION){
if(zoid!=-1){
_19de+=" <item imgclass='publishIcon_contextmenu'><![CDATA["+jsMsg.PublishThisRangeIn+"]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item onclick='rangePublish(\"org\", true);return false;'><![CDATA["+jsMsg.IntranetBlogSite+"]]></item>";
_19de+=" <item onclick='rangePublish(\"external\", true);return false;'><![CDATA["+jsMsg.ExternalBlogSite+"]]></item>";
_19de+=" </menu></item>";
}else{
_19de+=" <item imgclass='publishIcon_contextmenu' onclick='rangePublish(\"external\", true);return false;'><![CDATA["+jsMsg.PublishThisRange+"...]]></item>";
}
}
_19de+=" <sep></sep>";
_19de+=" <item imgclass='freezePanes'><![CDATA["+_19db+"]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item imgclass='freezePanes' onclick='freeze()'><![CDATA["+_19db+"]]></item>";
_19de+=" <item imgclass='freezeTopRow' onclick='freezeTopRow();'><![CDATA["+jsMsg["FreezePanes.FreezeTopRow"]+"]]></item>";
_19de+=" <item imgclass='freezeFirstColumn' onclick='freezeFirstColumn();'><![CDATA["+jsMsg["FreezePanes.FreezeFirstColumn"]+"]]></item>";
_19de+=" </menu></item>";
_19de+=" <item imgclass='unfreezePanes' onclick='unFreezePanes()'><![CDATA["+_19dc+"]]></item>";
_19de+=" <item hidden='true' onclick='setCustomFormat()'><![CDATA["+jsMsg.FormatCells+"]]></item>";
_19de+="</menu>";
if(!browser_opera){
createContextMenu(_19de,{inputType:"xml"});
}else{
Menu.create(_19de,{inputType:"xml"});
}
}
rangeChanged=true;
if(rangeChanged){
var _19e1;
for(_19e1=0;_19e1<Menu.contextMenu.data.length;_19e1++){
Menu.contextMenu.data[_19e1].hidden="true";
}
if(copyStatus||cutStatus||(cellRangeFillDIV&&cellRangeFillDIV.style.display!="none")){
Menu.contextMenu.data[5].disabled="false";
}else{
Menu.contextMenu.data[5].disabled="true";
}
Menu.contextMenu.data[0].hidden="false";
Menu.contextMenu.data[1].hidden="false";
Menu.contextMenu.data[4].hidden="true";
Menu.contextMenu.data[5].hidden="false";
Menu.contextMenu.data[6].hidden="false";
Menu.contextMenu.data[7].hidden="false";
Menu.contextMenu.data[11].hidden="false";
Menu.contextMenu.data[12].hidden="false";
Menu.contextMenu.data[13].hidden="false";
Menu.contextMenu.data[14].hidden="false";
Menu.contextMenu.data[15].hidden="false";
Menu.contextMenu.data[16].hidden="false";
Menu.contextMenu.data[17].hidden="false";
Menu.contextMenu.data[18].hidden="false";
Menu.contextMenu.data[19].hidden="false";
if(Menu.contextMenu.data[27]){
Menu.contextMenu.data[27].hidden="false";
}
if(_19d9){
Menu.contextMenu.data[21].hidden="false";
Menu.contextMenu.data[22].hidden="false";
}else{
Menu.contextMenu.data[23].hidden="false";
}
if((jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW)&&NAMEDRANGES.length>0){
Menu.contextMenu.data[25].hidden="false";
}
if(_19d2){
if(!jsGADGET_VIEW){
Menu.contextMenu.data[25].hidden="true";
Menu.contextMenu.data[24].hidden="false";
}
Menu.contextMenu.data[20].hidden="false";
Menu.contextMenu.data[10].hidden="true";
}else{
if(!jsGADGET_VIEW){
Menu.contextMenu.data[25].hidden="false";
Menu.contextMenu.data[24].hidden="true";
}
if(_19da==null){
Menu.contextMenu.data[8].hidden="false";
}else{
if(_19da=="full"){
Menu.contextMenu.data[9].hidden="false";
var value=getHyperLinkInCell(currCell).childTag.href;
if(value.indexOf("mailto:")>-1&&value.length>7){
Menu.contextMenu.data[2].hidden="false";
}else{
Menu.contextMenu.data[3].hidden="false";
}
}
}
if(_19da=="multi"||_19da=="full"){
Menu.contextMenu.data[10].hidden="false";
}
}
var _19e3=Menu.contextMenu.data[13].subMenu;
var _19e4=Menu.contextMenu.data[14].subMenu;
if(_19d4>1){
_19e3[0].content=replaceParams(jsMsg.NoofRowsAbove,new Array(""+_19d4+""));
_19e3[1].content=replaceParams(jsMsg.NoofRowsBelow,new Array(""+_19d4+""));
_19e4[0].content=replaceParams(jsMsg.NoofRows,new Array(""+_19d4+""));
}else{
_19e3[0].content=jsMsg.RowAbove;
_19e3[1].content=jsMsg.RowBelow;
_19e4[0].content=jsMsg["Sheet.Row"];
}
if(_19d5>1){
_19e3[3].content=replaceParams(jsMsg.NoofColumnsBefore,new Array(""+_19d5+""));
_19e3[4].content=replaceParams(jsMsg.NoofColumnsAfter,new Array(""+_19d5+""));
_19e4[1].content=replaceParams(jsMsg.NoofColumns,new Array(""+_19d5+""));
}else{
_19e3[3].content=jsMsg.ColumnBefore;
_19e3[4].content=jsMsg.ColumnAfter;
_19e4[1].content=jsMsg["Sheet.Column"];
}
Menu.contextMenu.data[13].cachedContent="";
Menu.contextMenu.data[14].cachedContent="";
_19e3=_19e4=null;
if(jsGADGET_VIEW){
Menu.contextMenu.data[4].hidden="true";
Menu.contextMenu.data[7].hidden="true";
Menu.contextMenu.data[8].hidden="true";
Menu.contextMenu.data[9].hidden="true";
Menu.contextMenu.data[10].hidden="true";
Menu.contextMenu.data[11].hidden="true";
Menu.contextMenu.data[12].hidden="true";
Menu.contextMenu.data[16].hidden="true";
if(!_19d2){
Menu.contextMenu.data[19].hidden="true";
}
Menu.contextMenu.data[21].hidden="true";
Menu.contextMenu.data[22].hidden="true";
Menu.contextMenu.data[23].hidden="true";
}
if(Menu.contextMenu.data.length>31){
Menu.contextMenu.data[28].hidden="false";
Menu.contextMenu.data[29].hidden="false";
Menu.contextMenu.data[30].hidden="false";
if(jsGADGET_VIEW){
Menu.contextMenu.data[28].hidden="true";
Menu.contextMenu.data[29].hidden="true";
Menu.contextMenu.data[30].hidden="true";
}else{
if(ISFREEZED){
Menu.contextMenu.data[29].hidden="true";
}else{
Menu.contextMenu.data[30].hidden="true";
}
}
}else{
Menu.contextMenu.data[27].hidden="false";
Menu.contextMenu.data[28].hidden="false";
Menu.contextMenu.data[29].hidden="false";
if(jsGADGET_VIEW){
Menu.contextMenu.data[27].hidden="true";
Menu.contextMenu.data[28].hidden="true";
Menu.contextMenu.data[29].hidden="true";
}else{
if(ISFREEZED){
Menu.contextMenu.data[28].hidden="true";
}else{
Menu.contextMenu.data[29].hidden="true";
}
}
}
if(!browser_opera){
if(!contextMenuStatus){
if(browser_ie){
Menu._getCursorPos();
showMenu("contextMenu");
}else{
if(browser_nn6){
Menu._getCursorPos(ev);
showMenu("contextMenu");
}
}
if(!ISFREEZED){
contextMenuStatus=true;
}
}else{
Menu.contextMenu.cachedContent="";
}
}else{
if(currContextMenuFor=="fD"||(browser_opera&&currContextMenuFor=="tS")){
contextMenuStatus=true;
}else{
if(currContextMenuFor=="fD1"){
contextMenuStatusFD1=true;
}else{
if(currContextMenuFor=="fD2"){
contextMenuStatusFD2=true;
}else{
if(currContextMenuFor=="fD3"){
contextMenuStatusFD3=true;
}
}
}
}
Menu.contextMenu.cachedContent="";
var _19e0=getCursorPos(ev);
showMenu("contextMenu",{position:"absolute",top:_19e0.y,left:_19e0.x});
}
}
}else{
if(currContextMenuFor=="sT"||currContextMenuFor=="sheet"){
if(!sTcontextMenuStatus){
var _19de="<menu id='sTcontextMenu'  onLoad = 'contextLoad();' onUnload = 'contextUnLoad();' forElement='"+currContextMenuFor+"'>";
_19de+=" <item onclick='cutCells();closeDialog();setCutStatus();return false;' imgclass='cutIcon_contextmenu' shortcut='Ctrl+X'><![CDATA["+jsMsg.Cut+"]]></item>";
_19de+=" <item id='contextCopyRow' onclick='copyCells();closeDialog();setCopyStatus();return false;' imgclass='copyIcon_contextmenu' shortcut='Ctrl+C'><![CDATA["+jsMsg.Copy+"]]></item>";
_19de+=" <item onclick='copytoclip(\"Link\");return false;'><![CDATA["+jsMsg.CopyEmailAddress+"]]></item>";
_19de+=" <item onclick='copytoclip(\"Link\");return false;'><![CDATA["+jsMsg.CopyLinkLocation+"]]></item>";
_19de+=" <item onclick='copytoclip();return false;'><![CDATA["+jsMsg.CopyToClipboard+"]]></item>";
_19de+=" <item onclick='pasteCells();closeDialog();setPasteStatus();return false;' imgclass='pasteIcon_contextmenu' shortcut='Ctrl+V'><![CDATA["+jsMsg.Paste+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item onclick='cellwrap();return false;'><![CDATA["+jsMsg.WrapText+"]]></item>";
_19de+=" <item onclick='showHyperlink(\"add\");return false;' imgclass='mainBgImg hyperlinkIcon_contextmenu' shortcut='Ctrl+K'><![CDATA["+jsMsg.Hyperlink+"...]]></item>";
_19de+=" <item onclick='showHyperlink(\"edit\");return false' shortcut='Ctrl+K'><![CDATA["+jsMsg.EditHyperlink+"...]]></item>";
_19de+=" <item onclick='setHyperlink(\"remove\");return false;'><![CDATA["+jsMsg.RemoveHyperlink+"]]></item>";
_19de+=" <item onclick='pickFromList();return false;' shortcut='Alt+Down'><![CDATA["+jsMsg.PickFromList+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item><![CDATA["+jsMsg.Insert+"]]><menu onBeforeUnload='menuClose(ev)'>";
_19de+=" <item imgclass='mainBgImg insrow_above' onclick='Row.executeShiftOperation(\"INSERT\",\"above\");'><![CDATA["+replaceParams(jsMsg.NoofRowsAbove,new Array(""+_19d4+""))+"]]></item>";
_19de+=" <item imgclass='mainBgImg insrow_below' onclick='Row.executeShiftOperation(\"INSERT\",\"below\");'><![CDATA["+replaceParams(jsMsg.NoofRowsBelow,new Array(""+_19d4+""))+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item imgclass='mainBgImg inscol_before'  onclick='insertCol(\"before\");'><![CDATA["+replaceParams(jsMsg.NoofColumnsBefore,new Array(""+_19d5+""))+"]]></item>";
_19de+=" <item  imgclass='mainBgImg inscol_after' onclick='insertCol(\"after\");'><![CDATA["+replaceParams(jsMsg.NoofColumnsAfter,new Array(""+_19d5+""))+"]]></item>";
_19de+=" </menu></item>";
_19de+=" <sep></sep>";
_19de+=" <item><![CDATA["+jsMsg.Delete+"]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item onclick='Row.executeShiftOperation(\"DELETE\");'><![CDATA["+replaceParams(jsMsg.NoofRows,new Array(""+_19d4+""))+"]]></item>";
_19de+=" <item onclick='deleteCol();'><![CDATA["+replaceParams(jsMsg.NoofColumns,new Array(""+_19d5+""))+"]]></item>";
_19de+=" </menu></item>";
_19de+=" <item onclick='deleteCell();closeDialog();return false;'><![CDATA["+jsMsg.ClearContents+"]]></item>";
_19de+=" <item onclick='deleteCell(\"ClearStyles\");closeDialog();return false;'><![CDATA["+jsMsg.ClearFormatting+"]]></item>";
_19de+=" <sep></sep>";
_19de+=" <item imgclass='sort_cust' ><![CDATA["+jsMsg.Sort+"]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item imgclass='sort_asc' onclick='sortheader(\"asc\");return false;'><![CDATA["+jsMsg.SortAscending+"]]></item>";
_19de+=" <item imgclass='sort_desc' onclick='sortheader(\"desc\");return false;'><![CDATA["+jsMsg.SortDescending+"]]></item>";
if(!jsGADGET_VIEW){
_19de+=" <item imgclass='sort_cust' onclick='constructSortDialog();return false;'><![CDATA["+jsMsg.CustomSort+"...]]></item>";
}
_19de+=" </menu></item>";
_19de+=" <item onclick='showCommentDialog(\"edit\");return false;' imgclass='editCmntIcon_contextmenu' shortcut='Shift+F2'><![CDATA["+jsMsg.EditComment+"...]]></item>";
_19de+=" <item onclick='commentaction(\"remove\");return false;' imgclass='rmvCmntIcon_contextmenu'><![CDATA["+jsMsg.RemoveComment+"]]></item>";
_19de+=" <item onclick='showCommentDialog(\"add\");return false;' imgclass='insrtCmntIcon_contextmenu' shortcut='Shift+F2'><![CDATA["+jsMsg.InsertComment+"...]]></item>";
_19de+=" <item imgclass='cellName' onclick='showNameDialog(\"add\");return false;' shortcut='Ctrl+F3'><![CDATA["+jsMsg.NamethisRange+"...]]></item>";
_19de+=" <item imgclass='cellName' onclick='showNameDialog(\"add\");return false;' shortcut='Ctrl+F3'><![CDATA["+jsMsg.NamethisCell+"...]]></item>";
_19de+=" <item onclick='showNameDialog(\"view\");return false;' shortcut='Ctrl+F3'><![CDATA["+jsMsg.ViewDefinedNames+"...]]></item>";
if(jsSHARE_VIEW==false&&jsTRASH_VIEW==false&&jsGUEST_VIEW==false&&jsPUBLIC_VIEW==false&&jsREMOTE_VIEW==false&&jsTHROWAWAY_VIEW==false&&jsVERSION_VIEW==false&&jsREMOTE_SAVE_VIEW==false&&!HIDE_PUBLISH_OPTION){
if(zoid!=-1){
_19de+=" <item imgclass='publishIcon_contextmenu'><![CDATA["+jsMsg.PublishThisRangeIn+"...]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item onclick='rangePublish(\"org\", true);return false;'><![CDATA["+jsMsg.IntranetBlogSite+"]]></item>";
_19de+=" <item onclick='rangePublish(\"external\", true);return false;'><![CDATA["+jsMsg.ExternalBlogSite+"]]></item>";
_19de+=" </menu></item>";
}else{
_19de+=" <item imgclass='publishIcon_contextmenu' onclick='rangePublish(\"external\", true);return false;'><![CDATA["+jsMsg.PublishThisRange+"...]]></item>";
}
}
_19de+=" <sep></sep>";
_19de+=" <item imgclass='freezePanes' ><![CDATA["+_19db+"]]><menu  onBeforeUnload='menuClose(ev)'>";
_19de+=" <item imgclass='freezePanes' onclick='freeze()'><![CDATA["+_19db+"]]></item>";
_19de+=" <item imgclass='freezeTopRow' onclick='freezeTopRow();'><![CDATA["+jsMsg["FreezePanes.FreezeTopRow"]+"]]></item>";
_19de+=" <item imgclass='freezeFirstColumn' onclick='freezeFirstColumn();'><![CDATA["+jsMsg["FreezePanes.FreezeFirstColumn"]+"]]></item>";
_19de+=" </menu></item>";
_19de+=" <item imgclass='unfreezePanes' onclick='unFreezePanes()'><![CDATA["+_19dc+"]]></item>";
_19de+=" <item hidden='true' onclick='setCustomFormat()'><![CDATA["+jsMsg.FormatCells+"]]></item>";
_19de+="</menu>";
if(!browser_opera){
createContextMenu(_19de,{inputType:"xml"});
}else{
Menu.create(_19de,{inputType:"xml"});
}
sTcontextMenuStatus=true;
}
rangeChanged=true;
if(rangeChanged){
var _19e1;
for(_19e1=0;_19e1<Menu.sTcontextMenu.data.length;_19e1++){
Menu.sTcontextMenu.data[_19e1].hidden="true";
}
if(copyStatus||cutStatus||(cellRangeFillDIV&&cellRangeFillDIV.style.display!="none")){
Menu.sTcontextMenu.data[5].disabled="false";
}else{
Menu.sTcontextMenu.data[5].disabled="true";
}
Menu.sTcontextMenu.data[0].hidden="false";
Menu.sTcontextMenu.data[1].hidden="false";
Menu.sTcontextMenu.data[4].hidden="true";
Menu.sTcontextMenu.data[5].hidden="false";
Menu.sTcontextMenu.data[6].hidden="false";
Menu.sTcontextMenu.data[7].hidden="false";
Menu.sTcontextMenu.data[11].hidden="false";
Menu.sTcontextMenu.data[12].hidden="false";
Menu.sTcontextMenu.data[13].hidden="false";
Menu.sTcontextMenu.data[14].hidden="false";
Menu.sTcontextMenu.data[15].hidden="false";
Menu.sTcontextMenu.data[16].hidden="false";
Menu.sTcontextMenu.data[17].hidden="false";
Menu.sTcontextMenu.data[18].hidden="false";
if(Menu.sTcontextMenu.data[26]){
Menu.sTcontextMenu.data[26].hidden="false";
}
if(_19d9){
Menu.sTcontextMenu.data[20].hidden="false";
Menu.sTcontextMenu.data[21].hidden="false";
}else{
Menu.sTcontextMenu.data[22].hidden="false";
}
if((jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW)&&NAMEDRANGES.length>0){
Menu.sTcontextMenu.data[25].hidden="false";
}
if(_19d2){
if(!jsGADGET_VIEW){
Menu.sTcontextMenu.data[23].hidden="false";
}
Menu.sTcontextMenu.data[19].hidden="false";
Menu.sTcontextMenu.data[10].hidden="false";
}else{
if(!jsGADGET_VIEW){
Menu.sTcontextMenu.data[24].hidden="false";
}
if(_19da==null){
Menu.sTcontextMenu.data[8].hidden="false";
}else{
if(_19da=="full"){
Menu.sTcontextMenu.data[9].hidden="false";
var value=getHyperLinkInCell(currCell).childTag.href;
if(value.indexOf("mailto:")>-1&&value.length>7){
Menu.sTcontextMenu.data[2].hidden="false";
}else{
Menu.sTcontextMenu.data[3].hidden="false";
}
}
}
if(_19da=="multi"||_19da=="full"){
Menu.sTcontextMenu.data[10].hidden="false";
}
}
var _19e3=Menu.sTcontextMenu.data[13].subMenu;
var _19e4=Menu.sTcontextMenu.data[15].subMenu;
if(_19d4>1){
_19e3[0].content=replaceParams(jsMsg.NoofRowsAbove,new Array(""+_19d4+""));
_19e3[1].content=replaceParams(jsMsg.NoofRowsBelow,new Array(""+_19d4+""));
_19e4[0].content=replaceParams(jsMsg.NoofRows,new Array(""+_19d4+""));
}else{
_19e3[0].content=jsMsg.RowAbove;
_19e3[1].content=jsMsg.RowBelow;
_19e4[0].content=jsMsg["Sheet.Row"];
}
if(_19d5>1){
_19e3[3].content=replaceParams(jsMsg.NoofColumnsBefore,new Array(""+_19d5+""));
_19e3[4].content=replaceParams(jsMsg.NoofColumnsAfter,new Array(""+_19d5+""));
_19e4[1].content=replaceParams(jsMsg.NoofColumns,new Array(""+_19d5+""));
}else{
_19e3[3].content=jsMsg.ColumnBefore;
_19e3[4].content=jsMsg.ColumnAfter;
_19e4[1].content=jsMsg["Sheet.Column"];
}
Menu.sTcontextMenu.data[13].cachedContent="";
Menu.sTcontextMenu.data[15].cachedContent="";
_19e3=_19e4=null;
if(jsGADGET_VIEW){
Menu.sTcontextMenu.data[4].hidden="true";
Menu.sTcontextMenu.data[7].hidden="true";
Menu.sTcontextMenu.data[8].hidden="true";
Menu.sTcontextMenu.data[9].hidden="true";
Menu.sTcontextMenu.data[10].hidden="true";
Menu.sTcontextMenu.data[11].hidden="true";
Menu.sTcontextMenu.data[12].hidden="true";
if(!_19d2){
Menu.contextMenu.data[18].hidden="true";
}
Menu.sTcontextMenu.data[20].hidden="true";
Menu.sTcontextMenu.data[21].hidden="true";
Menu.sTcontextMenu.data[22].hidden="true";
}
if(Menu.sTcontextMenu.data.length>30){
Menu.sTcontextMenu.data[27].hidden="false";
Menu.sTcontextMenu.data[28].hidden="false";
Menu.sTcontextMenu.data[29].hidden="false";
if(jsGADGET_VIEW){
Menu.sTcontextMenu.data[27].hidden="true";
Menu.sTcontextMenu.data[28].hidden="true";
Menu.sTcontextMenu.data[29].hidden="true";
}else{
if(ISFREEZED){
Menu.sTcontextMenu.data[28].hidden="true";
}else{
Menu.sTcontextMenu.data[29].hidden="true";
}
}
}else{
Menu.sTcontextMenu.data[26].hidden="false";
Menu.sTcontextMenu.data[27].hidden="false";
Menu.sTcontextMenu.data[28].hidden="false";
if(jsGADGET_VIEW){
Menu.sTcontextMenu.data[26].hidden="true";
Menu.sTcontextMenu.data[27].hidden="true";
Menu.sTcontextMenu.data[28].hidden="true";
}else{
if(ISFREEZED){
Menu.sTcontextMenu.data[27].hidden="true";
}else{
Menu.sTcontextMenu.data[28].hidden="true";
}
}
}
if(!browser_opera){
if(!sTcontextMenuStatus){
if(browser_ie){
Menu._getCursorPos();
showMenu("sTcontextMenu");
}else{
if(browser_nn6){
Menu._getCursorPos(ev);
showMenu("sTcontextMenu");
}
}
if(!ISFREEZED){
sTcontextMenuStatus=true;
}
}else{
Menu.sTcontextMenu.cachedContent="";
}
}else{
sTcontextMenuStatus=true;
Menu.sTcontextMenu.cachedContent="";
var _19e0=getCursorPos(ev);
showMenu("sTcontextMenu",{position:"absolute",top:_19e0.y,left:_19e0.x});
}
}
}
}
}
}
stopEvt(ev);
}
function cellwrap(){
wraptext("wraptext");
}
function sortvalues(nvp,_19e6){
var _19e7=getCellRange();
var _19e8=_19e7.startRow;
var _19e9=_19e7.startCol;
var endR=_19e7.endRow;
var endC=_19e7.endCol;
if(containsAnyArray(_19e8,_19e9,endR,endC)||isPartOfArray(_19e8,_19e9,endR,endC)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
if(typeof _19e6=="undefined"){
_19e6="false";
}
loadon();
var _19ec=new getXmlhttp();
_19ec.onreadystatechange=function(){
if(_19ec.readyState==4){
gridListener.listen(8);
noOfUpdateRequestInProgress--;
if(_19ec.responseText==showErrorPanelMsg){
handleServerError("ERROR",_19ec.responseText,true);
}else{
if(ISSAMESHEET=="true"){
var _19ed=_19ec.responseXML;
var _19ee=_19ec.status;
var _19ef=_19ec.statusText;
updateCell(_19ed,_19ee,_19ef);
}
if(READ_WRITE){
btn_enabled();
}
ISSAMESHEET="true";
}
closeDialog();
loadoff();
}
};
var _19f0=getAvailableStartRow();
var _19f1=getAvailableEndRow();
nvp+="&readwrite="+ALLOW_TO_WRITE+"&viewType="+getViewType()+"&isDocSaved="+isDocSaved()+"&availableStartRow="+_19f0+"&availableEndRow="+_19f1+"&isColSelected="+isColSelected();
nvp=appendCSRFToURL(nvp);
if(jsREMOTE_SAVE_VIEW){
nvp+="&RMLOGINNAME="+RMUSER;
nvp+="&userStateId="+USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _19f2=getObj("apiKey");
if(_19f2!=null){
nvp+="&apiKeyId="+_19f2.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols;
postAjax(_19ec,ctxpath+"sort.do",nvp);
noOfUpdateRequestInProgress++;
}
function sort1(_19f3,_19f4){
var _19f5=false;
if(getObj("toptobottom").checked){
_19f5=false;
}else{
_19f5=true;
}
var _19f6=false;
if(getObj("containsheader").checked){
_19f6=true;
}
var _19f7=false;
if(_19f5){
if(getObj("DD_row_0").value==""){
_19f7=true;
}
}else{
if(_19f6){
if(getObj("DD_column_header_0").value==""){
_19f7=true;
}
}else{
if(getObj("DD_column_0").value==""){
_19f7=true;
}
}
}
if(_19f7){
showAlertDialog(jsTitleMsg.SortByBoxShouldNotBlank);
return;
}
var ddID="DD_column";
if(_19f6){
ddID="DD_column_header";
}
var ascID="asc_col";
if(_19f5){
ddID="DD_row";
ascID="asc_row";
}
var _19fa=getCellRange();
var _19fb=_19fa.startRow;
var _19fc=_19fa.startCol;
var endR=_19fa.endRow;
var endC=_19fa.endCol;
var nvp="startColumn="+_19fc+"&endColumn="+endC+"&startRow="+_19fb+"&endRow="+endR;
nvp+="&currentTime="+CURRENTTIME+"&currentSheet="+encodeURIComponent(CURRSHEETNAME)+"&documentId="+DOCUMENT_ID;
var _1a00="FALSE";
if(_19f6&&!_19f5){
_1a00="TRUE";
}
var _1a01="FALSE";
if(getObj("sensitive").checked){
_1a01="TRUE";
}
if(_19f5){
_19f5="TRUE";
}else{
_19f5="FALSE";
}
nvp+="&isSortColumns="+_19f5;
nvp+="&containsHeader="+_1a00;
nvp+="&sensitive="+_1a01;
nvp+="&numberofColumns="+_19f3;
var _1a02="";
var _1a03="";
for(var i=0;i<_19f3;i++){
if(i>2){
break;
}
var index=-1;
var val=getObj(ddID+"_"+i).value;
if(val==""){
_1a03+="&field"+i+"="+index;
}else{
index=getIndex(_19f4,val);
_1a03+="&field"+i+"="+index;
}
var asc="FALSE";
if(getObj(ascID+"_"+i).checked){
asc="TRUE";
}
_1a02+="&sortorder"+i+"="+asc;
}
nvp+=_1a03;
nvp+=_1a02;
var _1a08="false";
nvp+="&afterRTC="+_1a08+"&collabId="+COLLAB_ID+"&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&documentOwner="+CURR_DOC_OWNERNAME+"&subActionMode=custom";
sortvalues(nvp);
closeDialog();
}
function sortheader(order){
if(isCellRange()){
var _1a0a=getCellRange();
var _1a0b=_1a0a.startRow;
var _1a0c=_1a0a.startCol;
var endR=_1a0a.endRow;
var endC=_1a0a.endCol;
var _1a0f=false;
_1a0f=checkSort(_1a0b,endR,_1a0c,endC);
if(_1a0f){
showAlertDialog(jsTitleMsg.SortingNotPossibleInMergedCellrange);
closeDialog();
return;
}
var field=0;
var _1a11=false;
var _1a12=false;
var _1a13=_1a0c;
var _1a14=endC;
var nvp="currentTime="+CURRENTTIME+"&currentSheet="+encodeURIComponent(CURRSHEETNAME)+"&documentId="+DOCUMENT_ID;
nvp+="&afterRTC=false"+"&collabId="+COLLAB_ID+"&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&documentOwner="+CURR_DOC_OWNERNAME+"&isColSelected"+isColSelected();
if(isColSelected()){
var _1a16=eval("("+getSortingRangeDetails(_1a0b,endR,_1a0c,endC)+")");
var _1a17=_1a16[0];
var _1a18=_1a16[1];
_1a13=_1a17["ESC"];
_1a14=_1a17["EEC"];
if(_1a17["ES"]=="true"){
_1a11=true;
_1a18=_1a16[0];
focusCellRange(_1a0b,_1a13,usedCursRow,_1a14,undefined,true);
field=_1a0c-_1a13;
_1a0c=_1a13;
endC=_1a14;
endR=usedCursRow;
}
header=(_1a18["ch"]=="true");
var _1a19="FALSE";
if(header){
_1a19="TRUE";
}
nvp+="&containsHeader="+_1a19;
}
nvp+="&startColumn="+_1a0c+"&endColumn="+endC+"&startRow="+_1a0b+"&endRow="+endR;
var _1a1a="FALSE";
var _1a1b="FALSE";
var _1a1c=1;
if(_1a11){
_1a11="TRUE";
_1a1c=endC-_1a0c+1;
}else{
_1a11="FALSE";
}
nvp+="&expandSelection="+_1a11;
nvp+="&isSortColumns="+_1a1b;
nvp+="&sensitive="+_1a1a;
nvp+="&numberofColumns="+_1a1c;
var asc="FALSE";
if(order=="asc"){
asc="TRUE";
}
nvp+="&field0="+field;
nvp+="&sortorder0="+asc;
sortvalues(nvp);
}
}
function checkForHeader(sR,eR,sC,eC,nvp){
var _1a23=checkForHeaderInClient(sR,eR,sC,eC);
if(_1a23==null){
var _1a24=new getXmlhttp();
_1a24.open("POST",ctxpath+"sort.do",false);
var _1a25=getAvailableStartRow();
var _1a26=getAvailableEndRow();
if(typeof nvp=="undefined"){
nvp="startColumn="+sC+"&endColumn="+eC+"&startRow="+sR+"&endRow="+eR;
nvp+="&currentTime="+CURRENTTIME+"&currentSheet="+encodeURIComponent(CURRSHEETNAME)+"&documentId="+DOCUMENT_ID;
nvp+="&afterRTC=false&collabId="+COLLAB_ID+"&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&documentOwner="+CURR_DOC_OWNERNAME;
}
nvp+="&readwrite="+ALLOW_TO_WRITE+"&viewType="+getViewType()+"&isDocSaved="+isDocSaved()+"&availableStartRow="+_1a25+"&availableEndRow="+_1a26+"&isColSelected="+isColSelected();
nvp+="&actionMode=cH";
nvp=appendCSRFToURL(nvp);
if(jsREMOTE_SAVE_VIEW){
nvp+="&RMLOGINNAME="+RMUSER;
nvp+="&userStateId="+USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _1a27=getObj("apiKey");
if(_1a27!=null){
nvp+="&apiKeyId="+_1a27.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols;
_1a24.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_1a24.send(nvp);
return _1a24.responseText;
}else{
return "{ ch :\""+_1a23+"\"}";
}
}
function checkForHeaderInClient(sR,eR,sC,eC){
var _1a2c=new Array();
var _1a2d=false;
var type="NUMBER";
var cnt=0;
for(var i=sC;i<=eC;i++){
_1a2c[cnt]=type;
var cell=getCell(sR,i);
if(cell==null){
return null;
}
var _1a32=cell.getAttribute("format");
if(typeof _1a32!="undefined"&&_1a32!=null&&_1a32!="null"&&_1a32!=""){
_1a2c[cnt]=_1a32;
}else{
var _1a33="";
var _1a34=getCellContent(cell);
if(_1a34.charAt(0)=="="||_1a34==""){
_1a34=getCellContent(cell,"cV");
}
var pos1=_1a34.indexOf("$",0);
var pos2=_1a34.indexOf("?",0);
var pos3=_1a34.indexOf("?",0);
if(pos1!=-1&&pos1<2){
_1a33="DOLLAR";
}else{
if(pos2!=-1&&pos2<2){
_1a33="YEN";
}else{
if(pos3!=-1&&pos3<2){
_1a33="POUND";
}else{
if(_1a34.charAt(_1a34.length-1)=="%"){
_1a33="PERCENT";
}
}
}
}
if(_1a33==""){
if(isNaN(_1a34)){
_1a2c[cnt]="TEXT";
}else{
_1a2c[cnt]="NUMBER";
}
}else{
_1a2c[cnt]=_1a33;
}
}
cnt++;
}
cnt=0;
for(var j=sC;j<=eC;j++){
for(var i=sR+1;i<=eR;i++){
var cell=getCell(i,j);
if(cell==null){
return null;
}
var _1a32=cell.getAttribute("format");
if(typeof _1a32!="undefined"&&_1a32!=null&&_1a32!="null"&&_1a32!=""){
if(_1a32==_1a2c[cnt]){
_1a2d=false;
break;
}else{
_1a2d=true;
}
}else{
var _1a33="";
var _1a34=getCellContent(cell);
if(_1a34.charAt(0)=="="||_1a34==""){
_1a34=getCellContent(cell,"cV");
}
var pos1=_1a34.indexOf("$",0);
var pos2=_1a34.indexOf("?",0);
var pos3=_1a34.indexOf("?",0);
if(pos1!=-1&&pos1<2){
_1a33="DOLLAR";
}else{
if(pos2!=-1&&pos2<2){
_1a33="YEN";
}else{
if(pos3!=-1&&pos3<2){
_1a33="POUND";
}else{
if(_1a34.charAt(_1a34.length-1)=="%"){
_1a33="PERCENT";
}
}
}
}
if(_1a33==""){
if(isNaN(_1a34)){
if(_1a2c[cnt]=="TEXT"){
_1a2d=false;
break;
}
}else{
if(_1a2c[cnt]=="NUMBER"){
_1a2d=false;
break;
}else{
_1a2d=true;
}
}
}else{
if(_1a2c[cnt]==_1a33){
_1a2d=false;
break;
}else{
_1a2d=true;
}
}
}
}
if(_1a2d){
break;
}
cnt++;
}
return _1a2d;
}
function getSortingRangeDetails(sR,eR,sC,eC,nvp){
var _1a3e=new getXmlhttp();
_1a3e.open("POST",ctxpath+"sort.do",false);
var _1a3f=getAvailableStartRow();
var _1a40=getAvailableEndRow();
if(typeof nvp=="undefined"){
nvp="startColumn="+sC+"&endColumn="+eC+"&startRow="+sR+"&endRow="+eR;
nvp+="&currentTime="+CURRENTTIME+"&currentSheet="+encodeURIComponent(CURRSHEETNAME)+"&documentId="+DOCUMENT_ID;
nvp+="&afterRTC=false&collabId="+COLLAB_ID+"&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&documentOwner="+CURR_DOC_OWNERNAME;
}
nvp+="&readwrite="+ALLOW_TO_WRITE+"&viewType="+getViewType()+"&isDocSaved="+isDocSaved()+"&availableStartRow="+_1a3f+"&availableEndRow="+_1a40+"&isColSelected="+isColSelected();
nvp+="&actionMode=cH";
nvp=appendCSRFToURL(nvp);
if(jsREMOTE_SAVE_VIEW){
nvp+="&RMLOGINNAME="+RMUSER;
nvp+="&userStateId="+USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _1a41=getObj("apiKey");
if(_1a41!=null){
nvp+="&apiKeyId="+_1a41.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols;
_1a3e.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_1a3e.send(nvp);
return _1a3e.responseText;
}
function checkForNearestCell(sR,eR,sC,eC){
var _1a46=new Array();
var _1a47=sC;
var _1a48=eC;
var _1a49=false;
for(var i=sC-1;i>=0;i--){
_1a49=false;
for(var j=sR;j<=eR;j++){
var _1a4c=getCellContent(getCell(j,i),"cV");
if(_1a4c!=""){
_1a49=true;
_1a47=i;
}
}
if(!_1a49){
break;
}
}
_1a49=false;
for(var i=eC;i<=usedCursCol;i++){
_1a49=false;
for(var j=sR;j<=eR;j++){
var _1a4c=getCellContent(getCell(j,i),"cV");
if(_1a4c!=""){
_1a49=true;
_1a48=i;
}
}
if(!_1a49){
break;
}
}
_1a46["SC"]=_1a47;
_1a46["EC"]=_1a48;
return _1a46;
}
function changeDDOptions(obj,cnt,_1a4f){
if(obj.id=="toptobottom"){
if(obj.checked){
getObj("lefttorightBtn").style.display="none";
getObj("toptobtmBtn").style.display="";
getObj("lefttorightRow").style.display="none";
getObj("toptotbmRow").style.display="";
getObj("containsheader").disabled=false;
getObj("containsheader").checked=_1a4f;
for(var i=0;i<cnt;i++){
if(getObj("containsheader").checked){
getObj("columnheaderDD_"+i).style.display="";
getObj("columnDD_"+i).style.display="none";
}else{
getObj("columnheaderDD_"+i).style.display="none";
getObj("columnDD_"+i).style.display="";
}
}
}
}else{
if(obj.id=="lefttoright"){
if(obj.checked){
getObj("lefttorightBtn").style.display="";
getObj("toptobtmBtn").style.display="none";
getObj("lefttorightRow").style.display="";
getObj("toptotbmRow").style.display="none";
getObj("containsheader").checked=false;
getObj("containsheader").disabled=true;
}
}else{
if(obj.id=="containsheader"){
for(var i=0;i<cnt;i++){
if(obj.checked){
getObj("columnheaderDD_"+i).style.display="";
getObj("columnDD_"+i).style.display="none";
}else{
getObj("columnheaderDD_"+i).style.display="none";
getObj("columnDD_"+i).style.display="";
}
}
}
}
}
}
function DDcolvalidate(obj,_1a52){
var val=obj.value;
if(val==""){
return;
}
var objid=obj.id;
var _1a55=false;
if(objid.indexOf("DD_column_header_")!=-1){
_1a55=true;
}
if(_1a55){
objid="DD_column_header_";
}else{
objid="DD_column_";
}
for(var i=0;i<_1a52;i++){
if(i>2){
break;
}
var dd=objid+i;
var check=getObj(dd).value;
if(obj.id!=dd){
if(val==check){
showAlertDialogDialog(jsTitleMsg.SelectDifferentColumn);
obj.selectedIndex=0;
break;
}
}
}
}
function DDrowvalidate(obj,_1a5a){
var val=obj.value;
if(val==""){
return;
}
for(var i=0;i<_1a5a;i++){
if(i>2){
break;
}
var dd="DD_row_"+i;
var check=getObj(dd).value;
if(obj.id!=dd){
if(val==check){
showAlertDialog(jsTitleMsg.SelectDifferentRow);
obj.selectedIndex=0;
break;
}
}
}
}
function getIndex(_1a5f,val){
var _1a61=_1a5f.split(":");
var index=-1;
for(var i=0;i<_1a61.length;i++){
if(val.trim()==_1a61[i].trim()){
index=i;
break;
}
}
return index;
}
function checkSort(sR,eR,sC,eC){
var range=new Range(sR,sC,eR,eC);
var iter=range.getIterator();
iter.initData(false);
iter.setDataProcessor(function(value){
return value;
});
iter.iterate(function(row,col){
var info=Merge.getCellInfo(row,col);
if(info){
this.processData(true);
this.interrupt();
}
});
return iter.getData();
}
function constructSortDialog(){
var _1a6e=getCellRange();
var _1a6f=_1a6e.startRow;
var _1a70=_1a6e.startCol;
var endR=_1a6e.endRow;
var endC=_1a6e.endCol;
var _1a73=checkSort(_1a6f,endR,_1a70,endC);
if(_1a73){
showAlertDialog(jsTitleMsg.SortingNotPossibleInMergedCellrange);
closeDialog();
return;
}
var _1a74=eval("("+getSortingRangeDetails(_1a6f,endR,_1a70,endC)+")");
var _1a75=_1a74[0];
var _1a76=_1a74[1];
startColumn=_1a75["ESC"];
endColumn=_1a75["EEC"];
if(isColSelected()&&_1a75["ES"]=="true"){
_1a76=_1a74[0];
focusCellRange(_1a6f,startColumn,usedCursRow,endColumn,undefined,true);
_1a70=startColumn;
endC=endColumn;
endR=usedCursRow;
}
_1a77=(_1a76["ch"]=="true");
var _1a78="FALSE";
if(_1a77){
_1a78="TRUE";
}
var _1a79=endC-_1a70+1;
var _1a7a=endR-_1a6f+1;
var _1a7b=_1a79>3?3:_1a79;
var _1a7c="";
var _1a7d=new Array();
var _1a77=(_1a76["ch"]=="true");
var cntt=0;
for(var i=_1a70;i<=endC;i++){
_1a7d[cntt]=(typeof _1a76["c_"+i]=="undefined")?getCellContent(getCell(_1a6f,i),"cV"):_1a76["c_"+i];
_1a7c+=getColHeadLabel(i+1)+":";
cntt++;
}
_1a7c=_1a7c.substring(0,_1a7c.length-1);
var _1a80="";
for(var i=_1a6f;i<=endR;i++){
_1a80+=(i+1)+":";
}
_1a80=_1a80.substring(0,_1a80.length-1);
var title="";
var _1a82=IMAGE_PATH+"/spacer.gif";
var _1a83=_1a7c.split(":");
var _1a84=_1a80.split(":");
var _1a85="";
_1a85+="<table style='table-layout:fixed;' width='100%' border='0' cellspacing='0' cellpadding='0'><tr><td style='padding: 0px 10px 10px 10px'>";
_1a85+="<table width='100%' border='0' cellspacing='0' cellpadding='0'>";
_1a85+="<tr id='toptotbmRow'><td>";
_1a85+="<table width='100%' border='0' cellspacing='0' cellpadding='0'>";
for(var i=0;i<3;i++){
title=jsMsg.Thenby;
if(i==0){
title=jsMsg.SortBy;
}
_1a85+="<tr> <td colspan='2' style='padding-top:10px;'><div style='float:left;clear:both;width:20%;white-space:nowrap;'>"+title+"</div>";
_1a85+="<div class='hsep' style='float:right;width:80%;height:20px;'><img src='"+_1a82+"' width='1' height='1'></div></td></tr>";
_1a85+="<tr>";
var style="";
if(!_1a77){
style="style='display:none'";
}
var _1a87="";
if(i>_1a79-1){
_1a87="disabled";
}
_1a85+="<td id='columnheaderDD_"+i+"' "+style+"> <div style='width:130px;'><select style='width:130px;' id='DD_column_header_"+i+"' onchange='DDcolvalidate(this, "+_1a79+");' "+_1a87+">";
var sel="";
if(i!=0){
sel="selected";
}
_1a85+="<option value='' "+sel+"></option>";
for(var opt=0;opt<_1a83.length;opt++){
var _1a8a=_1a7d[opt];
var _1a8b="";
if(i==0&&opt==0){
_1a8b="selected";
}
_1a85+="<option value='"+_1a83[opt]+"' "+_1a8b+">"+_1a8a+"</option>";
}
_1a85+="</select> </div></td>";
style="";
if(_1a77){
style="style='display:none'";
}
_1a85+="<td id='columnDD_"+i+"' "+style+"> <div style='width:130px;'><select style='width:130px;' id='DD_column_"+i+"' onchange='DDcolvalidate(this, "+_1a79+");' "+_1a87+">";
sel="";
if(i!=0){
sel="selected";
}
_1a85+="<option value='' "+sel+"></option>";
for(var opt=0;opt<_1a83.length;opt++){
var _1a8a=replaceParams(jsTitleMsg["Sort.Orientation.Column"],new Array(_1a83[opt]));
var _1a8b="";
if(i==0&&opt==0){
_1a8b="selected";
}
_1a85+="<option value='"+_1a83[opt]+"' "+_1a8b+">"+_1a8a+"</option>";
}
_1a85+="</select> </div></td>";
_1a85+="<td><table border='0' cellspacing='0' cellpadding='0'><tr>";
_1a85+="<td><input type='radio' id='asc_col_"+i+"' name='order_col_"+i+"' value='Ascending' checked "+_1a87+"></td>";
_1a85+="<td><label for='asc_col_"+i+"'>"+jsMsg.Ascending+"</label></td></tr>";
_1a85+="<tr><td><input type='radio' id='desc_col_"+i+"' name='order_col_"+i+"' value='Descending' "+_1a87+"></td>";
_1a85+="<td><label for='desc_col_"+i+"'>"+jsMsg.Descending+"</label></td></tr>";
_1a85+="</table></td>";
_1a85+="</tr>";
}
_1a85+="</table>";
_1a85+="</td></tr>";
_1a85+="<tr id='lefttorightRow' style='display:none'><td>";
_1a85+="<table width='100%' border='0' cellspacing='0' cellpadding='0'>";
for(var i=0;i<3;i++){
if(i>2){
break;
}
title=jsMsg.Thenby;
if(i==0){
title=jsMsg.SortBy;
}
var _1a87="";
if(i>_1a7a-1){
_1a87="disabled";
}
_1a85+="<tr> <td colspan='2' style='padding-top:10px;'><div style='float:left;clear:both;width:20%;white-space:nowrap;'>"+title+"</div>";
_1a85+="<div class='hsep' style='float:right;width:80%;height:20px;'><img src='"+_1a82+"' width='1' height='1'></div></td></tr>";
_1a85+="<tr><td> <div style='width:130px;'><select style='width:130px;' id='DD_row_"+i+"' onchange='DDrowvalidate(this, "+_1a7a+");' "+_1a87+">";
var sel="";
if(i!=0){
sel="selected";
}
_1a85+="<option value='' "+sel+"></option>";
for(var opt=0;opt<_1a84.length;opt++){
var row=replaceParams(jsTitleMsg["Sort.Orientation.Row"],new Array(_1a84[opt]));
var _1a8b="";
if(i==0&&opt==0){
_1a8b="selected";
}
_1a85+="<option value='"+_1a84[opt]+"' "+_1a8b+">"+row+"</option>";
}
_1a85+="</select> </div></td>";
_1a85+="<td><table border='0' cellspacing='0' cellpadding='0'><tr>";
_1a85+="<td><input type='radio' id='asc_row_"+i+"' name='order_row_"+i+"' value='Ascending' checked "+_1a87+"></td>";
_1a85+="<td><label for='asc_row_"+i+"'>"+jsMsg.Ascending+"</label></td></tr>";
_1a85+="<tr><td><input type='radio' id='desc_row_"+i+"' name='order_row_"+i+"' value='Descending' "+_1a87+"></td>";
_1a85+="<td><label for='desc_row_"+i+"'>"+jsMsg.Descending+"</label></td></tr>";
_1a85+="</table></td>";
_1a85+="</tr>";
}
_1a85+="</table>";
_1a85+="</td></tr>";
var _1a8d="";
if(_1a77){
_1a8d="checked";
}
_1a85+="<tr> <td colspan='2' style='padding-top:10px;'><div style='float:left;clear:both;width:30%;white-space:nowrap;'>"+jsMsg.ListOptions+"</div>";
_1a85+="<div class='hsep' style='float:right;width:70%;height:20px;'><img src='"+_1a82+"' width='1' height='1'></div></td></tr>";
_1a85+="<tr><td colspan='2' height='30'><table border='0' cellspacing='0' cellpadding='2'><tr>";
_1a85+="<td><input id='containsheader' name='checkbox' value='checkbox' type='checkbox' "+_1a8d+" onclick='changeDDOptions(this, "+_1a7b+", "+_1a77+");'></td>";
_1a85+="<td nowrap><label for='containsheader'>"+jsMsg.ContainsHeader+"</label></td>";
_1a85+="<td style='padding-left:10px;'><input id='sensitive' name='checkbox' value='checkbox' type='checkbox' checked></td>";
_1a85+="<td nowrap><label for='sensitive'>"+jsMsg.CaseSensitive+"</label></td></tr>";
_1a85+="</table></td></tr>";
_1a85+="<tr> <td colspan='2' style='padding-top:5px;'><div style='float:left;clear:both;width:30%;white-space:nowrap;'>"+jsMsg.Orientation+"</div>";
_1a85+="<div class='hsep' style='float:right;width:70%;height:20px;'><img src='"+_1a82+"' width='1' height='1'></div></td></tr>";
_1a85+="<tr><td colspan='2' height='30'><table border='0' cellspacing='0' cellpadding='2'><tr>";
_1a85+="<td><input id='toptobottom' name='orientation' type='radio' checked onclick='changeDDOptions(this, "+_1a7b+", "+_1a77+");'></td>";
_1a85+="<td nowrap><label for='toptobottom'>"+jsMsg.SortTopToBottom+"</label></td>";
_1a85+="<td style='padding-left:10px;'><input id='lefttoright' name='orientation' type='radio' onclick='changeDDOptions(this, "+_1a7b+");'></td>";
_1a85+="<td nowrap><label for='lefttoright'>"+jsMsg.SortLeftToRight+"</label></td></tr>";
_1a85+="</table></td></tr>";
_1a85+="<tr> <td colspan='2' align='center' style='padding-top:10px'><input type='button' id='toptobtmBtn' class='button' value='"+jsTitleMsg.OK+"' onclick='sort1("+_1a79+", \""+_1a7c+"\");'><input type='button' id='lefttorightBtn' style='display:none' class='button' value='"+jsTitleMsg.OK+"' onclick='sort1("+_1a7a+", \""+_1a80+"\");'>";
_1a85+="  <input type='button' class='button' value='"+jsTitleMsg.Cancel+"' onClick='isSortDialogOpened=false;closeDialog();'></td>";
_1a85+="</tr></table></td></tr></table>";
showDialog(_1a85,"width=284,position=absmiddle,title="+jsTitleMsg.Sort+",closeOnEscKey=yes,modal=yes");
}
function formatcells(){
var _1a8e=getXMLHttpRequest();
_1a8e.onreadystatechange=function(){
if(_1a8e.readyState==4){
var _1a8f=_1a8e.responseText;
showDialog(_1a8f,"position=absmiddle,title="+jsTitleMsg.FormatCells+",closeOnEscKey=yes,modal=yes");
}
};
postAjax(_1a8e,ctxpath+"pages/formatcells.jsp","");
}
function pickFromList(){
try{
isAutoSuggestMenuOpen=true;
closeDialog();
getSuggestList(currCol);
}
catch(e){
}
}
function getNamedRanges(inval){
if(isDocumentReadyToEdit){
if(typeof inval=="undefined"){
if(DOCUMENT_ID=="doc_id"){
message("","none");
return;
}
}
var _1a91=getXMLHttpRequest();
_1a91.onreadystatechange=function(){
if(_1a91.readyState==4){
var resp=_1a91.responseXML;
var _1a93=resp;
if(_1a91.responseText!="Not Authorized"){
NAMEDRANGES=new Array();
updateNamedRangesFromXml(_1a93,"read");
}
if(typeof inval=="undefined"){
loadOthersforDoc();
fireWorkbook_OpenEvent();
}
}
};
var _1a94=encodeURIComponent(CURRSHEETNAME);
var nvp="action=READRANGESALONE&docid="+DOCUMENT_ID+"&curtime="+CURRENTTIME+"&sheetname="+_1a94+"&bridgeNo="+bridgeNumber+"&docowner="+CURR_DOC_OWNERNAME;
nvp+="&viewType="+getViewType()+"&isStockConfigured="+isStockConfigured+"&isDocSaved="+SAVED+"&fileFormat="+FILE_FORMAT;
nvp+="&availableStartRow="+getAvailableStartRow();
nvp+="&availableEndRow="+getAvailableEndRow();
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols;
if(jsPUBLIC_VIEW){
nvp+="&loadObject="+LOAD_OBJECT_IN_PUBLIC;
}
sendXMLHTTPRequest(_1a91,nvp,true,true,ctxpath+"namedRanges.do");
}
}
var NAMEVIEW="";
function showNameDialog(val){
NAMEVIEW=val;
defineNameHTML=constructNameDialog();
showDialog(defineNameHTML,"width=535 position=absolute, title="+jsTitleMsg.NamesList+",closeOnEscKey=yes,modal=no",defineNameCallBkFn,defineNameDlgClsFn);
}
function defineNameCallBkFn(){
isNameDialogOpened=true;
if(NAMEVIEW=="add"||NAMEVIEW==""||NAMEVIEW=="view"){
NAMEVIEW="";
getObj("defineCellName").focus();
var sheet=CURRSHEETNAME;
var _1a98="";
if(isCellRange()){
var _1a99=getCellRange();
_1a98=constructCellName(_1a99.startRow,_1a99.startCol,_1a99.endRow,_1a99.endCol);
}else{
var row=ActiveCellInfo.getStartRow();
var col=ActiveCellInfo.getStartCol();
_1a98=constructCellName(row,col);
}
var _1a9c=getObj("refCellTxt");
if(sheet.indexOf(" ")!=-1){
sheet="'"+sheet+"'";
}
_1a9c.value=ASSIGNEDTO="$"+sheet+"."+_1a98;
}
positionDialog();
}
function constructCellName(sr,sc,er,ec){
var _1aa1="";
if(typeof er!="undefined"){
_1aa1="$"+getColHeadLabel(sc+1)+"$"+getRowHeadLabel(sr);
_1aa1+=":"+"$"+getColHeadLabel(ec+1)+"$"+getRowHeadLabel(er);
}else{
_1aa1="$"+getColHeadLabel(sc+1)+"$"+getRowHeadLabel(sr);
}
return _1aa1;
}
function defineNameDlgClsFn(){
isNameDialogOpened=false;
FOCUSSEDNAMEINPUTOBJECT=defineNameHTML=currentNamesListSPAN=ASSIGNEDTO="";
resetCellRangeFill("definename");
}
function addName(_1aa2,_1aa3,_1aa4,_1aa5){
if(!READ_WRITE){
return;
}
if(typeof _1aa5=="undefined"){
_1aa5=false;
}
if(typeof _1aa4=="undefined"){
_1aa4="false";
}
if(typeof _1aa2=="undefined"){
var _1aa6=getObj("defineCellName").value;
var _1aa7=getObj("refCellTxt").value;
if(_1aa6.trim()==""){
showAlertDialog(jsTitleMsg.Namecannotbeempty);
return;
}
if(_1aa7.trim()==""){
showAlertDialog(jsTitleMsg.Rangecannotbeempty);
return;
}
if(checkSheetName(_1aa6,"Define Name")||!isNaN(_1aa6.charAt(0))||isCellLabel(_1aa6.trim())){
var _1aa8=jsTitleMsg.InvalidName+"\n";
_1aa8+="\t";
_1aa8+="- "+jsTitleMsg.CellNamecannotstartwithnumbers;
_1aa8+="\n\t";
_1aa8+="- "+jsTitleMsg.CellNamecannotbeassameasZohoSheetdefinedcelllabels;
showAlertDialog(_1aa8);
return;
}
}else{
var _1aa6=_1aa2;
var _1aa7=_1aa3;
}
var _1aa9="";
var cnt;
var _1aab="contentSPAN_"+cnt;
var _1aac=new getXmlhttp();
_1aac.onreadystatechange=function(){
if(_1aac.readyState==4){
var resp=_1aac.responseXML;
var nodes=resp.firstChild.childNodes;
var _1aaf="";
var _1ab0="";
var _1ab1="FALSE";
for(var i=0;i<nodes.length;i++){
var _1ab3=nodes[i].nodeName;
if(_1ab3=="error"){
if(showErrorPanelMsg==nodes[i].firstChild.nodeValue){
handleServerError("ERROR",nodes[i].firstChild.nodeValue,true);
closeDialog();
}else{
showAlertDialog(jsTitleMsg.Error+" "+nodes[i].firstChild.nodeValue);
}
return;
}
if(_1ab3=="NAMES"){
_1aaf=nodes[i];
var _1ab4=_1aaf.childNodes;
for(var x=0;x<_1ab4.length;x++){
var node=_1ab4.item(x);
if(node.nodeName=="DEFINENAME"){
var _1ab7=node.childNodes;
for(var y=0;y<_1ab7.length;y++){
var _1ab9=_1ab7[y].nodeName;
if(_1ab9=="ALREADYEXISTS"){
_1ab1=_1ab7[y].firstChild.nodeValue;
}
if(_1ab9=="COUNT"){
cnt=_1ab7[y].firstChild.nodeValue;
}
}
}
}
}else{
if(_1ab3=="CELLDETAILS"){
var _1aba=nodes[i].childNodes;
for(var z=0;z<_1aba.length;z++){
var _1abc=_1aba.item(z);
if(_1abc.nodeName=="websheet"){
_1ab0=_1abc;
}
}
}
}
}
if(_1ab1=="TRUE"&&_1aa4=="false"){
showAlertDialog(jsTitleMsg.ThenameenteredalreadyexistsEnterauniquename);
var _1abd=getObj("defineCellName");
_1abd.focus();
_1abd.select();
return;
}
defineNameHTML="";
if(typeof _1aa2=="undefined"){
_1aa6=getObj("defineCellName").value;
_1aa7=getObj("refCellTxt").value;
}else{
_1aa6=_1aa2;
_1aa7=_1aa3;
}
if(isNameDialogOpened){
var _1abe=getObj("namesListTBody");
if(cnt==0){
var _1abf=getObj("nameTR_0");
var _1ac0=_1abf.parentNode;
_1ac0.removeChild(_1abf);
}
if(browser_ie){
constructNameTrHTMLforIE(cnt,_1aa6,_1aa7);
}else{
var html=constructNameTrHTML(cnt,_1aa6,_1aa7);
var _1ac2=_1abe.innerHTML;
_1abe.innerHTML=_1ac2+html;
}
_1aa9=getObj("contentSPAN_"+cnt);
}
var _1ac3=_1aaf;
updateNamedRangesFromXml(_1ac3,"add");
if(_1ab0){
updateCell(_1ab0,_1aac.status,_1aac.statusText,"DEFINENAME");
}
if(READ_WRITE){
btn_enabled();
}
if(isNameDialogOpened){
if(_1aa4=="false"){
resetCellRangeFill("definename");
FOCUSSEDNAMEINPUTOBJECT="";
getObj("defineCellName").value="";
getObj("defineCellName").focus();
if(NAMEDRANGES.length>5){
var _1ac4=getObj("namesListDIV");
_1ac4.scrollTop=_1ac4.scrollHeight;
}
}
}
}
};
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
var _1ac8=encodeURIComponent(CURRSHEETNAME);
_1aa6=encodeURIComponent(_1aa6);
_1aa7=encodeURIComponent(_1aa7);
_1aa7=doit(_1aa7);
var nvp="action=ADD&docid="+DOCUMENT_ID+"&curtime="+CURRENTTIME+"&sheetname="+_1ac8+"&docowner="+CURR_DOC_OWNERNAME;
nvp+="&cellName="+_1aa6+"&content="+_1aa7+"&row="+row+"&column="+col+"&bridgeNo="+bridgeNumber;
nvp+="&collabid="+COLLAB_ID+"&afterRTC="+_1aa4+"&currentNamesListSPAN="+_1aab+"&fromUNDO="+_1aa5;
nvp+="&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING+"&viewType="+getViewType()+"&isDocSaved="+SAVED;
if(_1aa4=="true"){
var _1aca=encodeURIComponent(RTCSHEETNAME);
nvp+="&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+_1aca;
}
if(jsREMOTE_SAVE_VIEW){
nvp+="&RMLOGINNAME="+RMUSER;
}
nvp+="&availableStartRow="+getAvailableStartRow();
nvp+="&availableEndRow="+getAvailableEndRow();
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols;
sendXMLHTTPRequest(_1aac,nvp,true,true,ctxpath+"namedRanges.do");
}
function modifyName(_1acb,_1acc,_1acd,_1ace,_1acf){
if(typeof _1acf=="undefined"){
_1acf=false;
}
if(typeof _1ace=="undefined"){
_1ace="false";
}
var _1ad0=_1acb;
var _1ad1=_1acc;
var _1ad2=_1ad0;
var _1ad3=_1ad1;
if(typeof _1acd=="undefined"){
if(_1ad1.trim()==""){
showAlertDialog(jsTitleMsg.Rangecannotbeempty);
return;
}
}
var cnt=currentNamesListSPAN.id.split("_")[1];
var _1ad5=getDefinedNameProperty(_1ad0,"CONTENT");
if(isNameDialogOpened&&_1ace=="false"){
resetCellRangeFill("definename");
}
if(_1ad5==_1ad1){
resetNameEditRange();
return;
}
var _1ad6=new getXmlhttp();
_1ad6.onreadystatechange=function(){
if(_1ad6.readyState==4){
if(isNameDialogOpened){
var _1ad7=_1ad3;
if(_1ad7.length>18){
_1ad7=_1ad7.substring(0,18)+"...";
}
if(typeof _1acd=="undefined"){
currentNamesListSPAN.innerHTML=_1ad7;
currentNamesListSPAN.title=_1ad3;
var cnt=currentNamesListSPAN.id.split("_")[1];
}else{
_1acd=getObj(_1acd);
_1acd.innerHTML=_1ad7;
_1acd.title=_1ad3;
var cnt=_1acd.id.split("_")[1];
}
getObj("contentINPUT_"+cnt).value=_1ad3;
}
if(READ_WRITE){
btn_enabled();
}
var resp=_1ad6.responseXML;
var nodes=resp.firstChild.childNodes;
var _1adb="";
var _1adc="";
var _1add="FALSE";
for(var i=0;i<nodes.length;i++){
var _1adf=nodes[i].nodeName;
if(_1adf=="error"){
if(showErrorPanelMsg==nodes[i].firstChild.nodeValue){
handleServerError("ERROR",nodes[i].firstChild.nodeValue,true);
closeDialog();
}else{
showAlertDialog(jsTitleMsg.Error+" "+nodes[i].firstChild.nodeValue);
}
return;
}
if(_1adf=="NAMES"){
_1adb=nodes[i];
}else{
if(_1adf=="CELLDETAILS"){
var _1ae0=nodes[i].childNodes;
for(var z=0;z<_1ae0.length;z++){
var _1ae2=_1ae0.item(z);
if(_1ae2.nodeName=="websheet"){
_1adc=_1ae2;
}
}
}
}
}
var _1ae3=_1adb;
updateNamedRangesFromXml(_1ae3,"modify");
if(_1adc){
updateCell(_1adc,_1ad6.status,_1ad6.statusText,"DEFINENAME");
}
defineNameHTML="";
if(isNameDialogOpened&&_1ace=="false"){
resetNameEditRange();
getObj("defineCellName").focus();
}
}
};
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
var _1ae7=encodeURIComponent(CURRSHEETNAME);
_1ad0=encodeURIComponent(_1ad0);
_1ad1=encodeURIComponent(_1ad1);
_1ad1=doit(_1ad1);
var nvp="action=MODIFY&docid="+DOCUMENT_ID+"&curtime="+CURRENTTIME+"&sheetname="+_1ae7+"&row="+row+"&column="+col+"&docowner="+CURR_DOC_OWNERNAME;
nvp+="&cellName="+_1ad0+"&content="+_1ad1+"&currentNamesListSPAN="+currentNamesListSPAN.id;
nvp+="&collabid="+COLLAB_ID+"&afterRTC="+_1ace+"&bridgeNo="+bridgeNumber+"&fromUNDO="+_1acf+"&oldContent="+_1ad5;
nvp+="&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING+"&viewType="+getViewType()+"&isDocSaved="+SAVED;
if(_1ace=="true"){
var _1ae9=encodeURIComponent(RTCSHEETNAME);
nvp+="&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+_1ae9;
}
if(jsREMOTE_SAVE_VIEW){
nvp+="&RMLOGINNAME="+RMUSER;
}
nvp+="&availableStartRow="+getAvailableStartRow();
nvp+="&availableEndRow="+getAvailableEndRow();
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols;
sendXMLHTTPRequest(_1ad6,nvp,true,true,ctxpath+"namedRanges.do");
}
function deleteName(_1aea,_1aeb,_1aec,_1aed,_1aee){
if(typeof _1aee=="undefined"){
_1aee=false;
}
if(typeof _1aed=="undefined"){
_1aed="false";
}
var _1aef=_1aea;
var _1af0=_1aeb;
var _1af1=_1aef;
var _1af2=_1af0;
var _1af3=new getXmlhttp();
_1af3.onreadystatechange=function(){
if(_1af3.readyState==4){
updateCell(_1af3.responseXML,_1af3.status,_1af3.statusText);
var resp=_1af3.responseXML;
var nodes=resp.firstChild.childNodes;
var _1af6;
for(var i=0;i<nodes.length;i++){
if(nodes[i].nodeName=="COUNT"){
_1af6=nodes[i].firstChild.nodeValue;
}
}
if(isNameDialogOpened){
if(typeof _1aec=="undefined"){
var cnt=currentNamesListSPAN.id.split("_")[1];
}else{
_1aec=getObj(_1aec);
var cnt=_1aec.id.split("_")[1];
}
var _1af9=getObj("nameTR_"+cnt);
var _1afa=_1af9.parentNode;
_1afa.removeChild(_1af9);
}
if(READ_WRITE){
btn_enabled();
}
updateNamedRanges("delete",_1af1,true);
defineNameHTML="";
if(isNameDialogOpened){
getObj("defineCellName").value="";
getObj("defineCellName").focus();
if(typeof _1aec=="undefined"){
currentNamesListSPAN="";
if(_1af6>0){
resetDNIds();
}else{
reconstructNamesListHTML();
}
}else{
if(_1aed=="true"||_1aee){
if(_1af6>0){
resetDNIds();
}else{
reconstructNamesListHTML();
}
}
}
}
}
};
var _1afb=encodeURIComponent(CURRSHEETNAME);
_1aef=encodeURIComponent(_1aef);
_1af0=encodeURIComponent(_1af0);
var nvp="action=DELETE&docid="+DOCUMENT_ID+"&curtime="+CURRENTTIME+"&sheetname="+_1afb+"&bridgeNo="+bridgeNumber;
nvp+="&docowner="+CURR_DOC_OWNERNAME+"&cellName="+_1aef+"&content="+_1af0+"&currentNamesListSPAN="+currentNamesListSPAN.id;
nvp+="&collabid="+COLLAB_ID+"&afterRTC="+_1aed+"&fromUNDO="+_1aee;
nvp+="&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING+"&viewType="+getViewType()+"&isDocSaved="+SAVED;
if(_1aed=="true"){
var _1afd=encodeURIComponent(RTCSHEETNAME);
nvp+="&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+_1afd;
}
if(jsREMOTE_SAVE_VIEW){
nvp+="&RMLOGINNAME="+RMUSER;
}
nvp+="&availableStartRow="+getAvailableStartRow();
nvp+="&availableEndRow="+getAvailableEndRow();
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols;
sendXMLHTTPRequest(_1af3,nvp,true,true,ctxpath+"namedRanges.do");
}
function resetDNIds(){
var _1afe=getObj("namesListTBody");
var _1aff=_1afe.getElementsByTagName("TR");
var len=0;
var i=0;
while(_1aff.length>len){
var trObj=_1aff[len];
if(trObj.id.indexOf("nameTR_")!=-1){
trObj.id="nameTR_"+i;
var _1b03=trObj;
var _1b04=_1b03.getElementsByTagName("TD");
for(var j=0;j<_1b04.length;j++){
var tdObj=_1b04[j];
if(tdObj.id.indexOf("nameTD_")!=-1){
tdObj.id="nameTD_"+i;
}
}
var _1b07=_1b03.getElementsByTagName("SPAN");
for(var k=0;k<_1b07.length;k++){
var _1b09=_1b07[k];
if(_1b09.id.indexOf("contentSPAN_")!=-1){
_1b09.id="contentSPAN_"+i;
}
}
var _1b0a=_1b03.getElementsByTagName("INPUT");
for(var m=0;m<_1b0a.length;m++){
var _1b0c=_1b0a[m];
if(_1b0c.id.indexOf("contentINPUT_")!=-1){
_1b0c.id="contentINPUT_"+i;
}
}
var _1b0d=_1b03.getElementsByTagName("A");
for(var n=0;n<_1b0d.length;n++){
var aObj=_1b0d[n];
if(aObj.id.indexOf("nameEditTD_")!=-1){
aObj.id="nameEditTD_"+i;
if(browser_ie){
aObj.onclick=function(){
defineNameActions(i,this);
};
}else{
aObj.setAttribute("onclick","defineNameActions("+i+", this);");
}
}
if(aObj.id.indexOf("nameUpdateTD_")!=-1){
aObj.id="nameUpdateTD_"+i;
if(browser_ie){
aObj.onclick=function(){
defineNameActions(i,this);
};
}else{
aObj.setAttribute("onclick","defineNameActions("+i+", this);");
}
}
if(aObj.id.indexOf("nameCancelTD_")!=-1){
aObj.id="nameCancelTD_"+i;
if(browser_ie){
aObj.onclick=function(){
defineNameActions(i,this);
};
}else{
aObj.setAttribute("onclick","defineNameActions("+i+", this);");
}
}
if(aObj.id.indexOf("nameDeleteTD_")!=-1){
aObj.id="nameDeleteTD_"+i;
if(browser_ie){
aObj.onclick=function(){
defineNameActions(i,this);
};
}else{
aObj.setAttribute("onclick","defineNameActions("+i+", this);");
}
}
}
i++;
}
len++;
}
}
function reconstructNamesListHTML(){
if(!isNameDialogOpened){
return;
}
if(browser_ie){
var _1b10=getObj("namesListTbl");
while(_1b10.rows.length>0){
_1b10.deleteRow(0);
}
var tr=document.createElement("TR");
tr.className="trOdd";
tr.id="nameTR_0";
var td=document.createElement("TD");
td.align="center";
td.innerHTML="0 "+jsMsg.NamesDefined;
tr.appendChild(td);
var _1b13=getObj("namesListTBody");
if(_1b13==null||typeof _1b13=="undefined"){
var tbody=document.createElement("TBODY");
tbody.id="namesListTBody";
_1b10.appendChild(tbody);
_1b13=tbody;
}
_1b13.appendChild(tr);
}else{
var _1b13=getObj("namesListTBody");
_1b13.innerHTML=constructEmptyTrHtml();
}
}
function updateNamedRangesFromXml(_1b15,_1b16,_1b17){
if(_1b15==null||typeof _1b15=="undefined"){
return;
}
if(!_1b15.hasChildNodes()){
return;
}
var _1b18=_1b15.childNodes;
for(var x=0;x<_1b18.length;x++){
var node=_1b18.item(x);
if(node.nodeName=="websheet"){
var _1b1b=node.childNodes;
for(var y=0;y<_1b1b.length;y++){
var child=_1b1b.item(y);
if(child.nodeName=="error"){
if(showErrorPanelMsg==child.firstChild.nodeValue){
handleServerError("ERROR",child.firstChild.nodeValue,true);
closeDialog();
}else{
showAlertDialog(jsTitleMsg.Error+" "+child.firstChild.nodeValue);
}
return;
}
}
}else{
if(node.nodeName=="DEFINENAME"){
var _1b1b=node.childNodes;
for(var y=0;y<_1b1b.length;y++){
var child=_1b1b.item(y);
if(child.nodeName=="BRIDGENUMBER"){
bridgeNumber=child.firstChild.nodeValue;
if(!OOLOADED){
OOLOADED=true;
if(CANREADWRITE&&!(!ALLOW_TO_WRITE&&!ALL_SHEET_SHARED)&&!(jsSHARE_VIEW&&isSheetBasedShare&&!ALLOW_TO_WRITE)&&!jsTRASH_VIEW){
READ_WRITE=true;
}
}
}else{
if(child.nodeName=="NAMEDETAILS"){
var _1b1e=child.childNodes;
var _1b1f=null;
var _1b20=null;
var _1b21=null;
var _1b22=null;
var _1b23=null;
var _1b24=null;
var _1b25=null;
var _1b26=null;
for(var i=0;i<_1b1e.length;i++){
var _1b28=_1b1e[i].nodeName;
var _1b29="";
if(_1b28=="NAME"||_1b28=="CONTENT"||_1b28=="STARTROW"||_1b28=="STARTCOL"||_1b28=="ENDROW"||_1b28=="ENDCOL"||_1b28=="REFSHEET"||_1b28=="ISRANGE"){
_1b29=_1b1e[i].firstChild.nodeValue;
}
if(_1b28=="NAME"){
_1b1f=_1b29;
_1b1f=replaceSplChrs(_1b1f);
}else{
if(_1b28=="CONTENT"){
_1b20=_1b29;
_1b20=replaceSplChrs(_1b20);
}else{
if(_1b28=="STARTROW"){
_1b21=_1b29;
}else{
if(_1b28=="STARTCOL"){
_1b22=_1b29;
}else{
if(_1b28=="ENDROW"){
_1b23=_1b29;
}else{
if(_1b28=="ENDCOL"){
_1b24=_1b29;
}else{
if(_1b28=="REFSHEET"){
_1b25=_1b29;
_1b25=replaceSplChrs(_1b25);
}else{
if(_1b28=="ISRANGE"){
_1b26=_1b29;
}
}
}
}
}
}
}
}
}
updateNamedRanges(_1b16,_1b1f,_1b26,_1b20,_1b21,_1b22,_1b23,_1b24,_1b25,_1b17);
}
}
}
}
}
}
}
function updateNamedRanges(_1b2a,_1b2b,_1b2c,_1b2d,_1b2e,_1b2f,_1b30,_1b31,_1b32,_1b33){
if(_1b2b){
var _1b34=null;
if(_1b2a=="modify"||_1b2a==ActionConstants.NAMEDRANGE_MODIFY||_1b2a=="delete"||_1b2a==ActionConstants.NAMEDRANGE_DELETE){
for(var i=0;i<NAMEDRANGES.length;i++){
var _1b36=NAMEDRANGES[i];
var name=_1b36["NAME"];
if(_1b2b.toUpperCase().trim()==name.toUpperCase().trim()){
if(!_1b2c||_1b2a=="delete"||_1b2a==ActionConstants.NAMEDRANGE_DELETE){
NAMEDRANGES.splice(i,1);
deleteCellName(_1b2b);
}else{
_1b34=_1b36;
}
break;
}
}
}
if(_1b2a=="delete"||_1b2a==ActionConstants.NAMEDRANGE_DELETE){
return;
}
if(!_1b34){
_1b34=new Object();
_1b34["NAME"]=_1b2b;
if(_1b33){
_1b33.push(_1b34);
}else{
if(_1b2c){
NAMEDRANGES.push(_1b34);
}
}
}
_1b34["CONTENT"]=_1b2d;
_1b34["STARTROW"]=_1b2e;
_1b34["STARTCOLUMN"]=_1b2f;
_1b34["ENDROW"]=_1b30;
_1b34["ENDCOLUMN"]=_1b31;
_1b34["REFSHEET"]=_1b32;
if(_1b2c=="true"&&(_1b2a=="add"||_1b2a=="modify"||_1b2a=="read"||_1b2a==ActionConstants.NAMEDRANGE_ADD||_1b2a==ActionConstants.NAMEDRANGE_MODIFY)){
var _1b38=getCellRange();
if(_1b38.startRow==_1b2e&&_1b38.startCol==_1b2f&&_1b38.endRow==_1b30&&_1b38.endCol==_1b31&&CURRSHEETNAME==_1b32){
displayCellName(_1b2e,_1b2f,_1b30,_1b31,_1b32);
}
}
}
}
function displayCellName(sr,sc,er,ec,sheet){
var _1b3e="";
if(sheet.indexOf(" ")!=-1){
sheet="'"+sheet+"'";
}
for(var i=0;i<NAMEDRANGES.length;i++){
var _1b40=NAMEDRANGES[i];
var sRow=_1b40["STARTROW"];
var eRow=_1b40["ENDROW"];
var sCol=_1b40["STARTCOLUMN"];
var eCol=_1b40["ENDCOLUMN"];
var name=_1b40["NAME"];
var _1b46=_1b40["REFSHEET"];
if(sRow==sr&&eRow==er&&sCol==sc&&eCol==ec&&_1b46.toUpperCase().trim()==sheet.toUpperCase().trim()){
_1b3e=name;
break;
}
}
if(_1b3e!=""){
currCellIndicator.value=_1b3e;
currCellIndicator.title=_1b3e;
}
return _1b3e;
}
function deleteCellName(_1b47){
if(ISSAMESHEET=="true"){
if(currCellIndicator.value==_1b47){
var _1b48=getCellRange();
var _1b49=_1b48.startRow;
var _1b4a=_1b48.startCol;
var _1b4b=_1b48.endRow;
var _1b4c=_1b48.endCol;
if(_1b49-_1b4b==0&&_1b4a-_1b4c==0){
currCellIndicator.value=getColHeadLabel(_1b4c+1)+getRowHeadLabel(_1b4b);
}else{
if(_1b49<=_1b4b&&_1b4a<=_1b4c){
currCellIndicator.value=(_1b4b-_1b49+1)+"R x "+(_1b4c-_1b4a+1)+"C";
}else{
if(_1b4b<_1b49&&_1b4c<_1b4a){
currCellIndicator.value=(_1b49-_1b4b+1)+"R x "+(_1b4a-_1b4c+1)+"C";
}else{
if(_1b49<=_1b4b&&_1b4a>_1b4c){
currCellIndicator.value=(_1b4b-_1b49+1)+"R x "+(_1b4a-_1b4c+1)+"C";
}else{
if(_1b4b<_1b49&&_1b4a<=_1b4c){
currCellIndicator.value=(_1b49-_1b4b+1)+"R x "+(_1b4c-_1b4a+1)+"C";
}
}
}
}
}
}
}
}
function toggleCreateBtn(val,ev){
var _1b4f=true;
if(val.trim()==""){
_1b4f=false;
}
if(_1b4f){
getObj("name_createBtn").disabled=false;
}else{
getObj("name_createBtn").disabled=true;
}
}
function constructNameDialog(){
var _1b50="";
_1b50+="<table border='0' cellspacing='0' cellpadding='0' style='width:100%;table-layout:fixed;'><tr><td style='padding: 10px'>";
_1b50+="<table width='100%' border='0' cellspacing='0' cellpadding='0'><tr>";
_1b50+="<td height='25' nowrap style='padding-right:5px;width:1%;white-space:nowrap;'>"+jsMsg.AddNewName+"</td><td class='hsep'>&nbsp;</td></tr></table>";
_1b50+="<table width='100%' border='0' cellspacing='0' cellpadding='0' id='tbl_DN'><tr>";
_1b50+="<tr><td height='20'><input type='text' class='textField' style='width:170px;' id='defineCellName' value='' onkeyup='toggleCreateBtn(this.value, event);' onKeyPress='javascript:updateNameRangeEnter(this, event);'></td>";
_1b50+="<td nowrap style='padding:0px 5px;'>"+jsMsg.Refersto+":</td><td title='"+jsTitleMsg["CellReference.Tooltip"]+"' ><input type='text' class='textField cR' style='width:190px;' id='refCellTxt' value='' onfocus='updateFocusID(this);' onKeyPress='javascript:updateNameRangeEnter(this, event);'></td>";
_1b50+="<td align='right'><input id='name_createBtn' name='name_createBtn' type='button' class='button' style='width:60px;' disabled='true' value='"+jsTitleMsg.Add+"' onclick='addName();'></td></tr></table>";
_1b50+="<table width='100%' border='0' cellspacing='0' cellpadding='0' style='margin-top:10px;'><tr>";
_1b50+="<td height='25' nowrap style='padding-right:5px;width:1%;white-space:nowrap;'>"+jsMsg.DefinedNames+"</td><td class='hsep'>&nbsp;</td></tr></table>";
_1b50+="<div id='namesListDIV' style='max-height:146px;overflow:auto;'>";
_1b50+="<table id='namesListTbl' class='tableView' cellspacing='0' cellpadding='0' align='center' width='100%'><tbody id='namesListTBody'>";
_1b50+=constructNamesListHTML();
_1b50+="</tbody></table></div></td></tr></table>";
return _1b50;
}
function constructNamesListHTML(){
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
var _1b54=getXMLHttpRequest();
_1b54.open("POST",ctxpath+"namedRanges.do",false);
var _1b55=encodeURIComponent(CURRSHEETNAME);
var nvp="action=READALL&docid="+DOCUMENT_ID+"&curtime="+CURRENTTIME+"&sheetname="+_1b55+"&row="+row+"&column="+col+"&bridgeNo="+bridgeNumber+"&docowner="+CURR_DOC_OWNERNAME;
nvp+="&viewType="+getViewType()+"&isStockConfigured="+isStockConfigured+"&isDocSaved="+SAVED+"&fileFormat="+FILE_FORMAT;
nvp+="&availableStartRow="+getAvailableStartRow();
nvp+="&availableEndRow="+getAvailableEndRow();
nvp=appendCSRFToURL(nvp);
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols;
if(jsPUBLIC_VIEW){
nvp+="&loadObject="+LOAD_OBJECT_IN_PUBLIC;
}
_1b54.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_1b54.send(nvp);
var resp=_1b54.responseXML;
var _1b58=resp;
var _1b59=new Array();
if(_1b54.responseText!="Not Authorized"){
updateNamedRangesFromXml(_1b58,"read",_1b59);
}
var _1b5a="";
if(_1b59.length>0){
for(var i=0;i<_1b59.length;i++){
var _1b5c=_1b59[i];
var name=_1b5c["NAME"];
var _1b5e=_1b5c["CONTENT"];
_1b5a+=constructNameTrHTML(i,name,_1b5e);
}
}else{
_1b5a+=constructEmptyTrHtml();
}
return _1b5a;
}
function constructEmptyTrHtml(){
var html="";
html+="<tr class='trOdd' id='nameTR_0'>";
html+="<td align='center'>0 "+jsMsg.NamesDefined+"</td>";
html+="</td></tr>";
return html;
}
function constructNameTrHTML(cnt,cname,_1b62){
var _1b63=cname;
if(_1b63.length>18){
_1b63=_1b63.substring(0,18)+"...";
}
var _1b64=_1b62;
if(_1b64.length>18){
_1b64=_1b64.substring(0,18)+"...";
}
_1b62=replace(_1b62,"\"","&quot;");
var html="";
html+="<tr class='trOdd' id='nameTR_"+cnt+"'>";
html+="<td style='width: 170px; height: 22px;' id='nameTD_"+cnt+"' title='"+cname+"'><a href ='javascript:gotoCellByName(\""+cname+"\");'>"+_1b63+"</a></td>";
html+="<td style='width: 170px; height: 22px;'><input type='text' onfocus='updateFocusID(this);' onKeyPress='javascript:updateNameRangeEnter(this, event);' id='contentINPUT_"+cnt+"' value="+"\""+_1b62+"\""+" style='display:none;height:17px;'>";
html+="<span id='contentSPAN_"+cnt+"' cname='"+cname+"' title="+"\""+_1b62+"\""+">"+_1b64+"</span></td>";
html+="<td>";
html+="<a class='trActionLink' id='nameEditTD_"+cnt+"' onclick='defineNameActions("+cnt+", this);return false;' href='javascript:void(0);'>"+jsMsg.EditReference+"</a>";
html+="<a class='trActionLink' id='nameUpdateTD_"+cnt+"' style='display:none' onclick='defineNameActions("+cnt+", this);return false;' href='javascript:void(0);'>"+jsMsg.Update+"</a>";
html+="<span class='linkSep'> | </span>";
html+="<a class='trActionLink' id='nameCancelTD_"+cnt+"' style='display:none' onclick='defineNameActions("+cnt+", this);return false;' href='javascript:void(0);'>"+jsMsg.Cancel+"</a>";
html+="<a class='trActionLink' id='nameDeleteTD_"+cnt+"' onclick='defineNameActions("+cnt+", this);return false;' href='javascript:void(0);'>"+jsMsg.Delete+"</a>";
html+="</td></tr>";
return html;
}
function constructNameTrHTMLforIE(cnt,cname,_1b68){
var _1b69=cname;
if(_1b69.length>18){
_1b69=_1b69.substring(0,18)+"...";
}
var _1b6a=_1b68;
if(_1b6a.length>18){
_1b6a=_1b6a.substring(0,18)+"...";
}
var tr1=document.createElement("TR");
tr1.className="trOdd";
tr1.id="nameTR_"+cnt;
var td1=document.createElement("TD");
td1.style.width="170px";
td1.style.height="22px";
td1.id="nameTD_"+cnt;
td1.title=cname;
td1.innerHTML=_1b69;
tr1.appendChild(td1);
var td2=document.createElement("TD");
td2.style.width="170px";
td2.style.height="22px";
td2.innerHTML="<input type='text' onfocus='updateFocusID(this);' onKeyPress='javascript:updateNameRangeEnter(this, event);' id='contentINPUT_"+cnt+"' value="+"\""+_1b68+"\""+" style='display:none;'><span id='contentSPAN_"+cnt+"' cname='"+cname+"' title="+"\""+_1b68+"\""+">"+_1b6a+"</span>";
tr1.appendChild(td2);
var td3=document.createElement("TD");
var html="";
html+="<a class='trActionLink' id='nameEditTD_"+cnt+"' onclick='defineNameActions("+cnt+", this);return false;' href='javascript:void(0);'>"+jsMsg.EditReference+"</a>";
html+="<a class='trActionLink' id='nameUpdateTD_"+cnt+"' style='display:none' onclick='defineNameActions("+cnt+", this);return false;' href='javascript:void(0);'>"+jsMsg.Update+"</a>";
html+="<span class='linkSep'> | </span>";
html+="<a class='trActionLink' id='nameCancelTD_"+cnt+"' style='display:none' onclick='defineNameActions("+cnt+", this);return false;' href='javascript:void(0);'>"+jsMsg.Cancel+"</a>";
html+="<a class='trActionLink' id='nameDeleteTD_"+cnt+"' onclick='defineNameActions("+cnt+", this);return false;' href='javascript:void(0);'>"+jsMsg.Delete+"</a>";
td3.innerHTML=html;
tr1.appendChild(td3);
var _1b70=getObj("namesListTBody");
_1b70.appendChild(tr1);
}
function updateFocusID(obj){
FOCUSSEDNAMEINPUTOBJECT=obj;
}
function updateNameRangeEnter(_1b72,e){
var key;
var _1b75;
if(window.event){
key=window.event.keyCode;
}else{
if(e){
key=e.which;
}else{
return true;
}
}
_1b75=String.fromCharCode(key);
if(key==13){
if(_1b72.id=="defineCellName"||_1b72.id=="refCellTxt"){
addName();
}else{
var arr=_1b72.id.split("_");
var cnt=arr[1];
var _1b78=getObj("contentSPAN_"+cnt);
currentNamesListSPAN=_1b78;
var _1b79=currentNamesListSPAN.getAttribute("cname");
var cnt=currentNamesListSPAN.id.split("_")[1];
var _1b7a=getObj("contentINPUT_"+cnt).value;
modifyName(_1b79,_1b7a);
}
}
}
function defineNameActions(cnt,obj){
var id=obj.id;
var _1b7e=id.split("_")[1];
cnt=_1b7e;
var _1b7f=getObj("contentSPAN_"+cnt);
if(id.indexOf("nameEditTD_")!=-1){
resetNameEditRange();
currentNamesListSPAN=_1b7f;
_1b7f.style.display="none";
getObj("nameEditTD_"+cnt).style.display="none";
getObj("nameDeleteTD_"+cnt).style.display="none";
getObj("contentINPUT_"+cnt).style.display="";
getObj("nameUpdateTD_"+cnt).style.display="";
getObj("nameCancelTD_"+cnt).style.display="";
var _1b80=currentNamesListSPAN.getAttribute("cname");
for(var i=0;i<NAMEDRANGES.length;i++){
var _1b82=NAMEDRANGES[i];
var name=_1b82["NAME"];
var sht=_1b82["REFSHEET"];
if(sht&&_1b80.toUpperCase().trim()==name.toUpperCase().trim()){
var stRow=_1b82["STARTROW"];
var stCol=_1b82["STARTCOLUMN"];
var enRow=_1b82["ENDROW"];
var enCol=_1b82["ENDCOLUMN"];
if(sht.indexOf(" ")!=-1){
sht=sht.substring(1,sht.length-1);
}
if(CURRSHEETNAME.toUpperCase().trim()==sht.toUpperCase().trim()){
focusCellRangeFill(parseInt(stRow),parseInt(stCol),parseInt(enRow),parseInt(enCol));
}
break;
}
}
getObj("contentINPUT_"+cnt).focus();
}else{
if(id.indexOf("nameUpdateTD_")!=-1){
currentNamesListSPAN=_1b7f;
var _1b80=currentNamesListSPAN.getAttribute("cname");
var cnt=currentNamesListSPAN.id.split("_")[1];
var _1b89=getObj("contentINPUT_"+cnt).value;
modifyName(_1b80,_1b89);
FOCUSSEDNAMEINPUTOBJECT="";
resetCellRangeFill("definename");
}else{
if(id.indexOf("nameCancelTD_")!=-1){
var _1b8a=getObj("contentINPUT_"+cnt);
var _1b80=currentNamesListSPAN.getAttribute("cname");
_1b8a.value=getDefinedNameProperty(_1b80,"CONTENT");
resetNameEditRange();
resetCellRangeFill("definename");
_1b7f.style.display="";
getObj("nameEditTD_"+cnt).style.display="";
getObj("nameDeleteTD_"+cnt).style.display="";
_1b8a.style.display="none";
getObj("nameUpdateTD_"+cnt).style.display="none";
getObj("nameCancelTD_"+cnt).style.display="none";
FOCUSSEDNAMEINPUTOBJECT="";
}else{
if(id.indexOf("nameDeleteTD_")!=-1){
var _1b7f=getObj("contentSPAN_"+cnt);
currentNamesListSPAN=_1b7f;
var _1b80=currentNamesListSPAN.getAttribute("cname");
var _1b89=currentNamesListSPAN.innerHTML;
deleteName(_1b80,_1b89);
}
}
}
}
}
function resetNameEditRange(){
if(currentNamesListSPAN==""){
return;
}
var _1b8b=currentNamesListSPAN.id.split("_")[1];
getObj("contentSPAN_"+_1b8b).style.display="";
getObj("nameEditTD_"+_1b8b).style.display="";
getObj("nameDeleteTD_"+_1b8b).style.display="";
getObj("contentINPUT_"+_1b8b).style.display="none";
getObj("nameUpdateTD_"+_1b8b).style.display="none";
getObj("nameCancelTD_"+_1b8b).style.display="none";
}
function isDefinedName(_1b8c){
for(var i=0;i<NAMEDRANGES.length;i++){
var _1b8e=NAMEDRANGES[i];
var named=_1b8e["NAME"];
if(named.toUpperCase()==_1b8c.toUpperCase()){
return true;
}
}
return false;
}
function getDefinedNameProperty(name,_1b91){
var x=NAMEDRANGES.length;
while(x){
if(typeof _1b91!="undefined"&&!NAMEDRANGES[x-1][_1b91.toUpperCase()]){
return null;
}
if((NAMEDRANGES[x-1].NAME).toUpperCase()==name.toUpperCase()){
return (_1b91)?NAMEDRANGES[x-1][_1b91.toUpperCase()]:NAMEDRANGES[x-1];
}
--x;
}
return null;
}
function contextLoad(){
if(browser_ie||!swfobject.getFlashPlayerVersion().major){
return;
}
$("#contextCopyRow").mouseover(function(){
var _1b93=$(this);
var _1b94=$("#contextCopyDiv");
var _1b95=_1b93.outerWidth();
var _1b96=_1b93.outerHeight();
var map={"height":_1b96,"width":_1b95};
_1b94.css(map);
var _1b98=_1b93.offset();
if(_1b98==null){
return;
}
var _1b99={"left":_1b98.left+"px","top":_1b98.top+"px","z-index":"100000000000"};
_1b94.css(_1b99);
});
return;
}
function contextUnLoad(){
if(browser_ie||!swfobject.getFlashPlayerVersion().major){
return;
}
$("#contextCopyDiv").css("left","-1000px").css("top","-1000px");
}
function initializeContextCopy(){
var _1b9a={};
var _1b9b={menu:"false",wmode:"transparent",allowscriptaccess:"always"};
var _1b9c={};
var _1b9d=ctxpath+"flash/";
swfobject.embedSWF(_1b9d+"contextcopy.swf","contextCopyDiv",5,5,"9.0.0","",_1b9a,_1b9b,_1b9c,contextCopyFlashLoaded);
return;
}
function contextCopyFlashLoaded(e){
}
function contextCopyMouseMove(){
var _1b9f=document.getElementById("contextCopyRow");
Menu._itemMouseOver(_1b9f);
}
function contextCopyMouseLeave(){
$("#contextCopyDiv").mouseout();
}
function contextCopyMouseClick(){
hideMenu(Menu._currMenuId);
var data=copyCells("flash");
var _1ba1=document.getElementById("contextCopyDiv");
_1ba1.sendDataToFlash(data);
hideProgressMessage();
}
function message(text,disp,_1ba4,_1ba5){
var _1ba6=getObj("openmessage");
if(_1ba6==null){
return;
}
if(disp=="none"){
_1ba6.style.display=disp;
_1ba6.style.left=_1ba6.style.top="0px";
}else{
var _1ba7="";
if(typeof _1ba4!="undefined"){
_1ba7=" "+_1ba4.substring(0,15);
}
_1ba6.innerHTML=text+encodeHtml(_1ba7);
_1ba6.style.visibility="hidden";
_1ba6.style.display=disp;
if(_1ba5){
$(_1ba6).css("position","absolute");
$(_1ba6).css("top",(($(window).height()-$(_1ba6).outerHeight())/2)+$(window).scrollTop()+"px");
$(_1ba6).css("left",(($(window).width()-$(_1ba6).outerWidth())/2)+$(window).scrollLeft()+"px");
}else{
if(typeof getSheetWidth()=="undefined"||typeof getSheetHeight()=="undefined"){
var _1ba8=findClientDim();
_1ba6.style.left=((_1ba8.width/2)-(_1ba6.offsetWidth/2)-25)+"px";
_1ba6.style.top=((_1ba8.height/2)-(_1ba6.offsetHeight/2)-75)+"px";
}else{
_1ba6.style.left=((sheetLeft+(getSheetWidth()/2))-(_1ba6.offsetWidth/2)-25)+"px";
_1ba6.style.top=((sheetTop+(getSheetHeight()/2))-(_1ba6.offsetHeight/2)-75)+"px";
}
}
_1ba6.style.visibility="visible";
}
}
function replaceHTML(_1ba9){
_1ba9=_1ba9.replace(/colHeadFocus/gi,"");
_1ba9=_1ba9.replace(/rowHeadFocus/gi,"");
_1ba9=_1ba9.replace(/<IMG.*id.*ExcelGraph[^\"]+\"[^<]+/gi,"");
_1ba9=_1ba9.replace(/ charts\=\"[^"]+\"/gi,"");
_1ba9=_1ba9.replace(/<IMG.*id.*img_[^\"]+\"[^<]+/gi,"");
return _1ba9;
}
function setTotRowsandCols(){
var _1baa=getObj("sT");
var _1bab=getObj("initCols");
var _1bac=getObj("initRows");
var _1bad=getObj("tablewidth");
var _1bae=getObj("tableheight");
if(_1bab!=null){
_1bab.value=totCols;
}
if(_1bac!=null){
_1bac.value=totRows;
}
if(_1bad!=null&&_1baa!=null){
_1bad.value=_1baa.style.width;
}
if(_1bae!=null&&_1baa!=null){
_1bae.value=_1baa.style.height;
}
}
function sheetDefault(){
assignInitialValues();
SHEETSWITCH=true;
initSheet(ssServer,initSSWidth,initSSHeight,initCols,initRows,initColHeadHeight,initRowHeadWidth,initColWidth,initRowHeight,tablewidth,tableheight);
getisSheetWritable(DOCUMENT_ID,CURRSHEETNAME);
if(isSSActive){
resetWorkSheetDim();
if(isDocumentReadyToEdit){
if(!jsVERSION_VIEW){
if(jsREMOTE_SAVE_VIEW&&!HTMLVIEW){
}
if(DOCUMENT_ID=="doc_id"){
getFormulas();
}else{
getSheetImages();
}
}else{
getSheetImages(DOCUMENT_VERSION);
}
}
}
for(var i=0;i<SHAREDUSERSLIST.length;i++){
var _1bb0=SHAREDUSERSLIST[i];
var stat=_1bb0["cstatus"];
var user=_1bb0["uname"];
var _1bb3=_1bb0["zuid"];
if(stat=="1"){
var _1bb4=usercell[user];
if(_1bb4!=""){
var _1bb5=_1bb4.split("-");
var _1bb6={"user":user,"sheetname":_1bb5[0],"row":parseInt(_1bb5[1]),"col":parseInt(_1bb5[2]),"zuid":_1bb3};
Userpresence.show(_1bb6);
}
}
}
isSheetLoading=false;
}
function getCharts(docid,_1bb8,_1bb9){
if(docid!=null&&docid!="doc_id"){
var _1bba=new getXmlhttp();
_1bba.open("POST",ctxpath+"getCharts.do",true);
_1bba.onreadystatechange=function(){
if(_1bba.readyState==4){
if(_1bb9){
getChartsInfo(_1bba.responseXML,_1bb9);
}else{
getChartsInfo(_1bba.responseXML);
}
}
};
_1bb8=encodeURIComponent(_1bb8);
var _1bbb=false;
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
_1bbb=true;
}
_1bba.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_1bba.send("docid="+docid+"&sheetname="+_1bb8+"&isRemoteView="+_1bbb+"&docOwner="+CURR_DOC_OWNERNAME+"&curtime="+CURRENTTIME+"&READ_WRITE="+READ_WRITE+"&action="+_1bb9);
}
}
function getVersionCharts(docid,_1bbd,_1bbe){
if(docid!=null&&docid!="doc_id"){
var _1bbf=new getXmlhttp();
_1bbf.open("POST",ctxpath+"getCharts.do",true);
_1bbf.onreadystatechange=function(){
if(_1bbf.readyState==4){
getChartsInfo(_1bbf.responseXML);
}
};
_1bbd=encodeURIComponent(_1bbd);
_1bbf.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_1bbf.send("docid="+docid+"&sheetname="+_1bbd+"&version="+_1bbe+"&docOwner="+CURR_DOC_OWNERNAME);
}
}
var chartRenderingDIV;
function getChartsInfo(_1bc0,_1bc1){
if(typeof _1bc1=="undefined"){
_1bc1="GENERATE";
}
if(_1bc0!=null&&(_1bc0.hasChildNodes())){
var _1bc2="";
var _1bc3="";
var docid="";
if(_1bc0.firstChild.hasChildNodes()){
var _1bc5=_1bc0.firstChild.childNodes;
var _1bc6=_1bc5.length;
if(_1bc6>0){
if(ENTEREDPERFCHECK){
if(!SHEETSWITCH&&General.isLoggedIn&&!jsVERSION_VIEW&&CANREADWRITE&&((jsSHARE_VIEW&&!ALLOW_TO_WRITE)||ALLOW_TO_WRITE)){
disableToolBar(READ_WRITE);
getObj("waitmsg").innerHTML=jsMsg.RenderingCharts+"...";
}
}
}
for(var x=0;x<_1bc6;x++){
node=_1bc5.item(x);
HTMLCHARTINFO=new Array();
if(node.nodeName=="sheet"){
if(node.attributes){
var _1bc8=node.attributes;
if(_1bc8!=null&&_1bc8.length>0){
for(var cnt=0;cnt<_1bc8.length;cnt++){
var _1bca=_1bc8.item(cnt);
if(_1bca.nodeName=="action"){
_1bc2=_1bca.nodeValue;
}else{
if(_1bca.nodeName=="name"){
_1bc3=_1bca.nodeValue;
}else{
if(_1bca.nodeName=="docid"){
docid=_1bca.nodeValue;
}
}
}
}
}
}
}
if(node.nodeName=="charts"){
otherSheetRef=false;
if(_1bc3==CURRSHEETNAME&&docid==DOCUMENT_ID){
var attrs=node.attributes;
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="CP_CHART_DBID"){
HTMLCHARTINFO["CP_CHART_DBID"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_PLOT_ORIENTATION"){
HTMLCHARTINFO["CP_PLOT_ORIENTATION"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_GRAPHTYPE"){
HTMLCHARTINFO["CP_GRAPHTYPE"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_SHOW_LEGEND"){
HTMLCHARTINFO["CP_SHOW_LEGEND"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_DOCUMENTID"){
HTMLCHARTINFO["CP_DOCUMENTID"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_DOCUMENTSHEET_NAME"){
HTMLCHARTINFO["CP_DOCUMENTSHEET_NAME"]=CURRSHEETNAME;
}else{
if(attr.nodeName=="CP_DATARANGE"){
HTMLCHARTINFO["CP_DATARANGE"]=attr.nodeValue;
if(HTMLCHARTINFO["CP_DATARANGE"]!=null){
var _1bce=HTMLCHARTINFO["CP_DATARANGE"];
arr=_1bce.split(";");
for(var j=0;j<arr.length;j++){
shtname=arr[j].split(".");
shtrange=arr[j];
if(shtname.length>=2){
if(shtname[0]!=CURRSHEETNAME){
otherSheetRef=true;
}
}
}
}
}else{
if(attr.nodeName=="CP_DATAIN"){
HTMLCHARTINFO["CP_DATAIN"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_CHART_TITLE"){
HTMLCHARTINFO["CP_CHART_TITLE"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_LEFT"){
HTMLCHARTINFO["CP_LEFT"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_TOP"){
HTMLCHARTINFO["CP_TOP"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_HEIGHT"){
HTMLCHARTINFO["CP_HEIGHT"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_WIDTH"){
HTMLCHARTINFO["CP_WIDTH"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_SCOL"){
HTMLCHARTINFO["CP_SCOL"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_SROW"){
HTMLCHARTINFO["CP_SROW"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_SCOL_DIFF"){
HTMLCHARTINFO["CP_SCOL_DIFF"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_SROW_DIFF"){
HTMLCHARTINFO["CP_SROW_DIFF"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_CHART_X_LABEL"){
HTMLCHARTINFO["CP_CHART_X_LABEL"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_CHART_Y_LABEL"){
HTMLCHARTINFO["CP_CHART_Y_LABEL"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_CHART_PUBLICURL"){
HTMLCHARTINFO["CP_CHART_PUBLICURL"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_LABEL_FORMAT"){
HTMLCHARTINFO["CP_LABEL_FORMAT"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_FILENAME"){
HTMLCHARTINFO["CP_FILENAME"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_DOCUMNETOWNER"){
HTMLCHARTINFO["CP_DOCUMENTOWNER"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_FILEEXISTS"){
HTMLCHARTINFO["CP_FILEEXISTS"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_FIRSTCOL_LABEL"){
HTMLCHARTINFO["CP_FIRSTCOL_LABEL"]=attr.nodeValue;
}else{
if(attr.nodeName=="CP_FIRSTROW_LABEL"){
HTMLCHARTINFO["CP_FIRSTROW_LABEL"]=attr.nodeValue;
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
if(_1bc1=="REGENERATE"){
var chart=ExcelGraph.getInstance(getChartImgId(HTMLCHARTINFO["CP_CHART_DBID"]));
if(typeof (HTMLCHARTINFO["CP_CHART_DBID"])!="undefined"){
chart["CP_CHART_DBID"]=HTMLCHARTINFO["CP_CHART_DBID"];
}
if(typeof (HTMLCHARTINFO["CP_PLOT_ORIENTATION"])!="undefined"){
chart["CP_PLOT_ORIENTATION"]=HTMLCHARTINFO["CP_PLOT_ORIENTATION"];
}
if(typeof (HTMLCHARTINFO["CP_GRAPHTYPE"])!="undefined"){
chart["CP_GRAPHTYPE"]=HTMLCHARTINFO["CP_GRAPHTYPE"];
}
if(typeof (HTMLCHARTINFO["CP_SHOW_LEGEND"])!="undefined"){
chart["CP_SHOW_LEGEND"]=HTMLCHARTINFO["CP_SHOW_LEGEND"];
}
if(typeof (HTMLCHARTINFO["CP_DOCUMENTID"])!="undefined"){
chart["CP_DOCUMENTID"]=HTMLCHARTINFO["CP_DOCUMENTID"];
}
if(typeof (HTMLCHARTINFO["CP_DOCUMENTSHEET_NAME"])!="undefined"){
chart["CP_DOCUMENTSHEET_NAME"]=HTMLCHARTINFO["CP_DOCUMENTSHEET_NAME"];
}
if(typeof (HTMLCHARTINFO["CP_DATARANGE"])!="undefined"){
chart["CP_DATARANGE"]=HTMLCHARTINFO["CP_DATARANGE"];
}
if(typeof (HTMLCHARTINFO["CP_DATAIN"])!="undefined"){
chart["CP_DATAIN"]=HTMLCHARTINFO["CP_DATAIN"];
}
if(typeof (HTMLCHARTINFO["CP_CHART_TITLE"])!="undefined"){
chart["CP_CHART_TITLE"]=HTMLCHARTINFO["CP_CHART_TITLE"];
}
if(typeof (HTMLCHARTINFO["CP_LEFT"])!="undefined"){
chart["CP_LEFT"]=HTMLCHARTINFO["CP_LEFT"];
}
if(typeof (HTMLCHARTINFO["CP_TOP"])!="undefined"){
chart["CP_TOP"]=HTMLCHARTINFO["CP_TOP"];
}
if(typeof (HTMLCHARTINFO["CP_HEIGHT"])!="undefined"){
chart["CP_HEIGHT"]=HTMLCHARTINFO["CP_HEIGHT"];
}
if(typeof (HTMLCHARTINFO["CP_WIDTH"])!="undefined"){
chart["CP_WIDTH"]=HTMLCHARTINFO["CP_WIDTH"];
}
if(typeof (HTMLCHARTINFO["CP_SCOL"])!="undefined"){
chart["CP_SCOL"]=HTMLCHARTINFO["CP_SCOL"];
}
if(typeof (HTMLCHARTINFO["CP_SROW"])!="undefined"){
chart["CP_SROW"]=HTMLCHARTINFO["CP_SROW"];
}
if(typeof (HTMLCHARTINFO["CP_SROW_DIFF"])!="undefined"){
chart["CP_SROW_DIFF"]=HTMLCHARTINFO["CP_SROW_DIFF"];
}
if(typeof (HTMLCHARTINFO["CP_SCOL_DIFF"])!="undefined"){
chart["CP_SCOL_DIFF"]=HTMLCHARTINFO["CP_SCOL_DIFF"];
}
if(typeof (HTMLCHARTINFO["CP_CHART_X_LABEL"])!="undefined"){
chart["CP_CHART_X_LABEL"]=HTMLCHARTINFO["CP_CHART_X_LABEL"];
}
if(typeof (HTMLCHARTINFO["CP_CHART_Y_LABEL"])!="undefined"){
chart["CP_CHART_Y_LABEL"]=HTMLCHARTINFO["CP_CHART_Y_LABEL"];
}
if(typeof (HTMLCHARTINFO["CP_CHART_PUBLICURL"])!="undefined"){
chart["CP_CHART_PUBLICURL"]=HTMLCHARTINFO["CP_CHART_PUBLICURL"];
}
if(typeof (HTMLCHARTINFO["CP_LABEL_FORMAT"])!="undefined"){
chart["CP_LABEL_FORMAT"]=HTMLCHARTINFO["CP_LABEL_FORMAT"];
}
HTMLCHARTINFO=chart;
if(READ_WRITE){
createChart(HTMLCHARTINFO,_1bc1,"GENPUBLICCHART=true");
}else{
createChart(HTMLCHARTINFO,_1bc1);
}
}
}
}
if(_1bc1!="REGENERATE"){
var _1bd1=getViewType();
if(!(_1bd1=="OPEN_VIEW")&&!(_1bd1=="NEW_VIEW")&&!(_1bd1=="SHARE_VIEW")&&!(_1bd1=="PUBLIC_VIEW")){
createChart(HTMLCHARTINFO,_1bc1);
}else{
if(HTMLCHARTINFO["CP_FILEEXISTS"]=="NO"||otherSheetRef){
createChart(HTMLCHARTINFO,_1bc1);
}else{
var _1bd2=ctxpath+"ChartDisplay.do?u_n="+HTMLCHARTINFO["CP_DOCUMENTOWNER"]+"&currtime="+Math.floor(Math.random()*10001);
if(typeof HTMLCHARTINFO["CP_CHART_DBID"]!="undefined"){
_1bd2+="&i_n="+HTMLCHARTINFO["CP_CHART_DBID"];
}
if(typeof chartRenderingDIV=="undefined"||chartRenderingDIV==null){
var div=document.createElement("div");
var _1bd4="<img dbid = '"+HTMLCHARTINFO["CP_CHART_DBID"]+"' src = "+_1bd2+" border= \"0\" />";
div.id="chartRenderingDIV";
div.style.display="none";
div.innerHTML=_1bd4;
document.body.appendChild(div);
chartRenderingDIV=getObj("chartRenderingDIV");
}else{
var _1bd4="<img dbid = '"+HTMLCHARTINFO["CP_CHART_DBID"]+"' src = "+_1bd2+" border= \"0\" />";
chartRenderingDIV.innerHTML=_1bd4;
}
var img=chartRenderingDIV.getElementsByTagName("img")[0];
var b=1;
var a=ExcelGraph._INSCOUNT+b;
img.id="ExcelGraph"+a;
img.className="chart";
img.objType="chart";
img.width=HTMLCHARTINFO["CP_WIDTH"];
img.height=HTMLCHARTINFO["CP_HEIGHT"];
img.chartName=HTMLCHARTINFO["CP_CHART_TITLE"];
var _1bd8=HTMLCHARTINFO["CP_TOP"];
var _1bd9=HTMLCHARTINFO["CP_LEFT"];
img.style.top=_1bd8+"px";
img.style.left=_1bd9+"px";
sheetObjectsPane.appendChild(img);
ExcelGraph.createInstance(HTMLCHARTINFO);
setChartPermission();
actwd=null;
actht=null;
var _1bda=parseInt(img.style.left);
var _1bdb=parseInt(img.style.top);
insertImgorChartIsFreezed(img,img.style.left,img.style.top);
ole.init(img.id);
if(HTMLCHARTINFO["CP_SCOL"]!=-1){
ole(img.id).sCol=HTMLCHARTINFO["CP_SCOL"];
}else{
ole(img.id).sCol=findColInXPos(parseInt(img.style.left));
}
if(HTMLCHARTINFO["CP_SCOL_DIFF"]!=-1){
ole(img.id).sColDiff=HTMLCHARTINFO["CP_SCOL_DIFF"];
}else{
ole(img.id).sColDiff=_1bda-getColLeft(ole(img.id).sCol);
}
if(HTMLCHARTINFO["CP_SROW"]!=-1){
ole(img.id).sRow=HTMLCHARTINFO["CP_SROW"];
}else{
ole(img.id).sRow=findRowInYPos(parseInt(img.style.top));
}
if(HTMLCHARTINFO["CP_SROW_DIFF"]!=-1){
ole(img.id).sRowDiff=HTMLCHARTINFO["CP_SROW_DIFF"];
}else{
ole(img.id).sRowDiff=_1bdb-getRowTop(ole(img.id).sRow);
}
chart={};
chart["CP_SCOL"]=OLE[img.id].sCol;
chart["CP_SCOL_DIFF"]=OLE[img.id].sColDiff;
chart["CP_SROW"]=OLE[img.id].sRow;
chart["CP_SROW_DIFF"]=OLE[img.id].sRowDiff;
chart["CP_DATARANGE"]=HTMLCHARTINFO["CP_DATARANGE"];
chart["CP_CHARTID"]=img.id;
if(parseInt(ole(img.id).sColDiff)>parseInt(getColWidth(ole(img.id).sCol))){
var xPos=parseInt(getColLeft(ole(img.id).sCol))+parseInt(getColWidth(ole(img.id).sCol));
}else{
var xPos=(getColLeft(ole(img.id).sCol)+parseInt(ole(img.id).sColDiff));
}
if(parseInt(ole(img.id).sRowDiff)>parseInt(getRowHeight(ole(img.id).sRow))){
var yPos=parseInt(getRowTop(ole(img.id).sRow))+parseInt(getRowHeight(ole(img.id).sRow));
}else{
var yPos=(getRowTop(ole(img.id).sRow)+parseInt(ole(img.id).sRowDiff));
}
ole(img.id).moveTo(xPos,yPos);
UpdateChartCellRange(chart);
availChartRange[HTMLCHARTINFO["CP_CHART_DBID"]]=chart;
}
}
}
}
if(x==_1bc6-1){
if(_1bc1=="REGENERATE"){
return;
}
getComments();
}
}
}else{
if(ENTEREDPERFCHECK){
if(!SHEETSWITCH&&General.isLoggedIn&&!jsVERSION_VIEW&&CANREADWRITE&&((jsSHARE_VIEW&&!ALLOW_TO_WRITE)||ALLOW_TO_WRITE)){
getObj("waitmsg").style.display="none";
disableToolBar(READ_WRITE);
}
}
if(_1bc1=="REGENERATE"){
return;
}
getComments("true");
}
}else{
if(ENTEREDPERFCHECK){
if(!SHEETSWITCH&&General.isLoggedIn&&!jsVERSION_VIEW&&CANREADWRITE&&((jsSHARE_VIEW&&!ALLOW_TO_WRITE)||ALLOW_TO_WRITE)){
getObj("waitmsg").style.display="none";
disableToolBar(READ_WRITE);
}
}
if(_1bc1=="REGENERATE"){
return;
}
getComments("true");
}
getFormulas();
}
function getFormulas(){
var url=ctxpath+"getFormulas.do";
var _1bdf=new getXmlhttp();
_1bdf.open("POST",url,true);
_1bdf.onreadystatechange=function(){
if(_1bdf.readyState==4){
gridListener.listen(5);
loadFormulas(_1bdf.responseText);
var _1be0=eval("("+_1bdf.responseText+")");
for(var x in _1be0){
if(!isUndefined(_1be0[x].CONDITIONALFORMAT)){
var _1be2=_1be0[x].CONDITIONALFORMAT;
for(var y in _1be2){
updateCFChangesInHtmlClient(_1be2[y],false,encodeURIComponent(CURRSHEETNAME));
}
}
}
if(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE&&!CONTAINSMACRO&&!HASDRAWCONTROL&&!HASCONDITIONALFORMAT){
closeDocumentInstance(false);
}
}
};
var _1be4=encodeURIComponent(CURRSHEETNAME);
_1bdf.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var nvp="docid="+DOCUMENT_ID+"&curtime="+CURRENTTIME+"&sheetname="+_1be4+"&bridgeNo="+bridgeNumber+"&docowner="+CURR_DOC_OWNERNAME;
nvp+="&isStockConfigured="+isStockConfigured+"&isDocSaved="+SAVED+"&viewType="+getViewType();
nvp+="&usedCursRow="+usedCursRow+"&usedCursCol="+usedCursCol+"&fileFormat="+FILE_FORMAT;
if(jsPUBLIC_VIEW){
nvp+="&loadObject="+LOAD_OBJECT_IN_PUBLIC;
}
nvp+="&availableStartRow="+getAvailableStartRow();
nvp+="&availableEndRow="+getAvailableEndRow();
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols;
nvp+="&isDocContainsArrayFormula="+isDocContainsArrayFormula;
sendXMLHTTPRequest(_1bdf,nvp,true,false);
}
function loadFormulas(resp,rec){
var ret=eval(resp);
var len=0;
if(ret!=null&&ret!=""){
len=ret.length;
}
var _1bea="";
if(len>0){
if(READ_WRITE&&rec=="RECALCULATE"){
btn_enabled();
}
}
var _1beb=new Array();
var _1bec=0;
var _1bed=len-1;
if(rec=="RECALCULATE"){
_1bed=len;
var _1bee=ret[len-1];
if(_1bee&&_1bee.CONDITIONALFORMAT&&_1bee.CONDITIONALFORMAT!="null"&&_1bee.CONDITIONALFORMAT!="undefined"){
var _1bef=_1bee.CONDITIONALFORMAT;
for(var y in _1bef){
updateCFChangesInHtmlClient(_1bef[y],false,encodeURIComponent(CURRSHEETNAME));
}
}
}
if(_1bed==0){
if(rec!="RECALCULATE"){
if(!jsVERSION_VIEW){
}else{
}
}
}
for(var x=0;x<_1bed;x++){
var _1bee=ret[x];
var _1bf2=_1bee.SHEET;
var docid=_1bee.DOCUMENT;
if(rec!="RECALCULATE"){
if(docid!=DOCUMENT_ID||_1bf2!=CURRSHEETNAME){
break;
}
}else{
if(DOCUMENT_ID!="doc_id"){
if(docid!=DOCUMENT_ID){
break;
}
}
if(_1bf2!=CURRSHEETNAME){
break;
}
}
var row=parseInt(_1bee.ROW);
var _1bf5=parseInt(_1bee.COLUMN);
var _1bf6=_1bee.FORMULA;
var value=_1bee.RESULT;
var elem=getCell(row,_1bf5);
var _1bf9=updateFormula(elem,_1bf6,value);
_1beb.push(_1bf9.formulaElems);
_1bea=_1bf9.chartList;
if(ISFREEZED){
elem=getCell(row,_1bf5,sheetPane2Id);
var _1bfa=updateFormula(elem,_1bf6,value).formulaElems;
if(_1bfa){
_1beb.push(_1bfa);
}
elem=getCell(row,_1bf5,sheetPane3Id);
var _1bfb=updateFormula(elem,_1bf6,value).formulaElems;
if(_1bfb){
_1beb.push(_1bfb);
}
elem=getCell(row,_1bf5,sheetPane1Id);
var _1bfc=updateFormula(elem,_1bf6,value).formulaElems;
if(_1bfc){
_1beb.push(_1bfc);
}
}
if(x==_1bed-1){
if(rec!="RECALCULATE"){
if(!jsVERSION_VIEW){
}else{
}
}
}
}
if(rec!="RECALCULATE"){
var _1bee=ret[len-1];
if(_1bee&&_1bee.BRIDGENO!=""&&_1bee.BRIDGENO!="null"){
bridgeNumber=_1bee.BRIDGENO;
}
var _1bfd=ret[len-2];
if(_1bfd&&_1bfd.ARRAYDETAILS&&_1bfd.ARRAYDETAILS!="null"&&_1bfd.ARRAYDETAILS!="undefined"){
arrayDetails=eval(_1bfd.ARRAYDETAILS);
var sr=getAvailableStartRow();
var sc=getAvailableStartCol();
var er=getAvailableEndRow();
var ec=getAvailableEndCol();
fixArrayFormulaNotation(sr,sc,er,ec);
}
}
UpdateCellCharts(_1bea);
if(rec=="RECALCULATE"){
DoFades(_1beb);
hideProgressMessage();
}
message("","none");
}
function updateFormula(elem,_1c03,value){
var _1c05;
var _1c06="";
var _1c07=0;
if(elem!=null&&elem!="null"){
_1c05=elem;
elem.setAttribute("fn",replaceSplChrs(_1c03));
setCellContent(elem,replaceSplChrs(value));
if(elem.getAttribute("charts")!=null){
var _1c08=(elem.getAttribute("charts")).split(",");
if(_1c08!=null){
_1c06=_1c06+","+_1c08.join(",");
}
}
}
return {"formulaElems":_1c05,"chartList":_1c06};
}
function getSheetImages(_1c09){
if(DOCUMENT_ID=="doc_id"){
return;
}
if(typeof _1c09=="undefined"){
_1c09="";
}
if(_1c09==""){
if(General.isLoggedIn&&ENTEREDPERFCHECK){
}
}
var url=ctxpath+"getSheetImages.do";
var _1c0b=new getXmlhttp();
_1c0b.open("POST",url,true);
_1c0b.onreadystatechange=function(){
if(_1c0b.readyState==4){
loadImages(_1c0b.responseText);
}
};
var _1c0c=encodeURIComponent(CURRSHEETNAME);
_1c0b.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var nvp="docid="+DOCUMENT_ID+"&sheetname="+_1c0c+"&docowner="+CURR_DOC_OWNERNAME+"&viewType="+getViewType()+"&version="+_1c09;
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
nvp+="&apiKeyId="+getObj("apiKey").value;
}
_1c0b.send(nvp);
}
function loadImages(resp){
var ret=eval(resp);
var len=ret.length;
if(jsPUBLIC_VIEW&&HAS_FILTERS||!jsPUBLIC_VIEW){
Filter.doFilterAction("read");
}
if(!jsREMOTE_SAVE_VIEW&&!jsREMOTE_VIEW){
getControlComponent();
}
if(len==0){
if(!jsVERSION_VIEW){
getCharts(DOCUMENT_ID,CURRSHEETNAME);
}else{
getVersionCharts(DOCUMENT_ID,CURRSHEETNAME,DOCUMENT_VERSION);
}
}
for(var x=0;x<len;x++){
var _1c12=ret[x];
var _1c13=_1c12.SHEET;
var docid=_1c12.DOCUMENT;
if(docid!=DOCUMENT_ID||_1c13!=CURRSHEETNAME){
break;
}else{
if(DOCUMENT_ID!="doc_id"){
if(docid!=DOCUMENT_ID){
break;
}
}
if(_1c13!=CURRSHEETNAME){
break;
}
}
var _1c15=_1c12.IMGURL;
var imgid=_1c12.IMGID;
var _1c17=_1c12.SEQ_NUM;
var _1c18=_1c12.IMGNAME;
var _1c19=_1c12.IMGEXTN;
var _1c1a=_1c12.IMG_EXT_URL;
var left=_1c12.LEFT;
var top=_1c12.TOP;
var width=_1c12.WIDTH;
var _1c1e=_1c12.HEIGHT;
var actWd=_1c12.ACT_WIDTH;
var actHt=_1c12.ACT_HEIGHT;
var img=document.createElement("img");
if(_1c1a!=""){
img.src=_1c1a;
}else{
img.src=ctxpath+_1c15;
}
img.id="img_"+_1c17;
img.name=_1c18;
img.height=_1c1e;
img.width=width;
img.className="img";
img.objType="img";
img.setAttribute("imgid",imgid);
img.setAttribute("imgextn",_1c19);
img.setAttribute("exturl",_1c1a);
img.setAttribute("actwd",actWd);
img.setAttribute("actht",actHt);
var _1c22=top;
var _1c23=left;
img.style.top=_1c22+"px";
img.style.left=_1c23+"px";
sheetObjectsPane.appendChild(img);
setImagePermission();
actwd=null;
actht=null;
var _1c24=parseInt(img.style.left);
var _1c25=parseInt(img.style.top);
insertImgorChartIsFreezed(img,img.style.left,img.style.top);
ole.init(img.id);
if(_1c12.sCol!=-1){
ole(img.id).sCol=_1c12.sCol;
}else{
ole(img.id).sCol=findColInXPos(left);
}
if(_1c12.sColDiff!=-1){
ole(img.id).sColDiff=_1c12.sColDiff;
}else{
ole(img.id).sColDiff=_1c24-getColLeft(ole(img.id).sCol);
}
if(_1c12.sRow!=-1){
ole(img.id).sRow=_1c12.sRow;
}else{
ole(img.id).sRow=findRowInYPos(top);
}
if(_1c12.sRowDiff!=-1){
ole(img.id).sRowDiff=_1c12.sRowDiff;
}else{
ole(img.id).sRowDiff=_1c25-getRowTop(ole(img.id).sRow);
}
if(parseInt(ole(img.id).sColDiff)>parseInt(getColWidth(ole(img.id).sCol))){
var xPos=parseInt(getColLeft(ole(img.id).sCol))+parseInt(getColWidth(ole(img.id).sCol));
}else{
var xPos=(getColLeft(ole(img.id).sCol)+parseInt(ole(img.id).sColDiff));
}
if(parseInt(ole(img.id).sRowDiff)>parseInt(getRowHeight(ole(img.id).sRow))){
var yPos=parseInt(getRowTop(ole(img.id).sRow))+parseInt(getRowHeight(ole(img.id).sRow));
}else{
var yPos=(getRowTop(ole(img.id).sRow)+parseInt(ole(img.id).sRowDiff));
}
if(x==len-1){
if(!jsVERSION_VIEW){
getCharts(DOCUMENT_ID,CURRSHEETNAME);
}else{
getVersionCharts(DOCUMENT_ID,CURRSHEETNAME,DOCUMENT_VERSION);
}
}
}
}
function getControlComponent(){
var url=ctxpath+"getControlComponent.do";
var _1c29=new getXmlhttp();
_1c29.open("POST",url,true);
_1c29.onreadystatechange=function(){
if(_1c29.readyState==4){
loadControlComponent(_1c29.responseText);
}
};
var _1c2a=encodeURIComponent(CURRSHEETNAME);
_1c29.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var nvp="docid="+DOCUMENT_ID+"&curtime="+CURRENTTIME+"&sheetname="+_1c2a+"&docowner="+CURR_DOC_OWNERNAME;
nvp+="&viewType="+getViewType()+"&bridgeNo="+bridgeNumber;
if(jsVERSION_VIEW){
nvp+="&versionId="+DOCUMENT_VERSION;
}
_1c29.send(nvp);
}
function loadControlComponent(resp){
var ret=eval(resp);
if(typeof ret=="undefined"){
return;
}
var len=ret.length;
for(var x=0;x<len;x++){
var docid=ret[x].DOCUMENT;
ret[x].LABEL=decodeURIComponent(replace(ret[x].LABEL,"+"," "));
ret[x].SHEETNAME=decodeURIComponent(replace(ret[x].SHEETNAME,"+"," "));
var _1c31=ret[x].SHEETNAME;
if(docid!=DOCUMENT_ID||_1c31!=CURRSHEETNAME){
break;
}else{
if(DOCUMENT_ID!="doc_id"){
if(docid!=DOCUMENT_ID){
break;
}
}
if(_1c31!=CURRSHEETNAME){
break;
}
}
Button.create(ret[x]);
}
}
var oDialog,doc,srcEl,closeOnEscKey=true,closeOnBodyClick=false,iframeIEHack,onCloseCallBack,dialogHidden,dialogOpened;
var dialogProperties=new Array("position","top","left","height","width","srcElement","modal","draggable","title","closeButton","closeOnEscKey","transitionType","transitionInterval","closeOnBodyClick","freezeLayerBGColor","freezeLayerOpacity");
var dialogEl,dialogContentEl;
var onDialogOpen,onDialogClose;
var isModalDialog;
function showDialog(_1c32,_1c33,_1c34,_1c35){
if(typeof (_1c33)=="undefined"){
var _1c33="position=absmiddle";
}
_1c33=_1c33.split(",");
var _1c36;
for(var i=0;i<dialogProperties.length;i++){
_1c36=false;
for(var j=0;j<_1c33.length;j++){
if(_1c33[j].indexOf(dialogProperties[i])>=0){
_1c36=true;
break;
}
}
self["dialog_"+dialogProperties[i]]=(_1c36)?_1c33[j].substr(_1c33[j].indexOf("=")+1,_1c33[j].length).trim():"undefined";
}
if(document.getElementById("_DIALOG_LAYER")!=null){
closeDialog();
}
oDialog=document.createElement("DIV");
oDialog.id="_DIALOG_LAYER";
document.body.appendChild(oDialog);
dialogEl=oDialog;
if(typeof _1c35!="undefined"&&_1c35!=null){
onCloseCallBack=_1c35;
}
var _1c39=((typeof _1c32)!="string");
var _1c3a=_1c32;
_1c32="<div id=\"_DIALOG_CONTENT\">"+((_1c39)?"":_1c32)+"</div>";
var box="<table class=\"DialogBox\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><tr><td class=\"boxTL\">&nbsp;</td>";
if(dialog_draggable!="undefined"&&dialog_draggable=="no"){
box+="<td class=\"boxHeader\">";
}else{
box+="<td class=\"boxHeader drag\" onMouseDown=\"captureDialog(event)\">";
}
if(dialog_title!="undefined"){
if(dialog_title.charAt(0)=="'"&&dialog_title.charAt(dialog_title.length-1)=="'"){
dialog_title=dialog_title.substr(1,dialog_title.length-2);
}
if(dialog_title.trim().length==0){
dialog_title="&nbsp;";
}
}else{
dialog_title="&nbsp;";
}
box+=dialog_title+"</td><td class=\"boxCtrlButtonPane\">";
if(dialog_closeButton!="undefined"&&dialog_closeButton=="no"){
box+="&nbsp;</td>";
}else{
box+="<input type=\"button\" class=\"closeButton\" onClick=\"closeDialog();\"></td>";
}
box+="<td class=\"boxTR\">&nbsp;</td></tr><tr><td colspan=\"4\" class=\"boxContent\">"+_1c32+"</td></tr>";
box+="<tr><td class=\"boxBL\"></td><td class=\"boxBC\" colspan=\"2\"></td><td class=\"boxBR\"></td></tr></table>";
oDialog.style.display="block";
var _1c3c=true;
if(dialog_closeButton!="undefined"){
if(dialog_title=="&nbsp;"&&dialog_closeButton=="no"){
_1c3c=false;
}
}
if(_1c3c){
oDialog.innerHTML="<table cellpadding='0' cellspacing='0'><tr><td height='100%' style='display:;'>"+box+"</td></tr></table>";
}else{
oDialog.innerHTML="<table cellpadding='0' cellspacing='0'><tr><td height='100%' style='display:;'>"+_1c32+"</td></tr></table>";
}
oDialog.style.position="absolute";
oDialog.style.left="-1000px";
oDialog.style.top="-1000px";
oDialog.style.zIndex="100000";
var _1c3d=oDialog.getElementsByTagName("SCRIPT");
for(var i=0;i<_1c3d.length;i++){
var _1c3e=document.createElement("SCRIPT");
_1c3e.type="text/javascript";
_1c3e.language="javascript";
if(_1c3d[i].src!=""){
_1c3e.src=_1c3d[i].src;
}
_1c3e.text=_1c3d[i].text;
if(typeof document.getElementsByTagName("HEAD")[0]=="undefined"){
document.createElement("HEAD").appendChild(_1c3e);
}else{
document.getElementsByTagName("HEAD")[0].appendChild(_1c3e);
}
}
if(browser_opera){
var temp=_1c32;
var _1c40=oDialog.getElementsByTagName("STYLE");
for(var i=0;i<_1c40.length;i++){
_1c40[i].innerHTML=temp.substring(temp.indexOf("<style>")+7,temp.indexOf("</style>")-1);
temp=temp.substring(temp.indexOf("</style>")+8,temp.length);
}
}
if(dialog_width!="undefined"){
if(browser_ie){
oDialog.childNodes[0].style.width=parseInt(dialog_width)+"px";
}else{
if(browser_nn4||browser_nn6){
oDialog.childNodes.item(0).style.width=parseInt(dialog_width)+"px";
}
}
}
if(dialog_height!="undefined"){
if(browser_ie){
oDialog.childNodes[0].style.height=parseInt(dialog_height)+"px";
}else{
if(browser_nn4||browser_nn6){
oDialog.childNodes.item(0).style.height=parseInt(dialog_height)+"px";
}
}
}
oDialogContent=getObj("_DIALOG_CONTENT");
dialogContentEl=oDialogContent;
if(_1c39){
oDialogContent.appendChild(_1c3a);
}
var left=0,top=0;
if(browser_opera){
if(dialog_width!="undefined"){
oDialogContent.style.width=parseInt(dialog_width)+"px";
}else{
oDialogContent.style.width=oDialogContent.offsetWidth+"px";
oDialog.style.width=oDialogContent.offsetWidth+"px";
}
}
if(browser_nn4||browser_nn6){
if(dialog_width!="undefined"){
oDialogContent.style.width=parseInt(dialog_width)+"px";
}else{
oDialogContent.style.width=(oDialogContent.offsetWidth+20)+"px";
}
}
if(dialog_height!="undefined"){
if(browser_ie&&(parseInt(dialog_height)<oDialogContent.offsetHeight)){
left=-15;
}
oDialogContent.style.height=parseInt(dialog_height)+"px";
}
oDialogContent.style.overflow="auto";
var width=oDialog.offsetWidth;
var _1c44=oDialog.offsetHeight;
doc=findDocDim();
if(dialog_closeOnEscKey!="undefined"&&dialog_closeOnEscKey=="no"){
closeOnEscKey=false;
}else{
closeOnEscKey=true;
}
if(dialog_closeOnBodyClick!="undefined"&&dialog_closeOnBodyClick=="yes"){
closeOnBodyClick=true;
}else{
closeOnBodyClick=false;
}
if(!browser_opera){
if(dialog_modal!="undefined"&&dialog_modal=="yes"){
if(dialog_freezeLayerBGColor=="undefined"){
self["dialog_freezeLayerBGColor"]="";
}
if(dialog_freezeLayerOpacity=="undefined"){
self["dialog_freezeLayerOpacity"]="";
}
isModalDialog=true;
freezeBackground({"BGColor":dialog_freezeLayerBGColor,"opacity":dialog_freezeLayerOpacity});
}else{
if(document.getElementById("FreezeLayer")!=null){
document.body.removeChild(document.getElementById("FreezeLayer"));
isModalDialog=false;
}else{
isModalDialog=false;
}
}
}
if(dialog_left!="undefined"){
left+=parseInt(dialog_left);
}
if(dialog_top!="undefined"){
top+=parseInt(dialog_top);
}
var _1c45=(document.body.scrollLeft>0)?15:0;
var _1c46=(document.body.scrollTop>0)?15:0;
if(dialog_position!="undefined"&&dialog_position=="relative"){
if(dialog_srcElement!="undefined"){
srcEl=getObj(dialog_srcElement);
}else{
if(srcEl==null){
srcEl=document.body;
}
}
var _1c47=(srcEl.offsetWidth)?srcEl.offsetWidth:0;
var _1c48=(srcEl.offsetHeight)?srcEl.offsetHeight:0;
if(findPosX(srcEl)+width>doc.width-_1c45){
left+=findPosX(srcEl)+_1c47-width;
}else{
left+=findPosX(srcEl);
}
if(findPosY(srcEl)+_1c48+_1c44>doc.height-_1c46){
top+=findPosY(srcEl)-_1c44;
}else{
top+=findPosY(srcEl)+_1c48+2;
}
}else{
if(dialog_position!="undefined"&&dialog_position=="current"){
if(dialog_cursor_left!=null&&dialog_cursor_top!=null){
left=dialog_cursor_left;
top=dialog_cursor_top;
}else{
left=top=0;
}
left=(dialog_cursor_left!=null)?dialog_cursor_left:0;
top=(dialog_cursor_top!=null)?dialog_cursor_top:0;
if(left+width>doc.width-_1c45){
left-=width;
}
if(top+_1c44>doc.height-_1c46){
top-=_1c44;
}
}else{
if(dialog_position!="undefined"&&dialog_position=="absolute"){
if(dialog_left=="undefined"||dialog_left=="absmiddle"){
left=(doc.width/2)-(width/2)+document.body.scrollLeft;
}
if(dialog_top=="undefined"||dialog_top=="absmiddle"){
top=(doc.height/2)-(_1c44/2)+document.body.scrollTop;
}
left+=document.body.scrollLeft;
top+=document.body.scrollTop;
}else{
left=(doc.width/2)-(width/2)+document.body.scrollLeft+left;
top=(doc.height/2)-(_1c44/2)+document.body.scrollTop+top;
}
}
}
left=(left>0)?left:0;
top=(top>0)?top:0;
if(dialog_transitionType!="undefined"){
if(dialog_transitionInterval=="undefined"){
dialog_transitionInterval=10;
}
Effect.init({type:dialog_transitionType,speed:dialog_transitionInterval,layerId:"_DIALOG_LAYER",layerTop:top,layerLeft:left});
Effect.display();
}else{
oDialog.style.left=parseInt(left)+"px";
oDialog.style.top=parseInt(top)+"px";
}
if(browser_ie&&!browser_opera){
iframeIEHack=document.createElement("IFRAME");
iframeIEHack.scrolling="no";
iframeIEHack.frameBorder=0;
if(window["CONTEXT_PATH"]!=null){
iframeIEHack.src=CONTEXT_PATH+"/framework/html/blank.html";
}
iframeIEHack.style.position="absolute";
iframeIEHack.style.zIndex="99998";
iframeIEHack.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)";
if(dialog_modal!="undefined"&&dialog_modal=="yes"){
iframeIEHack.style.width=document.getElementById("FreezeLayer").style.width;
iframeIEHack.style.top="0px";
iframeIEHack.style.left="0px";
}else{
iframeIEHack.style.width=oDialog.offsetWidth+"px";
iframeIEHack.style.height=oDialog.offsetHeight+"px";
iframeIEHack.style.top=parseInt(top)+"px";
iframeIEHack.style.left=parseInt(left)+"px";
}
document.body.appendChild(iframeIEHack);
}
if(!browser_opera){
if(dialog_modal!="undefined"&&dialog_modal=="yes"){
var _1c49=0;
_1c49=setFreezeLayerHeight();
if(browser_ie){
iframeIEHack.style.height=_1c49;
}
}
}
dialogHidden=false;
dialogOpened=true;
if(typeof _1c34!="undefined"&&_1c34!=null&&_1c34!=""){
_1c34();
}
if(typeof onDialogOpen=="function"){
onDialogOpen();
}
return oDialog;
}
function freezeBackground(_1c4a){
var _1c4b=document.createElement("DIV");
_1c4b.id="FreezeLayer";
_1c4b.className="freezeLayer";
_1c4b.style.width="100%";
_1c4b.style.zIndex="99999";
if(_1c4a.BGColor!=""){
_1c4b.style.backgroundColor=_1c4a.BGColor;
}
if(_1c4a.opacity!=""){
var _1c4c=(_1c4a.opacity.indexOf("%")<0)?_1c4a.opacity:_1c4a.opacity.substr(0,_1c4a.opacity.length-1);
if(browser_ie){
_1c4b.style.filter="alpha(opacity="+_1c4c+")";
}else{
_1c4b.style.opacity=_1c4c/1000;
}
}
document.body.appendChild(_1c4b);
}
var diffLeft=0,diffTop=0;
function captureDialog(ev){
oDialog.style.cursor="move";
if(browser_ie){
diffLeft=window.event.clientX+document.body.scrollLeft-parseInt(findPosX(oDialog));
diffTop=window.event.clientY+document.body.scrollTop-parseInt(findPosY(oDialog));
}else{
if(browser_nn4||browser_nn6){
diffLeft=ev.pageX-parseInt(findPosX(oDialog));
diffTop=ev.pageY-parseInt(findPosY(oDialog));
}
}
document.onmousemove=moveDialog;
document.onmouseup=releaseDialog;
}
function moveDialog(ev){
clearTextSelection();
if(browser_ie){
var left=window.event.clientX+document.body.scrollLeft-diffLeft;
var top=window.event.clientY+document.body.scrollTop-diffTop;
left=(left>=0)?left:0;
top=(top>=0)?top:0;
if(document.getElementById("FreezeLayer")!=null||browser_opera){
oDialog.style.left=left+"px";
oDialog.style.top=top+"px";
}else{
oDialog.style.left=iframeIEHack.style.left=left+"px";
oDialog.style.top=iframeIEHack.style.top=top+"px";
}
}else{
if(browser_nn4||browser_nn6){
oDialog.style.left=((ev.pageX-diffLeft>0)?ev.pageX-diffLeft:0)+"px";
oDialog.style.top=((ev.pageY-diffTop>0)?ev.pageY-diffTop:0)+"px";
}
}
}
function releaseDialog(){
oDialog.style.cursor="default";
document.onmousemove=null;
document.onmouseup=null;
}
function closeDialog(_1c51){
if(oDialog!=null&&(oDialog.style.display!="none"||dialogHidden)){
oDialog.style.display="none";
if(document.getElementById("FreezeLayer")!=null){
document.body.removeChild(document.getElementById("FreezeLayer"));
}
if(browser_ie&&!browser_opera){
document.body.removeChild(iframeIEHack);
iframeIEHack=null;
}
closeOnBodyClick=false;
if(typeof _1c51!="undefined"&&_1c51.srcElement=="undefined"){
_1c51();
}
if(typeof onCloseCallBack!="undefined"&&onCloseCallBack!=null){
onCloseCallBack();
}
dialogHidden=false;
dialogOpened=false;
onCloseCallBack=null;
document.body.removeChild(oDialog);
oDialog=null;
dialogEl=null;
if(typeof onDialogClose=="function"){
onDialogClose();
}
}
}
function hideDialog(){
if(oDialog!=null&&oDialog.style.display!="none"){
oDialog.style.display="none";
var _1c52=document.getElementById("FreezeLayer");
if(_1c52!=null){
_1c52.style.display="none";
}
if(browser_ie&&!browser_opera){
iframeIEHack.style.display="none";
}
dialogHidden=true;
}
}
function recallDialog(){
if(oDialog!=null&&oDialog.style.display=="none"){
if(browser_ie&&!browser_opera){
iframeIEHack.style.display="";
}
var _1c53=document.getElementById("FreezeLayer");
if(_1c53!=null){
_1c53.style.display="";
}
oDialog.style.display="";
dialogHidden=false;
}
}
document.onkeydown=function(ev){
if(browser_ie){
var _1c55=window.event.keyCode;
}else{
if(browser_nn4||browser_nn6){
var _1c55=ev.which;
}
}
if(_1c55==27&&closeOnEscKey==true&&oDialog!=null&&oDialog.style.display!="none"){
closeDialog();
}
};
var dialog_cursor_left,dialog_cursor_top;
document.onmousedown=function(ev){
if(browser_ie){
srcEl=window.event.srcElement;
}else{
if(browser_nn4||browser_nn6){
srcEl=ev.target;
}
}
var _1c57=getCursorPos(ev);
var x=_1c57.x;
var y=_1c57.y;
dialog_cursor_left=x;
dialog_cursor_top=y;
if(typeof closeOnBodyClick!="undefined"&&closeOnBodyClick==true&&oDialog!=null&&oDialog.style.visibility!="hidden"){
if((x<findPosX(oDialog)||x>=findPosX(oDialog)+oDialog.offsetWidth)||(y<findPosY(oDialog)||y>=findPosY(oDialog)+oDialog.offsetHeight)){
closeDialog();
}
}
};
var scrollEnd=0,cnt=0;
function scrollPage(){
if(cnt<=scrollEnd){
document.body.scrollTop+=10;
cnt+=10;
}else{
scrollEnd=cnt=0;
clearInterval(scrollInterval);
}
}
function showURLInDialog(url,_1c5b,_1c5c,_1c5d,_1c5e){
callBack=function(_1c5f){
var _1c60=showDialog(_1c5f.responseText,_1c5b,_1c5c,_1c5e);
if(_1c5d){
_1c60.setAttribute("opener",_1c5d);
}
};
AjaxAPI.sendRequest({METHOD:"GET",URL:url,ONSUCCESSFUNC:callBack});
}
function closeParentDialog(_1c61,_1c62){
closeDialog();
if(_1c62){
var _1c63=DOMUtils.getParentWithAttr(_1c61,"opener");
AjaxAPI.refreshOpener({OPENER:_1c63.getAttribute("opener")});
}
}
if(browser_ie){
window.attachEvent("onresize",dialogWinResizeListener);
}else{
window.addEventListener("resize",dialogWinResizeListener,false);
}
function dialogWinResizeListener(){
if(dialogOpened&&isModalDialog){
setFreezeLayerHeight();
}
}
function setFreezeLayerHeight(){
var _1c64=0;
if(browser_ie){
if(document.documentElement.scrollHeight<document.documentElement.offsetHeight){
_1c64=document.documentElement.offsetHeight;
}else{
_1c64=document.documentElement.scrollHeight;
}
}else{
_1c64=document.body.scrollHeight;
}
document.getElementById("FreezeLayer").style.height=_1c64;
return _1c64;
}
Effect=function(){
};
Effect.init=function(_1c65){
if(typeof _1c65!="undefined"){
this.type=(typeof _1c65.type!="undefined")?_1c65.type:"boxIn( { } )";
this.speed=(typeof _1c65.speed!="undefined")?_1c65.speed:10;
this.layer=document.getElementById(_1c65.layerId);
this.layerId=_1c65.layerId;
this.layerLeft=_1c65.layerLeft;
this.layerTop=_1c65.layerTop;
if(typeof _1c65.layerContent=="undefined"||_1c65.layerContent==null||_1c65.layerContent==""){
this.layerContent=this.layer.innerHTML;
}else{
this.layerContent=_1c65.layerContent;
}
if(typeof _1c65.layerWidth=="undefined"||_1c65.layerWidth==null||_1c65.layerWidth==""){
this.layerWidth=this.layer.offsetWidth;
}else{
this.layerWidth=_1c65.layerWidth;
}
if(typeof _1c65.layerHeight=="undefined"||_1c65.layerHeight==null||_1c65.layerHeight==""){
this.layerHeight=this.layer.offsetHeight;
}else{
this.layerHeight=_1c65.layerHeight;
}
}else{
this.speed=10;
}
};
var xPoint,yPoint;
Effect.drawPath=function(x1,y1,x2,y2){
xPoint=new Array();
yPoint=new Array();
var dist=Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1));
var dx=(x2-x1)/dist;
var dy=(y2-y1)/dist;
for(var i=0;i<dist;i++){
xPoint[i]=x1+=dx;
yPoint[i]=y1+=dy;
}
};
var wArray,hArray;
Effect.buildSize=function(){
wArray=new Array();
hArray=new Array();
var _1c6e=this.layerHeight/this.layerWidth;
for(var i=0,j=0;i<=this.layerWidth;i+=1,j++){
wArray[j]=i;
hArray[j]=i*_1c6e;
}
};
var pitStops=0,dim=0,movCnt=0,dimCnt=0,effectIntvl;
Effect.display=function(){
var midX=this.layerLeft+parseInt(this.layerWidth/2);
var midY=this.layerTop+parseInt(this.layerHeight/2);
this.layer.style.left=midX+"px";
this.layer.style.top=midY+"px";
this.layer.style.width=this.layer.style.height="0px";
this.layer.style.overflow="hidden";
this.drawPath(this.layerLeft,this.layerTop,midX,midY);
movCnt=xPoint.length-1;
pitStops=(xPoint.length>5)?(xPoint.length-1)/5:1;
this.buildSize();
dim=wArray.length/(movCnt/pitStops);
effectIntvl=setInterval(eval("this."+this.type),this.speed);
};
Effect.boxIn=function(){
if(movCnt>0){
Effect.layer.style.left=xPoint[movCnt]+"px";
Effect.layer.style.top=yPoint[movCnt]+"px";
if(wArray[dimCnt]){
Effect.layer.style.width=wArray[dimCnt]+"px";
Effect.layer.style.height=hArray[dimCnt]+"px";
}
movCnt-=Math.round(pitStops);
dimCnt+=Math.round(dim);
}else{
Effect.layer.style.left=Effect.layerLeft+"px";
Effect.layer.style.top=Effect.layerTop+"px";
Effect.layer.style.width=Effect.layerWidth+"px";
Effect.layer.style.height=Effect.layerHeight+"px";
Effect.layer.style.overflow="";
pitStops=dim=movCnt=dimCnt=0;
window.clearInterval(effectIntvl);
}
};
var arrayDetails;
var ssServer="";
var isSSActive=true;
var spreadSheet,ssWidth,ssHeight,ssResizePane,ssResizeCue,ssLeft,ssTop,ssRightPanel,ssBottomPanel;
var ssHScrollResizePane,ssHScrollContainer,ssHScrollResizeCue,ssHScrollbarContainer,ssHScrollbar,ssHScrollDIV,ssHScrollEnd,ssVScrollStart,ssVScrollbar,ssVScrollDIV;
var sheetObjectsPane;
var colHeadContainer,rowHeadContainer;
var colHeadStart,colHead,colHeadHeight,colHeadTable,rowHead,rowHeadWidth,rowHeadTable,sheet,sheetTable;
var colHeadCells,rowHeadCells,sheetRightBit,sheetBottomBit;
var focusDIV,transSPAN,dummySPAN,cellFieldSPAN,cellField,resizePane,resizeOverlay;
var currCell,currCellHolder,currCellRange,currRow,currCol,currCellWidth,selRow,selCol;
var currCellContent,currCellValue,currCellFormula,currKeyCode;
var sheetLeft,sheetTop,sheetRight,sheetBottom,sheetWidth,sheetHeight;
var adjst=(browser_nn6)?-3:3;
var pgUpCnt=pgDownCnt=10;
var totRows=0,totCols=0;
var startRow=-1,startCol=-1,endRow=-1,endCol=-1;
var stdCellWidth,stdCellHeight;
var exprPanel,exprField,currCellIndicator;
var isF2KeyPressed,isDblClicked;
var isCellSelection;
var exprFieldKeyPressed=false;
var totalTableWidth,totalTableHeight;
var fillSeriesDIV,fillSeriesSPAN;
var currColTemp,currRowTemp;
var ancStyle=" style='text-decoration:underline;color:blue;cursor:pointer;' target='_blank'";
var cellRangeFillDIV,cellRangeFillSPAN;
var formulaCell=false;
var isExprFunc=false;
var tempPos=0;
var cellRangeStartIdx=0;
var cellRangeEndfIdx=0;
var forRangeHidden="";
var browserVersion=window.navigator.appVersion;
var spreadSheetWidth=0;
var ssParentElWidth=0;
var bandOffsetWidth=0;
var ssParentElHeight=0;
var rowHeadDIVAdjust=6;
var colHeadDIVAdjust=6;
var totValAsArr=[];
var currColOrdrArr=[];
var isAutoSuggestMenuOpen=false;
var EXPRCONTENTHEIGHT=16;
var collapsedExprField={};
var expandedExprField={};
var exprEqualExpandDiv={};
var exprArrowExpandDiv={};
var exprEqual={};
var colSelection=false;
var rowSelection=false;
var dummyTextArea={};
var isMouseEventInSheetScrollBar=false;
var exprEqualTable={};
var EXPRFIELD_EXPAND_HEIGHT=57;
var EXPRFIELD_COLLAPSE_HEIGHT=19;
var cellContentWidth=0;
var cellContentHeight=0;
var requiredCellWidth=0;
var requiredCellHeight=0;
var currRowOfCellfield=0;
var currColOfCellfield=0;
var isSuggestAvailable=false;
var maxCellFieldWidthInExprFieldNewMode=0;
var posOfCaret=0;
var startPosOfSelection=0;
var endPosOfSelection=0;
var scrolledHeightForExprField=0;
var scrolledHeightForCellField=0;
var isStylesAssignedForCellField=false;
var contentHeight=0;
var currentCellObject={};
var sheetHeightMaxInViewPort=0;
var sheetWidthMaxInViewPort=0;
var isEditingInExprField=false;
var isTextWrapped=false;
var contentNotReachedMaximumWidth=true;
var contentNotReachedMaximumheight=true;
var sheetScrollLeftMaxInViewPort=0;
var rowToFocusOnPageNavigation=undefined;
var isColumnSelected=false;
var isRowSelectd=false;
var isRangeSelection=false;
var tempFocusRow="";
var tempFocusCol="";
var colSelected;
var currColHead,currColHeadCOLTag,currColHeadCnt,currColHeadLeft,currColHeadWidth,colHeadTableWidth,currColHeadDIV;
var rowSelected;
var currRowHead,currRowHeadDIV,currRowHeadCnt,currRowHeadTop,currRowHeadHeight,rowHeadTableHeight;
var ssResizeType;
var cellRangeStartRow,cellRangeStartCol,cellRangeEndRow,cellRangeEndCol;
var cnt=0;
var rangeFill=false;
var isColResized=false;
var selectionLeft=-1;
var selectionTop=-1;
var quadName="DEFAULT";
var vertArea="DEFAULT";
var horiArea="DEFAULT";
var sheetScrollTopId;
var sheetScrollLeftId;
var tileHolder;
var currScrollTop=0;
var currScrollLeft=0;
var isVScrollFaceOnDrag=false;
var isHScrollFaceOnDrag=false;
var isUpArrowPressed=false;
var isDownArrowPressed=false;
var scrollFaceDragTimer=200;
var scrollArrowClickTimer=10;
var sheetHolder;
var availableStartRow;
var availableEndRow;
var firstRowInViewPort;
var lastRowInViewPort;
var selectedCellRange={};
var sheetTotalScrollHeight,sheetTotalScrollWidth;
var colMergeDetailStr;
var colMergeDetails;
var isChangeMadeAfterScroll=false;
var rowHeightAry=[];
var rowTopAry=[];
var colWidthAry=[];
var colLeftAry=[];
var mainTable;
var colHead1,colHead2,colHeadTable1,colHeadTable2;
var rowHead1,rowHead2,rowHeadTable1,rowHeadTable2;
var sheetPane1,sheetPane2,sheetPane3,sheetPane4;
var sheetTable1,sheetTable2,sheetTable3,sheetTable4;
var currTableId,currTableObj;
var freezedRowsHt,freezedColsWd;
var vFreezeCue,hFreezeCue;
var focusDIV1,focusDIV2,focusDIV3,focusDIV4;
var transSPAN1,transSPAN2,transSPAN3,transSPAN4;
var cellRangeFillDIV1,cellRangeFillDIV2,cellRangeFillDIV3,cellRangeFillDIV4;
var cellRangeFillSPAN1,cellRangeFillSPAN2,cellRangeFillSPAN3,cellRangeFillSPAN4;
var fillSeriesDIV1,fillSeriesDIV2,fillSeriesDIV3,fillSeriesDIV4;
var fillSeriesSPAN1,fillSeriesSPAN2,fillSeriesSPAN3,fillSeriesSPAN4;
var availChartRange={};
var DOCUMENT_REQUESTED_TIME;
var isDocumentReadyToEdit=true;
var docMetaDetails={};
var tileLoadTimeoutId;
var isTileLoaded;
var isVScrollFaceClicked;
var vScrollFaceClickedPos;
var updateTileCallbackInfo={"isCallbackAvailable":false,"actionDetails":{}};
var currSearchBarEl="";
var isHScrollbarRightArrowPressed=false;
var isDocumentRendered=true;
var noOfUpdateRequestInProgress=0;
var VIEW_REQUESTED_TIME;
var PAGES_PER_LOAD=1;
var prevRow=-1;
var prevCol=-1;
var dataResponse=null;
var rowsInRange=0;
var colsInRange=0;
var cellDragRange={"ASR":-1,"ASC":-1,"AER":-1,"AEC":-1,"CSR":-1,"CSC":-1,"CER":-1,"CEC":-1};
var cellDragProps={"ADR":-1,"ADC":-1,"cellDragRange":cellDragRange,"isDraggable":false};
var dragDIV,dragDIV1,dragDIV2,dragDIV3;
var moveCursorDIV;
var fillSeriesProps={mergedRightEndCol:-1,mergedRightColSpan:-1,mergedLeftEndCol:-1,mergedLeftColSpan:-1,mergedTopEndRow:-1,mergedTopRowSpan:-1,mergedBottomEndRow:-1,mergedBottomRowSpan:-1,isMergeCellExists:false,selectedStartRow:-1,selectedStartCol:-1,selectedEndRow:-1,selectedEndCol:-1,reset:function(){
this.mergedRightEndCol=-1;
this.mergedRightColSpan=-1;
this.mergedLeftEndCol=-1;
this.mergedLeftColSpan=-1;
this.mergedTopEndRow=-1;
this.mergedTopRowSpan=-1;
this.mergedBottomEndRow=-1;
this.mergedBottomRowSpan=-1;
this.isMergeCellExists=false;
this.selectedStartRow=-1;
this.selectedStartCol=-1;
this.selectedEndRow=-1;
this.selectedEndCol=-1;
}};
var WORKBOOK={};
var getWorkBook=function(){
if(!WORKBOOK["d"]){
this.book=new workBook();
}
return this.book;
};
var workBook=function(){
this.DATA_KEY="d";
WORKBOOK["noOfCells"]=0;
WORKBOOK[this.DATA_KEY]={};
return this;
};
workBook.prototype={getSheet:function(id){
return WORKBOOK[this.DATA_KEY][id];
},getSheets:function(){
return WORKBOOK[this.DATA_KEY];
},isSheetAvailable:function(id){
return ((this.getSheet(id))?true:false);
},reset:function(){
WORKBOOK={};
},addSheet:function(id){
if(!this.isSheetAvailable(id)){
var sheet=new workBook.sheet(id);
this.setSheet(id,sheet);
}
return this.getSheet(id);
},setSheet:function(id,sheet){
WORKBOOK[this.DATA_KEY][id]=sheet;
sheet.setName(id);
},deleteSheet:function(id){
if(this.isSheetAvailable(id)){
delete WORKBOOK[this.DATA_KEY][id];
}
},insertSheet:function(id){
addSheet(id);
},renameSheet:function(_1c7b,_1c7c){
var objct=WORKBOOK[this.DATA_KEY];
if(objct.hasOwnProperty(_1c7b)){
var sheet=objct[_1c7b];
this.setSheet(_1c7c,sheet);
this.deleteSheet(_1c7b);
}
},getCellCount:function(){
return WORKBOOK["noOfCells"];
}};
workBook.getDeficitRangeAry=function(_1c7f,_1c80,_1c81){
var _1c82=[];
var _1c83=(_1c7f/ROWS_PER_TILE);
var _1c84=!(_1c83%2);
var _1c85=_1c84?(_1c83/2):(_1c83-1)/2;
var _1c86=_1c80/ROWS_PER_TILE;
var _1c87=!(_1c86%2);
var _1c88=_1c87?(_1c86/2)-1:(_1c86-1)/2;
var _1c89=_1c87?_1c88-1:_1c88;
var _1c8a=_1c88-_1c85;
var book=getWorkBook();
var sheet=book.getSheet(_1c81);
var _1c8d;
if(sheet){
_1c8d=sheet.getDataAry();
}
var _1c8e=_1c85;
var _1c8f;
var _1c90;
if(_1c8d){
for(var i=_1c8a;i>=0;i--){
var _1c92=sheet.getDataByAryIndex(_1c8e);
if(_1c8e==_1c85&&_1c8e==_1c88){
if(_1c92){
var dI=_1c92.getStatus();
if(_1c84&&_1c87){
if(dI==2){
}else{
if(dI){
var sR=_1c8e*ROWS_PER_TILE*2;
var eR=sR+ROWS_PER_TILE;
}else{
var sR=_1c8e*ROWS_PER_TILE*2+ROWS_PER_TILE;
var eR=sR+ROWS_PER_TILE;
}
}
}else{
if(_1c84&&!_1c87){
if(dI==0||dI==2){
}else{
var sR=_1c8e*ROWS_PER_TILE*2;
var eR=sR+ROWS_PER_TILE;
}
}else{
if(!_1c84&&_1c87){
if(dI==1||dI==2){
}else{
var sR=_1c8e*ROWS_PER_TILE*2+ROWS_PER_TILE;
var eR=sR+ROWS_PER_TILE;
}
}else{
}
}
}
}else{
if(_1c84){
var sR=_1c8e*ROWS_PER_TILE*2;
}else{
var sR=_1c8e*ROWS_PER_TILE*2+ROWS_PER_TILE;
}
if(_1c87){
var eR=_1c8e*ROWS_PER_TILE*2+2*ROWS_PER_TILE;
}else{
var eR=_1c8e*ROWS_PER_TILE*2+ROWS_PER_TILE;
}
}
}else{
if(_1c8e==_1c85){
if(_1c92){
var dI=_1c92.getStatus();
if(_1c84){
if(dI==2){
}else{
if(dI){
var sR=_1c8e*ROWS_PER_TILE*2;
var eR=sR+ROWS_PER_TILE;
}else{
var sR=_1c8e*ROWS_PER_TILE*2+ROWS_PER_TILE;
var eR=sR+ROWS_PER_TILE;
}
}
}else{
if(dI>0){
}else{
var sR=_1c8e*ROWS_PER_TILE*2+ROWS_PER_TILE;
var eR=sR+ROWS_PER_TILE;
}
}
}else{
if(_1c84){
var sR=_1c8e*ROWS_PER_TILE*2;
var eR=sR+2*ROWS_PER_TILE;
}else{
var sR=_1c8e*ROWS_PER_TILE*2+ROWS_PER_TILE;
var eR=sR+ROWS_PER_TILE;
}
}
}else{
if(_1c8e==_1c88){
if(_1c92){
var dI=_1c92.getStatus();
if(_1c87){
if(dI==2){
}else{
if(dI){
var sR=_1c8e*ROWS_PER_TILE*2;
var eR=sR+ROWS_PER_TILE;
}else{
var sR=_1c8e*ROWS_PER_TILE*2+ROWS_PER_TILE;
var eR=sR+ROWS_PER_TILE;
}
}
}else{
if(dI==0||dI==2){
}else{
var sR=_1c8e*ROWS_PER_TILE*2;
var eR=sR+ROWS_PER_TILE;
}
}
}else{
if(_1c87){
var sR=_1c8e*ROWS_PER_TILE*2;
var eR=sR+2*ROWS_PER_TILE;
}else{
var sR=_1c8e*ROWS_PER_TILE*2;
var eR=sR+ROWS_PER_TILE;
}
}
}else{
if(_1c92){
var dI=_1c92.getStatus();
if(dI==2){
}else{
if(dI){
var sR=_1c8e*ROWS_PER_TILE*2;
var eR=sR+ROWS_PER_TILE;
}else{
var sR=_1c8e*ROWS_PER_TILE*2+ROWS_PER_TILE;
var eR=sR+ROWS_PER_TILE;
}
}
}else{
var sR=_1c8e*ROWS_PER_TILE*2;
var eR=sR+2*ROWS_PER_TILE;
}
}
}
}
if(typeof sR!="undefined"&&typeof eR!="undefined"){
var _1c96=false;
if(typeof _1c8f=="undefined"&&typeof _1c90=="undefined"){
_1c8f=sR;
_1c90=eR;
_1c96=true;
}else{
if(_1c90!=sR){
_1c8f=sR;
var _1c97=[sR,eR];
_1c82[_1c82.length]=_1c97;
_1c96=false;
}else{
_1c96=true;
}
_1c90=eR;
}
}
if(i==0&&_1c96){
var _1c97=[_1c8f,_1c90];
_1c82[_1c82.length]=_1c97;
}
_1c8e++;
}
}else{
var _1c97=[_1c7f,_1c80];
_1c82[_1c82.length]=_1c97;
}
return _1c82;
};
workBook.sheet=function(id){
this.DATA_KEY="d";
this.d=[];
this.name=id;
this.noOfCells=0;
};
workBook.sheet.tileUtil=function(row){
this.row=row;
this.tileIndex=row/ROWS_PER_TILE;
this.isEven=!(this.tileIndex%2);
if(this.isEven){
this.dataIndex=this.tileIndex/2;
}else{
this.dataIndex=(this.tileIndex-1)/2;
}
return this;
};
workBook.sheet.aryel=function(){
this.i;
this.d={};
};
workBook.sheet.aryel.prototype={getStatus:function(){
return this.i;
},getData:function(){
return this.d;
},changeStatus:function(_1c9a){
if(typeof this["i"]=="undefined"){
if(_1c9a){
this["i"]=0;
}else{
this["i"]=1;
}
}else{
this["i"]=2;
}
},addRow:function(row){
var _1c9c=this.getRow(row);
if(!_1c9c){
_1c9c=this.getData()[row]={};
}
return _1c9c;
},getRow:function(row){
return this.getData()[row];
},setRow:function(row,_1c9f){
this.getData()[row]=_1c9f;
}};
workBook.sheet.prototype={getName:function(){
return this.name;
},setName:function(name){
this.name=name;
},getDataAry:function(){
return this.d;
},setDataAry:function(_1ca1){
this.d=_1ca1;
},getDataByAryIndex:function(index){
return (this.getDataAry())[index];
},resetDataObject:function(row){
var objct=new workBook.sheet.tileUtil(row);
var _1ca5=this._getDataByAryIndex(objct.dataIndex);
if(!_1ca5){
_1ca5=this._addDataInAryIndex(objct.dataIndex);
}
_1ca5.changeStatus(objct.isEven);
this.updateCount();
return _1ca5;
},_getDataByAryIndex:function(_1ca6){
return this[this.DATA_KEY][_1ca6];
},_addDataInAryIndex:function(_1ca7){
this[this.DATA_KEY][_1ca7]=new workBook.sheet.aryel();
return this[this.DATA_KEY][_1ca7];
},reset:function(){
},clone:function(){
var _1ca8=new workBook.sheet();
_1ca8.setName(this.getName());
_1ca8.setDataAry(this.getDataAry());
return _1ca8;
},updateCount:function(){
this.noOfCells+=ROWS_PER_TILE;
var count=WORKBOOK["noOfCells"]+ROWS_PER_TILE;
WORKBOOK["noOfCells"]=count;
},getCellCount:function(){
return this.noOfCells;
}};
var gridListener={listen:function(_1caa){
var _1cab=true;
switch(_1caa){
case 0:
this.onDataUpdate();
break;
case 1:
this.onFormatUpdate();
break;
case 2:
this.onUndo();
break;
case 3:
this.onRedo();
break;
case 4:
this.onRecalculate();
break;
case 5:
_1cab=false;
this.onFormulaUpdate();
break;
case 6:
this.onHyperlink();
break;
case 7:
_1cab=false;
this.onCellAnnotRender();
break;
case 8:
this.onSort();
break;
case 9:
_1cab=false;
this.onWebDataUpdate();
break;
case 10:
this.onWebDataChange();
break;
case 11:
_1cab=false;
this.onMacroUpdate();
break;
case 12:
this.onMacroChange();
break;
}
if(_1cab){
this.onGridChange();
}
},onDataUpdate:function(){
},onFormatUpdate:function(){
},onUndo:function(){
},onRedo:function(){
},onRecalculate:function(){
},onFormulaUpdate:function(){
},onHyperlink:function(){
},onCellAnnotRender:function(){
},onSort:function(){
},onWebDataUpdate:function(){
},onWebDataChange:function(){
},onMacroUpdate:function(){
},onMacroChange:function(){
},onCustomFormat:function(){
},onGridChange:function(){
if(clearHiddenRowFormulas){
Row.clientData.hiddenRowsInfo={};
}
if(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE){
PUBLIC_EDIT_MODE=true;
}
return;
var book=getWorkBook();
book.reset();
}};
function updateDataInClient(_1cad,_1cae,_1caf,_1cb0){
var _1cb1=_1caf-_1cae+1;
var row=_1cae;
var sheet=getWorkBook().getSheet(_1cb0);
if(sheet){
sheet=book.addSheet(_1cb0);
}
do{
if(isTiledRow(row)){
var _1cb4=sheet.resetDataObject(row);
}
var _1cb5=_1cad[row];
if(_1cb5){
var objct=_1cb4.getRow(row);
if(!objct){
_1cb4.addRow(row);
}
_1cb4.setRow(row,_1cb5);
}
row++;
_1cb1--;
}while(_1cb1);
}
var workbookData=new Object();
var jsonWorkbookObj=function(){
if(workbooksheets==null){
workbooksheets=constructClientJson();
}
var scnt=workbooksheets.sheetcnt;
var sheet,data;
for(var x=0;x<=scnt;x++){
sheet=workbooksheets["sheet"+x];
if(sheet!=undefined){
workbookData.shNm=sheet.sheetName;
if(workbookData.preSheetName==sheet.sheetName){
sheet.activeRowIndex=workbookData.preActiveRow;
sheet.activeColIndex=workbookData.preActiveCol;
sheet.activeERowIndex=workbookData.endRow;
sheet.activeEColIndex=workbookData.endCol;
sheet.positionBottom=workbookData.posBtm;
sheet.positionLeft=workbookData.posLft;
}
}
}
return workbooksheets;
};
function constructClientJson(){
var tab=getObj("sheetsTab").getElementsByTagName("TD");
var _1cbc=new Array();
var _1cbd=[];
for(var i=0;i<tab.length-1;i++){
var _1cbf={};
_1cbc[i]=tab[i].getAttribute("sheetname");
_1cbf["sheetName"]=_1cbc[i];
_1cbf["activeRowIndex"]=0;
_1cbf["activeColIndex"]=0;
_1cbf["activeERowIndex"]=0;
_1cbf["activeEColIndex"]=0;
_1cbf["positionBottom"]=0;
_1cbf["positionLeft"]=0;
_1cbd["sheet"+i]=_1cbf;
_1cbd["sheetcnt"]=tab.length-1;
}
return _1cbd;
}
function addSheetInJson(_1cc0,_1cc1){
var _1cc2=parseInt(_1cc1);
var _1cc3={};
_1cc3["sheetName"]=_1cc0;
_1cc3["activeRowIndex"]=0;
_1cc3["activeColIndex"]=0;
_1cc3["activeERowIndex"]=0;
_1cc3["activeEColIndex"]=0;
_1cc3["positionBottom"]=0;
_1cc3["positionLeft"]=0;
workbooksheets["sheet"+_1cc2]=_1cc3;
workbooksheets["sheetcnt"]=_1cc1;
return workbooksheets;
}
function renameSheetInJson(_1cc4,_1cc5){
var _1cc6=workbooksheets.sheetcnt;
var sheet;
for(var x=0;x<_1cc6;x++){
sheet=workbooksheets["sheet"+x];
if(_1cc4==sheet.sheetName){
sheet.sheetName=_1cc5;
}
}
}
function deleteSheetInJson(_1cc9){
var _1cca=workbooksheets.sheetcnt;
var sheet;
for(var x=0;x<_1cca;x++){
sheet=workbooksheets["sheet"+x];
if(sheet!=undefined){
if(_1cc9==sheet.sheetName){
delete workbooksheets["sheet"+x];
workbooksheets["sheetcnt"]=_1cca-1;
}
}
}
}
function copySheetInJson(_1ccd,_1cce){
var _1ccf={};
var _1cd0=workbooksheets.sheetcnt;
var sheet;
var _1cd2=parseInt(TOTALSHEETS);
for(var x=0;x<=_1cd0;x++){
sheet=workbooksheets["sheet"+x];
if(sheet!=undefined){
if(sheet.sheetName==_1ccd){
_1ccf["sheetName"]=_1cce;
_1ccf["activeRowIndex"]=sheet.activeRowIndex;
_1ccf["activeColIndex"]=sheet.activeColIndex;
_1ccf["activeERowIndex"]=sheet.activeERowIndex;
_1ccf["activeEColIndex"]=sheet.activeEColIndex;
_1ccf["positionBottom"]=sheet.positionBottom;
_1ccf["positionLeft"]=sheet.positionLeft;
workbooksheets["sheet"+_1cd2]=_1ccf;
workbooksheets["sheetcnt"]=_1cd0+1;
}
}
}
return workbooksheets;
}
function initSheet(_1cd4,_1cd5,_1cd6,_1cd7,_1cd8,_1cd9,_1cda,_1cdb,_1cdc,_1cdd,_1cde,_1cdf){
$=jQuery;
tileHolder=getObj("tileHolder");
sheetHolder=getObj("sheetHolder");
cellFieldSPAN=getObj("cF");
cellField=getObj("cF");
var _1ce0=JSON.parse(colDetailStr);
colWidthAry=_1ce0[0];
colLeftAry=_1ce0[1];
var _1ce1=JSON.parse(rowDetailStr);
setRowDetails("LOAD",_1ce1);
if(!isDocumentReadyToEdit){
if(!docMetaDetails.CURRSHEETNAME){
docMetaDetails[CURRSHEETNAME]={};
}
docMetaDetails[CURRSHEETNAME]["ROW_HT"]=rowDetailStr;
docMetaDetails[CURRSHEETNAME]["USED_COL"]=usedCursCol;
docMetaDetails[CURRSHEETNAME]["USED_ROW"]=usedCursRow;
}
colMergeDetails={};
arrayDetails=new Array();
colDetailStr="";
rowDetailStr="";
_1cd4=_1cd4;
spreadSheet=getObj("spreadSheet");
ssWidth=_1cd5;
ssHeight=_1cd6;
var _1ce2=getObj("poweredByDIV");
if(_1ce2!=null){
poweredByObjHt=_1ce2.offsetHeight;
}
ssWidthIn=(ssWidth.indexOf("%")>-1)?"percentage":"fixed";
ssHeightIn=(ssHeight.indexOf("%")>-1)?"percentage":"fixed";
ssBottomPanel=getObj("ssBottomPanel");
ssRightPanel=getObj("ssRightPanel");
ssHScrollContainer=getObj("ssHScrollContainer");
ssHScrollResizePane=getObj("ssHScrollResizePane");
ssHScrollResizeCue=getObj("ssHScrollResizeCue");
ssHScrollbarContainer=getObj("ssHScrollbarContainer");
ssHScrollEnd=getObj("ssHScrollEnd");
ssHScrollbar=getObj("ssHScrollbar");
ssVScrollbar=getObj("ssVScrollbar");
ssHScrollDIV=ssHScrollbar.getElementsByTagName("DIV")[0];
ssVScrollDIV=ssVScrollbar.getElementsByTagName("DIV")[0];
ssResizePane=getObj("ssResizePane");
ssResizeCue=getObj("ssResizeCue");
colHeadHeight=parseInt(_1cd9);
rowHeadWidth=parseInt(_1cda);
colHeadStart=getObj("cHSt");
colHeadContainer=getObj("cHCont");
colHead=getObj("cH");
colHeadTable=getObj("cHT");
exprPanel=getObj("eP");
exprField=getObj("Tv");
currCellIndicator=getObj("Trc");
rowHeadContainer=getObj("rHCont");
rowHead=getObj("rH");
rowHeadTable=getObj("rHT");
sheet=getObj("sheet");
sheetObjectsPane=getObj("sOP");
(typeof ole!=="undefined")&&ole.setWorkSpace(sheetObjectsPane);
if(browser_safari){
sheet.addEventListener("mousewheel",mousewheel.scroll);
}else{
if(!browser_opera&&browser_nn6){
sheet.addEventListener("DOMMouseScroll",mousewheel.scroll,false);
}else{
if(browser_ie){
sheet.attachEvent("onmousewheel",mousewheel.scroll);
}else{
if(browser_opera){
sheet.attachEvent("onmousewheel",mousewheel.scroll);
}
}
}
}
sheetTable=getObj("sT");
sheetPane=getObj("sP");
focusDIV=getObj("fD");
userPresencePane=getObj("uPP");
userPresencePane1=getObj("uPP1");
userPresencePane2=getObj("uPP2");
userPresencePane3=getObj("uPP3");
dragDIV=getObj("dragDIV");
dragDIV1=getObj("dragDIV1");
dragDIV2=getObj("dragDIV2");
dragDIV3=getObj("dragDIV3");
transSPAN=getObj("tS");
dummySPAN=getObj("dummySPAN");
fillSeriesDIV=getObj("fSD");
fillSeriesSPAN=getObj("fSS");
cellRangeFillDIV=getObj("fCROD");
cellRangeFillSPAN=getObj("fCRID");
forRangeHidden="";
resizePane=getObj("resizePane");
resizeOverlay=getObj("resizeOverlay");
expandedExprField=getObj("eFTE");
collapsedExprField=getObj("eFTC");
exprEqualExpandDiv=getObj("eTExp");
exprArrowExpandDiv=getObj("eFTExp");
exprEqual=getObj("eE");
dummyTextArea=getObj("dummyTextArea");
exprEqualTable=getObj("eETable");
totCols=_1cd7;
stdCellWidth=_1cdb;
stdCellHeight=_1cdc;
vFreezeCue=getObj("vFreezeCue");
hFreezeCue=getObj("hFreezeCue");
sheetPane1=getObj("sP1");
sheetPane2=getObj("sP2");
sheetPane3=getObj("sP3");
sheetTable1=getObj("sT1");
sheetTable2=getObj("sT2");
sheetTable3=getObj("sT3");
rowHead1=getObj("rH1");
rowHeadTable1=getObj("rHT1");
colHead1=getObj("cH1");
colHeadTable1=getObj("cHT1");
focusDIV1=getObj("fD1");
focusDIV2=getObj("fD2");
focusDIV3=getObj("fD3");
transSPAN1=getObj("tS1");
transSPAN2=getObj("tS2");
transSPAN3=getObj("tS3");
fillSeriesDIV1=getObj("fSD1");
fillSeriesDIV2=getObj("fSD2");
fillSeriesDIV3=getObj("fSD3");
fillSeriesSPAN1=getObj("fSS1");
fillSeriesSPAN2=getObj("fSS2");
fillSeriesSPAN3=getObj("fSS3");
cellRangeFillDIV1=getObj("fCROD1");
cellRangeFillDIV2=getObj("fCROD2");
cellRangeFillDIV3=getObj("fCROD3");
cellRangeFillSPAN1=getObj("fCRID1");
cellRangeFillSPAN2=getObj("fCRID2");
cellRangeFillSPAN3=getObj("fCRID3");
Merge.reset();
filterIconsPane=getObj("fIP");
filterIconsPane1=getObj("fIP1");
filterIconsPane2=getObj("fIP2");
filterIconsPane3=getObj("fIP3");
collapsedExprField.style.display="";
expandedExprField.style.display="none";
isEditingInExprField=false;
if(jsGADGET_VIEW){
wmsBarHt=0;
}
setSheetDim();
totRows=Row.findMaxRowToRender();
var _1ce3=getSheetWidth();
totalTableWidth=getColLeft(totCols-1)+getColWidth(totCols-1);
if(totalTableWidth<_1ce3){
var _1ce4=getDefaultColHdr();
while(totalTableWidth-80<_1ce3){
var _1ce5=_1ce4.cloneNode(true);
_1ce5.style.width=getColWidth(totCols)+"px";
_insertColHead(1,_1ce5,totCols,"after",getColWidth(totCols));
totalTableWidth=getColLeft(totCols)+getColWidth(totCols);
totCols+=1;
}
}
totalTableHeight=(totRows>0)?getRowTop(totRows-1)+getRowHeight(totRows-1):0;
var _1ce6=getScrollBarDIM();
H_SCROLLBAR_HEIGHT=_1ce6;
V_SCROLLBAR_WIDTH=(_1ce6<18)?18:_1ce6;
if(browser_nn6){
ssVScrollbar.style.width=V_SCROLLBAR_WIDTH+"px";
ssHScrollbar.style.height=H_SCROLLBAR_HEIGHT+"px";
}
setSheetTableHeight(totalTableHeight);
setSheetTableWidth(totalTableWidth);
if(!(os_mac&&browser_ff3)){
restrictTextSelection(sheetTable);
restrictTextSelection(focusDIV);
}
if(!isUndefined(editedFormulaCellInfo.cellFieldDetails.CF_VALUE)){
var _1ce7=changeFormulaCellValue(editedFormulaCellInfo.cellFieldDetails.CF_VALUE);
exprField.value=cellField.value=_1ce7;
cellField.className=editedFormulaCellInfo.cellFieldDetails.CF_CLSNAME;
diminishCellField();
if(!jsEMBED_VIEW){
setCaretPos(cellField,formulaEIdxTemp);
}
}else{
if(browser_ie){
cellField.style.visibility="visible";
}
if(!jsEMBED_VIEW){
setCaretPos(cellField,0);
}
isCellFieldSPANHided.isHided=true;
}
var _1ce8=getSheetHeight();
var _1ce9=findRowInYPos(2*_1ce8);
_1cd8=getCeilRow(_1ce9);
isRespondedInScroll=true;
firstRowInViewPort=0;
lastRowInViewPort=0;
availableStartRow=0;
availableEndRow=0;
if(browser_safari){
var _1cea="1px";
var cF=getObj("cF");
var cF1=getObj("cF1");
var cF2=getObj("cF2");
var cF3=getObj("cF3");
cF.style.width=_1cea;
cF.style.height=_1cea;
cF1.style.width=_1cea;
cF1.style.height=_1cea;
cF2.style.width=_1cea;
cF2.style.height=_1cea;
cF3.style.width=_1cea;
cF3.style.height=_1cea;
}
var _1cef=fromGoTo;
updateTileCallbackInfo.isCallbackAvailable=true;
updateTileCallbackInfo.actionDetails={"action":"SHEET_OPEN","pageScrollState":"UNLOADED_SHEET","callbackMethod":sheetLoadCallBack};
if(dataResponse&&dataResponse!="null"){
isRespondedInScroll=false;
updateTile(dataResponse,200,"OK");
}else{
loadXTileIfVacantInViewPort();
}
if((_1cdf!=true)&&(tmpSheetName==CURRSHEETNAME)&&(insertCopyRows||insertCutRows||insertCopyCols||insertCutCols)){
focusCellRangeFill(copyRangeEndRow,copyRangeEndCol,copyRangeStartRow,copyRangeStartCol,false);
}
documentUtilities();
if($.ui){
initialiseFormulaAutoComplete();
}
}
function initUIComponents(){
$(document).one("componentinitialized",function(e,ui){
$("#topBand").css("visibility","visible");
$("#main").css("visibility","visible");
$("#editorDIV").css("visibility","visible");
$("#addSheetBtn").show();
zswidgets.init();
if(!jsTHROWAWAY_VIEW){
DOC_PANEL.init();
}
});
$.ZContextMenu.registerColorpalette();
$("#bgcolor").children("span:first").css({"border-bottom":"3px solid #FFFF00"});
$("#fontcolor").children("span:first").css({"border-bottom":"3px solid \t#FF0000"});
menutab.init($("body"));
$.ui.utils.initComponents($("#menutabs"));
zsmouse.init();
if(!toolbarinited||jsVERSION_VIEW){
$.ZToolbarHandler.init(["#toolbarContainer","#popupmenu","#versionview"]);
toolbarinited=false;
}
if(TEMPLATE_FLAG=="true"){
$("#sharetw").hide();
$("#templateicon").show();
}else{
$("#sharetw").show();
$("#templateicon").hide();
}
var _1cf2=["openfile","share"];
$.each(_1cf2,function(i){
$("#"+_1cf2[i]).bind("click",function(){
closeDialog();
$(".ui-icon-closethick").click();
});
});
$(".ui-dialog").bind("dialogfocus",function(event,ui){
if($("#createRuleContent").length==0){
if(dialogOpened){
closeDialog();
}
}
});
var _1cf6=$(".ui-zadvcolorpalette");
_1cf6.parent().css("zIndex",999999);
_1cf6.parent().bind("dialogfocus",function(event,ui){
_1cf6.parent().css("zIndex",999999);
$("#menutabs :input").css("zIndex",999);
});
var _1cf9=$("#docnamepart");
(jsPUBLIC_VIEW||jsGUEST_VIEW||jsREMOTE_VIEW||jsTRASH_VIEW)?_1cf9.removeClass("fileNameEditable").addClass("fileNameOthers"):_1cf9.removeClass("fileNameOthers").addClass("fileNameEditable");
(orgName==""&&isDocumentPublic)?$("#orgembed").hide():$("#orgembed").show();
(!isDocumentPublic||jsPUBLIC_VIEW)?$("#extpub").hide():$("#extpub").show();
(!isDocumentSemiPublic||isDocumentPublic)?$("#orgpub").hide():$("#orgpub").show();
isDocumentPublic?$("#externalembed").hide():$("#externalembed").show();
(jsTRASH_VIEW||(jsSHARE_VIEW&&!ALLOW_TO_WRITE))?$("#readonlyico").show():$("#readonlyico").hide();
(isDocumentSemiPublic&&!isDocumentPublic)&&$("#viewpubURL").hide();
if(ALLOW_TO_WRITE&&!jsSHARE_VIEW&&!jsREMOTE_SAVE_VIEW){
$("#editablefname").show();
$("#readonlyfname").hide();
}else{
$("#editablefname").hide();
$("#readonlyfname").show();
}
$("#fileName").attr("value",DOCUMENT_NAME);
var _1cfa;
if($("#fileName").is(":visible")){
_1cfa=$("#fileName");
}else{
_1cfa=$("#sp_docName");
}
$(_1cfa).text(DOCUMENT_NAME);
if(!jsGADGET_VIEW){
setFileNameMaxWidth(true);
}
if(!jsGADGET_VIEW&&!jsTHROWAWAY_VIEW&&!jsREMOTE_SAVE_VIEW){
WebMessanger.enableToggleUI();
}
if(USERCURRENCY!="DOLLAR"){
var _1cfb=getObj("currency");
if(_1cfb){
_1cfb.setAttribute("currencyType",USERCURRENCY);
$(_1cfb).find("span").first().text($("#"+$("#currency").attr("currencyType")).find("span").first().text());
$(_1cfb).attr("title",$(_1cfb).find("span").first().text());
}
}
}
function getScrollBarDIM(){
var _1cfc=document.createElement("DIV");
var _1cfd=document.createElement("DIV");
_1cfc.style.height="100px";
_1cfc.style.overflowX="scroll";
_1cfc.style.overflowY="scroll";
_1cfc.style.position="relative";
_1cfc.style.top="-100000px";
_1cfc.style.left="-100000px";
_1cfd.style.height="1000px";
_1cfc.appendChild(_1cfd);
document.body.appendChild(_1cfc);
var _1cfe=_1cfc.offsetWidth;
var _1cff=_1cfd.offsetWidth;
document.body.removeChild(_1cfc);
var _1d00=_1cfe-_1cff;
_1d00=(_1d00<17)?17:_1d00;
return _1d00;
}
function sheetLoadCallBack(){
if(typeof isSheetFreezed!="undefined"&&isSheetFreezed==true){
freezePanes(persistedFreezedRow,persistedFreezedCol);
}else{
if(fromGoTo){
fromGoTo=false;
gotoCell();
}else{
if(editedFormulaCellInfo.isOtherSheet||editedFormulaCellInfo.isSameSheet){
if(editedFormulaCellInfo.cellFieldDetails.ACTUAL_FORMULA_SHEET!=CURRSHEETNAME){
return;
}else{
focusCell(editedFormulaCellInfo.cellFieldDetails.ROW,editedFormulaCellInfo.cellFieldDetails.COLUMN);
focusCellField(cellField.value);
}
}else{
var row=(Row.firstNonHiddenRow!==-1)?Row.firstNonHiddenRow:0;
if(DOCUMENT_ID=="doc_id"){
if(!jsGADGET_VIEW){
var _1d02=jsonWorkbookObj();
var scnt=_1d02.sheetcnt;
for(var x=0;x<=scnt;x++){
var sheet=_1d02["sheet"+x];
if(sheet!=undefined){
if(sheet.sheetName==CURRSHEETNAME){
position_Bottom=sheet.positionBottom;
position_Left=sheet.positionLeft;
}
}
}
if(!workbookData.switchSheet){
var _1d06=findRowInYPos(getRowTop(position_Bottom)+getSheetHeight(),true);
appendBlankRows("ROWS_EXCEEDED",_1d06);
setScrollTop(getRowTop(position_Bottom));
var _1d07=findColInXPos(getColLeft(position_Left)+getSheetWidth(),true);
if(_1d07>totCols){
insertCol("append",position_Left,_1d07-totCols+1,true,true,true,undefined,undefined,undefined,undefined,true);
setScrollLeft(getColLeft(position_Left));
}
focusCell(row,0);
}
}
}else{
if(!workbookData.switchSheet){
var _1d02=jsonWorkbookObj();
var scnt=_1d02.sheetcnt;
for(var x=0;x<=scnt;x++){
var sheet=_1d02["sheet"+x];
if(sheet!=undefined){
if(sheet.sheetName==CURRSHEETNAME){
sheet.activeERowIndex=sheet.activeRowIndex;
sheet.activeEColIndex=sheet.activeColIndex;
}
}
}
var t1=findRowInYPos(getRowTop(position_Bottom)+getSheetHeight(),true);
appendBlankRows("ROWS_EXCEEDED",t1);
if(position_Left<getColMax()){
var t2=findColInXPos(getColLeft(position_Left)+getSheetWidth(),true);
if(t2>totCols){
var diff=(t2-totCols)+1;
insertCol("append",totCols,diff,true,true,true,undefined,undefined,undefined,undefined,true);
}
}
if(cursor_Row_Index>position_Bottom&&cursor_Col_Index>position_Left){
setScrollTop(getRowTop(position_Bottom));
setScrollLeft(getColLeft(position_Left));
focusCell(cursor_Row_Index,cursor_Col_Index,"",true);
}else{
focusCell(cursor_Row_Index,cursor_Col_Index);
setScrollTop(getRowTop(position_Bottom));
setScrollLeft(getColLeft(position_Left));
}
}
}
cursorchange();
}
}
workbookData.switchSheet=false;
}
}
function setSheetDim(mode){
if(!mode&&mode!="RESET"&&cellField&&!isUndefined(cellField.value)&&!isCellFieldSPANHided()){
var _1d0c=getCaretPos(cellField);
}
colHeadContainer.style.visibility="hidden";
rowHeadContainer.style.visibility="hidden";
sheet.style.visibility="hidden";
ssVScrollbar.style.visibility="hidden";
ssLeft=findPosX(spreadSheet);
ssTop=findPosY(spreadSheet);
ssParentEl=getObj("spreadSheet").parentNode;
var _1d0d=(typeof getObj("ssEResize")!="undefined"&&getObj("ssEResize")!=null)?getObj("ssEResize").offsetWidth:0;
var _1d0e=(typeof getObj("ssSResize")!="undefined"&&getObj("ssSResize")!=null)?getObj("ssSResize").offsetHeight:0;
var _1d0f=ssParentEl.offsetWidth;
var width=(parseInt(ssWidth)/100*_1d0f)-rowHeadWidth-_1d0d-ssRightPanel.offsetWidth;
if(width<0){
width=0;
}
var _1d11=findClientDim();
var _1d12=_1d11.width;
var _1d13=_1d11.height;
if(!jsGADGET_VIEW){
bottomBandHeight=$("#bottomBand").height();
}else{
bottomBandHeight=0;
}
bottomBandHeight=parseInt(bottomBandHeight);
var _1d14=getObj("cHC");
colHeadContPosY=findPosY(_1d14);
colHeadContHeight=parseInt(_1d14.style.height);
var _1d15=27;
if(browser_ie){
_1d15=29;
}
var _1d16=_1d13-(colHeadContPosY+colHeadContHeight)-_1d15-bottomBandHeight-wmsBarHt-poweredByObjHt;
if(_1d16<0){
_1d16=0;
}
spreadSheet.style.visibility="hidden";
setSheetWidth(width);
setSheetHeight(_1d16);
spreadSheet.style.visibility="";
if(!mode&&mode!="RESET"){
colHeadContainer.style.visibility="";
rowHeadContainer.style.visibility="";
sheet.style.visibility="";
ssVScrollbar.style.visibility="";
if(cellField&&!isUndefined(cellField.value)&&!isCellFieldSPANHided()){
setCaretPos(cellField,_1d0c);
}
setSheetProps();
}
}
function setSheetProps(){
sheetLeft=findPosX(sheet);
sheetTop=findPosY(sheet);
var _1d17=sheet.style.width;
var _1d18=sheet.style.height;
sheetRight=sheetLeft+parseInt(_1d17);
sheetBottom=sheetTop+parseInt(_1d18);
sheetWidth=parseInt(_1d17);
sheetHeight=parseInt(_1d18);
}
var resetSheetDimIntvl;
function resetSheetDim(){
if(isCellEdited()||exprFieldKeyPressed){
posOfCaret=(isEditingInExprField)?getCaretPos(exprField):getCaretPos(cellField);
}
if(browser_nn6){
var _1d19=getScrollBarDIM();
H_SCROLLBAR_HEIGHT=_1d19;
V_SCROLLBAR_WIDTH=(_1d19<18)?18:_1d19;
if(parseInt(ssVScrollbar.style.width)!=V_SCROLLBAR_WIDTH){
ssVScrollbar.style.width=V_SCROLLBAR_WIDTH+"px";
ssHScrollbar.style.height=H_SCROLLBAR_HEIGHT+"px";
}
}
if(resetSheetDimIntvl){
clearInterval(resetSheetDimIntvl);
}
if(cellField&&!isUndefined(cellField.value)&&!isCellFieldSPANHided()){
var _1d1a=getCaretPos(cellField);
}
resetSheetDimIntvl=setTimeout(function(){
setSheetDim("RESET");
if(ISFREEZED){
resetSheetPanesDim();
}
colHeadContainer.style.visibility="";
rowHeadContainer.style.visibility="";
sheet.style.visibility="";
ssVScrollbar.style.visibility="";
if(cellField&&!isUndefined(cellField.value)&&!isCellFieldSPANHided()){
setCaretPos(cellField,_1d1a);
}
setSheetProps();
drawColsRows();
loadXTileIfVacantInViewPort();
if(resetSheetDimIntvl){
clearInterval(resetSheetDimIntvl);
}
resetCellFieldPosition();
},0);
}
function focusSheet(){
if((editedFormulaCellInfo.isOtherSheet||editedFormulaCellInfo.isSameSheet&&editedFormulaCellInfo.cellFieldDetails.ACTUAL_FORMULA_SHEET!=CURRSHEETNAME)){
return;
}
if(isCellRange()){
var _1d1b=getCellRange();
var _1d1c,_1d1d,_1d1e,_1d1f;
if(isWholeSheetSelected()){
_1d1c=0;
_1d1d=0;
_1d1e=getSheetTableWidth();
_1d1f=getSheetTableHeight();
setCurrCellIndicator(0,0,totRows-1,totCols-1);
}else{
var dim=getCellRangeDIM(_1d1b.startRow,_1d1b.startCol,_1d1b.endRow,_1d1b.endCol);
_1d1d=dim.top;
_1d1c=dim.left;
_1d1e=dim.width;
_1d1f=dim.height;
}
ActiveCellInfo.reset(currRow,currCol);
setFocusDIVPos(_1d1c,_1d1d);
setFocusDIVDim(_1d1e,_1d1f);
}else{
var _1d21=ActiveCellInfo;
var _1d22=_1d21.isMerged();
var _1d23=_1d21.getStartRow();
var _1d24=_1d21.getStartCol();
var _1d25=_1d21.getEndRow();
var _1d26=_1d21.getEndCol();
ActiveCellInfo.reset(currRow,currCol);
var info=ActiveCellInfo;
if(_1d22&&!info.isMerged()||!_1d22&&info.isMerged()){
blurColHead(_1d24,_1d26);
blurRowHead(_1d23,_1d25);
currRow=_1d23;
currCol=_1d24;
ActiveCellInfo.reset(currRow,currCol);
info=ActiveCellInfo;
selectColHead(info.getStartCol(),info.getEndCol());
selectRowHead(info.getStartRow(),info.getEndRow());
}else{
blurColHead(_1d24,_1d26);
blurRowHead(_1d23,_1d25);
selectColHead(info.getStartCol(),info.getEndCol());
selectRowHead(info.getStartRow(),info.getEndRow());
}
var _1d1d=info.getTop();
var _1d1f=info.getHeight();
var _1d1c=info.getLeft();
var _1d1e=info.getWidth();
setFocusDIVPos(_1d1c,_1d1d);
setFocusDIVDim(_1d1e,_1d1f);
}
var cell=getCell(currRow,currCol);
if(cell){
currCell=cell;
updateActiveCellDependencies(currCell);
activateCellField();
}
}
function scrollSheetVertically(){
var _1d29=ssVScrollbar.scrollTop;
if(!isRowSelected()){
if(getSheetScrollTop()!=_1d29){
setScrollTop(_1d29);
}
}
if(isFilterOptionsDIVOpened){
Filter.hideFilterOptions();
}
if(isVScrollFaceOnDrag&&!(isUpArrowPressed||isDownArrowPressed)){
if(typeof vScrollbarMoveIntvl!="undefined"){
clearTimeout(vScrollbarMoveIntvl);
}
vScrollbarMoveIntvl=setTimeout(function(){
loadXTiles(_1d29);
},scrollFaceDragTimer);
if(isVScrollFaceClicked){
showRowNoInfo();
}
}else{
if(isUpArrowPressed||isDownArrowPressed){
if(typeof vScrollbarMoveIntvl!="undefined"){
clearTimeout(vScrollbarMoveIntvl);
}
vScrollbarMoveIntvl=setTimeout(function(){
loadXTiles(_1d29);
},scrollArrowClickTimer);
}else{
loadXTiles(_1d29);
}
}
if(isDownArrowPressed){
appendBlankRows("SCROLLBAR_DOWN_ARROW_MOUSEDOWN");
}
if(ole.getCurrObj()){
ole.getCurrObj().positionActionBar(false);
var _1d2a=parseInt(ole.getCurrObj().getActionBar().style.top);
var _1d2b=parseInt(sheetBottom)-_1d2a-ole.getCurrObj().getActionBar().offsetHeight;
var _1d2c=ole.getCurrObj().top+ole.getCurrObj().height-getSheetScrollTop();
var _1d2d=_1d2a-sheetTop;
if(_1d2d<0){
$(ole.getCurrObj().getActionBar()).hide();
}
}
}
function scrollSheetHorizontally(){
(typeof snippet!=="undefined")&&snippet.hideDesignModeCue();
isMouseEventInSheetScrollBar=true;
setScrollLeft(ssHScrollbar.scrollLeft);
afterResetSheetDimension("SCROLL");
if(isHScrollbarRightArrowPressed===true){
if(getSheetScrollLeft()===(getSheetTableWidth()-getSheetWidth())){
insertCol("append",totCols,1,false,true,false,undefined,undefined,undefined,undefined,true);
setScrollLeft(getSheetTableWidth()-getSheetWidth()-1);
if(isRowSelected()){
if(isWholeSheetSelected()){
setFocusDIVDim(getSheetTableWidth(),getSheetTableHeight());
focusSheet();
}else{
focusCellRange(currRow,0,getCellRange().endRow,totCols-1,"ROW",true,true);
}
}
}
}
}
var mousewheel={};
mousewheel.config={divisor:browser_opera?40:browser_firefox&&os_mac?1:browser_firefox?3:120,eventThreshold:7,timeThreshold:150,isVigorousMode:false,maxRowsPerEvent:5,maxRowsPerEventInVigorousMode:3,vigorousModeDivisor:10,timeDiff:undefined,eventCount:0};
mousewheel.scroll=function(ev){
var _1d2f=mousewheel.config;
if(isFilterOptionsDIVOpened){
return false;
}
if(_1d2f.timeDiff){
_1d2f.timeDiff=performance.now()-_1d2f.timeDiff;
if(_1d2f.timeDiff>_1d2f.timeThreshold){
_1d2f.eventCount=0;
_1d2f.isVigorousMode=false;
}else{
if(_1d2f.eventCount>_1d2f.eventThreshold){
_1d2f.isVigorousMode=true;
}
_1d2f.eventCount++;
}
}
(typeof snippet!=="undefined")&&snippet.hideDesignModeCue();
if(!ev){
ev=event;
}
var _1d30=ev.wheelDelta;
var _1d31=ev.wheelDeltaX;
var _1d32=ev.wheelDeltaY;
var _1d33=ev.detail;
var _1d34=_1d31||ev.axis===1;
var _1d35=_1d32||ev.axis===2||browser_ie&&_1d30;
var _1d36;
if(_1d35){
var _1d37=browser_opera?(_1d32/_1d33):_1d32||-_1d33||_1d30;
var _1d38=findRowInYPos(getSheetScrollTop()+1);
var _1d39=browser_opera?_1d33>0:_1d37<0;
_1d37=Math.abs(_1d37);
_1d36=_1d37/_1d2f.divisor;
_1d36=(_1d2f.isVigorousMode&&browser_firefox)?Math.ceil(_1d36/_1d2f.vigorousModeDivisor):Math.ceil(_1d36);
var max=_1d2f.isVigorousMode?_1d2f.maxRowsPerEventInVigorousMode:_1d2f.maxRowsPerEvent;
_1d36=Math.min(max,_1d36);
var _1d3b=Row.findNthNonHiddenRow(_1d36,_1d38,!!_1d39);
setScrollTop(Math.max(getRowTop(_1d3b),0));
appendBlankRows("MOUSE_WHEEL_SCROLL");
}
if(_1d34){
if(browser_safari||browser_ie){
var _1d3c=_1d31/SCROLL_PER_MOUSEWHEEL;
}else{
if(browser_nn6){
var _1d3c=_1d33*-1;
}
}
var _1d3d=SCROLL_PER_MOUSEWHEEL*(_1d3c/3);
var _1d3e=getSheetScrollLeft();
if(_1d3c<0){
var _1d3f=(_1d3e+(-1*_1d3d));
}else{
var _1d3f=(_1d3e-_1d3d);
}
var _1d40=getSheetWidth();
var _1d41=getSheetTableWidth();
var _1d42=_1d41-_1d40;
if(_1d3e>_1d42){
_1d3f=_1d42;
}
if(_1d3f<0){
_1d3f=0;
}
setTimeout(function(){
setScrollLeft(_1d3f);
},1);
}
stopEvt(ev);
_1d2f.timeDiff=performance.now();
if(browser_safari){
return false;
}
};
function scrollSheet(ev){
}
var ssHScrollContLeft=0;
var ssHScrollResizeDiff=0;
var sheetsTabLeft=0;
var sheetsTabNavBarWidth=0;
var addSheetBtnWidth=0;
var ssHScrollDefaultWidth=650;
function resizeHScrollbar(el,ev){
var x=findPosX(el);
var left=(x-(ssHScrollResizePane.offsetWidth/2)+(el.offsetWidth/2));
ssHScrollResizePane.style.top=findPosY(el)+"px";
ssHScrollContLeft=findPosX(ssHScrollContainer);
sheetsTabLeft=findPosX(getObj("sheetsTab"));
sheetsTabNavBarWidth=getObj("sheetsTabNavBar").offsetWidth;
addSheetBtnWidth=getObj("addSheetBtn").offsetWidth;
ssHScrollResizeDiff=x-left+6;
if(browser_ie){
document.attachEvent("onmousemove",doResizeHScrollbar);
document.attachEvent("onmouseup",endResizeHScrollbar);
}else{
if(browser_nn6){
window.addEventListener("mousemove",doResizeHScrollbar,false);
window.addEventListener("mouseup",endResizeHScrollbar,false);
}
}
stopEvt(ev);
document.body.style.cursor="col-resize";
}
function doResizeHScrollbar(ev){
clearTextSelection();
var _1d49=findDocDim();
docWidth=_1d49.width;
var pgX=ev.clientX;
if((pgX-ssHScrollResizeDiff>sheetsTabLeft+sheetsTabNavBarWidth+addSheetBtnWidth)&&(pgX<docWidth-100)){
ssHScrollResizePane.style.left=(pgX-ssHScrollResizeDiff)+"px";
}
}
function endResizeHScrollbar(ev){
document.body.style.cursor="";
if(browser_ie){
document.detachEvent("onmousemove",doResizeHScrollbar);
document.detachEvent("onmouseup",endResizeHScrollbar);
}else{
if(browser_nn6){
window.removeEventListener("mousemove",doResizeHScrollbar,false);
window.removeEventListener("mouseup",endResizeHScrollbar,false);
}
}
var _1d4c=parseInt(ssHScrollResizePane.style.left);
if(!isNaN(_1d4c)&&_1d4c>0){
var _1d4d=ssHScrollContainer.offsetWidth;
var x=_1d4c+ssHScrollResizeDiff-6;
if(x<ssHScrollContLeft){
var _1d4f=_1d4d+(ssHScrollContLeft-x);
}else{
var _1d4f=_1d4d-(x-ssHScrollContLeft);
}
ssHScrollContainer.style.width=_1d4f+"px";
ssHScrollContainer.setAttribute("customWidth",_1d4d-(x-ssHScrollContLeft));
setHScrollbarDim();
resetSheetsTabDim();
}
ssHScrollResizePane.style.left=ssHScrollResizePane.style.top="-100000px";
ssHScrollContLeft=addSheetBtnWidth=sheetsTabNavBarWidth=ssHScrollResizeDiff=0;
}
function resizeHScrollbarToDefaultWidth(){
var width=ssHScrollDefaultWidth;
var diff=width-ssHScrollContainer.offsetWidth;
if(getObj("sheetsTabContainer").offsetWidth-diff>sheetsTabNavBarWidth+addSheetBtnWidth){
ssHScrollContainer.style.width=width+"px";
ssHScrollContainer.setAttribute("customWidth",width);
setHScrollbarDim();
resetSheetsTabDim();
}
}
function setHScrollbarDim(_1d52,_1d53,_1d54,_1d55){
var _1d56=0;
var diff=getSheetTableWidth()-getSheetWidth();
if(typeof _1d52=="undefined"||_1d52==null){
var _1d55=0;
_1d56=ssHScrollbar.parentNode.offsetWidth;
}else{
var _1d58=_1d54-(getObj("addSheetBtn").offsetWidth+getObj("sheetsTabNavBar").offsetWidth)-_1d53;
if(_1d58<0){
_1d53=_1d53+_1d58;
}
if(ssHScrollContainer){
ssHScrollContainer.style.width=_1d53+"px";
}
_1d56=getObj("ssHScrollbarContainer").offsetWidth;
}
ssHScrollbar.style.width=_1d56+"px";
ssHScrollDIV.style.width=diff+_1d56+"px";
sheetTabWidth=0;
sbarEnd=0;
if($("#sheetsTabContainer").length>0){
newWidth=Math.round($(window).width()/1.5);
$("#sheetsTab").css({"width":"45%"});
$("#sheetsTabContainer").css({"width":"50%"});
$("#sshbar").css({"width":"150%"});
$("#sheetsTab").css({"minWidth":$("#sheetsTab").width()/4,"float":"left"});
$("#ssHScrollContainer").css({"maxWidth":newWidth});
$("#ssHScrollContainer").css({"minWidth":$("#ssHScrollContainer").width()-$("#sheets").width()});
}
}
function resetHScrollDim(_1d59){
if(typeof _1d59!="undefined"&&_1d59!=null&&_1d59!=""){
var _1d5a=getObj("sheetsTabNavBar");
if(_1d5a==null){
return;
}
var _1d5b=parseInt(_1d5a.offsetWidth);
var _1d5c=parseInt(getObj("addSheetBtn").offsetWidth);
var _1d5d=getObj("spreadSheet").offsetWidth;
if(_1d59!="WIN_RESIZE"){
var _1d5e=(_1d59=="DOCPANEL_OPEN"||_1d59=="DOCPANEL_CLOSE")?DOC_PANEL.docPanelDim.width:(sbWidth-sbWidthAdjust);
var _1d5f=(_1d59=="DOCPANEL_OPEN"||_1d59=="SIDEBAR_OPEN")?_1d5e:-1*_1d5e;
var _1d60=_1d5d-_1d5f;
var _1d61=(_1d60/_1d5d)*100;
var _1d62=ssHScrollContainer.offsetWidth;
var _1d63=parseInt((_1d61/100)*_1d62);
setHScrollbarDim(_1d59,_1d63,_1d60,_1d5f);
}else{
var _1d64=findClientDim().width;
if(_1d64<clientWidth){
var _1d60=clientWidth-_1d64;
var _1d61=(_1d5d/(_1d5d+_1d60))*100;
}else{
var _1d60=_1d64-clientWidth;
var _1d61=(_1d5d/(_1d5d-_1d60))*100;
}
var _1d62=0;
if(ssHScrollContainer&&ssHScrollContainer!=null&&!isUndefined(ssHScrollContainer)){
_1d62=ssHScrollContainer.offsetWidth;
}
var _1d63=parseInt((_1d61/100)*_1d62);
if(browser_ff3){
ssHScrollContainer.style.width="0px";
}
setHScrollbarDim(_1d59,_1d63,getObj("spreadSheet").offsetWidth,(_1d64<clientWidth)?_1d60:-1*_1d60);
}
_1d5a=null;
}
}
function showHScrollbar(){
var _1d65=getObj("ssHScrollContainer").getElementsByTagName("TABLE")[0];
if(_1d65){
_1d65.style.visibility="visible";
}
}
function hideHScrollbar(){
var _1d66=getObj("ssHScrollContainer").getElementsByTagName("TABLE")[0];
if(_1d66){
_1d66.style.visibility="hidden";
}
}
function resizeSheet(type,ev){
ssResizeType=type;
if(browser_ie&&ev.button==2){
return false;
}else{
if(browser_nn6&&ev.which==3){
return false;
}
}
if(ssResizeType.indexOf("s")>=0&&ssResizeType.indexOf("e")>=0){
sheet.style.cursor=sheetTable.style.cursor=ssResizePane.style.cursor="se-resize";
}else{
if(ssResizeType.indexOf("s")>=0){
sheet.style.cursor=sheetTable.style.cursor=ssResizePane.style.cursor="s-resize";
}else{
sheet.style.cursor=sheetTable.style.cursor=ssResizePane.style.cursor="col-resize";
}
}
ssResizePane.style.left=ssLeft+"px";
ssResizePane.style.top=ssTop+"px";
ssResizePane.style.width=spreadSheet.offsetWidth+"px";
ssResizePane.style.height=spreadSheet.offsetHeight+"px";
ssResizePane.style.display="block";
if(browser_ie){
document.attachEvent("onmousemove",doResizeSheet);
document.attachEvent("onmouseup",endResizeSheet);
}else{
if(browser_nn6){
window.addEventListener("mousemove",doResizeSheet,false);
window.addEventListener("mouseup",endResizeSheet,false);
}
}
stopEvt(ev);
return false;
}
function doResizeSheet(ev){
clearTextSelection();
if(browser_ie){
var ev=window.event;
var _1d6a=document.body.offsetWidth;
var _1d6b=document.body.offsetHeight;
}else{
if(browser_nn6){
var _1d6a=document.body.offsetWidth;
var _1d6b=document.body.offsetHeight;
}
}
if(ssResizeType.indexOf("e")>=0){
var pgX=ev.clientX;
if(_1d6a-pgX<50){
document.body.scrollLeft+=15;
}else{
if(pgX<25){
document.body.scrollLeft-=5;
}
}
var width=pgX-ssLeft+document.body.scrollLeft;
ssResizePane.style.width=((width<0)?0:width)+"px";
}
if(ssResizeType.indexOf("s")>=0){
var pgY=ev.clientY;
if(_1d6b-pgY<50){
document.body.scrollTop+=15;
}else{
if(pgY<25){
document.body.scrollTop-=5;
}
}
var _1d6f=pgY-ssTop+document.body.scrollTop;
ssResizePane.style.height=((_1d6f<0)?0:_1d6f)+"px";
}
}
function endResizeSheet(ev){
if(browser_ie){
document.detachEvent("onmousemove",doResizeSheet);
document.detachEvent("onmouseup",endResizeSheet);
}else{
if(browser_nn6){
window.removeEventListener("mousemove",doResizeSheet,false);
window.removeEventListener("mouseup",endResizeSheet,false);
}
}
if(ssResizeType.indexOf("e")>=0){
ssWidthIn="fixed";
spreadSheet.style.width=ssResizePane.offsetWidth+"px";
var width=spreadSheet.offsetWidth-rowHeadWidth-getObj("ssEResize").offsetWidth-ssRightPanel.offsetWidth;
colHead.style.width=width+"px";
sheet.style.width=width+"px";
var _1d72=ssHScrollbar.parentNode.offsetWidth;
ssHScrollbar.style.width=(ssHScrollbar.parentNode.offsetWidth)+"px";
ssHScrollDIV.style.width=(getSheetTableWidth()-getSheetWidth()+_1d72)+"px";
}
if(ssResizeType.indexOf("s")>=0){
ssHeightIn="fixed";
spreadSheet.style.height=ssResizePane.offsetHeight+"px";
var _1d73=parseInt(spreadSheet.style.height)-colHeadHeight-getObj("ssSResize").offsetHeight;
setSheetHeight(_1d73);
}
ssResizeType="";
ssResizePane.style.display="none";
if(browser_opera){
sheet.style.cursor=sheetTable.style.cursor="default";
}else{
var _1d74=ctxpath+"images/cell.cur";
sheet.style.cursor=sheetTable.style.cursor="url("+_1d74+"), default";
}
updateResizedSheet(parseInt(spreadSheet.style.width),parseInt(spreadSheet.style.height));
}
function doNotResizeSS(ev){
stopEvt(ev);
return false;
}
function updateResizedSheet(width,_1d77){
var param={"width":width,"height":_1d77};
}
function copySheet(){
closeDialog();
var tab=getObj("sheetsTab").getElementsByTagName("TD");
var _1d7a=new Array();
for(var i=0;i<tab.length-1;i++){
_1d7a[i]=encodeURIComponent(tab[i].getAttribute("sheetname"));
}
var name=currSheetOnRightClick;
name=encodeURIComponent(name);
var _1d7d=getXMLHttpRequest();
var nvp="name="+name+"&sheetnames="+_1d7a+"&browser_ie="+browser_ie;
_1d7d.onreadystatechange=function(){
if(_1d7d.readyState==4){
var _1d7f=_1d7d.responseText;
showDialog(_1d7f,"width=350px,title="+jsTitleMsg.CopyThisSheet);
getObj("newsheetname").focus();
getObj("newsheetname").select();
}
};
sendXMLHTTPRequest(_1d7d,nvp,false,true,ctxpath+"pages/copythissheet.jsp");
}
function moveSheet(){
closeDialog();
var tab=getObj("sheetsTab").getElementsByTagName("TD");
var _1d81=new Array();
for(var i=0;i<tab.length-1;i++){
_1d81[i]=encodeURIComponent(tab[i].getAttribute("sheetname"));
}
var name=currSheetOnRightClick;
name=encodeURIComponent(name);
var _1d84=getXMLHttpRequest();
var nvp="name="+name+"&sheetnames="+_1d81+"&browser_ie="+browser_ie;
_1d84.onreadystatechange=function(){
if(_1d84.readyState==4){
var _1d86=_1d84.responseText;
showDialog(_1d86,"width=350px,title="+jsTitleMsg.MoveThisSheet);
getObj("SelectedSheet").focus();
}
};
sendXMLHTTPRequest(_1d84,nvp,false,true,ctxpath+"pages/movethissheet.jsp");
}
function vScrollMouseDown(ev){
if(isFilterOptionsDIVOpened){
if(browser_ie){
var el=ev.srcElement;
}else{
if(browser_nn6){
var el=ev.target;
}
}
var id=el.id;
if(!id||id.indexOf("filter")===-1){
Filter.hideFilterOptions();
}
return false;
}
vScrollbarOnMove=false;
currScrollTop=getSheetScrollTop();
var _1d8a=findPosY(ssVScrollbar);
var _1d8b=_1d8a+ssVScrollbar.offsetHeight;
var pos=getCursorPos(ev);
if(pos.y>_1d8a&&pos.y<_1d8a+ARROW_HEIGHT_IN_SCROLLBAR){
isUpArrowPressed=true;
isDownArrowPressed=false;
}else{
if(pos.y>_1d8b-ARROW_HEIGHT_IN_SCROLLBAR&&pos.y<_1d8b){
isDownArrowPressed=true;
isUpArrowPressed=false;
if(isSheetScrollTopCrossedLastRow()){
appendBlankRows("SCROLLBAR_DOWN_ARROW_MOUSEDOWN");
scrollSheetVertically();
}
}else{
isDownArrowPressed=false;
isUpArrowPressed=false;
}
}
if(!isUpArrowPressed&&!isDownArrowPressed){
isVScrollFaceClicked=true;
vScrollFaceClickedPos=pos;
}else{
updateSSVScrollFaceState();
}
rowToFocusOnPageNavigation=undefined;
}
function vScrollMouseMove(){
isVScrollFaceOnDrag=true;
}
function vScrollMouseUp(){
isVScrollFaceOnDrag=false;
isUpArrowPressed=false;
isDownArrowPressed=false;
}
function hScrollMouseDown(ev){
if(isFilterOptionsDIVOpened){
if(browser_ie){
var el=ev.srcElement;
}else{
if(browser_nn6){
var el=ev.target;
}
}
var id=el.id;
if(!id||id.indexOf("filter")===-1){
Filter.hideFilterOptions();
}
return false;
}
var _1d90=findPosX(ssHScrollbar);
var _1d91=_1d90+ssHScrollbar.offsetWidth;
var pos=getCursorPos(ev);
isHScrollbarRightArrowPressed=false;
if(pos.x>_1d90&&pos.x<_1d90+ARROW_WIDTH_IN_SCROLLBAR){
}else{
if(pos.x>_1d91-ARROW_WIDTH_IN_SCROLLBAR&&pos.x<_1d91){
isHScrollbarRightArrowPressed=true;
if(getSheetScrollLeft()===(getSheetTableWidth()-getSheetWidth())){
scrollSheetHorizontally(ev);
}
}
}
}
function hScrollMouseMove(){
isHScrollFaceOnDrag=true;
}
function hScrollMouseUp(){
isHScrollFaceOnDrag=false;
}
var sheetScrollInfo={scrollTop:0,scrollLeft:0};
function setScrollTop(_1d93){
if(isNumber(_1d93)){
var _1d94=(ssVScrollbar.scrollHeight-parseInt(ssVScrollbar.style.height));
_1d93=(_1d93<0)?0:_1d93;
_1d93=(_1d93>_1d94)?_1d94:_1d93;
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
var _1d98=getSheetPane(row,col);
if(_1d98==3||_1d98==4){
var _1d99=findThirdPaneYPos();
var _1d9a=_1d93+parseInt((getSheetPaneHeight()-_1d99)/2)+_1d99;
if(!isCellFieldSPANHided()){
var _1d9b=getRowTop(currRow);
var _1d9c=requiredCellHeight;
if(_1d9b>=_1d93&&((_1d9b+_1d9c)<=getSheetPaneHeight()+_1d93)){
_1d9a=ActiveCellInfo.getTop();
if(editedFormulaCellInfo.isOtherSheet){
diminishCellField();
}else{
cellField.style.zIndex=3;
cellField.style.height=requiredCellHeight+"px";
cellField.style.width=requiredCellWidth+"px";
}
}else{
cellField.style.zIndex=-1;
diminishCellField();
}
}
cellField.style.top=_1d9a+"px";
}
activateCellField();
if(isColsOnlyFreezed||isColsAndRowsFreezed){
sheetPane3.scrollTop=_1d93;
}
rowHead.scrollTop=_1d93;
sheetPane.scrollTop=_1d93;
if(ssVScrollbar.scrollTop!=_1d93){
ssVScrollbar.scrollTop=_1d93;
}
sheetScrollInfo.scrollTop=_1d93;
}
}
function setScrollLeft(_1d9d){
if(isNumber(_1d9d)){
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
var _1da1=getSheetPane(row,col);
if(_1da1==4||_1da1==2){
var _1da2=findSecondPaneXPos();
var _1da3=_1d9d+parseInt((getSheetWidth()-_1da2)/2)+_1da2;
if(!isCellFieldSPANHided()){
var _1da4=getColLeft(currCol);
var _1da5=requiredCellWidth;
if(_1da4>=_1d9d&&((_1da4+_1da5)<=getSheetWidth()+_1d9d)){
_1da3=ActiveCellInfo.getLeft();
if(editedFormulaCellInfo.isOtherSheet){
diminishCellField();
}else{
cellField.style.zIndex=3;
cellField.style.width=requiredCellWidth+"px";
cellField.style.height=requiredCellHeight+"px";
}
}else{
cellField.style.zIndex=-1;
diminishCellField();
}
}
cellField.style.left=addSTDMode(_1da3);
}
activateCellField();
if(isRowsOnlyFreezed||isColsAndRowsFreezed){
sheetPane2.scrollLeft=_1d9d;
}
colHead.scrollLeft=sheetPane.scrollLeft=_1d9d;
if(ssHScrollbar.scrollLeft!=_1d9d){
ssHScrollbar.scrollLeft=_1d9d;
}
sheetScrollInfo.scrollLeft=_1d9d;
}
}
function removeYTiles(){
}
function removeXTiles(_1da6,_1da7,_1da8){
var _1da9=Row.getAvailableRowsInRange(_1da6,_1da7-1,true);
var _1daa=_1da9.length;
switch(_1da8){
case "UNLOADED_PAGE":
sheetTable.innerHTML="";
if(isColsOnlyFreezed||isColsAndRowsFreezed){
sheetTable3.innerHTML="";
}
break;
case "START_OF_PAGE":
case "PAGE_BEFORE_CURRENT_PAGE":
var _1dab=_1daa/ROWS_PER_TILE;
removeSheetTableTiles(_1dab,_1da8);
if(isColsOnlyFreezed||isColsAndRowsFreezed){
removeSheetTableTiles(_1dab,_1da8,sheetPane3Id);
}
break;
case "END_OF_PAGE":
case "PAGE_AFTER_CURRENT_PAGE":
var _1dab=_1daa/ROWS_PER_TILE;
removeSheetTableTiles(_1dab,_1da8);
if(isColsOnlyFreezed||isColsAndRowsFreezed){
removeSheetTableTiles(_1dab,_1da8,sheetPane3Id);
}
break;
}
removeRowHdrs(_1da9,_1da8);
updateAvailableRowRange("DELETE",_1da8,_1da9);
var _1dac=true;
Merge.remove(_1da6,0,_1da7-1,getTotalColumn(),_1dac);
}
function removeSheetTableTiles(_1dad,_1dae,_1daf){
if(typeof _1dae=="undefined"||(_1dae=="START_OF_PAGE"||_1dae=="PAGE_BEFORE_CURRENT_PAGE")){
var _1db0=true;
}else{
var _1db0=false;
}
for(var i=0,len=_1dad;i<len;i++){
if(_1db0){
var _1db3=getLastTile(_1daf);
}else{
var _1db3=getFirstTile(_1daf);
}
if(_1db3!=null){
var pNode=_1db3.parentNode;
pNode.removeChild(_1db3);
}
}
}
function findVScrollPos(_1db5){
var _1db6;
var _1db7;
var _1db8;
var _1db9;
var _1dba=getSheetPaneHeight();
if(isSheetScrolledDown()){
var _1dbb=getAvailableEndRow();
var _1dbc=(_1dbb<0);
if(_1dbc){
var _1dbd=0;
}else{
var _1dbd=getRowTop(_1dbb)+getRowHeight(_1dbb);
}
if((_1dbd>_1db5)&&(_1dbd<_1db5+_1dba)){
var _1dbe=getRowRangeForPageInView("END_OF_PAGE");
_1db6=_1dbe.firstRow;
_1db7=_1dbe.lastRow;
_1db9="END_OF_PAGE";
}else{
if((_1dbd>_1db5)&&(_1dbd-_1dba)<_1db5+_1dba){
var _1dbe=getRowRangeForPageInView("PAGE_AFTER_CURRENT_PAGE");
_1db6=_1dbe.firstRow;
_1db7=_1dbe.lastRow;
_1db9="PAGE_AFTER_CURRENT_PAGE";
}else{
if(_1dbd<_1db5+_1dba){
var _1dbe=getRowRangeForPageInView("UNLOADED_PAGE");
_1db6=_1dbe.firstRow;
_1db7=_1dbe.lastRow;
_1db9="UNLOADED_PAGE";
}
}
}
_1db8="SCROLLDOWN";
}else{
var _1dbf=getAvailableStartRow();
var _1dbc=(_1dbf<=0);
if(_1dbc){
var _1dc0=0;
}else{
var _1dc0=getRowTop(_1dbf);
}
if((_1dc0>_1db5)&&(_1dc0<_1db5+_1dba)){
var _1dbe=getRowRangeForPageInView("START_OF_PAGE");
_1db6=_1dbe.firstRow;
_1db7=_1dbe.lastRow;
_1db9="START_OF_PAGE";
}else{
if((_1db5-_1dba>0)&&(_1dc0>_1db5-_1dba)&&(_1dc0<_1db5+_1dba)){
var _1dbe=getRowRangeForPageInView("PAGE_BEFORE_CURRENT_PAGE");
_1db6=_1dbe.firstRow;
_1db7=_1dbe.lastRow;
_1db9="PAGE_BEFORE_CURRENT_PAGE";
}else{
if(_1dc0>_1db5+_1dba){
var _1dbe=getRowRangeForPageInView("UNLOADED_PAGE");
_1db6=_1dbe.firstRow;
_1db7=_1dbe.lastRow;
_1db9="UNLOADED_PAGE";
}
}
}
_1db8="SCROLLUP";
}
currScrollTop=getSheetScrollTop();
if(isNumber(_1db6)){
return {startRow:_1db6,endRow:_1db7,scrollState:_1db8,pageScrollState:_1db9};
}
}
var lastRequestedTileInfo;
function loadXTiles(_1dc1){
var _1dc2=findVScrollPos(_1dc1);
if(_1dc2){
var _1dc3=_1dc2.startRow;
var _1dc4=_1dc2.endRow;
var _1dc5=_1dc2.scrollState;
var _1dc6=_1dc2.pageScrollState;
var _1dc7=validateRequestRange(_1dc3,_1dc4,_1dc5);
if(_1dc7.isValidRequestRange){
_1dc3=_1dc7.startRow;
_1dc4=_1dc7.endRow;
if(isRespondedInScroll){
removeXTileIfExcessThanViewPort(_1dc6);
}
clearTileLoadTimeout();
isTileLoaded=false;
if(isVScrollFaceClicked){
tileLoadTimeoutId=setTimeout("onTileLoadTimeout('VSCROLLBAR_FACE_DRAG'"+","+_1dc3+","+_1dc4+")",500);
}else{
tileLoadTimeoutId=setTimeout("onTileLoadTimeout('SCROLL_WITHOUT_VSCROLLBAR_FACE_DRAG'"+","+_1dc3+","+_1dc4+")",500);
}
lastRequestedTileInfo={"startRow":_1dc3,"endRow":_1dc4};
submitScrollForm(Row.getNonHiddenRowsInRange(_1dc3,_1dc4-1),_1dc5,_1dc6);
}else{
setRowInfoBoxTimeout();
}
}else{
setRowInfoBoxTimeout();
}
}
function insertTiles(_1dc8,_1dc9,_1dca,_1dcb,_1dcc,_1dcd,_1dce){
if(isStr(_1dc8)&&isObject(_1dc9)){
var _1dcf=_1dce&&_1dce.fakeReload;
updateAvailableRowRange("INSERT",_1dc8,_1dca,_1dce);
var _1dd0=constructTileFromJSON(_1dc9,_1dca,_1dcb,_1dcc,_1dcd,_1dce);
var _1dd1=_1dd0.docFragment;
var _1dd2=_1dd0.frozenAreaDocFragment;
if(!isUndefined(_1dd1)){
switch(_1dc8){
case "UNLOADED_SHEET":
case "UNLOADED_PAGE":
case "END_OF_PAGE":
case "PAGE_AFTER_CURRENT_PAGE":
if(_1dc8!="UNLOADED_SHEET"){
if(isColsOnlyFreezed||isColsAndRowsFreezed){
var _1dd3=_1dd1.cloneNode(true);
if(_1dcf){
sheetTable3.innerHTML="";
}
sheetTable3.appendChild(_1dd3);
}
}
if(_1dcf){
sheetTable.innerHTML="";
if(_1dd2){
sheetTable1.innerHTML="";
sheetTable2.innerHTML="";
sheetTable1.appendChild(_1dd2.cloneNode(true));
sheetTable2.appendChild(_1dd2);
}
}
sheetTable.appendChild(_1dd1);
setScrollLeft(colHead.scrollLeft);
var info=_1dce;
if(info&&info.reloadFrozenRows&&info.frozenRows.length===0){
var _1dd5=sheetTable.childNodes[0];
sheetTable1.innerHTML="";
sheetTable2.innerHTML="";
sheetTable1.appendChild(_1dd5.cloneNode(true));
sheetTable2.appendChild(_1dd5.cloneNode(true));
}
break;
case "START_OF_PAGE":
case "PAGE_BEFORE_CURRENT_PAGE":
if(_1dc8!="UNLOADED_SHEET"){
if(isColsOnlyFreezed||isColsAndRowsFreezed){
var _1dd6=getFirstTile(sheetPane3Id);
var _1dd3=_1dd1.cloneNode(true);
sheetTable3.insertBefore(_1dd3,_1dd6);
}
}
_1dd6="";
_1dd6=getFirstTile();
sheetTable.insertBefore(_1dd1,_1dd6);
break;
}
}
insertRowHdrs(_1dca,_1dc8,_1dce);
if(isDocContainsArrayFormula){
var sr=startRow<endRow?startRow:endRow;
var sc=_1dcb<_1dcc?_1dcb:_1dcc;
var er=startRow>endRow?startRow:endRow;
var ec=_1dcb>_1dcc?_1dcb:_1dcc;
fixArrayFormulaNotation(sr,sc,er,ec);
}
for(var i in availChartRange){
if(availChartRange[i]!=-1){
UpdateChartCellRange(availChartRange[i]);
}
}
}
}
function getTilesDocFragment(_1ddc,_1ddd,_1dde){
if(isStr(_1ddc)&&isNumber(_1ddd)&&isNumber(_1dde)){
var _1ddf=document.createDocumentFragment();
var _1de0=getTileContainerMarkup();
var tiles=_1ddc.split(getTileSeperator());
var row=_1ddd;
for(var j=0,len=tiles.length;j<len;j++){
var _1de5=_1de0.cloneNode("false");
_1de5.style.display="none";
_1ddf.appendChild(_1de5);
_1de5.style.top=getRowTop(row)+"px";
_1de5.innerHTML=tiles[j];
_1de5.style.display="";
row+=ROWS_PER_TILE;
}
return _1ddf;
}
}
function appendBlankRows(_1de6,_1de7){
var _1de8=8;
var _1de9=false;
var _1dea=false;
var max=Row.lastNonHiddenRow;
switch(_1de6){
case "MOUSE_WHEEL_SCROLL":
if(getSheetScrollTop()==(getSheetTableHeight()-getSheetHeight())){
_1de8=ROWS_PER_TILE;
_1de9=true;
}
break;
case "SCROLLBAR_DOWN_ARROW_MOUSEDOWN":
if(getSheetScrollTop()==(getSheetTableHeight()-getSheetHeight())){
_1de8=ROWS_PER_TILE;
_1de9=true;
_1dea=true;
}
break;
case "ROWS_EXCEEDED":
_1de9=true;
_1de8=Row.getNonHiddenRowsInRange(totRows,_1de7).length;
break;
default:
_1de9=true;
break;
}
if(_1de8<=0){
_1de9=false;
}
if(_1de9){
var _1dec=getCeilRow(Row.findNthNonHiddenRow(_1de8,totRows-1)+1);
if(totRows===max){
return;
}else{
if(_1dec>max){
totRows=max+1;
}else{
totRows=_1dec;
}
}
setSheetTableHeight(getRowTop(totRows-1)+getRowHeight(totRows-1));
if(_1dea){
setScrollTop(getSheetTableHeight()-getSheetHeight()-1);
}
if(isColSelected()){
if(isWholeSheetSelected()){
setFocusDIVDim(getSheetTableWidth(),getSheetTableHeight());
focusSheet();
}else{
focusCellRange(0,currCol,totRows-1,getCellRange().endCol,"COLUMN",true,true);
}
}
}
}
function updateRowHdrs(_1ded){
var _1dee=36;
var _1def=getSheetHeight();
var _1df0=getSheetScrollTop();
}
function removeRowHdrs(_1df1,_1df2){
var _1df3=_1df1.length;
if(!_1df3){
return;
}
var start=_1df1[0];
var end=_1df1[_1df3-1];
var _1df6=getRowHeads(start,end);
var _1df7=_1df6.length;
switch(_1df2){
case "SCROLLDOWN":
case "END_OF_PAGE":
case "PAGE_AFTER_CURRENT_PAGE":
case "SCROLLUP":
case "START_OF_PAGE":
case "PAGE_BEFORE_CURRENT_PAGE":
for(var i=0;i<_1df7;i++){
rowHeadTable.removeChild(_1df6[i]);
}
break;
case "UNLOADED_SHEET":
case "UNLOADED_PAGE":
rowHeadTable.innerHTML="";
break;
}
}
function insertRowHdrs(_1df9,_1dfa,_1dfb){
var _1df9=Row.getAvailableRows();
if(_1df9.length>0){
var _1dfc=getRowHeadsDocFragment(_1df9);
rowHeadTable.innerHTML="";
rowHeadTable.appendChild(_1dfc);
}
if(FREEZED_ROW>0&&_1dfb&&_1dfb.fakeReload){
_1df9=Row.getLoadedRowsInFrozenRange();
if(_1df9.length>0){
var _1dfc=getRowHeadsDocFragment(_1df9);
rowHeadTable1.innerHTML="";
rowHeadTable1.appendChild(_1dfc);
}
}
}
function getRowHeadsDocFragment(_1dfd){
var _1dfe=_1dfd[0];
var _1dff=_1dfd[_1dfd.length-1];
if(_1dfe<=_1dff){
var _1e00=document.createDocumentFragment();
var _1e01=getDefaultRowHdrHTML();
var _1e02=false;
if(Filter&&Filter.isApplied()){
var _1e03=Filter.getInstance(CURRSHEETNAME);
if(_1e03&&_1e03.appliedCols.length!=0){
_1e02=true;
}
var fSR=_1e03.range.sR;
var fER=_1e03.range.eR;
}
var _1e06=true;
var _1e07;
var row=_1dfd[0];
for(var i=0,len=_1dfd.length;i<len;i++){
var _1e0b=_1e01.cloneNode(false);
if(!_1e06){
_1e0b.style.borderTop="1px solid #BBBBBB";
}
var _1e0c=_1dfd[i+1];
if((_1e0c-row)!=1){
_1e0b.style.borderBottom="1px solid #BBBBBB";
_1e06=false;
}else{
_1e06=true;
}
if(isRowInsideCurrCellRange(row)){
_1e0b.className="rowHeadFocus";
}
_1e0b.style.height=getRowHeight(row)+"px";
var _1e0d=getRowTop(row);
_1e0b.style.top=_1e0d+"px";
if(_1e02&&(row>fSR&&row<=fER)){
_1e0b.style.color="#4169E1";
}
_1e0b.innerHTML=(row+1);
_1e00.appendChild(_1e0b);
row=_1e0c;
}
return _1e00;
}
}
function scanTextSelection(){
var _1e0e;
var _1e0f;
if(browser_nn6){
_1e0e=window.getSelection();
var range=_1e0e.getRangeAt(0);
el=range.startContainer;
if(el.parentNode.tagName=="A"){
_1e0f=el.parentNode.parentNode;
}else{
_1e0f=el.parentNode;
}
}else{
if(browser_ie){
var _1e0e=document.selection;
var range=_1e0e.createRange();
_1e0f=range.parentElement();
}
}
if(browser_ie&&_1e0f.tagName=="BODY"){
return;
}
if(isCell(_1e0f)){
var pos=getCellPos(_1e0f);
var _1e12=getTotalRows();
var _1e13=getTotalColumn();
var _1e14=_1e12-pos.row;
var _1e15=_1e13-pos.col;
var cLeft=findCellLeft(_1e0f);
var cTop=findCellTop(_1e0f);
var _1e18=getSheetScrollLeft();
var _1e19=getSheetScrollTop();
var _1e1a;
var _1e1b;
if(browser_nn6){
if(cTop<_1e19){
_1e1a="N";
}else{
if(cTop>=(_1e19+getSheetHeight())){
_1e1a="S";
}
}
if(cLeft<_1e18){
_1e1b="W";
}else{
if(cLeft>=(_1e18+getSheetWidth())){
_1e1b="E";
}
}
}
if(_1e1a=="N"){
if(pos.row>1){
pos.row-=2;
}else{
if(pos.row==1){
pos.row-=1;
}
}
}else{
if(_1e1a=="S"){
if(_1e14>1){
pos.row+=2;
}else{
if(_1e14==1){
pos.row+=1;
}
}
}
}
if(_1e1b=="W"){
if(pos.col>1){
pos.col-=2;
}else{
if(pos.col==1){
pos.col-=1;
}
}
}else{
if(_1e1b=="E"){
if(_1e15>1){
pos.col+=2;
}else{
if(_1e15==1){
pos.col+=1;
}
}
}
}
_1e0f=getCell(pos.row,pos.col);
if(isCell(_1e0f)){
scrollCellIntoView(_1e0f);
}
}
}
function stopTextSelectionScanning(){
if(typeof scanSelectionIntvlId!="undefined"&&scanSelectionIntvlId!=null){
if(!(os_mac&&browser_ff3)){
if(sheetTable!=null){
restrictTextSelection(sheetTable);
}
if(sheetTable1!=null){
restrictTextSelection(sheetTable1);
}
if(sheetTable2!=null){
restrictTextSelection(sheetTable2);
}
if(sheetTable3!=null){
restrictTextSelection(sheetTable3);
}
}
clearInterval(scanSelectionIntvlId);
}
}
function closeSheet(){
$("#fileName").text("");
exprPanel.style.visibility="hidden";
fileToolbarMask.style.display="";
stdToolbarMask.style.display="";
getObj("editorDIV").className="blankState";
getObj("editorContainer").style.visibility="hidden";
ssHScrollContainer.getElementsByTagName("TABLE")[0].style.visibility="hidden";
getObj("addSheetBtn").style.visibility="hidden";
getObj("sheetsTabNavBar").style.visibility="hidden";
getObj("bottomBandMask").style.display="";
getObj("waitmsg").style.display="none";
var _1e1c=getObj("notifyInfoMsg");
if(_1e1c!=null){
_1e1c.style.display="none";
}
getObj("docCloseBtn").style.display="none";
getObj("msgBannerPanel").style.display="none";
isEditorClosed=true;
formulaSyntaxTip.hideMe();
}
function showRowNoInfo(row,_1e1e){
var _1e1f=getObj("rowInfoLoaderBox");
if(_1e1f.style.display=="block"){
_1e1f.style.display="none";
}
getObj("textWidthCalculator").innerHTML=jsMsg["Sheet.Row"];
var _1e20=getObj("rowInfoBox");
var row=(row)?row:getBoundaryRowInViewPort().firstRow;
_1e20.innerHTML=jsMsg["Sheet.Row"]+": "+row;
var _1e21=ssVScrollbar.offsetLeft;
var _1e22=ssVScrollbar.offsetWidth;
var _1e23=findClientDim().width;
var left=((_1e21>(_1e23-_1e22+1))?(_1e23-_1e22):_1e21);
_1e20.style.left=addSTDMode(parseInt(left)-getObj("textWidthCalculator").offsetWidth-60);
if(isUndefined(_1e1e)){
_1e20.style.top=addSTDMode(vScrollFaceClickedPos.y-(parseInt(getCurrentStyle(_1e20,"height"))/2));
}else{
_1e20.style.top=addSTDMode(sheetTop+(_1e1e-getSheetScrollTop()));
}
_1e20.style.display="block";
}
function hideRowNoInfo(){
isTileLoaded=true;
clearTileLoadTimeout();
if(isVScrollFaceClicked){
if(rowInfoBoxTimeout){
window.clearTimeout(rowInfoBoxTimeout);
}
rowInfoBoxTimeout=window.setTimeout("onRowInfoBoxTimeout('UNLOADED_PAGE')",500);
}else{
hideRowInfoBox();
hideRowInfoLoaderBox();
}
getObj("textWidthCalculator").innerHTML="";
}
function hideRowInfoBox(){
getObj("rowInfoBox").style.display="none";
}
function hideRowInfoLoaderBox(){
getObj("rowInfoLoaderBox").style.display="none";
}
function showRowInfoBox(){
getObj("rowInfoBox").style.display="block";
}
function showRowInfoLoaderBox(){
getObj("rowInfoLoaderBox").style.display="block";
}
function onTileLoadTimeout(_1e25,_1e26,_1e27){
var _1e28=getBoundaryRowInViewPort();
var _1e29=false;
if(_1e25==="VSCROLLBAR_FACE_DRAG"){
if(_1e27>=_1e28.firstRow&&_1e27<=_1e28.lastRow){
_1e29=true;
}
if(_1e26>=(_1e28.firstRow-1)&&_1e26<=(_1e28.lastRow-1)){
_1e29=true;
}
if(_1e26<_1e28.firstRow&&_1e28.lastRow<=_1e27){
_1e29=true;
}
if(_1e29){
positionRowInfoLoader();
}
}else{
var _1e2a;
var _1e2b;
var _1e2c;
if(_1e27>=_1e28.firstRow&&_1e27<=_1e28.lastRow){
_1e29=true;
_1e2a=_1e26+1;
_1e2b=getRowTop(_1e27-1)-5;
_1e2c=getRowHeight(_1e27-1);
}
if(_1e26>=(_1e28.firstRow-1)&&_1e26<=(_1e28.lastRow-1)){
_1e29=true;
_1e2a=_1e26+1;
_1e2b=getRowTop(_1e26)+5;
_1e2c=getRowHeight(_1e26);
}
if(_1e26<_1e28.firstRow&&_1e28.lastRow<=_1e27){
_1e29=true;
_1e2a=_1e26+1;
_1e2b=getRowTop(_1e26)+5;
_1e2c=getRowHeight(_1e26);
}
if(_1e2a<_1e28.firstRow){
_1e2a=_1e28.firstRow;
}
if(_1e29){
if(_1e2b<getSheetScrollTop()){
_1e2b=getSheetScrollTop()+5;
}else{
if(_1e2b+parseInt(getObj("rowInfoBox").offsetHeight)>getSheetScrollTop()+getSheetHeight()){
_1e2b=getSheetScrollTop()+getSheetHeight()-getObj("rowInfoBox").offsetHeight-5;
}
}
showRowNoInfo(_1e2a,_1e2b);
positionRowInfoLoader();
}
}
}
function positionRowInfoLoader(){
var _1e2d=getObj("rowInfoLoaderBox");
var _1e2e=getObj("rowInfoBox");
_1e2e.style.display="block";
_1e2d.style.display="block";
_1e2d.style.left=addSTDMode(parseInt(_1e2e.style.left)-parseInt(getObj("rowInfoLoaderBox").offsetWidth)+1);
_1e2d.style.top=addSTDMode(_1e2e.style.top);
if(browser_ie){
_1e2d.style.height=addSTDMode(_1e2e.offsetHeight);
}
}
function clearTileLoadTimeout(){
if(tileLoadTimeoutId){
window.clearTimeout(tileLoadTimeoutId);
}
}
var rowInfoBoxTimeout;
function onRowInfoBoxTimeout(_1e2f){
if(_1e2f==="LOADED_PAGE"){
hideRowNoInfo();
}
if(_1e2f==="UNLOADED_PAGE"){
if(isRespondedInScroll){
hideRowInfoBox();
hideRowInfoLoaderBox();
}else{
hideRowInfoLoaderBox();
clearTileLoadTimeout();
tileLoadTimeoutId=setTimeout("onTileLoadTimeout('VSCROLLBAR_FACE_DRAG',"+lastRequestedTileInfo["startRow"]+","+lastRequestedTileInfo["endRow"]+")",500);
showRowInfoBox();
}
}
}
function setRowInfoBoxTimeout(){
if(isVScrollFaceClicked){
if(rowInfoBoxTimeout){
window.clearTimeout(rowInfoBoxTimeout);
}
rowInfoBoxTimeout=window.setTimeout("onRowInfoBoxTimeout('LOADED_PAGE')",400);
}
}
function updateSSVScrollFaceState(){
if(isVScrollFaceClicked){
isVScrollFaceClicked=false;
onVScrollFaceStateChange();
}
}
function onVScrollFaceStateChange(){
if(rowInfoBoxTimeout){
window.clearTimeout(rowInfoBoxTimeout);
}
clearTileLoadTimeout();
hideRowInfoBox();
hideRowInfoLoaderBox();
}
function acknowledgeFunc(_1e30){
var obj=eval("("+_1e30+")");
var _1e32=getAvailableStartRow();
var _1e33=getAvailableEndRow();
var _1e34=obj.aSR;
var _1e35=obj.aER;
var _1e36=obj.mSR;
var _1e37=obj.mER;
var _1e38=obj.mSC;
var _1e39=obj.mEC;
var _1e3a=obj.a;
var _1e3b=obj.sN;
var _1e3c=[1,2,3,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,113,114,115,116,117,118,119,120,31,33,34,35,36,37,38,41,52,56,57,58,69,77,121,122,123,124,129];
if(_1e3c.indexOf(_1e3a)===-1){
if(_1e37>usedCursRow&&_1e3a!=37){
usedCursRow=_1e37;
}
if(_1e39>usedCursCol&&_1e3a!=37){
usedCursCol=_1e39;
}
}
if(_1e3a==45||_1e3a==43||_1e3a==124){
_1e39=totCols;
}
if(_1e3b==CURRSHEETNAME){
var _1e3d=getChangedScrollStatus(_1e34,_1e35);
if(_1e3d!="SUBSET"&&_1e3d!="NO_CHANGE"){
if(!(_1e32>_1e37||_1e33<_1e36)){
if(_1e36>_1e32&&_1e33<_1e37){
var _1e3e=_1e36;
var _1e3f=_1e33;
}else{
if(_1e36<_1e32&&_1e33>_1e37){
var _1e3e=_1e32;
var _1e3f=_1e37;
}else{
if(_1e32<=_1e36&&_1e33>=_1e37){
var _1e3e=_1e36;
var _1e3f=_1e37;
}else{
if(_1e32>=_1e36&&_1e33<=_1e37){
var _1e3e=_1e32;
var _1e3f=_1e33;
}
}
}
}
readRangeDetails(_1e3e,_1e38,_1e3f,_1e39);
}
}
}
}
function getChangedScrollStatus(_1e40,_1e41){
var _1e42=getAvailableStartRow();
var _1e43=getAvailableEndRow();
var _1e44="NO_CHANGE";
if(_1e42>_1e41){
_1e44="DOWN";
}else{
if(_1e43<_1e40){
_1e44="UP";
}else{
if(_1e40<_1e42&&_1e41<=_1e43){
_1e44="UP_PARTIAL";
}else{
if(_1e40>=_1e42&&_1e43<_1e41){
_1e44="DOWN_PARTIAL";
}else{
if(_1e42>_1e40&&_1e43<_1e41){
_1e44="IN_RANGE";
}else{
if(_1e42<=_1e40&&_1e43>=_1e41){
_1e44="SUBSET";
}
}
}
}
}
}
return _1e44;
}
function readRangeDetails(_1e45,_1e46,_1e47,_1e48){
document.cellform.startColumn.value=_1e46;
document.cellform.endColumn.value=_1e48;
document.cellform.startRow.value=_1e45;
document.cellform.endRow.value=_1e47;
document.cellform.totCols.value=totCols;
document.cellform.actionMode.value="callBack";
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.availableStartRow.value=getAvailableStartRow();
document.cellform.availableEndRow.value=getAvailableEndRow();
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
}
if($("#fileName")!=null){
document.cellform.tmpSheet.value=encodeURIComponent($("#fileName").text());
}
importxmlForForm(document.cellform,updateCell,true);
}
function constructTileFromJSON(_1e49,_1e4a,_1e4b,_1e4c,_1e4d,_1e4e){
var _1e4f=false;
var _1e50=[];
var _1e51=document.createDocumentFragment();
var _1e52;
if(_1e4e){
var _1e53=_1e4e.reloadFrozenRows;
_1e50=_1e4e.frozenRows;
if(_1e53&&_1e50.length>0){
_1e4f=true;
_1e52=document.createDocumentFragment();
}
}
var _1e54=getTileContainerMarkup();
var _1e55=getCellMarkUp();
var _1e56=_1e4a[0];
var _1e57=getRowTop(_1e56);
var _1e58=0;
var row=_1e56;
var _1e5a=_1e4a.length;
var _1e5b;
do{
row=_1e4a[_1e58];
if(isTiledRow(row)){
var _1e5c=_1e54.cloneNode("false");
_1e5c.style.display="none";
if(_1e4f&&_1e58<ROWS_PER_TILE){
_1e52.appendChild(_1e5c);
}else{
_1e51.appendChild(_1e5c);
}
_1e5b=getRowTop(row);
_1e5c.style.top=_1e5b+"px";
}
var _1e5d=_1e49[row];
var _1e5e=_1e4c-_1e4b+1;
var col=_1e4b;
if(_1e5d){
do{
var _1e60=_1e5d[col];
var cell=_1e55.cloneNode(false);
if(_1e60){
var _1e62=(browser_ie)?[]:"";
_1e62=concat(_1e62,"cD");
var _1e63=_1e60[0];
var wrap=_1e60[1];
var _1e65=_1e60[2];
var _1e66=_1e60[3];
var annot=_1e60[4];
var _1e68=_1e60[5];
var _1e69=_1e60[6];
var _1e6a=_1e60[7];
var _1e6b=_1e60[8];
var _1e6c=_1e60[9];
var value=!isUndefined(_1e6a)?_1e6a:"";
if(isUndefined(_1e6c)){
_1e6c=value;
}else{
value=_1e6c;
}
cell.style.height=getRowHeight(row)+"px";
cell.style.width=getColWidth(col)+"px";
cell.style.top=getRowTop(row)-_1e5b+"px";
cell.style.left=getColLeft(col)+"px";
_1e62=(wrap)?concat(_1e62," W"):concat(_1e62," nW");
if(_1e63){
_1e62=concat(_1e62,_1e63);
}
if(_1e6b){
_1e62=concat(_1e62,_1e6b);
}
if(browser_ie){
_1e62=_1e62.join("");
}
cell.className=_1e62;
if(_1e65){
var link=_1e65[0];
var _1e6f=_1e65[1];
if(_1e6f!="multi"){
value=_1e65[2];
}
}
if(_1e66){
switch(_1e66){
case 1:
_1e66="STRING";
break;
case 2:
_1e66="FORMULA";
break;
case 3:
_1e66="DATE";
break;
case 4:
_1e66="PERCENT";
break;
case 5:
_1e66="FRACTION";
break;
case 6:
_1e66="CURRENCY";
break;
case 7:
_1e66="BOOLEAN";
break;
case 8:
_1e66="DATETIME";
break;
case 9:
_1e66="ERROR";
break;
case 10:
_1e66="TIME";
break;
case 11:
_1e66="MATRIX";
break;
case 12:
_1e66="SCIENTIFIC";
break;
}
cell.setAttribute("format",_1e66);
}
if(!isUndefined(_1e68)){
cell.setAttribute("fn",_1e68);
}
if(_1e69){
for(var el in _1e69){
switch(el){
case "1":
cell.style.backgroundColor=_1e69[el];
break;
case "2":
cell.style.color=_1e69[el];
break;
case "3":
cell.style.fontFamily=_1e69[el];
break;
case "4":
cell.style.fontSize=_1e69[el];
break;
case "5":
cell.style.textAlign=_1e69[el];
break;
case "6":
cell.style.verticalAlign=_1e69[el];
break;
case "7":
cell.style.borderTop=_1e69[el];
break;
case "8":
cell.style.borderBottom=_1e69[el];
break;
case "9":
cell.style.borderLeft=_1e69[el];
break;
case "10":
cell.style.borderRight=_1e69[el];
break;
}
}
}
if(!isUndefined(_1e6a)){
cell.setAttribute("cV",_1e6a);
}
if(_1e6b){
alignCellVertically(cell,_1e6b,value);
}
if(_1e65){
if(_1e6f!="multi"){
setHyperLinkForCell(undefined,cell,_1e6a,value.replace(/\n/g,"<br>"));
}else{
constructURL(cell,_1e6a);
}
if(browser_ie){
if(cell!=null){
var _1e71=getHyperLinkInCell(cell).childTag;
if(_1e71){
var _1e72=cell;
var cls=cell.className;
if(cls.indexOf("vab")!=-1||cls.indexOf("vam")!=-1){
if(!featureSupport.boxAlign){
_1e72=getChildNode(getChildNode(cell,0),0);
}
}
var _1e74=getChildNodesLength(_1e72);
for(var _1e75=0;_1e75<_1e74;_1e75+=1){
_1e71=getChildItem(_1e72.childNodes,_1e75);
if(_1e71!=null&&_1e71.nodeName=="A"){
var _1e76="";
var regex=new RegExp(getCSSStyleRegex("fontSize")).exec(_1e62);
if(regex!=null){
_1e76=regex[0];
}
var regex=new RegExp(getCSSStyleRegex("fontFamily")).exec(_1e62);
if(regex!=null){
_1e76+=regex[0];
}
if(_1e76!=""){
_1e71.className=_1e76;
}
var _1e78=cell.style.fontSize;
var _1e79=cell.style.fontfamily;
if(_1e78!=""){
_1e71.style.fontSize=_1e78;
}
if(_1e79!=""){
_1e71.style.fontfamily=_1e79;
}
}
}
}
}
}
}else{
var value=encodeBlankSpaces(value.replace(/\n/g,"<br>"),true);
setCellInnerHTML(cell,revertQuote(value));
}
if(!isUndefined(annot)){
addcomment1(cell,"add",row,col,annot);
}
}
_1e5c.appendChild(cell);
var celHt=getRowHeight(row);
var _1e7b=getColWidth(col);
cell.style.height=getRowHeight(row)+"px";
cell.style.width=getColWidth(col)+"px";
cell.style.top=getRowTop(row)-_1e5b+"px";
cell.style.left=getColLeft(col)+"px";
var _1e7c=Merge.getRootCellInfo(row,col);
if(_1e7c){
var sRow=_1e7c["startRow"];
var sCol=_1e7c["startCol"];
var eRow=_1e7c["endRow"];
var eCol=_1e7c["endCol"];
Merge.remove(sRow,sCol,eRow,eCol);
}
col++;
_1e5e--;
}while(_1e5e);
}else{
do{
var cell=_1e55.cloneNode(false);
cell.className="cD nW";
var _1e7b=getColWidth(col);
var celHt=getRowHeight(row);
cell.style.height=celHt+"px";
cell.style.width=_1e7b+"px";
cell.style.top=getRowTop(row)-_1e5b+"px";
cell.style.left=getColLeft(col)+"px";
_1e5c.appendChild(cell);
var _1e7c=Merge.getRootCellInfo(row,col);
if(_1e7c){
var sRow=_1e7c["startRow"];
var sCol=_1e7c["startCol"];
var eRow=_1e7c["endRow"];
var eCol=_1e7c["endCol"];
Merge.remove(sRow,sCol,eRow,eCol);
}
col++;
_1e5e--;
}while(_1e5e);
}
if(isTiledRow(row)){
_1e5c.style.display="";
}
_1e58++;
}while(_1e58<_1e5a);
return {"frozenAreaDocFragment":_1e52,"docFragment":_1e51};
}
function insertRowOrColumn(){
var _1e81=getCellRange();
if(isRowSelected()==true){
Row.executeShiftOperation("INSERT","above",_1e81.startRow,_1e81.endRow-_1e81.startRow+1);
}else{
if(isColSelected()==true){
insertCol("before",_1e81.startcol,_1e81.endcol-_1e81.startcol+1);
}
}
}
var pivot$=function(){
var _1e82=new Array();
for(var i=0;i<arguments.length;i++){
var _1e84=arguments[i];
if(typeof _1e84=="string"){
_1e84=document.getElementById(_1e84);
}
if(arguments.length==1){
return _1e84;
}
_1e82.push(_1e84);
}
return _1e82;
};
function showCollabPannel(){
DOC_PANEL.showDocPanel("chat",showChatPanel());
return false;
}
function cellKeyUp(ev){
if(isSSActive){
if(browser_opera){
var _1e86=(browser_ie)?window.event.keyCode:ev.which;
if(_1e86==46){
}else{
if(_1e86==9||_1e86==13&&!ev.ctrlKey){
exprField.blur();
}
}
}
if(browser_ie){
var ev=window.event;
var el=ev.srcElement;
var _1e86=ev.keyCode;
}else{
if(browser_nn6){
var el=ev.target;
var _1e86=ev.which;
}
}
if(!jsREMOTE_SAVE_VIEW&&!jsGADGET_VIEW&&!jsTHROWAWAY_VIEW){
var _1e88=false;
if(ev.ctrlKey){
ole.onCtrlKeyUp(ev,el);
_1e88=true;
}
if(_1e86==17&&!_1e88){
ole.onCtrlKeyUp(ev,el);
}
}
}
}
var scanSelectionIntvlId;
function cellKeyDown(ev){
stopTextSelectionScanning();
var _1e8a=ev;
if(isSSActive){
if(browser_ie){
var ev=window.event;
var el=ev.srcElement;
var _1e8c=ev.keyCode;
}else{
if(browser_nn6){
var el=ev.target;
var _1e8c=ev.which;
}
}
if(!copyStatus&&!cutStatus&&!(formulaCell&&(_1e8c==37||_1e8c==38||_1e8c==39||_1e8c==40))){
hideFlashDIV();
}
var _1e8d=ev.shiftKey;
var _1e8e=ev.ctrlKey;
var _1e8f=ev.altKey;
var _1e90=ev.metaKey;
if(formulaCell){
if(_1e8c!=16&&_1e8c!=37&&_1e8c!=38&&_1e8c!=39&&_1e8c!=40){
resetFillRanges("cellField",ev.shiftKey,_1e8c);
}
}else{
if(ev.shiftKey){
if(_1e8c!=16&&_1e8c!=37&&_1e8c!=38&&_1e8c!=39&&_1e8c!=40){
resetFillRanges("cellField",ev.shiftKey,_1e8c);
}
}
}
if(!jsREMOTE_SAVE_VIEW&&!jsGADGET_VIEW&&!jsTHROWAWAY_VIEW){
if(_1e8e){
ole.onCtrlKeyDown(ev,el);
}
if(_1e90){
ole.onCtrlKeyDown(ev,el);
}
}
var tag=el.tagName.toUpperCase();
if((el!=cellField)&&(tag=="INPUT"||(tag=="TEXTAREA"&&el.id!="cpTextArea")||tag=="SELECT"||tag=="IMG"||tag=="A")){
if(_1e8c==9||_1e8c==39){
if(currCol+1==totCols){
insertCol("append",totCols,1,false,true,false);
focusCell(currRow,currCol+1,undefined,undefined,undefined,_1e8a);
}
}
if(_1e8c==13||_1e8c==40){
if(currRowTemp+1==totRows){
appendBlankRows();
focusCell(currRowTemp+1,currCol,undefined,undefined,undefined,_1e8a);
}
}
if(_1e8c==27){
insertCopyRows=false;
insertCopyCols=false;
insertCutRows=false;
insertCutCols=false;
clearCellRangeFill();
}
if(_1e8c==37||_1e8c==38||_1e8c==39||_1e8c==40){
rangeSelection();
}
return;
}
currKeyCode=_1e8c;
if((os_mac&&_1e8c==8)&&(browser_safari||browser_firefox)){
deleteCell();
}
if((os_mac&&(_1e90||_1e8e))||(!os_mac&&_1e8e&&!_1e8f&&!_1e90)){
switch(_1e8c){
case 32:
if(_1e8d){
focusAllCells();
}else{
var _1e92;
var _1e93;
if(isCellRange()){
var _1e94=getCellRange();
_1e92=_1e94.startCol;
_1e93=_1e94.endCol;
}else{
var info=ActiveCellInfo;
_1e92=info.getStartCol();
_1e93=info.getEndCol();
}
focusCol(_1e92,_1e93);
}
return false;
case 65:
focusAllCells();
return false;
case 66:
if(READ_WRITE){
var _1e96;
if($("#bold").metadata().appData.status=="true"){
_1e96=0;
$("#formatData").zbutton("uncheck","#bold");
}else{
_1e96=1;
$("#formatData").zbutton("check","#bold");
}
format_new("bold",_1e96);
}
return false;
case 67:
copyCells("copyShortCut");
return;
case 68:
if(isCellRange()&&getCellRange().startRow<getCellRange().endRow){
Event.stop(ev);
stopEvt(ev);
fillSeriesDown();
return false;
}else{
return;
}
case 70:
if(_1e8d){
if(os_mac&&_1e90&&!_1e8e&&!_1e8f){
Filter.doFilterAction();
return false;
}
if(READ_WRITE){
setCaretPos(exprField,getCellContent().length);
}
return false;
}else{
showSearchBar();
if(browser_ie){
disableKeys(ev);
}
stopEvt(ev);
return false;
}
case 71:
callGoToJsp();
return false;
case 72:
showSearchBar();
if(browser_ie){
disableKeys(ev);
}
stopEvt(ev);
return false;
case 73:
if(READ_WRITE){
var _1e96;
if($("#italic").metadata().appData.status=="true"){
_1e96=0;
$("#formatData").zbutton("uncheck","#italic");
}else{
_1e96=1;
$("#formatData").zbutton("check","#italic");
}
format_new("italic",_1e96);
}
return false;
case 75:
if(READ_WRITE){
hyperLinkSetting();
}
return false;
case 76:
if(_1e8d&&!os_mac){
Filter.doFilterAction();
return false;
}
break;
case 110:
case 78:
if(_1e8d){
currCellIndicator.focus();
}else{
if(!jsREMOTE_SAVE_VIEW&&!jsGADGET_VIEW&&!jsTHROWAWAY_VIEW&&!jsPUBLIC_VIEW){
if(jsDOCS_VIEW||(docView&&displayAll)){
return;
}
ole.onOpenNewDoc(ev);
TEMPLATE_FLAG="false";
loadDocument("ajaxnew.do");
}
}
return false;
case 79:
if(browser_ie){
disableKeys(ev);
}
if(!cdview&&!jsREMOTE_VIEW&&!jsREMOTE_SAVE_VIEW&&!jsTHROWAWAY_VIEW){
openFileDialog();
}
return false;
case 80:
if(getViewType()!="REMOTE_VIEW"&&getViewType()!="THROWAWAY_VIEW"){
if(ENABLE_PDF_PRINT){
Print.init();
}else{
exportDoc(".html","print","yes");
}
}
if(browser_ie){
disableKeys(ev);
}
stopEvt(ev);
return false;
case 82:
if(!ev.shiftKey&&isCellRange()&&getCellRange().startCol<getCellRange().endCol){
Event.stop(ev);
stopEvt(ev);
fillSeriesRight();
return false;
}else{
return;
}
case 83:
if(_1e8d){
saveasdialog("saveasdialog");
}else{
if(isEdit&&!docView){
saveDocument();
}else{
if(jsREMOTE_SAVE_VIEW){
saveremoteGEdoc();
}else{
var _1e97=document.getElementById("isDocTemplate").value;
if(_1e97=="true"){
savefile("template");
}else{
if(TEMPLATE_FLAG=="true"){
savefile("template");
}else{
if(!ISAPP_READONLYMODE){
savefile();
}
}
}
}
}
}
return false;
case 84:
return;
case 85:
if(READ_WRITE&&os_mac&&_1e8e){
isF2KeyPressed=true;
focusCellField(getCellContent());
}else{
if(READ_WRITE&&!ev.shiftKey){
var _1e96;
if($("#underline").metadata().appData.status=="true"){
_1e96=0;
$("#formatData").zbutton("uncheck","#underline");
}else{
_1e96=1;
$("#formatData").zbutton("check","#underline");
}
format_new("underline",_1e96);
}else{
if(ev.shiftKey){
if(isExprFieldExpanded){
collapseExprField();
}else{
expandExprField();
}
}
}
}
return false;
case 86:
if(READ_WRITE){
var _1e98=copyStatus;
var _1e99=cutStatus;
pasteCells();
copyStatus=_1e98;
if(copyStatus||cutStatus){
return false;
}
return;
}
return;
case 88:
if(READ_WRITE){
cutCells();
}
return;
case 89:
redo();
return false;
case 90:
undo();
return false;
case 107:
if(_1e8d||_1e8f){
insertRowOrColumn();
return false;
}
case 109:
setTimeout("focusSheet()",10);
return;
case 114:
if(READ_WRITE){
showNameDialog("add");
}
return false;
case 49:
if(READ_WRITE&&_1e8d){
showFormatCellsDialog();
}
return false;
case 50:
if(READ_WRITE&&_1e8d){
var _1e96;
if($("#bold").metadata().appData.status=="true"){
_1e96=0;
$("#formatData").zbutton("uncheck","#bold");
}else{
_1e96=1;
$("#formatData").zbutton("check","#bold");
}
format_new("bold",_1e96);
}
return false;
case 51:
if(READ_WRITE&&_1e8d){
var _1e96;
if($("#italic").metadata().appData.status=="true"){
_1e96=0;
$("#formatData").zbutton("uncheck","#italic");
}else{
_1e96=1;
$("#formatData").zbutton("check","#italic");
}
format_new("italic",_1e96);
}
return false;
case 52:
if(READ_WRITE&&_1e8d){
var _1e96;
if($("#underline").metadata().appData.status=="true"){
_1e96=0;
$("#formatData").zbutton("uncheck","#underline");
}else{
_1e96=1;
$("#formatData").zbutton("check","#underline");
}
format_new("underline",_1e96);
}
return false;
case 53:
if(_1e8d&&READ_WRITE){
var _1e96;
if($("#strike").metadata().appData.status=="true"){
_1e96=0;
$("#formatData").zbutton("uncheck","#strike");
}else{
_1e96=1;
$("#formatData").zbutton("check","#strike");
}
format_new("strike",_1e96);
}
return false;
case 57:
}
}
if(_1e8c==107){
if(_1e8e&&(_1e8d||_1e8f)){
insertRowOrColumn();
return false;
}
}
if(_1e8c==187){
if(ev.ctrlKey&&(ev.altKey||ev.shiftKey)){
insertRowOrColumn();
return false;
}
}
if(_1e8c==113){
if(_1e8d){
if(READ_WRITE){
commentSetting();
}
exitFormatPainter();
}else{
if(READ_WRITE){
isF2KeyPressed=true;
focusCellField(getCellContent());
exitFormatPainter();
}
}
return false;
}
if(_1e8c==114){
if(_1e8d){
showFuncList();
}else{
if(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE){
return;
}
showSearchBar();
if(browser_ie&&!browser_ie6){
ev.keyCode=0;
}
stopEvt(ev);
return false;
}
}
if(_1e8c==115){
if(browser_ie){
ev.keyCode=0;
}
redo();
return false;
}
if(_1e8f&&_1e8c==119){
if(ALL_SHEET_SHARED&&!jsREMOTE_SAVE_VIEW&&!jsGADGET_VIEW&&!jsTHROWAWAY_VIEW&&READ_WRITE){
showMacros();
stopEvt(ev);
return false;
}
}
if(_1e8f&&_1e8c==122){
if(ALL_SHEET_SHARED&&!jsREMOTE_SAVE_VIEW&&!jsGADGET_VIEW&&!jsTHROWAWAY_VIEW&&READ_WRITE){
showMacroEditorDialog();
stopEvt(ev);
return false;
}
}
if(_1e8c==120){
recalculate("");
stopEvt(ev);
return false;
}
if(_1e8d&&_1e8c==122){
if(getViewType()!="PUBLIC_VIEW"&&!isReadOnlyViewMode&&!ISAPP_READONLYMODE){
insertSheet();
}
return false;
}
if(_1e8c==27){
if(fPainter.fPainterdoubleclick||fPainter.fPaintersingleclick){
fPainter.fPainterdoubleclick=false;
fPainter.fPaintersingleclick=false;
cursorchange();
firing=false;
}
insertCopyRows=false;
insertCopyCols=false;
insertCutRows=false;
insertCutCols=false;
changebuttonsState("insertRowColumn","enable",["insrowstbtn","insrowsmenu"]);
changebuttonsState("insertRowColumn","enable",["inscolstbtn","inscolsmenu"]);
clearCellRangeFill();
if(isFilterOptionsDIVOpened){
Filter.hideFilterOptions();
}
return false;
}
if((_1e8c>=16&&_1e8c<=20)||_1e8c==27||_1e8c==45||(_1e8c>=112&&_1e8c<=126)||_1e8c==144||_1e8c==145||_1e8c==193){
return;
}
if(_1e8c==37||_1e8c==38||_1e8c==39||_1e8c==40){
rangeSelection();
}
switch(_1e8c){
case 8:
if(READ_WRITE){
if(!os_mac&&(browser_safari||browser_firefox)){
focusCellField();
}
}
return false;
break;
case 27:
clearCellRangeFill();
focusCell(currRow,currCol,undefined,undefined,undefined,_1e8a);
break;
case 32:
if(_1e8d){
var _1e9a;
var _1e9b;
if(isCellRange()){
var _1e94=getCellRange();
_1e9a=_1e94.startRow;
_1e9b=_1e94.endRow;
}else{
var info=ActiveCellInfo;
_1e9a=info.getStartRow();
_1e9b=info.getEndRow();
}
focusRow(_1e9a,_1e9b);
}
break;
case 33:
if(!_1e8e){
var _1e94=getCellRange();
var _1e9c=_1e94.startRow;
var _1e9d=getSheetScrollTop()-getSheetHeight();
var count=0;
if(rowToFocusOnPageNavigation!==undefined){
count=rowToFocusOnPageNavigation;
}else{
var _1e9f=getBoundaryRowInViewPort();
var _1ea0=_1e9f.firstRow;
var _1ea1=_1e9f.lastRow;
if(_1e9c<=_1ea1&&_1e9c>=_1ea0){
var count=Row.getNonHiddenRowsInRange(_1ea0,_1e9c).length;
}else{
var count=0;
}
rowToFocusOnPageNavigation=count;
}
if((getRowTop(_1e9c)-getSheetHeight())<0){
setScrollTop(0);
return;
}
setScrollTop(_1e9d+findThirdPaneYPos());
var _1e9f=getBoundaryRowInViewPort();
var _1ea2=_1e9f.firstRow;
var _1ea3=_1e9f.lastRow;
var _1ea4=Row.getNonHiddenRowsInRange(_1ea2,_1ea3).length;
count=Row.findNthNonHiddenRow(((_1ea4<count)?_1ea4:count),_1ea2-1,true);
if(_1e8d){
clearTextSelection();
focusCellRange(currRow,currCol,count,_1e94.startCol,"KEYSELECTION",true,undefined,true);
}else{
var info=ActiveCellInfo;
focusCell(count,info.getStartCol(),undefined,true,true,_1e8a);
}
return false;
}else{
return;
}
case 34:
if(!_1e8e){
var _1e94=getCellRange();
var _1ea5=_1e94.endRow;
var _1ea6=getSheetScrollTop()+getSheetHeight();
var count=0;
if(rowToFocusOnPageNavigation!==undefined){
count=rowToFocusOnPageNavigation;
}else{
var _1e9f=getBoundaryRowInViewPort();
var _1ea0=_1e9f.firstRow;
var _1ea1=_1e9f.lastRow;
if(_1ea5<=_1ea1&&_1ea5>=_1ea0){
var count=Row.getNonHiddenRowsInRange(_1ea0,_1ea5).length;
}else{
var count=0;
}
rowToFocusOnPageNavigation=count;
}
var _1ea7=getSheetScrollTop()+(2*getSheetHeight());
if((getRowTop(totRows-1)+getRowHeight(totRows-1))<_1ea7){
var _1ea8=getCeilRow(findRowInYPos(_1ea7,true));
appendBlankRows("ROWS_EXCEEDED",_1ea8);
}
setScrollTop(_1ea6-findThirdPaneYPos());
var _1e9f=getBoundaryRowInViewPort();
var _1ea9=_1e9f.firstRow;
var _1eaa=_1e9f.lastRow;
var _1eab=Row.getNonHiddenRowsInRange(_1ea9,_1eaa).length;
count=Row.findNthNonHiddenRow(((_1eab<count)?_1eab:count),_1ea9-1,true);
if(_1e8d){
clearTextSelection();
focusCellRange(currRow,currCol,count,_1e94.endCol,"KEYSELECTION",true,undefined,true);
}else{
var info=ActiveCellInfo;
focusCell(count,info.getStartCol(),undefined,true,true,_1e8a);
}
return false;
}else{
return;
}
case 35:
if(_1e8e){
var _1eac=usedCursRow;
if(Row.isHidden(usedCursRow)){
_1eac=Row.findNextNonHiddenRow(usedCursRow,false);
}
if(isUndefined(_1eac)){
_1eac=0;
}
}
if(_1e8e&&!_1e8d){
focusCell(_1eac,usedCursCol,undefined,undefined,undefined,_1e8a);
}else{
if(_1e8d&&!_1e8e){
clearTextSelection();
_1e93=(selCol==null||selCol==-1)?currCol:selCol;
focusCellRange(currRow,currCol,currRow,usedCursCol);
}else{
if(_1e8e&&_1e8d){
clearTextSelection();
_1e9b=(selRow==null||selRow==-1)?currRow:selRow;
focusCellRange(currRow,currCol,_1eac,usedCursCol);
}else{
var info=ActiveCellInfo;
focusCell(info.getStartRow(),totCols-1,undefined,undefined,undefined,_1e8a);
}
}
}
return false;
break;
case 36:
if(_1e8d&&!_1e8e){
if(isCellRange()){
var _1e94=getCellRange();
blurColHead(_1e94.startCol,_1e94.endCol);
}
clearTextSelection();
_1e9b=(selRow==null||selRow==-1)?currRow:selRow;
if(ISFREEZED){
focusCellRange(currRow,currCol,_1e9b,FREEZED_COL);
}else{
focusCellRange(currRow,currCol,_1e9b,0);
}
return false;
}else{
if(_1e8e&&!_1e8d){
if(ISFREEZED){
focusCell((Row.isHidden(FREEZED_ROW))?Row.findNextNonHiddenRow(FREEZED_ROW-1):FREEZED_ROW,FREEZED_COL,undefined,undefined,undefined,_1e8a);
}else{
focusCell(Row.firstNonHiddenRow,0);
}
return false;
}else{
if(_1e8e&&_1e8d){
if(isCellRange()){
var _1e94=getCellRange();
blurColHead(_1e94.startCol,_1e94.endCol);
blurRowHead(_1e94.startRow,_1e94.endRow);
}
clearTextSelection();
_1e9b=(selRow==null||selRow==-1)?currRow:selRow;
if(ISFREEZED){
focusCellRange(currRow,currCol,(Row.isHidden(FREEZED_ROW))?Row.findNextNonHiddenRow(FREEZED_ROW-1):FREEZED_ROW,FREEZED_COL);
}else{
focusCellRange(currRow,currCol,0,0);
}
return false;
}else{
if(!_1e8f){
var info=ActiveCellInfo;
focusCell(info.getStartRow(),FREEZED_COL,undefined,undefined,undefined,_1e8a);
return false;
}
}
}
}
return;
break;
case 37:
rangeSelection();
if(_1e8d&&!(_1e8e||_1e90)){
if(formulaCell){
var _1e92=cellRangeStartCol;
var _1e93=cellRangeEndCol;
var _1e9a=_1e9c;
var _1e9b=_1ea5;
var info=ActiveFormulaInfo;
var _1ead=info.getActiveCol();
var _1eae=false;
var _1eaf=false;
}else{
var rng=getCellRange();
var _1e92=rng.startCol;
var _1e93=rng.endCol;
var _1e9a=rng.startRow;
var _1e9b=rng.endRow;
var _1ead=currCol;
var _1eae=isColSelected();
var _1eaf=isRowSelected();
}
if(_1eaf){
return;
}else{
if(_1eae){
if(_1e92==_1ead){
if(_1e93<=0){
return;
}
focusCol(_1e92,_1e93-1);
}else{
if(_1e93==_1ead){
if(_1e92<=0){
return;
}
focusCol(_1e93,_1e92-1);
}else{
var _1eb1=new Range(_1e9a,_1ead,_1e9b,_1ead);
Merge.extendRange(_1eb1);
var _1eb2=_1eb1.startCol;
var endC=_1eb1.endCol;
if(_1eb2==_1e92){
if(_1e93<=0){
return;
}
focusCol(_1e92,_1e93-1);
}else{
if(endC==_1e93){
if(_1e92<=0){
return;
}
focusCol(_1e93,_1e92-1);
}
}
}
}
}else{
if(_1e92==_1ead){
var range=new Range(_1e9a,_1e93,_1e9b,_1e93);
Merge.extendRange(range);
if(range.startCol<=0){
return;
}
_1e93=range.startCol-1;
focusCellRange(_1e9a,_1e92,_1e9b,_1e93,"KEYSELECTION");
}else{
if(_1e93==_1ead){
if(_1e92<=0){
return;
}
_1e92=_1e92-1;
focusCellRange(_1e9b,_1e93,_1e9a,_1e92,"KEYSELECTION");
}else{
var _1eb1=new Range(_1e9a,_1ead,_1e9b,_1ead);
Merge.extendRange(_1eb1);
var _1eb2=_1eb1.startCol;
var endC=_1eb1.endCol;
if(_1eb2==_1e92){
var range=new Range(_1e9a,_1e93,_1e9b,_1e93);
Merge.extendRange(range);
if(range.startCol<=0){
return;
}
_1e93=range.startCol-1;
focusCellRange(_1e9a,_1e92,_1e9b,_1e93,"KEYSELECTION");
}else{
if(endC==_1e93){
if(_1e92<=0){
return;
}
_1e92=_1e92-1;
focusCellRange(_1e9b,_1e93,_1e9a,_1e92,"KEYSELECTION");
}else{
if(_1e93<=0){
return;
}
_1e93-=1;
focusCellRange(_1e9a,_1e92,_1e9b,_1e93,"KEYSELECTION");
}
}
}
}
}
}
}else{
if(_1e8e||_1e90){
if(isCellRange()){
if(_1e8d){
var _1e94=getCellRange();
if(currCol!=_1e94.startCol){
var _1eb5=_1e94.startCol;
}else{
var _1eb5=_1e94.endCol;
}
}else{
var _1eb5=currCol;
var info=ActiveCellInfo;
_1eb5=info.getStartCol();
}
var _1eb6=getCell(currRow,_1eb5,undefined,true);
}else{
var _1eb5=currCol;
var info=ActiveCellInfo;
var _1eb7=info.getActiveRow();
var _1ead=info.getActiveCol();
var _1eb6=getCell(_1eb7,_1ead,undefined,true);
_1eb5=info.getStartCol();
}
var evt="LEFT";
if(_1eb5>0){
if(isRowAvailable(currRow)){
if(isCellContainingContent(_1eb6)){
var _1eb9=getCell(currRow,_1eb5-1,undefined,true);
if(isCellContainingContent(_1eb9)){
var i=getNextCellDetailsNotContainingContent(currRow,_1eb5,evt,_1e8d).col+1;
}else{
var i=getNextCellDetailsContainingContent(currRow,_1eb5,evt,_1e8d).col;
}
}else{
var i=getNextCellDetailsContainingContent(currRow,_1eb5,evt,_1e8d).col;
}
}else{
getUsedCursorCell(currRow,_1eb5,evt,_1e8d);
return;
}
i=(i<0)?0:i;
if(_1e8d){
if(isCellRange()){
var _1e94=getCellRange();
if(currCol!=_1e94.startCol){
focusCellRange(_1e94.startRow,_1e94.endCol,_1e94.endRow,i,"KEYSELECTION");
}else{
resetCellRange();
focusCellRange(_1e94.startRow,_1e94.startCol,_1e94.endRow,i,"KEYSELECTION");
}
}else{
focusCellRange(currRow,currCol,currRow,i,"KEYSELECTION");
}
}else{
focusCell(currRow,i,undefined,undefined,undefined,_1e8a);
}
}
}else{
if(formulaCell){
var info=ActiveFormulaInfo;
var row=info.getActiveRow();
var col=info.getStartCol()-1;
if(col>=0){
ActiveFormulaInfo.set(row,col);
focusCellRangeFill(row,col,row,col);
}
}else{
var info=ActiveCellInfo;
focusCell(info.getActiveRow(),info.getStartCol()-1,undefined,undefined,undefined,_1e8a);
}
}
}
return false;
case 38:
rangeSelection();
if(_1e8d&&!(_1e8e||_1e90)){
if(formulaCell){
var _1e92=cellRangeStartCol;
var _1e93=cellRangeEndCol;
var _1e9a=_1e9c;
var _1e9b=_1ea5;
var info=ActiveFormulaInfo;
var _1eb7=info.getActiveRow();
var _1eae=false;
var _1eaf=false;
}else{
var rng=getCellRange();
var _1e92=rng.startCol;
var _1e93=rng.endCol;
var _1e9a=rng.startRow;
var _1e9b=rng.endRow;
var _1eb7=currRow;
var _1eae=isColSelected();
var _1eaf=isRowSelected();
}
if(_1eae){
return;
}else{
if(_1eaf){
if(_1e9a==_1eb7){
if(_1e9b<=0){
return;
}
focusRow(_1e9a,Row.findNextNonHiddenRow(_1e9b,false));
}else{
if(_1e9b==_1eb7){
if(_1e9a<=0){
return;
}
focusRow(_1e9b,Row.findNextNonHiddenRow(_1e9a,false));
}else{
var _1ebd=new Range(_1eb7,_1e92,_1eb7,_1e93);
Merge.extendRange(_1ebd);
var _1ebe=_1ebd.startRow;
var endR=_1ebd.endRow;
if(_1ebe==_1e9a){
if(_1e9b<=0){
return;
}
focusRow(_1e9a,Row.findNextNonHiddenRow(_1e9b,false));
}else{
if(endR==_1e9b){
if(_1e9a<=0){
return;
}
focusRow(_1e9b,Row.findNextNonHiddenRow(_1e9a,false));
}
}
}
}
}else{
if(_1e9a==_1eb7){
var range=new Range(_1e9b,_1e92,_1e9b,_1e93);
Merge.extendRange(range);
if(range.startRow<=0){
return;
}
_1e9b=Row.findNextNonHiddenRow(range.startRow,false);
focusCellRange(_1e9a,_1e92,_1e9b,_1e93,"KEYSELECTION");
}else{
if(_1e9b==_1eb7){
if(_1e9a<=0){
return;
}
_1e9a=Row.findNextNonHiddenRow(_1e9a,false);
focusCellRange(_1e9b,_1e93,_1e9a,_1e92,"KEYSELECTION");
}else{
var _1ebd=new Range(_1eb7,_1e92,_1eb7,_1e93);
Merge.extendRange(_1ebd);
var _1ebe=_1ebd.startRow;
var endR=_1ebd.endRow;
if(_1ebe==_1e9a){
var range=new Range(_1e9b,_1e92,_1e9b,_1e93);
Merge.extendRange(range);
if(range.startRow<=0){
return;
}
_1e9b=Row.findNextNonHiddenRow(range.startRow,false);
focusCellRange(_1e9a,_1e92,_1e9b,_1e93,"KEYSELECTION");
}else{
if(endR==_1e9b){
if(_1e9a<=0){
return;
}
_1e9a=Row.findNextNonHiddenRow(_1e9a,false);
focusCellRange(_1e9b,_1e93,_1e9a,_1e92,"KEYSELECTION");
}else{
if(_1e9b<=0){
return;
}
_1e9b=Row.findNextNonHiddenRow(_1e9b,false);
focusCellRange(_1e9a,_1e92,_1e9b,_1e93,"KEYSELECTION");
}
}
}
}
}
}
}else{
if(_1e8e||_1e90){
if(isCellRange()){
if(_1e8d){
var _1e94=getCellRange();
if(currRow!=_1e94.startRow){
var _1ec0=_1e94.startRow;
}else{
var _1ec0=_1e94.endRow;
}
}else{
var _1ec0=currRow;
var info=ActiveCellInfo;
_1ec0=info.getStartRow();
}
var _1eb6=getCell(_1ec0,currCol,undefined,true);
}else{
var _1ec0=currRow;
var info=ActiveCellInfo;
var _1eb7=info.getActiveRow();
var _1ead=info.getActiveCol();
var _1eb6=getCell(_1eb7,_1ead,undefined,true);
_1ec0=info.getStartRow();
}
var evt="UP";
if(_1ec0>0){
if(isRowAvailable(_1ec0)){
if(isCellContainingContent(_1eb6)){
var _1ec1=Row.findNextNonHiddenRow(_1ec0,false);
var _1eb9=getCell(_1ec1,currCol,undefined,true);
if(isRowAvailable(_1ec1)){
if(isCellContainingContent(_1eb9)){
var info=getNextCellDetailsNotContainingContent(_1ec0,currCol,evt,_1e8d);
var i=info.found?info.row+1:info.row;
if(isNaN(i)){
return;
}
}else{
var i=getNextCellDetailsContainingContent(_1ec0,currCol,evt,_1e8d).row;
if(isNaN(i)){
return;
}
}
}else{
getUsedCursorCell(_1ec0,currCol,evt,_1e8d);
return;
}
}else{
var i=getNextCellDetailsContainingContent(_1ec0,currCol,evt,_1e8d).row;
if(isNaN(i)){
return;
}
}
}else{
getUsedCursorCell(_1ec0,currCol,evt,_1e8d);
return;
}
i=(i<0)?0:i;
if(_1e8d){
if(isCellRange()){
var _1e94=getCellRange();
if(currRow!=_1e94.startRow){
focusCellRange(_1e94.endRow,_1e94.startCol,i,_1e94.endCol,"KEYSELECTION");
}else{
resetCellRange();
focusCellRange(_1e94.startRow,_1e94.startCol,i,_1e94.endCol,"KEYSELECTION");
}
}else{
focusCellRange(currRow,currCol,i,currCol,"KEYSELECTION");
}
}else{
focusCell(i,currCol,undefined,undefined,undefined,_1e8a);
}
}
}else{
if(formulaCell){
var info=ActiveFormulaInfo;
var col=info.getActiveCol();
var row=Row.findNextNonHiddenRow(info.getStartRow(),false);
if(row>=0){
ActiveFormulaInfo.set(row,col);
focusCellRangeFill(row,col,row,col);
}
}else{
var info=ActiveCellInfo;
focusCell(Row.findNextNonHiddenRow(info.getStartRow(),false),info.getActiveCol(),undefined,undefined,undefined,_1e8a);
}
}
}
return false;
case 9:
if(_1e8d&&!(_1e8e||_1e90)){
if(!isCellRange()){
var info=ActiveCellInfo;
focusCell(info.getActiveRow(),info.getStartCol()-1,undefined,undefined,undefined,_1e8a);
}
return false;
}else{
if(_1e8e||_1e90){
return;
}
}
case 39:
rangeSelection();
if(_1e8d&&!(_1e8e||_1e90)){
if(formulaCell){
var _1e92=cellRangeStartCol;
var _1e93=cellRangeEndCol;
var _1e9a=_1e9c;
var _1e9b=_1ea5;
var info=ActiveFormulaInfo;
var _1ead=info.getActiveCol();
var _1eae=false;
var _1eaf=false;
}else{
if(isCellRange()){
var rng=getCellRange();
var _1e92=rng.startCol;
var _1e93=rng.endCol;
var _1e9a=rng.startRow;
var _1e9b=rng.endRow;
}else{
var info=ActiveCellInfo;
var _1e92=info.getStartCol();
var _1e93=info.getEndCol();
var _1e9a=info.getStartRow();
var _1e9b=info.getEndRow();
}
var _1ead=currCol;
var _1eae=isColSelected();
var _1eaf=isRowSelected();
}
if(_1eaf){
return;
}else{
if(_1eae){
if(_1e92==_1ead){
focusCol(_1e92,_1e93+1);
}else{
if(_1e93==_1ead){
focusCol(_1e93,_1e92+1);
}else{
var _1eb1=new Range(_1e9a,_1ead,_1e9b,_1ead);
Merge.extendRange(_1eb1);
var _1eb2=_1eb1.startCol;
var endC=_1eb1.endCol;
if(_1eb2==_1e92){
focusCol(_1e92,_1e93+1);
}else{
if(endC==_1e93){
focusCol(_1e93,_1e92+1);
}
}
}
}
}else{
if(_1e92==_1ead){
_1e93=_1e93+1;
focusCellRange(_1e9a,_1e92,_1e9b,_1e93,"KEYSELECTION");
}else{
if(_1e93==_1ead){
var range=new Range(_1e9a,_1e92,_1e9b,_1e92);
Merge.extendRange(range);
_1e92=range.endCol+1;
focusCellRange(_1e9b,_1e93,_1e9a,_1e92,"KEYSELECTION");
}else{
var _1eb1=new Range(_1e9a,_1ead,_1e9b,_1ead);
Merge.extendRange(_1eb1);
var _1eb2=_1eb1.startCol;
var endC=_1eb1.endCol;
if(_1eb2==_1e92){
_1e93=_1e93+1;
focusCellRange(_1e9a,_1e92,_1e9b,_1e93,"KEYSELECTION");
}else{
if(endC==_1e93){
var range=new Range(_1e9a,_1e92,_1e9b,_1e92);
Merge.extendRange(range);
_1e92=range.endCol+1;
focusCellRange(_1e9b,_1e93,_1e9a,_1e92,"KEYSELECTION");
}else{
_1e92+=1;
focusCellRange(_1e9b,_1e93,_1e9a,_1e92,"KEYSELECTION");
}
}
}
}
}
}
}else{
if(_1e8e||_1e90){
if(isCellRange()){
if(_1e8d){
var _1e94=getCellRange();
if(currCol!=_1e94.endCol){
var _1eb5=getCellRange().endCol;
}else{
var _1eb5=getCellRange().startCol;
}
}else{
var _1eb5=currCol;
var info=ActiveCellInfo;
_1eb5=info.getEndCol();
}
var _1eb6=getCell(currRow,_1eb5,undefined,true);
}else{
var _1eb5=currCol;
var info=ActiveCellInfo;
var _1eb7=info.getActiveRow();
var _1ead=info.getActiveCol();
var _1eb6=getCell(_1eb7,_1ead,undefined,true);
_1eb5=info.getEndCol();
}
var evt="RIGHT";
if(_1eb5<(totCols-1)){
if(isRowAvailable(currRow)){
if(isCellContainingContent(_1eb6)){
var _1ec2=getCell(currRow,_1eb5+1,undefined,true);
if(isCellContainingContent(_1ec2)){
var i=getNextCellDetailsNotContainingContent(currRow,_1eb5,evt,_1e8d).col-1;
}else{
var i=getNextCellDetailsContainingContent(currRow,_1eb5,evt,_1e8d).col;
}
}else{
var i=getNextCellDetailsContainingContent(currRow,_1eb5,evt,_1e8d).col;
}
}else{
getUsedCursorCell(currRow,_1eb5,evt,_1e8d);
return;
}
i=(i>=totCols)?totCols-1:i;
if(_1e8d){
if(isCellRange()){
var _1e94=getCellRange();
if(currCol!=_1e94.endCol){
focusCellRange(_1e94.startRow,_1e94.startCol,_1e94.endRow,i,"KEYSELECTION");
}else{
resetCellRange();
focusCellRange(_1e94.startRow,_1e94.endCol,_1e94.endRow,i,"KEYSELECTION");
}
}else{
focusCellRange(currRow,currCol,currRow,i,"KEYSELECTION");
}
}else{
focusCell(currRow,i,undefined,undefined,undefined,_1e8a);
}
}
}else{
if(formulaCell){
var info=ActiveFormulaInfo;
var row=info.getActiveRow();
var col=info.getEndCol()+1;
if(col<totCols){
ActiveFormulaInfo.set(row,col);
focusCellRangeFill(row,col,row,col);
}
}else{
var info=ActiveCellInfo;
var col=info.getEndCol()+1;
if(col==totCols){
insertCol("append",totCols,1,false,true,false);
}
focusCell(info.getActiveRow(),col,undefined,undefined,undefined,_1e8a);
}
}
}
return false;
case 13:
if(_1e8d){
var info=ActiveCellInfo;
focusCell(Row.findNextNonHiddenRow(info.getStartRow(),false),info.getActiveCol(),undefined,undefined,undefined,_1e8a);
return false;
}
if(_1e8f){
repeat.doAction(repeat.LASTACTIONJSON,false);
return;
}
case 40:
var _1ec3=((isCellRange()?selRow:currRow)>=Row.getLastNonHiddenRow());
if(_1ec3){
return false;
}
rangeSelection();
if(_1e8d&&!(_1e8e||_1e90)){
clearTextSelection();
if(formulaCell){
var _1e92=cellRangeStartCol;
var _1e93=cellRangeEndCol;
var _1e9a=_1e9c;
var _1e9b=_1ea5;
var info=ActiveFormulaInfo;
var _1eb7=info.getActiveRow();
var _1eae=false;
var _1eaf=false;
}else{
if(isCellRange()){
var rng=getCellRange();
var _1e92=rng.startCol;
var _1e93=rng.endCol;
var _1e9a=rng.startRow;
var _1e9b=rng.endRow;
}else{
var info=ActiveCellInfo;
var _1e92=info.getStartCol();
var _1e93=info.getEndCol();
var _1e9a=info.getStartRow();
var _1e9b=info.getEndRow();
}
var _1eb7=currRow;
var _1eae=isColSelected();
var _1eaf=isRowSelected();
}
if(_1eae){
return;
}else{
if(_1eaf){
if(_1e9a==_1eb7){
focusRow(_1e9a,Row.findNextNonHiddenRow(_1e9b));
}else{
if(_1e9b==_1eb7){
focusRow(_1e9b,Row.findNextNonHiddenRow(_1e9a));
}else{
var _1ebd=new Range(_1eb7,_1e92,_1eb7,_1e93);
Merge.extendRange(_1ebd);
var _1ebe=_1ebd.startRow;
var endR=_1ebd.endRow;
if(_1ebe==_1e9a){
focusRow(_1e9a,Row.findNextNonHiddenRow(_1e9b));
}else{
if(endR==_1e9b){
focusRow(_1e9b,Row.findNextNonHiddenRow(_1e9a));
}
}
}
}
}else{
if(_1e9a==_1eb7){
_1e9b=Row.findNextNonHiddenRow(_1e9b);
focusCellRange(_1e9a,_1e92,_1e9b,_1e93,"KEYSELECTION");
}else{
if(_1e9b==_1eb7){
var range=new Range(_1e9a,_1e92,_1e9a,_1e93);
Merge.extendRange(range);
_1e9a=Row.findNextNonHiddenRow(range.endRow);
focusCellRange(_1e9b,_1e93,_1e9a,_1e92,"KEYSELECTION");
}else{
var _1ebd=new Range(_1eb7,_1e92,_1eb7,_1e93);
Merge.extendRange(_1ebd);
var _1ebe=_1ebd.startRow;
var endR=_1ebd.endRow;
if(_1ebe==_1e9a){
_1e9b=Row.findNextNonHiddenRow(_1e9b);
focusCellRange(_1e9a,_1e92,_1e9b,_1e93,"KEYSELECTION");
}else{
if(endR==_1e9b){
var range=new Range(_1e9a,_1e92,_1e9a,_1e93);
Merge.extendRange(range);
_1e9a=Row.findNextNonHiddenRow(range.endRow);
focusCellRange(_1e9b,_1e93,_1e9a,_1e92,"KEYSELECTION");
}else{
_1e9a=Row.findNextNonHiddenRow(_1e9a);
focusCellRange(_1e9b,_1e93,_1e9a,_1e92,"KEYSELECTION");
}
}
}
}
}
}
if(selRow>=(totRows-1)){
appendBlankRows();
}
}else{
if(_1e8e||_1e90){
if(isCellRange()){
if(_1e8d){
var _1e94=getCellRange();
if(currRow!=_1e94.endRow){
var _1ec0=_1e94.endRow;
}else{
var _1ec0=_1e94.startRow;
}
}else{
var _1ec0=currRow;
var info=ActiveCellInfo;
_1ec0=info.getEndRow();
}
var _1eb6=getCell(_1ec0,currCol,undefined,true);
}else{
var _1ec0=currRow;
var info=ActiveCellInfo;
var _1eb7=info.getActiveRow();
var _1ead=info.getActiveCol();
var _1eb6=getCell(_1eb7,_1ead,undefined,true);
_1ec0=info.getEndRow();
}
var evt="DOWN";
if(_1ec0<(totRows-1)){
if(isRowAvailable(_1ec0)){
if(isCellContainingContent(_1eb6)){
var _1ec4=Row.findNextNonHiddenRow(_1ec0);
var _1ec2=getCell(_1ec4,currCol,undefined,true);
if(isRowAvailable(_1ec4)){
if(isCellContainingContent(_1ec2)){
var info=getNextCellDetailsNotContainingContent(_1ec0,currCol,evt,_1e8d);
var i=info.found?info.row-1:info.row;
if(isNaN(i)){
return;
}
}else{
var i=getNextCellDetailsContainingContent(_1ec0,currCol,evt,_1e8d).row;
if(isNaN(i)){
return;
}
}
}else{
getUsedCursorCell(_1ec0,currCol,evt,_1e8d);
return;
}
}else{
var i=getNextCellDetailsContainingContent(_1ec0,currCol,evt,_1e8d).row;
if(isNaN(i)){
return;
}
}
}else{
getUsedCursorCell(_1ec0,currCol,evt,_1e8d);
return;
}
i=(i>=totRows)?totRows-1:i;
if(_1e8d){
if(isCellRange()){
var _1e94=getCellRange();
if(currRow!=_1e94.endRow){
focusCellRange(_1e94.startRow,_1e94.startCol,i,_1e94.endCol,"KEYSELECTION");
}else{
resetCellRange();
focusCellRange(_1e94.endRow,_1e94.startCol,i,_1e94.endCol,"KEYSELECTION");
}
}else{
focusCellRange(currRow,currCol,i,currCol,"KEYSELECTION");
}
}else{
if(formulaCell){
currRow=i;
focusCellRangeFill(i,currCol,i,currCol);
}else{
focusCell(i,currCol,undefined,undefined,undefined,_1e8a);
}
}
}
}else{
if(_1e8f&&_1e8c==40){
if(READ_WRITE){
if(Filter.hasFilter&&Filter.getInstance().range.sR===currRow){
Filter.showFilterOptions();
}else{
pickFromList();
}
}
break;
}else{
if(formulaCell){
var info=ActiveFormulaInfo;
var col=info.getActiveCol();
var row=info.getEndRow()+1;
if(row<totRows){
ActiveFormulaInfo.set(row,col);
focusCellRangeFill(row,col,row,col);
}
}else{
var info=ActiveCellInfo;
focusCell(Row.findNextNonHiddenRow(info.getEndRow(),true),info.getActiveCol(),undefined,undefined,undefined,_1e8a);
}
if(currRowTemp+1==totRows){
appendBlankRows();
if(formulaCell){
currRow=currRowTemp+1;
focusCellRangeFill(Row.findNextNonHiddenRow(currRowTemp),currCol,currRowTemp+1,currCol);
}else{
var info=ActiveCellInfo;
focusCell(Row.findNextNonHiddenRow(info.getEndRow()),info.getActiveCol(),undefined,undefined,undefined,_1e8a);
}
}
}
}
}
return false;
case 46:
if(!jsREMOTE_SAVE_VIEW&&!jsGADGET_VIEW&&!jsTHROWAWAY_VIEW){
if(ole.isActive()){
if(ole.currObj!=null&&!isUndefined(ole.currObj)){
ole.remove(ole.currObj.id,true);
break;
}
}
}
if(READ_WRITE&&!(ev.shiftKey&&ev.ctrlKey)){
deleteCell();
}
break;
case 59:
case 186:
if(ev.shiftKey&&ev.ctrlKey){
insertDateOrTime("time");
}else{
if(ev.ctrlKey){
insertDateOrTime("date");
}
}
break;
case 61:
case 107:
case 187:
if(!ev.ctrlKey&&ev.altKey){
initAutoSum(ev);
return false;
}
break;
case 191:
if(ev.ctrlKey){
var obj=getArray(currRow,currCol);
if(obj!=null){
focusCellRange(obj[0],obj[2],obj[1],obj[3]);
}
return;
}
}
}
}
function cellKeyPress(ev){
if(isSSActive){
if(browser_ie){
var ev=window.event;
var el=ev.srcElement;
var _1ec8=ev.keyCode;
}else{
if(browser_nn6){
var el=ev.target;
var _1ec8=ev.which;
}
}
var tag=el.tagName.toUpperCase();
if((el!=cellField)&&(tag=="INPUT"||tag=="TEXTAREA"||tag=="SELECT"||tag=="IMG"||tag=="A")){
return;
}
if(browser_nn6&&window.navigator.userAgent.toLowerCase().indexOf("firefox")<0&&(currKeyCode==34||currKeyCode==40||currKeyCode==9)){
return false;
}
if(ev.ctrlKey||ev.metaKey){
switch(_1ec8){
case 66:
case 98:
case 73:
case 105:
case 83:
case 115:
case 85:
case 117:
return false;
}
}
if(ev.shiftKey&&_1ec8==32){
return;
}
if((_1ec8<150)&&(_1ec8==0||_1ec8==27||ev.ctrlKey||ev.altKey||ev.metaKey)){
return;
}
if(browser_opera){
if(_1ec8==13||_1ec8==9){
exprField.blur();
return false;
}
if(_1ec8==16||_1ec8==8||_1ec8==36||_1ec8==35){
return;
}
}
if(browser_nn6){
if((ev.keyCode!=9&&ev.keyCode!=13&&ev.keyCode!=33&&ev.keyCode!=34&&!(ev.keyCode>=37&&ev.keyCode<=40)||(browser_safari&&ev.keyCode!=13))&&READ_WRITE){
var _1eca=isCapsLockOn(_1ec8,ev.shiftKey);
if(ev.keyCode==229){
focusCellField();
}else{
if(_1ec8>=65&&_1ec8<=90||_1ec8>=95&&_1ec8<=123){
if(_1ec8>=65&&_1ec8<=90&&_1eca){
if(ev.shiftKey){
focusCellField(String.fromCharCode(_1ec8).toLowerCase());
}else{
focusCellField(String.fromCharCode(_1ec8));
}
}else{
if(_1ec8>=95&&_1ec8<=123&&_1eca){
if(ev.shiftKey){
focusCellField(String.fromCharCode(_1ec8));
}else{
focusCellField(String.fromCharCode(_1ec8).toUpperCase());
}
}else{
focusCellField(String.fromCharCode(_1ec8));
}
}
}else{
focusCellField(String.fromCharCode(_1ec8));
}
}
}
}else{
if(browser_ie){
if(_1ec8>=65&&_1ec8<=90&&_1eca){
if(ev.shiftKey){
focusCellField(String.fromCharCode(_1ec8).toLowerCase());
}else{
focusCellField(String.fromCharCode(_1ec8));
}
}else{
if(_1ec8>=95&&_1ec8<=123&&_1eca){
if(ev.shiftKey){
focusCellField(String.fromCharCode(_1ec8));
}else{
focusCellField(String.fromCharCode(_1ec8).toUpperCase());
}
}else{
focusCellField(String.fromCharCode(_1ec8));
}
}
}
}
return false;
}
}
function focusCell(row,col,_1ecd,_1ece,_1ecf,evt,_1ed1){
if(row>=getRowMax()||col>=totCols){
return;
}
var _1ed2=0;
if(evt){
_1ed2=(browser_ie)?window.event.keyCode:evt.which;
}
var fP=fPainter;
if((fP.fPainterdoubleclick||fP.fPaintersingleclick)&&(copyFormatRange.sheetName==CURRSHEETNAME)){
focusCellRangeFill(copyFormatRange.startRow,copyFormatRange.startCol,copyFormatRange.endRow,copyFormatRange.endCol,true);
}
if(!isCellFieldSPANHided()&&isPartOfArray(currRow,currCol,currRow,currCol)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
colSelection=false;
rowSelection=false;
if(~~(row)>=0&&~~(col)>=0){
Row.isAppendable(row)&&appendBlankRows("ROWS_EXCEEDED",row+1);
updateSSVScrollFaceState();
window.clearInterval(userpresenceintvl);
var el;
if(ISFREEZED){
var _1ed5=FREEZED_COL;
var _1ed6=FREEZED_ROW;
if(row<_1ed6&&col<_1ed5){
el=getCell(row,col,sheetPane1Id);
}else{
if(row<_1ed6&&col>=_1ed5){
el=getCell(row,col,sheetPane2Id);
}else{
if(row>=_1ed6&&col<_1ed5){
el=getCell(row,col,sheetPane3Id);
}else{
el=getCell(row,col);
}
}
}
}else{
el=getCell(row,col);
}
var _1ed7=isCellRange();
resetCellRange();
var _1ed8=ActiveCellInfo;
var _1ed9=_1ed8.isMerged();
var _1eda=_1ed8.getStartCol();
var _1edb=_1ed8.getEndCol();
var _1edc=_1ed8.getStartRow();
var _1edd=_1ed8.getEndRow();
ActiveCellInfo.reset(row,col);
var info=ActiveCellInfo;
var _1edf=info.getTop();
var _1ee0=info.getHeight();
var _1ee1=info.getLeft();
var _1ee2=info.getWidth();
var _1ee3=info.isMerged();
var _1ee4=false;
if((_1ed9&&!_1ee3)||(!_1ed9&&_1ee3)||(_1ed9&&_1ee3)){
_1ee4=true;
}
if(!_1ee4){
if((_1ed2!=38&&_1ed2!=40&&_1ed2!=13)||_1ed7){
blurColHead(_1eda,_1edb);
selectColHead(info.getStartCol(),info.getEndCol());
}
if((_1ed2!=37&&_1ed2!=39&&_1ed2!=9)||_1ed7){
blurRowHead(_1edc,_1edd);
selectRowHead(info.getStartRow(),info.getEndRow());
}
}else{
blurColHead(_1eda,_1edb);
blurRowHead(_1edc,_1edd);
selectColHead(info.getStartCol(),info.getEndCol());
selectRowHead(info.getStartRow(),info.getEndRow());
}
setCellFieldSPAN();
setFocusDIVPos(_1ee1,_1edf);
setFocusDIVDim(_1ee2,_1ee0);
currColTemp=currCol;
currRowTemp=currRow;
currRow=row;
currCol=col;
var _1ee5=currCol;
var _1ee6=currRow;
_1ee6=ActiveCellInfo.getStartRow();
_1ee5=ActiveCellInfo.getStartCol();
currCell=el;
currCellIndicator.title="";
currCellIndicator.value=getColHeadLabel(_1ee5+1)+getRowHeadLabel(_1ee6);
if(el&&el.parentNode&&isCell(el)){
var timer=0;
if(browser_ie){
timer=500;
}else{
timer=300;
}
window.clearTimeout(initFormatTimeoutId);
initFormatTimeoutId=setTimeout(function(){
if(!isCellRange()){
resetAutoFormulas();
}
displayCellName(currRow,currCol,currRow,currCol,CURRSHEETNAME);
updateActiveCellDependencies(el);
if(jsPUBLIC_VIEW&&PUBLIC_EDIT_MODE){
if(getCellContent(currCell,"fn")=="hide"&&!showFormulas){
READ_WRITE=false;
exprField.readonly=true;
}else{
if(showFormulas){
READ_WRITE=true;
exprField.readonly=false;
}
}
if(!READ_WRITE){
setStatusText(jsMsg["PublicView.ProtectedCell"]);
}
}
if(_1ecd){
_1ecd();
}
if(!_1ecf){
rowToFocusOnPageNavigation=undefined;
}
if(evt!=undefined&&evt.keyCode!=9){
applyFormatting();
}
},timer);
}
if(formulaCell){
if(isUndefined(editedFormulaCellInfo.cellFieldDetails.CF_VALUE)){
focusCellRangeFill(currRow,currCol,currRow,currCol);
}
}
cellRangeStartRow=currRow;
cellRangeStartCol=currCol;
cellRangeEndRow=currRow;
cellRangeEndCol=currCol;
if(!_1ece){
if(!(ActiveCellInfo.isMerged()&&ActiveCellInfo.getRange().isCol())){
scrollRowIntoView(_1ee6);
}
if(!(ActiveCellInfo.isMerged()&&ActiveCellInfo.getRange().isRow())){
scrollColIntoView(_1ee5);
}
}
if(!jsTHROWAWAY_VIEW){
userpresenceintvl=window.setInterval("Userpresence.send()",1000);
}
}
if((_1ed1!==false)&&Row.isHidden(currRow)){
var _1ee8=getHiddenCellFormula(row,col);
if(isUndefined(_1ee8)){
requestHiddenRowData(row);
}else{
updateExprFieldWithHiddenRowData(row,_1ee8);
}
}
}
var clearHiddenRowFormulas=true;
function requestHiddenRowData(row){
document.cellform.actionMode.value="readHiddenInfo";
document.cellform.row.value=row;
document.cellform.column.value=currCol;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.view.value=getObj("VIEW").value;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.currentSelection.value=getCurrentSelection();
clearHiddenRowFormulas=false;
importxmlForForm(document.cellform,updateCell,true);
}
function updateHiddenRowData(row,data){
Row.clientData.hiddenRowsInfo[row]=data;
updateExprFieldWithHiddenRowData(row);
}
function updateExprFieldWithHiddenRowData(row,_1eed){
if(currRow===row){
var _1eee=!isUndefined(_1eed)?_1eed:getHiddenCellFormula(row,currCol);
exprField.value=_1eee;
_1eed=_1eee;
}
}
function getHiddenCellFormula(row,col){
var _1ef1=Row.clientData.hiddenRowsInfo[row];
var _1ef2;
if(_1ef1){
_1ef2=_1ef1[col];
if(isUndefined(_1ef2)){
_1ef2="";
}
}
return _1ef2;
}
var initFormatTimeoutId;
function updateActiveCellDependencies(el){
currCellHolder=el;
currCellValue=(currCell)?currCell.getAttribute("cV"):null;
if(currCellValue==null||currCellValue=="null"){
currCellValue="";
}
currCellFormula=getCellFormula(currCell);
currCellFormula=(currCellFormula!="")?currCellFormula:currCellValue;
if(!jsVERSION_VIEW&&!jsGUEST_VIEW){
init_format(el);
}
if(!jsTHROWAWAY_VIEW&&!jsGADGET_VIEW&&!jsGUEST_VIEW){
setExtDataStartCell();
}
if(!isFuncDlgOpen&&!(isCellEdited()&&cellField!=null&&cellField.value.indexOf("=")==0)&&!isExprFunc){
exprField.value=getCellContent();
}
if(jsPUBLIC_VIEW&&!showFormulas&&PUBLIC_EDIT_MODE){
if(getCellContent(currCell,"fn")=="hide"){
READ_WRITE=false;
exprField.readonly=true;
return;
}
READ_WRITE=true;
exprField.readonly=false;
}
}
function sheetMouseDown(ev){
if(browser_ie){
var ev=window.event;
var el=ev.srcElement;
var _1ef6=(ev.button==2);
}else{
if(browser_nn6){
var el=ev.target;
var _1ef6=(ev.which==3);
}
}
if(isFilterOptionsDIVOpened){
var id=el.id;
if(!id||id.indexOf("filter")===-1){
Filter.hideFilterOptions();
}
return false;
}
var row=getRowPosInMouseEvent(ev);
var col=getColPosInMouseEvent(ev);
if(isFMenuOpened){
hideFormulaMenu();
}
var info=Merge.getCellInfo(row,col);
if(info){
row=info["startRow"];
col=info["startCol"];
}
if(el.id=="sheet"){
return;
}
if(isCellEdited()&&cellField.value.indexOf("=")!=0&&isPartOfArray(currRow,currCol,currRow,currCol)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return false;
}
var _1efb=(browser_ie&&(el.className==="filterIconContainer"));
if(!isUndefined(GoalSeek)&&GoalSeek.dialog){
if(getObj("variableCell")==null){
GoalSeek.dialog=false;
clearCellRangeFill();
}else{
isEditingInExprField=false;
if(GoalSeek.temp==1){
getObj("variableCell").value=getCellLabel(row,col);
GoalSeek.focusCell(ev);
getObj("variableCell").focus();
}else{
if(GoalSeek.temp==2){
getObj("targetCell").value=getCellLabel(row,col);
GoalSeek.focusCell(ev);
getObj("targetCell").focus();
}else{
getObj("desiredValue").focus();
}
}
return;
}
}
if(!isUndefined(Solver)&&Solver.dialog){
if($("#SolverResultDialog").is(":visible")){
Solver.dialog=false;
clearCellRangeFill();
}else{
isEditingInExprField=false;
if(Solver.focusVariable==1){
getObj("objectiveCell").value=CURRSHEETNAME+"."+getCellLabel(row,col);
Solver.focusCell(ev);
getObj("objectiveCell").focus();
}else{
if(Solver.focusVariable==2){
focusCellRangeInit(ev);
getObj("decisionVariable").focus();
}else{
if(Solver.focusVariable==3){
Solver.focusConstraint.value=CURRSHEETNAME+"."+getCellLabel(row,col);
Solver.focusCell(ev);
$(Solver.focusConstraint).focus();
}
}
}
return;
}
}
if((isFuncDlgOpen&&getObj("funcList")!=null)||isExprFunc||(isCellEdited()&&cellField.value.indexOf("=")==0&&!isCellField(el))){
if(!isUndefined(editedFormulaCellInfo.cellFieldDetails.CF_VALUE)&&!formulaSIdxTemp){
if(!isFuncDlgOpen){
exprField.value=cellField.value=cellField.value+CURRSHEETNAME+"!";
editedFormulaCellInfo.cellFieldDetails.appendSheetName=false;
}else{
var _1efc=(exprField.value);
if(editedFormulaCellInfo.cellFieldDetails.appendSheetName&&_1efc.substring(_1efc.length-1)!=")"){
editedFormulaCellInfo.cellFieldDetails.appendSheetName=true;
}
}
}
if(isCellEdited()&&cellField.value.indexOf("=")==0){
formulaCell=true;
cellRangeStartIdx=getSelectionStart(cellField);
cellRangeEndfIdx=getSelectionEnd(cellField);
tempPos=getCaretPos(cellField);
}else{
cellRangeStartIdx=getSelectionStart(exprField);
cellRangeEndfIdx=getSelectionEnd(exprField);
tempPos=getCaretPos(exprField);
}
if(!isUndefined(editedFormulaCellInfo.cellFieldDetails.CF_VALUE)&&isFuncDlgOpen&&editedFormulaCellInfo.cellFieldDetails.tempPosReduce){
tempPos=tempPos-editedFormulaCellInfo.cellFieldDetails.tempPos;
editedFormulaCellInfo.cellFieldDetails.tempPosReduce=false;
}
if(el.style.cursor!="move"){
focusCellRangeInit(ev);
}
return;
}
if(isRangeEdit||isPivotDialogOpen||isEditPivotDialogOpen){
focusCellRangeInit(ev);
return;
}
if(isChartDialogOpened&&getObj("chartDataDIV")!=null&&getObj("chartDataDIV").style.display!="none"){
var _1efd=getObj("dataRange");
cellRangeStartIdx=getSelectionStart(_1efd);
cellRangeEndfIdx=getSelectionEnd(_1efd);
tempPos=getCaretPos(_1efd);
focusCellRangeInit(ev);
return;
}
if(isConditionalDialogOpen){
var _1efe=getObj("appliestofield");
cellRangeStartIdx=getSelectionStart(_1efe);
cellRangeEndfIdx=getSelectionEnd(_1efe);
tempPos=getCaretPos(_1efe);
focusCellRangeInit(ev);
return;
}
if(HYPERLINK.isRangeFocused&&getObj("internalLink").style.display!="none"){
var Data=getObj("InternalUrl");
cellRangeStartIdx=getSelectionStart(Data);
cellRangeEndfIdx=getSelectionEnd(Data);
tempPos=getCaretPos(Data);
focusCellRangeInit(ev);
return;
}
if(isNameDialogOpened&&FOCUSSEDNAMEINPUTOBJECT!=""){
focusCellRangeInit(ev);
return;
}
if(ev.type=="dblclick"&&isFocusDIV(el)){
focusCell(currRow,currCol);
return;
}
if(isCellField(el)){
return;
}else{
if(!isCellFieldSPANHided()){
submitCell();
}
}
if(ev.shiftKey&&(isCell(el)||_1efb)){
var _1f00=currCol;
var _1f01=col;
clearSelection();
resetCellRange();
focusCellRange(currRow,_1f00,row,_1f01);
return false;
}
if(browser_opera&&ev.altKey){
setTimeout(function(){
return contextmenu(obj,ev);
},0);
if(isCellRange()&&isTransSPAN(el.id)){
return false;
}
}
if(ev.type=="mousedown"&&!_1ef6&&(_1efb||isTransSPAN(el)||isFocusDIV(el))){
if(ev.shiftKey){
resetCellRange();
focusCellRange(currRow,currCol,row,col);
return;
}else{
if(el.style.cursor!="move"){
focusCell(row,col,undefined,true);
}
}
}
if(ev.type=="mousedown"&&!_1ef6&&!isTransSPAN(el)&&isFocusDIV(el)){
var _1f02=getHyperLinkInCell(currCell).childTag;
if(_1f02&&isObject(_1f02)&&(_1f02.tagName)&&((_1f02.tagName).toUpperCase()=="A")){
var _1f03=getCursorPos(ev);
var x=_1f03.x;
var y=_1f03.y;
if(checkBoundaryForTextInDiv(x,y,currCell)){
var title=_1f02.title;
var ref=_1f02.href;
if(title.indexOf("#")==0){
gotoCellInit(title.substring(1,title.length));
}else{
if(ref.indexOf("mailto")==0){
window.location.href=ref;
}else{
window.open(ref);
}
}
}
}
}
if(ev.type=="mousedown"&&isCellRangeFlashInnerDIV(el)){
if(!ev.shiftKey){
focusCell(row,col,undefined,true);
}else{
focusCellRange(currRow,currCol,row,col);
}
}
if(tourdivopen){
$("#tourDiv").fadeOut(700);
}
if(ev.type=="mousedown"&&!_1ef6&&(_1efb||isCell(el)||isFocusDIV(el)||isSheetTable(el)||isTransSPAN(el)||isCellRangeFlashInnerDIV(el)||(typeof Userpresence!="undefined"&&Userpresence.isOwnDiv(el)))){
if(isCell(el)||isSheetTable(el)||Userpresence.isOwnDiv(el)||_1efb){
focusCell(row,col,undefined,true);
}
if(isFocusDIV(el)&&el.style.cursor=="move"){
if(READ_WRITE){
startDragCellOrCellRange(ev,el);
}
}else{
selRow=currRow;
selCol=currCol;
selectionLeft=getEndLeftOfCol(currCol);
selectionTop=getEndTopOfRow(currRow);
if(browser_ie){
document.attachEvent("onmousemove",selectCell);
document.attachEvent("onmouseup",endSelect);
}else{
document.addEventListener("mousemove",selectCell,false);
document.addEventListener("mouseup",endSelect,false);
}
}
return;
}
if(ev.type=="mousedown"&&_1ef6&&(_1efb||isCell(el)||el.tagName=="A"&&isCell(el.parentNode))){
focusCell(row,col,undefined,true);
}
if(ev.type=="mousedown"&&_1ef6){
exitFormatPainter();
}
}
function blurCell(row,col){
if(isNumber(row)&&isNumber(col)){
var _1f0a=endRow=row;
var _1f0b=endCol=col;
var info=Merge.getCellInfo(row,col);
if(info){
_1f0a=info.startRow;
_1f0b=info.startCol;
endRow=info.endRow;
endCol=info.endCol;
}
blurColHead(_1f0b,endCol);
blurRowHead(_1f0a,endRow);
}
}
function setCellContent(cell,val){
var _1f0f=val;
if(cell){
if(isObject(cell)&&!isUndefined(val)){
val=escapeSpecialCharacters(val).replace(/\n/g,"<br>");
val=encodeBlankSpaces(val);
var cls=cell.className;
if(cls.indexOf("vab")!=-1||cls.indexOf("vam")!=-1){
if(featureSupport.boxAlign){
cell.innerHTML=val;
}else{
cell.childNodes[0].childNodes[0].innerHTML=val;
}
}else{
cell.innerHTML=val;
}
}
if(!val){
cell.removeAttribute("cV");
}else{
cell.setAttribute("cV",_1f0f);
}
}
}
function clearCell(row,col){
if(!READ_WRITE){
return;
}
if(typeof row!="undefined"&&typeof col!="undefined"){
var cell=getCell(row,col);
}else{
var cell=currCell;
}
if(cell){
setCellContent(cell,"");
cell.removeAttribute("fn");
if(ISFREEZED){
var _1f14=getCellPos(cell);
var cRow=_1f14.row;
var cCol=_1f14.col;
if(FREEZED_ROW>0){
cell=getCell(cRow,cCol,sheetPane2Id);
if(cell!=null){
setCellContent(cell,"");
cell.removeAttribute("fn");
}
}
if(FREEZED_COL>0){
cell=getCell(cRow,cCol,sheetPane3Id);
if(cell!=null){
setCellContent(cell,"");
cell.removeAttribute("fn");
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
cell=getCell(cRow,cCol,sheetPane1Id);
if(cell!=null){
setCellContent(cell,"");
cell.removeAttribute("fn");
}
}
}
}
exprField.value="";
if(jsGADGET_VIEW){
return;
}
setStatusText("");
}
function setDefaultFormatForCell(cell){
if(cell!=null){
var _1f18=cell.className;
var _1f19=getCellInnerHTML(cell);
if(_1f18.indexOf(" cC")==-1){
cell.className="cD nW";
}else{
cell.className="cD nW cC";
}
var _1f1a=parseInt(cell.style.top);
var _1f1b=parseInt(cell.style.left);
var _1f1c=parseInt(cell.style.width);
var _1f1d=parseInt(cell.style.height);
cell.removeAttribute("style");
cell.style.top=_1f1a+"px";
cell.style.left=_1f1b+"px";
cell.style.width=_1f1c+"px";
cell.style.height=_1f1d+"px";
var _1f1e=cell.getAttribute("format");
if(_1f1e=="FLOAT"){
cell.className+=" tar";
}
cell.removeAttribute("fn");
cell.removeAttribute("format");
cell.removeAttribute("cV");
cell.innerHTML=_1f19;
}
}
function setDefaultValueForCell(cell){
setCellContent(cell,"");
cell.removeAttribute("fn");
cell.removeAttribute("cV");
}
var calloutLeft;
var calloutTop;
var commentCallout;
var commentPointerTl;
var commentPointerBl;
var commentPointerTr;
var commentPointerBr;
var commentPtrWidth;
var calloutContentWidth;
var calloutContentHeight;
var calloutContentMinHeight;
var isBL;
var isTR;
var wdBeforeCell=0;
var wdAfterCell=0;
var htAboveCell=0;
var htBelowCell=0;
var cellExceedsVp;
var isCalloutTopAreaPresent;
var isCalloutRightAreaPresent;
var isPtrLeft=false;
var isPtrRight=false;
var isPtrTop=false;
var isPtrBottom=false;
var isRowVisiblePartial;
var isCalloutPresentLeft;
var heightAboveCommentPtr;
var tLCommentPtrHeight;
var tRCommentPtrHeight;
var heightBelowCommentPtr;
var bLCommentPtrHeight;
function showCellComment(ev,el){
if(isCellSelection){
return;
}
if(typeof el=="undefined"){
if(browser_ie){
el=ev.srcElement;
}else{
el=ev.target;
}
}
if(el==focusDIV||(ISFREEZED&&(el==focusDIV1||el==focusDIV2||el==focusDIV3))){
if(isCellRange()){
var row=getRowPosInMouseEvent(ev);
var col=getColPosInMouseEvent(ev);
if(prevRow==row&&prevCol==col){
commentCallout=getObj("cellCommentCallout");
if((commentCallout!=null)||(commentCallout.style.visibility=="")){
return;
}
}
var cell=getCell(row,col);
hideCellComment();
}else{
var cell=currCell;
}
}else{
var cell=el;
}
var value=(cell)?cell.getAttribute("comment"):null;
if(value!=null){
var cLeft=findCellLeft(cell);
var cTop=findCellTop(cell);
var _1f28=getCellWidth(cell);
var _1f29=getCellHeight(cell);
commentCallout=getObj("cellCommentCallout");
commentCallout.style.visibility="hidden";
commentCallout.style.display="block";
var _1f2a=cell.getAttribute("comment");
cellCommentContent=getObj("cellCommentCalloutContent");
calloutContentMinHeight=parseInt(getCurrentStyle(cellCommentContent,"minHeight"));
cellCommentContent.innerHTML=_1f2a.replace(/\n/g,"<br>");
commentPointerTl=getObj("commentCalloutPointerTL");
commentPointerBl=getObj("commentCalloutPointerBL");
commentPointerTr=getObj("commentCalloutPointerTR");
commentPointerBr=getObj("commentCalloutPointerBR");
var _1f2b=commentPointerTl.getElementsByTagName("div");
var _1f2c=commentPointerTr.getElementsByTagName("div");
var _1f2d=commentPointerBl.getElementsByTagName("div");
commentPtrWidth=parseInt(getCurrentStyle(_1f2b[0],"width"));
var _1f2e=getSheetScrollLeft();
var _1f2f=getSheetScrollTop();
var _1f30=sheetLeft+cLeft;
var _1f31=sheetTop+cTop;
if(browser_ie){
ev=window.event;
}
var _1f32=getCursorPos(ev);
if(_1f32.y>=(sheetTop+findThirdPaneYPos())){
_1f31=_1f31-_1f2f;
}
if(_1f32.x>=(sheetLeft+findSecondPaneXPos())){
_1f30=_1f30-_1f2e;
}
calloutTop=_1f31;
calloutLeft=_1f30+_1f28+commentPtrWidth;
var td=commentCallout.getElementsByTagName("td");
var tlTd=td[0];
var mcTd=td[4];
var trTd=td[2];
var _1f37=tlTd.offsetWidth;
var _1f38=getCurrentStyle(mcTd,"paddingLeft");
var _1f39=getCurrentStyle(mcTd,"paddingRight");
var _1f3a=trTd.offsetWidth;
var _1f3b=parseInt(_1f37)+parseInt(_1f38)+parseInt(_1f39)+parseInt(_1f3a);
td=commentCallout.getElementsByTagName("td");
var tcTd=td[1];
var mcTd=td[4];
var bcTd=td[7];
var blTd=td[6];
var _1f3f=tcTd.offsetHeight;
var _1f40=getCurrentStyle(mcTd,"paddingTop");
var _1f41=getCurrentStyle(mcTd,"paddingBottom");
var _1f42=bcTd.offsetHeight;
var _1f43=parseInt(_1f3f)+parseInt(_1f40)+parseInt(_1f41)+parseInt(_1f42);
var _1f44=blTd.offsetHeight;
heightAboveCommentPtr=tlTd.offsetHeight+parseInt(_1f40);
tLCommentPtrHeight=parseInt(getCurrentStyle(_1f2b[0],"height"));
tRCommentPtrHeight=parseInt(getCurrentStyle(_1f2c[0],"height"));
heightBelowCommentPtr=blTd.offsetHeight+parseInt(_1f41);
bLCommentPtrHeight=parseInt(getCurrentStyle(_1f2d[0],"height"));
calloutContentWidth=cellCommentContent.offsetWidth;
calloutContentHeight=cellCommentContent.offsetHeight;
if(browser_ie){
if(calloutContentHeight<calloutContentMinHeight){
calloutContentHeight=calloutContentMinHeight;
}
}
cellCommentContent.style.width=addSTDMode(calloutContentWidth);
cellCommentContent.style.height=addSTDMode(calloutContentHeight);
while(calloutContentHeight>calloutContentMinHeight){
var _1f45=(calloutContentWidth*calloutContentHeight)/12;
_1f45=Math.ceil(Math.sqrt(_1f45));
calloutContentWidth=4*_1f45;
calloutContentHeight=3*_1f45;
cellCommentContent.style.width=addSTDMode(calloutContentWidth);
if(browser_ie){
cellCommentContent.style.height="0px";
}else{
if(browser_nn6){
cellCommentContent.style.height="";
}
}
cellCommentContent.style.minHeight=calloutContentHeight;
calloutContentMinHeight=calloutContentHeight;
calloutContentHeight=cellCommentContent.offsetHeight;
}
var _1f46=commentCallout.offsetWidth;
var _1f47=commentCallout.offsetHeight;
var _1f48=findClientDim().width;
var _1f49=findClientDim().height;
if((calloutLeft+_1f46)>_1f48){
commentPtrWidth=parseInt(getCurrentStyle(_1f2c[0],"width"));
calloutLeft=(_1f30-(_1f46+commentPtrWidth));
isTR=true;
if(calloutLeft<0){
cellExceedsVp=true;
isTR=false;
}
}
var _1f4a=0;
var _1f4b=getObj("commentCalloutPointerBL");
var _1f4c=_1f4b.getElementsByTagName("div");
var _1f4d=getCurrentStyle(_1f4c[0],"height");
var _1f4e=getCurrentStyle(_1f4c[0],"top");
var _1f4f=parseInt(_1f4d)+parseInt(_1f4e);
_1f4a=parseInt(_1f4d)-_1f4f;
if((calloutTop+_1f47)>_1f49){
calloutTop=((_1f31+_1f4a)-(_1f47));
isBL=true;
if(calloutTop<0){
cellExceedsVp=true;
isBL=false;
}
}
if(cellExceedsVp){
wdBeforeCell=_1f30;
wdAfterCell=(_1f48-(_1f30+_1f28));
htAboveCell=_1f31;
htBelowCell=(_1f49-(_1f31+_1f29));
cellCommentContent.style.overflow="hidden";
if(wdBeforeCell>wdAfterCell){
calloutLeft=0;
calloutContentWidth=_1f30;
commentPtrWidth=getCurrentStyle(_1f2c[0],"width");
calloutContentWidth=(calloutContentWidth-(_1f3b+parseInt(commentPtrWidth)));
if(calloutContentWidth<0){
calloutContentWidth=0;
}
cellCommentContent.style.width=addSTDMode(calloutContentWidth);
isPtrLeft=true;
}else{
commentPtrWidth=parseInt(getCurrentStyle(_1f2b[0],"width"));
if(calloutLeft<0){
calloutLeft=(_1f30+_1f28+commentPtrWidth);
}
calloutContentWidth=(_1f48-(_1f30+_1f28));
calloutContentWidth=calloutContentWidth-(_1f3b+commentPtrWidth);
if(calloutContentWidth<0){
calloutContentWidth=0;
}
cellCommentContent.style.width=addSTDMode(calloutContentWidth);
isPtrRight=true;
}
if(htAboveCell>htBelowCell){
calloutTop=0;
calloutContentHeight=_1f31+_1f4a;
calloutContentHeight=calloutContentHeight-_1f43;
if(calloutContentMinHeight>calloutContentHeight){
calloutContentMinHeight=calloutContentHeight;
cellCommentContent.style.minHeight=calloutContentMinHeight;
}
if(calloutContentHeight<0){
calloutContentHeight=0;
}
cellCommentContent.style.height=addSTDMode(calloutContentHeight);
isPtrTop=true;
}else{
if(calloutTop<0){
calloutTop=_1f31;
}
calloutContentHeight=_1f49-(_1f31+_1f29);
calloutContentHeight=calloutContentHeight-_1f43;
if(calloutContentMinHeight>calloutContentHeight){
calloutContentMinHeight=calloutContentHeight;
cellCommentContent.style.minHeight=calloutContentMinHeight;
}
if(calloutContentHeight<0){
calloutContentHeight=0;
}
cellCommentContent.style.height=addSTDMode(calloutContentHeight);
isPtrBottom=true;
}
}else{
if(!browser_ie){
if(commentCallout.offsetWidth<=300){
fadeIn("cellCommentCallout",50,commentFadeInCallback);
}
}
}
_1f46=commentCallout.offsetWidth;
_1f47=commentCallout.offsetHeight;
if(isPtrLeft&&isPtrTop){
isBL=true;
isTR=true;
}else{
if(isPtrLeft&&isPtrBottom){
isTR=true;
isBL=false;
}else{
if(isPtrRight&&isPtrTop){
isBL=true;
isTR=false;
}else{
if(isPtrRight&&isPtrBottom){
isBL=false;
isTR=false;
}
}
}
}
if(_1f32.y>=(sheetTop+findThirdPaneYPos())){
if(_1f31<=(sheetTop+findThirdPaneYPos())){
calloutTop=(sheetTop+findThirdPaneYPos())-heightAboveCommentPtr;
}
if((isBL==true&&isTR==true)||(isBL==true)){
var _1f50=((calloutTop+_1f47+_1f2f)-sheetTop);
if(_1f50>(_1f2f+sheetHeight)){
calloutTop=(sheetTop+_1f2f+sheetHeight)-(_1f47+_1f2f);
calloutTop=(calloutTop+heightBelowCommentPtr);
}
}
}
if((_1f30+_1f28)<(_1f48+_1f28)){
if(isBL==true&&isTR==true){
commentPointerBr.style.visibility="visible";
}else{
if(isBL==true){
commentPointerBl.style.visibility="visible";
}else{
if(isTR==true){
commentPointerTr.style.visibility="visible";
}else{
commentPointerTl.style.visibility="visible";
}
}
}
commentCallout.style.left=calloutLeft+"px";
commentCallout.style.top=calloutTop+"px";
commentCallout.style.visibility="";
}
commentShown=true;
prevRow=row;
prevCol=col;
}
}
function hideCellComment(){
if(commentShown){
commentCallout=getObj("cellCommentCallout");
if((commentCallout!=null)||(commentCallout.style.display!="none")){
commentCallout.style.display="none";
commentPointerBr.style.visibility="hidden";
commentPointerBl.style.visibility="hidden";
commentPointerTr.style.visibility="hidden";
commentPointerTl.style.visibility="hidden";
commentPtrWidth="";
if(browser_ie){
cellCommentContent.style.width=addSTDMode(defaultCalloutContentWidth);
cellCommentContent.style.minHeight=addSTDMode(defaultCalloutContentMinheight);
cellCommentContent.style.height="0px";
}else{
if(browser_nn6){
cellCommentContent.style.width=addSTDMode(defaultCalloutContentWidth);
cellCommentContent.style.minHeight=addSTDMode(defaultCalloutContentMinheight);
cellCommentContent.style.height="";
}
}
cellCommentContent.style.overflow="";
wdBeforeCell=0;
wdAfterCell=0;
htAboveCell=0;
htBelowCell=0;
cellExceedsVp=false;
isCalloutTopAreaPresent=false;
isCalloutRightAreaPresent=false;
isBL=false;
isTR=false;
isPtrLeft=false;
isPtrRight=false;
isPtrTop=false;
isPtrBottom=false;
isRowVisiblePartial=false;
isCalloutPresentLeft=false;
}
commentShown=false;
prevRow=-1;
prevCol=-1;
}
}
function commentFadeInCallback(){
var _1f51=getObj("cellCommentCallout");
_1f51.style.filter="";
_1f51.style.opacity="";
}
function merge(_1f52){
mergeCells(undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,_1f52);
}
function mergeCells(_1f53,_1f54,_1f55,_1f56,_1f57,_1f58,_1f59,_1f5a,_1f5b,_1f5c,_1f5d){
if(typeof _1f5a=="undefined"){
_1f5a="false";
}
if(isUndefined(_1f53)&&isUndefined(_1f54)&&isUndefined(_1f55)&&isUndefined(_1f56)){
if(!isCellRange()){
return;
}
var range=getCellRange();
_1f53=range.startRow;
_1f54=range.startCol;
_1f55=range.endRow;
_1f56=range.endCol;
if(isWholeSheetSelected()){
_1f53=0;
_1f54=0;
_1f55=getRowMax()-1;
_1f56=getColMax()-1;
}else{
if(isColSelected()){
_1f53=0;
_1f55=getRowMax()-1;
}else{
if(isRowSelected()){
_1f54=0;
_1f56=getColMax()-1;
}
}
}
}else{
_1f53=parseInt(_1f53);
_1f55=parseInt(_1f55);
_1f54=parseInt(_1f54);
_1f56=parseInt(_1f56);
}
if(containsAnyArray(_1f53,_1f54,_1f55,_1f56)||isPartOfArray(_1f53,_1f54,_1f55,_1f56)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
if(!_1f59){
var _1f59=false;
}
if(!_1f57){
_1f57=false;
}
if(!_1f58){
_1f58=false;
}
var _1f5f=false;
var _1f60=false;
var _1f61=new Range(getAvailableStartRow(),getAvailableStartCol(),getAvailableEndRow(),getAvailableEndCol());
if(_1f54<_1f56){
var _1f62=getTotalColumn();
var _1f63=(_1f54>_1f62)?_1f62-1:_1f54;
var endC=(_1f56>_1f62)?_1f62:_1f56;
var _1f65=new Range(_1f53,_1f63+1,_1f55,endC);
if(_1f61.subset(_1f65)){
var iter=_1f65.getIterator();
iter.initData(false);
iter.setDataProcessor(function(value){
return value;
});
iter.iterate(function(row,col){
var cell=getCell(row,col);
if(cell){
var _1f6b=getCellContent(cell);
if(_1f6b!=""){
this.processData(true);
iter.interrupt();
}
}
});
_1f5f=iter.getData();
}else{
_1f60=true;
_1f5f=true;
}
}
if(_1f53<_1f55&&!_1f5f){
var _1f62=getTotalColumn();
var _1f63=(_1f54>_1f62)?_1f62:_1f54;
var _1f6c=new Range(_1f53+1,_1f63,_1f55,_1f63);
if(_1f61.subset(_1f6c)){
var iter=_1f6c.getIterator();
iter.initData(false);
iter.setDataProcessor(function(value){
return value;
});
iter.iterate(function(row,col){
var cell=getCell(row,col);
if(cell){
var _1f71=getCellContent(cell);
if(_1f71!=""){
this.processData(true);
iter.interrupt();
}
}
});
_1f5f=iter.getData();
}else{
_1f60=true;
_1f5f=true;
}
}
var merge=true;
if(_1f5f&&!_1f59){
merge=showConfirmDialog(jsTitleMsg.MergingIntoOneCellKeepUpperLeftData+"\n "+jsTitleMsg.AreYouSureToMerge);
}
if(merge){
var _1f73=getAvailableStartRow();
var _1f74=getAvailableEndRow();
var _1f75=(_1f53<_1f73)?_1f73:_1f53;
var _1f76=(_1f55>_1f74)?_1f74:_1f55;
var _1f77=_1f53;
var _1f78=_1f54;
if(!_1f5d){
_1f5d="MergeCells";
}
if(_1f5d=="MergeCells"||_1f5d=="MergeAndCenter"){
Merge.remove(_1f53,_1f54,_1f55,_1f56);
Merge.add(_1f53,_1f54,_1f55,_1f56);
if(_1f5d=="MergeAndCenter"){
updateRangeFormat(_1f53,_1f54,_1f53,_1f54,"textAlign","center");
}
}else{
if(_1f5d=="MergeAcross"){
if(isColSelected()){
_1f55=usedCursRow;
_1f76=(_1f55>_1f74)?_1f74:_1f55;
}
for(var i=_1f75;i<=_1f76;i++){
Merge.remove(i,_1f54,i,_1f56);
Merge.add(i,_1f54,i,_1f56);
}
_1f77=_1f55;
}else{
if(_1f5d=="MergeDown"){
for(var i=_1f54;i<=_1f56;i++){
Merge.remove(_1f75,i,_1f76,i);
Merge.add(_1f75,i,_1f76,i);
}
_1f78=_1f56;
}
}
}
if(!_1f57){
document.cellform.startColumn.value=_1f54;
document.cellform.endColumn.value=_1f56;
document.cellform.startRow.value=_1f53;
document.cellform.endRow.value=_1f55;
document.cellform.cellValue.value="MERGE";
document.cellform.actionMode.value="MergeCells";
document.cellform.totCols.value=totCols;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_1f5a;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=SAVED;
document.cellform.availableStartRow.value=_1f73;
document.cellform.availableEndRow.value=_1f74;
document.cellform.bridgeNo.value=bridgeNumber;
if(_1f5a=="false"||!_1f5a){
if(_1f5d=="MergeAcross"){
document.cellform.isColSelected.value=false;
}else{
document.cellform.isColSelected.value=isColSelected();
}
document.cellform.isRowSelected.value=isRowSelected();
}
document.cellform.subActionMode.value=_1f5d;
if(_1f5a=="true"){
document.cellform.U_FN.value=_1f5b;
document.cellform.U_AO.value=_1f5c;
}
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _1f7a=getObj("apiKey");
if(_1f7a!=null){
document.cellform.apiKeyId.value=_1f7a.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
}
if(_1f77>usedCursRow){
usedCursRow=_1f77;
}
if(_1f78>usedCursCol){
usedCursCol=_1f78;
}
if(!_1f58){
if(_1f53==_1f55&&merge){
focusCell(_1f53,_1f54);
}else{
focusCellRange(_1f53,_1f54,_1f55,_1f56,undefined,true);
}
}
}
}
function doMergeCells(_1f7b,_1f7c,_1f7d,_1f7e){
var _1f7f=getAvailableStartRow();
var _1f80=getAvailableEndRow();
var _1f81=sheetPaneId;
var cLeft=getColLeft(_1f7c);
var cTop=getRowTop(_1f7b);
var _1f84=(_1f7b<_1f7f)?_1f7f:_1f7b;
var _1f85=(_1f7d>_1f80)?_1f80:_1f7d;
var mC=getObj("mCC");
var info=mergeDOMInfo;
var key=Range.getPrimal(_1f7b,_1f7c);
info[key]={};
if(ISFREEZED){
if(_1f7b<FREEZED_ROW&&_1f7f>FREEZED_ROW){
_1f81=sheetPane2Id;
var _1f89=(_1f7d<FREEZED_ROW)?_1f7d:FREEZED_ROW-1;
}
var mCC1=getObj(mCC1Id);
var mCC2=getObj(mCC2Id);
var mCC3=getObj(mCC3Id);
}
var _1f8d=getCell(_1f7b,_1f7c,_1f81,true);
var _1f8e=getRowTop(_1f7d)+getRowHeight(_1f7d)-getRowTop(_1f7b);
var width=getColLeft(_1f7e)+getColWidth(_1f7e)-getColLeft(_1f7c);
if(_1f8d){
var _1f90=_1f8d.cloneNode(true);
}else{
var _1f90=getDefaultCellHTML().cloneNode(true);
}
var _1f91=getCellContent(_1f90);
_1f90.style.left=cLeft+"px";
_1f90.style.top=cTop+"px";
_1f90.style.width=width+"px";
_1f90.style.height=_1f8e+"px";
_1f90.style.position="absolute";
_1f90.style.zIndex=1;
addCellComment(_1f90);
var _1f92=getCell(_1f7d,_1f7e,_1f81,true);
if(_1f92){
var regex=new RegExp(getCSSStyleRegex("borderRight")).exec(_1f92.className);
if(regex!=null){
removeCSSStyle("borderRight",_1f90);
_1f90.className+=regex[0];
}
if(_1f92.style.borderRight!=""){
_1f90.style.borderRight=_1f92.style.borderRight;
}
var regex=new RegExp(getCSSStyleRegex("borderBottom")).exec(_1f92.className);
if(regex!=null){
removeCSSStyle("borderBottom",_1f90);
_1f90.className+=regex[0];
}
if(_1f92.style.borderBottom!=""){
_1f90.style.borderBottom=_1f92.style.borderBottom;
}
}
setCellWidthForVAlignedCell(_1f90);
setCellHeightForVAlignedCell(_1f90);
if(ISFREEZED){
var _1f94=_1f90.cloneNode(true);
addCellComment(_1f94);
if(isColsAndRowsFreezed){
var _1f95=_1f90.cloneNode(true);
addCellComment(_1f95);
var _1f96=_1f90.cloneNode(true);
addCellComment(_1f96);
}
}
info[key]["mC"]=_1f90;
mC.appendChild(_1f90);
if(ISFREEZED){
if(FREEZED_ROW>0&&FREEZED_COL>0){
if(_1f7b<ROWS_PER_TILE){
info[key]["mC1"]=_1f94;
info[key]["mC2"]=_1f95;
mCC1.appendChild(_1f94);
mCC2.appendChild(_1f95);
}
info[key]["mC3"]=_1f96;
mCC3.appendChild(_1f96);
}else{
if(FREEZED_ROW>0&&_1f7b<ROWS_PER_TILE){
info[key]["mC2"]=_1f94;
mCC2.appendChild(_1f94);
}else{
if(FREEZED_COL>0&&_1f7b<ROWS_PER_TILE){
info[key]["mC3"]=_1f94;
mCC3.appendChild(_1f94);
}
}
}
}
}
function addCellComment(cell){
if(cell&&cell.getAttribute("comment")&&!cell.getAttribute("onmouseout")){
if(browser_ie){
document.attachEvent("onmouseover",showCellComment);
document.attachEvent("onmouseout",hideCellComment);
}else{
document.addEventListener("mouseover",showCellComment,false);
document.addEventListener("mouseout",hideCellComment,false);
}
}
}
function clearCoveredCells(_1f98,_1f99,_1f9a,_1f9b){
var _1f9c=getAvailableStartRow();
var _1f9d=getAvailableEndRow();
_1f98=(_1f98<_1f9c)?_1f9c:_1f98;
_1f9a=(_1f9a>_1f9d)?_1f9d:_1f9a;
if(_1f99<_1f9b){
clearContents(_1f98,_1f99+1,_1f9a,_1f9b);
removeRangeComments(_1f98,_1f99+1,_1f9a,_1f9b);
}
if(_1f98<_1f9a){
clearContents(_1f98+1,_1f99,_1f9a,_1f99);
removeRangeComments(_1f98+1,_1f99,_1f9a,_1f99);
}
}
function splitCells(_1f9e,_1f9f,_1fa0,_1fa1,_1fa2,_1fa3,_1fa4){
if(typeof _1fa4=="undefined"){
_1fa4="false";
closeDialog();
}
if(typeof _1fa3=="undefined"){
var _1fa3=false;
}
if(typeof _1f9e=="undefined"&&typeof _1f9f=="undefined"&&typeof _1fa0=="undefined"&&typeof _1fa1=="undefined"){
if(isCellRange()){
var range=getCellRange();
var _1f9e=range.startRow;
var _1f9f=range.startCol;
var _1fa0=range.endRow;
var _1fa1=range.endCol;
}else{
var info=ActiveCellInfo;
var _1f9e=info.getStartRow();
var _1f9f=info.getStartCol();
var _1fa0=info.getEndRow();
var _1fa1=info.getEndCol();
}
}else{
if(typeof _1f9e!="undefined"&&typeof _1f9f!="undefined"&&typeof _1fa0=="undefined"&&typeof _1fa1=="undefined"){
var _1fa0=_1f9e;
var _1fa1=_1f9f;
}
}
var _1fa7=getAvailableStartRow();
var _1fa8=getAvailableEndRow();
var _1fa9=(_1f9e<_1fa7)?_1fa7:_1f9e;
var _1faa=(_1fa0>_1fa8)?_1fa8:_1fa0;
var _1fab=_1fa1;
Merge.remove(_1f9e,_1f9f,_1fa0,_1fa1);
if(!_1fa3){
document.cellform.startColumn.value=_1f9f;
document.cellform.endColumn.value=_1fa1;
document.cellform.startRow.value=_1f9e;
document.cellform.endRow.value=_1fa0;
document.cellform.tmpData.value=_1fab;
document.cellform.cellValue.value="UNMERGE";
document.cellform.actionMode.value="MergeCells";
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_1fa4;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=SAVED;
document.cellform.availableStartRow.value=_1fa7;
document.cellform.availableEndRow.value=_1fa8;
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _1fac=getObj("apiKey");
if(_1fac!=null){
document.cellform.apiKeyId.value=_1fac.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
}
if(typeof _1fa2=="undefined"||!_1fa2){
focusCellRange(_1f9e,_1f9f,_1fa0,_1fa1,undefined,true);
}
}
function drawChart(msg,_1fae,_1faf){
HTMLCHARTINFO=new Array();
var _1fb0=msg["CP_CHART_DBID"];
var left=msg["CP_LEFT"];
var top=msg["CP_TOP"];
var width=msg["CP_WIDTH"];
var _1fb4=msg["CP_HEIGHT"];
var _1fb5="false";
if(_1fae=="PUBLISH"){
_1fb5="true";
}
var _1fb6=msg["CP_DATARANGE"];
var _1fb7=msg["CP_DATAIN"];
var _1fb8=msg["CP_CHART_TITLE"];
var _1fb9=msg["CP_GRAPHTYPE"];
var _1fba=msg["CP_PLOT_ORIENTATION"];
var _1fbb=msg["CP_SHOW_LEGEND"];
var _1fbc=msg["CP_CHART_X_LABEL"];
var _1fbd=msg["CP_CHART_Y_LABEL"];
var _1fbe=msg["CP_LABEL_FORMAT"];
var _1fbf=_1fb9;
if(_1fb9.indexOf("BAR")>-1){
var _1fbf=_1fb9+"_"+_1fba;
}
HTMLCHARTINFO["CP_CHART_DBID"]=_1fb0;
HTMLCHARTINFO["CP_PLOT_ORIENTATION"]=_1fba;
HTMLCHARTINFO["CP_CHARTTYPEID"]=_1fbf;
HTMLCHARTINFO["CP_GRAPHTYPE"]=_1fb9;
HTMLCHARTINFO["CP_SHOW_LEGEND"]=_1fbb;
HTMLCHARTINFO["CP_DOCUMENTID"]=msg["CP_DOCUMENTID"];
HTMLCHARTINFO["CP_DOCUMENTSHEET_NAME"]=msg["CP_DOCUMENTSHEET_NAME"];
HTMLCHARTINFO["CP_DOCUMENTSHEETID"]=msg["CP_DOCUMENTSHEETID"];
HTMLCHARTINFO["CP_DATARANGE"]=_1fb6;
HTMLCHARTINFO["CP_DATAIN"]=_1fb7;
HTMLCHARTINFO["CP_CHART_TITLE"]=_1fb8;
HTMLCHARTINFO["CP_LEFT"]=left;
HTMLCHARTINFO["CP_TOP"]=top;
HTMLCHARTINFO["CP_HEIGHT"]=_1fb4;
HTMLCHARTINFO["CP_WIDTH"]=width;
HTMLCHARTINFO["CP_CHART_X_LABEL"]=_1fbc;
HTMLCHARTINFO["CP_CHART_Y_LABEL"]=_1fbd;
HTMLCHARTINFO["CP_LABEL_FORMAT"]=_1fbe;
HTMLCHARTINFO["CP_CHART_PUBLICURL"]=msg["CP_CHART_PUBLICURL"];
var imgid=getChartImgId(_1fb0);
if(_1fae=="NEW"){
createChart(HTMLCHARTINFO,"GENERATE","GENPUBLICCHART="+_1fb5,_1faf,"val");
}else{
if(_1fae=="EDIT"||_1fae=="REGENERATE"){
if(imgid!=""){
var _1fc1=msg["CHART_URL"];
var chart=ExcelGraph.getInstance(imgid);
chart["CP_DATARANGE"]=_1fb6;
chart["CP_DATAIN"]=_1fb7;
chart["CP_CHARTTYPEID"]=_1fbf;
chart["CP_GRAPHTYPE"]=_1fb9;
chart["CP_PLOT_ORIENTATION"]=_1fba;
chart["CP_SHOW_LEGEND"]=_1fbb;
chart["CP_CHART_TITLE"]=_1fb8;
chart["CP_CHART_X_LABEL"]=_1fbc;
chart["CP_CHART_Y_LABEL"]=_1fbd;
chart["CP_LABEL_FORMAT"]=_1fbe;
if(_1faf&&getObj(imgid)!=null&&_1fc1!=null&&!jsREMOTE_SAVE_VIEW){
getObj(imgid).src=_1fc1;
}else{
var chart=ExcelGraph.getInstance(imgid);
createChart(chart,"EDIT","GENPUBLICCHART="+_1fb5,_1faf,"val");
}
}
}else{
if(imgid!=""){
var chart=ExcelGraph.getInstance(imgid);
var _1fc1=msg["CHART_URL"];
if(_1fae=="MOVE"){
if(!jsREMOTE_SAVE_VIEW){
getObj(imgid).src=_1fc1;
}
ole(imgid).sCol=findColInXPos(left);
ole(imgid).sRow=findRowInYPos(top);
ole(imgid).sRowDiff=top-getRowTop(ole(imgid).sRow);
ole(imgid).sColDiff=left-getColLeft(ole(imgid).sCol);
if(!_1faf){
OLE[imgid].setLeft(left).setSelectLayer().positionActionBar();
OLE[imgid].setTop(top).setSelectLayer().positionActionBar();
}else{
OLE[imgid].setLeft(left);
OLE[imgid].setTop(top);
}
if(currPic==imgid){
OLE[currPic].focus();
}
}else{
if(_1fae=="RESIZE"){
if(!jsREMOTE_SAVE_VIEW){
getObj(imgid).src=_1fc1;
}
ole(imgid).sCol=findColInXPos(left);
ole(imgid).sRow=findRowInYPos(top);
ole(imgid).sRowDiff=top-getRowTop(ole(imgid).sRow);
ole(imgid).sColDiff=left-getColLeft(ole(imgid).sCol);
if(!_1faf){
OLE[imgid].moveTo(left,top).setSelectLayer().positionActionBar();
OLE[imgid].resizeTo(width,_1fb4).setSelectLayer().positionActionBar();
}else{
OLE[imgid].moveTo(left,top);
OLE[imgid].resizeTo(width,_1fb4);
}
if(currPic==imgid){
OLE[currPic].focus();
}
}else{
if(_1fae=="DELETE"){
ole.remove(imgid,true);
}else{
if(_1fae=="PUBLISH"){
publishChart(imgid,_1faf);
}else{
if(_1fae=="UNPUBLISH"){
unpublishChart(imgid,_1faf);
}
}
}
}
}
}
}
}
}
function getChartImgId(dbid){
var imgid="";
for(var i in ExcelGraph._INSTANCES){
var graph=getObj(i);
if(graph!=null){
var _1fc7=graph.getAttribute("dbid");
if(_1fc7==dbid){
imgid=graph.id;
}
}
}
return imgid;
}
function makeOffline(chid,uname,user,_1fcb){
if(uname==zuid||uname==RMUSER||uname==""){
return;
}
var _1fcc=false;
var _1fcd=false;
for(var i=0;i<SHAREDUSERSLIST.length;i++){
if(SHAREDUSERSLIST[i]["uname"]==uname&&SHAREDUSERSLIST[i]["cstatus"]!=_1fcb){
SHAREDUSERSLIST[i]["cstatus"]="0";
_1fcd=true;
}
if(SHAREDUSERSLIST[i]["cstatus"]=="1"&&!_1fcc){
_1fcc=true;
}
}
if(!_1fcc){
COLLABORATIVE_EDITING="OFF";
}
if(SHAREDUSERSLIST.length!=0&&_1fcd){
notify("info",user+" "+jsMsg.hasClosedDocument,"");
}
Userpresence.remove(uname);
usercell[uname]="";
usercolorcode[uname]="";
if(!DOC_PANEL.isDocPanelClosed()&&panelOpenedFor=="chat"){
showChatPanel();
}
updateSharedUserStatus();
}
var _SharedUserList={};
function makeOnline(chid,uname,user,_1fd2){
var _1fd3=false;
for(var i=0;i<SHAREDUSERSLIST.length;i++){
var _1fd5=SHAREDUSERSLIST[i];
var name=_1fd5["dname"];
if(_1fd5["uname"]==uname){
_1fd3=true;
if(_1fd5["cstatus"]=="1"){
return;
}else{
_1fd5["cstatus"]="1";
break;
}
}
}
if(!_1fd3){
_SharedUserList[uname]={"uname":uname,"dname":user,"cstatus":1};
}
var _1fd7="<hr size='1' color='#CCCCCC' style='margin-top:10px;'><div style='height:25px;text-align:right;'><a href='#' onclick='javascript:if(DOC_PANEL.isDocPanelClosed()) { DOC_PANEL.showDocPanel(\"chat\", showChatPanel()); return false;}' style='color:#00F;text-decoration:underline;'>"+jsMsg.EnterDiscussionRoom+"</a></div>";
if(!DONTNOTIFY){
notify("info",user+" "+jsMsg.hasOpenedDoc,_1fd7);
}
DONTNOTIFY=false;
updateSharedUserStatus();
Userpresence.send();
}
function updateSharedUserStatus(){
var cnt=0;
for(var i=0;i<SHAREDUSERSLIST.length;i++){
var _1fda=SHAREDUSERSLIST[i];
var stat=_1fda["cstatus"];
if(stat=="1"){
status=1;
cnt=cnt+1;
}
}
var _1fdc=$("#userStatusDiv");
var _1fdd=getObj("sharedUserStatus");
_1fdc.css("display","block");
if(_1fdc.hasClass("chatBlink")){
_1fdc.removeClass("chatBlink");
}
if(cnt>0){
_1fdc.addClass("userOnline");
}else{
_1fdc.removeClass("userOnline");
}
if(_1fdd!=null){
var msg=jsMsg["Share.Collaborators"];
if(cnt==1){
msg=jsMsg["Share.Collaborator"];
}
_1fdd.innerHTML="<b>"+(cnt)+"</b>"+" "+msg;
_1fdd.title=jsTitleMsg.SharedUserStatus;
}
}
function getCollaboratorsMode(usr){
var resp;
var _1fe1=false;
resp="[";
var _1fe1=false;
for(var i=0;i<SHAREDUSERSLIST.length;i++){
var _1fe3=SHAREDUSERSLIST[i];
var stat=_1fe3["cstatus"];
var name=_1fe3["dname"];
if(stat=="1"){
resp+="{uname:'"+name+"',mode:'-1'}";
if(i<SHAREDUSERSLIST.length-1){
resp+=",";
}
}
}
resp+="]";
if(typeof usr=="undefined"){
_1fe1=true;
}
if(resp!="[]"){
resp=eval("({CollabModes:"+resp+"})");
setUserDivColor(resp,_1fe1);
}
}
function setUserDivColor(resp,_1fe7){
if(resp!=null||resp!=""){
for(var i=0;i<resp.CollabModes.length;i++){
if(typeof resp.CollabModes[i]=="undefined"){
return false;
}
var mode=(resp.CollabModes[i].mode)?resp.CollabModes[i].mode:null;
var uname=(resp.CollabModes[i].uname)?resp.CollabModes[i].uname:null;
if(mode!=null&&uname!=null){
userpremission[uname]=mode;
if(uname!=RMUSER){
usercolorcode[uname]=getColorCode(uname);
}
}
if(!DOC_PANEL.isDocPanelClosed()&&!_1fe7&&panelOpenedFor=="chat"){
showChatPanel();
}
}
}
}
function getChatLogsObj(){
return getObj("chatLogs");
}
function changeImageSrc(img,msg,user){
var win=window.frames["docPanelFrame"];
win.getObj("uname_"+user).getElementsByTagName("IMG")[0].src=IMAGE_PATH+img;
win.getObj("msg_"+user).innerHTML=msg;
}
function showCommentsIFrame(){
DOC_PANEL.showDocPanel("comments",showSheetComments());
}
function commentSetting(){
var _1fef=getCell(currRow,currCol).getAttribute("comment");
if(_1fef==null){
showCommentDialog("add");
}else{
showCommentDialog("edit");
}
}
function getNextCellDetailsContainingContent(row,col,evt,_1ff3){
var _1ff4,_1ff5;
var _1ff6={};
switch(evt){
case "DOWN":
_1ff4=row;
var rows=Row.getNonHiddenRowsInRange(row+1,totRows-1);
var len=rows.length;
for(var i=0;i<len;i++){
_1ff4=rows[i];
if(!isRowInAvailableRowRange(row)){
getUsedCursorCell(row,col,evt,_1ff3);
return -1;
}
if(_1ff4>(getAvailableEndRow())){
getUsedCursorCell(row,col,evt,_1ff3);
return -1;
}
_1ff6=getCell(_1ff4,col);
if(isCellContainingContent(_1ff6)){
break;
}
}
case "LEFT":
for(_1ff5=col-1;_1ff5>=0;_1ff5-=1){
if(!isRowAvailable(row)){
getUsedCursorCell(row,col,evt,_1ff3);
return -1;
}
_1ff6=getCell(row,_1ff5);
if(isNotValidCell(_1ff6)){
var _1ffa=getValidCellWithDetails(row,_1ff5);
_1ff6=_1ffa.obj;
_1ff5=_1ffa.col;
}
if(isCellContainingContent(_1ff6)){
break;
}
}
break;
case "RIGHT":
_1ff5=col;
var iter=Range.getIterator(row,col+1,row,totCols-1);
var _1ffc=iter.iterate(function(row,col,evt,_2000){
if(!isRowAvailable(row)){
getUsedCursorCell(row,_1ff5,evt,_2000);
this.interrupt();
return null;
}
var _2001=getCell(row,col);
if(isCellContainingContent(_2001)){
this.interrupt();
}
return {row:row,col:col,cell:_2001};
},evt,_1ff3);
if(!_1ffc){
return -1;
}else{
_1ff4=_1ffc.row;
_1ff5=_1ffc.col;
_1ff6=_1ffc.cell;
}
break;
case "UP":
var rows=Row.getNonHiddenRowsInRange(0,row-1);
var len=rows.length-1;
while(len>-1){
_1ff4=rows[len];
if(!isRowAvailable(row)){
getUsedCursorCell(row,col,evt,_1ff3);
return -1;
}
if(_1ff4<(getAvailableStartRow())){
getUsedCursorCell(row,col,evt,_1ff3);
return -1;
}
_1ff6=getCell(_1ff4,col);
if(isCellContainingContent(_1ff6)){
break;
}
len--;
}
break;
}
return {row:_1ff4,col:_1ff5,cell:_1ff6};
}
function getNextCellDetailsNotContainingContent(row,col,evt,_2005){
var _2006,_2007;
var _2008={};
var found=false;
switch(evt){
case "DOWN":
_2006=row;
var rows=Row.getNonHiddenRowsInRange(row+1,totRows-1);
var len=rows.length;
for(var i=0;i<len;i++){
_2006=rows[i];
if(!isRowInAvailableRowRange(row)){
getUsedCursorCell(row,col,evt,_2005);
return -1;
}
if(_2006>(getAvailableEndRow())){
getUsedCursorCell(row,col,evt,_2005);
return -1;
}
_2008=getCell(_2006,col);
if(!isCellContainingContent(_2008)){
found=true;
break;
}
}
break;
case "LEFT":
for(_2007=col-1;_2007>=0;_2007-=1){
if(!isRowAvailable(row)){
getUsedCursorCell(row,col,evt,_2005);
return -1;
}
_2008=getCell(row,_2007);
if(isNotValidCell(_2008)){
var _200d=getValidCellWithDetails(row,_2007);
_2008=_200d.obj;
_2007=_200d.col;
}
if(!isCellContainingContent(_2008)){
break;
}
}
break;
case "RIGHT":
_2007=col;
var iter=Range.getIterator(row,col+1,row,totCols-1);
var _200f=iter.iterate(function(row,col,evt,_2013){
if(!isRowAvailable(row)){
getUsedCursorCell(row,_2007,evt,_2013);
this.interrupt();
return null;
}
var _2014=getCell(row,col);
if(!isCellContainingContent(_2014)){
this.interrupt();
}
return {row:row,col:col,cell:_2014};
},evt,_2005);
if(!_200f){
return -1;
}else{
_2006=_200f.row;
_2007=_200f.col;
_2008=_200f.cell;
}
break;
case "UP":
var rows=Row.getNonHiddenRowsInRange(0,row-1);
var len=rows.length-1;
while(len>-1){
_2006=rows[len];
if(!isRowAvailable(row)){
getUsedCursorCell(row,col,evt,_2005);
return -1;
}
if(_2006<(getAvailableStartRow())){
getUsedCursorCell(row,col,evt,_2005);
return -1;
}
_2008=getCell(_2006,col);
if(!isCellContainingContent(_2008)){
found=true;
break;
}
len--;
}
break;
}
return {"row":_2006,"col":_2007,"cell":_2008,"found":found};
}
function setCellTooltip(cell,title){
cell.title=title;
}
function getUsedCursorCell(row,col,_2019,_201a){
if(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE){
return;
}
var _201b=new getXmlhttp();
_201b.onreadystatechange=function(){
if(_201b.readyState==4){
var _201c=eval("("+_201b.responseText+")");
var _201d=_201c["cR"];
var _201e=_201c["cC"];
if(!_201a){
focusCell(_201d,_201e);
}else{
if(isCellRange()){
var _201f=getCellRange();
if(_2019.toUpperCase()=="DOWN"){
if(currRow!=_201f.endRow){
focusCellRange(_201f.startRow,_201f.startCol,_201d,_201f.endCol);
}else{
resetCellRange();
focusCellRange(_201f.endRow,_201f.startCol,_201d,_201f.endCol);
}
}else{
if(_2019.toUpperCase()=="UP"){
if(currRow!=_201f.startRow){
focusCellRange(_201f.endRow,_201f.startCol,_201d,_201f.endCol);
}else{
resetCellRange();
focusCellRange(_201f.startRow,_201f.startCol,_201d,_201f.endCol);
}
}else{
if(_2019.toUpperCase()=="RIGHT"){
if(currCol!=_201f.endCol){
focusCellRange(_201f.startRow,_201f.startCol,_201f.endRow,_201e);
}else{
resetCellRange();
focusCellRange(_201f.startRow,_201f.endCol,_201f.endRow,_201e);
}
}else{
if(_2019.toUpperCase()=="LEFT"){
if(currCol!=_201f.startCol){
focusCellRange(_201f.startRow,_201f.endCol,_201f.endRow,_201e);
}else{
resetCellRange();
focusCellRange(_201f.startRow,_201f.startCol,_201f.endRow,_201e);
}
}
}
}
}
}else{
focusCellRange(row,col,_201d,_201e);
}
}
}
};
var _2020="startRow="+row+"&startCol="+col+"&totalRows="+totRows+"&totalCols="+totCols+"&action="+_2019;
_2020+="&currentTime="+CURRENTTIME+"&currentSheet="+encodeURIComponent(CURRSHEETNAME)+"&documentId="+DOCUMENT_ID;
_2020+="&view="+getObj("VIEW").value+"&docOwner="+CURR_DOC_OWNERNAME;
sendXMLHTTPRequest(_201b,_2020,true,true,ctxpath+"ctrlnavigation.do");
}
function getNearerCellPos(cRow,cCol,_2023,_2024){
var bR=(typeof cRow!="undefined")?parseInt(cRow):currRow;
var bC=(typeof cCol!="undefined")?parseInt(cCol):currCol;
var rL=(typeof _2023!="undefined")?parseInt(_2023):2;
var cL=(typeof _2024!="undefined")?parseInt(_2024):1;
var rR=(getCell((bR-rL),cL)==null)?(bR+rL):(bR-rL);
var rC=(getCell(bR,(bC-cL))==null)?(bC+cL):(bC-cL);
return {"row":rR,"col":rC};
}
function clearContents(_202b,_202c,_202d,_202e){
var range=new Range(_202b,_202c,_202d,_202e);
var iter=range.getIterator();
iter.iterate(clearCell);
}
function setCellClass(cell,_2032,_2033){
if(cell){
if(typeof _2033!="undefined"&&_2033==true){
cell.className=_2032;
}else{
cell.className+=" "+_2032;
}
}
}
function insertCells(){
SAVED=false;
reloadPage();
}
function deleteCells(){
SAVED=false;
reloadPage();
}
function startDragCellOrCellRange(ev,el){
if(el.id=="fD"||el.id=="fD1"||el.id=="fD2"||el.id=="fD3"){
cellDragProps.isDraggable=true;
}
var _2036=getCellRange();
if(isCellRange()){
var _2037=_2036.startRow;
var _2038=_2036.startCol;
var _2039=_2036.endRow;
var _203a=_2036.endCol;
}else{
var info=ActiveCellInfo;
var _2037=info.getStartRow();
var _2038=info.getStartCol();
var _2039=info.getEndRow();
var _203a=info.getEndCol();
}
cellDragProps.cellDragRange.ASR=_2037;
cellDragProps.cellDragRange.ASC=_2038;
cellDragProps.cellDragRange.AER=_2039;
cellDragProps.cellDragRange.AEC=_203a;
var _203c=getRowPosInMouseEvent(ev);
if(_203c<_2037){
_203c=_2037;
}else{
if(_203c>_2039){
_203c=_2039;
}
}
cellDragProps.ADR=_203c;
var _203d=getColPosInMouseEvent(ev);
if(_203d<_2038){
_203d=_2038;
}else{
if(_203d>_203a){
acutalCol=_203a;
}
}
cellDragProps.ADC=_203d;
rowsInRange=cellDragProps.cellDragRange.AER-cellDragProps.cellDragRange.ASR;
colsInRange=cellDragProps.cellDragRange.AEC-cellDragProps.cellDragRange.ASC;
selRow=currRow;
selCol=currCol;
selectionLeft=getEndLeftOfCol(currCol);
selectionTop=getEndTopOfRow(currRow);
if(!moveCursorDIV){
moveCursorDIV=document.createElement("DIV");
moveCursorDIV.className="moveCursorDIV";
moveCursorDIV.id="moveCursorDIV";
moveCursorDIV.style.cursor="move";
if(browser_ie){
moveCursorDIV.style.backgroundColor="#fff";
moveCursorDIV.style.filter="alpha(opacity=0)";
}
moveCursorDIV.style.display="none";
document.body.appendChild(moveCursorDIV);
}
if(browser_ie){
document.attachEvent("onmousemove",dragCellOrCellRange);
document.attachEvent("onmouseup",endDragCellOrCellRange);
document.attachEvent("onkeydown",cancelDragCellOrCellRange);
}else{
document.addEventListener("mousemove",dragCellOrCellRange,false);
document.addEventListener("mouseup",endDragCellOrCellRange,false);
document.addEventListener("keydown",cancelDragCellOrCellRange,false);
}
}
function rangeSelection(){
if(isCellEdited()&&cellField.value.indexOf("=")==0&&isCellFieldInNewMode){
if(!isRangeSelection){
isRangeSelection=true;
var info=ActiveFormulaInfo;
if(!info.isAvailable()){
ActiveFormulaInfo.set(currRow,currCol);
}
tempPos=getCaretPos(cellField);
}else{
if(formulaSIdxTemp>0){
tempPos=formulaSIdxTemp;
}else{
tempPos=getCaretPos(cellField);
}
}
cellRangeStartIdx=getSelectionStart(cellField);
cellRangeEndfIdx=getSelectionEnd(cellField);
var _203f=true;
if(formulaSIdxTemp==formulaEIdxTemp&&formulaSIdxTemp==0){
if(cellRangeStartIdx==cellRangeEndfIdx){
_203f=checkForValidCellKeyRangeInsert(cellField,tempPos);
}
}
if(_203f){
formulaCell=true;
functionRow=currRow;
functionCol=currCol;
}else{
formulaCell=false;
}
return true;
}
return true;
}
var isScrollTopSet=false;
var isScrollLeftSet=false;
function selectCell(ev){
clearTextSelection();
isCellSelection=true;
var el=(browser_ie)?window.event.srcElement:ev.target;
var _2042=getCursorPos(ev);
var x=0,y=0,_2045=0,_2046=0,_2047=ISFREEZED,_2048={},_2049={};
if(_2047){
if(_2042.x>sheetLeft+findSecondPaneXPos()){
x=_2042.x-sheetLeft+getSheetScrollLeft();
}else{
x=_2042.x-sheetLeft;
}
if(_2042.y>sheetTop+findThirdPaneYPos()){
y=_2042.y-sheetTop+getSheetScrollTop();
}else{
y=_2042.y-sheetTop;
}
}else{
x=_2042.x-sheetLeft+getSheetScrollLeft();
y=_2042.y-sheetTop+getSheetScrollTop();
}
if(x>getColLeft(currCol)){
_2048=(x>selectionLeft)?increaseReqCellLeft(x,selCol,selectionLeft):decreaseReqCellLeft(x,selCol,selectionLeft);
selCol=_2048.col;
selectionLeft=_2048.left;
}else{
_2048=(x<selectionLeft)?decreaseReqCellLeft(x,selCol,selectionLeft):increaseReqCellLeft(x,selCol,selectionLeft);
selCol=_2048.col;
selectionLeft=_2048.left;
}
if(y>getRowTop(currRow)){
_2049=(y>selectionTop)?increaseReqCellTop(y,selRow,selectionTop):decreaseReqCellTop(y,selRow,selectionTop);
selRow=_2049.row;
selectionTop=_2049.top;
}else{
_2049=(y<selectionTop)?decreaseReqCellTop(y,selRow,selectionTop):increaseReqCellTop(y,selRow,selectionTop);
selRow=_2049.row;
selectionTop=_2049.top;
}
_2045=isMouseCursorYInOutOfViewPort(y);
_2046=isMouseCursorXInOutOfViewPort(x);
if(_2045||_2046){
if(_2045){
if((_2047&&(y-getSheetScrollTop()>0))||!_2047){
scrollSheetVertical(y,"SELECTION");
}
}else{
if((_2047&&(x-getSheetScrollLeft()>0))||!_2047){
scrollSheetHorizontal(x,"SELECTION");
}
}
}else{
if(typeof sheetScrollLeftId!="undefined"){
clearInterval(sheetScrollLeftId);
}
if(typeof sheetScrollTopId!="undefined"){
clearInterval(sheetScrollTopId);
}
setTimeout(function(){
focusCellRange(currRow,currCol,selRow,selCol,"INCREMENT");
},0);
}
}
function endSelect(ev){
applyFormatting();
window.clearInterval(userpresenceintvl);
if(browser_ie){
document.detachEvent("onmousemove",selectCell);
document.detachEvent("onmouseup",endSelect);
}else{
document.removeEventListener("mousemove",selectCell,false);
document.removeEventListener("mouseup",endSelect,false);
}
if(typeof sheetScrollLeftId!="undefined"){
clearInterval(sheetScrollLeftId);
}
if(typeof sheetScrollTopId!="undefined"){
clearInterval(sheetScrollTopId);
}
isCellSelection=false;
isScrollTopSet=false;
isScrollLeftSet=false;
if(!jsTHROWAWAY_VIEW){
userpresenceintvl=window.setInterval("Userpresence.send()",1000);
}
}
function resetCellRange(){
if(isCellRange()){
var _204b=getCellRange();
if(isRowSelected()){
blurColHeadTable();
}else{
blurColHead(_204b.startCol,_204b.endCol);
}
if(isColSelected()){
blurRowHeadTable();
}else{
if(browser_ie&&!colSelected||!browser_ie){
blurRowHead(_204b.startRow,_204b.endRow);
}
}
hideTransSpan();
currCellRange="";
selectedCellRange={};
}
selRow=selCol=-1;
}
function blurCellRange(sR,sC,eR,eC){
if(isCellRange()){
blurColHead(sC,eC);
blurRowHead(sR,eR);
}else{
blurCell(currRow,currCol);
}
}
function focusCellRange(_2050,_2051,_2052,_2053,ev,_2055,_2056,_2057,_2058){
var _2059,_205a,_205b,_205c="";
if(ev){
ev=ev.toUpperCase();
}
if(_2051==-1){
rowSelection=true;
_2051=0;
}
if(_2050==-1){
colSelection=true;
_2050=0;
}
if((isCellEdited()&&cellField.value.indexOf("=")==0)||formulaCell||isExprFunc||(isFuncDlgOpen&&getObj("funcList")!=null)||isRangeEdit||(isChartDialogOpened&&getObj("chartDataDIV")!=null&&getObj("chartDataDIV").style.display!="none")||isPivotDialogOpen||isEditPivotDialogOpen||isConditionalDialogOpen){
focusCellRangeFill(_2050,_2051,_2052,_2053);
return;
}
var _205d=(_2051<_2053)?_2051:_2053;
var _205e=(_2051>_2053)?_2051:_2053;
var _205f=(_2050<_2052)?_2050:_2052;
var _2060=(_2050>_2052)?_2050:_2052;
var _2061=getCellRange();
var _2062=(_2050<_2052)?"N":"S";
var _2063=(_2051<_2053)?"E":"W";
var _2064=false;
if(_2060>=getRowMax()||_205e>=getColMax()){
return;
}
if(ev!="COLUMN"&&ev!="COLUMNINMOUSE"&&ev!="COLUMNINKEY"&&ev!="WHOLESHEET"){
if(_2060>=totRows){
appendBlankRows("ROWS_EXCEEDED",_2060+1);
}
}
if(_205d<totCols&&_205e>=totCols){
if(_2051>=totCols){
_2051=totCols-1;
}
if(_2053>=totCols){
_2053=totCols-1;
}
}else{
if(_205e>=totCols&&_205d>=totCols){
return;
}
}
if(ev!="ROW"&&ev!="COLUMN"&&ev!="COLUMNINMOUSE"&&ev!="COLUMNINKEY"&&ev!="WHOLESHEET"&&ev!="ROWINMOUSE"){
var _205d=(_2051<_2053)?_2051:_2053;
var _205e=(_2051>_2053)?_2051:_2053;
var _205f=(_2050<_2052)?_2050:_2052;
var _2060=(_2050>_2052)?_2050:_2052;
var range=new Range(_205f,_205d,_2060,_205e);
Merge.extendRange(range);
_2050=range.startRow;
_2051=range.startCol;
_2052=range.endRow;
_2053=range.endCol;
_2064=true;
}else{
if(ev=="COLUMN"||ev=="COLUMNINMOUSE"||ev=="COLUMNINKEY"){
var _205d=(_2051<_2053)?_2051:_2053;
var _205e=(_2051>_2053)?_2051:_2053;
var _205f=0;
var _2060=getRowMax()-1;
var range=new Range(_205f,_205d,_2060,_205e);
Merge.extendCol(range);
_2050=range.startRow;
_2051=range.startCol;
_2052=range.endRow;
_2053=range.endCol;
_2064=true;
}else{
if(ev=="ROW"||ev=="ROWINMOUSE"){
var _205f=(_2050<_2052)?_2050:_2052;
var _2060=(_2050>_2052)?_2050:_2052;
var _205d=0;
var _205e=getColMax()-1;
var range=new Range(_205f,_205d,_2060,_205e);
Merge.extendRow(range);
_2050=range.startRow;
_2051=range.startCol;
_2052=range.endRow;
_2053=range.endCol;
_2064=true;
}
}
}
if(ev){
if(isCellRange()){
if((_2061.startRow==_205f)&&(_2061.endRow==_2060)&&(_2061.startCol==_205d)&&(_2061.endCol==_205e)){
return;
}
}
}
switch(ev){
case "ROWINKEY":
case "ROWINMOUSE":
case "ROW":
var dim=getCellRangeDIM(_2050,_2051,_2052,_2053);
_205c=0;
_205b=getSheetTableWidth();
_2059=dim.top;
_205a=dim.height;
selectColHeadTable();
if(ev=="ROW"){
if(isCellRange()){
var _2061=getCellRange();
if(!isColSelected()){
(_2050<=_2052)?blurRowHead(_2061.startRow,_2061.endRow):blurRowHead(_2061.endRow,_2061.startRow);
}else{
blurRowHeadTable();
}
}else{
blurRowHead(currRow,currRow);
}
(_2050<=_2052)?selectRowHead(_2050,_2052):selectRowHead(_2052,_2050);
}else{
if(_2050<=_2052){
var _2067=_2052+1;
var _2068=_2061.endRow;
var _2069=_2061.endRow;
var _206a=_2052;
if(_2061.startRow<currRow&&_2052>=currRow){
blurRowHead(_2061.startRow,_2061.endRow-1);
selectRowHead(_2050,_2052);
}else{
blurRowHead(_2067,_2068);
selectRowHead(_2069,_206a);
}
}else{
var _2067=_2061.startRow;
var _2068=_2052-1;
var _2069=_2052;
var _206a=_2061.startRow;
if(_2061.endRow>currRow&&_2052<currRow){
blurRowHead(_2061.startRow+1,_2061.endRow);
selectRowHead(_2052,_2050);
}else{
blurRowHead(_2067,_2068);
selectRowHead(_2069,_206a);
}
}
}
break;
case "COLUMNINKEY":
case "COLUMNINMOUSE":
case "COLUMN":
var dim=getCellRangeDIM(_2050,_2051,_2052,_2053);
_2059=0;
_205a=getSheetTableHeight();
_205c=dim.left;
_205b=dim.width;
selectRowHeadTable();
if(ev=="COLUMN"){
if(isCellRange()){
var _2061=getCellRange();
if(!isRowSelected()){
(_2051<=_2053)?blurColHead(_2061.startCol,_2061.endCol):blurColHead(_2061.endCol,_2061.startCol);
}else{
blurColHeadTable();
}
}else{
blurColHead(currCol,currCol);
}
(_2051<=_2053)?selectColHead(_2051,_2053):selectColHead(_2053,_2051);
}else{
if(_2051<=_2053){
if(_2061.startCol<currCol&&_2053>=currCol){
blurColHead(_2061.startCol,_2061.endCol-1);
selectColHead(_2051,_2053);
}else{
blurColHead(_2053+1,_2061.endCol);
selectColHead(_2051,_2053);
}
}else{
if(_2061.endCol>currCol&&_2053<currCol){
blurColHead(_2061.startCol+1,_2061.endCol);
selectColHead(_2053,_2051);
}else{
blurColHead(_2061.startCol,_2053-1);
selectColHead(_2053,_2061.startCol);
}
}
}
break;
case "WHOLESHEET":
_205c=0;
_205b=getSheetTableWidth();
_2059=0;
_205a=getSheetTableHeight();
selectRowHeadTable();
selectColHeadTable();
break;
case "KEYSELECTION":
case "INCREMENT":
var dim=getCellRangeDIM(_2050,_2051,_2052,_2053);
_205c=dim.left;
_205b=dim.width;
_2059=dim.top;
_205a=dim.height;
var _206b=_2061.startCol;
var _206c=_2061.endCol;
var _206d=Selection.changeInPosition(_206b,_206c,_2051,_2053);
if(_206d){
var _206e=_206d["reset"];
var _206f=_206d["set"];
if(_206e){
blurColHead(_206e[0].start,_206e[0].end);
if(_206e[1]){
blurColHead(_206e[1].start,_206e[1].end);
}
}
if(_206f){
selectColHead(_206f[0].start,_206f[0].end);
if(_206f[1]){
selectColHead(_206f[1].start,_206f[1].end);
}
}
}
var _2070=_2061.startRow;
var _2071=_2061.endRow;
var _2072=Selection.changeInPosition(_2070,_2071,_2050,_2052);
if(_2072){
var _206e=_2072["reset"];
var _206f=_2072["set"];
if(_206e){
blurRowHead(_206e[0].start,_206e[0].end);
if(_206e[1]){
blurRowHead(_206e[1].start,_206e[1].end);
}
}
if(_206f){
selectRowHead(_206f[0].start,_206f[0].end);
if(_206f[1]){
selectRowHead(_206f[1].start,_206f[1].end);
}
}
}
break;
default:
var dim=getCellRangeDIM(_2050,_2051,_2052,_2053);
_205c=dim.left;
_205b=dim.width;
_2059=dim.top;
_205a=dim.height;
if(isCellRange()){
var _2061=getCellRange();
if(!isColSelected()){
(_2061.startRow<=_2061.endRow)?blurRowHead(_2061.startRow,_2061.endRow):blurRowHead(_2061.endRow,_2061.startRow);
}else{
blurRowHeadTable();
}
if(!isRowSelected()){
(_2061.startCol<=_2061.endCol)?blurColHead(_2061.startCol,_2061.endCol):blurColHead(_2061.endCol,_2061.startCol);
}else{
blurColHeadTable();
}
}else{
blurCell(currRow,currCol);
}
(_2050<=_2052)?selectRowHead(_2050,_2052):selectRowHead(_2052,_2050);
(_2051<=_2053)?selectColHead(_2051,_2053):selectColHead(_2053,_2051);
break;
}
var info=Merge.getCellInfo(_2050,_2051);
if(info){
var _2074=((_2051-_2053+info.getColSpan()-1==0)&&(_2050-_2052+info.getRowSpan()-1==0));
}
if(!ev){
currRow=_2050;
currCol=_2051;
if(_2064){
currRow=(_2062=="N")?_2050:_2052;
currCol=(_2063=="E")?_2051:_2053;
}
ActiveCellInfo.reset(currRow,currCol);
var cell=getCell(currRow,currCol);
if(cell){
currCell=cell;
updateActiveCellDependencies(cell);
}
}
if((_2050-_2052==0&&(_2051-_2053==0)||_2074)){
if(info){
var _2076=info["startRow"];
var _2077=info["startCol"];
}else{
var _2076=_2050;
var _2077=_2051;
}
setCurrCellIndicator(_2076,_2077,_2076,_2077);
currCellRange="";
}else{
var _2078=_2053;
var _2079=getAvailableEndCol();
if(_2078>_2079){
_2078=_2079;
}
setCurrCellIndicator(_2050,_2051,_2052,_2078);
}
if(!_2055){
var _207a=_2052;
var _207b=_2053;
if(_2064){
_207a=(_2062=="N")?_2052:_2050;
_207b=(_2063=="E")?_2053:_2051;
}
switch(ev){
case "WHOLESHEET":
break;
case "ROWINKEY":
case "ROWINMOUSE":
case "ROW":
if(!_2058){
scrollRowIntoView(_207a);
}
break;
case "COLUMNINKEY":
case "COLUMN":
case "COLUMNINMOUSE":
if(!_2058){
scrollColIntoView(_207b);
}
break;
case "INCREMENT":
break;
default:
if(!_2058){
scrollCellIntoView(_207a,_207b);
}
break;
}
}
if(_2050-_2052==0&&(_2051-_2053==0)||_2074){
hideTransSpan();
resetAutoFormulas();
}else{
showTransSpan();
calcAutoFormulas();
}
setFocusDIVPos(_205c,_2059);
setFocusDIVDim(_205b,_205a);
displayCellName(_2050,_2051,_2052,_2053,CURRSHEETNAME);
if(!_2057){
rowToFocusOnPageNavigation=undefined;
}
if(Row.isHidden(currRow)){
var _207c=getHiddenCellFormula(currRow,currCol);
if(isUndefined(_207c)){
requestHiddenRowData(currRow);
}else{
updateExprFieldWithHiddenRowData(currRow,_207c);
}
}
}
function selectCol(ev){
clearTextSelection();
var el=(browser_ie)?window.event.srcElement:ev.target;
var _207f=getCursorPos(ev);
if(ISFREEZED){
if(_207f.x>sheetLeft+findSecondPaneXPos()){
var x=_207f.x-sheetLeft+getSheetScrollLeft();
}else{
var x=_207f.x-sheetLeft;
}
}else{
var x=_207f.x-sheetLeft+getSheetScrollLeft();
}
if((isCellEdited()&&cellField.value.indexOf("=")==0)||formulaCell||isExprFunc||(isFuncDlgOpen&&getObj("funcList")!=null)||isRangeEdit||(isChartDialogOpened&&getObj("chartDataDIV")!=null&&getObj("chartDataDIV").style.display!="none")||isPivotDialogOpen||isEditPivotDialogOpen){
var info=ActiveFormulaInfo;
var _2082=info.getActiveCol();
if(x>getColLeft(_2082)){
var _2083=(x>functionLeft)?increaseReqCellLeft(x,funCol,functionLeft):decreaseReqCellLeft(x,funCol,functionLeft);
funCol=_2083.col;
functionLeft=_2083.left;
}else{
var _2083=(x<functionLeft)?decreaseReqCellLeft(x,funCol,functionLeft):increaseReqCellLeft(x,funCol,functionLeft);
funCol=_2083.col;
functionLeft=_2083.left;
}
var _2084=info.getStartCol();
var _2085=funCol;
}else{
if(x>(getColLeft(currCol))){
var _2083=(x>selectionLeft)?increaseReqCellLeft(x,selCol,selectionLeft):decreaseReqCellLeft(x,selCol,selectionLeft);
selCol=_2083.col;
selectionLeft=_2083.left;
}else{
var _2083=(x<selectionLeft)?decreaseReqCellLeft(x,selCol,selectionLeft):increaseReqCellLeft(x,selCol,selectionLeft);
selCol=_2083.col;
selectionLeft=_2083.left;
}
var _2084=currCol;
var _2085=selCol;
}
if(isMouseCursorXInOutOfViewPort(x)){
if(ISFREEZED){
if(x-getSheetScrollLeft()>0){
scrollSheetHorizontal(x,"SELECTIONCOL");
}
}else{
scrollSheetHorizontal(x,"SELECTIONCOL");
}
}else{
if(typeof sheetScrollLeftId!="undefined"){
clearInterval(sheetScrollLeftId);
}
focusCol(_2084,_2085,"COLUMNINMOUSE");
}
}
function endSelectCol(){
applyFormatting();
window.clearInterval(userpresenceintvl);
if(browser_ie){
document.detachEvent("onmousemove",selectCol);
document.detachEvent("onmouseup",endSelectCol);
}else{
if(browser_nn6){
document.removeEventListener("mousemove",selectCol,false);
document.removeEventListener("mouseup",endSelectCol,false);
}
}
if(typeof sheetScrollLeftId!="undefined"){
clearInterval(sheetScrollLeftId);
}
colSelected=false;
if(((isCellEdited()&&cellField.value.indexOf("=")==0)||formulaCell)&&!isExprFunc){
if(formulaEIdxTemp>0){
setCaretPos(cellField,formulaEIdxTemp);
}
}else{
if(isExprFunc||(isFuncDlgOpen&&getObj("funcList")!=null)){
if(formulaCell||(isCellEdited()&&cellField.value.indexOf("=")==0)){
if(formulaEIdxTemp>0){
setCaretPos(cellField,formulaEIdxTemp);
}
}else{
if(formulaEIdxTemp>0){
setCaretPos(exprField,formulaEIdxTemp);
}
}
}else{
if(isChartDialogOpened&&getObj("chartDataDIV")!=null&&getObj("chartDataDIV").style.display!="none"){
if(formulaEIdxTemp>0){
var _2086=getObj("dataRange");
setCaretPos(_2086,formulaEIdxTemp);
}
}
}
}
isScrollLeftSet=false;
if((isFuncDlgOpen&&getObj("funcList")!=null)||isRangeEdit||(isChartDialogOpened&&getObj("chartDataDIV")!=null)||isPivotDialogOpen||isEditPivotDialogOpen){
recallDialog();
}
if(!jsTHROWAWAY_VIEW){
userpresenceintvl=window.setInterval("Userpresence.send()",1000);
}
}
function selectRow(ev){
clearTextSelection();
var el=(browser_ie)?window.event.srcElement:ev.target;
var _2089=getCursorPos(ev);
if(ISFREEZED){
if(_2089.y>sheetTop+findThirdPaneYPos()){
var y=_2089.y-sheetTop+getSheetScrollTop();
}else{
var y=_2089.y-sheetTop;
}
}else{
var y=_2089.y-sheetTop+getSheetScrollTop();
}
if((isCellEdited()&&cellField.value.indexOf("=")==0)||formulaCell||isExprFunc||(isFuncDlgOpen&&getObj("funcList")!=null)||isRangeEdit||(isChartDialogOpened&&getObj("chartDataDIV")!=null&&getObj("chartDataDIV").style.display!="none")||isPivotDialogOpen||isEditPivotDialogOpen){
var info=ActiveFormulaInfo;
var _208c=info.getActiveRow();
if(y>getRowTop(_208c)){
var _208d=(y>functionTop)?increaseReqCellTop(y,funRow,functionTop):decreaseReqCellTop(y,funRow,functionTop);
funRow=_208d.row;
functionTop=_208d.top;
}else{
var _208d=(y<functionTop)?decreaseReqCellTop(y,funRow,functionTop):increaseReqCellTop(y,funRow,functionTop);
funRow=_208d.row;
functionTop=_208d.top;
}
var _208e=info.getStartRow();
var _208f=funRow;
}else{
if(y>getRowTop(currRow)){
var _208d=(y>selectionTop)?increaseReqCellTop(y,selRow,selectionTop):decreaseReqCellTop(y,selRow,selectionTop);
selRow=_208d.row;
selectionTop=_208d.top;
}else{
var _208d=(y<selectionTop)?decreaseReqCellTop(y,selRow,selectionTop):increaseReqCellTop(y,selRow,selectionTop);
selRow=_208d.row;
selectionTop=_208d.top;
}
var _208e=currRow;
var _208f=selRow;
}
if(isMouseCursorYInOutOfViewPort(y)){
if(ISFREEZED){
if(y-getSheetScrollTop()>0){
scrollSheetVertical(y,"SELECTIONROW");
}
}else{
scrollSheetVertical(y,"SELECTIONROW");
}
}else{
if(typeof sheetScrollTopId!="undefined"){
clearInterval(sheetScrollTopId);
}
focusRow(_208e,_208f,"ROWINMOUSE");
}
}
function endSelectRow(){
applyFormatting();
window.clearInterval(userpresenceintvl);
if(browser_ie){
document.detachEvent("onmousemove",selectRow);
document.detachEvent("onmouseup",endSelectRow);
}else{
if(browser_nn6){
document.removeEventListener("mousemove",selectRow,false);
document.removeEventListener("mouseup",endSelectRow,false);
}
}
if(typeof sheetScrollTopId!="undefined"){
clearInterval(sheetScrollTopId);
}
rowSelected=false;
if(((isCellEdited()&&cellField.value.indexOf("=")==0)||formulaCell)&&!isExprFunc){
if(formulaEIdxTemp>0){
setCaretPos(cellField,formulaEIdxTemp);
}
}else{
if(isExprFunc||(isFuncDlgOpen&&getObj("funcList")!=null)){
if(formulaCell||(isCellEdited()&&cellField.value.indexOf("=")==0)){
if(formulaEIdxTemp>0){
setCaretPos(cellField,formulaEIdxTemp);
}
}else{
if(formulaEIdxTemp>0){
setCaretPos(exprField,formulaEIdxTemp);
}
}
}else{
if(isChartDialogOpened&&getObj("chartDataDIV")!=null&&getObj("chartDataDIV").style.display!="none"){
if(formulaEIdxTemp>0){
var _2090=getObj("dataRange");
setCaretPos(_2090,formulaEIdxTemp);
}
}
}
}
isScrollTopSet=false;
if(!jsTHROWAWAY_VIEW){
userpresenceintvl=window.setInterval("Userpresence.send()",1000);
}
}
var autoFormulas={"Sum":0,"Count":0,"Average":0,"Count Numbers":0,"Minimum":0,"Maximum":0};
var autoFormulasCnt=0;
var autoFormulasNames=new Array();
for(var name in autoFormulas){
autoFormulasNames[autoFormulasCnt]=name;
autoFormulasCnt++;
}
var defAutoFormulaIdx="Sum";
var fCRIntvl;
var summedValue;
var totalSumObj;
var loaderImgObj;
var isCellValueEmpty=false;
var initialStatusText;
var isCellInTextFormat=false;
var isNegativeNo=false;
var statusBarSumObj;
var statusBarLoadIconObj;
var isContinousString=true;
var firstCellFormat=undefined;
function changeStatusBarItem(val){
if(val!=undefined){
defAutoFormulaIdx=val;
}
}
function showStatusBarMenu(id){
if((transMode==true)&&(messagetranslated==true)){
Menu.statusMenuBar.cachedContent="";
}
menuData="<menu id='statusMenuBar' forElement='statusBarContainer'  onClose='menuClose(ev)'>";
menuData+=" <item onclick='updateFormulaStatusBar(\"Sum\")'><![CDATA["+jsMsg["Sum"]+" : "+autoFormulas["Sum"]+"]]></item>";
menuData+=" <item onclick='updateFormulaStatusBar(\"Average\")'><![CDATA["+jsMsg["Average"]+" : "+autoFormulas["Average"]+"]]></item>";
menuData+=" <item onclick='updateFormulaStatusBar(\"Minimum\")'><![CDATA["+jsMsg["Minimum"]+" : "+autoFormulas["Minimum"]+"]]></item>";
menuData+=" <item onclick='updateFormulaStatusBar(\"Maximum\")'><![CDATA["+jsMsg["Maximum"]+" : "+autoFormulas["Maximum"]+"]]></item>";
menuData+=" <item onclick='updateFormulaStatusBar(\"Count\")'><![CDATA["+jsMsg["Count"]+" : "+autoFormulas["Count"]+"]]></item>";
menuData+=" <item imgclass='' onclick='updateFormulaStatusBar(\"Count Numbers\")'><![CDATA["+jsMsg["CountNumbers"]+" : "+autoFormulas["Count Numbers"]+"]]></item>";
menuData+="</menu>";
Menu.create(menuData,{inputType:"xml"});
if(isContinousString){
Menu.statusMenuBar.data[0].hidden="true";
Menu.statusMenuBar.data[1].hidden="true";
Menu.statusMenuBar.data[2].hidden="true";
Menu.statusMenuBar.data[3].hidden="true";
Menu.statusMenuBar.data[5].hidden="true";
Menu.statusMenuBar.data[4].imgClass="tickMark";
}else{
setSelectedFormula();
}
if(Menu["statusMenuBar"]){
showMenu("statusMenuBar");
}
}
function setSelectedFormula(){
if(Menu.statusMenuBar!=undefined){
if(defAutoFormulaIdx=="Sum"){
Menu.statusMenuBar.data[0].imgClass="tickMark";
Menu.statusMenuBar.data[1].imgClass="";
Menu.statusMenuBar.data[2].imgClass="";
Menu.statusMenuBar.data[3].imgClass="";
Menu.statusMenuBar.data[4].imgClass="";
Menu.statusMenuBar.data[5].imgClass="";
}else{
if(defAutoFormulaIdx=="Average"){
Menu.statusMenuBar.data[0].imgClass="";
Menu.statusMenuBar.data[1].imgClass="tickMark";
Menu.statusMenuBar.data[2].imgClass="";
Menu.statusMenuBar.data[3].imgClass="";
Menu.statusMenuBar.data[4].imgClass="";
Menu.statusMenuBar.data[5].imgClass="";
}else{
if(defAutoFormulaIdx=="Minimum"){
Menu.statusMenuBar.data[0].imgClass="";
Menu.statusMenuBar.data[1].imgClass="";
Menu.statusMenuBar.data[2].imgClass="tickMark";
Menu.statusMenuBar.data[3].imgClass="";
Menu.statusMenuBar.data[4].imgClass="";
Menu.statusMenuBar.data[5].imgClass="";
}else{
if(defAutoFormulaIdx=="Maximum"){
Menu.statusMenuBar.data[0].imgClass="";
Menu.statusMenuBar.data[1].imgClass="";
Menu.statusMenuBar.data[2].imgClass="";
Menu.statusMenuBar.data[3].imgClass="tickMark";
Menu.statusMenuBar.data[4].imgClass="";
Menu.statusMenuBar.data[5].imgClass="";
}else{
if(defAutoFormulaIdx=="Count"){
Menu.statusMenuBar.data[0].imgClass="";
Menu.statusMenuBar.data[1].imgClass="";
Menu.statusMenuBar.data[2].imgClass="";
Menu.statusMenuBar.data[3].imgClass="";
Menu.statusMenuBar.data[4].imgClass="tickMark";
Menu.statusMenuBar.data[5].imgClass="";
}else{
if(defAutoFormulaIdx=="Count Numbers"){
Menu.statusMenuBar.data[0].imgClass="";
Menu.statusMenuBar.data[1].imgClass="";
Menu.statusMenuBar.data[2].imgClass="";
Menu.statusMenuBar.data[3].imgClass="";
Menu.statusMenuBar.data[4].imgClass="";
Menu.statusMenuBar.data[5].imgClass="tickMark";
}
}
}
}
}
}
}
}
function updateFormulaStatusBar(_2093,_2094){
if(isContinousString){
_2093="Count";
if(autoFormulas[_2093]!=0){
initialStatusText="<div style='float:left;cursor:pointer' id ='initialStatusText' onclick='showStatusBarMenu()'><div style='float:left'>"+jsMsg[_2093]+"</div><div style='float:left;' id='totalSum'> = "+autoFormulas[_2093]+"</div></div>"+"<div id ='arrowImg' onclick='showStatusBarMenu()' style='float:right;padding:2px 0px 0px 0px;margin:3px 0px 0px 5px;cursor:pointer;'><img id='' src='"+IMAGE_PATH+"spacer.gif' class='arrowUpDown' /></div>";
setStatusText(initialStatusText);
var _2095=getObj("totalSum");
var _2096=getObj("initialStatusText");
if(_2095!=null&&_2096!=null){
_2095.className="";
setAutoSumValue(autoFormulas[_2093]);
}
}
return;
}
defAutoFormulaIdx=_2093;
initialStatusText="<div style='float:left;cursor:pointer' id ='initialStatusText' onclick='showStatusBarMenu()'><div style='float:left'>"+(defAutoFormulaIdx=="Count Numbers"?jsMsg["CountNumbers"]:jsMsg[defAutoFormulaIdx])+"</div><div style='float:left' id='totalSum'> = "+autoFormulas[defAutoFormulaIdx]+"</div></div>"+"<div id ='arrowImg' onclick='showStatusBarMenu()' style='float:right;padding:2px 0px 0px 0px;margin:3px 0px 0px 5px;cursor:pointer;'><img id='' src='"+IMAGE_PATH+"spacer.gif' class='arrowUpDown' /></div>";
setStatusText(initialStatusText);
var _2095=getObj("totalSum");
var _2096=getObj("initialStatusText");
if(_2095!=null&&_2096!=null){
if(defAutoFormulaIdx=="Sum"){
_2095.className="";
if(firstCellFormat=="PERCENT"){
setAutoSumValue(autoFormulas[defAutoFormulaIdx],"%");
}else{
setAutoSumValue(autoFormulas[defAutoFormulaIdx]);
}
}else{
if(defAutoFormulaIdx=="Average"){
_2095.className="";
if(firstCellFormat=="PERCENT"){
setAutoSumValue(autoFormulas[defAutoFormulaIdx],"%");
}else{
setAutoSumValue(autoFormulas[defAutoFormulaIdx]);
}
}else{
if(defAutoFormulaIdx=="Minimum"){
_2095.className="";
if(firstCellFormat=="PERCENT"){
setAutoSumValue(autoFormulas[defAutoFormulaIdx],"%");
}else{
setAutoSumValue(autoFormulas[defAutoFormulaIdx]);
}
}else{
if(defAutoFormulaIdx=="Maximum"){
_2095.className="";
if(firstCellFormat=="PERCENT"){
setAutoSumValue(autoFormulas[defAutoFormulaIdx],"%");
}else{
setAutoSumValue(autoFormulas[defAutoFormulaIdx]);
}
}else{
if(defAutoFormulaIdx=="Count"){
_2095.className="";
setAutoSumValue(autoFormulas[defAutoFormulaIdx]);
}else{
if(defAutoFormulaIdx=="Count Numbers"){
_2095.className="";
setAutoSumValue(autoFormulas[defAutoFormulaIdx]);
}
}
}
}
}
}
}
}
function calcAutoFormulas(){
if(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE){
return;
}
var _2097;
var _2098=undefined;
var _2099=undefined;
var _209a=0;
var _209b=0;
var _209c=0;
isContinousString=true;
isCellInTextFormat=false;
_209d=undefined;
if(!jsGADGET_VIEW){
for(var name in autoFormulas){
autoFormulas[name]=0;
}
var _209f=getCellRange();
initialStatusText="<div style='float:left;cursor:pointer' id ='initialStatusText' onclick='showStatusBarMenu()'><div style='float:left'>"+(defAutoFormulaIdx=="Count Numbers"?jsMsg["CountNumbers"]:jsMsg[defAutoFormulaIdx])+"</div><div style='float:left' id='totalSum'> = "+summedValue+"</span></div>"+"<div id ='arrowImg' onclick='showStatusBarMenu()' style='float:right;padding:2px 0px 0px 0px;margin:3px 0px 0px 5px;cursor:pointer;'><img id='' src='"+IMAGE_PATH+"spacer.gif' class='arrowUpDown' /></div>";
var _20a0=getObj("status");
if(_20a0!=null){
var _20a1=getStatusText();
if(_20a1.length>0){
if(_20a1.indexOf("id")>-1){
_20a1=_20a1.substring(_20a1.indexOf("id"),_20a1.length);
_20a1=_20a1.substring(_20a1.indexOf("=")+1,_20a1.length);
_20a1=_20a1.substring(0,_20a1.indexOf(">"));
if(_20a1.indexOf("\"")>-1){
_20a1=_20a1.substring(1,_20a1.length-1);
}
if(_20a1!="totalSum"){
setStatusText(initialStatusText);
}
}else{
setStatusText(initialStatusText);
}
}else{
setStatusText(initialStatusText);
}
}
totalSumObj=getObj("totalSum");
loaderImgObj=getObj("loadIcon");
var _20a2=getObj("initialStatusText");
var _20a3=getObj("arrowImg");
statusBarSumObj=totalSumObj.parentNode;
statusBarLoadIconObj=loaderImgObj.parentNode;
if((_209f.startRow>=getAvailableStartRow())&&(_209f.endRow<=getAvailableEndRow())){
if(!Row.isHidden(_209f.startRow)){
var _20a4=getCell(_209f.startRow,_209f.startCol);
var _20a5=_209f.startCol;
if(_20a4==null){
while(_20a4==null&&_20a5>=0){
_20a5-=1;
_20a4=getCell(_209f.startRow,_20a5);
}
}
}
_20a4=getCell(_209f.startRow,_20a5);
if(!Row.isHidden(_209f.startRow)&&_20a4){
var _20a6=_20a4.getAttribute("format");
if(_20a6!=null&&_20a6!="null"){
_209d=_20a4.getAttribute("format").toUpperCase();
}else{
_209d="STANDARD";
}
}else{
var _209d="STANDARD";
}
var _20a7=getCurrencySymbol(_209d);
var eR=_209f.endRow;
var eC=_209f.endCol;
if(_209f.startRow<usedCursRow&&eR>usedCursRow){
eR=usedCursRow;
}
if(_209f.startCol<usedCursCol&&eC>usedCursCol){
eC=usedCursCol;
}
var range=new Range(_209f.startRow,_209f.startCol,eR,eC);
var iter=range.getIterator();
iter.iterate(function(row,col){
var cell=getCell(row,col);
if(typeof cell!="undefined"&&cell!=null){
var _20af=getCellFunctionValueWOF(cell);
var _20b0=cell.getAttribute("format");
if(_20af!=null){
var _20b1=_20af.replace(/\,/g,"");
if(!isNaN(_20b1)){
_20af=_20b1;
}
}
if(_209d!="PERCENT"&&(col>_209f.startRow||col>_209f.startCol)&&_20b0=="PERCENT"){
_20af=_20af/100;
}else{
if(_209d=="PERCENT"&&(col>_209f.startRow||col>_209f.startCol)&&_20b0!="PERCENT"){
_20af=_20af*100;
}
}
if(_20b0=="EURO"){
_20af=_20af/100;
}
if(_20b0=="FRACTION"){
isCellInTextFormat=false;
if(isStr(_20af)&&_20af.indexOf(" ")>0){
if(_20af.indexOf("-")>=0){
isNegativeNo=true;
}
var _20b2=_20af.split(" ");
var _20b3=_20b2[0];
if(_20b3.indexOf("-")>=0){
minusPos=_20b3.indexOf("-");
_20b3=_20b3.substring(minusPos+1,_20b3.length);
}
var _20b4=_20b2[1];
if(_20b4.indexOf("-")>=0){
minusPos=_20b4.indexOf("-");
_20b4=_20b4.substring(minusPos+1,_20b4.length);
}
if(!isNaN(_20b4)){
_20b4=eval(_20b4);
}
var sum=parseFloat(_20b3)+parseFloat(_20b4);
if(isNegativeNo){
sum=-sum;
isNegativeNo=false;
}
_20af=sum;
}
}
if(_20af!=null){
if(_20af!="NULL"){
_209b=_209b+1;
autoFormulas["Count"]=_209b;
}
if(isNaN(_20af)){
isCellInTextFormat=true;
}else{
if(_20af!=""){
if(_2098==undefined){
_2098=_20af;
}
if(_2099==undefined){
_2099=_20af;
}
}
}
}
if(_20af==""){
isCellInTextFormat=true;
}
var _20b6=loaderImgObj.style.display;
if(_20b0!="DATE"&&!isCellInTextFormat){
_209a=_209a+1;
}
if(!isCellInTextFormat){
for(var name in autoFormulas){
switch(name){
case "Sum":
autoFormulas[name]+=parseFloat(_20af);
summedValue=autoFormulas[name];
if(_20b6=="block"){
loaderImgObj.style.display="none";
}
break;
case "Average":
_2097=parseFloat(summedValue)/_209a;
autoFormulas[name]=(parseFloat(_2097)).toFixed(2);
if(_20b6=="block"){
loaderImgObj.style.display="none";
}
break;
case "Minimum":
autoFormulas[name]=Math.min(_20af,_2098);
_2098=autoFormulas[name];
if(_20b6=="block"){
loaderImgObj.style.display="none";
}
break;
case "Maximum":
autoFormulas[name]=Math.max(_20af,_2099);
_2099=autoFormulas[name];
if(_20b6=="block"){
loaderImgObj.style.display="none";
}
break;
case "Count":
if(_20b6=="block"){
loaderImgObj.style.display="none";
}
break;
case "Count Numbers":
autoFormulas[name]=_209a;
if(_20b6=="block"){
loaderImgObj.style.display="none";
}
}
}
isCellValueEmpty=false;
if(isContinousString){
isContinousString=false;
}
updateFormulaStatusBar(defAutoFormulaIdx,_209d);
}else{
if(isContinousString&&isCellInTextFormat&&_20af!="NULL"){
_209c=_209c+1;
initialStatusText="<div style='float:left;' id ='initialStatusText' onclick='showStatusBarMenu()'><div style='float:left'>"+jsMsg["Count"]+"</div><div style='float:left' id='totalSum'> = "+_209c+"</div></div>"+"<div onclick='showStatusBarMenu()' style='float:right;padding:2px 0px 0px 0px;margin:3px 0px 0px 5px;cursor:pointer;'><img id='' src='"+IMAGE_PATH+"spacer.gif' class='arrowUpDown' /></div>";
autoFormulas["Count"]=_209c;
summedValue=autoFormulas["Count"];
updateFormulaStatusBar();
if(_20b6=="block"){
loaderImgObj.style.display="none";
}
isCellValueEmpty=false;
}
}
isCellInTextFormat=false;
}
});
if(!isCellValueEmpty){
isCellValueEmpty=true;
}else{
if(totalSumObj!=null){
totalSumObj.className="";
summedValue="";
setAutoSumValue(summedValue);
}
}
}else{
if(!isUndefined(fCRIntvl)){
if(totalSumObj!=null){
totalSumObj.className="disabled";
}
if(loaderImgObj.style.display=="none"){
loaderImgObj.style.display="inline-block";
}
clearInterval(fCRIntvl);
}
fCRIntvl=setTimeout("showAutoFormulas("+_209f.startRow+", "+_209f.startCol+", "+_209f.endRow+", "+_209f.endCol+")",250);
}
if(summedValue==null||summedValue==""){
statusBarSumObj.style.visibility="hidden";
statusBarLoadIconObj.style.visibility="hidden";
}else{
statusBarSumObj.style.visibility="";
statusBarLoadIconObj.style.visibility="";
}
}
}
function showAutoFormulas(_20b8,_20b9,_20ba,_20bb){
var _20bc=getCellRange();
if(_20b8===undefined||_20b9===undefined||_20ba===undefined||_20bb===undefined){
return;
}
if(_20bc.startRow==_20b8&&_20bc.startCol==_20b9&&_20bc.endRow==_20ba&&_20bc.endCol==_20bb){
if(summedValue!=null){
if(totalSumObj!=null){
totalSumObj.className="disabled";
}
if(loaderImgObj.style.display=="none"){
loaderImgObj.style.display="inline-block";
}
}
var _20b8=_20bc.startRow;
var _20b9=_20bc.startCol;
var _20ba=_20bc.endRow;
var _20bb=_20bc.endCol;
var _20bd=new getXmlhttp();
_20bd.onreadystatechange=function(){
if(_20bd.readyState==4){
var _20be=eval("("+_20bd.responseText+")");
var _20bf=_20be["sR"];
var _20c0=_20be["sC"];
var endR=_20be["eR"];
var endC=_20be["eC"];
var sum=_20be["sum"];
if(sum!=undefined){
setAutoFormulas(_20bf,_20c0,endR,endC,JSON.parse(sum));
}else{
summedValue="";
setAutoFormulas(_20bf,_20c0,endR,endC);
}
}
};
var _20c4="startRow="+_20b8+"&startCol="+_20b9+"&endRow="+_20ba+"&endCol="+_20bb;
_20c4+="&currentTime="+CURRENTTIME+"&currentSheet="+encodeURIComponent(CURRSHEETNAME)+"&documentId="+DOCUMENT_ID+"&action="+"rangesum";
_20c4+="&view="+getObj("VIEW").value+"&docOwner="+CURR_DOC_OWNERNAME;
sendXMLHTTPRequest(_20bd,_20c4,true,true,ctxpath+"autosum.do");
}else{
clearInterval(fCRIntvl);
}
}
function setAutoFormulas(_20c5,_20c6,endR,endC,sum){
var _20ca=getCellRange();
if((_20ca.startRow==_20c5)&&(_20ca.startCol==_20c6)&&(_20ca.endRow==endR)&&(_20ca.endCol==endC)){
if(sum!=undefined){
summedValue=sum[defAutoFormulaIdx];
}
if(totalSumObj!=null){
setAutoSumValue(summedValue);
totalSumObj.className="";
}
if(loaderImgObj!=null){
loaderImgObj.style.display="none";
}
if(sum!=undefined){
if(sum["Count Numbers"]!=undefined&&sum["Count Numbers"]!=0){
for(var name in autoFormulas){
autoFormulas[name]=sum[name];
}
isContinousString=false;
}else{
isContinousString=true;
autoFormulas["Count"]=sum["Count"];
summedValue=sum["Count"];
}
}
updateFormulaStatusBar(defAutoFormulaIdx,"");
if(summedValue==null||summedValue==""){
statusBarSumObj.style.visibility="hidden";
}else{
statusBarSumObj.style.visibility="";
}
}
}
function resetAutoFormulas(){
if(jsGADGET_VIEW){
return;
}
if(Menu["statusMenuBar"]){
hideMenu("statusMenuBar");
var _20cc="<menu id='statusMenuBar' forElement='status'  onClose='menuClose(ev)'>";
_20cc+="</menu>";
Menu.create(_20cc,{inputType:"xml"});
}
for(var name in autoFormulas){
autoFormulas[name]=0;
}
if(getStatusText()!=jsMsg.UpdatingFormulas){
setStatusText("");
}
if(loaderImgObj!=undefined){
loaderImgObj.style.display="none";
}
summedValue="";
isContinousString=true;
}
function clearCellRangeFill(){
currFocusFld="";
isFuncDlgOpen=false;
rangeFill=false;
formulaCell=false;
isExprFunc=false;
hideCellRangeFillDIV();
ActiveFormulaInfo.reset();
cellRangeStartRow=currRow;
cellRangeStartCol=currCol;
cellRangeEndRow=currRow;
cellRangeEndCol=currCol;
isRangeSelection=false;
formulaSIdxTemp=0;
formulaEIdxTemp=0;
}
function hideFlashDIV(){
if(isSSActive){
hideCellRangeFillDIV();
}
}
function resetCellRangeFill(isKey){
if(isSSActive){
currFunCell="";
rangeFill=false;
hideCellRangeFillDIV();
if(typeof isKey=="undefined"||isKey=="close"||isKey=="copy"){
if(formulaCell&&!isExprFunc){
setCaretPos(cellField,tempPos);
}else{
if(isExprFunc||isFuncDlgOpen){
if(formulaCell||(isCellEdited()&&cellField.value.indexOf("=")==0)){
if(formulaEIdxTemp>0){
setCaretPos(cellField,formulaEIdxTemp);
}
}else{
if(formulaEIdxTemp>0){
setCaretPos(exprField,formulaEIdxTemp);
}
}
}else{
if(isKey=="copy"){
copyStatus=false;
cutStatus=false;
}else{
setCaretPos(exprField,tempPos);
}
}
}
}
}
}
function focusCellRangeInit(ev){
resetCellRangeFill();
clearTextSelection();
var el=(browser_ie)?window.event.srcElement:ev.target;
rangeFill=true;
var _20d1=(browser_ie&&(el.className==="filterIconContainer"));
if((el&&isCell(el))||isCellRangeFlashInnerDIV(el)||isFocusDIV(el.id)||isTransSPAN(el.id)||_20d1){
var row=getRowPosInMouseEvent(ev);
var col=getColPosInMouseEvent(ev);
if(ev.shiftKey){
var info=ActiveFormulaInfo;
if(info.isAvailable()){
var _20d5=info.getStartRow();
var _20d6=info.getStartCol();
}else{
ActiveFormulaInfo.set(row,col);
var _20d5=row;
var _20d6=col;
}
focusCellRangeFill(_20d5,_20d6,row,col);
}else{
ActiveFormulaInfo.set(row,col);
var info=ActiveFormulaInfo;
var _20d5=info.getStartRow();
var _20d6=info.getStartCol();
funRow=_20d5;
funCol=_20d6;
functionLeft=info.getLeft();
functionTop=info.getTop();
focusCellRangeFill(_20d5,_20d6,_20d5,_20d6);
}
}
if(browser_ie){
document.attachEvent("onmousemove",selectCellRangeFill);
document.attachEvent("onmouseup",endCellRangeFill);
}else{
document.addEventListener("mousemove",selectCellRangeFill,false);
document.addEventListener("mouseup",endCellRangeFill,false);
}
}
var funRow="";
var funCol="";
var functionLeft=-1;
var functionTop=-1;
function selectCellRangeFill(ev){
clearTextSelection();
var el=(browser_ie)?window.event.srcElement:ev.target;
var _20d9=getCursorPos(ev);
if(ISFREEZED){
if(_20d9.x>sheetLeft+findSecondPaneXPos()){
var x=_20d9.x-sheetLeft+getSheetScrollLeft();
}else{
var x=_20d9.x-sheetLeft;
}
if(_20d9.y>sheetTop+findThirdPaneYPos()){
var y=_20d9.y-sheetTop+getSheetScrollTop();
}else{
var y=_20d9.y-sheetTop;
}
}else{
var x=_20d9.x-sheetLeft+getSheetScrollLeft();
var y=_20d9.y-sheetTop+getSheetScrollTop();
}
var info=ActiveFormulaInfo;
var _20dd=info.getActiveRow();
var _20de=info.getActiveCol();
if(x>getColLeft(_20de)){
var _20df=(x>functionLeft)?increaseReqCellLeft(x,funCol,functionLeft):decreaseReqCellLeft(x,funCol,functionLeft);
funCol=_20df.col;
functionLeft=_20df.left;
}else{
var _20df=(x<functionLeft)?decreaseReqCellLeft(x,funCol,functionLeft):increaseReqCellLeft(x,funCol,functionLeft);
funCol=_20df.col;
functionLeft=_20df.left;
}
if(y>getRowTop(_20dd)){
var _20e0=(y>functionTop)?increaseReqCellTop(y,funRow,functionTop):decreaseReqCellTop(y,funRow,functionTop);
funRow=_20e0.row;
functionTop=_20e0.top;
}else{
var _20e0=(y<functionTop)?decreaseReqCellTop(y,funRow,functionTop):increaseReqCellTop(y,funRow,functionTop);
funRow=_20e0.row;
functionTop=_20e0.top;
}
if(isMouseCursorYInOutOfViewPort(y)){
scrollSheetVertical(y,"FORMULAFILL");
}else{
if(typeof sheetScrollTopId!="undefined"){
clearInterval(sheetScrollTopId);
}
focusCellRangeFill(info.getStartRow(),info.getStartCol(),funRow,funCol);
}
if(isMouseCursorXInOutOfViewPort(x)){
scrollSheetHorizontal(x,"FORMULAFILL");
}else{
if(typeof sheetScrollLeftId!="undefined"){
clearInterval(sheetScrollLeftId);
}
focusCellRangeFill(info.getStartRow(),info.getStartCol(),funRow,funCol,true);
}
if(isFuncDlgOpen||isRangeEdit||isChartDialogOpened||isNameDialogOpened||isPivotDialogOpen||isEditPivotDialogOpen||(isConditionalDialogOpen&&(cfinputElem==null))||Solver.dialog){
if(Solver.dialog){
$("#SolverDialog").parent().parent().hide();
}
hideDialog();
if(isEditPivotDialogOpen){
clearTextSelection();
}
}
}
function endCellRangeFill(ev){
if(isFuncDlgOpen||isRangeEdit||isChartDialogOpened||isNameDialogOpened||isPivotDialogOpen||isEditPivotDialogOpen||(isConditionalDialogOpen&&(cfinputElem==null))||Solver.dialog){
if(Solver.dialog){
$("#SolverDialog").parent().parent().show();
}
recallDialog();
if(isFuncDlgOpen){
if(typeof prevFuncRow!="undefined"){
prevFuncRow.className="hover";
}
}
if(isConditionalDialogOpen){
resetRules();
}
}
if(browser_ie){
document.detachEvent("onmousemove",selectCellRangeFill);
document.detachEvent("onmouseup",endCellRangeFill);
}else{
document.removeEventListener("mousemove",selectCellRangeFill,false);
document.removeEventListener("mouseup",endCellRangeFill,false);
}
isCellSelection=false;
isScrollTopSet=false;
isScrollLeftSet=false;
if(typeof sheetScrollLeftId!="undefined"){
clearInterval(sheetScrollLeftId);
}
if(typeof sheetScrollTopId!="undefined"){
clearInterval(sheetScrollTopId);
}
if(rangeFill){
var _20e2=false;
var info=ActiveFormulaInfo;
var _20e4=info.getStartCol();
var _20e5=info.getStartRow();
var _20e6=info.getEndCol();
var _20e7=info.getEndRow();
if(_20e4==cellRangeStartCol&&_20e6==cellRangeEndCol&&_20e5==cellRangeStartRow&&_20e7==cellRangeEndRow){
_20e2=info.isMerged();
}
if(_20e2||(_20e4==cellRangeStartCol&&_20e6==cellRangeEndCol&&_20e5==cellRangeStartRow&&_20e7==cellRangeEndRow)){
if(isNameDialogOpened||(isConditionalDialogOpen&&(cfinputElem!=null))){
cellVal=constructCellName(_20e5,_20e4);
if(cfinputElem!=null){
if(cfinputVal==null){
cfinputVal=$(cfinputElem).val();
$(cfinputElem).val(cfinputVal+cellVal);
}else{
$(cfinputElem).val(cfinputVal+cellVal);
}
$(cfinputElem).focus();
}
}else{
cellVal=getCellLabel(_20e5,_20e4);
}
}else{
var er,ec,sr,sc;
if(cellRangeStartRow>cellRangeEndRow){
sr=cellRangeEndRow;
er=cellRangeStartRow;
}else{
er=cellRangeEndRow;
sr=cellRangeStartRow;
}
if(cellRangeStartCol>cellRangeEndCol){
sc=cellRangeEndCol;
ec=cellRangeStartCol;
}else{
ec=cellRangeEndCol;
sc=cellRangeStartCol;
}
if(isNameDialogOpened||(isConditionalDialogOpen&&(cfinputElem!=null))){
cellVal=constructCellName(sr,sc,er,ec);
if(cfinputElem!=null){
if(cfinputVal==null){
cfinputVal=$(cfinputElem).val();
$(cfinputElem).val(cfinputVal+cellVal);
}else{
$(cfinputElem).val(cfinputVal+cellVal);
}
$(cfinputElem).focus();
}
}else{
cellVal=getCellLabel(sr,sc)+":"+getCellLabel(er,ec);
}
}
insertCellRange(cellVal);
if(formulaCell&&!isExprFunc){
}else{
if((isExprFunc||(isFuncDlgOpen&&getObj("funcList")!=null))&&!isChartDialogOpened){
if(formulaCell||(isCellEdited()&&cellField.value.indexOf("=")==0)){
if(formulaEIdxTemp>0){
setCaretPos(cellField,formulaEIdxTemp);
}
}else{
if(formulaEIdxTemp>0){
setCaretPos(exprField,formulaEIdxTemp);
}
}
}else{
if(isChartDialogOpened&&getObj("chartDataDIV")!=null&&getObj("chartDataDIV").style.display!="none"){
if(formulaEIdxTemp>0){
var _20ec=getObj("dataRange");
setCaretPos(_20ec,formulaEIdxTemp);
}
}
}
}
}
if(isConditionalDialogOpen&&(cfinputElem==null)){
var _20ed=getObj("appliestofield");
if(cellVal.indexOf(":")==-1){
cellVal=cellVal+":"+cellVal;
}
_20ed.value=CURRSHEETNAME+"."+cellVal;
var cfrng=getRangeValues(cellVal);
if(typeof (cfrng)!="undefined"){
var sR=cfrng.startRow;
var sC=cfrng.startCol;
var eR=cfrng.endRow;
var eC=cfrng.endCol;
var _20f3="&sheetname="+encodeURIComponent(CURRSHEETNAME)+"&action="+ActionConstants.CONDITIONAL_FORMAT_READ_RANGE+"&sR="+sR+"&eR="+eR+"&sC="+sC+"&eC="+eC+"&rowHeight="+"";
sendCFormatRequest(_20f3,false);
}
}
}
var formulaSIdxTemp=0;
var formulaEIdxTemp=0;
var formulaKeyPressed=false;
function insertCellRange(val){
var _20f5="";
if(typeof val=="undefined"){
var _20f6=false;
var info=ActiveFormulaInfo;
var _20f8=info.getStartCol();
var _20f9=info.getStartRow();
var _20fa=info.getEndCol();
var _20fb=info.getEndRow();
if(_20f8==cellRangeStartCol&&_20fa==cellRangeEndCol&&_20f9==cellRangeStartRow&&_20fb==cellRangeEndRow){
_20f6=info.isMerged();
}
if(_20f6||(_20f8==cellRangeStartCol&&_20fa==cellRangeEndCol&&_20f9==cellRangeStartRow&&_20fb==cellRangeEndRow)){
if(isNameDialogOpened||Solver.dialog){
_20f5=constructCellName(cellRangeStartRow,cellRangeStartCol);
}else{
_20f5=getCellLabel(cellRangeStartRow,cellRangeStartCol);
}
}else{
var er,ec,sr,sc;
if(cellRangeStartRow>cellRangeEndRow){
sr=cellRangeEndRow;
er=cellRangeStartRow;
}else{
er=cellRangeEndRow;
sr=cellRangeStartRow;
}
if(cellRangeStartCol>cellRangeEndCol){
sc=cellRangeEndCol;
ec=cellRangeStartCol;
}else{
ec=cellRangeEndCol;
sc=cellRangeStartCol;
}
if(isNameDialogOpened||Solver.dialog){
_20f5=constructCellName(sr,sc,er,ec);
}else{
_20f5=getCellLabel(sr,sc)+":"+getCellLabel(er,ec);
}
}
}else{
_20f5=val;
if(Solver.dialog){
getObj("decisionVariable").value=CURRSHEETNAME+"!"+val;
}
}
if(editedFormulaCellInfo.cellFieldDetails.appendSheetName){
_20f5=CURRSHEETNAME+"!"+_20f5;
}
currFunCell=getCell(currRow,currCol);
funcFocusFld=exprField;
var st="";
var et="";
if((isExprFunc||(isFuncDlgOpen&&getObj("funcList")!=null))&&!isChartDialogOpened&&!isConditionalDialogOpen&&!(Solver.dialog)){
forRangeHidden=funcFocusFld.value;
if((cellRangeStartIdx>0||cellRangeEndfIdx>0)&&(cellRangeStartIdx<cellRangeEndfIdx)){
st=forRangeHidden.substring(0,cellRangeStartIdx);
if(forRangeHidden.length>=cellRangeEndfIdx){
et=forRangeHidden.substring(cellRangeEndfIdx,forRangeHidden.length);
}else{
et="";
}
forRangeHidden=st+et;
}else{
if((formulaSIdxTemp>0||formulaEIdxTemp>0)&&(formulaSIdxTemp!=formulaEIdxTemp)){
st=forRangeHidden.substring(0,formulaSIdxTemp);
et=forRangeHidden.substring(formulaEIdxTemp,forRangeHidden.length);
forRangeHidden=st+et;
tempPos=formulaSIdxTemp;
}
}
if(tempPos>=0){
st=forRangeHidden.substring(0,tempPos);
}else{
st="";
}
if(tempPos>0&&tempPos<forRangeHidden.length){
et=forRangeHidden.substring(tempPos,forRangeHidden.length);
}else{
et="";
}
forRangeHidden=st+_20f5+et;
if(forRangeHidden!=funcFocusFld.value){
cellField.value=forRangeHidden;
exprField.value=forRangeHidden;
if(!editedFormulaCellInfo.isOtherSheet){
setCellContent(currCell,funcFocusFld.value);
}
var _2102=tempPos+(_20f5.length);
formulaSIdxTemp=_2102-(_20f5.length);
formulaEIdxTemp=_2102;
}
}else{
if(((isCellEdited()&&cellField.value.indexOf("=")==0)||formulaCell)&&!isChartDialogOpened){
forRangeHidden=cellField.value;
if((cellRangeStartIdx>0||cellRangeEndfIdx>0)&&(cellRangeStartIdx!=cellRangeEndfIdx)){
st=forRangeHidden.substring(0,cellRangeStartIdx);
if(forRangeHidden.length>=cellRangeEndfIdx){
et=forRangeHidden.substring(cellRangeEndfIdx,forRangeHidden.length);
}else{
et="";
}
forRangeHidden=st+et;
tempPos=cellRangeStartIdx;
}else{
if((formulaSIdxTemp>0||formulaEIdxTemp>0)&&(formulaSIdxTemp!=formulaEIdxTemp)){
st=forRangeHidden.substring(0,formulaSIdxTemp);
et=forRangeHidden.substring(formulaEIdxTemp,forRangeHidden.length);
forRangeHidden=st+et;
tempPos=formulaSIdxTemp;
}
}
if(tempPos>=0){
st=forRangeHidden.substring(0,tempPos);
}else{
st="";
}
if(tempPos>0&&tempPos<forRangeHidden.length){
et=forRangeHidden.substring(tempPos,forRangeHidden.length);
}else{
et="";
}
forRangeHidden=st+_20f5+et;
if(forRangeHidden!=cellField.value){
cellField.value=forRangeHidden;
funcFocusFld.value=cellField.value;
var _2102=tempPos+(_20f5.length);
formulaSIdxTemp=_2102-(_20f5.length);
formulaEIdxTemp=_2102;
}
if(!editedFormulaCellInfo.isOtherSheet){
setCellFieldWidth();
}
setCaretPos(cellField,formulaEIdxTemp);
}else{
if(isRangeEdit){
var _2103=getObj(rangeEditText);
_2103.value=CURRSHEETNAME+"!"+_20f5;
if(!isDialogHidden){
_2103.focus();
}
_2103=null;
}else{
if(isPivotDialogOpen){
getObj("pivotDataRange").value=CURRSHEETNAME+"!"+_20f5;
getObj("pivotDataRange").focus();
}else{
if(isEditPivotDialogOpen){
getObj("editpivotDataRange").value=CURRSHEETNAME+"!"+_20f5;
getObj("editpivotDataRange").focus();
}else{
if(HYPERLINK.isRangeFocused){
var data=getObj("InternalUrl");
data.value=CURRSHEETNAME+"."+_20f5;
doSelection(data);
try{
setCaretPos(data,"END");
}
catch(e){
}
}else{
if(isChartDialogOpened&&getObj("chartDataDIV")!=null){
if(getObj("chartDataDIV").style.display!="none"){
var _2105=getObj("dataRange");
forRangeHidden=_2105.value;
if(forRangeHidden.indexOf(";")>=0){
if((cellRangeStartIdx>0||cellRangeEndfIdx>0)&&(cellRangeStartIdx!=cellRangeEndfIdx)){
st=forRangeHidden.substring(0,cellRangeStartIdx);
if(forRangeHidden.length>=cellRangeEndfIdx){
et=forRangeHidden.substring(cellRangeEndfIdx,forRangeHidden.length);
}else{
et="";
}
forRangeHidden=st+et;
}else{
if((formulaSIdxTemp>0||formulaEIdxTemp>0)&&(formulaSIdxTemp!=formulaEIdxTemp)){
st=forRangeHidden.substring(0,formulaSIdxTemp);
et=forRangeHidden.substring(formulaEIdxTemp,forRangeHidden.length);
forRangeHidden=st+et;
tempPos=formulaSIdxTemp;
}
}
if(tempPos>=0){
st=forRangeHidden.substring(0,tempPos);
}else{
st="";
}
if(tempPos>0&&tempPos<forRangeHidden.length){
et=forRangeHidden.substring(tempPos,forRangeHidden.length);
}else{
et="";
}
forRangeHidden=st+_20f5+et;
}else{
forRangeHidden=_20f5;
}
if(forRangeHidden!=_2105.value){
_2105.value=forRangeHidden;
var _2102=tempPos+(_20f5.length);
formulaSIdxTemp=_2102-(_20f5.length);
formulaEIdxTemp=_2102;
}
}
}else{
if(isNameDialogOpened||Solver.dialog){
var sheet=CURRSHEETNAME;
if(sheet.indexOf(" ")!=-1){
sheet="'"+sheet+"'";
}
if(FOCUSSEDNAMEINPUTOBJECT!=""){
FOCUSSEDNAMEINPUTOBJECT.value=ASSIGNEDTO="$"+sheet+"."+_20f5;
}
if(Solver.dialog){
getObj("decisionVariable").value="$"+sheet+"."+_20f5;
}
}
}
}
}
}
}
}
}
cellRangeStartIdx=0;
cellRangeEndfIdx=0;
}
function focusCellRangeFill(_2107,_2108,_2109,_210a,_210b){
if(_2107>=totRows||_2108>=totCols||(_2109>=totRows&&!isCellEdited()&&!isColSelected())||_210a>=totCols){
return;
}
if(_2108==-1){
rowSelection=true;
_2108=0;
}
if(_2107==-1){
colSelection=true;
_2107=0;
}
if(_2109<0||_210a<0){
return;
}
if(!colSelection){
var _210c=(_2108<_210a)?_2108:_210a;
var _210d=(_2108>_210a)?_2108:_210a;
var _210e=(_2107<_2109)?_2107:_2109;
var _210f=(_2107>_2109)?_2107:_2109;
var range=new Range(_210e,_210c,_210f,_210d);
Merge.extendRange(range);
_2107=range.startRow;
_2108=range.startCol;
_2109=range.endRow;
_210a=range.endCol;
}
var dim=getCellRangeDIM(_2107,_2108,_2109,_210a);
setCellRangeFillDIVPos(dim.left,dim.top);
setCellRangeFillDIVDim(dim.width,dim.height);
showCellRangeFillDIV();
var ev="";
if(!_210b){
if(colSelection&&rowSelection){
ev="WHOLESHEET";
}else{
if(rowSelection){
ev="ROW";
}else{
if(colSelection){
ev="COLUMN";
}
}
}
switch(ev){
case "WHOLESHEET":
break;
case "ROW":
scrollRowIntoView(_2109);
break;
case "COLUMN":
scrollColIntoView(_210a);
break;
default:
scrollCellIntoView(_2109,_210a);
break;
}
}
cellRangeStartRow=_2107;
cellRangeStartCol=_2108;
cellRangeEndRow=_2109;
cellRangeEndCol=_210a;
insertCellRange();
}
function resetFillRanges(field,_2114,_2115){
formulaSIdxTemp=formulaEIdxTemp=0;
cellRangeStartRow=currRow;
cellRangeStartCol=currCol;
cellRangeEndRow=-1;
cellRangeEndCol=-1;
return;
}
function insertCellRangeInit(){
if((isCellEdited()&&cellField.value.indexOf("=")==0)||formulaCell){
cellRangeStartIdx=getSelectionStart(cellField);
cellRangeEndfIdx=getSelectionEnd(cellField);
tempPos=getCaretPos(cellField);
}
if((isFuncDlgOpen&&getObj("funcList")!=null)||isExprFunc){
cellRangeStartIdx=getSelectionStart(exprField);
cellRangeEndfIdx=getSelectionEnd(exprField);
tempPos=getCaretPos(exprField);
if((isCellEdited()&&cellField.value.indexOf("=")==0)||formulaCell){
cellRangeStartIdx=getSelectionStart(cellField);
cellRangeEndfIdx=getSelectionEnd(cellField);
tempPos=getCaretPos(cellField);
}
}
if(isChartDialogOpened){
if(getObj("chartDataDIV")!=null&&getObj("chartDataDIV").style.display!="none"){
var _2116=getObj("dataRange");
cellRangeStartIdx=getSelectionStart(_2116);
cellRangeEndfIdx=getSelectionEnd(_2116);
tempPos=getCaretPos(_2116);
}
}
if(isConditionalDialogOpen&&(cfinputElem==null)){
var _2117=getObj("appliestofield");
cellRangeStartIdx=getSelectionStart(_2117);
cellRangeEndfIdx=getSelectionEnd(_2117);
tempPos=getCaretPos(_2117);
}
if(HYPERLINK.isRangeFocused){
if(getObj("InternalUrl")!=null){
var Data=getObj("InternalUrl");
cellRangeStartIdx=getSelectionStart(Data);
cellRangeEndfIdx=getSelectionEnd(Data);
tempPos=getCaretPos(Data);
}
}
clearTextSelection();
}
function focusAllCells(ev){
if(!isCellFieldSPANHided()&&isPartOfArray(currRow,currCol,currRow,currCol)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
if(isCellEdited()&&!isFormulaCell()){
submitCell();
}
if((isCellEdited()&&cellField.value.indexOf("=")==0)||formulaCell||isExprFunc||(isFuncDlgOpen&&getObj("funcList")!=null)||isRangeEdit||(isChartDialogOpened&&getObj("chartDataDIV")!=null&&getObj("chartDataDIV").style.display!="none")||isPivotDialogOpen||isEditPivotDialogOpen||HYPERLINK.isRangeFocused){
insertCellRangeInit();
focusCellRangeInit(ev);
focusCellRangeFill(-1,-1,totRows-1,totCols-1);
}else{
focusCellRange(-1,-1,totRows-1,totCols-1,"WHOLESHEET");
}
isColumnSelected=true;
applyFormatting();
}
function increaseReqCellLeft(x,_211b,_211c){
if(_211b<totCols-1){
while(x>_211c){
if(_211b<totCols-1){
_211b+=1;
_211c=getEndLeftOfCol(_211b);
}else{
break;
}
}
}
return {col:_211b,left:_211c};
}
function increaseReqCellTop(y,_211e,_211f){
if(_211e<totRows-1){
while(y>_211f){
if(_211e<totRows-1){
_211e+=1;
_211f=getEndTopOfRow(_211e);
}else{
break;
}
}
}
return {row:_211e,top:_211f};
}
function decreaseReqCellLeft(x,_2121,_2122){
if(_2121>0){
while(x<(_2122-getColWidth(_2121))){
if(_2121>0){
_2121-=1;
_2122=getEndLeftOfCol(_2121);
}else{
break;
}
}
}
return {col:_2121,left:_2122};
}
function decreaseReqCellTop(y,_2124,_2125){
if(_2124>0){
while(y<(_2125-getRowHeight(_2124))){
if(_2124>0){
_2124-=1;
_2125=getEndTopOfRow(_2124);
}else{
break;
}
}
}
return {row:_2124,top:_2125};
}
function setQuadName(from){
var _2127=getCellRange();
if((from!=quadName)&&(quadName=="FIRST")){
blurCellRange(selRow+1,selCol+1,_2127.endRow,_2127.endCol);
}else{
if((from!=quadName)&&(quadName=="SECOND")){
blurCellRange(selRow+1,_2127.startCol,_2127.endRow,selCol-1);
}else{
if((from!=quadName)&&(quadName=="THIRD")){
blurCellRange(_2127.startRow,_2127.startCol,selRow-1,selCol-1);
}else{
if((from!=quadName)&&(quadName=="FOURTH")){
blurCellRange(_2127.startRow,selCol+1,selRow-1,_2127.endCol);
}
}
}
}
quadName=from;
}
function getCellRangeDIM(_2128,_2129,_212a,_212b){
var _212c=(browser_ie)?1:2;
if(_2129<=_212b){
var x1=getColLeft(_2129);
var x2=getColLeft(_212b)+getColWidth(_212b);
}else{
var x1=getColLeft(_212b);
var x2=getColLeft(_2129)+getColWidth(_2129);
}
if(_2128<_212a){
var y1=getRowTop(_2128);
var y2=getRowTop(_212a)+getRowHeight(_212a);
}else{
var y1=getRowTop(_212a);
var y2=getRowTop(_2128)+getRowHeight(_2128);
}
return {left:x1,width:(x2-x1),top:y1,height:(y2-y1)};
}
function setCurrCellIndicator(_2131,_2132,_2133,_2134){
currCellRange="R"+_2131+"C"+_2132+":R"+_2133+"C"+_2134;
setCellFieldSPAN();
currCellIndicator.title="";
if(_2131-_2133==0&&_2132-_2134==0){
currCellIndicator.value=getColHeadLabel(_2134+1)+(_2133+1);
}else{
if(_2131<=_2133&&_2132<=_2134){
currCellIndicator.value=(_2133-_2131+1)+"R x "+(_2134-_2132+1)+"C";
}else{
if(_2133<_2131&&_2134<_2132){
currCellIndicator.value=(_2131-_2133+1)+"R x "+(_2132-_2134+1)+"C";
}else{
if(_2131<=_2133&&_2132>_2134){
currCellIndicator.value=(_2133-_2131+1)+"R x "+(_2132-_2134+1)+"C";
}else{
if(_2133<_2131&&_2132<=_2134){
currCellIndicator.value=(_2131-_2133+1)+"R x "+(_2134-_2132+1)+"C";
}
}
}
}
}
if(_2131<=_2133){
var _2135=_2131;
var _2136=_2133;
}else{
var _2135=_2133;
var _2136=_2131;
}
if(_2132<=_2134){
var _2137=_2132;
var _2138=_2134;
}else{
var _2137=_2134;
var _2138=_2132;
}
selectedCellRange={startRow:_2135,endRow:_2136,startCol:_2137,endCol:_2138};
}
function setScrollSheetTop(y,ev,_213b){
if(getSheetScrollTop()>0){
var _213c,_213d,_213e,_213f;
switch(ev){
case "FILLSERIES":
selRow=((selRow-_213b)>=0)?(selRow-_213b):0;
if(selRow>=0){
_213c=beforeFillSeriesStartR;
_213d=beforeFillSeriesStartC;
_213e=selRow;
_213f=beforeFillSeriesEndC;
selectionTop=getEndTopOfRow(selRow);
focusCellRangeforAutoFill(_213c,_213d,_213e,_213f);
}
break;
case "SELECTION":
case "SELECTIONROW":
selRow=((selRow-_213b)>=0)?(selRow-_213b):0;
if(selRow>=0){
_213c=currRow;
_213d=currCol;
_213e=selRow;
_213f=selCol;
selectionTop=getEndTopOfRow(selRow);
if(isRowSelected()){
focusRow(_213c,_213e,"ROWINMOUSE");
}else{
focusCellRange(_213c,_213d,_213e,_213f,"INCREMENT");
}
}
break;
case "FORMULAFILL":
funRow=((funRow-_213b)>=0)?(funRow-_213b):0;
if(funRow>=0){
var info=ActiveFormulaInfo;
_213c=info.getActiveRow();
_213d=info.getActiveCol();
_213e=funRow;
_213f=funCol;
functionTop=getEndTopOfRow(funRow);
focusCellRangeFill(_213c,_213d,_213e,_213f);
}
break;
case "DRAG":
_213c=cellDragProps.cellDragRange.CSR;
_213d=cellDragProps.cellDragRange.CSC;
_213e=cellDragProps.cellDragRange.CER;
_213f=cellDragProps.cellDragRange.CEC;
if(_213c>0){
_213c-=_213b;
_213e=_213c+rowsInRange;
}
if(_213c<=0){
_213c=0;
_213e=_213c+rowsInRange;
selRow=_213c;
}
if(_213f<(totCols-1)){
_213f=selCol;
_213d=_213f-colsInRange;
setDragDIVPosAndDim(_213c,_213d,_213e,_213f);
}
cellDragProps.cellDragRange.CSR=_213c;
cellDragProps.cellDragRange.CER=_213e;
cellDragProps.cellDragRange.CSC=_213d;
cellDragProps.cellDragRange.CEC=_213f;
break;
}
if(ev!="DRAG"){
setSheetScrollDIM(_213c,_213e,_213d,_213f,"TOP");
}else{
setSheetScrollDIM(_213c,_213c,_213d,_213f,"TOP");
}
}else{
if(ev=="FORMULAFILL"){
if((funRow!=0)&&(funRow>0)){
var info=ActiveFormulaInfo;
_213c=info.getActiveRow();
_213d=info.getActiveCol();
funRow=0;
focusCellRangeFill(_213c,_213d,funRow,funCol);
}
}else{
if(ev=="DRAG"){
_213c=cellDragProps.cellDragRange.CSR;
_213d=cellDragProps.cellDragRange.CSC;
_213e=cellDragProps.cellDragRange.CER;
_213f=cellDragProps.cellDragRange.CEC;
if(_213c<=0){
_213c=0;
_213e=_213c+rowsInRange;
selRow=_213c;
cellDragProps.cellDragRange.CSR=_213c;
cellDragProps.cellDragRange.CER=_213e;
cellDragProps.cellDragRange.CSC=_213d;
cellDragProps.cellDragRange.CEC=_213f;
if(_213f<(totCols-1)){
_213f=selCol;
_213d=_213f-colsInRange;
setDragDIVPosAndDim(_213c,_213d,_213e,_213f);
}
}
}else{
if((selRow!=0)&&(selRow>0)){
selRow=0;
if(ev=="FILLSERIES"){
focusCellRangeforAutoFill(beforeFillSeriesStartR,beforeFillSeriesStartC,selRow,beforeFillSeriesEndC);
}else{
if(isRowSelected()){
focusRow(currRow,selRow,"ROWINMOUSE");
}else{
focusCellRange(currRow,currCol,selRow,selCol,"INCREMENT");
}
}
}
}
}
}
}
function setScrollSheetBottom(y,ev,_2143){
if((getSheetScrollHeight())>(getSheetScrollTop()+getSheetHeight())){
var _2144,_2145,_2146,_2147;
switch(ev){
case "FILLSERIES":
selRow=(selRow+_2143<totRows)?(selRow+_2143):(totRows-1);
if(selRow<totRows){
_2144=beforeFillSeriesStartR;
_2145=beforeFillSeriesStartC;
_2146=selRow;
_2147=beforeFillSeriesEndC;
selectionTop=getEndTopOfRow(selRow);
focusCellRangeforAutoFill(_2144,_2145,_2146,_2147);
}
if(selRow>=(totRows-1)){
appendBlankRows();
}
break;
case "SELECTION":
case "SELECTIONROW":
selRow=(selRow+_2143<totRows)?(selRow+_2143):(totRows-1);
if(selRow<totRows){
_2144=currRow;
_2145=currCol;
_2146=selRow;
_2147=selCol;
selectionTop=getEndTopOfRow(selRow);
if(isRowSelected()){
focusRow(_2144,_2146,"ROWINMOUSE");
}else{
focusCellRange(_2144,_2145,_2146,_2147,"INCREMENT");
}
}
if(selRow>=(totRows-1)){
appendBlankRows();
}
break;
case "FORMULAFILL":
funRow=(funRow+_2143<totRows)?(funRow+_2143):(totRows-1);
if(funRow<totRows){
var info=ActiveFormulaInfo;
_2144=info.getActiveRow();
_2145=info.getActiveCol();
_2146=funRow;
_2147=funCol;
functionTop=getEndTopOfRow(funRow);
focusCellRangeFill(_2144,_2145,_2146,_2147);
}
break;
case "DRAG":
_2144=cellDragProps.cellDragRange.CSR;
_2145=cellDragProps.cellDragRange.CSC;
_2146=cellDragProps.cellDragRange.CER;
_2147=cellDragProps.cellDragRange.CEC;
if(selCol<totCols){
_2147=selCol;
_2145=_2147-colsInRange;
}
if(_2146>=totRows){
appendBlankRows();
}
if(_2146<totRows){
_2144+=_2143;
_2146=_2144+rowsInRange;
}
setDragDIVPosAndDim(_2144,_2145,_2146,_2147);
cellDragProps.cellDragRange.CSR=_2144;
cellDragProps.cellDragRange.CER=_2146;
cellDragProps.cellDragRange.CSC=_2145;
cellDragProps.cellDragRange.CEC=_2147;
break;
}
setSheetScrollDIM(_2144,_2146,_2145,_2147,"BOTTOM");
}else{
if(ev=="FORMULAFILL"){
appendBlankRows();
if(funRow!=(totRows-1)&&(funRow<totRows-1)){
var info=ActiveFormulaInfo;
_2144=info.getActiveRow();
_2145=info.getActiveCol();
funRow=(totRows-1);
focusCellRangeFill(_2144,_2145,funRow,funCol);
}
}else{
if(ev=="DRAG"){
appendBlankRows();
}else{
appendBlankRows();
if(selRow!=(totRows-1)&&(selRow<totRows-1)){
selRow=(totRows-1);
if(ev=="FILLSERIES"){
focusCellRangeforAutoFill(beforeFillSeriesStartR,beforeFillSeriesStartC,selRow,beforeFillSeriesEndC);
}else{
if(isRowSelected()){
focusRow(currRow,selRow,"ROWINMOUSE");
}else{
focusCellRange(currRow,currCol,selRow,selCol,"INCREMENT");
}
}
}
}
}
}
}
function setScrollSheetRight(x,ev,_214b){
if((getSheetScrollWidth()+findSecondPaneXPos())>(getSheetScrollLeft()+getSheetWidth())){
var _214c,_214d,_214e,_214f;
switch(ev){
case "FILLSERIES":
selCol=(selCol+_214b<totCols)?(selCol+_214b):(totCols-1);
if(selCol<totCols){
_214c=beforeFillSeriesStartR;
_214d=beforeFillSeriesStartC;
_214e=beforeFillSeriesEndR;
_214f=selCol;
selectionLeft=getEndLeftOfCol(selCol);
focusCellRangeforAutoFill(_214c,_214d,_214e,_214f);
}
break;
case "SELECTION":
case "SELECTIONCOL":
selCol=(selCol+_214b<totCols)?(selCol+_214b):(totCols-1);
if(selCol<totCols){
_214c=currRow;
_214d=currCol;
_214e=selRow;
_214f=selCol;
selectionLeft=getEndLeftOfCol(selCol);
if(isColSelected()){
focusCol(_214d,_214f,"COLUMNINMOUSE");
}else{
focusCellRange(_214c,_214d,_214e,_214f,"INCREMENT");
}
}
break;
case "FORMULAFILL":
funCol=(funCol+_214b<totCols)?(funCol+_214b):(totCols-1);
if(funCol<totCols){
var info=ActiveFormulaInfo;
_214c=info.getActiveRow();
_214d=info.getActiveCol();
_214e=funRow;
_214f=funCol;
functionLeft=getEndLeftOfCol(funCol);
focusCellRangeFill(_214c,_214d,_214e,_214f);
}
break;
case "DRAG":
_214d=cellDragProps.cellDragRange.CSC;
_214f=cellDragProps.cellDragRange.CEC;
_214c=cellDragProps.cellDragRange.CSR;
_214e=cellDragProps.cellDragRange.CER;
if(_214f<totCols){
setDragDIVPosAndDim(_214c,_214d,_214e,_214f);
_214d+=_214b;
_214f=_214d+colsInRange;
if(_214f>=totCols){
_214f=totCols;
_214d=_214f-colsInRange;
selCol=_214f;
}
_214e=selRow;
_214c=_214e-rowsInRange;
cellDragProps.cellDragRange.CSC=_214d;
cellDragProps.cellDragRange.CEC=_214f;
}
break;
}
if(ev!="DRAG"){
setSheetScrollDIM(_214c,_214e,_214d,_214f,"RIGHT");
}else{
setSheetScrollDIM(_214c,_214e,_214f,_214f,"RIGHT");
if(_214f>=totCols){
_214f=totCols-1;
_214d=_214f-colsInRange;
selCol=_214f;
_214e=selRow;
_214c=_214e-rowsInRange;
setDragDIVPosAndDim(_214c,_214d,_214e,_214f);
}
}
}else{
if(ev=="FORMULAFILL"){
if(funCol!=(totCols-1)&&(funCol<totCols-1)){
var info=ActiveFormulaInfo;
_214c=info.getActiveRow();
_214d=info.getActiveCol();
funCol=totCols-1;
focusCellRangeFill(_214c,_214d,funRow,funCol);
}
}else{
if(ev=="DRAG"){
var _214d=cellDragProps.cellDragRange.CSC;
var _214f=cellDragProps.cellDragRange.CEC;
var _214c=cellDragProps.cellDragRange.CSR;
var _214e=cellDragProps.cellDragRange.CER;
_214e=selRow;
_214c=_214e-rowsInRange;
if(_214c<=0){
_214c=0;
_214e=_214c+rowsInRange;
}
setDragDIVPosAndDim(_214c,_214d,_214e,_214f);
}else{
if(selCol!=(totCols-1)&&(selCol<totCols-1)){
selCol=totCols-1;
if(ev=="FILLSERIES"){
focusCellRangeforAutoFill(beforeFillSeriesStartR,beforeFillSeriesStartC,beforeFillSeriesEndR,selCol);
}else{
if(isColSelected()){
focusCol(currCol,selCol,"COLUMNINMOUSE");
}else{
focusCellRange(currRow,currCol,selRow,selCol,"INCREMENT");
}
}
}
}
}
}
}
function setScrollSheetLeft(x,ev,_2153){
if(getSheetScrollLeft()>0){
var _2154,_2155,_2156,_2157;
switch(ev){
case "FILLSERIES":
selCol=(selCol-_2153>=0)?(selCol-_2153):0;
if(selCol>=0){
_2154=beforeFillSeriesStartR;
_2156=beforeFillSeriesStartC;
_2155=beforeFillSeriesEndR;
_2157=selCol;
selectionLeft=getEndLeftOfCol(selCol);
focusCellRangeforAutoFill(_2154,_2156,_2155,_2157);
}
break;
case "SELECTION":
case "SELECTIONCOL":
selCol=(selCol-_2153>=0)?(selCol-_2153):0;
if(selCol>=0){
_2154=currRow;
_2156=currCol;
_2155=selRow;
_2157=selCol;
selectionLeft=getEndLeftOfCol(selCol);
if(isColSelected()){
focusCol(_2156,_2157,"COLUMNINMOUSE");
}else{
focusCellRange(_2154,_2156,_2155,_2157,"INCREMENT");
}
}
break;
case "FORMULAFILL":
funCol=(funCol-_2153>=0)?(funCol-_2153):0;
if(funCol>=0){
var info=ActiveFormulaInfo;
_2154=info.getActiveRow();
_2156=info.getActiveCol();
_2155=funRow;
_2157=funCol;
functionLeft=getEndLeftOfCol(funCol);
focusCellRangeFill(_2154,_2156,_2155,_2157);
}
break;
case "DRAG":
_2156=cellDragProps.cellDragRange.CSC;
_2157=cellDragProps.cellDragRange.CEC;
_2154=cellDragProps.cellDragRange.CSR;
_2155=cellDragProps.cellDragRange.CER;
_2156-=_2153;
_2157=_2156+colsInRange;
_2155=selRow;
_2154=_2155-rowsInRange;
if(_2156<=0){
_2156=0;
_2157=_2156+colsInRange;
}
setDragDIVPosAndDim(_2154,_2156,_2155,_2157);
cellDragProps.cellDragRange.CSC=_2156;
cellDragProps.cellDragRange.CEC=_2157;
cellDragProps.cellDragRange.CSR=_2154;
cellDragProps.cellDragRange.CER=_2155;
_2157=_2156;
break;
}
setSheetScrollDIM(_2154,_2155,_2156,_2157,"LEFT");
}else{
if(ev=="FORMULAFILL"){
if((funCol!=0)&&(funCol>0)){
var info=ActiveFormulaInfo;
_2154=info.getActiveRow();
_2156=info.getActiveCol();
funCol=0;
focusCellRangeFill(_2154,_2156,funRow,funCol);
}
}else{
if(ev=="DRAG"){
var _2156=cellDragProps.cellDragRange.CSC;
var _2157=cellDragProps.cellDragRange.CEC;
var _2154=cellDragProps.cellDragRange.CSR;
var _2155=cellDragProps.cellDragRange.CER;
_2156-=_2153;
_2157=_2156+colsInRange;
_2155=selRow;
_2154=_2155-rowsInRange;
if(_2156<=0){
_2156=0;
_2157=_2156+colsInRange;
}
cellDragProps.cellDragRange.CSC=_2156;
cellDragProps.cellDragRange.CEC=_2157;
cellDragProps.cellDragRange.CSR=_2154;
cellDragProps.cellDragRange.CER=_2155;
setDragDIVPosAndDim(_2154,_2156,_2155,_2157);
}else{
if((selCol!=0)&&(selCol>0)){
selCol=0;
if(ev=="FILLSERIES"){
focusCellRangeforAutoFill(beforeFillSeriesStartR,beforeFillSeriesStartC,beforeFillSeriesEndR,selCol);
}else{
if(isColSelected()){
focusCol(currCol,selCol,"COLUMNINMOUSE");
}else{
focusCellRange(currRow,currCol,selRow,selCol,"INCREMENT");
}
}
}
}
}
}
}
function scrollSheetVertical(y,ev){
var itvl=-1,_215c=1,toTop,_215e,_215f;
if((y-getSheetScrollTop())<0){
toTop=true;
_215f=getSheetScrollTop()-y;
}else{
if((y-getSheetScrollTop())>getSheetHeight()){
_215e=true;
_215f=y-(getSheetHeight()+getSheetScrollTop())+16;
}
}
if(_215f<=18){
itvl=200;
}else{
if(_215f>=18&&_215f<=36){
itvl=175;
}else{
if(_215f>=36&&_215f<54){
itvl=100;
}else{
if(_215f>=54){
itvl=75;
}
}
}
}
if(_215f&&scrollSheetVertical.prevItvl!==itvl){
scrollSheetVertical.prevItvl=itvl;
clearInterval(sheetScrollTopId);
sheetScrollTopId=setInterval(function(){
if(_215e){
setScrollSheetBottom(y,ev,_215c);
}
if(toTop){
setScrollSheetTop(y,ev,_215c);
}
},itvl);
}
}
function scrollSheetHorizontal(x,ev){
if((x-getSheetScrollLeft())<0){
var _2162=getScrollLeftTime("TO_LEFT",x);
var _2163=getCountOfRowToScroll("TO_LEFT",x);
if(typeof sheetScrollLeftId!="undefined"){
clearInterval(sheetScrollLeftId);
}
sheetScrollLeftId=setInterval(function(){
setScrollSheetLeft(x,ev,_2163);
},_2162);
}else{
if((x-getSheetScrollLeft())>(getSheetWidth())){
var _2162=getScrollLeftTime("TO_RIGHT",x);
var _2163=getCountOfRowToScroll("TO_RIGHT",x);
if(typeof sheetScrollLeftId!="undefined"){
clearInterval(sheetScrollLeftId);
}
sheetScrollLeftId=setInterval(function(){
setScrollSheetRight(x,ev,_2163);
},_2162);
}
}
}
function getScrollLeftTime(ev,x){
var _2166=-1;
switch(ev){
case "TO_RIGHT":
var _2167=(x+16)-(getSheetWidth()+getSheetScrollLeft());
if(_2167<=2){
_2166=500;
}else{
if(_2167>2&&_2167<8){
_2166=300;
}else{
if(_2167>=8&&_2167<=14){
_2166=200;
}else{
if(_2167>14){
_2166=0;
}
}
}
}
break;
case "TO_LEFT":
var _2168=getSheetScrollLeft()-x;
if(_2168<=15){
_2166=500;
}else{
if(_2168>15&&_2168<=25){
_2166=400;
}else{
if(_2168>25&&_2168<=34){
_2166=300;
}else{
_2166=150;
}
}
}
break;
}
return _2166;
}
function getCountOfRowToScroll(ev,x){
var _216b=0;
switch(ev){
case "TO_RIGHT":
var _216c=(x+16)-(getSheetWidth()+getSheetScrollLeft());
if(_216c<=2){
_216b=1;
}else{
if(_216c>2&&_216c<8){
_216b=2;
}else{
if(_216c>=8&&_216c<=14){
_216b=3;
}else{
if(_216c>14){
_216b=4;
}
}
}
}
break;
case "TO_LEFT":
var _216d=getSheetScrollLeft()-x;
if(_216d<=15){
_216b=1;
}else{
if(_216d>15&&_216d<=25){
_216b=2;
}else{
if(_216d>25&&_216d<=34){
_216b=3;
}else{
_216b=4;
}
}
}
break;
}
return _216b;
}
function setSheetScrollDIM(_216e,_216f,_2170,_2171,evt){
var dim=getCellRangeDIM(_216e,_2170,_216f,_2171);
switch(evt){
case "LEFT":
if(_2171<=_2170){
var _2174=dim.left-80;
}else{
var _2174=(dim.left+dim.width)-80;
}
break;
case "RIGHT":
if(_2171>_2170){
var _2174=(dim.left+dim.width)-getSheetWidth();
}else{
var _2174=(dim.left-getSheetWidth());
}
break;
case "TOP":
if(_216f<_216e){
var _2175=dim.top-32;
}else{
var _2175=(dim.top+dim.height)-32;
}
break;
case "BOTTOM":
if(_216f>_216e){
var _2175=(dim.top+dim.height)-getSheetHeight();
}else{
var _2175=(dim.top-getSheetHeight());
}
break;
}
if(typeof _2175!="undefined"){
setScrollTop(_2175);
}
if(typeof _2174!="undefined"){
setScrollLeft(_2174);
}
}
function showCellRangeFillDIV(){
if(ISFREEZED){
cellRangeFillDIV1.style.display=cellRangeFillDIV2.style.display=cellRangeFillDIV3.style.display="block";
cellRangeFillSPAN1.style.display=cellRangeFillSPAN2.style.display=cellRangeFillSPAN3.style.display="block";
}
cellRangeFillDIV.style.display="";
cellRangeFillSPAN.style.display="";
}
function hideCellRangeFillDIV(){
var none="none";
if(ISFREEZED){
cellRangeFillDIV1.style.display=cellRangeFillDIV2.style.display=cellRangeFillDIV3.style.display=none;
cellRangeFillSPAN1.style.display=cellRangeFillSPAN2.style.display=cellRangeFillSPAN3.style.display=none;
}
cellRangeFillDIV.style.display=none;
cellRangeFillSPAN.style.display=none;
insertCopyRows=false;
insertCutRows=false;
insertCopyCols=false;
insertCutCols=false;
}
function resetCellRangeFillDIV(){
var dim=getCellRangeDIM(copyRangeStartRow,copyRangeStartCol,copyRangeEndRow,copyRangeEndCol);
setCellRangeFillDIVPos(dim.left,dim.top);
setCellRangeFillDIVDim(dim.width,dim.height);
}
function setCellRangeFillDIVPos(left,top){
left--;
top--;
cellRangeFillDIV.style.left=left+"px";
cellRangeFillDIV.style.top=top+"px";
if(ISFREEZED){
cellRangeFillDIV1.style.left=cellRangeFillDIV2.style.left=cellRangeFillDIV3.style.left=left+"px";
cellRangeFillDIV1.style.top=cellRangeFillDIV2.style.top=cellRangeFillDIV3.style.top=top+"px";
}
}
function setCellRangeFillDIVDim(width,_217b){
width++;
_217b++;
if(isNumber(width)&&isNumber(_217b)){
if(ISFREEZED){
cellRangeFillDIV1.style.width=cellRangeFillDIV2.style.width=cellRangeFillDIV3.style.width=width+"px";
cellRangeFillDIV1.style.height=cellRangeFillDIV2.style.height=cellRangeFillDIV3.style.height=_217b+"px";
}
cellRangeFillDIV.style.width=parseInt(width)+"px";
cellRangeFillDIV.style.height=parseInt(_217b)+"px";
}
}
function showTransSpan(){
var block="block";
if(ISFREEZED){
if(isRowsOnlyFreezed){
transSPAN2.style.display=block;
}else{
if(isColsOnlyFreezed){
transSPAN3.style.display=block;
}else{
if(isColsAndRowsFreezed){
transSPAN1.style.display=block;
transSPAN2.style.display=block;
transSPAN3.style.display=block;
}
}
}
}
transSPAN.style.display=block;
}
function hideTransSpan(){
var none="none";
if(ISFREEZED){
transSPAN1.style.display=none;
transSPAN2.style.display=none;
transSPAN3.style.display=none;
}
transSPAN.style.display=none;
}
function cancelDragCellOrCellRange(ev){
if(ev.keyCode==27){
cellDragProps.isDraggable=false;
endDragCellOrCellRange(ev);
stopEvt(ev);
return false;
}
}
function dragCellOrCellRange(ev){
if(browser_ie){
var el=ev.srcElement;
}else{
if(browser_nn6){
var el=ev.target;
}
}
if(cellDragProps.isDraggable){
if(el.id=="dragDIV"||el.id=="dragDIV1"||el.id=="dragDIV2"||el.id=="dragDIV3"){
el.style.cursor="move";
}
var SR=cellDragProps.cellDragRange.ASR;
var SC=cellDragProps.cellDragRange.ASC;
var ER=cellDragProps.cellDragRange.AER;
var EC=cellDragProps.cellDragRange.AEC;
var AR=cellDragProps.ADR;
var AC=cellDragProps.ADC;
var row=getRowPosInMouseEvent(ev);
var col=getColPosInMouseEvent(ev);
var range=new Range(SR,SC,ER,EC);
if(range.isCol()){
AR=0;
row=0;
}
if(range.isRow()){
AC=0;
col=0;
}
var _218a=row-(AR-SR);
var _218b=col-(AC-SC);
if(_218a<0){
_218a=0;
}
if(_218b<0){
_218b=0;
}
SR=_218a;
SC=_218b;
ER=_218a+rowsInRange;
EC=_218b+colsInRange;
selCol=EC;
selRow=ER;
var _218c=getCursorPos(ev);
if(ISFREEZED){
if(_218c.x>sheetLeft+findSecondPaneXPos()){
var x=_218c.x-sheetLeft+getSheetScrollLeft();
}else{
var x=_218c.x-sheetLeft;
}
if(_218c.y>sheetTop+findThirdPaneYPos()){
var y=_218c.y-sheetTop+getSheetScrollTop();
}else{
var y=_218c.y-sheetTop;
}
}else{
var x=_218c.x-sheetLeft+getSheetScrollLeft();
var y=_218c.y-sheetTop+getSheetScrollTop();
}
if(moveCursorDIV!=null){
moveCursorDIV.style.left=_218c.x-20;
moveCursorDIV.style.top=_218c.y-20;
}
if(!browser_ie){
sheetTable.style.cursor=sheetTable1.style.cursor=sheetTable2.style.cursor=sheetTable3.style.cursor="move";
sheetPane.style.cursor=sheetPane1.style.cursor=sheetPane2.style.cursor=sheetPane3.style.cursor="move";
}
if(isMouseCursorXInOutOfViewPort(x)){
if(moveCursorDIV){
if(moveCursorDIV.style.display=="none"){
moveCursorDIV.style.display="";
}
}
scrollSheetHorizontal(x,"DRAG");
}else{
if(isMouseCursorYInOutOfViewPort(y)){
if(moveCursorDIV){
if(moveCursorDIV.style.display=="none"){
moveCursorDIV.style.display="";
}
}
scrollSheetVertical(y,"DRAG");
}else{
if(typeof sheetScrollLeftId!="undefined"){
clearInterval(sheetScrollLeftId);
}
if(typeof sheetScrollTopId!="undefined"){
clearInterval(sheetScrollTopId);
}
if(EC<=totCols||range.isRow()){
setDragDIVPosAndDim(SR,SC,ER,EC);
}
}
}
}
}
function endDragCellOrCellRange(ev){
if(typeof sheetScrollLeftId!="undefined"){
clearInterval(sheetScrollLeftId);
}
if(typeof sheetScrollTopId!="undefined"){
clearInterval(sheetScrollTopId);
}
if(browser_ie){
var el=ev.srcElement;
}else{
if(browser_nn6){
var el=ev.target;
}
}
var ASR=cellDragProps.cellDragRange.ASR;
var ASC=cellDragProps.cellDragRange.ASC;
var AER=cellDragProps.cellDragRange.AER;
var AEC=cellDragProps.cellDragRange.AEC;
var SR=cellDragProps.cellDragRange.CSR;
var SC=cellDragProps.cellDragRange.CSC;
var ER=cellDragProps.cellDragRange.CER;
var EC=cellDragProps.cellDragRange.CEC;
dragDIV.style.display="none";
dragDIV1.style.display="none";
dragDIV2.style.display="none";
dragDIV3.style.display="none";
if(cellDragProps.isDraggable){
if(SR!=-1&&SR!=ASR||SC!=-1&&SC!=ASC||ER!=-1&&ER!=AER||EC!=-1&&EC!=AEC){
if(ev.ctrlKey){
copyCells();
}else{
copyCells("cutCells",true,true);
}
pasteCells(SR,SC);
}
cellDragProps.isDraggable=false;
}
if(SR!=-1&&SC!=-1){
currRow=SR;
currCol=SC;
ActiveCellInfo.reset(currRow,currCol);
}
if(browser_ie){
document.detachEvent("onmousemove",dragCellOrCellRange);
document.detachEvent("onmouseup",endDragCellOrCellRange);
document.detachEvent("onkeydown",cancelDragCellOrCellRange);
}else{
if(browser_nn6){
document.removeEventListener("mousemove",dragCellOrCellRange,false);
document.removeEventListener("mouseup",endDragCellOrCellRange,false);
document.removeEventListener("keydown",cancelDragCellOrCellRange,false);
}
}
if(!browser_ie){
sheetTable.style.cursor=sheetTable1.style.cursor=sheetTable2.style.cursor=sheetTable3.style.cursor="";
sheetPane.style.cursor=sheetPane1.style.cursor=sheetPane2.style.cursor=sheetPane3.style.cursor="";
}
if(moveCursorDIV){
if(moveCursorDIV.style.display==""){
moveCursorDIV.style.display="none";
}
}
cellDragProps.cellDragRange.CSR=-1;
cellDragProps.cellDragRange.CSC=-1;
cellDragProps.cellDragRange.CER=-1;
cellDragProps.cellDragRange.CEC=-1;
}
function setDragDIVPosAndDim(_2199,_219a,_219b,_219c){
if(cellDragProps.isDraggable){
var left=getColLeft(_219a)-1;
var top=getRowTop(_2199)-1;
var width=0;
var _21a0=0;
var _21a1=getCellRange();
width=getColLeft(_219c)-getColLeft(_219a);
width+=getColWidth(_219c)+1;
_21a0=getRowTop(_219b)-getRowTop(_2199);
_21a0+=getRowHeight(_219b)+1;
var _21a2=left-findSecondPaneXPos();
var _21a3=top-findThirdPaneYPos();
if(ISFREEZED){
if(FREEZED_ROW>0){
dragDIV2.style.left=_21a2+"px";
dragDIV2.style.top=top+"px";
dragDIV2.style.width=width+"px";
dragDIV2.style.height=_21a0+"px";
}
if(FREEZED_COL>0){
dragDIV3.style.left=left+"px";
dragDIV3.style.top=_21a3+"px";
dragDIV3.style.width=width+"px";
dragDIV3.style.height=_21a0+"px";
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
dragDIV1.style.left=left+"px";
dragDIV1.style.top=top+"px";
dragDIV1.style.width=width+"px";
dragDIV1.style.height=_21a0+"px";
}
}
dragDIV.style.left=_21a2+"px";
dragDIV.style.top=_21a3+"px";
dragDIV.style.width=width+"px";
dragDIV.style.height=_21a0+"px";
cellDragProps.cellDragRange.CSR=_2199;
cellDragProps.cellDragRange.CSC=_219a;
cellDragProps.cellDragRange.CER=_219b;
cellDragProps.cellDragRange.CEC=_219c;
dragDIV.style.display="";
dragDIV1.style.display="";
dragDIV2.style.display="";
dragDIV3.style.display="";
}
}
function setAutoSumValue(value,apn){
var val=(value!=undefined)?value+"":"";
apn=(!apn)?"":apn;
if(findClientDim().width<=1024){
var _21a7=$("#initialStatusText").children("div")[0].innerHTML;
if(val.length>7){
$("#initialStatusText").children("div")[1].style.width="50px";
$("#initialStatusText").children("div")[1].style.overflow="hidden";
}
if(_21a7.length>7){
$("#initialStatusText").children("div")[0].style.width="50px";
$("#initialStatusText").children("div")[0].style.overflow="hidden";
}
}else{
if(val.length>10){
$("#totalSum").addClass("autoSumEllipsis");
}
}
$("#totalSum").html(" = "+val);
}
function insertCutColumns(pos,idx,cnt,_21ab,_21ac,_21ad,_21ae,_21af,_21b0,_21b1){
changebuttonsState("insertRowColumn","enable",["insrowstbtn","insrowsmenu"]);
if(_21ae!="true"&&!isColSelected()){
showAlertDialog(jsTitleMsg["TheContentCopiedIsBigger"]);
return;
}
var _21b2;
var _21b3=false;
var _21b4=false;
var _21b5=getCellRange();
var _21b6=_21b5.startCol;
var _21b7=_21b5.endCol;
var obj=_initInsertCol(pos,idx,cnt,undefined,undefined,undefined,undefined,_21ae);
cnt=obj.cnt;
var _21b9=obj.currColIdx;
_21ae=obj.afterRTC;
_21af=(_21ae!="true")?tmpSheetName:_21af;
var _21ba=getAvailableStartRow();
var _21bb=getAvailableEndRow();
_21ab=(isUndefined(_21ab))?copyRangeStartCol:_21ab;
_21ac=(isUndefined(_21ac))?copyRangeEndCol:_21ac;
var _21bc=0;
var _21ad=(!_21ad)?copyRangeEndRow:_21ad;
if(_21ae!="true"){
cnt=_21ac-_21ab+1;
_21b9=((pos!="before")?_21b7+1:_21b9);
hideFlashDIV();
insertCutCols=false;
unsetStatus();
}
if(CURRSHEETNAME==_21af){
if((_21ae!="true")&&(_21ab<_21b6&&_21b6<=_21ac)){
showAlertDialog(jsTitleMsg["InsertCopiedRows.NotAllowed.Alert.CopyPasteAreasOverlap"]);
return false;
}else{
_21b2=insertCol(pos,_21b9,cnt,true,true,true);
if(_21b2){
return false;
}
if(_21ae!="true"&&_21ab>=_21b9){
_21ab+=cnt;
_21ac+=cnt;
}
_21b5=getCellRange();
var temp=_21ac-_21ab+1;
_21b2=deleteCol(_21ab,_21ac-_21ab+1,true,true,_21ae);
if(_21b2){
return false;
}
var eCol=((_21b5.startCol)+temp)-1;
if(_21af==CURRSHEETNAME){
if(_21ae!="true"){
blurColHead(_21ab,_21ac);
if(pos!="after"){
if(_21b5.startCol>_21ab){
focusCol((_21b5.startCol)-temp,(_21b5.startCol)-1);
}else{
temp=temp-1;
focusCol((_21b5.startCol),(_21b5.startCol+temp));
}
}else{
if(_21b5.startCol>_21ab){
blurColHead(_21b5.startCol-temp,_21b5.endCol+1);
focusCol((_21b5.endCol)-temp+1,(_21b5.endCol));
}else{
temp=temp;
focusCol((_21b5.endCol)+1,(_21b5.endCol+temp));
}
}
}else{
blurColHead(_21ab,_21ac);
}
}
}
}else{
_21b2=insertCol(pos,_21b9,cnt,true,true,true);
if(_21b2){
return;
}
if(_21ab>=_21b9){
_21ab+=cnt;
_21ac+=cnt;
}
_21b5=getCellRange();
}
document.cellform.startColumn.value=_21ab;
document.cellform.endColumn.value=_21ac;
document.cellform.startRow.value=_21bc;
document.cellform.endRow.value=_21ad;
document.cellform.tmpSheet.value=_21af;
document.cellform.actionMode.value="InsertCutCols";
document.cellform.row.value=ActiveCellInfo.getStartRow();
document.cellform.tmpData.value=pos;
document.cellform.column.value=_21b9;
document.cellform.cellValue.value=cnt;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_21ae;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.view.value=getObj("VIEW").value;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_21ba;
document.cellform.availableEndRow.value=_21bb;
if(!_21ae){
document.cellform.isColSelected.value=isColSelected();
}
document.cellform.isRowSelected.value=false;
document.cellform.usedRow.value=usedCursRow;
document.cellform.totCols.value=totCols;
document.cellform.currentSelection.value=getCurrentSelection();
if(_21ae=="true"){
document.cellform.U_FN.value=_21b0;
document.cellform.U_AO.value=_21b1;
}
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _21bf=getObj("apiKey");
if(_21bf!=null){
document.cellform.apiKeyId.value=_21bf.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
if(_21ae!="true"&&CURRSHEETNAME!=tmpSheetName){
var temp=_21ac-_21ab+1;
var eCol=(_21b5.startCol)+(_21ac-_21ab);
if(pos!="after"){
eCol=(_21b5.startCol)+(_21ac-_21ab);
focusCol((_21b5.startCol),eCol);
}else{
eCol=(_21b5.endCol)+(_21ac-_21ab)-1;
focusCol((_21b5.endCol)+1,eCol+temp);
}
}
}
function insertCopiedCols(pos,idx,cnt,_21c3,_21c4,_21c5,_21c6,_21c7,_21c8,_21c9){
changebuttonsState("insertRowColumn","enable",["insrowstbtn","insrowsmenu"]);
if(_21c6!="true"&&!isColSelected()){
showAlertDialog(jsTitleMsg["TheContentCopiedIsBigger"]);
return;
}
var _21ca;
var _21cb=false;
var _21cc=false;
var _21cd=getCellRange();
var _21ce=_21cd.startCol;
var _21cf=_21cd.endCol;
var obj=_initInsertCol(pos,idx,cnt,undefined,undefined,undefined,undefined,_21c6);
cnt=obj.cnt;
var _21d1=obj.currColIdx;
_21c6=obj.afterRTC;
_21c7=(_21c6!="true")?tmpSheetName:_21c7;
var _21d2=getAvailableStartRow();
var _21d3=getAvailableEndRow();
_21c3=(isUndefined(_21c3))?copyRangeStartCol:_21c3;
_21c4=(isUndefined(_21c4))?copyRangeEndCol:_21c4;
var _21d4=0;
var _21c5=(!_21c5)?copyRangeEndRow:_21c5;
if(_21c6!="true"){
_21d1=((pos!="before")?_21cf+1:_21d1);
var _21d5=_21cd.startCol;
var _21d6=_21cd.endCol;
var _21d7=_21d6-_21d5+1;
var _21d8=_21c4-_21c3+1;
insertCopyCols=false;
hideFlashDIV();
if(_21d7>_21d8){
var temp=0;
temp=Math.floor(_21d7/_21d8);
cnt=_21d8*temp;
}else{
_21d1=((pos!="before")?_21cf+1:_21d1);
cnt=_21d8;
}
}
if(CURRSHEETNAME==_21c7){
if((_21c6!="true")&&(_21c3<_21ce&&_21ce<=_21c4)){
showAlertDialog(jsTitleMsg["InsertCopiedRows.NotAllowed.Alert.CopyPasteAreasOverlap"]);
return false;
}else{
_21ca=insertCol(pos,_21d1,cnt,true,true,true);
if(_21ca){
return false;
}
if(_21c6!="true"&&_21c3>=_21d1){
_21c3+=cnt;
_21c4+=cnt;
}
_21cd=getCellRange();
}
}else{
_21ca=insertCol(pos,_21d1,cnt,true,true,true);
if(_21ca){
return;
}
_21cd=getCellRange();
}
document.cellform.startColumn.value=_21c3;
document.cellform.endColumn.value=_21c4;
document.cellform.startRow.value=_21d4;
document.cellform.endRow.value=_21c5;
document.cellform.tmpSheet.value=_21c7;
document.cellform.actionMode.value="InsertCopiedCols";
document.cellform.row.value=ActiveCellInfo.getStartRow();
document.cellform.tmpData.value=pos;
document.cellform.column.value=_21d1;
document.cellform.cellValue.value=cnt;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_21c6;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.view.value=getObj("VIEW").value;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_21d2;
document.cellform.availableEndRow.value=_21d3;
if(!_21c6){
document.cellform.isColSelected.value=isColSelected();
}
document.cellform.isRowSelected.value=false;
document.cellform.usedRow.value=usedCursRow;
document.cellform.totCols.value=totCols;
document.cellform.currentSelection.value=getCurrentSelection();
if(_21c6=="true"){
document.cellform.U_FN.value=_21c8;
document.cellform.U_AO.value=_21c9;
}
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _21da=getObj("apiKey");
if(_21da!=null){
document.cellform.apiKeyId.value=_21da.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
if(_21c6!="true"){
var eCol=((getCellRange().startCol)+cnt)-1;
if(pos!="after"){
eCol=((getCellRange().startCol)+cnt)-1;
focusCol((getCellRange().startCol),eCol);
}else{
eCol=((getCellRange().endCol)+cnt);
focusCol((getCellRange().endCol)+1,eCol);
}
}
}
function focusCol(_21dc,_21dd,ev,_21df){
if(typeof _21dd=="undefined"){
var _21dd=_21dc;
}
if((isCellEdited()&&cellField.value.indexOf("=")==0)||formulaCell||isExprFunc||(isFuncDlgOpen&&getObj("funcList")!=null)||isRangeEdit||(isChartDialogOpened&&getObj("chartDataDIV")!=null&&getObj("chartDataDIV").style.display!="none")||isPivotDialogOpen||isEditPivotDialogOpen){
insertCellRangeInit();
focusCellRangeFill(-1,_21dc,getRowMax()-1,_21dd);
}else{
if(isCellEdited()){
submitCell();
}
if(!ev){
ev="COLUMN";
}
focusCellRange(-1,_21dc,getRowMax()-1,_21dd,ev,_21df);
}
}
function colHeadClick(ev,obj){
if(!isCellFieldSPANHided()&&isPartOfArray(currRow,currCol,currRow,currCol)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
if(isFilterOptionsDIVOpened){
Filter.hideFilterOptions();
}
if(cellFieldSPAN&&!isCellFieldSPANHided()&&!isFormulaCell()){
submitCell();
}
if(browser_ie){
var el=window.event.srcElement;
var _21e3=(ev.button==2);
}else{
if(browser_nn6){
var el=ev.target;
var _21e3=(ev.which==3);
}
}
if(_21e3&&(isWholeSheetSelected())){
return;
}
if(((browser_opera&&ev.altKey)||_21e3)&&el.tagName=="DIV"&&isColHead(el)&&el.className=="colHeadFocus"&&isColSelected()){
if(browser_opera&&ev.altKey&&READ_WRITE){
if(browser_ie){
document.detachEvent("onmousemove",resizeCol);
document.detachEvent("onmouseup",endResizeCol);
}else{
if(browser_nn6){
document.removeEventListener("mousemove",resizeCol,false);
document.removeEventListener("mouseup",endResizeCol,false);
}
}
setTimeout(function(){
return contextmenu(obj,ev);
},0);
}
return false;
}
if(el.tagName=="DIV"&&isColHead(el)){
var _21e4=false;
var _21e5=getCursorPos(ev);
var col=getColPosInMouseEvent(ev);
var x=_21e5.x;
var elX=sheetLeft+getColLeft(col)-colHead.scrollLeft;
var _21e9=getColWidth(col);
if(_21e9<30){
var _21ea=2;
}else{
var _21ea=10;
}
if(x>=elX&&x<=elX+_21ea){
_21e4=true;
currColHeadCnt=col-1;
currColHeadCnt=(currColHeadCnt<0)?0:currColHeadCnt;
currColHead=getColHead(currColHeadCnt);
currColHeadLeft=(sheetLeft+getColLeft(currColHeadCnt))-colHead.scrollLeft;
currColHeadWidth=getColWidth(currColHeadCnt);
}else{
if(x>=(elX+_21e9-_21ea)&&x<=elX+_21e9+_21ea){
_21e4=true;
currColHeadCnt=col;
currColHeadCnt=(currColHeadCnt>totCols)?totCols:currColHeadCnt;
currColHead=getColHead(currColHeadCnt);
currColHeadLeft=elX;
currColHeadWidth=_21e9;
}
}
if(_21e4&&isServerComponentLoaded(true)){
if(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE){
return;
}
if(ISFREEZED){
if(isColsOnlyFreezed||isColsAndRowsFreezed){
var _21eb=currColHeadCnt;
var _21ec;
if(isCellRange()){
_21ec=getCellRange();
if(currColHeadCnt<_21ec.startCol){
_21eb=currColHeadCnt;
}else{
_21eb=_21ec.startCol;
}
}
if(_21eb<FREEZED_COL){
if(isCellRange()&&_21ec.endCol>=FREEZED_COL){
if(currColHeadCnt>=FREEZED_COL){
showAlertDialog(jsTitleMsg["FreezePanes.Columnresizingnotsupported"]);
}
}
return;
}
}
}
colHeadTableWidth=getSheetTableWidth();
if(READ_WRITE){
resizePane.style.left=(currColHeadLeft+currColHeadWidth+((browser_ie6)?1:-1))+"px";
resizePane.style.top=findPosY(colHead)+"px";
resizePane.style.width="1px";
resizePane.style.height=colHead.offsetHeight+sheet.offsetHeight+"px";
resizePane.style.cursor="col-resize";
}
colHeadTable.style.cursor="col-resize";
colHeadTable.onmouseover=null;
currColHeads=getColHeads(currColHeadCnt+1,totCols-1);
currColHeadWidth=getColWidth(currColHeadCnt);
if(READ_WRITE){
if(browser_ie){
resizeOverlay.style.left=findPosX(rowHead)+"px";
resizeOverlay.style.top=findPosY(colHead)+"px";
resizeOverlay.style.width=sheet.offsetWidth+"px";
resizeOverlay.style.height=sheet.offsetHeight+"px";
resizeOverlay.style.cursor="col-resize";
document.attachEvent("onmousemove",resizeCol);
document.attachEvent("onmouseup",endResizeCol);
}else{
document.addEventListener("mousemove",resizeCol,false);
document.addEventListener("mouseup",endResizeCol,false);
stopEvt(ev);
}
}
}else{
var info=Merge.getCellInfo(0,col);
if(info&&info.isCol()){
col=info["startCol"];
}
if((isCellEdited()&&cellField.value.indexOf("=")==0)||formulaCell||isExprFunc||(isFuncDlgOpen&&getObj("funcList")!=null)||isRangeEdit||(isChartDialogOpened&&getObj("chartDataDIV")!=null&&getObj("chartDataDIV").style.display!="none")||isPivotDialogOpen||isEditPivotDialogOpen){
if(ev.shiftKey){
var info=ActiveFormulaInfo;
if(info.isAvailable()){
var _21ee=ActiveFormulaInfo.getActiveCol();
}else{
ActiveFormulaInfo.set(0,col);
var _21ee=col;
}
var _21ef=col;
}else{
ActiveFormulaInfo.set(0,col);
var _21ee=col;
var _21ef=col;
}
}else{
if(isCellRange()){
resetCellRange();
}else{
blurCell(currRow,currCol);
}
currRow=0;
selCol=col;
vertArea="DEFAULT";
selectionLeft=getEndLeftOfCol(col);
if(ev.shiftKey){
clearTextSelection();
}else{
currCol=col;
currRow=findRowInYPos(getSheetScrollTop());
if(ISFREEZED&&FREEZED_ROW>0){
currRow=0;
}else{
currRow=findRowInYPos(getSheetScrollTop());
}
ActiveCellInfo.reset(currRow,currCol);
var info=ActiveCellInfo;
if(info.isMerged()){
var row=info.getStartRow()+info.getRowSpan();
var _21f1=getRowMax();
if(row<_21f1-1){
currRow=row;
}
}
ActiveCellInfo.reset(currRow,currCol);
}
if(ISFREEZED&&FREEZED_ROW>0){
if(currCol<FREEZED_COL){
currCell=getCell(currRow,currCol,sheetPane1Id);
}else{
currCell=getCell(currRow,currCol,sheetPane2Id);
}
}else{
currCell=getCell(currRow,currCol);
}
setCellFieldSPAN();
if(currCell){
updateActiveCellDependencies(currCell);
}
var _21ee=currCol;
var _21ef=col;
}
colSelected=true;
colSelection=true;
focusCol(_21ee,_21ef);
if(browser_ie){
document.attachEvent("onmousemove",selectCol);
document.attachEvent("onmouseup",endSelectCol);
}else{
if(browser_nn6){
document.addEventListener("mousemove",selectCol,false);
document.addEventListener("mouseup",endSelectCol,false);
}
}
}
}
if(browser_opera&&ev.altKey){
if(browser_ie){
document.detachEvent("onmousemove",resizeCol);
document.detachEvent("onmouseup",endResizeCol);
}else{
if(browser_nn6){
document.removeEventListener("mousemove",resizeCol,false);
document.removeEventListener("mouseup",endResizeCol,false);
}
}
setTimeout(function(){
return contextmenu(obj,ev);
},0);
}
}
var currColHeads;
function resizeCol(ev){
isColResized=true;
clearTextSelection();
var x=getCursorPos(ev).x;
var width=x-currColHeadLeft;
if(width>0&&width<=sheetRight-currColHeadLeft){
}else{
if(width>(sheetRight-currColHeadLeft)){
width=(sheetLeft+getSheetWidth())-currColHeadLeft;
x=sheetLeft+getSheetWidth();
}else{
var width=1;
x=width+currColHeadLeft;
}
}
resizePane.style.left=(x-1)+"px";
currColHead.style.width=width+"px";
for(var i=0,len=currColHeads.length;i<len;i++){
var _21f7=getColLeft(i+currColHeadCnt+1)+(width-currColHeadWidth);
shiftColHead(currColHeads[i],{mode:"VAL",val:_21f7});
}
}
function endResizeCol(){
hideElement(resizePane);
if(browser_ie){
hideElement(resizeOverlay);
}
if(browser_ie){
document.detachEvent("onmousemove",resizeCol);
document.detachEvent("onmouseup",endResizeCol);
}else{
if(browser_nn6){
document.removeEventListener("mousemove",resizeCol,false);
document.removeEventListener("mouseup",endResizeCol,false);
}
}
colHeadTable.onmouseover=function(event){
setCursor(event,colHeadTable);
};
if(isColResized){
var _21f9=currColHeadCnt;
var _21fa=currColHeadCnt;
if(isColSelected()){
var _21fb=getCellRange();
var _21fc=_21fb.startCol;
var _21fd=_21fb.endCol;
if(_21fc<=currColHeadCnt&&currColHeadCnt<=_21fd){
_21f9=_21fc;
_21fa=_21fd;
}
}
width_height_action("width",parseInt(currColHead.style.width),_21f9,_21fa);
isColResized=false;
currColHeadWidth=0;
}
}
function resetCols(_21fe,_21ff,count,evt,pos){
switch(evt){
case "INSERT":
for(var j=_21fe;j<_21ff;j+=1){
var _2204=getColHead(j);
if((pos!="after"||pos!="append")&&!isWholeSheetSelected()){
_2204.className="";
}
_2204.innerHTML=getColHeadLabel(j+count+1);
}
break;
case "DELETE":
for(var j=_21fe;j<(_21ff-count);j+=1){
var _2204=getColHead(j);
if(j<(_21fe+count)){
_2204.className="colHeadFocus";
}
_2204.innerHTML=getColHeadLabel(j+1);
}
break;
}
}
function insertCol(pos,idx,cnt,_2208,_2209,_220a,_220b,_220c,_220d,_220e,_220f,_2210){
if(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE){
return;
}
var init=_initInsertCol(pos,idx,cnt,_2208,_2209,_220a,_220b,_220c);
cnt=init.cnt;
pos=init.pos;
_2208=init.doNotFocus;
_2209=init.doNotSlide;
_220a=init.jsOnly;
_220c=init.afterRTC;
currColIdx=init.currColIdx;
var _2212=getColMax();
if(totCols+cnt-1>=_2212||(Merge.isRowMergeXists()&&pos!="append")){
if(!_220f){
showAlertDialog(jsTitleMsg["InsertCol.Alert.InsertingNotPossibleBeyondMaxCol"]);
}
return true;
}
if(currColIdx<usedCursCol&&pos!="append"){
if(usedCursCol+cnt>=_2212){
if(!_220f){
showAlertDialog(jsTitleMsg["InsertCol.Alert.InsertingNotPossibleBeforUsedCol"]);
}
return true;
}
}
if(_220c&&cellFieldSPAN!=null&&!isCellFieldSPANHided()&&!isFormulaCell()){
if(currCol>idx){
currCol+=(cnt);
}else{
if(currCol==idx){
currCol+=cnt;
}
}
}
if(ISFREEZED){
if(isColsOnlyFreezed||isColsAndRowsFreezed){
if(currColIdx<FREEZED_COL){
if(!_220f){
showAlertDialog(jsTitleMsg["FreezePanes.Columninsertionnotsupported"]);
}
return true;
}
}
}
var _2213=arrayDetails;
updateArrayDetails("INSERTCOL",currColIdx,cnt,currRow,currCol);
if(isPartOfArray(0,currColIdx,65535,(currColIdx+cnt-1))){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
arrayDetails=_2213;
return true;
}
if(currColIdx>totCols){
return true;
}
_2209=true;
if(isUndefined(_2210)){
var _2210=_getCloneColInsertCol(pos,currColIdx,cnt);
}
var _2214=(pos=="before")&&(currColIdx==0)?true:false;
var _2215=false;
if(isUndefined(_220b)){
if(_2214){
_220b=getCellDefaultWidth();
}else{
_220b=getColWidth(_2210);
}
}else{
_2215=true;
}
if(pos=="append"){
_2215=true;
}
resetCols(currColIdx,totCols,cnt,"INSERT",pos);
var _2216=_getColsToInsert(_2208,_220b,_2209,_2210,pos,currColIdx,_2215);
_insertColHead(cnt,_2216,currColIdx,pos,_220b);
var _2217=_getCellArrToInsert(_2210,cnt,currColIdx,pos,_220b,_2215);
_insertCells(_2217.newCellArr,currColIdx,_2217.insertCellArr,cnt,_220b,pos);
if(ISFREEZED){
if(FREEZED_ROW>0){
_2217=_getCellArrToInsert(_2210,cnt,currColIdx,pos,_220b,_2215,sheetPane2Id);
_insertCells(_2217.newCellArr,currColIdx,_2217.insertCellArr,cnt,_220b,pos,sheetPane2Id);
}
if(FREEZED_COL>0){
_2217=_getCellArrToInsert(_2210,cnt,currColIdx,pos,_220b,_2215,sheetPane3Id);
_insertCells(_2217.newCellArr,currColIdx,_2217.insertCellArr,cnt,_220b,pos,sheetPane3Id);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_2217=_getCellArrToInsert(_2210,cnt,currColIdx,pos,_220b,_2215,sheetPane1Id);
_insertCells(_2217.newCellArr,currColIdx,_2217.insertCellArr,cnt,_220b,pos,sheetPane1Id);
}
}
shiftMergedCellsHorizontally(currColIdx,cnt,_220b,"INSERTCOL");
setColDetails("INSERT",currColIdx,cnt,_220b);
if(pos!="append"){
Merge.shiftColumn(currColIdx,cnt,true);
}
totCols+=cnt;
if(currColIdx<=copyRangeStartCol&&tmpSheetName==CURRSHEETNAME&&(copyStatus||cutStatus)){
copyRangeStartCol+=cnt;
copyRangeEndCol+=cnt;
resetCellRangeFillDIV();
}
if(currColIdx<=copyCellCol){
if(copyStatus||cutStatus){
copyCellCol+=cnt;
}
}
if(usedCursCol>=currColIdx){
usedCursCol+=cnt;
}
if(_2209){
var width=getColLeft(totCols-1)+getColWidth(totCols-1);
setSheetTableWidth(width);
var _2219=getCellRange();
if(isColSelected()){
focusCellRange(_2219.startRow,_2219.startCol,_2219.endRow,_2219.endCol,"COLUMN",true);
}else{
if(isRowSelected()){
focusCellRange(_2219.startRow,_2219.startCol,_2219.endRow,_2219.endCol,"ROW",true);
}else{
focusCellRange(_2219.startRow,_2219.startCol,_2219.endRow,_2219.endCol,undefined,true);
}
}
}else{
if(browser_ie){
colWdIncrIntvl=window.setInterval("incrColWidth("+currColIdx+", "+(currColIdx+cnt)+")",0);
}else{
if(browser_nn6){
colWdIncrIntvl=window.setTimeout("incrColWidth("+currColIdx+", "+(currColIdx+cnt)+")",0);
}
}
}
currCell=getCell(currRow,currCol);
if(!_220a){
if(pos=="append"){
readRangeDetails(getAvailableStartRow(),totCols-cnt,getAvailableEndRow(),totCols-1);
}else{
_2219=getCellRange();
var _221a=getAvailableStartRow();
var _221b=getAvailableEndRow();
document.cellform.startColumn.value=_2219.startCol;
document.cellform.endColumn.value=totCols-1;
document.cellform.startRow.value=0;
document.cellform.endRow.value=totRows-1;
document.cellform.actionMode.value="InsertCol";
document.cellform.row.value=ActiveCellInfo.getStartRow();
document.cellform.tmpData.value=pos;
document.cellform.column.value=currColIdx;
document.cellform.cellValue.value=cnt;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_220c;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.view.value=getObj("VIEW").value;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_221a;
document.cellform.availableEndRow.value=_221b;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=false;
document.cellform.usedRow.value=usedCursRow;
document.cellform.totCols.value=totCols;
if(_220c=="true"){
document.cellform.U_FN.value=_220d;
document.cellform.U_AO.value=_220e;
}
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _221c=getObj("apiKey");
if(_221c!=null){
document.cellform.apiKeyId.value=_221c.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
}
}
Userpresence.send();
if(pos!="append"){
var _221d=[];
var _221e=getCellRange().startCol;
var _221f=getCellRange().endCol;
var _2220=ole.getObjects();
for(var i=0;i<_2220.length;i++){
if(pos!="before"){
if(_221f<OLE[_2220[i].id].sCol){
OLE[_2220[i].id].sCol=parseInt(OLE[_2220[i].id].sCol)+parseInt(cnt);
}
}else{
OLE[_2220[i].id].sCol=parseInt(OLE[_2220[i].id].sCol)+parseInt(cnt);
}
var _2222=parseInt(OLE[_2220[i].id].sColDiff);
var col=parseInt(OLE[_2220[i].id].sCol);
var width=parseInt(getColWidth(col));
var left=parseInt(getColLeft(col));
if(_2222>width){
_221d[i]=left+width;
}else{
_221d[i]=left+_2222;
}
OLE[_2220[i].id].setLeft(_221d[i]);
}
ole.conf.onPositionChange(_2220);
}
}
function _initInsertCol(pos,idx,cnt,_2228,_2229,_222a,_222b,_222c){
if(isUndefined(_222c)){
_222c="false";
}
if(isUndefined(idx)||isNaN(idx)){
var _222d=(isCellRange())?getCellRange().startCol:currCol;
}else{
var _222d=idx;
}
if(isUndefined(cnt)||isNaN(cnt)){
if(isCellRange()){
var _222e=getCellRange();
var cnt=_222e.endCol-_222e.startCol+1;
}else{
var cnt=1;
}
if(pos=="after"||pos=="append"){
_222d+=cnt;
}
}
if(isUndefined(_2229)){
_2229=false;
}
if(isUndefined(_2228)){
_2228=false;
}
if(browser_ie){
_2229=true;
}
if((pos=="after"||pos=="append")&&!isWholeSheetSelected()){
_2228=true;
}
if(typeof _222a=="undefined"){
var _222a=false;
}
return {pos:pos,cnt:cnt,doNotFocus:_2228,doNotSlide:_2229,jsOnly:_222a,currColIdx:_222d,afterRTC:_222c};
}
function _getCloneColInsertCol(pos,_2230,cnt){
var _2232=(_2230-1<0)?0:(_2230-1);
return _2232;
}
function _getColsToInsert(_2233,_2234,_2235,_2236,pos,_2238,_2239){
var _223a=(pos=="before")&&(_2238==0)?true:false;
if(_223a||_2239){
var _223b=getDefaultColHdr().cloneNode(true);
_223b.style.width=_2234+"px";
}else{
var _223b=getColHead(_2236).cloneNode(true);
}
if(!_2233){
_223b.className="colHeadFocus";
}else{
_223b.className="";
}
return _223b;
}
function _getCellArrToInsert(_223c,cnt,_223e,pos,_2240,_2241,_2242){
if(isUndefined(_2242)){
_2242=sheetPaneId;
}
var _2243=(pos=="before")&&(_223e==0)?true:false;
if(_2243||_2241){
var _2244=getDefaultCellHTML();
_2244.style.width=_2240+"px";
}
var _2245=((pos=="after"||pos=="append")&&(_223e==totCols))?true:false;
var _2246=[];
var _2247=[];
var _2248;
var _2249=Row.getAvailableRows();
var _224a=_2249[0];
var _224b=_2249[_2249.length-1];
if(isRowsOnlyFreezed||isColsAndRowsFreezed){
if(_2242==sheetPane1Id||_2242==sheetPane2Id){
_224a=0;
_224b=ROWS_PER_TILE-1;
_2249=Row.getLoadedRowsInFrozenRange();
}
}
for(var i=0,len=_2249.length;i<len;i++){
var row=_2249[i];
if(_2243||_2241){
if(i%ROWS_PER_TILE===0){
var _224f=0;
}
var _2250=getRowHeight(row);
var _2248=_2244.cloneNode(true);
_2248.style.top=_224f+"px";
_2248.style.height=_2250+"px";
_224f+=_2250;
}else{
var _2251=getCell(row,_223c,_2242,true);
_2248=_2251.cloneNode(true);
}
if(!_2243&&Merge.getCellInfo(row,_223c)){
var _2252=getColLeft(_223c);
var _2240=getColWidth(_223c);
_2248.style.left=_2252+"px";
_2248.style.width=_2240+"px";
}
setDefaultValueForCell(_2248);
if(_2245){
var _2253=_2249[i+1];
if(((i+1)%ROWS_PER_TILE)===0){
var _2254=null;
}else{
var _2254=getCell(_2253,0,_2242,true);
}
}else{
var _2254=getCell(row,_223e,_2242,true);
}
removeCSSStyle("cellComment",_2248);
if(_2248.getAttribute("comment")!=null){
_2248.removeAttribute("comment");
}
if(_2248.getAttribute("onmouseover")!=null){
_2248.removeAttribute("onmouseover");
}
if(_2248.getAttribute("onmouseout")!=null){
_2248.removeAttribute("onmouseout");
}
handleBordersInInsertCol(_2248,_2254);
_2246[row]=_2254;
_2247[row]=_2248;
}
return {insertCellArr:_2246,newCellArr:_2247};
}
function _insertCells(_2255,_2256,_2257,cnt,_2259,pos,_225b){
var _225c=getAvailableStartRow();
var _225d=getAvailableEndRow();
if(isUndefined(_225b)){
_225b=sheetPaneId;
}
var _225e=[];
var _225f=((pos=="after"||pos=="append")&&(_2256==totCols))?true:false;
if(_225b===sheetPane1Id||_225b===sheetPane2Id){
_225c=0;
_225d=ROWS_PER_TILE-1;
}
var _2260=!(_225b==sheetPane1Id||_225b==sheetPane2Id)?Row.getAvailableRows():Row.getLoadedRowsInFrozenRange();
var len=_2260.length;
for(var i=0;i<len;i++){
var row=_2260[i];
var _2264=document.createDocumentFragment();
var _2265=_2255[row].cloneNode(true);
if(_225f){
var _2266=getColLeft(_2256-1)+getColWidth(_2256-1);
}else{
var _2266=getColLeft(_2256);
}
var diffX=0;
for(var j=0;j<cnt;j+=1){
var _2265=_2255[row].cloneNode(true);
_2265.style.left=_2266+"px";
if(pos=="append"){
_2259=getColWidth(_2256+j);
_2265.style.width=_2259+"px";
}
_2264.appendChild(_2265);
_2266+=_2259;
diffX+=_2259;
}
_225e[row]=_2264;
}
shiftCellsHorizontally(_2256,totCols-1,{mode:"DIFF",val:(diffX)},_225b);
for(var i=0;i<len;i++){
var row=_2260[i];
if(i%ROWS_PER_TILE===0){
if(_225b==sheetPane1Id||_225b==sheetPane2Id){
var tile=getTile(0,_225b);
}else{
var tile=getTile(getTileIndex(row),_225b);
}
}
tile.insertBefore(_225e[row],_2257[row]);
}
}
function _insertColHead(cnt,_226b,_226c,pos,_226e){
var _226f=document.createDocumentFragment();
var _2270=(pos=="before")&&(_226c==0)?true:false;
var _2271=((pos=="after"||pos=="append")&&(_226c==totCols))?true:false;
if(_2271){
var _2272=getColLeft(_226c-1)+getColWidth(_226c-1);
}else{
if(_2270){
var _2272=0;
}else{
var _2272=getColLeft(_226c);
}
}
var diff=0;
for(var j=0;j<cnt;j+=1){
_226b=_226b.cloneNode(true);
if(pos=="append"){
_226e=getColWidth(_226c+j);
_226b.style.width=_226e+"px";
}
_226b.innerHTML=getColHeadLabel(_226c+j+1);
_226b.style.left=_2272+"px";
_226f.appendChild(_226b);
_2272+=_226e;
diff+=_226e;
}
colHeadTable.insertBefore(_226f,getColHead(_226c));
var _2275=getColHeads(_226c+cnt,(totCols-1+cnt));
for(var i=0;i<_2275.length;i++){
_2275[i].style.left=(parseInt(_2275[i].style.left)+diff)+"px";
}
}
function incrColWidth(_2277,_2278){
}
function deleteCol(_2279,cnt,_227b,_227c,_227d,_227e,_227f){
var _2280=false;
if(_227d&&cellFieldSPAN!=null&&!isCellFieldSPANHided()&&!isFormulaCell()){
if(currCol>_2279){
currCol-=(cnt);
}else{
if(currCol==_2279){
}
}
}
if(!_227d&&isCellEdited()){
submitCell();
}
if(cutStatus||copyStatus){
resetCellRangeFill("copy");
}
if(typeof _227d=="undefined"){
_227d="false";
}
if(typeof _227b=="undefined"){
var _227b=false;
}
if(typeof _2279=="undefined"&&typeof cnt=="undefined"){
if(isCellRange()){
var _2279=getCellRange().startCol;
var _2281=getCellRange();
var cnt=_2281.endCol-_2281.startCol+1;
}else{
var _2279=currCol;
var cnt=1;
}
}
if(ISFREEZED){
if(isColsOnlyFreezed||isColsAndRowsFreezed){
if(_2279<FREEZED_COL){
if(!_227b){
showAlertDialog(jsTitleMsg["FreezePanes.Columndeletionnotsupported"]);
}
return true;
}
}
}
if(Merge.isSheetMergeXists()){
splitCells(0,0,0,0);
return true;
}
if(isPartOfArray(0,_2279,65535,(_2279+cnt-1))){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return true;
}
clearOldArrayPosition(0,_2279,65535,(_2279+cnt-1));
updateArrayDetails("DELETECOL",_2279,cnt,currRow,currCol);
var _2282=_2279;
if(_2279==0&&cnt>=totCols){
_2280=true;
insertCol("append",totCols-1,1,true,true,false,undefined,undefined,undefined,undefined,true);
}
var _2283=getCellRange().startCol;
var _2284=getCellRange().endCol;
var _2285=[];
var _2286=[];
if(cnt>1){
var _2286=ole.getObjectsByPositionX(getColLeft(_2283),getColLeft(_2284+1));
var _2287=ole.getObjectsByPositionX(getColLeft(_2284+1));
}else{
var _2288=getColLeft(_2284)+getColWidth(_2284);
var _2286=ole.getObjectsByPositionX(getColLeft(_2283),_2288);
var _2287=ole.getObjectsByPositionX(getColLeft(_2284+1));
}
if(_2286.length!=0){
for(var i=0;i<=_2286.length-1;i++){
OLE[_2286[i].id].sColDiff=0;
OLE[_2286[i].id].sCol=_2283;
OLE[_2286[i].id].setLeft(getColLeft(_2283));
}
}
for(var i=0;i<_2287.length;i++){
OLE[_2287[i].id].sCol=OLE[_2287[i].id].sCol-cnt;
var _228a=parseInt(OLE[_2287[i].id].sColDiff);
var col=parseInt(OLE[_2287[i].id].sCol);
var width=parseInt(getColWidth(col));
var left=parseInt(getColLeft(col));
if(_228a>width){
_2285[i]=left+width;
}else{
_2285[i]=left+_228a;
}
OLE[_2287[i].id].setLeft(_2285[i]);
}
var _228e=ole.getObjects();
ole.conf.onPositionChange(_228e);
var diff=0;
for(var i=_2279;i<_2279+cnt;i++){
diff+=getColWidth(i);
}
_removeColHeadsDeleteCol(cnt,_2279,diff);
_removeCellsDeleteCol(cnt,_2279,diff);
if(ISFREEZED){
if(FREEZED_ROW>0){
_removeCellsDeleteCol(cnt,_2279,diff,sheetPane2Id);
}
if(FREEZED_COL>0){
_removeCellsDeleteCol(cnt,_2279,diff,sheetPane3Id);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_removeCellsDeleteCol(cnt,_2279,diff,sheetPane1Id);
}
}
resetCols(_2279,totCols,cnt,"DELETE");
var _2290=getAvailableStartRow();
var _2291=getAvailableEndRow();
setColDetails("DELETE",_2279,cnt,diff);
Merge.shiftColumn(_2279,cnt,false);
if(_2279<=copyRangeEndCol&&tmpSheetName==CURRSHEETNAME&&(copyStatus||cutStatus)){
copyRangeStartCol-=cnt;
copyRangeEndCol-=cnt;
resetCellRangeFillDIV();
}
var width=(getSheetTableWidth()-(diff));
setSheetTableWidth(width);
totCols-=cnt;
if(!_227c){
_2281=getCellRange();
document.cellform.startColumn.value=_2281.startCol;
document.cellform.endColumn.value=totCols-1;
document.cellform.startRow.value=0;
document.cellform.endRow.value=totRows-1;
document.cellform.row.value=ActiveCellInfo.getStartRow();
document.cellform.column.value=_2279;
document.cellform.cellValue.value=cnt;
document.cellform.actionMode.value="DeleteCol";
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_227d;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.view.value=getObj("VIEW").value;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=getAvailableStartRow();
document.cellform.availableEndRow.value=getAvailableEndRow();
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=false;
document.cellform.usedRow.value=usedCursRow;
document.cellform.totCols.value=totCols;
if(_227d=="true"){
document.cellform.U_FN.value=_227e;
document.cellform.U_AO.value=_227f;
}
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2292=getObj("apiKey");
if(_2292!=null){
document.cellform.apiKeyId.value=_2292.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
}
if(totCols+cnt-1<getColMax()){
if(_2280){
insertCol("append",totCols,cnt-1,true,true,true,undefined,undefined,undefined,undefined,true);
}else{
insertCol("append",totCols,cnt,true,true,true,undefined,undefined,undefined,undefined,true);
}
}
drawCols();
setFocusInCellField();
Userpresence.send();
}
function _removeCellsDeleteCol(cnt,_2294,diff,_2296){
var _2297=getAvailableStartRow();
var _2298=getAvailableEndRow();
if(isUndefined(_2296)){
_2296=sheetPaneId;
}
if(_2296==sheetPane1Id||_2296==sheetPane2Id){
_2297=0;
_2298=ROWS_PER_TILE-1;
}
var _2299=[];
var _229a=!(_2296==sheetPane1Id||_2296==sheetPane2Id)?Row.getAvailableRows():Row.getLoadedRowsInFrozenRange();
var len=_229a.length;
for(var i=0;i<len;i++){
var _229d=[];
var row=_229a[i];
for(var j=_2294,k=0;j<(_2294+cnt);j+=1,k++){
_229d[k]=getCell(row,j,_2296,true);
}
_2299[row]=_229d;
}
shiftCellsHorizontally(_2294+cnt,totCols-1,{mode:"DIFF",val:(-diff)},_2296);
for(var i=0;i<len;i++){
var row=_229a[i];
if(i%ROWS_PER_TILE===0){
if(_2296==sheetPane1Id||_2296==sheetPane2Id){
var tile=getTile(0,_2296);
}else{
var tile=getTile(getTileIndex(row),_2296);
}
}
for(var j=0;j<cnt;j+=1){
tile.removeChild(_2299[row][j]);
}
}
}
function _removeColHeadsDeleteCol(cnt,_22a3,diff){
var _22a5=getColHeads(_22a3,_22a3+cnt-1);
var _22a6=getColHeads(_22a3,(totCols-1));
for(var i=0;i<_22a6.length;i++){
_22a6[i].style.left=(parseInt(_22a6[i].style.left)-diff)+"px";
}
for(var i=0,len=_22a5.length;i<len;i++){
colHeadTable.removeChild(_22a5[i]);
}
}
function removeColTags(_22a9,cnt,idx){
if(browser_ie){
var _22ac=_22a9.childNodes;
for(i=cnt;i>0;i-=1){
var node=_22ac.item(idx+(i-1));
node.removeNode(true);
}
}else{
for(i=cnt;i>0;i-=1){
_22a9.removeChild(_22a9.childNodes[idx+(i-1)]);
}
}
}
function setColumnWidth(_22ae){
var _22af="";
comntaction=_22ae;
if((isColsOnlyFreezed||isColsAndRowsFreezed)&&currCol<FREEZED_COL){
showAlertDialog(jsTitleMsg["FreezePanes.Columnresizingnotsupported"]);
return;
}
var value=getColWidth(currCol);
_22af=getWidthHeightHtml("setcolumnwidth",value);
showDialog(_22af,"position=current, width=180, closeOnBodyClick=yes, closeOnEscKey=yes,title="+jsTitleMsg.ColumnWidth);
var _22b1=getObj("col_width");
if(!browser_ie&&!browser_opera){
_22b1.focus();
}else{
setCaretPos(_22b1,_22b1.value.length);
}
}
function drawColsRows(){
drawCols();
drawRows();
}
function drawRows(){
var _22b2=getSheetTableHeight();
if(getSheetHeight()<_22b2){
return;
}
var _22b3=getSheetHeight();
if(_22b3>_22b2){
var _22b4=totRows;
while(_22b3>_22b2){
_22b2+=getRowHeight(_22b4);
_22b4+=1;
}
totRows=getCeilRow(_22b4);
setSheetTableHeight(getRowTop(totRows-1)+getRowHeight(totRows-1));
if(ISFREEZED&&FREEZED_COL>0){
setVFreezeCueHeight();
}
}
}
function drawCols(){
var _22b5=getSheetTableWidth();
if(getSheetWidth()<_22b5){
return;
}
if(getSheetWidth()>_22b5){
var _22b6=getColMax();
if(totCols<_22b6){
var diff=getSheetWidth()-_22b5;
var _22b8=0;
while(diff>0){
if(totCols+_22b8+1>=_22b6){
break;
}
diff-=getColWidth(totCols+_22b8);
_22b8+=1;
}
if(_22b8>0){
insertCol("append",totCols,_22b8,true,true,false,undefined,undefined,undefined,undefined,true);
}
if(ISFREEZED&&FREEZED_ROW>0){
setHFreezeCueWidth();
}
if(isWholeSheetSelected()||isRowSelected()){
focusAllCells();
}
}
}
}
function colHeadDblClick(ev,obj){
if(!READ_WRITE){
return;
}
if(!isCellFieldSPANHided()){
submitCell();
}
clearTextSelection();
if(browser_ie){
var el=window.event.srcElement;
var _22bc=(ev.button==2);
}else{
if(browser_nn6){
var el=ev.target;
var _22bc=(ev.which==3);
}
}
if(el.tagName=="DIV"&&isColHead(el)){
var _22bd=false;
var x=getCursorPos(ev).x;
var col=getColPosInMouseEvent(ev);
var elX=sheetLeft+getColLeft(col)-colHead.scrollLeft;
var _22c1=parseInt(el.style.width);
if(_22c1<30){
var _22c2=2;
}else{
var _22c2=10;
}
if(x>=elX&&x<=elX+_22c2){
_22bd=true;
currColHeadCnt=col-1;
}else{
if(x>=(elX+_22c1-_22c2)&&x<=elX+_22c1+_22c2){
_22bd=true;
currColHeadCnt=col;
}
}
if(_22bd){
var _22c3=getCellRange();
if(ISFREEZED){
if(isColsOnlyFreezed||isColsAndRowsFreezed){
var _22c4=currColHeadCnt;
var _22c3;
if(isCellRange()){
_22c3=getCellRange();
if(currColHeadCnt<_22c3.startCol){
_22c4=currColHeadCnt;
}else{
_22c4=_22c3.startCol;
}
}
if(_22c4<FREEZED_COL){
if(isCellRange()&&_22c3.endCol>=FREEZED_COL){
if(currColHeadCnt>=FREEZED_COL){
showAlertDialog(jsTitleMsg["FreezePanes.Columnresizingnotsupported"]);
}
}
return;
}
}
}
width_height_action("OptimalWidth","",currColHeadCnt,currColHeadCnt);
}else{
clearTextSelection();
}
}
}
function handleBordersInInsertCol(_22c5,_22c6){
if(isObject(_22c5)&&isObject(_22c6)&&_22c6!=null){
var _22c7=_22c5.className;
var _22c8=_22c6.className;
var _22c9=getCSSStyleRegex("borderRight");
var _22ca=getCSSStyleRegex("borderLeft");
var _22cb=getCSSStyleRegex("borderBottom");
var _22cc=getCSSStyleRegex("borderTop");
var bRArr=_22c9.exec(_22c7);
var bLArr=_22ca.exec(_22c7);
var bBArr=_22cb.exec(_22c7);
var bTArr=_22cc.exec(_22c7);
if(bRArr!=null){
var _22d1=_22c9.exec(_22c8);
if(_22d1==null||(bRArr[0]!=_22d1[0])){
removeCSSStyle("borderRight",_22c5);
}
}
if(bLArr!=null){
var _22d2=_22ca.exec(_22c8);
if(_22d2==null||(bLArr[0]!=_22d2[0])){
removeCSSStyle("borderLeft",_22c5);
}
}
if(bBArr!=null){
var _22d3=_22cb.exec(_22c8);
if(_22d3==null||(bBArr[0]!=_22d3[0])){
removeCSSStyle("borderBottom",_22c5);
}
}
if(bTArr!=null){
var _22d4=_22cc.exec(_22c8);
if(_22d4==null||(bTArr[0]!=_22d4[0])){
removeCSSStyle("borderTop",_22c5);
}
}
}
}
function focusRow(_22d5,_22d6,ev,_22d8){
if(typeof _22d6=="undefined"){
var _22d6=_22d5;
}
if((isCellEdited()&&cellField.value.indexOf("=")==0)||formulaCell||isExprFunc||(isFuncDlgOpen&&getObj("funcList")!=null)||isRangeEdit||(isChartDialogOpened&&getObj("chartDataDIV")!=null&&getObj("chartDataDIV").style.display!="none")||isPivotDialogOpen||isEditPivotDialogOpen){
insertCellRangeInit();
focusCellRangeFill(_22d5,-1,_22d6,totCols-1);
}else{
if(isCellEdited()){
submitCell();
}
if(!ev){
ev="ROW";
}
focusCellRange(_22d5,-1,_22d6,getColMax()-1,ev,_22d8);
}
}
function rowHeadClick(ev,obj){
if(!isCellFieldSPANHided()&&isPartOfArray(currRow,currCol,currRow,currCol)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
if(isFilterOptionsDIVOpened){
Filter.hideFilterOptions();
}
if(isCellEdited()&&!isFormulaCell()){
submitCell();
}
if(browser_ie){
var el=window.event.srcElement;
var _22dc=(ev.button==2);
}else{
if(browser_nn6){
var el=ev.target;
var _22dc=(ev.which==3);
}
}
if(_22dc&&el.tagName=="DIV"&&isRowHead(el)&&el.className=="rowHeadFocus"&&getCellRange().endCol==totCols-1){
return false;
}
if(_22dc&&isWholeSheetSelected()){
return;
}
if(el.tagName=="DIV"&&isRowHead(el)){
var _22dd=false;
var y=getCursorPos(ev).y;
var row=getRowPosInMouseEvent(ev);
var elY=sheetTop+getRowTop(row)-rowHead.scrollTop;
var _22e1=getRowHeight(row);
if(_22e1<10){
var _22e2=1;
}else{
var _22e2=4;
}
if(y>=elY&&y<=elY+_22e2){
_22dd=true;
currRowHeadCnt=Row.findNextNonHiddenRow(row,false);
currRowHeadCnt=(currRowHeadCnt<0)?0:currRowHeadCnt;
currRowHead=getRowHead(currRowHeadCnt);
currRowHeadTop=sheetTop+getRowTop(currRowHeadCnt)-rowHead.scrollTop;
currRowHeadHeight=currRowHeadNewHeight=getRowHeight(currRowHeadCnt);
}else{
if(y>=(elY+_22e1-_22e2)&&y<=elY+_22e1+_22e2){
_22dd=true;
currRowHeadCnt=row;
currRowHeadCnt=(currRowHeadCnt>totRows)?totRows:currRowHeadCnt;
currRowHead=getRowHead(currRowHeadCnt);
currRowHeadTop=elY;
currRowHeadHeight=currRowHeadNewHeight=_22e1;
}
}
if(_22dd&&isServerComponentLoaded(true)){
if(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE){
return;
}
if(ISFREEZED){
if(isRowsOnlyFreezed||isColsAndRowsFreezed){
var _22e3=currRowHeadCnt;
var _22e4;
if(isCellRange()){
_22e4=getCellRange();
if(currRowHeadCnt<_22e4.startRow){
_22e3=currRowHeadCnt;
}else{
_22e3=_22e4.startRow;
}
}
if(_22e3<FREEZED_ROW){
if(isCellRange()&&_22e4.endRow>=FREEZED_ROW){
if(currRowHeadCnt>=FREEZED_ROW){
showAlertDialog(jsTitleMsg["FreezePanes.Rowresizingnotsupported"]);
}
}
return;
}
}
}
rowHeadTableHeight=getSheetTableHeight()+"px";
if(READ_WRITE){
resizePane.style.left=findPosX(rowHead);
resizePane.style.top=(currRowHeadTop+currRowHeadHeight+((browser_ie)?1:-1))+"px";
resizePane.style.width=addSTDMode(rowHead.offsetWidth+sheet.offsetWidth);
resizePane.style.height="1px";
resizePane.style.cursor="row-resize";
}
rowHeadTable.onmouseover=null;
rowHeadTable.style.cursor="row-resize";
currRowHeads=getRowHeads(currRowHeadCnt+1,getLastRowInRowHdr());
currRowHeadHeight=getRowHeight(currRowHeadCnt);
if(READ_WRITE){
if(browser_ie){
resizeOverlay.style.left=findPosX(rowHead)+"px";
resizeOverlay.style.top=findPosY(colHead)+"px";
resizeOverlay.style.width=sheet.offsetWidth+"px";
resizeOverlay.style.height=sheet.offsetHeight+"px";
resizeOverlay.style.cursor="row-resize";
document.attachEvent("onmousemove",resizeRow);
document.attachEvent("onmouseup",endResizeRow);
}else{
document.addEventListener("mousemove",resizeRow,false);
document.addEventListener("mouseup",endResizeRow,false);
stopEvt(ev);
}
}
}else{
var info=Merge.getCellInfo(row,0);
if(info&&info.isRow()){
row=info["startRow"];
}
if((isCellEdited()&&cellField.value.indexOf("=")==0)||formulaCell||isExprFunc||(isFuncDlgOpen&&getObj("funcList")!=null)||isRangeEdit||(isChartDialogOpened&&getObj("chartDataDIV")!=null&&getObj("chartDataDIV").style.display!="none")||isPivotDialogOpen||isEditPivotDialogOpen){
if(ev.shiftKey){
var info=ActiveFormulaInfo;
if(info.isAvailable()){
var _22e6=ActiveFormulaInfo.getActiveRow();
}else{
ActiveFormulaInfo.set(row,0);
var _22e6=row;
}
var _22e7=row;
}else{
ActiveFormulaInfo.set(row,0);
var _22e6=row;
var _22e7=row;
}
}else{
if(isCellRange()){
resetCellRange();
}else{
blurCell(currRow,currCol);
}
rowSelected=true;
rowSelection=true;
currCol=0;
selRow=row;
horiArea="DEFAULT";
selectionTop=getEndTopOfRow(row);
if(ev.shiftKey){
clearTextSelection();
}else{
currRow=row;
ActiveCellInfo.reset(currRow,currCol);
}
currCell=getCell(currRow,currCol);
if(currCell){
updateActiveCellDependencies(currCell);
}
var _22e6=currRow;
var _22e7=row;
}
focusRow(_22e6,_22e7);
if(browser_ie){
document.attachEvent("onmousemove",selectRow);
document.attachEvent("onmouseup",endSelectRow);
}else{
if(browser_nn6){
document.addEventListener("mousemove",selectRow,false);
document.addEventListener("mouseup",endSelectRow,false);
}
}
}
}
if(browser_opera&&ev.altKey&&READ_WRITE){
if(browser_ie){
document.detachEvent("onmousemove",resizeRow);
document.detachEvent("onmouseup",endResizeRow);
}else{
if(browser_nn6){
document.removeEventListener("mousemove",resizeRow,false);
document.removeEventListener("mouseup",endResizeRow,false);
}
}
setTimeout(function(){
return contextmenu(obj,ev);
},0);
}
}
var currRowHeads,currRowHeadNewHeight=0;
function resizeRow(ev){
clearTextSelection();
var y=getCursorPos(ev).y;
var _22ea=y-currRowHeadTop;
if(_22ea>0&&_22ea<=sheetBottom-currRowHeadTop){
}else{
if(_22ea>(sheetBottom-currRowHeadTop)){
_22ea=(sheetTop+sheetHeight)-currRowHeadTop;
y=sheetTop+sheetHeight;
}else{
_22ea=1;
y=_22ea+currRowHeadTop;
}
}
var _22eb=_22ea-currRowHeadNewHeight;
resizePane.style.top=y+"px";
currRowHead.style.height=_22ea+"px";
currRowHeadNewHeight=_22ea;
for(var i=0,len=currRowHeads.length;i<len;i++){
shiftRowHead(currRowHeads[i],{mode:"DIFF",val:_22eb});
}
}
function endResizeRow(){
hideElement(resizePane);
if(browser_ie){
hideElement(resizeOverlay);
}
if(browser_ie){
document.detachEvent("onmousemove",resizeRow);
document.detachEvent("onmouseup",endResizeRow);
}else{
if(browser_nn6){
document.removeEventListener("mousemove",resizeRow,false);
document.removeEventListener("mouseup",endResizeRow,false);
}
}
rowHeadTable.onmouseover=function(event){
setCursor(event,rowHeadTable);
};
var diff=currRowHeadNewHeight-currRowHeadHeight;
if(diff==0){
return;
}
var _22f0=currRowHeadCnt;
var _22f1=currRowHeadCnt;
if(isRowSelected()){
var _22f2=getCellRange();
var _22f3=_22f2.startRow;
var _22f4=_22f2.endRow;
if(_22f3<=currRowHeadCnt&&currRowHeadCnt<=_22f4){
_22f0=_22f3;
_22f1=_22f4;
}
}
width_height_action("height",currRowHeadNewHeight,_22f0,_22f1);
}
function incrRowHeight(_22f5,_22f6,pos,_22f8){
var _22f9;
var _22fa;
if(ISFREEZED){
if(isRowsOnlyFreezed||isColsAndRowsFreezed){
var _22fb=rowHeadTable2.rows[_22f5-FREEZED_ROW].cells[0];
}else{
if(isColsOnlyFreezed){
var _22fb=rowHeadTable.rows[_22f5].cells[0];
}
}
}else{
var _22fb=rowHeadTable.rows[_22f5].cells[0];
}
var _22fc=parseInt(_22fb.style.height);
newHt=_22fc+6;
if(newHt<initRowHeight&&initRowHeight-newHt<3){
newHt=_22fc+1;
}
if(newHt<=initRowHeight){
for(var i=_22f5;i<_22f6;i+=1){
if(ISFREEZED){
if(isRowsOnlyFreezed||isColsAndRowsFreezed){
var _22fb=rowHeadTable2.rows[i-FREEZED_ROW].cells[0];
}else{
if(isColsOnlyFreezed){
var _22fb=rowHeadTable.rows[i].cells[0];
}
}
}else{
_22fb=rowHeadTable.rows[i].cells[0];
}
if(ISFREEZED){
if(isRowsOnlyFreezed){
_22f9=sheetTable3.rows[i-FREEZED_ROW].cells[0];
}else{
if(isColsOnlyFreezed){
_22f9=sheetTable1.rows[i].cells[0];
_22fa=sheetTable2.rows[i].cells[0];
}else{
_22f9=sheetTable3.rows[i-FREEZED_ROW].cells[0];
_22fa=sheetTable4.rows[i-FREEZED_ROW].cells[0];
}
}
}else{
_22f9=sheetTable.rows[i].cells[0];
}
if(typeof _22fa!="undefined"&&_22fa!=null){
_22fb.style.height=_22f9.style.height=_22fa.style.height=newHt+"px";
}else{
_22fb.style.height=_22f9.style.height=newHt+"px";
}
}
}else{
window.clearInterval(rowHtIncrIntvl);
if(ISFREEZED){
if(isRowsOnlyFreezed){
rowHeadTable2.style.height=sheetTable3.style.height=(parseInt(rowHeadTable2.style.height)+(initRowHeight*(_22f6-_22f5)))+"px";
}else{
if(isColsOnlyFreezed){
rowHeadTable.style.height=sheetTable1.style.height=sheetTable2.style.height=ssVScrollDIV.style.height=(parseInt(rowHeadTable.style.height)+(initRowHeight*(_22f6-_22f5)))+"px";
}else{
rowHeadTable2.style.height=sheetTable3.style.height=sheetTable4.style.height=(parseInt(rowHeadTable2.style.height)+(initRowHeight*(_22f6-_22f5)))+"px";
}
}
ssVScrollDIV.style.height=totalTableHeight+"px";
}else{
rowHeadTable.style.height=sheetTable.style.height=ssVScrollDIV.style.height=(parseInt(rowHeadTable.style.height)+(initRowHeight*(_22f6-_22f5)))+"px";
}
focusSheet();
if(_22f8){
if(pos=="above"){
splitCells();
}else{
splitCells(_22f5,0,_22f6,totCols-1,true);
}
}
}
}
function setRowHeight(_22fe){
var _22ff="";
comntaction=_22fe;
if((isRowsOnlyFreezed||isColsAndRowsFreezed)&&currRow<FREEZED_ROW){
showAlertDialog(jsTitleMsg["FreezePanes.Rowresizingnotsupported"]);
return;
}
var hei=getRowHeight(currRow);
_22ff=getWidthHeightHtml("setrowheight",hei);
title=jsTitleMsg.RowHeight;
showDialog(_22ff,"position=current, width=180, closeOnBodyClick=yes, closeOnEscKey=yes, title="+jsTitleMsg.RowHeight);
var _2301=getObj("row_height");
if(!browser_ie&&!browser_opera){
_2301.focus();
}else{
setCaretPos(_2301,_2301.value.length);
}
}
function adjustRowHeight(sRow,eRow){
var _2304=0;
var srow=0;
var erow=usedCursRow;
if(typeof sRow!="undefined"){
srow=sRow;
}
if(typeof eRow!="undefined"){
erow=eRow;
}
for(rowNum=srow;rowNum<=erow;rowNum++){
var _2307=getCell(rowNum,0).offsetHeight;
var _2308=getCell(rowNum,0).style.height;
if(parseInt(_2307)!=parseInt(_2308)){
getRowHead(rowNum).style.height=getCell(rowNum,0).style.height=_2307;
if(parseInt(_2307)<rowHeadDIVAdjust){
getRowHeadDIV(rowNum).style.height=_2307;
}else{
getRowHeadDIV(rowNum).style.height=parseInt(_2307)-rowHeadDIVAdjust;
}
_2304+=(parseInt(_2307)-parseInt(_2308));
}
}
if(_2304!=0){
setSheetTableHeight(getSheetTableHeight()+_2304);
}
}
function adjustRowHeightNodes(sRow,eRow){
var _230b=0;
var srow=0;
var erow=usedCursRow;
if(typeof sRow!="undefined"){
srow=sRow;
}
if(typeof eRow!="undefined"){
erow=eRow;
}
var _230e;
var _230f;
_230e=sheetTable.getElementsByTagName("tr");
var _2310=rowHeadTable.getElementsByTagName("tr");
for(rowNum=srow;rowNum<=erow;rowNum++){
var _2311=_230e[rowNum-FREEZED_ROW].childNodes[0];
var _2312;
if(_230f!=null&&typeof _230f!="undefined"){
_2312=_230f[rowNum-FREEZED_ROW].childNodes[0];
}
var _2313=parseInt(_2311.offsetHeight);
var _2314=parseInt(_2311.style.height);
var _2315=_2310[rowNum-FREEZED_ROW].childNodes[0];
if(_2313<stdCellHeight){
_2313=stdCellHeight;
}
if(_2313!=_2314){
_2315.style.height=_2313;
_2311.style.height=_2313;
if(_2312!=null&&typeof _2312!="undefined"){
_2312.style.height=_2313;
}
_2315.childNodes[0].style.height=_2313-rowHeadDIVAdjust;
}
}
}
function adjustRowHeightHandle(sRow,eRow,val){
if(sRow=="init"){
adjustRowHeightNodes();
}else{
var _2319=getCellRange();
var srow=_2319.startRow;
var erow=_2319.endRow;
if(typeof sRow!="undefined"){
srow=sRow;
}
if(typeof eRow!="undefined"){
erow=eRow;
}
adjustRowHeightNodes(srow,erow);
}
if(val=="resize"){
sheetTable.style.tableLayout="";
sheetTable.style.tableLayout="fixed";
}
}
function rowHeadDblClick(ev,obj){
if(!READ_WRITE){
return;
}
if(!isCellFieldSPANHided()){
submitCell();
}
clearTextSelection();
if(browser_ie){
var el=window.event.srcElement;
var _231f=(ev.button==2);
}else{
if(browser_nn6){
var el=ev.target;
var _231f=(ev.which==3);
}
}
if(el.tagName=="DIV"&&isRowHead(el)){
var _2320=false;
var y=getCursorPos(ev).y;
var row=getRowPosInMouseEvent(ev);
var elY=sheetTop+getRowTop(row)-rowHead.scrollTop;
var _2324=getRowHeight(row);
if(_2324<10){
var _2325=1;
}else{
var _2325=4;
}
if(y>=elY&&y<=elY+_2325){
_2320=true;
currRowHeadCnt=row-1;
}else{
if(y>=(elY+_2324-_2325)&&y<=elY+_2324+_2325){
_2320=true;
currRowHeadCnt=row;
}
}
if(_2320){
var _2326=getCellRange();
if(ISFREEZED){
if(isRowsOnlyFreezed||isColsAndRowsFreezed){
var _2327=currRowHeadCnt;
var _2326;
if(isCellRange()){
_2326=getCellRange();
if(currRowHeadCnt<_2326.startRow){
_2327=currRowHeadCnt;
}else{
_2327=_2326.startRow;
}
}
if(_2327<FREEZED_ROW){
if(isCellRange()&&_2326.endRow>=FREEZED_ROW){
if(currRowHeadCnt>=FREEZED_ROW){
showAlertDialog(jsTitleMsg["FreezePanes.Rowresizingnotsupported"]);
}
}
return;
}
}
}
width_height_action("OptimalHeight","",currRowHeadCnt,currRowHeadCnt);
}else{
clearTextSelection();
}
}
}
Row={HIDDENROW_INDEX_INTERVAL:1000,DO_NOT_USE_MINIFIED_ARY:false,MINIFIED_HIDDEN_INFO_THRESHOLD:10000,predictNthNonHiddenRow:function(n,_2329,_232a){
var count=0;
var _232c=Row.isHidden;
var _232d=_232a;
for(var i=_232a,max=getRowMax();i<max;i++){
if(count===n){
_232d=i;
break;
}
if(!_232c(i)&&_2329.indexOf(i)===-1){
count++;
}
}
return _232d;
},hide:function(_2330,endR,_2332,_2333){
var _2334=[];
var _2335,endR;
isFirstArgumentArray=isArray(_2330);
if(isFirstArgumentArray){
_2334=_2330;
_2335=_2334[0];
}else{
if(_2330===undefined){
var _2336=getCellRange();
_2335=_2336.startRow;
endR=_2336.endRow;
if(isColSelected()){
_2334="all";
}else{
_2334=Row.getNonHiddenRowsInRange(_2335,endR);
}
}else{
_2335=_2330;
if(_2335===0&&endR===65535){
_2334="all";
}else{
_2334=Row.getNonHiddenRowsInRange(_2335,endR);
}
}
}
if(!_2334.length){
return;
}
setRowDetails("HIDE",_2334);
if(!(_2333===false)){
width_height_action("HIDE_ROWS",undefined,_2335,endR,_2332);
}
Row.dom.hide(_2334);
},updateHiddenInfo:function(_2337,_2338){
var _2339;
var value=(_2338)?1:0;
if(_2337==="all"){
_2339=true;
var len=getRowMax()-1;
if(len>0){
do{
hiddenRowInfo[len]=value;
}while(len--);
}
}else{
for(var i=0,len=_2337.length,_2339=(len>0);i<len;i++){
hiddenRowInfo[_2337[i]]=value;
}
}
_2339&&Row.minifyHiddenRowInfo();
},clearHiddenRowCache:function(){
Row.cachedStartRow=undefined;
},isHidden:function(row){
var _233e=filterMetaInfo?filterMetaInfo.isCriteriaApplied:Filter.isApplied();
return (_233e&&(range=Filter.getInstance().range,(row>=range.sR&&row<=range.eR&&rowHeightAry[row]===0)));
if(this.DO_NOT_USE_MINIFIED_ARY){
return hiddenRowInfo[row];
}else{
var len=hiddenRowStartIdxAry.length;
var _2340=false;
var _2341,_2342;
var _2343=Row.getFloorIdxInMinifiedAry(row);
if(_2343===undefined){
return false;
}
while(_2343<len){
_2342=hiddenRowEndIdxAry[_2343];
if(row>_2342){
_2343++;
continue;
}else{
if(row>=hiddenRowStartIdxAry[_2343]){
_2340=true;
}
}
break;
}
return _2340;
}
},isAppendable:function(row){
if(row>=totRows&&row<=Row.lastNonHiddenRow){
return true;
}else{
return false;
}
},getHiddenRowsInRange:function(_2345,_2346){
var _2347=[];
if(!Row.hasHiddenRows()){
return _2347;
}
if(this.DO_NOT_USE_MINIFIED_ARY){
if(typeof _2345==="undefined"){
_2345=0;
}
if(typeof _2346==="undefined"){
_2346=getRowMax()-1;
}
for(var i=_2345;i<=_2346;i++){
Row.isHidden(i)&&_2347.push(i);
}
return _2347;
}else{
var _2349=this.trimHiddenRange(_2345,_2346);
_2345=_2349.startRow;
_2346=_2349.endRow;
var _234a=this.getFloorIdxInMinifiedAry(_2345);
if(_234a!==undefined){
var end=(hiddenRowEndIdxAry[_234a]>_2346)?_2346:hiddenRowEndIdxAry[_234a];
for(var i=_2345;i<=end;i++){
_2347.push(i);
}
while(hiddenRowStartIdxAry[++_234a]<=_2346){
end=(_2346<hiddenRowEndIdxAry[_234a])?_2346:hiddenRowEndIdxAry[_234a];
for(var i=hiddenRowStartIdxAry[_234a];i<=end;i++){
_2347.push(i);
}
}
}
return _2347;
}
},getHiddenRowCount:function(_234c,_234d){
if(!Row.hasHiddenRows()){
return 0;
}
if(this.DO_NOT_USE_MINIFIED_ARY){
return this.getHiddenRowsInRange(_234c,_234d).length;
}else{
var _234e=0;
var _234f=this.trimHiddenRange(_234c,_234d);
_234c=_234f.startRow;
_234d=_234f.endRow;
var _2350=this.getFloorIdxInMinifiedAry(_234c);
if(_2350!==undefined){
var _2351=hiddenRowEndIdxAry[_2350];
_234e=(_234c>_2351)?0:((_234d>_2351)?_2351:_234d)+1-_234c;
while(hiddenRowStartIdxAry[++_2350]<=_234d){
var end=(_234d<hiddenRowEndIdxAry[_2350])?_234d:hiddenRowEndIdxAry[_2350];
_234e+=end-hiddenRowStartIdxAry[_2350]+1;
}
}
if(_234e<0){
_234e=0;
}
return _234e;
}
},getFirstHiddenRow:function(){
return Row.firstHiddenRow;
},getFirstNonHiddenRow:function(){
return Row.firstNonHiddenRow;
},getLastHiddenRow:function(){
return Row.lastHiddenRow;
},getLastNonHiddenRow:function(){
return Row.lastNonHiddenRow;
},findNextNonHiddenRow:function(row,_2354){
if(_2354===undefined){
_2354=true;
}
return this.findNthNonHiddenRow(1,row,_2354);
},getNonHiddenRowsInRange:function(_2355,_2356){
var _2357=[];
if(!Row.hasHiddenRows()){
for(var i=_2355;i<=_2356;i++){
_2357.push(i);
}
return _2357;
}
if(this.DO_NOT_USE_MINIFIED_ARY){
var _2359=Row.isHidden;
if(typeof _2355==="undefined"){
_2355=0;
}
if(typeof _2356==="undefined"){
_2356=getRowMax()-1;
}
for(var i=_2355;i<=_2356;i++){
!_2359(i)&&_2357.push(i);
}
return _2357;
}else{
var _235a=this.trimNonHiddenRange(_2355,_2356);
_2355=_235a.startRow;
_2356=_235a.endRow;
var _235b=this.getFloorIdxInMinifiedAry(_2355);
if(_235b!==undefined){
var end=(hiddenRowStartIdxAry[0]<=_2356)?hiddenRowStartIdxAry[0]-1:_2356;
for(var i=_2355;i<=end;i++){
_2357.push(i);
}
while(hiddenRowEndIdxAry[_235b]<_2356){
var _235d=hiddenRowStartIdxAry[_235b+1];
end=(_235d<=_2356)?_235d:_2356+1;
var start=(_2355<=hiddenRowEndIdxAry[_235b]+1)?hiddenRowEndIdxAry[_235b]+1:_2355;
for(var i=start;i<end;i++){
_2357.push(i);
}
_235b++;
}
}else{
for(var i=_2355;i<=_2356;i++){
_2357.push(i);
}
}
return _2357;
}
},getNNonHiddenRows:function(n,_2360){
var _2361=[];
if(!Row.hasHiddenRows()){
for(var i=_2360;i<_2360+n;i++){
_2361.push(i);
}
return _2361;
}
if(this.DO_NOT_USE_MINIFIED_ARY){
var _2363=Row.isHidden;
for(var i=_2360,max=getRowMax();i<max;i++){
if(_2361.length===n){
break;
}
if(!_2363(i)){
_2361.push(i);
}
}
return _2361;
}else{
if(n===0||n>65535||_2360<0||_2360>65535){
return undefined;
}
var _2365=this.getFloorIdxInMinifiedAry(_2360);
var count=0;
if(_2365!==undefined){
var _2367=false;
var max=Row.lastNonHiddenRow;
for(var i=_2360;i<hiddenRowStartIdxAry[_2365];i++){
if(count===n){
break;
}
_2361.push(i);
count++;
}
var start=hiddenRowEndIdxAry[_2365]+1;
start=(_2360>start)?_2360:start;
while(count<n){
var end=((hiddenRowStartIdxAry[_2365+1])?hiddenRowStartIdxAry[_2365+1]:start+n);
if(end>(max+1)){
end=max+1;
_2367=true;
}
for(var i=start;i<end;i++){
_2361.push(i);
if(++count===n){
break;
}
}
if(_2367){
break;
}
_2365++;
start=hiddenRowEndIdxAry[_2365]+1;
}
}else{
for(var i=_2360;i<_2360+n;i++){
_2361.push(i);
}
}
return _2361;
}
},findNthNonHiddenRow:function(n,_236b,_236c){
if(_236c===undefined){
_236c=true;
}
if(_236b<0||n<0){
return undefined;
}
var max=this.lastNonHiddenRow;
var min=this.firstNonHiddenRow;
var _236f;
if(!Row.hasHiddenRows()){
if(_236c){
_236f=(_236b+n);
if(_236f>max){
_236f=max;
}
}else{
_236f=(_236b-n);
if(_236f<min){
_236f=min;
}
}
return _236f;
}
if(this.DO_NOT_USE_MINIFIED_ARY){
var cnt=0;
if(_236c){
for(var i=_236b+1;i<getRowMax();i++){
if(!Row.isHidden(i)){
cnt++;
if(cnt===n){
return i;
}
}
}
}else{
for(var i=_236b-1;i>=0;i--){
if(!Row.isHidden(i)){
cnt++;
if(cnt===n){
return i;
}
}
}
}
return _236b;
}else{
var count=0;
if(_236c){
if(this.lastHiddenRow===-1){
_236f=_236b+n;
return (_236f<=max)?_236f:max;
}
var _2373=this.getFloorIdxInMinifiedAry(_236b);
if(_2373!==undefined){
var _2374=false;
var _2375=0;
if(_236b<hiddenRowStartIdxAry[_2373]){
count=hiddenRowStartIdxAry[_2373]-_236b-1;
if(count>=n){
_236f=_236b+n;
}
}
while(count<n){
var start=(_236b>hiddenRowEndIdxAry[_2373])?_236b:hiddenRowEndIdxAry[_2373];
var _2377=hiddenRowStartIdxAry[_2373+1];
if(_2377!==undefined){
end=_2377-1;
}else{
end=start+n;
}
_2375=end-start;
if(count+_2375>=n){
_236f=start+n-count;
return (_236f<=max)?_236f:max;
}
count=count+_2375;
_2373++;
}
}else{
_236f=_236b+n;
}
return (_236f<=max)?_236f:max;
}else{
var _2379=false;
if(this.lastHiddenRow===-1){
_236f=_236b-n;
return (_236f<min)?min:_236f;
}
var _2373=this.getFloorIdxInMinifiedAry(_236b);
if(_2373!==undefined){
var _237a=_236b-1;
var _2375=_237a-hiddenRowEndIdxAry[_2373];
_2375=(_2375<0)?0:_2375;
if(_2375>=n){
_236f=_237a-n+1;
_2379=true;
}
if(!_2379){
while(_2373>0){
count+=_2375;
_237a=hiddenRowStartIdxAry[_2373]-1;
var end=hiddenRowEndIdxAry[_2373-1];
_2375=_237a-end;
if(_2375+count>=n){
_236f=_237a-(n-count)+1;
_2379=true;
break;
}
_2373--;
}
}
if(!_2379){
_237a=((_236b<hiddenRowStartIdxAry[0])?_236b:hiddenRowStartIdxAry[0])-1;
count+=_2375;
_2375=(_237a-min)+1;
if(_2375<0){
_2375=0;
}
if(count+_2375>=n){
_2379=true;
_236f=_237a-(n-count)+1;
}
}
}else{
_236f=_236b-n;
}
if(_236f===undefined){
_236f=min;
}
return (_236f<min)?min:_236f;
}
}
},findNthHiddenRow:function(n,_237c){
var _237d;
if(startIdx!==undefined){
var count=0;
var _237f=0;
var _2380=(_237c>=hiddenRowEndIdxAry[startIdx])?hiddenRowEndIdxAry[startIdx]:_237c;
do{
_237f=_2380-hiddenRowStartIdxAry[startIdx]+1;
if(count+_237f>=n){
_237d=_2380-(count+_237f-n);
break;
}
count=count+_237f;
_2380=hiddenRowEndIdxAry[startIdx-1];
}while(--startIdx>=0);
}
return _237d;
},getFloorIdxInMinifiedAry:function(row){
var _2382=this.getCeilIdxInMinifiedAry(row);
if(_2382>0){
_2382--;
}
return _2382;
},getCeilIdxInMinifiedAry:function(row){
var _2384=indexedHiddenRowAry[~~(row/Row.HIDDENROW_INDEX_INTERVAL)];
if(_2384===undefined){
return undefined;
}
while(hiddenRowStartIdxAry[_2384]<=row){
_2384++;
}
return _2384;
},getLoadedRowsInRange:function(_2385,_2386){
var _2387=ArrayUtils.getSortedIndex;
var _2388=Row.getAvailableRows();
_2388=Row.getLoadedRowsInFrozenRange().concat(_2388);
var start=_2387(_2388,_2385);
var end=_2387(_2388,_2386);
if(!Row.isHidden(_2386)){
end=end+1;
}
return _2388.slice(start,end);
},getLoadedRowsInFrozenRange:function(){
visibleRowsInFrozenRange=[];
if(FREEZED_ROW>0){
visibleRowsInFrozenRange=Row.getNNonHiddenRows(ROWS_PER_TILE,0);
}
return visibleRowsInFrozenRange;
},getAvailableRowsInFrozenRange:function(){
visibleRowsInFrozenRange=[];
for(var i=0,len=FREEZED_ROW;i<len;i++){
if(getRowHeight(i)!==0){
visibleRowsInFrozenRange.push(i);
}
}
return visibleRowsInFrozenRange;
},getAvailableRowsInRange:function(_238d,_238e,_238f){
var _2390=ArrayUtils.getSortedIndex;
var _2391=Row.getAvailableRows();
if(!_238f&&_2391[0]!==0){
_2391=Row.getAvailableRowsInFrozenRange().concat(_2391);
}
if(_238d instanceof Array){
var _2392=_238d;
var start=_2390(_2392,getAvailableStartRow());
var end=_2390(_2392,getAvailableEndRow()+1);
return _2392.slice(start,end);
}else{
var start=_2390(_2391,_238d);
var end=_2390(_2391,_238e);
if(!Row.isHidden(_238e)){
end=end+1;
}
return _2391.slice(start,end);
}
},trimHiddenRange:function(_2395,_2396){
if(this.firstHiddenRow>=0){
_2395=(_2395>this.firstHiddenRow)?_2395:this.firstHiddenRow;
}
if(this.lastHiddenRow>=0){
_2396=(_2396>this.lastHiddenRow)?this.lastHiddenRow:_2396;
}
return {startRow:_2395,endRow:_2396};
},trimNonHiddenRange:function(_2397,_2398){
if(_2397<this.firstNonHiddenRow){
_2397=this.firstNonHiddenRow;
}
if(_2398>this.lastNonHiddenRow){
_2398=this.lastNonHiddenRow;
}
return {startRow:_2397,endRow:_2398};
},minifyHiddenRowInfo:function(){
var _2399=0;
var count=0;
var _239b=false;
var _239c=0;
var _239d=0;
var _239e=window.rowHeightAry;
var len=_239e.length;
var _23a0=false;
hiddenRowStartIdxAry=[];
hiddenRowEndIdxAry=[];
indexedHiddenRowAry=[];
_239d++;
for(var i=0;i<len;i++){
var _23a2=Row.isHidden(i);
if(_23a2){
_23a0=true;
if(!_239b){
_2399=i;
_239b=true;
}
}else{
if(_239b){
hiddenRowStartIdxAry[count]=_2399;
hiddenRowEndIdxAry[count++]=i-1;
_239b=false;
}
}
if(_23a0&&_239c++===Row.HIDDENROW_INDEX_INTERVAL-1){
indexedHiddenRowAry[_239d++]=(count>0)?count-1:count;
_239c=0;
}
}
if(_239b){
hiddenRowStartIdxAry[count]=_2399;
hiddenRowEndIdxAry[count++]=len-1;
_239b=false;
}
var _23a3=hiddenRowStartIdxAry.length;
if(_23a3>0){
indexedHiddenRowAry[0]=0;
}
if(_23a3>0){
this.firstHiddenRow=hiddenRowStartIdxAry[0];
this.lastHiddenRow=hiddenRowEndIdxAry[_23a3-1];
this.firstNonHiddenRow=(0<this.firstHiddenRow)?0:(hiddenRowEndIdxAry[0]+1===getRowMax())?-1:hiddenRowEndIdxAry[0]+1;
this.lastNonHiddenRow=(this.lastHiddenRow===(getRowMax()-1))?hiddenRowStartIdxAry[_23a3-1]-1:getRowMax()-1;
this.lastNonHiddenRowY=(this.lastNonHiddenRow<0)?0:(getRowTop(this.lastNonHiddenRow)+getRowHeight(this.lastNonHiddenRow));
}else{
this.firstHiddenRow=-1;
this.lastHiddenRow=-1;
this.firstNonHiddenRow=0;
this.lastNonHiddenRow=65535;
this.lastNonHiddenRowY=getRowTop(this.lastNonHiddenRow)+getRowHeight(this.lastNonHiddenRow);
}
if(_23a3>this.MINIFIED_HIDDEN_INFO_THRESHOLD){
}
return this;
},unhide:function(_23a4,endR,_23a6,_23a7,_23a8){
var _23a9=[];
var _23aa,endR,_23ab;
isFirstArgumentArray=isArray(_23a4);
if(isFirstArgumentArray){
_23a9=_23a4;
_23aa=_23a9[0];
}else{
if(_23a4===undefined){
_23ab=getCellRange();
_23aa=_23ab.startRow;
endR=_23ab.endRow;
if(isColSelected()){
_23a9="all";
}else{
_23a9=Row.getHiddenRowsInRange(_23aa,endR);
}
}else{
if(_23aa===0&&endR===65535){
rowsToHide="all";
}else{
_23aa=_23a4;
_23a9=Row.getHiddenRowsInRange(_23aa,endR);
}
}
}
if(!_23a9.length){
return;
}
if(!(_23a8===false)){
updateTileCallbackInfo.isCallbackAvailable=true;
updateTileCallbackInfo.actionDetails={"callbackMethod":function(){
if(_23a9==="all"){
focusCellRange(-1,_23ab.startCol,_23ab.endRow,_23ab.endCol,"WHOLESHEET",true);
}else{
focusCellRange(_23ab.startRow,_23ab.startCol,_23ab.endRow,_23ab.endCol,undefined,true);
}
resetCellFieldPosition();
}};
width_height_action("UNHIDE_ROWS",undefined,_23aa,endR,_23a7);
}
if(_23a6){
Row.unhideHelper(_23a9,_23a6);
}
},unhideHelper:function(_23ac,_23ad){
setRowDetails("RANGEOBJ",_23ad);
Row.dom.unhide(_23ac);
},isAllRowsHidden:function(){
return (hiddenRowStartIdxAry[0]===0&&hiddenRowEndIdxAry[0]===(getRowMax()-1));
},sendHiddenInfoToServer:function(_23ae,_23af,endR,_23b1,_23b2){
var _23b3=new getXmlhttp();
_23b3.open("POST",ctxpath+"width_height.do",true);
_23b3.onreadystatechange=function(){
if(_23b3.readyState==4){
if(_23b2){
_23b2(_23b3.responseText);
}
}
};
if(!_23b1){
_23b1=false;
}
var nvp="docid="+DOCUMENT_ID+"&afterRTC="+_23b1+"&docowner="+CURR_DOC_OWNERNAME+"&collabid="+COLLAB_ID;
nvp+="&readwrite="+ALLOW_TO_WRITE+"&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+encodeURIComponent(RTCSHEETNAME)+"&collabEditing="+COLLABORATIVE_EDITING+"&bridgeNo="+bridgeNumber+"&isDocSaved="+isDocSaved();
nvp+="&viewType="+getViewType()+"&isColSelected="+isColSelected()+"&isRowSelected="+isRowSelected();
nvp+="&type="+_23ae+"&startRow="+_23af+"&endRow="+endR+"&startColumn=-1&endColumn=-1&curtime="+CURRENTTIME+"&sheetname="+encodeURIComponent(CURRSHEETNAME)+"&totalRows="+usedCursRow+"&fromUNDO="+WIDTHHEIGHTUNDO;
nvp=appendCSRFToURL(nvp);
_23b3.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_23b3.send(nvp);
},findMaxRowToRender:function(){
var _23b5=getCeilRow(usedCursRow+1);
var _23b6=getRowTop(_23b5)+getRowHeight(_23b5);
var _23b7=getSheetHeight();
var _23b8=Row.lastNonHiddenRow;
var _23b9=(_23b8===-1)?0:(getRowTop(_23b8)+getRowHeight(_23b8));
if(_23b9<=_23b7){
maxRowToRender=Row.lastNonHiddenRow+1;
}else{
if(_23b6<_23b7){
var _23ba=_23b6;
while(_23b7>_23ba){
_23ba=getRowTop(_23b5)+getRowHeight(_23b5);
_23b5+=1;
}
maxRowToRender=getCeilRow(_23b5)+ROWS_PER_TILE;
}else{
maxRowToRender=Math.max(getCeilRow(totRows),_23b5);
}
}
return maxRowToRender;
},getMaxRowToRender:function(){
return this.findMaxRowToRender();
},setMaxRowToRender:function(_23bb){
totRows=this.findMaxRowToRender();
return this;
},getAvailableRows:function(_23bc){
var rows=[];
if(_23bc&ISFREEZED){
var _23be=Row.getAvailableRowsInFrozenRange();
if(_23be[0]!==rowsInPage[0]){
rows=rows.concat(_23be);
}
}
return rows.concat(rowsInPage);
},setAvailableRows:function(ary){
var _23c0=ary[0],_23c1=ary[ary.length-1];
availableStartRow=!isUndefined(_23c0)?_23c0:-1;
availableEndRow=!isUndefined(_23c1)?_23c1:-1;
rowsInPage=ary;
},trimToAvailableRowRange:function(_23c2,endR){
var _23c4=getAvailableStartRow();
var _23c5=getAvailableEndRow();
if(_23c2>_23c5||endR<_23c4){
return undefined;
}
if(_23c2<_23c4){
_23c2=_23c4;
}
if(endR>_23c5){
endR=_23c5;
}
return {"startRow":_23c2,"endRow":endR};
},getVisibleRowRangesAsJSONArray:function(_23c6,endR){
var range=Row.trimToAvailableRowRange(_23c6,endR);
var _23c9="";
var _23ca=hiddenRowStartIdxAry.length;
if(range){
_23c6=range.startRow;
endR=range.endRow;
if(!_23ca){
_23c9="[{\"sr\":"+_23c6+",\"er\":"+endR+"}]";
}else{
var _23cb=ArrayUtils.getSortedIndex;
var _23cc=_23cb(hiddenRowStartIdxAry,_23c6);
var _23cd=_23cb(hiddenRowEndIdxAry,endR);
var _23ce=false;
if(_23cd!==_23ca){
_23cd=_23cd+1;
}else{
_23ce=true;
}
var _23cf="",_23d0="",_23d1="";
if(_23c6<hiddenRowStartIdxAry[_23cc]){
_23cf="{\"sr\":"+_23c6+","+"\"er\":"+(hiddenRowStartIdxAry[_23cc]-1)+"},";
}
for(var i=_23cc+1;i<_23cd;i++){
_23d0=_23d0+"{\"sr\":"+(hiddenRowEndIdxAry[i-1]+1)+","+"\"er\":"+(hiddenRowStartIdxAry[i]-1)+"},";
}
if(_23ce){
_23d1="{\"sr\":"+Math.max(_23c6,hiddenRowEndIdxAry[_23ca-1]+1)+","+"\"er\":"+endR+"}";
}
_23c9="["+_23cf+_23d0+_23d1+"]";
}
}else{
_23c9="[]";
}
return _23c9;
},getVisibleRowsInViewPortAsJSONStr:function(){
var _23d3=Row.getAvailableRows(true);
var _23d4=_23d3[0];
var _23d5="[";
for(var i=1,len=_23d3.length;i<len;i++){
var _23d8=_23d3[i-1];
var _23d9=_23d3[i];
if((_23d9-_23d8)!==1){
_23d5+="{\"sr\":"+_23d4+",\"er\":"+_23d8+"},";
_23d4=_23d9;
}
}
_23d5+="{\"sr\":"+_23d4+",\"er\":"+_23d8+"}";
return _23d5.concat("]");
}};
Row.hasHiddenRows=function(){
return hiddenRowStartIdxAry.length>0;
};
function setSheetRowHeight(row,_23db){
setRowsHeightAndModifyDOM({"sr":row,"er":row,"v":_23db});
}
function setRowsHeightAndModifyDOM(_23dc,_23dd,_23de){
var _23df,row;
var _23e1=true;
var _23e2,_23e3,_23e4,_23e5;
if(_23de){
_23e2=_23de.passiveReload;
_23e3=_23de.onBeforeReload;
_23e4=_23de.onAfterReload;
_23e5=_23de.reloadFrozenRows;
}
if(!isArray(_23dc)){
_23df=JSON.parse(_23dc);
}else{
_23df=_23dc;
}
if(!_23df.length){
return;
}
var start=_23df[0].sr;
var end=_23df[_23df.length-1].er;
if(_23e2){
row=findRowInYPos(getSheetScrollTop());
}
setRowDetails("RANGEOBJ",_23df);
var _23e8=Row.findMaxRowToRender();
totRows=(totRows>_23e8)?totRows:_23e8;
setSheetTableHeight(getRowTop(totRows-1)+getRowHeight(totRows-1));
if(!_23dd&&(start>getAvailableEndRow())){
_23e1=false;
}
if(_23dd){
_23e3&&_23e3();
var _23e9=getRowTop(row);
reloadPage(_23e9,_23e5);
updateTileCallbackInfo.isCallbackAvailable=true;
updateTileCallbackInfo.actionDetails={"callbackMethod":function(){
if(_23e2){
setScrollTop(_23e9);
}
focusSheet();
resetCellFieldPosition();
_23e4&&_23e4();
calcAutoFormulas();
if(!jsTHROWAWAY_VIEW){
Userpresence.send();
}
}};
}else{
if(_23e1){
Row.dom.setRowsHeight(start,end);
Merge.resizeDOM(start,end,"ROWS");
insertRowHdrs();
focusSheet();
}
}
if(!jsTHROWAWAY_VIEW){
Userpresence.send();
}
if(Filter.hasFilter){
var _23ea=Filter.getInstance();
if(_23ea){
if(start<=_23ea.range.sR){
_23ea.reconstructIcons();
}
}
}
(typeof ole!=="undefined")&&ole.shiftObjects("HEIGHT",start);
!_23dd&&loadXTileIfVacantInViewPort();
resetCellFieldPosition();
}
function insertAndShiftRows(_23eb,cnt,_23ed,_23ee){
var _23ef=getDummyRow(_23ed);
var _23f0=Row.dom.getCellsInRows(_23eb,getAvailableEndRow());
resetRowsInPage();
var _23f1=Row.getAvailableRows();
var _23f2=ArrayUtils.getSortedIndex(_23f1,_23eb);
var _23f3=_23f2%ROWS_PER_TILE;
var _23f4=ROWS_PER_TILE;
var _23f5=~~(_23f2/ROWS_PER_TILE);
var len=totCols;
var _23f7=0;
var tiles=getAvailableTiles();
var _23f9=tiles.length;
while(_23f5<_23f9){
var _23fa=document.createDocumentFragment();
var _23fb=getRowTop(_23f1[_23f5*ROWS_PER_TILE]);
var tile=tiles[_23f5++];
for(var i=_23f3;i<_23f4;i++){
var row=_23f1[_23f2];
var _23ff=getRowTop(row)-_23fb+"px";
if(cnt-->0){
for(var j=0;j<len;j++){
var clone=_23ef[j].cloneNode(true);
clone.style.top=_23ff;
_23fa.appendChild(clone);
}
}else{
var cells=_23f0[_23f7++];
for(var j=0;j<len;j++){
var cell=cells[j];
cell.style.top=_23ff;
_23fa.appendChild(cell);
}
}
_23f2++;
}
_23f3=0;
tile.style.top=_23fb+"px";
tile.appendChild(_23fa);
}
var _2404=document.createDocumentFragment();
for(var i=_23f7,len=_23f0.length;i<len;i++){
var cells=_23f0[i];
for(var j=0;j<totCols;j++){
_2404.appendChild(cells[j]);
}
}
if(FREEZED_COL>0){
sheetTable3.innerHTML=sheetTable.innerHTML;
}
}
Row.dom={insertCutRows:function(_2405,_2406){
var _2407=Row.getAvailableRows();
var _2408=Row.dom.getCellsInRows(getAvailableStartRow(),getAvailableEndRow());
var _2409=ArrayUtils.getSortedIndex;
var _240a=_2409(_2407,_2405.startRow);
var _240b=_2409(_2407,_2405.endRow);
var _240c=_2409(_2407,_2406);
var _240d,_240e,_240f,_2410;
var _2411=[];
if(_240a<_240c){
_240d=_2408.slice(0,_240a);
_240e=_2408.slice(_240a,_240b+1);
_240f=_2408.slice(_240b+1,_240c);
_2410=_2408.slice(_240c,_2408.length);
}else{
_240d=_2408.slice(0,_240c);
_240e=_2408.slice(_240c,_240a);
_240f=_2408.slice(_240a,_240b+1);
_2410=_2408.slice(_240b+1,_2408.length);
}
_2411=_240d.concat(_240f).concat(_240e).concat(_2410);
resetRowsInPage();
_2407=Row.getAvailableRows();
for(var i=0,len=_2407.length,k=0;i<len;i++){
var _2415=_2411[i];
var row=_2407[i];
var _2417=getRowTop(_2407[i-(i%ROWS_PER_TILE)]);
var _2418=getRowTop(_2407[i])-_2417;
if(i%ROWS_PER_TILE===0){
var tile=getTile(getTileIndex(row));
tile.style.top=_2417+"px";
}
for(var x=0;x<totCols;x++){
var cell=_2415[x];
cell.style.top=_2418+"px";
cell.style.height=getRowHeight(row)+"px";
tile.appendChild(cell);
}
}
if(FREEZED_COL>0){
}
},setRowsHeight:function(_241c,endR){
var _241e=Row.getAvailableRowsInRange(_241c,endR,true);
var _241f=Row.getAvailableRows();
var _2420=Row.dom.getCellsInRows(_241c,getAvailableEndRow());
var _2421=isRowInAvailableRowRange(_241c)?ArrayUtils.getSortedIndex(_241f,_241c):0;
for(var i=_2421,len=_241f.length,k=0;i<len;i++,k++){
var _2425=_2420[k];
var row=_241f[i];
var _2427=(_241e.indexOf(row)!==-1);
var _2428=getRowTop(_241f[i-(i%ROWS_PER_TILE)]);
var _2429=getRowTop(_241f[i])-_2428;
if(i%ROWS_PER_TILE===0){
var tile=getTile(getTileIndex(row));
tile.style.top=_2428+"px";
}
for(var x=0;x<totCols;x++){
var cell=_2425[x];
cell.style.top=_2429+"px";
if(_2427){
cell.style.height=getRowHeight(row)+"px";
setCellHeightForVAlignedCell(cell);
}
}
}
if(FREEZED_COL>0){
sheetTable3.innerHTML=sheetTable.innerHTML;
}
},removeAndShiftRows:function(_242d,_242e){
var rows=Row.getAvailableRowsInRange(_242d);
var _2430=getTilesCount();
var _2431=_2430*ROWS_PER_TILE-rows.length;
var _2432=parseInt(_2431/ROWS_PER_TILE);
var _2433=_2430-_2432;
var _2434=rows[0];
var _2435;
if(_2432>0){
_2435=Row.predictNthNonHiddenRow(_2432*ROWS_PER_TILE,rows,getAvailableStartRow());
}else{
_2435=Row.findNextNonHiddenRow(getAvailableEndRow(),true);
}
var _2436=_2434;
var _2437;
var _2438=Row.getAvailableRowsInRange(getAvailableStartRow(),_2434).length-1;
var _2439=_2432*ROWS_PER_TILE-_2438;
if(!_242e&&getAvailableStartRow()===_2434){
_2437=true;
}
if(_2432===0){
_2435=getAvailableStartRow();
}
var _243a=Row.getAvailableRows();
if(_2432>0&&_2436<_2435){
var _243b=_243a.indexOf(_2436);
var _243c=_243a.indexOf(_2435)>0?_2435:_243a.length;
var _243d=_243a.slice(_243b,_243c);
var _243e=this.getCellsInRows(_243d);
var _243f=0;
var _2440=0;
for(var i=0,len=_243d.length;i<len;i++){
var row=_243d[i];
var _2444=_243e[i];
if(rows.indexOf(row)!==-1){
var _2445=_2444[0].parentNode;
for(var col=0;col<totCols;col++){
_2445.removeChild(_2444[col]);
}
_243f++;
}else{
if(_2437){
availableStartRow=row;
_2437=false;
}
var _2447=_243d[i-_243f];
var _2448=getTileIndex(_2447);
var _2449=getTile(_2448);
var _244a=getTile(getTileIndex(row));
var _244b=!_242e?row:row-ArrayUtils.getSortedIndex(_242d,row);
var _244c=getRowTop(_244b);
var _244d=_244c-getTileTop(_2449);
for(var col=0;col<totCols;col++){
_2444[col].style.top=_244d+"px";
if(_244a!==_2449){
_2449.appendChild(_2444[col]);
}
}
}
}
}
if(_2433!==getTilesCount()){
var _244e=Row.getNNonHiddenRows(_2432*ROWS_PER_TILE,availableStartRow);
var _244f=Row.getNNonHiddenRows(_2433*ROWS_PER_TILE,_2435);
while(_2433>0){
sheetTable.removeChild(getLastTile());
_2433--;
}
}else{
var _2450=true;
}
if(FREEZED_COL>0&&!_2450){
sheetTable3.innerHTML=sheetTable.innerHTML;
}
return {"rowsToLoad":_244f,"availableRows":_244e,"pageReload":_2450};
},hide:function(_2451){
var _2452=getCellRange();
var _2453=_2452.startRow;
var _2454=_2452.endRow;
var _2455=_2453;
function hideHelper(){
totRows=Row.findMaxRowToRender();
var _2456=(totRows>0)?getRowTop(totRows-1)+getRowHeight(totRows-1):0;
setSheetTableHeight(_2456);
setScrollTop(getRowTop(_2453));
resetCellFieldPosition();
var _2457=isWholeSheetSelected()?"WHOLESHEET":undefined;
var _2458=isWholeSheetSelected()?true:false;
focusCellRange(_2452.startRow,_2452.startCol,_2452.endRow,_2452.endCol,_2457,_2458);
}
if(_2451==="all"){
hideHelper();
reloadPage(getRowTop(_2453));
}else{
if(!isRowAvailable(_2455)){
updateTileCallbackInfo.isCallbackAvailable=true;
updateTileCallbackInfo.actionDetails={"callbackMethod":hideHelper};
reloadPage(getRowTop(_2453));
}else{
var _2459=Row.dom.removeAndShiftRows(_2451);
var _245a=_2459.availableRows;
if(_245a){
Row.setAvailableRows(_245a);
submitScrollForm(_2459.rowsToLoad,"SCROLLDOWN","END_OF_PAGE");
focusCellRange(_2453,_2452.startCol,_2454,_2452.endCol,undefined,true);
resetCellFieldPosition();
}else{
updateTileCallbackInfo.isCallbackAvailable=true;
updateTileCallbackInfo.actionDetails={"callbackMethod":hideHelper};
reloadPage(getRowTop(_2453));
}
}
}
},unhide:function(_245b){
var _245c=getCellRange();
var _245d=_245c.startRow;
totRows=Row.findMaxRowToRender();
setSheetTableHeight(getRowTop(totRows-1)+getRowHeight(totRows-1));
updateTileCallbackInfo.isCallbackAvailable=true;
updateTileCallbackInfo.actionDetails={"callbackMethod":function(){
if(_245b==="all"){
focusCellRange(-1,_245c.startCol,_245c.endRow,_245c.endCol,"WHOLESHEET",true);
}else{
focusCellRange(_245c.startRow,_245c.startCol,_245c.endRow,_245c.endCol,undefined,true);
}
resetCellFieldPosition();
}};
reloadPage();
return this;
},getCellsInRows:function(_245e,_245f){
if(!isArray(_245e)){
var _2460=Row.getAvailableRows();
var _2461=ArrayUtils.getSortedIndex;
_245e=_2460.slice(_2461(_2460,_245e),_2461(_2460,_245f)+1);
}
var tiles=sheetTable.childNodes;
var cells=[];
for(var i=0,len=_245e.length;i<len;i++){
var row=_245e[i];
var _2467=getRowIndex(row);
if(_2467===-1){
continue;
}
var _2468=~~(_2467/ROWS_PER_TILE);
var diff=_2467%ROWS_PER_TILE;
cells.push(ArrayUtils.slice(tiles[_2468].childNodes,diff*totCols,(diff+1)*totCols));
}
return cells;
},getCellsInRow:function(row,_246b,_246c){
var _246d=getRowIndex(row);
var _246e=~~(_246d/ROWS_PER_TILE);
_246b=_246b||0;
_246c=(_246c===undefined||_246c>totCols)?_246c=totCols:_246c=_246c+1;
var diff=_246d%ROWS_PER_TILE;
return ArrayUtils.slice(sheetTable.childNodes[_246e].childNodes,diff*totCols+_246b,diff*totCols+_246c);
}};
Row.clientData={rows:[],meta:[],hiddenRowsInfo:{},data:[]};
Row.sendInsertInfoToServer=function(_2470,_2471,_2472,_2473){
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_2470;
document.cellform.view.value=getObj("VIEW").value;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=getAvailableStartRow();
document.cellform.availableEndRow.value=getAvailableEndRow();
document.cellform.isColSelected.value=false;
document.cellform.isRowSelected.value=isRowSelected();
document.cellform.totCols.value=totCols;
if(_2470=="true"){
document.cellform.U_FN.value=_2471;
document.cellform.U_AO.value=_2472;
}
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2474=getObj("apiKey");
if(_2474!=null){
document.cellform.apiKeyId.value=_2474.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,_2473,true);
};
Row.temporaryInfo={};
Row.setTemporaryInfo=function(info){
Row.temporaryInfo=info;
};
Row.getTemporaryInfo=function(info){
var _2477=Row.temporaryInfo;
return _2477;
};
Row.clearTempInfo=function(){
Row.temporaryInfo={};
};
Row.hasHiddenRows=function(){
return hiddenRowStartIdxAry.length>0;
};
Row.validateInsertRows=function(idx,_2479,cnt,_247b,_247c){
var _247d=getRowMax();
if(totRows+cnt>=_247d){
if(!_247c){
alert(jsTitleMsg["InsertRow.Alert.InsertingNotPossibleBeyondMaxRow"]);
}
return true;
}
if(_2479<usedCursRow){
if(usedCursRow+cnt>=_247d){
if(!_247c){
alert(jsTitleMsg["InsertRow.Alert.InsertingNotPossibleBeforeUsedRow"]);
}
return true;
}
}
if(_247b&&cellFieldSPAN!=null&&!isCellFieldSPANHided()&&!isFormulaCell()){
if(currRow>idx){
currRow+=(cnt);
}else{
if(currRow==idx){
currRow+=cnt;
}
}
}
if(cellFieldSPAN!=null&&!isCellFieldSPANHided()&&!isFormulaCell()){
hideCellField();
}
doNotSlide=true;
if(ISFREEZED){
if(isRowsOnlyFreezed||isColsAndRowsFreezed){
if(_2479<FREEZED_ROW){
alert(jsTitleMsg["FreezePanes.Rowinsertionnotsupported"]);
return true;
}
}
}
var _247e=arrayDetails;
updateArrayDetails("INSERTROW",_2479,cnt,currRow,currCol);
if(isPartOfArray(_2479,0,(_2479+cnt-1),255)){
alert(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
arrayDetails=_247e;
return true;
}
};
function getDummyRow(_247f){
var _2480=[];
var _2481=getDefaultCellHTML();
for(var i=0;i<totCols;i++){
var _2483=_2481.cloneNode(true);
_2483.style.left=getColLeft(i)+"px";
_2483.style.width=getColWidth(i)+"px";
_2483.style.height=_247f+"px";
_2480.push(_2483);
}
return _2480;
}
function getCellsToInsert(_2484){
return Row.dom.getCellsInRows(_2484);
}
function resetRowsInPage(){
var _2485=getNonHiddenRowsInPage();
var _2486=Row.getAvailableRows();
_2485.length=_2486.length;
Row.setAvailableRows(_2485);
}
function getNonHiddenRowsInPage(start,end){
start=start===undefined?getAvailableStartRow():start;
end=end===undefined?getAvailableEndRow():end;
var rows=[];
for(var i=start;i<=end;i++){
if(getRowHeight(i)!==0){
rows.push(i);
}
}
return rows;
}
function reinitHiddenInfo(){
Row.minifyHiddenRowInfo(true);
}
function _resettingRowHdrs(_248b){
insertRowHdrs(Row.getAvailableRows(),"UNLOADED_SHEET");
}
function _initInsertRow(pos,idx,cnt,_248f,_2490,_2491,_2492,_2493,_2494){
_2493=(isUndefined(_2493))?false:_2493;
if(isUndefined(idx)||isNaN(idx)){
if(isCellRange()){
var _2495=getCellRange().startRow;
}else{
var _2495=currRow;
}
}else{
var _2495=idx;
}
var _2490=(isUndefined(_2490))?false:_2490;
if(isUndefined(_248f)){
var _248f=((pos=="below")&&!isWholeSheetSelected())?true:false;
}
if(isUndefined(cnt)||isNaN(cnt)){
if(isCellRange()){
var _2496=getCellRange();
var cnt=_2496.endRow-_2496.startRow+1;
if(_2494){
cnt=cnt-Row.getHiddenRowCount(_2496.startRow,_2496.endRow);
}
}else{
var cnt=1;
}
if(pos==="below"){
if(cnt>1){
_2495=Row.findNthNonHiddenRow(cnt-1,_2495)+1;
}else{
_2495=_2495+cnt;
}
}
}
if(isUndefined(_2491)){
_2491=false;
}
return {pos:pos,cnt:cnt,doNotFocus:_248f,doNotSlide:_2490,jsOnly:_2491,afterRTC:_2493,currRowIdx:_2495};
}
Row.shiftOperations={"INSERT":function(pos,idx,cnt,_249a,_249b,_249c,_249d,_249e,_249f,_24a0,_24a1,_24a2){
var init=_initInsertRow(pos,idx,cnt,_249a,_249b,_249c,_249d,_249e,true);
var _24a4=init.currRowIdx;
cnt=init.cnt;
pos=init.pos;
_249a=init.doNotFocus;
_249b=init.doNotSlide;
_249c=init.jsOnly;
_249e=init.afterRTC;
isNotAValidUserRequest=Row.validateInsertRows(idx,_24a4,cnt,_249e);
if(isNotAValidUserRequest){
return;
}
cellRange=getCellRange();
document.cellform.startColumn.value=0;
document.cellform.endColumn.value=totCols-1;
document.cellform.startRow.value=cellRange.startRow;
document.cellform.endRow.value=totRows-1;
document.cellform.actionMode.value="InsertRow";
document.cellform.tmpData.value=pos;
document.cellform.row.value=_24a4;
document.cellform.column.value=currCol;
document.cellform.cellValue.value=cnt;
Row.sendInsertInfoToServer(_249e,_249f,_24a0,updateCell);
},"DELETE":function(_24a5,cnt,_24a7,_24a8,_24a9,_24aa,_24ab){
if(isUndefined(_24a9)){
_24a9="false";
}
if(isUndefined(_24a7)){
var _24a7=false;
}
if(isUndefined(_24a5)&&isUndefined(cnt)){
if(isCellRange()){
var _24a5=getCellRange().startRow;
var _24ac=getCellRange();
var cnt=_24ac.endRow-_24ac.startRow+1;
}else{
var _24a5=currRow;
var cnt=1;
}
}
if(cellFieldSPAN!=null&&!isCellFieldSPANHided()&&!isFormulaCell()){
hideCellField();
}
if(ISFREEZED){
if(_24a5<FREEZED_ROW){
alert(jsTitleMsg["FreezePanes.Rowdeletionnotsupported"]);
return true;
}
}
if(isPartOfArray(_24a5,0,(_24a5+cnt-1),255)){
alert(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return true;
}
clearOldArrayPosition(_24a5,0,(_24a5+cnt-1),255);
updateArrayDetails("DELETEROW",_24a5,cnt,currRow,currCol);
if(_24a9&&cellFieldSPAN!=null&&!isCellFieldSPANHided()&&!isFormulaCell()){
if(currRow>_24a5){
currRow-=(cnt);
}else{
if(currRow==_24a5){
currRow-=cnt;
}
}
}
if(!_24a8){
_24ac=getCellRange();
document.cellform.startColumn.value=0;
document.cellform.endColumn.value=totCols-1;
document.cellform.startRow.value=_24ac.startRow;
document.cellform.endRow.value=totRows-1;
document.cellform.row.value=_24a5;
document.cellform.column.value=currCol;
document.cellform.cellValue.value=cnt;
document.cellform.actionMode.value="DeleteRow";
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_24a9;
document.cellform.view.value=getObj("VIEW").value;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=getAvailableStartRow();
document.cellform.availableEndRow.value=getAvailableEndRow();
document.cellform.isColSelected.value=false;
document.cellform.isRowSelected.value=isRowSelected();
document.cellform.totCols.value=totCols;
if(_24a9=="true"){
document.cellform.U_FN.value=_24aa;
document.cellform.U_AO.value=_24ab;
}
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _24ad=getObj("apiKey");
if(_24ad!=null){
document.cellform.apiKeyId.value=_24ad.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
}
},"INSERT_CUT_ROWS":function(pos,idx,cnt,_24b1,_24b2,_24b3,_24b4,_24b5,_24b6,_24b7){
if(_24b4!="true"&&!isRowSelected()){
alert(jsTitleMsg["TheContentCopiedIsBigger"]);
return;
}
var _24b8=false;
var _24b9=false;
var _24ba=false;
var _24bb=getCellRange();
var _24bc=_24bb.startRow;
var _24bd=_24bb.endRow;
var obj=_initInsertRow(pos,idx,cnt,undefined,undefined,undefined,undefined,_24b4);
cnt=obj.cnt;
var _24bf=obj.currRowIdx;
_24b4=obj.afterRTC;
_24b5=(_24b4!="true")?tmpSheetName:_24b5;
var _24c0=getAvailableStartRow();
var _24c1=getAvailableEndRow();
_24b1=(isUndefined(_24b1))?copyRangeStartRow:_24b1;
_24b2=(isUndefined(_24b2))?copyRangeEndRow:_24b2;
var _24c2=0;
var _24b3=(!_24b3)?copyRangeEndCol:_24b3;
if(_24b4!="true"){
cnt=_24b2-_24b1+1;
hideFlashDIV();
_24bf=((pos!="below")?_24bf:_24bd+1);
insertCutRows=false;
unsetStatus();
}
isNotAValidUserRequest=Row.validateInsertRows(idx,_24bf,cnt,_24b4);
if(isNotAValidUserRequest){
return;
}
if((_24b4!="true")&&(CURRSHEETNAME===_24b5)&&(_24b1<_24bc&&_24bc<=_24b2)){
alert(jsTitleMsg["InsertCopiedRows.NotAllowed.Alert.CopyPasteAreasOverlap"]);
return false;
}
if(_24b4!="true"&&_24b1>=_24bf){
_24b1+=cnt;
_24b2+=cnt;
}
document.cellform.startColumn.value=_24c2;
document.cellform.endColumn.value=_24b3;
document.cellform.startRow.value=_24b1;
document.cellform.endRow.value=_24b2;
document.cellform.tmpSheet.value=_24b5;
document.cellform.actionMode.value="InsertCutRows";
document.cellform.row.value=_24bf;
document.cellform.tmpData.value=pos;
document.cellform.column.value=currCol;
document.cellform.cellValue.value=cnt;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_24b4;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.view.value=getObj("VIEW").value;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_24c0;
document.cellform.availableEndRow.value=_24c1;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=false;
document.cellform.usedRow.value=usedCursRow;
document.cellform.totCols.value=totCols;
document.cellform.currentSelection.value=getCurrentSelection();
if(_24b4=="true"){
document.cellform.U_FN.value=_24b6;
document.cellform.U_AO.value=_24b7;
}
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _24c3=getObj("apiKey");
if(_24c3!=null){
document.cellform.apiKeyId.value=_24c3.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
Row.setTemporaryInfo({"currRowIdx":_24bf,"sourceSheet":_24b5,"destSheet":CURRSHEETNAME,"sourceRange":{"startRow":(_24b1>=_24bf)?_24b1-cnt:_24b1,"endRow":(_24b2>=_24bf)?_24b2-cnt:_24b2},"destRange":_24bf});
importxmlForForm(document.cellform,updateCell,true);
},"INSERT_COPIED_ROWS":function(pos,idx,cnt,_24c7,_24c8,_24c9,_24ca,_24cb,_24cc,_24cd){
if(_24ca!="true"&&!isRowSelected()){
alert(jsTitleMsg["TheContentCopiedIsBigger"]);
return;
}
var _24ce=false;
var _24cf=false;
var _24d0=false;
var _24d1=getCellRange();
var _24d2=_24d1.startRow;
var _24d3=_24d1.endRow;
var obj=_initInsertRow(pos,idx,cnt,undefined,undefined,undefined,undefined,_24ca,cnt);
cnt=obj.cnt;
var _24d5=obj.currRowIdx;
_24ca=obj.afterRTC;
_24cb=(_24ca!="true")?tmpSheetName:_24cb;
var _24d6=getAvailableStartRow();
var _24d7=getAvailableEndRow();
_24c7=(isUndefined(_24c7))?copyRangeStartRow:_24c7;
_24c8=(isUndefined(_24c8))?copyRangeEndRow:_24c8;
var _24d8=0;
var _24c9=(!_24c9)?copyRangeEndCol:_24c9;
if(_24ca!="true"){
_24d5=((pos!="below")?_24d5:_24d3+1);
insertCopyRows=false;
hideFlashDIV();
var _24d9=_24d1.startRow;
var _24da=_24d1.endRow;
var _24db=_24da-_24d9+1;
var _24dc=_24c8-_24c7+1;
if(_24db>_24dc){
var temp=0;
temp=Math.floor(_24db/_24dc);
cnt=_24dc*temp;
}else{
cnt=_24dc;
}
}
isNotAValidUserRequest=Row.validateInsertRows(idx,_24d5,cnt,_24ca);
if(isNotAValidUserRequest){
return false;
}
var _24de=false;
if(_24ca!="true"&&CURRSHEETNAME==_24cb){
if(_24c7<_24d2&&_24d2<=_24c8){
alert(jsTitleMsg["InsertCopiedRows.NotAllowed.Alert.CopyPasteAreasOverlap"]);
return false;
}else{
if(_24c7>=_24d5){
_24c7+=cnt;
_24c8+=cnt;
_24de=true;
}
}
}
document.cellform.startColumn.value=_24d8;
document.cellform.endColumn.value=_24c9;
document.cellform.startRow.value=_24c7;
document.cellform.endRow.value=_24c8;
document.cellform.tmpSheet.value=_24cb;
document.cellform.actionMode.value="InsertCopiedRows";
document.cellform.row.value=_24d5;
document.cellform.tmpData.value=pos;
document.cellform.column.value=currCol;
document.cellform.cellValue.value=cnt;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_24ca;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.view.value=getObj("VIEW").value;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_24d6;
document.cellform.availableEndRow.value=_24d7;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=false;
document.cellform.usedRow.value=usedCursRow;
document.cellform.totCols.value=totCols;
document.cellform.currentSelection.value=getCurrentSelection();
if(_24ca=="true"){
document.cellform.U_FN.value=_24cc;
document.cellform.U_AO.value=_24cd;
}
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _24df=getObj("apiKey");
if(_24df!=null){
document.cellform.apiKeyId.value=_24df.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
if(_24ca!="true"){
var eRow=((getCellRange().startRow)+cnt)-1;
if(pos!="below"){
eRow=((getCellRange().startRow)+cnt)-1;
focusRow((getCellRange().startRow),eRow);
}else{
eRow=((getCellRange().endRow)+cnt);
focusRow((getCellRange().endRow)+1,eRow);
}
}
Row.setTemporaryInfo({"currRowIdx":_24d5,"startRow":_24de?_24c7-cnt:_24c7,"endRow":_24de?_24c8-cnt:_24c8,"sourceSheet":_24cb,"destSheet":CURRSHEETNAME});
}};
Row.validateDeleteRows=function(){
if(isUndefined(afterRTC)){
afterRTC="false";
}
if(isUndefined(_24e1)){
var _24e1=false;
}
if(isUndefined(_24e2)&&isUndefined(cnt)){
if(isCellRange()){
var _24e2=getCellRange().startRow;
var _24e4=getCellRange();
var cnt=_24e4.endRow-_24e4.startRow+1;
}else{
var _24e2=currRow;
var cnt=1;
}
}
if(cellFieldSPAN!=null&&!isCellFieldSPANHided()&&!isFormulaCell()){
hideCellField();
}
if(ISFREEZED){
if(_24e2<FREEZED_ROW){
showAlertDialog(jsTitleMsg["FreezePanes.Rowdeletionnotsupported"]);
return true;
}
}
if(Merge.isSheetMergeXists()){
splitCells(0,0,0,0);
return true;
}
if(isPartOfArray(_24e2,0,(_24e2+cnt-1),255)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return true;
}
clearOldArrayPosition(_24e2,0,(_24e2+cnt-1),255);
updateArrayDetails("DELETEROW",_24e2,cnt,currRow,currCol);
if(afterRTC&&cellFieldSPAN!=null&&!isCellFieldSPANHided()&&!isFormulaCell()){
if(currRow>_24e2){
currRow-=(cnt);
}else{
if(currRow==_24e2){
}
}
}
};
Row.shiftOperationsCallback={"INSERT":function(_24e5){
if(_24e5.sN===CURRSHEETNAME){
var _24e6=("true"===_24e5.afterRTC);
var row=_24e5.sr;
var count=_24e5.count;
var _24e9=_24e5.doNotModifyDOM;
var _24ea;
setRowDetails("INSERT",row,count,_24e5.height);
totRows=Row.findMaxRowToRender();
setSheetTableHeight(getRowTop(totRows-1)+getRowHeight(totRows-1));
if(!_24e9){
if(!isRowInAvailableRowRange(row)){
updateTileCallbackInfo.isCallbackAvailable=true;
updateTileCallbackInfo.actionDetails={"callbackMethod":function(){
if(!_24e6){
_24ea=getRowTop(row);
setScrollTop(_24ea);
focusCellRange(row,0,(row+count-1),totCols-1,"ROW",true);
}else{
_24ea=getSheetScrollTop();
focusSheet();
}
resetCellFieldPosition();
}};
reloadPage(_24ea);
}else{
insertAndShiftRows(row,count,_24e5.height);
!_24e6?focusCellRange(row,0,(row+count-1),getCellRange().endCol,"ROW",true):focusSheet();
_resettingRowHdrs();
Merge.shiftRow(row,_24e5.count,true);
}
}
(typeof ole!==undefined)&&ole.shiftObjects("INSERT",row,row+count-1);
if(row<=copyRangeEndRow&&tmpSheetName==CURRSHEETNAME&&(copyStatus||cutStatus)){
copyRangeStartRow+=count;
copyRangeEndRow+=count;
}
if(row<=copyCellRow){
if(copyStatus||cutStatus){
copyCellRow+=count;
}
}
}
},"DELETE":function(_24eb){
if(_24eb.sN===CURRSHEETNAME){
var _24ec=_24eb.rowsToDelete;
var count=_24ec.length;
if(!_24ec.length){
return;
}
_24ec=_24ec.sort(function(a,b){
return a-b;
});
setRowDetails("DELETE",_24ec);
totRows=Row.findMaxRowToRender();
setSheetTableHeight(getRowTop(totRows-1)+getRowHeight(totRows-1));
var _24f0=_24eb.doNotModifyDOM;
var _24f1;
if(!_24f0){
if(isRowInAvailableRowRange(_24ec[0])){
var _24f2=Row.dom.removeAndShiftRows(_24ec,true);
if(_24f2.availableRows){
Row.setAvailableRows(_24f2.availableRows);
insertRowHdrs();
}
if(_24f2.pageReload){
_24f1=true;
}
}else{
_24f1=true;
}
if(_24f1){
reloadPage();
}else{
loadXTileIfVacantInViewPort();
Merge.shiftRow(_24ec[0],_24ec.length,false);
}
}
(typeof ole!==undefined)&&ole.shiftObjects("DeleteRow");
if(startR<=copyRangeEndRow&&tmpSheetName==CURRSHEETNAME&&(copyStatus||cutStatus)){
copyRangeStartRow-=count;
copyRangeEndRow-=count;
}
if(startR<=copyCellRow){
if(copyStatus||cutStatus){
copyCellRow-=count;
}
}
}
},"INSERT_CUT_ROWS":function(){
var _24f3=Row.findMaxRowToRender();
totRows=(totRows>_24f3)?totRows:_24f3;
setSheetTableHeight(getRowTop(totRows-1)+getRowHeight(totRows-1));
reloadPage();
var _24f4=getCellRange();
updateTileCallbackInfo.isCallbackAvailable=true;
updateTileCallbackInfo.actionDetails={"callbackMethod":function(){
focusCellRange(_24f4.startRow,_24f4.startCol,_24f4.endRow,_24f4.endCol,undefined,true);
}};
},"INSERT_COPIED_ROWS":function(_24f5){
if(_24f5.sN===CURRSHEETNAME){
setRowsHeightAndModifyDOM(_24f5.rH,true);
}
}};
Row.executeShiftOperation=function(_24f6){
Row.meta.shiftOperations[_24f6].apply(undefined,Array.prototype.slice.call(arguments,1));
};
Row.executeShiftOperationCallback=function(_24f7){
Row.meta.shiftOperationsCallback[_24f7].apply(undefined,Array.prototype.slice.call(arguments,1));
resetCellRangeFillDIV();
Filter.hasFilter&&Filter.getInstance().reconstructIcons();
focusSheet();
Userpresence.send();
setFocusInCellField();
};
Row.meta={"shiftOperations":{"INSERT":Row.shiftOperations.INSERT,"DELETE":Row.shiftOperations.DELETE,"INSERT_CUT_ROWS":Row.shiftOperations.INSERT_CUT_ROWS,"INSERT_COPIED_ROWS":Row.shiftOperations.INSERT_COPIED_ROWS,"HIDE":Row.shiftOperations.HIDE,"UNHIDE":Row.shiftOperations.UNHIDE},"shiftOperationsCallback":{"INSERT":Row.shiftOperationsCallback.INSERT,"DELETE":Row.shiftOperationsCallback.DELETE,"INSERT_CUT_ROWS":Row.shiftOperationsCallback.INSERT_CUT_ROWS,"INSERT_COPIED_ROWS":Row.shiftOperationsCallback.INSERT_COPIED_ROWS,"HIDE":Row.shiftOperationsCallback.HIDE,"UNHIDE":Row.shiftOperationsCallback.UNHIDE}};
function checkForValidCellRangeInsert(field,_24f9){
return true;
}
function checkForValidCellKeyRangeInsert(field,_24fb){
return true;
}
function isCell(el){
if(el!=null&&isObject(el)){
var _24fd=el.parentNode;
if(!featureSupport.boxAlign){
if((_24fd.className.indexOf("vab-od")!=-1)||(_24fd&&_24fd.className.indexOf("vam-od")!=-1)){
_24fd=_24fd.parentNode.parentNode;
}else{
if((_24fd.className.indexOf("vab")!=-1)||(_24fd&&_24fd.className.indexOf("vam")!=-1)){
_24fd=_24fd.parentNode;
}
}
}
var id=_24fd.id;
var _24ff=_24fd.parentNode;
return ((_24fd&&(_24fd&&_24ff==sheetTable)||(_24fd&&_24ff==sheetTable1)||(_24fd&&_24ff==sheetTable2)||(_24fd&&_24ff==sheetTable3)||(_24fd&&(id=="mCC"))||(_24fd&&(id=="mCC1"))||(_24fd&&(id=="mCC2"))||(_24fd&&(id=="mCC3"))));
}else{
return false;
}
}
function isCellHolder(el){
return isCell(el);
}
function getRowIndex(row,_2502,isDOM){
var rows=(_2502===sheetPane1Id||_2502===sheetPane2Id)?(isDOM?Row.getLoadedRowsInFrozenRange():Row.getAvailableRowsInFrozenRange()):Row.getAvailableRows();
return rows.indexOf(row);
}
function getCell(row,col,_2507,_2508){
row=parseInt(row);
col=parseInt(col);
if(row<0||col<0){
return null;
}
var info=Merge.getCellInfo(row,col);
var _250a=getAvailableStartRow();
var _250b=getAvailableEndRow();
if(!(info&&(info.startRow<FREEZED_ROW||!(info.startRow>_250b||info.endRow<_250a)))){
if(typeof _2507=="undefined"||_2507==sheetPaneId||_2507==sheetPane3Id){
if(row>=totRows||col>=totCols||row>_250b||col>getAvailableEndCol()){
return null;
}
}else{
if(row>=totRows||col>=totCols){
return null;
}
}
}
if(isUndefined(_2507)){
_2507=sheetPaneId;
if(ISFREEZED){
if(row<FREEZED_ROW&&_250a>ROWS_PER_TILE){
if(col<FREEZED_COL){
_2507=sheetPane1Id;
}else{
_2507=sheetPane2Id;
}
}
}
}
if(isUndefined(arguments[3])&&info){
col=info.startCol;
row=info.startRow;
var _250c=null;
var _250d=info.getDOM();
if(_250d){
switch(_2507){
case sheetPane1Id:
_250c=_250d["mC1"];
break;
case sheetPane2Id:
_250c=_250d["mC2"];
break;
case sheetPane3Id:
_250c=_250d["mC3"];
break;
default:
_250c=_250d["mC"];
break;
}
}
return _250c;
}else{
var _250e=getRowIndex(row,_2507,true);
if(_250e!==-1){
var _250f=~~(_250e/ROWS_PER_TILE);
var tile=getTile(_250f,_2507);
var _2511=(_250e%ROWS_PER_TILE)*totCols+col;
return getChildNode(tile,_2511);
}
return null;
}
}
function findMergedCell(_2512,_2513,_2514){
if(_2514){
switch(_2514){
case sheetPane1Id:
var obj=getObj(mCC1Id);
break;
case sheetPane2Id:
var obj=getObj(mCC2Id);
break;
case sheetPane3Id:
var obj=getObj(mCC3Id);
break;
default:
var obj=getObj("mCC");
break;
}
}else{
var obj=getObj("mCC");
}
for(var i=0,len=obj.childNodes.length;i<len;i+=1){
var _2518=getChildNode(obj,i);
var left=parseInt(_2518.style.left);
var ctop=parseInt(_2518.style.top);
if(left==_2513&&ctop==_2512){
var _251b=_2518;
}
}
return _251b;
}
function getCellHolder(cell){
return cell;
}
function getCellHolderByPos(row,col){
var cell=getCell(row,col);
return cell;
}
function getCellPos(cell){
if(cell){
var _2521=cell.parentNode.parentNode.parentNode.id;
var _2522=findIndex(cell.parentNode);
var _2523=findIndex(cell);
var _2524=(_2523<totCols)?0:Math.floor(_2523/totCols);
var row=(_2522==0)?_2524:(_2522*ROWS_PER_TILE)+_2524;
var col=(_2523<totCols)?_2523:_2523+totCols-((_2524+1)*totCols);
if(_2521==_2521||_2521==sheetPane3Id){
row=addAvailStartRow(row);
}
return {row:row,col:col};
}
}
function getCellContent(cell,_2528){
if(isUndefined(cell)){
cell=currCell;
}
var _2529="";
if(cell!=null){
var fn=getCellFormula(cell);
if(fn&&fn!="null"&&_2528!="cV"){
if(fn==null||fn=="null"){
fn="";
}
if(fn=="hide"){
if(_2528=="fn"){
}else{
fn=cell.getAttribute("cV");
if(fn==null||fn=="null"){
fn="";
}
}
}
_2529=fn;
}else{
var cV=cell.getAttribute("cV");
if(cV==null||cV=="null"){
cV="";
}
_2529=cV;
}
}
return _2529;
}
function getCellFormula(cell){
return (cell)?cell.getAttribute("fn"):"";
}
function getCellFormat(cell){
return (cell)?cell.getAttribute("format"):"";
}
function getCellLabel(row,col){
if(isSSActive){
if(!isNumber(col)||col<0){
col=0;
}
return getColHeadLabel(col+1)+(row+1);
}
}
function getCellPosByLabel(lbl){
var _2531="";
var row="";
var col=0;
for(var i=0,k=0;i<lbl.length;i++,k++){
if(isNaN(lbl.charAt(i))){
_2531+=lbl.charAt(i).toUpperCase();
}else{
row+=lbl.charAt(i);
}
}
if(_2531.length>2||row==0){
var col=-1;
}else{
if(_2531.length==1){
var col=_2531.charCodeAt(0)-65;
}else{
var col=((_2531.charCodeAt(0)-65)*26)+((_2531.charCodeAt(1)-65)+26);
}
}
return {row:row-1,col:col};
}
function encodeBlankSpaces(val,_2537){
_2537=true;
if(_2537){
var _2538=val.length;
firstNonWhiteSpaceCharRegex=/\S/;
lastWhiteSpaceCharGroupRegex=/\s+$/;
var _2539=val.match(firstNonWhiteSpaceCharRegex);
var _253a=val.match(lastWhiteSpaceCharGroupRegex);
var _253b=(_2539&&_2539.index)||0;
var _253c=(_253a&&_253a.index)||_2538;
var _253d=val.substring(0,_253b).replace(/ /g,"&nbsp;");
var _253e=val.substring(_253b,_253c);
var _253f=val.substring(_253c,_2538).replace(/ /g,"&nbsp;");
val=_253d+_253e+_253f;
}else{
val=val.replace(/ /g,"&nbsp;");
}
return val;
}
function isCellRange(){
return (typeof currCellRange!="undefined"&&currCellRange!="")?true:false;
}
function getCellRange(){
if(isCellRange()){
return selectedCellRange;
}else{
startC=endC=ActiveCellInfo.getStartCol();
startR=endR=ActiveCellInfo.getStartRow();
}
return {startRow:(startR<endR)?startR:endR,startCol:(startC<endC)?startC:endC,endRow:(endR>startR)?endR:startR,endCol:(endC>startC)?endC:startC};
}
function hideElement(el){
el.style.left="-100000px";
el.style.top="-100000px";
}
function clearSelection(){
if(typeof tableClicked!="undefined"&&tableClicked){
if(cellFieldSPAN&&isCellFieldSPANHided()){
clearTextSelection();
}
}
}
function setCursor(ev,_2542){
if(sheet&&!colSelected&&!rowSelected){
var el=browser_ie?event.srcElement:ev.target;
var _2544=getCursorPos(ev);
var x=_2544.x;
var y=_2544.y;
var col=getColPosInMouseEvent(ev);
var row=getRowPosInMouseEvent(ev);
var _2549=fPainter.fPaintersingleclick||fPainter.fPainterdoubleclick;
var _254a="url("+ctxpath+"images/fp-cur.cur)"+(browser_ie?"":" 8 8")+", default";
if(isColHead(el)){
var elX=sheetLeft+getColLeft(col)-getSheetScrollLeft();
var width=getColWidth(col);
var _254d=(width<30?2:10);
var _254e=(col>FREEZED_COL)&&((col!=0&&x-elX<=_254d)||(elX+width)-x<=_254d);
var _254f=_254e?"col-resize":_2549?_254a:"";
colHeadTable.style.cursor=_254f;
colHeadTable1.style.cursor=_254f;
}else{
if(isRowHead(el)){
var elY=sheetTop+getRowTop(row)-getSheetScrollTop();
var _2551=getRowHeight(row);
var _2552=(_2551<10?1:4);
var _254e=(row>FREEZED_ROW)&&((row!=0&&y-elY<=_2552)||(elY+_2551)-y<=_2552);
var _254f=_254e?"row-resize":_2549?_254a:"";
rowHeadTable.style.cursor=_254f;
rowHeadTable1.style.cursor=_254f;
}
}
}
}
function isColHead(el){
return (el.parentNode==colHeadTable||el.parentNode==colHeadTable1);
}
function isColHeadHolder(el){
return isColHead(el);
}
function getCol(col,val){
}
function getColHead(col,cHId){
if(typeof cHId=="undefined"||cHId==colHeadId){
return getChildNode(colHeadTable,col);
}else{
return getChildNode(colHeadTable1,col);
}
}
function getColHeadPos(el){
return findIndex(el);
}
function getColHeadHolder(col){
if(isSSActive){
if(isNaN(col)&&typeof col=="object"){
return col.getElementsByTagName("DIV")[0];
}else{
return getColHead(col);
}
}
}
function getColHeadLabel(id){
if(id<=26){
return String.fromCharCode(id+64);
}else{
var rem=id%26;
var mod=Math.floor(id/26);
if(rem==0){
return getColHeadLabel(mod-1)+"Z";
}else{
return getColHeadLabel(mod)+String.fromCharCode(rem+64);
}
}
}
function getRowHeadLabel(id){
if(isNumber(id)){
return (id+1);
}
}
function getColHeadDIV(id){
return getColHead(col);
}
function isRowHead(el){
return (el.parentNode==rowHeadTable||el.parentNode==rowHeadTable1);
}
function isRowHeadHolder(el){
return isRowHead(el);
}
function getRowHead(row,rHId){
var _2564=(rHId===rowHead1Id);
var _2565=_2564?row:getRowIndex(row);
var _2566=_2564?rowHeadTable1:rowHeadTable;
if(_2565>=0){
return _2566.childNodes[_2565];
}
}
function getRowHeadPos(el){
if(el){
var rHId=el.parentNode.parentNode.id;
var row=findIndex(el);
if(rHId==rowHeadId){
row=getExcessiveRowInRowHdr(row);
}
return row;
}
}
function getRowHeadHolder(row){
if(isNaN(row)&&typeof row=="object"){
return row.getElementsByTagName("DIV")[0];
}else{
return getRowHead(row);
}
}
function getRowHeadDIV(id){
return getRowHead(id);
}
function findCellLeft(cell){
if(cell==null){
return 0;
}
var left;
left=parseInt(cell.style.left);
return left;
}
function findCellTop(cell){
if(cell==null){
return 0;
}
var _256f=cell.parentNode.id;
_256f=_256f.substring(0,3);
var top;
if((_256f=="mCC")){
top=parseInt(cell.style.top);
}else{
top=parseInt(cell.parentNode.style.top)+parseInt(cell.style.top);
}
return top;
}
var Steps=new Array();
Steps[1]="ff";
Steps[2]="ee";
Steps[3]="dd";
Steps[4]="cc";
Steps[5]="bb";
Steps[6]="aa";
Steps[7]="99";
var backColors=new Array();
var interval=60;
var fadeelems=new Array();
function showFadeChangesInCell(sR,eR,sC,eC){
backColors=new Array();
fadeelems=new Array();
var k=0;
var bg=0;
for(var i=sR;i<=eR;i++){
for(var j=sC;j<=eC;j++){
var elem=getCell(i,j);
if(elem!=null){
fadeelems[k++]=elem;
var bgclr=elem.style.backgroundColor;
if(bgclr==null||bgclr==""){
bgclr="rgb(255,255,255)";
}
backColors[bg++]=bgclr;
}
}
}
fadeOutInCell(7);
}
function fadeOutInCell(_257b){
if(_257b>=1){
for(i=0;i<fadeelems.length;i++){
var elem=fadeelems[i];
elem.style.backgroundColor="#FFFF"+Steps[_257b];
if(_257b==1){
elem.style.backgroundColor="";
if(backColors[i]!="rgb(255,255,255)"){
elem.style.backgroundColor=backColors[i];
}
}
}
_257b--;
setTimeout("fadeOutInCell("+_257b+")",interval);
}
}
function getCellWidth(_257d){
return parseInt(_257d.style.width);
}
function getCellHeight(_257e){
return parseInt(_257e.style.height);
}
function getMaxLineWidth(arr){
var width=0;
for(var count=0;count<arr.length;count+=1){
width=(getCellValueWidth(arr[count])>width)?getCellValueWidth(arr[count]):width;
}
return width;
}
function getCellContentHeightForMultiline(value){
return contentHeight*(value.split("\n").length);
}
function getCellValueWidth(val){
val=val.replace(/ /g,"&nbsp;");
val=val.replace(/</g,"&lt;");
val=val.replace(/</g,"&gt;");
dummySPAN.innerHTML=val;
return dummySPAN.offsetWidth;
}
function getCellValueHeight(val){
dummySPAN.innerHTML=val;
return dummySPAN.offsetHeight;
}
function setCellFieldSPANHeight(_2585){
if(isRowInViewPort(currRow)){
cellField.style.height=(_2585-1)+"px";
}
}
function setCellFieldSPANWidth(width){
if(isRowInViewPort(currRow)&&isColInViewPort(currCol)){
if(!(browser_ie&&editedFormulaCellInfo.isOtherSheet)){
cellField.style.width=(width-1)+"px";
}
}
}
function isCellFieldInNewMode(){
return (!(isF2KeyPressed||isDblClicked));
}
function isCellFieldInEditMode(){
return (isF2KeyPressed||isDblClicked);
}
function isMultilineInCellField(){
return (exprField.value.indexOf("\n")!=-1)||(cellField.value.indexOf("\n")!=-1);
}
function resetGlobalVariables(){
exprField.value="";
cellField.value="";
cellField.blur();
currFocusFld="";
clearCellRangeFill();
pasteOnly=true;
hideCellFieldSPAN();
closeDialog();
exprField.blur();
exprFieldKeyPressed=false;
isEditingInExprField=false;
requiredCellHeight=0;
cellContentHeight=0;
cellContentWidth=0;
requiredCellWidth=0;
currRowOfCellfield=0;
currColOfCellfield=0;
isSuggestAvailable=false;
maxCellFieldWidthInExprFieldNewMode=0;
posOfCaret=0;
startPosOfSelection=0;
endPosOfSelection=0;
scrolledHeightForExprField=0;
scrolledHeightForCellField=0;
isStylesAssignedForCellField=false;
contentHeight=0;
sheetHeightMaxInViewPort=0;
sheetWidthMaxInViewPort=0;
contentNotReachedMaximumheight=true;
isTextWrapped=false;
contentNotReachedMaximumWidth=true;
COLLAB_DOCUMENT_ID="";
isRegistered=true;
isMouseEventInSheetScrollBar=false;
editMode_enableButtons();
}
function isCellFieldContentOverflowsViewPortHeight(row){
return sheetHeightMaxInViewPort<(getRowTop(row)+getRowHeight(row));
}
function isCellFieldContentOverflowsViewPortWidth(col){
return sheetWidthMaxInViewPort<(getColLeft(col)+getColWidth(col));
}
function isCellWrapped(_2589){
return (_2589&&_2589.className.indexOf(" nW")!=-1)?false:true;
}
function isFormulaCell(){
if(!isFuncDlgOpen&&!(!isCellFieldSPANHided()&&cellField.value.indexOf("=")==0)&&!isExprFunc){
return false;
}else{
return true;
}
}
function scrollCellRangeIntoView(_258a,_258b,_258c,_258d){
if(typeof _258a=="undefined"||typeof _258b=="undefined"||typeof _258c=="undefined"||typeof _258d=="undefined"){
var _258e=getCellRange();
var _258a=_258e.startRow;
var _258b=_258e.startCol;
var _258c=_258e.endRow;
var _258d=_258e.endCol;
}
var _258f=_258a+parseInt((_258c-_258a+1)/2);
var _2590=_258b+parseInt((_258d-_258b+1)/2);
scrollCellIntoView(_258f,_2590);
}
function scrollCellIntoView(row,col){
if(isUndefined(arguments[0])&&isUndefined(arguments[1])){
row=currRow;
col=currCol;
}
scrollRowIntoView(row);
scrollColIntoView(col);
}
function scrollRowIntoView(row){
var _2594=getRowTop(row);
var _2595=getRowHeight(row);
var _2596=0;
var _2597=0;
if(row>=FREEZED_ROW){
_2597=findThirdPaneYPos();
_2596=sheetScrollInfo.scrollTop;
}
if(_2594-_2597<_2596){
setScrollTop(_2594-_2597);
}else{
if((_2594+_2595)>(_2596+sheetHeight)){
setScrollTop((_2594+_2595)-sheetHeight);
}
}
}
function scrollColIntoView(col){
var _2599=getColLeft(col);
var _259a=getColWidth(col);
var _259b=0;
var _259c=0;
if(col>=FREEZED_COL){
_259c=findSecondPaneXPos();
_259b=sheetScrollInfo.scrollLeft;
}
if(_2599-_259c<_259b){
setScrollLeft(_2599-_259c);
}else{
if((_2599+_259a)>(_259b+sheetWidth)){
if(_259a>sheetWidth){
setScrollLeft((_2599));
}else{
setScrollLeft((_2599+_259a)-sheetWidth);
}
}
}
}
function onlyNumber(_259d,e,dec){
var key;
var _25a1;
if(window.event){
key=window.event.keyCode;
}else{
if(e){
key=e.which;
}else{
return true;
}
}
_25a1=String.fromCharCode(key);
if(key==13){
if(_259d.id=="col_width"){
width_height_action("width");
}else{
if(_259d.id=="row_height"){
width_height_action("height");
}
}
}
if((key==null)||(key==0)||(key==8)||(key==9)||(key==13)||(key==27)){
return true;
}else{
if((("0123456789").indexOf(_25a1)>-1)){
return true;
}else{
if(dec&&(_25a1==".")){
_259d.form.elements[dec].focus();
return false;
}else{
return false;
}
}
}
}
function getWidthHeightHtml(_25a2,value){
var html="<div position='current' id="+"\""+"commentdialog"+"\""+">";
html+="<table align='center' width='100%' cellspacing="+"\""+"0"+"\""+" cellpadding="+"\""+"5"+"\""+">";
html+="<tr>";
if(_25a2=="setrowheight"){
html+="<td align='center'><input class='textField' style='width:100%;' id='row_height' maxlength='4' width='100%' onKeyPress='return onlyNumber(this, event)' value="+value+"></td>";
html+="</tr>";
html+="<tr>";
html+="<td"+" align="+"\""+"center"+"\""+">";
html+="<input type="+"\""+"button"+"\""+" class="+"\""+"button"+"\""+" value="+"\""+jsTitleMsg.OK+"\""+" onclick="+"\""+"width_height_action('height'); "+"\""+">";
html+="  <input type="+"\""+"button"+"\""+" class="+"\""+"button"+"\""+" value="+"\""+jsTitleMsg.Cancel+"\""+" onclick="+"\""+"closeDialog(); "+"\""+">";
html+="</td>";
html+="</tr>";
}else{
if(_25a2=="setcolumnwidth"){
html+="<td align='center'><input class='textField' style='width:100%;' id='col_width' maxlength='4' width='100%' onKeyPress='return onlyNumber(this, event)' value="+value+"></td>";
html+="</tr>";
html+="<tr>";
html+="<td"+" align="+"\""+"center"+"\""+">";
html+="<input type="+"\""+"button"+"\""+" class="+"\""+"button"+"\""+" value="+"\""+jsTitleMsg.OK+"\""+" onclick="+"\""+"width_height_action('width'); "+"\""+">";
html+="  <input type="+"\""+"button"+"\""+" class="+"\""+"button"+"\""+" value="+"\""+jsTitleMsg.Cancel+"\""+" onclick="+"\""+"closeDialog(); "+"\""+">";
html+="</td>";
html+="</tr>";
}
}
html+="</table>";
html+="</div>";
return html;
}
function findCell(x,y,_25a7,_25a8,_25a9,_25aa){
var _25ab=findCol(x,_25a8,_25aa);
var _25ac=findRow(y,_25a7,_25a9);
var cell=getValidCellWithDetails(_25ac,_25ab);
return cell;
}
function findCol(x,_25af,_25b0){
var low=_25af;
var high=_25b0;
var mid=-1;
while(low<=high){
mid=parseInt(low+((high-low)/2));
var _25b4=getSheetScrollLeft();
var _25b5=getColWidth(mid);
var _25b6=getColLeft(mid);
if((_25b6-_25b4)>x){
high=mid-1;
}else{
if((_25b6-_25b4)<=x&&((_25b6+_25b5-_25b4)>=x)){
break;
}else{
low=mid+1;
}
}
}
return mid;
}
function findRow(y,_25b8,_25b9){
var low=_25b8;
var high=_25b9;
var mid=-1;
while(low<=high){
mid=parseInt(low+((high-low)/2));
var _25bd=getSheetScrollTop();
var _25be=getRowTop(mid);
var _25bf=getRowHeight(mid);
if((_25be-_25bd)>y){
high=mid-1;
}else{
if((_25be-_25bd)<=y&&((_25be+_25bf-_25bd)>=y)){
break;
}else{
low=mid+1;
}
}
}
return mid;
}
function getFirstCell(row){
return getCell(row,0);
}
function getEndTopOfRow(row){
return (getRowTop(row)+getRowHeight(row));
}
function selectColHead(_25c2,_25c3){
for(var j=_25c2;j<=_25c3;j+=1){
var _25c5=getColHead(j);
if(_25c5!=null){
_25c5.className="colHeadFocus";
}
if(j<FREEZED_COL){
var _25c5=getColHead(j,colHead1Id);
if(_25c5!=null){
_25c5.className="colHeadFocus";
}
}
}
}
function getRowHeads(_25c6,_25c7,rHId){
var _25c9=(rHId===rowHead1Id);
var _25ca=!_25c9?Row.getAvailableRows():Row.getAvailableRowsInFrozenRange();
if(_25ca.length===0){
return [];
}
var _25cb=ArrayUtils.getSortedIndex;
var _25cc=Row.isHidden;
var _25cd=_25cb(_25ca,_25c6);
var _25ce=_25cb(_25ca,_25c7)+(_25cc(_25c7)?0:1);
var _25cf=!_25c9?rowHeadTable:rowHeadTable1;
return ArrayUtils.slice(_25cf.childNodes,_25cd,_25ce);
}
function styleRowHeadRangeWithClass(_25d0,_25d1,_25d2){
var _25d3=getRowHeads(_25d0,_25d1);
var _25d4=getRowHeads(_25d0,_25d1,rowHead1Id);
for(var i=0,len=_25d3.length;i<len;i++){
_25d3[i].className=_25d2;
}
for(var i=0,len=_25d4.length;i<len;i++){
_25d4[i].className=_25d2;
}
}
function selectRowHead(_25d7,_25d8){
styleRowHeadRangeWithClass(_25d7,_25d8,"rowHeadFocus");
}
function blurRowHead(_25d9,_25da){
styleRowHeadRangeWithClass(_25d9,_25da,"");
}
function blurRowHeadTable(){
blurRowHead(ISFREEZED?0:getAvailableStartRow(),getAvailableEndRow());
isColumnSelected=false;
}
function selectRowHeadTable(){
selectRowHead(ISFREEZED?0:getAvailableStartRow(),getAvailableEndRow());
isColumnSelected=true;
}
function selectColHeadTable(){
var _25db=0;
var _25dc=totCols-1;
selectColHead(_25db,_25dc);
isRowSelectd=true;
}
function blurColHead(sC,eC){
for(var j=sC;j<=eC;j+=1){
var co=getColHead(j);
if(typeof co!="undefined"&&co!=null){
co.className="";
}
if(j<FREEZED_COL){
var _25e1=getColHead(j,colHead1Id);
if(_25e1!=null){
_25e1.className="";
}
}
}
}
function blurColHeadTable(){
var _25e2=getCellRange();
blurColHead(_25e2.startCol,_25e2.endCol);
isRowSelectd=false;
}
function blurSheetHeadTables(){
blurColHeadTable();
blurRowHeadTable();
}
function getCurrencySymbol(_25e3){
var _25e4="";
switch(_25e3){
case "DOLLAR":
_25e4=decodeURIComponent("%24");
break;
case "EURO":
_25e4=decodeURIComponent("%E2%82%AC");
break;
case "POUND":
_25e4=decodeURIComponent("%C2%A3");
break;
case "RUPEE":
_25e4=decodeURIComponent("Rs.");
break;
case "YEN":
_25e4=decodeURIComponent("%EF%BF%A5");
break;
case "RMB":
_25e4=decodeURIComponent("%EF%BF%A5");
break;
case "PERCENT":
_25e4=decodeURIComponent("%25");
break;
}
return _25e4;
}
function getCellContentWOF(obj){
var val=getCellContent(obj);
var val=obj.getAttribute("cV");
val=encodeURIComponent(val).trim().toUpperCase();
if(val.indexOf("%24")==0){
val=val.replace("%24","");
}
if(val.indexOf("%E2%82%AC")!=-1){
val=val.replace("%E2%82%AC","");
}
if(val.indexOf("%C2%A3")==0){
val=val.replace("%C2%A3","");
}
if(val.indexOf("RS.")==0){
val=val.replace("RS.","");
}
if(val.indexOf("%EF%BF%A5")==0){
val=val.replace("%EF%BF%A5","");
}
if(val.indexOf("%25")!=-1){
val=val.replace("%25","");
}
if(val.indexOf("%2C")!=-1){
val=val.replace(/%2C/g,"");
}
val=decodeURIComponent(val).trim();
return val;
}
function getValidCellWithDetails(row,col){
var _25e9=getCell(row,col);
while(isNotValidCell(_25e9)){
col-=1;
_25e9=getCell(row,col);
}
return {obj:_25e9,col:col};
}
function isNotValidCell(_25ea){
return (_25ea==null)?true:false;
}
function isColSelected(){
return isColumnSelected;
}
function isRowSelected(){
return isRowSelectd;
}
function isWholeSheetSelected(){
return (isColSelected()&&isRowSelected())?true:false;
}
function isMouseCursorXInViewPort(x){
if(x<findSecondPaneXPos()){
return (isNumber(x)&&(x<0)||(x>getSheetWidth()));
}else{
return (isNumber(x)&&!((x-getSheetScrollLeft())<0)||((x-getSheetScrollLeft())>getSheetWidth()));
}
}
function isMouseCursorYInViewPort(y){
if(y<findThirdPaneYPos()){
return (isNumber(y)&&(y>getSheetHeight())||(y<0));
}else{
return (isNumber(y)&&!((y-getSheetScrollTop())>getSheetHeight())&&!((y-getSheetScrollTop())<0));
}
}
function isMouseCursorYInOutOfViewPort(y){
if(y<findThirdPaneYPos()){
return (isNumber(y)&&(y>getSheetHeight())||(y<0));
}else{
return (isNumber(y)&&((y-getSheetScrollTop())>getSheetHeight())||((y-getSheetScrollTop())<0));
}
}
function isMouseCursorXInOutOfViewPort(x){
if(x<findSecondPaneXPos()){
return (isNumber(x)&&(x<0)||(x>getSheetWidth()));
}else{
return (isNumber(x)&&((x-getSheetScrollLeft())<0)||((x-getSheetScrollLeft())>getSheetWidth()));
}
}
function getNextValidCellWithDetail(row,col){
var _25f1=getCell(row,col);
while(isNotValidCell(_25f1)){
col+=1;
_25f1=getCell(row,col);
}
return {obj:_25f1,col:col};
}
function isCellContainingContent(cell){
return (isCell(cell)&&getCellContent(cell)!="")?true:false;
}
function getTableId(_25f3){
return (_25f3!=null)?_25f3.parentNode.parentNode.id:null;
}
function getTableObject(_25f4){
return (_25f4!=null)?_25f4.parentNode.parentNode:null;
}
function getTotalColumn(){
return totCols-1;
}
function getTotalRows(){
return totRows-1;
}
function getHyperLinkInCell(cell){
if(cell){
if(!featureSupport.boxAlign){
var cls=cell.className;
if(cls.indexOf("vab")!=-1||cls.indexOf("vam")!=-1){
cell=getChildNode(getChildNode(cell,0),0);
}
}
var _25f7=cell.childNodes[0];
if(isHyperLink(_25f7)){
title=_25f7.title;
}else{
title=null;
_25f7=null;
}
return {title:title,childTag:_25f7};
}
return {title:null,childTag:null};
}
function isHyperLink(obj){
return (isObject(obj)&&(obj.tagName)&&((obj.tagName).toUpperCase()=="A"))?true:false;
}
function isRowPresentInSheet(pos){
return ((pos>=0)&&(pos<=totRows))?true:false;
}
function isColPresentInSheet(pos){
return ((pos>=0)&&(pos<=totCols))?true:false;
}
function getDefaultCellHTML(){
var obj=document.createElement("DIV");
obj.className=" cD nW";
obj.style.width=getCellDefaultWidth()+"px";
obj.style.height=getDefaultCellHeight()+"px";
obj.style.top="0px";
obj.style.left="0px";
return obj;
}
function getDefaultColHdr(){
var obj=document.createElement("DIV");
obj.style.width=getCellDefaultWidth()+"px";
obj.style.left="0px";
return obj;
}
function getDefaultRowHdrHTML(){
var obj=document.createElement("DIV");
obj.style.height=getDefaultCellHeight()+"px";
obj.style.top="0px";
return obj;
}
function getMouseWheelData(ev){
if(browser_safari||browser_ie){
var _25ff=ev.wheelDelta/SCROLL_PER_MOUSEWHEEL;
}else{
if(browser_nn6){
var _25ff=ev.detail*-1;
}
}
return _25ff;
}
function getTile(idx,_2601){
if(isUndefined(_2601)){
_2601=sheetPaneId;
}
if(_2601==sheetPane1Id){
return getChildNode(sheetTable1,idx);
}else{
if(_2601==sheetPane2Id){
return getChildNode(sheetTable2,idx);
}else{
if(_2601==sheetPane3Id){
return getChildNode(sheetTable3,idx);
}else{
return getChildNode(sheetTable,idx);
}
}
}
}
function getTiles(_2602,_2603){
var tiles=[];
for(var i=_2602;i<=_2603;i++){
tiles[i]=getTile(i);
}
return tiles;
}
function getAvailableTiles(_2606){
if(isUndefined(_2606)){
_2606=sheetPaneId;
}
if(_2606==sheetPane1Id){
return ((browser_ie)?sheetTable1.children:sheetTable1.childNodes);
}else{
if(_2606==sheetPane2Id){
return ((browser_ie)?sheetTable2.children:sheetTable2.childNodes);
}else{
if(_2606==sheetPane3Id){
return ((browser_ie)?sheetTable3.children:sheetTable3.childNodes);
}else{
return ((browser_ie)?sheetTable.children:sheetTable.childNodes);
}
}
}
}
function getTilesCount(_2607){
var _2608=1;
if(isUndefined(_2607)||_2607==sheetPaneId||_2607==sheetPane3Id){
var _2608=((browser_ie)?sheetTable.children.length:sheetTable.childNodes.length);
}
return _2608;
}
function getFirstTile(_2609){
if(isUndefined(_2609)){
_2609=sheetPaneId;
}
if(_2609==sheetPane1Id){
return ((browser_ie)?sheetTable1.children[0]:sheetTable1.childNodes[0]);
}else{
if(_2609==sheetPane3Id){
return ((browser_ie)?sheetTable3.children[0]:sheetTable3.childNodes[0]);
}else{
return ((browser_ie)?sheetTable.children[0]:sheetTable.childNodes[0]);
}
}
}
function getLastTile(_260a){
if(isUndefined(_260a)){
_260a=sheetPaneId;
}
if(_260a==sheetPane1Id){
return ((browser_ie)?sheetTable1.children[sheetTable1.children.length-1]:sheetTable1.childNodes[sheetTable1.childNodes.length-1]);
}else{
if(_260a==sheetPane2Id){
return ((browser_ie)?sheetTable2.children[sheetTable2.children.length-1]:sheetTable2.childNodes[sheetTable2.childNodes.length-1]);
}else{
if(_260a==sheetPane3Id){
return ((browser_ie)?sheetTable3.children[sheetTable3.children.length-1]:sheetTable3.childNodes[sheetTable3.childNodes.length-1]);
}else{
return ((browser_ie)?sheetTable.children[sheetTable.children.length-1]:sheetTable.childNodes[sheetTable.childNodes.length-1]);
}
}
}
}
function getFirstRowHdr(){
return ((browser_ie)?rowHeadTable.children[0]:rowHeadTable.childNodes[0]);
}
function getLastRowHdr(){
return (browser_ie)?rowHeadTable.children[rowHeadTable.children.length-1]:rowHeadTable.childNodes[rowHeadTable.childNodes.length-1];
}
function getRowHeaders(){
return (browser_ie)?rowHeadTable.children:rowHeadTable.childNodes;
}
function getColHeaders(){
return (browser_ie)?colHeadTable.children:colHeadTable.childNodes;
}
function getAvailableStartRow(){
if(availableStartRow){
return availableStartRow;
}else{
availableStartRow=0;
return availableStartRow;
}
}
function getAvailableEndRow(){
if(availableEndRow){
return availableEndRow;
}else{
availableEndRow=0;
return availableEndRow;
}
}
function getAvailableStartCol(){
return 0;
}
function getAvailableEndCol(){
return totCols-1;
}
function getFloorRow(row){
if(row<Row.firstNonHiddenRow){
row=Row.firstNonHiddenRow;
}
var _260c=(row-Row.getHiddenRowCount(0,row-1))%ROWS_PER_TILE;
return ((_260c===0)?row:Row.findNthNonHiddenRow(_260c,row,false));
}
function getCeilRow(row){
if(Row.lastNonHiddenRow>=0&&row>=Row.lastNonHiddenRow){
return Row.lastNonHiddenRow+1;
}
if(row<Row.firstNonHiddenRow){
row=Row.firstNonHiddenRow;
}
var _260e=(row-Row.getHiddenRowCount(0,row-1))%ROWS_PER_TILE;
return ((_260e===0)?row:Row.findNthNonHiddenRow(ROWS_PER_TILE-_260e,row,true));
}
function isTiledRow(row){
if(row===Row.firstNonHiddenRow){
return true;
}else{
var _2610=Row.getHiddenRowCount(0,row);
return ((row-_2610)%ROWS_PER_TILE===0)?true:false;
}
}
function getLoadedAreaYs(){
var start=getAvailableStartRow();
var end=getAvailableEndRow();
var _2613,endY;
if(start===-1){
_2613=0;
endY=0;
}else{
_2613=getRowTop(start);
endY=getRowTop(end)+getRowHeight(end);
}
return {startY:_2613,endY:endY};
}
function isYInLoadedArea(y){
var _2616=getLoadedAreaYs();
return (y>_2616.startY&&y<=_2616.endY);
}
function findRowInYPos(y,_2618,_2619){
var rows=Row.getAvailableRows();
var len=rows.length;
if(!_2619&&(len>0)&&isYInLoadedArea(y)){
var low=0;
var high=rows.length;
var mid=-1;
while(len){
mid=~~(high/2);
var _261f=getRowTop(rows[mid]);
var _2620=getRowHeight(rows[mid]);
if(y<=_261f){
rows=rows.slice(0,mid);
}else{
if(y>(_261f+_2620)){
rows=rows.slice(mid+1);
}else{
break;
}
}
high=rows.length;
}
return rows[mid];
}else{
var low=0;
var high=totRows;
var mid=-1;
if(_2618){
high=getRowMax();
}
while(low<=high){
mid=parseInt(low+((high-low)/2));
var _261f=parseInt(getRowTop(mid))+1;
var _2620=parseInt(getRowHeight(mid));
if(_261f>y){
high=mid-1;
}else{
if((_261f<=y)&&(_261f+_2620>y)){
break;
}else{
low=mid+1;
}
}
}
return mid;
}
}
function findColInXPos(x,_2622){
var low=0;
var high=totCols;
var mid=-1;
if(_2622){
high=getColMax();
}
while(low<=high){
mid=parseInt(low+((high-low)/2));
var _2626=parseInt(getColLeft(mid))+1;
var _2627=parseInt(getColWidth(mid));
if(_2626>x){
high=mid-1;
}else{
if((_2626<=x)&&((_2626+_2627)>x)){
break;
}else{
low=mid+1;
}
}
}
return mid;
}
function getRoundedRowRange(_2628,_2629){
if(isNumber(_2628)&&isNumber(_2629)){
return {firstRow:getFloorRow(_2628),lastRow:getCeilRow(_2629)};
}
}
function isSheetScrolledDown(){
return (currScrollTop<=getSheetScrollTop())?true:false;
}
function getRowRangeToRemove(_262a){
var _262b;
var _262c;
if(isStr(_262a)){
switch(_262a){
case "UNLOADED_PAGE":
_262b=getFloorRow(getAvailableStartRow());
_262c=getCeilRow(getAvailableEndRow());
break;
case "END_OF_PAGE":
case "PAGE_AFTER_CURRENT_PAGE":
_262b=getFloorRow(getAvailableStartRow());
_262c=getFloorRow(getFallenRowRangeToRemove(_262a).lastRow);
break;
case "START_OF_PAGE":
case "PAGE_BEFORE_CURRENT_PAGE":
_262c=getCeilRow(getAvailableEndRow());
_262b=getCeilRow(getFallenRowRangeToRemove(_262a).firstRow);
break;
}
return {firstRow:_262b,endRow:_262c};
}
}
function getFallenRowRangeToRemove(_262d){
var _262e;
var _262f;
if(isStr(_262d)){
var _2630=getSheetScrollTop();
var _2631=getSheetHeight();
switch(_262d){
case "START_OF_PAGE":
case "PAGE_BEFORE_CURRENT_PAGE":
_262e=findRowInYPos(_2630+2*_2631);
_262f=findRowInYPos(_2630+3*_2631);
break;
case "END_OF_PAGE":
case "PAGE_AFTER_CURRENT_PAGE":
_262e=findRowInYPos(_2630-2*_2631);
_262f=findRowInYPos(_2630-_2631);
break;
}
return {firstRow:_262e,lastRow:_262f};
}
}
function getTilePosToRemove(_2632,_2633){
if(isNumber(_2632)&&isNumber(_2633)){
var _2634=getAvailableStartRow();
_2634=(isTiledRow(_2634))?_2634:getFloorRow(_2634);
var _2635=getTileCountToRemove(_2632,_2633);
var tiles=[];
for(var i=0;i<_2635;i++){
if(_2632>=_2634){
tiles.push((_2632-_2634)/ROWS_PER_TILE);
}
_2632+=ROWS_PER_TILE;
}
return tiles;
}
}
function getTileCountToRemove(_2638,_2639){
return ((_2639-_2638)/ROWS_PER_TILE);
}
function validateRequestRange(_263a,_263b,_263c){
var _263a=getFloorRow(_263a);
var _263b=getCeilRow(_263b);
switch(_263c){
case "SCROLLDOWN":
var _263d=getAvailableEndRow();
if(_263d>0){
_263d=_263d+1;
}
if(_263d>_263a){
_263a=_263d;
}
_263b=(_263b<totRows)?_263b:totRows;
break;
case "SCROLLUP":
var _263e=getAvailableStartRow();
_263b=(_263e<=_263b)?_263e:_263b;
break;
}
return {startRow:_263a,endRow:_263b,isValidRequestRange:(_263a<=(_263b-1))};
}
function getRowCountPerPage(){
return Math.ceil(getSheetHeight()/cellDefaultHeight);
}
function getRowRangeForPageInView(_263f,_2640){
var _2641;
var _2642;
if(isStr(_263f)){
var _2643=(_2640===undefined)?getSheetScrollTop():_2640;
var _2644=getSheetPaneHeight();
switch(_263f){
case "END_OF_PAGE":
_2641=findRowInYPos(_2643);
_2642=findRowInYPos(_2643+2*_2644);
break;
case "START_OF_PAGE":
_2641=findRowInYPos(_2643-_2644);
_2642=findRowInYPos(_2643+_2644);
break;
case "UNLOADED_PAGE":
_2641=findRowInYPos(_2643-_2644,undefined,true);
_2642=findRowInYPos(_2643+2*_2644,undefined,true);
break;
case "PAGE_AFTER_CURRENT_PAGE":
_2641=findRowInYPos(_2643);
_2642=findRowInYPos(_2643+2*_2644);
break;
case "PAGE_BEFORE_CURRENT_PAGE":
_2641=findRowInYPos(_2643-_2644);
_2642=findRowInYPos(_2643+_2644);
break;
}
return {firstRow:_2641,lastRow:_2642};
}
}
function getTileContainerMarkup(){
var _2645=document.createElement("DIV");
_2645.style.left="0px";
_2645.style.width="0px";
_2645.style.height="0px";
_2645.style.top="0px";
_2645.style.overflow="visible";
_2645.style.position="absolute";
return _2645;
}
function getCellsInTile(el,_2647){
var tile=isElement(arguments[0])?el:getTile(arguments[0],_2647);
return tile.childNodes;
}
function getFirstCellInTile(el){
return getChildNode(tile,0);
}
function getLastCellInTile(el){
return getChildNode(tile,getChildNodesLength(tile)-1);
}
function getCellsInTileByIndex(idx,_264c){
var tile=getTile(idx,_264c);
var cells=getCellsInTile(tile,_264c);
return cells;
}
function getCellsInColumn(col,_2650,_2651,_2652){
var _2653=!(_2652==sheetPane1Id||_2652==sheetPane2Id)?Row.getAvailableRows():Row.getAvailableRowsInFrozenRange();
if(_2650===undefined){
_2650=_2653[0];
}
if(_2651===undefined){
_2651=_2653[_2653.length-1];
}
var _2654=ArrayUtils.getSortedIndex;
var _2655=Row.isHidden(_2650)?_2654(_2653,_2650):getRowIndex(_2650);
var _2656=Row.isHidden(_2651)?_2654(_2653,_2651):getRowIndex(_2651);
var _2657=~~(_2655/ROWS_PER_TILE);
var _2658=~~(_2656/ROWS_PER_TILE);
var _2659=((_2655%ROWS_PER_TILE)*totCols)+col;
var cells=[];
for(var i=_2657;i<=_2658;i++){
var _265c=getTile(i).childNodes;
var len=(i===_2658)?(((_2656%ROWS_PER_TILE)*totCols)+col+1):_265c.length;
for(var j=_2659;j<len;j=j+totCols){
cells.push(_265c[j]);
}
_2659=col;
}
return cells;
}
function getCellsInCol(col,_2660){
return getCellsInCols(col,col,_2660);
}
function getCellsInCols(_2661,_2662,_2663){
var _2664=[];
var _2665=ROWS_PER_TILE*totCols;
var k=0;
var diff=_2662-_2661;
var incr=totCols-_2662+_2661;
if(isUndefined(_2663)){
_2663=sheetPaneId;
}
var tiles=getAvailableTiles(_2663);
var _266a=getTilesCount(_2663);
for(var i=0;i<_266a;i++){
var tile=tiles[i];
var cells=getCellsInTile(tile,_2663);
for(var j=_2661,l=0;j<_2665;){
var cell=cells[j];
_2664[k]=cell;
k++;
if(l==diff){
j+=incr;
l=0;
}else{
j++;
l++;
}
}
}
return _2664;
}
function getCellsInRows(_2671,_2672){
if(isUndefined(_2672)){
_2672=sheetPaneId;
}
var _2673=[];
for(var i=0;i<_2671.length;i++){
var _2675=[];
for(var j=0;j<totCols;j++){
_2675[j]=getCell(_2671[i],j,_2672,true);
}
_2673[i]=_2675;
}
return _2673;
}
function getCellsInRowOfTile(row,tile,_2679){
if(isUndefined(_2679)){
_2679=sheetPaneId;
}
if(!isElement(tile)){
var tile=getTile(tile,_2679);
}
var cells=getCellsInTile(tile,_2679);
var _267b=ROWS_PER_TILE*totCols;
var _267c=row*totCols;
var _267d=_267c+totCols;
var _267e=[];
for(var i=_267c,k=0;i<_267d;i++,k++){
_267e[k]=cells[i];
}
return _267e;
}
function getCellsInRowsOfTile(_2681,_2682,tile){
if(!isElement(tile)&&!isArray(tile)){
var tile=getTile(tile);
}
var _2684=[];
for(var i=_2681,k=0;i<=_2682;i++,k++){
_2684[k]=getCellsInRowOfTile(i,tile);
}
return _2684;
}
function isSheetScrollTopCrossedLastRow(){
return ((getSheetScrollTop()+getSheetHeight())>=getSheetTableHeight())?true:false;
}
function getTileInfoForCell(row,col,_2689){
var cell=isElement(arguments[0])?arguments[0]:getCell(row,col,_2689);
var tile=cell.parentNode;
var index=findIndex(tile);
return {tileElement:tile,tileIndex:index};
}
function getTileInfoForRow(row){
var _268e=Math.floor(row/ROWS_PER_TILE);
var tile=getTile(_268e);
return {tileElement:tile,tileIndex:_268e};
}
function setColDetails(_2690,arg1,arg2,arg3){
switch(_2690){
case "RANGE":
var _2694=arg1;
var _2695=arg2;
var colWd=parseInt(arg3);
var diff=(((_2695+1-_2694)*colWd)-(colLeftAry[_2695+1]-colLeftAry[_2694]));
var _2698=colLeftAry[_2694];
var _2699=colLeftAry.length;
for(var i=_2694;i<=_2695;i++){
colWidthAry[i]=colWd;
colLeftAry[i+1]=_2698+colWd;
_2698=colLeftAry[i+1];
}
for(var i=_2695+2;i<_2699;i++){
colLeftAry[i]+=diff;
}
break;
case "RESIZE":
var col=arg1;
var colWd=parseInt(arg2);
var diff=colWidthAry[col]-colWd;
colWidthAry[col]=colWd;
var _2699=colLeftAry.length;
for(var i=col+1;i<_2699;i++){
colLeftAry[i]+=diff;
}
break;
case "INSERT":
var _2694=arg1;
var cnt=arg2;
var colWd=parseInt(arg3);
var diff=cnt*colWd;
var _269d=[];
var _269e=[];
var _2699=colLeftAry.length;
for(var i=0;i<cnt;i++){
_269d[i]=colWd;
}
var _2698=colLeftAry[_2694];
for(var i=0;i<cnt;i++){
_269e[i]=_2698+(i*colWd);
}
var _269f=colWidthAry.slice(0,_2694);
var _26a0=colWidthAry.slice(_2694,_2699-cnt);
var _26a1=colLeftAry.slice(0,_2694);
var _26a2=colLeftAry.slice(_2694,_2699-cnt);
for(var i=0,len=_26a2.length;i<len;i++){
_26a2[i]=diff+parseInt(_26a2[i]);
}
colWidthAry=(_269f.concat(_269d)).concat(_26a0);
colLeftAry=(_26a1.concat(_269e)).concat(_26a2);
break;
case "DELETE":
var _2694=arg1;
var cnt=arg2;
var _2699=colLeftAry.length;
var _26a1=colLeftAry.slice(0,_2694);
var _26a2=colLeftAry.slice(_2694+cnt,_2699);
var diff=colLeftAry[_2694+cnt]-colLeftAry[_2694];
for(var i=0,len=_26a2.length;i<len;i++){
_26a2[i]=_26a2[i]-diff;
}
colWidthAry.splice(_2694,cnt);
colLeftAry=_26a1.concat(_26a2);
for(var i=_2699-cnt;i<_2699;i++){
var wd=getCellDefaultWidth();
colWidthAry[i]=wd;
colLeftAry[i]=colLeftAry[i-1]+wd;
}
break;
}
}
function getColLeft(col){
return colLeftAry[col];
}
function getColWidth(col){
return colWidthAry[col];
}
function getRowTop(row){
return rowTopAry[row];
}
function getRowHeight(row){
return rowHeightAry[row];
}
function getEndLeftOfCol(col){
return (getColLeft(col)+getColWidth(col));
}
function setRowDetails(_26aa,arg1,arg2,arg3){
switch(_26aa){
case "LOAD":
case "RANGEOBJ":
var _26ae=arg1;
var index=0;
rowTopAry[0]=0;
var _26b0=false;
var _26b1;
for(var x in _26ae){
if(typeof _26ae[x]!="undefined"){
if(typeof _26ae[x].sr!="undefined"){
var _26b3=_26ae[x].sr;
var _26b4=_26ae[x].er;
var value=_26ae[x].v;
if((typeof _26b1!="undefined")&&_26b1+1!==_26b3){
for(var i=_26b1+1;i<_26b3;i++){
if(i!=0){
rowTopAry[i]=rowTopAry[i-1]+rowHeightAry[i-1];
}
}
}
for(var i=_26b3;i<=_26b4;i++){
rowHeightAry[i]=value;
if(i!==0){
rowTopAry[i]=rowTopAry[i-1]+rowHeightAry[i-1];
}
}
_26b0=true;
index=_26b4;
_26b1=_26b4;
}
}
}
if(_26b0){
while(index<getRowMax()){
if(index!=0){
rowTopAry[index]=rowTopAry[index-1]+rowHeightAry[index-1];
}
index++;
}
Row.minifyHiddenRowInfo(true);
}
break;
case "RANGE":
var _26b3=arg1;
var _26b4=arg2;
var rowHt=parseInt(arg3);
var diff=(((_26b4+1-_26b3)*rowHt)-(rowTopAry[_26b4+1]-rowTopAry[_26b3]));
var _26b9=rowTopAry[_26b3];
for(var i=_26b3;i<=_26b4;i++){
rowHeightAry[i]=rowHt;
rowTopAry[i+1]=_26b9+rowHt;
_26b9=rowTopAry[i+1];
}
for(var i=_26b4+2,len=rowTopAry.length;i<len;i++){
rowTopAry[i]+=diff;
}
break;
case "RESIZE":
var row=arg1;
var rowHt=parseInt(arg2);
var diff=rowHeightAry[row]-rowHt;
rowHeightAry[row]=rowHt;
for(var i=row+1,len=rowHeightAry.length;i<len;i++){
rowTopAry[i]+=diff;
}
break;
case "INSERT":
var _26b3=arg1;
var cnt=arg2;
var rowHt=parseInt(arg3);
var diff=cnt*rowHt;
var _26bd=[];
var _26be=[];
var _26bf=rowTopAry.length;
for(var i=0;i<cnt;i++){
_26bd[i]=rowHt;
}
var _26b9=rowTopAry[_26b3];
for(var i=0;i<cnt;i++){
_26be[i]=_26b9+(i*rowHt);
}
var _26c0=rowHeightAry.slice(0,_26b3);
var _26c1=rowHeightAry.slice(_26b3,_26bf-cnt);
var _26c2=rowTopAry.slice(0,_26b3);
var _26c3=rowTopAry.slice(_26b3,_26bf-cnt);
for(var i=0,len=_26c3.length;i<len;i++){
_26c3[i]=diff+parseInt(_26c3[i]);
}
rowHeightAry=(_26c0.concat(_26bd)).concat(_26c1);
rowTopAry=(_26c2.concat(_26be)).concat(_26c3);
Row.minifyHiddenRowInfo(true);
break;
case "DELETE":
var _26c4=arg1;
var cnt=_26c4.length;
var len=rowHeightAry.length;
var _26c5=_26c4[0];
var _26c6=_26c4[_26c4.length-1]+1;
var _26c7=rowHeightAry.slice(0,_26c5);
var _26c8=rowHeightAry.slice(_26c6,len);
var _26c9=rowHeightAry.slice(_26c5,_26c6);
var _26ca=[];
var start=1;
for(var i=1;i<cnt;i++){
var end=_26c4[i]-_26c5;
_26ca=_26ca.concat(_26c9.slice(start,end));
start=end+1;
}
var _26cd=[];
var ht=getDefaultCellHeight();
for(var i=0;i<cnt;i++){
_26cd.push(ht);
}
window.rowHeightAry=_26c7.concat(_26ca).concat(_26c8).concat(_26cd);
if(_26c5===0){
_26c5=1;
rowTopAry[0]=0;
}
for(var i=_26c5,len=rowHeightAry.length;i<len;i++){
rowTopAry[i]=rowTopAry[i-1]+rowHeightAry[i-1];
}
Row.minifyHiddenRowInfo(true);
break;
case "HIDE":
var _26cf=arg1;
var _26d0=arg2;
var len,_26d1;
if(_26cf==="all"){
len=rowHeightAry.length-1;
do{
rowHeightAry[len]=0;
}while(len--);
_26d1=0;
}else{
_26d1=_26cf[0];
for(var i=0,_26d2=_26cf.length;i<_26d2;i++){
rowHeightAry[_26cf[i]]=0;
}
}
for(var i=_26d1+1,len=rowHeightAry.length;i<len;i++){
rowTopAry[i]=rowTopAry[i-1]+rowHeightAry[i-1];
}
for(var i=rowIndex+1,len=rowDetails.length;i<len;i++){
rowDetails[i].t=getRowTop(i)+diff;
}
break;
case "RESIZE":
var row=arg1;
var _26d3=convertNumber(arg2);
var _26d4=getRowHeight(row);
var diff=_26d3-_26d4;
rowDetails[row].h=_26d3;
for(var i=row,len=rowDetails.length;i<len;i++){
rowDetails[i].t=getRowTop(i)+diff;
}
break;
case "INSERT":
var _26b3=arg1;
var cnt=arg2;
var _26d3=convertNumber(arg3);
var diff=0;
for(var i=_26b3;i<(_26b3+cnt);i++){
var _26d4=getRowHeight(i);
diff+=(_26d3-_26d4);
}
for(var i=(_26b3+cnt),len=(rowDetails.length+cnt);i<len;i++){
var obj={};
obj["h"]=getRowHeight(i-cnt);
obj["t"]=getRowTop(i)+diff;
rowDetails[i]=obj;
}
diff=0;
for(var i=_26b3;i<(_26b3+cnt);i++){
var _26d4=getRowHeight(i);
rowDetails[i].h=_26d3;
rowDetails[i].t=getRowTop(i)+diff;
diff+=(_26d3-_26d4);
}
var diff=cnt*_26d3;
var len=rowDetails.length;
var _26d6=rowDetails.slice(0,_26b3);
var _26d7=rowDetails.slice(_26b3,len);
var _26d8=(_26b3==totRows)?true:false;
if(_26d8){
var _26d9=_26d3;
var _26da=getRowTop(_26b3-1)+getRowHeight(_26b3-1);
}else{
var _26d9=_26d3;
var _26da=getRowTop(_26b3);
}
for(var i=0;i<cnt;i++){
var temp=getRowColDetailsTemplate("ROW");
temp.h=_26d3;
temp.t=_26da;
_26d6[_26b3+i]=temp;
_26da+=_26d9;
var temp={};
temp["h"]=_26d3;
temp["t"]=_26da;
_26d6[_26b3+i]=temp;
_26da+=_26d9;
}
for(var i=0,len=_26d7.length;i<len;i++){
_26d7[i].t=_26d7[i].t+diff;
}
rowDetails=_26d6.concat(_26d7);
Row.minifyHiddenRowInfo(true);
break;
case "INSERT_COPIED_ROWS":
var _26dc=arg1;
var _26d1=arg2;
var endR=arg3;
var _26de=rowHeightAry.slice(_26d1,endR+1);
var _26df=rowHeightAry.slice(0,_26dc);
var _26e0=rowHeightAry.slice(_26dc,getRowMax());
rowHeightAry=_26df.concat(_26de).concat(_26e0);
rowHeightAry.length=getRowMax();
for(var i=_26d1+1,len=rowHeightAry.length;i<len;i++){
rowTopAry[i]=rowTopAry[i-1]+rowHeightAry[i-1];
}
Row.minifyHiddenRowInfo(true);
break;
}
}
function updateRowDetails(_26e1){
var _26e2=_26e1[_26e1.length-1];
if(totRows<_26e2){
totRows=_26e2+1;
setSheetTableHeight(getRowTop(_26e2)+getRowHeight(_26e2));
}
}
function getDefaultCellHeight(){
return cellDefaultHeight;
}
function getCellDefaultWidth(){
return cellDefaultWidth;
}
function isCellField(el){
return (el==cellField)?true:false;
}
function setSheetTableHeight(_26e4){
if(isNumber(_26e4)&&_26e4>=0){
var _26e5=getSheetHeight();
var _26e6;
if(_26e4<_26e5){
_26e6=_26e4;
}else{
if(parseInt(sheetPane.style.height)<_26e5){
_26e6=_26e5;
}
}
var _26e7=!isUndefined(_26e6);
rowHeadTable.style.height=_26e4+"px";
sheetTable.style.height=_26e4+"px";
if(ISFREEZED){
_26e6=_26e6-getRowTop(FREEZED_ROW);
if(_26e6<0){
_26e6=0;
}
if(FREEZED_ROW>0){
sheetTable2.style.height=_26e4+"px";
}
if(FREEZED_COL>0){
sheetTable3.style.height=_26e4+"px";
if(_26e7){
sheetPane3.style.height=_26e6+"px";
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
sheetTable1.style.height=_26e4+"px";
}
}
if(_26e7){
sheetPane.style.height=_26e6+"px";
}
ssVScrollDIV.style.height=_26e4+"px";
totalTableHeight=_26e4;
}
}
function setSheetTableWidth(width){
if(isNumber(width)&&width>=0){
sheetTable.style.width=colHeadTable.style.width=width+" px";
if(ISFREEZED){
if(FREEZED_ROW>0){
sheetTable2.style.width=width+" px";
}
if(FREEZED_COL>0){
sheetTable3.style.width=width+" px";
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
sheetTable1.style.width=width+" px";
}
}
var _26e9=width-(parseInt(sheet.style.width)-parseInt(ssHScrollbar.style.width));
totalTableWidth=width;
if(_26e9>=0){
ssHScrollDIV.style.width=_26e9+"px";
}else{
ssHScrollDIV.style.width=0+"px";
}
}
}
function getSheetTableWidth(){
return totalTableWidth;
}
function getSheetTableHeight(){
return totalTableHeight;
}
function getSheetScrollHeight(){
return sheetPane.scrollHeight;
}
function getSheetScrollWidth(){
return sheetPane.scrollWidth;
}
function setSheetHeight(_26ea){
if(isNumber(_26ea)){
rowHead.style.height=ssVScrollbar.style.height=sheet.style.height=sheetPane.style.height=_26ea+"px";
sheetHeight=_26ea;
}
}
function getSheetHeight(){
sheetHeight=parseInt(sheet.style.height);
return sheetHeight;
}
function getSheetPaneHeight(){
return parseInt(sheetPane.style.height);
}
function setSheetWidth(width){
if(isNumber(width)){
colHead.style.width=width+"px";
sheet.style.width=width+"px";
sheetPane.style.width=width+"px";
var _26ec=ssHScrollbar.parentNode.offsetWidth;
ssHScrollbar.style.width=_26ec+"px";
var _26ed=getSheetTableWidth();
if(_26ed){
ssHScrollDIV.style.width=(_26ed-getSheetWidth()+_26ec)+"px";
}
}
}
function getSheetWidth(){
sheetWidth=parseInt(sheet.style.width);
return sheetWidth;
}
function isColExceedsMaxColumn(col){
if(isNumber(col)){
if(ISFREEZED){
var _26ef=getActivePane();
var _26f0;
switch(_26ef){
case 1:
case 3:
_26f0=(col+1<FREEZED_COL);
break;
case 2:
case 4:
_26f0=(col+1<totCols);
break;
}
return _26f0;
}else{
var _26f0=(col+1<totCols);
return _26f0;
}
}
}
function isRowExceedsMaxRow(row){
if(isNumber(row)){
if(ISFREEZED){
var _26f2=getActivePane();
switch(_26f2){
case 1:
case 2:
_26f3=(row+1<FREEZED_ROW);
break;
case 3:
case 4:
_26f3=(row+1<totRows);
break;
}
}else{
var _26f3=(row+1<totRows);
}
return _26f3;
}
}
function getSheetScrollLeft(){
return sheetScrollInfo.scrollLeft;
}
function getSheetScrollTop(){
return sheetScrollInfo.scrollTop;
}
function addAvailStartRow(row){
return row+getAvailableStartRow();
}
function reduceAvailStartRow(row){
var _26f6=getAvailableStartRow();
return (_26f6==-1)?_26f6:(row-_26f6);
}
function getDeficientRowInRowHdr(row){
return row-getFirstRowInRowHdr();
}
function getExcessiveRowInRowHdr(row){
return row+getFirstRowInRowHdr();
}
function isRowInsideCurrCellRange(pos){
if(isCellRange()){
var _26fa=getCellRange();
return (pos>=_26fa.startRow&&pos<=_26fa.endRow);
}else{
var info=ActiveCellInfo;
return (pos>=info.getStartRow()&&pos<=info.getEndRow());
}
}
function isColInsideCurrCellRange(pos){
if(isCellRange()){
var _26fd=getCellRange();
return (pos>=_26fd.startCol&&pos<=_26fd.Col);
}else{
var info=ActiveCellInfo;
return (pos>=info.getStartCol()&&pos<=info.getEndCol());
}
}
function isBlankAreaInViewPort(){
return isBlankAreaInTopOfViewPort()||isBlankAreaInBottomOfViewPort();
}
function isBlankAreaInBelowViewPort(){
return isBlankAreaInBottomOfViewPort(0);
}
function isBlankAreaInAboveViewPort(){
return isBlankAreaInTopOfViewPort(0);
}
function isBlankAreaInTopOfViewPort(_26ff){
if(isUndefined(_26ff)){
_26ff=PAGES_PER_LOAD;
}
var _2700=getAvailableStartRow();
var _2701=getRowTop(_2700);
var _2702=getSheetHeight();
var _2703=getSheetScrollTop()-_26ff*_2702;
_2703=(_2703<0)?0:_2703;
return (_2701>_2703);
}
function isBlankAreaInBottomOfViewPort(_2704){
if(isUndefined(_2704)){
_2704=PAGES_PER_LOAD;
}
var _2705=getAvailableEndRow();
if(_2705>=0){
var _2706=getRowTop(_2705)+getRowHeight(_2705);
}else{
var _2706=0;
}
var _2707=getSheetPaneHeight();
var _2708=getSheetScrollTop()+(_2704+1)*_2707;
var _2709=getSheetTableHeight();
_2708=(_2708<_2709)?_2708:_2709;
return (_2706<_2708);
}
function getBoundaryRowInViewPort(){
var _270a=getSheetScrollTop();
var _270b=findRowInYPos(_270a+findThirdPaneYPos())+1;
var _270c=findRowInYPos(_270a+getSheetHeight())+1;
var _270d=getRowMax();
_270b=(ISFREEZED)?((_270b<=FREEZED_ROW)?FREEZED_ROW+1:_270b):((_270b>0)?_270b:1);
_270c=(_270c<=(_270d))?_270c:_270d;
return {firstRow:_270b,lastRow:_270c};
}
function getXYPositions(){
var _270e=getSheetScrollTop();
var _270f=getSheetScrollLeft();
var _2710,_2711;
if(_270e==0){
_2710=0;
}else{
_2710=findRowInYPos(_270e+findThirdPaneYPos())+1;
}
if(_270f==0){
_2711=0;
}else{
_2711=findColInXPos(_270f+findSecondPaneXPos())+1;
}
return {firstRow:_2710,firstCol:_2711};
}
function getColHeads(_2712,_2713,_2714){
var _2714=_2714||colHeadTable;
return ArrayUtils.slice(_2714.childNodes,_2712,_2713+1);
}
function shiftColHead(_2715,shift){
if(_2715!=null){
if(shift.mode=="DIFF"){
_2715.style.left=(parseInt(_2715.style.left)+shift.val)+"px";
}else{
_2715.style.left=shift.val+"px";
}
}
}
function shiftColHeads(_2717,_2718,shift,_271a){
if(isUndefined(_271a)){
var _271a=getColHeads(_2717,_2718);
}
for(var i=0,_271c=_2717;i<_271a.length;i++){
var colNo=i+_2717;
var _271e=0;
if(shift.mode=="DIFF"){
_271e=getColLeft(colNo);
}else{
_271e=shift.val;
}
_271a[i].style.left=_271e+"px";
_271c=(_271c==_2718)?0:_271c+1;
}
}
function shiftRowHead(_271f,shift){
if(_271f!=null){
if(shift.mode=="DIFF"){
_271f.style.top=(parseInt(_271f.style.top)+shift.val)+"px";
}else{
var _2721=shift.val;
_271f.style.top=_2721+"px";
}
}
}
function shiftRowHeads(_2722,_2723,shift,_2725){
if(isNumber(_2722)&&isNumber(_2723)){
if(isUndefined(_2725)){
var _2725=getRowHeads(_2722,_2723);
}
for(var i=0,_2727=_2722;i<_2725.length;i++){
var rowNo=i+_2722;
var _2729=0;
if(shift.mode=="DIFF"){
_2729=getRowTop(rowNo)+shift.val;
}else{
_2729=shift.val;
}
if(_2725[i]){
_2725[i].style.top=_2729+"px";
}
_2727=(_2727==_2723)?0:_2727+1;
}
}
}
function shiftRowHeadsBy(_272a,_272b){
var len=_272a.length;
for(var i=0;i<len;i++){
var _272e=_272a[i];
_272e.style.top=parseInt(_272e.style.top)+_272b+"px";
}
}
function positionRowHeads(_272f,_2730){
for(var i=0,len=_272f.length;i<len;i++){
var _2733=_2730[i];
_2733.style.top=getRowTop(_272f[i])+"px";
}
}
function shiftCellsHorizontally(_2734,_2735,shift,_2737){
if(isUndefined(_2737)){
_2737=sheetPaneId;
}
var cells=getCellsInCols(_2734,_2735,_2737);
var _2739=_2735-_2734+1;
if(_2739>0){
doShiftCellsHorizontally(cells,_2734,_2735,shift);
}
}
function doShiftCellsHorizontally(cells,_273b,_273c,shift){
for(var i=0,j=_273b,len=cells.length;i<len;i++){
if(shift.mode=="DIFF"){
var left=(getColLeft(j)+shift.val);
}else{
var left=shift.val;
}
cells[i].style.left=left+"px";
j=(j==_273c)?_273b:j+1;
}
}
function shiftCellsVertically(cells,tiles,diffY){
var top;
for(var i=0;i<cells.length;i++){
top=(getRowTop(i)+diffY)+"px";
cells[i].style.top=top;
}
for(var i=0;i<tiles.length;i++){
top=(getTileTop(tiles[i])+diffY)+"px";
tiles[i].style.top=top;
}
}
function getTileTop(tile){
return parseInt(tile.style.top);
}
function getTileIndex(row){
return ~~(getRowIndex(row)/ROWS_PER_TILE);
}
function getRowMax(){
return 65536;
}
function getColMax(){
return 256;
}
function isRowInViewPort(row){
if(isNumber(row)){
if(ISFREEZED&&row<FREEZED_ROW){
return true;
}else{
var _274a=getRowTop(row);
var _274b=getRowHeight(row);
return (_274a>=getSheetScrollTop()&&((_274a+_274b)<=(getSheetScrollTop()+getSheetHeight())));
}
}
return false;
}
function isColInViewPort(col){
if(isNumber(col)){
if(ISFREEZED&&col<FREEZED_COL){
return true;
}else{
var _274d=getColLeft(col);
var _274e=getColWidth(col);
return (_274d>=getSheetScrollLeft()&&((_274d+_274e)<=(getSheetScrollLeft()+getSheetWidth())));
}
}
return false;
}
function getCellTop(row){
return (getRowTop(row)-getRowTop(getFloorRow(row)));
}
function updateArrayFormulaJson(_2750){
var _2751=eval("("+_2750+")");
var sRow=_2751[0].row;
var sCol=_2751[0].column;
var eRow=sRow+_2751[0].arrayRowSpan-1;
var eCol=sCol+_2751[0].arrayColSpan-1;
updateArrayDetails("SUBMIT",sRow,sCol,eRow,eCol);
}
function fixArrayFormulaNotation(_2756,_2757,_2758,_2759){
var _275a=getArraysInRange(_2756,_2757,_2758,_2759,true);
for(var i=0;i<_275a.length;i++){
var obj=_275a[i];
var sRow=obj[0];
var eRow=obj[1];
var sCol=obj[2];
var eCol=obj[3];
var cell=getCell(sRow,sCol);
var _2762=getCellFormula(cell);
if(_2762&&_2762.indexOf("{")!=0){
var _2763="{"+_2762+"}";
for(var r=sRow;r<=eRow;r++){
for(var c=sCol;c<=eCol;c++){
cell=getCell(r,c);
cell.setAttribute("fn",_2763);
}
}
}
}
}
function isPartOfArray(_2766,_2767,_2768,_2769){
for(var i=0;i<arrayDetails.length;i++){
var obj=arrayDetails[i];
if(!isUndefined(obj)){
var sRow=obj[0];
var eRow=obj[1];
var sCol=obj[2];
var eCol=obj[3];
if((_2766>=sRow&&_2766<=eRow)||(_2768>=sRow&&_2768<=eRow)){
if((_2767>=sCol&&_2767<=eCol)||(_2769>=sCol&&_2769<=eCol)||(sCol>_2767&&eCol<_2769)){
if(_2767<=sCol&&_2769>=eCol&&_2766<=sRow&&_2768>=eRow){
continue;
}
return true;
}
}else{
if((_2767>=sCol&&_2767<=eCol)||(_2769>=sCol&&_2769<=eCol)){
if((_2766>=sRow&&_2766<=eRow)||(_2768>=sRow&&_2768<=eRow)||(sRow>_2766&&eRow<_2768)){
if(_2767<=sCol&&_2769>=eCol&&_2766<=sRow&&_2768>=eRow){
continue;
}
return true;
}
}
}
}
}
return false;
}
function clearOldArrayPosition(_2770,_2771,_2772,_2773){
for(var i=0;i<arrayDetails.length;i++){
var obj=arrayDetails[i];
if(!isUndefined(obj)){
var sRow=obj[0];
var eRow=obj[1];
var sCol=obj[2];
var eCol=obj[3];
if((_2770>=sRow&&_2770<=eRow)||(_2772>=sRow&&_2772<=eRow)){
if((_2771>=sCol&&_2771<=eCol)||(_2773>=sCol&&_2773<=eCol)||(sCol>_2771&&eCol<_2773)){
if(_2771<=sCol&&_2773>=eCol&&_2770<=sRow&&_2772>=eRow){
arrayDetails.splice(i,1);
i--;
}
}
}else{
if((_2771>=sCol&&_2771<=eCol)||(_2773>=sCol&&_2773<=eCol)){
if((_2770>=sRow&&_2770<=eRow)||(_2772>=sRow&&_2772<=eRow)||(sRow>_2770&&eRow<_2772)){
if(_2771<=sCol&&_2773>=eCol&&_2770<=sRow&&_2772>=eRow){
arrayDetails.splice(i,1);
i--;
}
}
}else{
if(_2770<=sRow&&_2772>=eRow&&_2771<=sCol&&_2773>=eCol){
arrayDetails.splice(i,1);
i--;
}
}
}
}
}
}
function containsAnyArray(_277a,_277b,_277c,_277d){
for(var i=0;i<arrayDetails.length;i++){
var obj=arrayDetails[i];
if(!isUndefined(obj)){
var sRow=obj[0];
var eRow=obj[1];
var sCol=obj[2];
var eCol=obj[3];
if((_277a>=sRow&&_277a<=eRow)||(_277c>=sRow&&_277c<=eRow)){
if((_277b>=sCol&&_277b<=eCol)||(_277d>=sCol&&_277d<=eCol)||(sCol>_277b&&eCol<_277d)){
if(_277b<=sCol&&_277d>=eCol&&_277a<=sRow&&_277c>=eRow){
return true;
}
}
}else{
if((_277b>=sCol&&_277b<=eCol)||(_277d>=sCol&&_277d<=eCol)){
if((_277a>=sRow&&_277a<=eRow)||(_277c>=sRow&&_277c<=eRow)||(sRow>_277a&&eRow<_277c)){
if(_277b<=sCol&&_277d>=eCol&&_277a<=sRow&&_277c>=eRow){
return true;
}
}
}else{
if(_277a<=sRow&&_277c>=eRow&&_277b<=sCol&&_277d>=eCol){
return true;
}
}
}
}
}
return false;
}
function getArray(row,col){
var obj=null;
for(var i=0;i<arrayDetails.length;i++){
obj=arrayDetails[i];
if(!isUndefined(obj)){
var sRow=obj[0];
var eRow=obj[1];
var sCol=obj[2];
var eCol=obj[3];
if((col==sCol||(col>sCol&&col<=eCol))&&(row==sRow||(row>sRow&&row<=eRow))){
return obj;
}
}
}
return obj;
}
function getArraysInRange(_278c,_278d,_278e,_278f,_2790){
var _2791=new Array();
for(var i=0;i<arrayDetails.length;i++){
var obj=arrayDetails[i];
if(!isUndefined(obj)){
var sRow=obj[0];
var eRow=obj[1];
var sCol=obj[2];
var eCol=obj[3];
if((_278c>=sRow&&_278c<=eRow)||(_278e>=sRow&&_278e<=eRow)){
if((_278d>=sCol&&_278d<=eCol)||(_278f>=sCol&&_278f<=eCol)||(sCol>_278d&&eCol<_278f)){
if(_278d<=sCol&&_278f>=eCol&&_278c<=sRow&&_278e>=eRow){
var arr=new Array();
arr[0]=sRow;
arr[1]=eRow;
arr[2]=sCol;
arr[3]=eCol;
_2791.push(arr);
}else{
if(_2790){
var arr=getPartArray(_278c,_278d,_278e,_278f,sRow,sCol,eRow,eCol);
_2791.push(arr);
}
}
}
}else{
if((_278d>=sCol&&_278d<=eCol)||(_278f>=sCol&&_278f<=eCol)){
if((_278c>=sRow&&_278c<=eRow)||(_278e>=sRow&&_278e<=eRow)||(sRow>_278c&&eRow<_278e)){
if(_278d<=sCol&&_278f>=eCol&&_278c<=sRow&&_278e>=eRow){
var arr=new Array();
arr[0]=sRow;
arr[1]=eRow;
arr[2]=sCol;
arr[3]=eCol;
_2791.push(arr);
}else{
if(_2790){
var arr=getPartArray(_278c,_278d,_278e,_278f,sRow,sCol,eRow,eCol);
_2791.push(arr);
}
}
}
}else{
if(_278c<=sRow&&_278e>=eRow&&_278d<=sCol&&_278f>=eCol){
var arr=new Array();
arr[0]=sRow;
arr[1]=eRow;
arr[2]=sCol;
arr[3]=eCol;
_2791.push(arr);
}
}
}
}
}
return _2791;
}
function getPartArray(_2799,_279a,_279b,_279c,sRow,sCol,eRow,eCol){
var arr=new Array();
if(isArrayCell(_2799,_279a)&&(_2799>sRow)&&(_279a>sCol)){
arr[0]=_2799;
arr[2]=_279a;
}else{
if(isArrayCell(_2799,sCol)&&(_2799>sRow)){
arr[0]=_2799;
arr[2]=sCol;
}else{
if(isArrayCell(sRow,_279a)&&(_279a>sCol)){
arr[0]=sRow;
arr[2]=_279a;
}else{
arr[0]=sRow;
arr[2]=sCol;
}
}
}
if(isArrayCell(_279b,_279c)&&(_279b<eRow)&&(_279c<eCol)){
arr[1]=_279b;
arr[3]=_279c;
}else{
if(isArrayCell(_279b,eCol)&&(_279b<eRow)){
arr[1]=_279b;
arr[3]=eCol;
}else{
if(isArrayCell(eRow,_279c)&&(_279c<eCol)){
arr[1]=eRow;
arr[3]=_279c;
}else{
arr[1]=eRow;
arr[3]=eCol;
}
}
}
return arr;
}
function isArrayCell(row,col){
for(var i=0;i<arrayDetails.length;i++){
var obj=arrayDetails[i];
if(!isUndefined(obj)){
var sRow=obj[0];
var eRow=obj[1];
var sCol=obj[2];
var eCol=obj[3];
if((col==sCol||(col>sCol&&col<=eCol))&&(row==sRow||(row>sRow&&row<=eRow))){
return true;
}
}
}
return false;
}
function updateArrayDetails(_27aa,arg1,arg2,arg3,arg4){
switch(_27aa){
case "SUBMIT":
var _27af=arg1;
var _27b0=arg2;
var _27b1=arg3;
var _27b2=arg4;
clearOldArrayPosition(_27af,_27b0,_27b1,_27b2);
var obj=new Array();
obj[0]=_27af;
obj[1]=_27b1;
obj[2]=_27b0;
obj[3]=_27b2;
arrayDetails.push(obj);
break;
case "INSERTROW":
var row=arg1;
var count=arg2;
for(var i=0;i<arrayDetails.length;i++){
var obj=arrayDetails[i];
var _27af=obj[0];
if(_27af>=row){
obj[0]=_27af+count;
obj[1]=obj[1]+count;
arrayDetails[i]=obj;
}
}
break;
case "DELETEROW":
var row=arg1;
var count=arg2;
for(var i=0;i<arrayDetails.length;i++){
var obj=arrayDetails[i];
var _27af=obj[0];
if(_27af>=row){
obj[0]=_27af-count;
obj[1]=obj[1]-count;
arrayDetails[i]=obj;
}
}
break;
case "INSERTCOL":
var col=arg1;
var count=arg2;
for(var i=0;i<arrayDetails.length;i++){
var obj=arrayDetails[i];
var _27b0=obj[2];
if(_27b0>=col){
obj[2]=_27b0+count;
obj[3]=obj[3]+count;
arrayDetails[i]=obj;
}
}
break;
case "DELETECOL":
var col=arg1;
var count=arg2;
for(var i=0;i<arrayDetails.length;i++){
var obj=arrayDetails[i];
var _27b0=obj[2];
if(_27b0>=col){
obj[2]=_27b0-count;
obj[3]=obj[3]-count;
arrayDetails[i]=obj;
}
}
break;
}
}
function isMergeExistsInRowRange(_27b8,_27b9){
for(var i=_27b8;i<=_27b9;i++){
if(isMergeExistsInRow(i)){
return true;
}
}
return false;
}
function isMergeExistsInRow(row){
var _27bc=getColMergeDetails();
var _27bd=_27bc[(row+"")];
return (!isUndefined(_27bd)&&_27bd!=-1)?true:false;
}
function getMergedDetailsInRowRange(_27be,_27bf){
var row=[];
for(var i=_27be,k=0;i<=_27bf;i++){
if(isMergeExistsInRow(i)){
var _27c3=getMergeDetailsInRow(i);
for(var j in _27c3){
var _27c5=parseInt(j);
if(_27c3[j]!=-1){
var cell={};
var _27c7=parseInt(_27c3[j]);
cell["row"]=i;
cell["col"]=_27c5;
cell["colMergeCount"]=_27c7;
row[k]=cell;
k++;
}
}
}
}
return row;
}
function getMergeDetailsInRow(row){
var _27c9=getColMergeDetails();
return _27c9[row+""];
}
function isCellMerged(row,col){
if(isMergeExistsInRow(row)){
var _27cc=getMergeDetailsInRow(row);
if(!isUndefined(_27cc)){
for(var j in _27cc){
var _27ce=parseInt(j);
if(_27cc[j]!=-1){
var _27cf=(parseInt(_27cc[j])-1);
if((_27ce==col)||(col>_27ce&&col<=(_27ce+_27cf))){
return true;
}
}
}
}
}
return false;
}
function isCoveredCell(row,col){
if(isMergeExistsInRow(row)){
var _27d2=getMergeDetailsInRow(row);
for(var j in _27d2){
var _27d4=parseInt(j);
if(_27d2[j]!=-1){
var _27d5=(parseInt(_27d2[j])-1);
if((col>_27d4&&col<=(_27d4+_27d5))){
return true;
}
}
}
}
return false;
}
function getColMergeDetails(){
return colMergeDetails;
}
function getMergedColRange(row,col){
var obj={};
var _27d9=getMergeDetailsInRow(row);
for(var j in _27d9){
var _27db=parseInt(j);
if(_27d9[j]!=-1){
var _27dc=(parseInt(_27d9[j])-1);
if((_27db==col)||(col>_27db&&col<=(_27db+_27dc))){
obj["startCol"]=_27db;
obj["endCol"]=_27db+_27dc;
}
}
}
return obj;
}
function isCellMergedInGivenRange(_27dd,_27de,col){
for(var i=_27dd;i<=_27de;i++){
if(isCellMerged(i,col)){
return true;
}
}
return false;
}
function getMergedEndCol(_27e1,_27e2,col){
var _27e4,_27e5=col;
for(var i=_27e1;i<=_27e2;i++){
if(isCellMerged(i,col)){
_27e4=getMergedColRange(i,col).endCol;
if(_27e5<_27e4){
_27e5=_27e4;
}
}
}
return _27e5;
}
function getMergedStartCol(_27e7,_27e8,col){
var _27ea,_27eb=col;
for(var i=_27e7;i<=_27e8;i++){
if(isCellMerged(i,col)){
_27ea=getMergedColRange(i,col).startCol;
if(_27eb>_27ea){
_27eb=_27ea;
}
}
}
return _27eb;
}
function shiftMergedCellsHorizontally(col,cnt,_27ef,_27f0){
var diff=0;
switch(_27f0){
case "INSERTCOL":
case "RESIZE":
diff=cnt*_27ef;
break;
case "DELETECOL":
var _27f2=-cnt;
var _27f3=0;
for(var i=col;i<col+_27f2;i++){
_27f3+=getColWidth(col);
}
diff=-_27f3;
break;
}
var det=getColMergeDetails();
for(var r in det){
var _27f7=det[r];
r=parseInt(r);
for(var c in _27f7){
if(_27f7[c]!=-1){
var _27f9=convertNumber(c);
var _27fa=convertNumber(_27f7[c]);
if(_27f9>=col){
var cell=getCell(r,_27f9);
if(cell){
cell.style.left=convertNumber(cell.style.left)+diff;
}
if(ISFREEZED){
if(FREEZED_ROW>0){
cell=getCell(r,_27f9,sheetPane2Id);
if(cell){
cell.style.left=parseInt(cell.style.left)+diff;
}
}
if(FREEZED_COL>0){
cell=getCell(r,_27f9,sheetPane3Id);
if(cell){
cell.style.left=parseInt(cell.style.left)+diff;
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
cell=getCell(r,_27f9,sheetPane1Id);
if(cell){
cell.style.left=parseInt(cell.style.left)+diff;
}
}
}
}else{
if((!(col>=_27f9+_27fa))&&_27f9<col&&col<=_27f9+_27fa){
if(_27f0!="RESIZE"){
if(cnt<=0){
var _27fc=_27f9+_27fa;
_27fc=(_27fc>(col+_27f2))?(col+_27f2):_27fc;
var _27f3=0;
for(var i=col;i<_27fc;i++){
_27f3+=getColWidth(i);
}
diff=-_27f3;
}
var cell=getCell(r,_27f9);
if(cell){
cell.style.width=convertNumber(cell.style.width)+diff;
setCellWidthForVAlignedCell(cell);
}
if(ISFREEZED){
if(FREEZED_ROW>0){
cell=getCell(r,_27f9,sheetPane2Id);
if(cell){
cell.style.width=convertNumber(cell.style.width)+diff;
setCellWidthForVAlignedCell(cell);
}
}
if(FREEZED_COL>0){
cell=getCell(r,_27f9,sheetPane3Id);
if(cell){
cell.style.width=convertNumber(cell.style.width)+diff;
setCellWidthForVAlignedCell(cell);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
cell=getCell(r,_27f9,sheetPane1Id);
if(cell){
cell.style.width=convertNumber(cell.style.width)+diff;
setCellWidthForVAlignedCell(cell);
}
}
}
}
}
}
}
}
}
}
function getFirstRowInRowHdr(){
return getAvailableStartRow();
}
function getLastRowInRowHdr(){
return getAvailableEndRow();
}
function getCells(_27fd,_27fe,_27ff,_2800,_2801){
if(typeof _2801=="undefined"){
_2801=sheetPaneId;
}
if(isNumber(_27fd)&&isNumber(_27ff)&&isNumber(_27fe)&&isNumber(_2800)){
var count=0;
var _2803=[];
for(var _2804=_27fd;_2804<=_27ff;_2804++){
for(var _2805=_27fe;_2805<=_2800;_2805++){
_2803[count]=getCell(_2804,_2805,_2801);
count++;
}
}
return {value:_2803,count:count};
}
}
function getCellDIM(row,col){
var _2808,_2809,_280a,_280b;
var info=Merge.getCellInfo(row,col);
if(info){
var _280d=info["startRow"];
var _280e=info["startCol"];
var _280f=info["endRow"];
var _2810=info["endCol"];
_2809=getRowTop(_280d);
_280b=getRowTop(_280f)+getRowHeight(_280f)-getRowTop(_280d);
_2808=getColLeft(_280e);
_280a=getColLeft(_2810)+getColWidth(_2810)-getColLeft(_280e);
}else{
_2809=getRowTop(row);
_280b=getRowHeight(row);
_2808=getColLeft(col);
_280a=getColWidth(col);
}
return {left:_2808,top:_2809,width:_280a,height:_280b};
}
function getCellInnerHTML(cell){
var cls=cell.className;
if(cls.indexOf("vab")!=-1||cls.indexOf("vam")!=-1){
if(!featureSupport.boxAlign){
return cell.childNodes[0].childNodes[0].innerHTML;
}else{
return cell.innerHTML;
}
}else{
return cell.innerHTML;
}
}
function setCellInnerHTML(cell,val){
var cls=cell.className;
if(cls.indexOf("vab")!=-1||cls.indexOf("vam")!=-1){
if(featureSupport.boxAlign){
cell.innerHTML=val;
return;
}
getChildNode(getChildNode(cell,0),0).innerHTML=val;
}else{
cell.innerHTML=val;
}
}
function setCellHeightForVAlignedCell(cell){
if(featureSupport.boxAlign){
return;
}
var cls=cell.className;
if(cls.indexOf(" vab")!=-1||cls.indexOf(" vam")!=-1){
var _2818=cell.style.height;
cell.childNodes[0].style.height=_2818;
cell.childNodes[1].style.height=_2818;
}
}
function setCellWidthForVAlignedCell(cell){
if(featureSupport.boxAlign){
return;
}
var cls=cell.className;
if(cls.indexOf(" vab")!=-1||cls.indexOf(" vam")!=-1){
cell.childNodes[0].style.width=cell.style.width;
}
}
function alignCellVertically(_281b,_281c,_281d){
if(featureSupport.boxAlign){
_281b.innerHTML=_281d;
return;
}
switch(_281c){
case " vab":
case " vam":
var _281e=_281b.style.height;
var width=_281b.style.width;
var _2820="";
_2820=" style = height:"+_281e+";width:"+width;
var value="<div class='"+_281c+"-od'"+_2820+"><div class='"+_281c+"-id'>"+_281d+"</div></div><i class='i'></i></div>";
_281b.innerHTML=value;
break;
default:
_281b.innerHTML=_281d;
break;
}
}
function getRowPosInMouseEvent(ev){
var _2823=getCursorPos(ev);
var y=_2823.y-sheetTop;
if(y>=findThirdPaneYPos()){
y+=getSheetScrollTop();
}
return findRowInYPos(y);
}
function getColPosInMouseEvent(ev){
var _2826=getCursorPos(ev);
var x=_2826.x-sheetLeft;
if(x>=findSecondPaneXPos()){
x+=getSheetScrollLeft();
}
return findColInXPos(x);
}
function loadXTileIfVacantInViewPort(){
if(isBlankAreaInViewPort()){
if(isBlankAreaInBelowViewPort()){
currScrollTop=getSheetScrollTop()-1;
}else{
if(isBlankAreaInAboveViewPort()){
currScrollTop=getSheetScrollTop()+1;
}else{
if(isBlankAreaInBottomOfViewPort()){
currScrollTop=getSheetScrollTop()-1;
}else{
currScrollTop=getSheetScrollTop()+1;
}
}
}
if(isVScrollFaceClicked){
showRowNoInfo();
}
loadXTiles(getSheetScrollTop());
}
}
function removeXTileIfExcessThanViewPort(_2828){
var _2829=getRowRangeToRemove(_2828);
firstRToRemove=_2829.firstRow;
lastRToRemove=_2829.endRow;
if((lastRToRemove-firstRToRemove)>0){
removeXTiles(firstRToRemove,lastRToRemove,_2828);
}
}
function findCellOffsetX(cell){
var pos=getCellPos(cell);
return getColHead(pos.col).offsetLeft;
}
function findCellOffsetY(cell){
var pos=getCellPos(cell);
return getColHead(pos.col).offsetTop;
}
function findCellOffsetXY(cell){
var pos=getCellPos(cell);
return {x:getColHead(pos.col).offsetTop,y:getRowHead(pos.row).offsetTop};
}
function isFocusDIV(){
var _2830=arguments[0];
if(isUndefined(_2830)){
return false;
}
if(isStr(_2830)){
return (_2830=="fD"||_2830=="fD1"||_2830=="fD2"||_2830=="fD3");
}else{
if(isElement(_2830)){
return (_2830==focusDIV||_2830==focusDIV1||_2830==focusDIV2||_2830==focusDIV3);
}else{
return false;
}
}
}
function isSheetTable(){
var _2831=arguments[0];
if(!_2831){
return false;
}
if(isStr(_2831)){
return (_2831=="sT"||_2831=="sT1"||_2831=="sT2"||_2831=="sT3");
}else{
if(isElement(_2831)){
return (_2831==sheetTable||_2831==sheetTable1||_2831==sheetTable2||_2831==sheetTable3);
}else{
return false;
}
}
}
function isTransSPAN(){
var _2832=arguments[0];
if(isUndefined(_2832)){
return false;
}
if(isStr(_2832)){
return (_2832=="tS"||_2832=="tS1"||_2832=="tS2"||_2832=="tS3");
}else{
if(isElement(_2832)){
return (_2832==transSPAN||_2832==transSPAN1||_2832==transSPAN2||_2832==transSPAN3);
}else{
return false;
}
}
}
function isCellRangeFlashInnerDIV(){
var _2833=arguments[0];
if(isUndefined(_2833)){
return false;
}
if(isStr(_2833)){
return (_2833=="fCRID"||_2833=="fCRID1"||_2833=="fCRID2"||_2833=="fCRID3");
}else{
if(isElement(_2833)){
return (_2833==cellRangeFillSPAN||_2833==cellRangeFillSPAN1||_2833==cellRangeFillSPAN2||_2833==cellRangeFillSPAN3);
}else{
return false;
}
}
}
function getActivePane(){
return getSheetPane(currRow,currCol);
}
function getScrollResponseSeperator(){
return "<!--~*@#-->";
}
function getTileSeperator(){
return "<!---tileSep--->";
}
function isRowInAvailableRowRange(row){
return (row>=getAvailableStartRow()&&row<=getAvailableEndRow());
}
function isRowAvailable(row){
return (getRowIndex(row)>=0);
}
function isRowAvailable(row,_2837){
if(isNumber(row)&&row<totRows&&!Row.isHidden(row)){
if(!_2837){
_2837=1;
}
var _2838=row;
var _2839=row+_2837-1;
var _283a=getAvailableStartRow();
var _283b=getAvailableEndRow();
return !(_2838>_283b||_2839<_283a);
}
return false;
}
function activateCellField(){
var _283c=document.activeElement;
if(_283c&&isSSActive){
var _283d=dialogEl;
if(!isEditorClosed&&(!_283d||_283d&&_283d.style.display=="none")){
if(isNotEditorElement(_283c)){
if(!isCellFieldSPANHided()&&cellField.value.indexOf("=")==0){
var pos=formulaEIdxTemp;
if(pos==0){
pos=cellField.value.length;
}
setCaretPos(cellField,pos);
}else{
setFocusInCellField();
}
}
}
}
}
function isNotEditorElement(el){
var _2840=el.tagName;
if(_2840=="INPUT"){
var _2841=el.type;
}
return (_2840!="SELECT")&&(_2840!="TEXTAREA")&&!(_2840=="INPUT"&&_2841=="text");
}
function getCellValue(cell){
return cell.getAttribute("cV");
}
function isCellLabel(_2843){
var _2844=_2843.length;
if(_2844>=2&&isNaN(_2843.charAt(0))){
if(_2844==2&&!isNaN(_2843.charAt(1))&&parseInt(_2843.charAt(1))>0){
return true;
}
if(isNaN(_2843.charAt(1))){
if(!isNaN(_2843.substring(2,_2844))){
var _2845=_2843.toUpperCase().charCodeAt(0);
var rowNo=parseInt(_2843.substring(2,_2844));
if(rowNo<=getRowMax()&&rowNo>0&&_2845<=73){
if(_2845==73&&_2843.toUpperCase().charCodeAt(1)>86){
return false;
}
return true;
}
}
}else{
if(!isNaN(_2843.substring(1,_2844))){
var rowNo=parseInt(_2843.substring(1,_2844));
if(rowNo<=getRowMax()&&rowNo>0){
return true;
}
}
}
}
return false;
}
function getSheetPane(row,col){
var pane=4;
if(ISFREEZED){
pane=1;
if(row>=FREEZED_ROW){
pane+=2;
}
if(col>=FREEZED_COL){
pane+=1;
}
}
return pane;
}
function getSheetPaneId(pane){
var id="sP";
if(pane!=4){
id+=pane;
}
return id;
}
function getSheetPaneElement(row,col){
return getObj(getSheetPaneId(getSheetPane(row,col)));
}
function getViewPortRoundedDetails(_284e,_284f){
var _2850=_284e;
var _2851=false;
var _2852=(FREEZED_ROW>0&&_284e<=FREEZED_ROW-1);
var _2853;
if(_2852){
_2853=(FREEZED_ROW-1>=_284f)?_284f:FREEZED_ROW-1;
}
if(_284f>=getAvailableStartRow()&&_284e<=getAvailableEndRow()){
_284f=(_284f>getAvailableEndRow())?getAvailableEndRow():_284f;
_284e=(_284e<getAvailableStartRow())?getAvailableStartRow():_284e;
_284e=(_284e<FREEZED_ROW&&_284f>=FREEZED_ROW)?FREEZED_ROW:_284e;
_2851=true;
}
return {isInViewPort:_2851,isInFreezedRange:_2852,startRowIdx:_284e,endRowIdx:_284f,freezedStartRowIdx:_2850,freezedEndRowIdx:_2853};
}
function setFocusInCellField(){
if(jsEMBED_VIEW&&updateTileCallbackInfo.actionDetails){
return;
}
if(cellField){
try{
cellField.focus();
}
catch(e){
}
}
}
function reloadXTiles(){
var _2854=getFloorRow(getAvailableStartRow());
var _2855=getCeilRow(getAvailableEndRow());
removeXTiles(_2854,_2855,"END_OF_PAGE");
loadXTileIfVacantInViewPort();
}
function getCellMarkUp(){
var obj=document.createElement("DIV");
obj.className="cD nW";
return obj;
}
function concat(_2857,_2858){
if(browser_ie){
_2857.push(_2858);
}else{
_2857+=_2858;
}
return _2857;
}
function findSheetObjectOptimalPos(width,_285a){
var left=Math.round(((sheet.offsetWidth-width)/2)+getSheetScrollLeft());
var top=Math.round(((sheet.offsetHeight-_285a)/2)+getSheetScrollTop());
if(left<0){
left=0;
}
if(top<0){
top=0;
}
return {left:left,top:top};
}
function changeFormulaCellValue(_285d){
editedFormulaCellInfo.cellFieldDetails.appendSheetName=false;
var _285e=_285d.lastIndexOf("(");
if(isFuncDlgOpen&&_285e!=-1){
var ret;
var _2860=_285d.substring(0,_285e+2);
if(_2860.lastIndexOf(")")==_2860.length-1){
var _2861=(_285d.substring(_285e+1));
ret=(_2860.substring(0,_2860.length-1)+CURRSHEETNAME+"!"+_285d.substring(_285e+1));
formulaSIdxTemp=formulaEIdxTemp=ret.length;
editedFormulaCellInfo.cellFieldDetails.tempPosReduce=true;
editedFormulaCellInfo.cellFieldDetails.tempPos=_2861.length;
return ret;
}else{
editedFormulaCellInfo.cellFieldDetails.appendSheetName=true;
return _285d;
}
}
if(formulaEIdxTemp&&formulaEIdxTemp!=_285d.length){
var _2862=_285d.lastIndexOf("!");
var _2863=_285d.lastIndexOf(editedFormulaCellInfo.cellFieldDetails.PREV_SHEET);
var _2864=(editedFormulaCellInfo.cellFieldDetails.PREV_SHEET).length;
if(_2862==(_2863+_2864)){
var str=_285d.substring(0,_2863);
var str1=_285d.substring(_2862+1);
var ret=(str+CURRSHEETNAME+"!"+str1);
if(CURRSHEETNAME.length!=_2864){
formulaSIdxTemp+=CURRSHEETNAME.length-_2864;
formulaEIdxTemp=(ret).length;
}
var lbl=str1.split(":");
var rc=getCellPosByLabel(lbl[0]);
if(lbl.length>1){
var rc1=getCellPosByLabel(lbl[1]);
}else{
var rc1=rw;
}
focusCellRangeFill(rc.row,rc.col,rc1.row,rc1.col,false);
return ret;
}else{
var str=_285d.substring(0,formulaEIdxTemp);
var str1=_285d.substring(formulaEIdxTemp+1);
var ret=(str+CURRSHEETNAME+"!"+str1);
formulaEIdxTemp=formulaSIdxTemp=ret.length;
var lbl=str1.split(":");
var rc=getCellPosByLabel(lbl[0]);
if(lbl.length>1){
var rc1=getCellPosByLabel(lbl[1]);
}else{
var rc1=rc;
}
focusCellRangeFill(rc.row,rc.col,rc1.row,rc1.col,false);
return ret;
}
}else{
if(_285d.indexOf("!")==-1){
var temp=formulaSIdxTemp;
if(!formulaSIdxTemp){
temp=_285d.length;
}
var str=_285d.substring(0,temp);
var ret=(str+CURRSHEETNAME+"!");
formulaEIdxTemp=formulaSIdxTemp=ret.length;
return ret;
}else{
var _2862=_285d.lastIndexOf("!");
var _2863=_285d.lastIndexOf(editedFormulaCellInfo.cellFieldDetails.PREV_SHEET);
var _2864=(editedFormulaCellInfo.cellFieldDetails.PREV_SHEET).length;
if(!formulaSIdxTemp){
var ret=(_285d+CURRSHEETNAME+"!");
formulaEIdxTemp=formulaSIdxTemp=ret.length;
return ret;
}else{
if(_2862==(_2863+_2864)){
var str=_285d.substring(0,_2863);
var str1=_285d.substring(_2862+1);
var ret=(str+CURRSHEETNAME+"!"+str1);
if(CURRSHEETNAME.length!=_2864){
formulaSIdxTemp+=CURRSHEETNAME.length-_2864;
formulaEIdxTemp=(ret).length;
}
var lbl=str1.split(":");
var rc=getCellPosByLabel(lbl[0]);
if(lbl.length>1){
var rc1=getCellPosByLabel(lbl[1]);
}else{
var rc1=rc;
}
focusCellRangeFill(rc.row,rc.col,rc1.row,rc1.col,false);
return ret;
}
}
}
}
}
function saveEveCheck(ev){
var _286c=ev.keyCode;
if(_286c==83&&ev.ctrlKey){
if(browser_firefox){
setTimeout(function(){
parent.savefile();
},0);
}else{
if(parent){
parent.savefile();
}
}
return false;
}
}
function replaceDisallowedCharsInDocName(_286d){
var _286e=new RegExp("['\"<>#?/%\\\\]","g");
return _286d.replace(_286e,"-");
}
function showAlertDialog(msg){
if(msg.length!=0){
alert(msg);
}
lastTime=(new Date()).getTime();
return;
}
function showConfirmDialog(msg){
var _2871=confirm(msg);
lastTime=(new Date()).getTime();
return _2871;
}
function showPromptDialog(msg,_2873){
_2873=(!_2873)?"":_2873;
var _2874=prompt(msg,_2873);
lastTime=(new Date()).getTime();
return _2874;
}
function findScrollTopToPositionRowInView(row){
var _2876=getSheetPaneHeight();
var _2877=getRowTop(row)-(_2876>>1);
var _2878=getRowTop(findRowInYPos(x)+1);
return _2877;
}
function predictViewPortRowRange(){
var _2879=getRowRangeForPageInView("UNLOADED_PAGE",getSheetScrollTop());
var _287a=getFloorRow(_2879.firstRow);
var _287b=getCeilRow(_2879.lastRow);
return {"startRow":_287a,"endRow":_287b};
}
function getCellFunctionValueWOF(obj){
var val=obj.getAttribute("fn");
var _287e=obj.getAttribute("cV");
if(val!=undefined&&val.indexOf("=")==0){
val=_287e;
}
if(val==undefined){
val=_287e;
}
val=encodeURIComponent(val).trim().toUpperCase();
if(val.indexOf("%24")==0){
val=val.replace("%24","");
}
if(val.indexOf("%E2%82%AC")!=-1){
val=val.replace("%E2%82%AC","");
}
if(val.indexOf("%C2%A3")==0){
val=val.replace("%C2%A3","");
}
if(val.indexOf("RS.")==0){
val=val.replace("RS.","");
}
if(val.indexOf("%EF%BF%A5")==0){
val=val.replace("%EF%BF%A5","");
}
if(val.indexOf("%25")!=-1){
val=val.replace("%25","");
}
if(val.indexOf("%2C")!=-1){
val=val.replace(/%2C/g,"");
}
val=decodeURIComponent(val).trim();
return val;
}
function focusCellField(val,ev){
var _2881=Row.isHidden(currRow);
if(ev&&isObject(ev)){
var el=(browser_ie)?ev.srcElement:ev.target;
if(!isCell(el)&&!isFocusDIV(el)){
return;
}
}
if(!isServerComponentLoaded(true)){
return false;
}
if(!_2881&&!currCell){
return;
}
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
scrollCellIntoView(row,col);
cellField.style.zIndex=3;
if(!READ_WRITE){
return;
}
currCellWidth=info.getWidth();
cellField.setAttribute("wrap","on");
initMaxStylePropertyForSheet();
initCellFieldStyles();
val=(typeof val=="undefined")?"":replace(val,"<br>","\n");
if(isArrayCell(currRow,currCol)){
if(val!=null&&val!="null"){
if(val.charAt(0)=="{"){
val=val.substring(1,val.length-1);
}
}
}
exprField.value=val;
cellField.value=val;
setDummySpanStyles();
initCellContentDetails();
if(!isCellWrapped(currCell)){
if(isCellFieldInEditMode()||(isCellFieldInNewMode()&&(typeof ev!="undefined"))){
setCellFieldWidth("EDITMODE");
setCellFieldHeight("EDITMODE","CELLFIELD");
}
}else{
dummyTextArea.value=val;
setDummyTextAreaStyles();
isTextWrapped=true;
}
if(!browser_safari&&!browser_opera){
cellField.focus();
}
editMode_disableButtons();
if(browser_safari||!browser_ie||browser_opera){
setCaretPos(cellField,val.length);
}else{
if(browser_ie){
var _2886=getCountOfOccrnceOfCharInStr(val,"\n");
setCaretPos(cellField,(val.length+_2886));
}
}
isCellFieldSPANHided.isHided=false;
if(SAVED&&ALLOW_TO_WRITE){
$("#save").enable();
}
}
function cellFieldKeyDown(ev){
var _2888=(browser_ie)?window.event.keyCode:ev.which;
if(_2888==40||_2888==38||_2888==13||_2888==33||_2888==34||_2888==9){
if(isFMenuOpened){
initialiseFormulaAutoComplete.isMenuOpen=true;
return false;
}
}
if(isCellFieldSPANHided()){
if(_2888==229||browser_firefox&&((os_windows&&_2888==0)||os_mac&&!ev.altKey&&!ev.shiftKey&&!ev.ctrlKey&&!ev.metaKey&&(_2888>=65&&_2888<=90||_2888>=95&&_2888<=123))){
focusCellField();
return true;
}
return cellKeyDown(ev);
}
var id=cellField.id;
if(ev.altKey&&_2888==38){
disableAutoComplete(id);
return;
}
var _288a=$("#"+id);
if(_2888==113){
_288a.autocomplete("close");
}
var _288b=ev.shiftKey;
if((_288b&&_2888==48)||(_288b&&_2888==57)||(_288b&&_2888==222)||_2888==8||_2888==46){
if((_288b&&_2888==48)||(_288b&&_2888==57)){
_288a.autocomplete("close");
}
var _288c=(cellField.value).substr(0,getCaretPos(cellField));
var _288d=isTextSelected(cellField);
formulaSyntaxTip.showTip(_288c,_288a,_2888,_288d,_288b);
}
if((_2888==13||_2888==9||_2888==27)&&(!ev.altKey&&!ev.ctrlKey)){
formulaSyntaxTip.hideMe();
}
if((ev.altKey&&browser_ie&&_2888==13)||(os_mac&&browser_nn6&&ev.ctrlKey&&_2888==77)||(ev.altKey&&browser_safari&&_2888==13)){
posOfCaret=getCaretPos(cellField);
startPosOfSelection=posOfCaret;
endPosOfSelection=getSelectionEnd(cellField);
Event.stop(ev);
stopEvt(ev);
addLineBreak("CELLFIELD");
if($formulaSyntaxDiv){
if(formulaSyntaxTip.isVisible()){
var _288e=$formulaSyntaxDiv.data("formulaData");
var _288f=_288e["indx"];
formulaSyntaxTip.setLeftAndTop(_288f,_288a);
}
}
return;
}
var _2890=[37,38,39,40,16,17,18,19,20,33,34,35,36,44,45,93];
if(_2890.indexOf(_2888)==-1){
clearCellRangeFill();
}
if(_2888==27){
if(editedFormulaCellInfo.isOtherSheet){
var _2891=editedFormulaCellInfo.cellFieldDetails.ACTUAL_FORMULA_SHEET;
var _2892=true;
var _2893=editedFormulaCellInfo.cellFieldDetails.ROW;
var _2894=editedFormulaCellInfo.cellFieldDetails.COLUMN;
cellField.value="";
doGoto(_2891,_2893,_2893,_2894,_2894);
clearCellRangeFill();
editedFormulaCellInfo={"isOtherSheet":false,"cellFieldDetails":{}};
}
if(currCell!=null){
constructURL(currCell,currCellValue);
currCell.setAttribute("cV",currCellValue);
if(currCellFormula!=""){
if(currCellValue!=currCellFormula){
currCell.setAttribute("fn",currCellFormula);
}
}
exprField.value=getCellContent();
}else{
var _2895=getHiddenCellFormula(currRow,currCol);
exprField.value=_2895;
}
resetGlobalVariables();
focusCell(currRow,currCol);
exprField.value=getCellContent();
return false;
}else{
if(_2888==83){
if((ev.ctrlKey||ev.metaKey)&&!ev.altKey){
if(isEdit){
saveDocument();
}else{
if(jsREMOTE_SAVE_VIEW){
saveremoteGEdoc();
}else{
var _2896=getObj("isDocTemplate").value;
if(_2896=="true"||TEMPLATE_FLAG=="true"){
savefile("template");
}else{
savefile();
}
}
}
return false;
}
}else{
if(_2888==59||_2888==186){
if(ev.shiftKey&&ev.ctrlKey){
insertDateOrTime("time");
}else{
if(ev.ctrlKey){
insertDateOrTime("date");
}
}
}else{
if(_2888==9||_2888==13&&!ev.altKey&&!ev.ctrlKey||_2888==33||_2888==34||((_2888>=37&&_2888<=40)&&(isCellFieldInNewMode()&&!isMultilineInCellField()||formulaCell))){
if(_2888==37||_2888==38||_2888==39||_2888==40){
rangeSelection();
}
if(formulaCell){
if(_2888!=9&&_2888!=13&&_2888!=37&&_2888!=38&&_2888!=39&&_2888!=40&&(parseInt(cellField.style.width)>getColWidth(currCol)||isF2KeyPressed||isDblClicked)){
return;
}
}else{
if(_2888!=9&&_2888!=13&&_2888!=38&&_2888!=40&&(isF2KeyPressed||isDblClicked)){
return;
}
}
if(formulaCell&&(isF2KeyPressed||isDblClicked)&&(_2888==37||_2888==38||_2888==39||_2888==40)){
return;
}
if((!isArrayCell(currRow,currCol))&&(!formulaCell||(_2888!=37&&_2888!=38&&_2888!=39&&_2888!=40))){
if(editedFormulaCellInfo.isOtherSheet){
var _2891=editedFormulaCellInfo.cellFieldDetails.ACTUAL_FORMULA_SHEET;
submitCell();
var fRow=editedFormulaCellInfo.cellFieldDetails.ROW;
var fCol=editedFormulaCellInfo.cellFieldDetails.COLUMN;
doGoto(_2891,fRow,fRow,fCol,fCol);
return false;
}else{
submitCell();
}
}
switch(_2888){
case 33:
if(currRow-10<0){
focusCell(0,currCol);
}else{
focusCell(currRow-10,currCol);
}
return false;
case 34:
if(currRow+10>10){
focusCell(10,currCol);
}else{
focusCell(currRow+10,currCol);
}
return false;
case 37:
if(formulaCell&&ev.shiftKey){
var _2899=cellRangeStartCol;
var _289a=cellRangeEndCol;
var _289b=cellRangeStartRow;
var _289c=cellRangeEndRow;
var info=ActiveFormulaInfo;
var _289e=info.getActiveCol();
var _289f=false;
var _28a0=false;
if(_28a0){
return;
}else{
if(_289f){
if(_2899==_289e){
if(_289a<=0){
return;
}
focusCol(_2899,_289a-1);
}else{
if(_289a==_289e){
if(_2899<=0){
return;
}
focusCol(_289a,_2899-1);
}else{
var _28a1=new Range(_289b,_289e,_289c,_289e);
Merge.extendRange(_28a1);
var _28a2=_28a1.startCol;
var endC=_28a1.endCol;
if(_28a2==_2899){
if(_289a<=0){
return;
}
focusCol(_2899,_289a-1);
}else{
if(endC==_289a){
if(_2899<=0){
return;
}
focusCol(_289a,_2899-1);
}
}
}
}
}else{
if(_2899==_289e){
var range=new Range(_289b,_289a,_289c,_289a);
Merge.extendRange(range);
if(range.startCol<=0){
return;
}
_289a=range.startCol-1;
focusCellRange(_289b,_2899,_289c,_289a);
}else{
if(_289a==_289e){
if(_2899<=0){
return;
}
_2899=_2899-1;
focusCellRange(_289b,_289a,_289c,_2899);
}else{
var _28a1=new Range(_289b,_289e,_289c,_289e);
Merge.extendRange(_28a1);
var _28a2=_28a1.startCol;
var endC=_28a1.endCol;
if(_28a2==_2899){
var range=new Range(_289b,_289a,_289c,_289a);
Merge.extendRange(range);
if(range.startCol<=0){
return;
}
_289a=range.startCol-1;
focusCellRange(_289b,_2899,_289c,_289a);
}else{
if(endC==_289a){
if(_2899<=0){
return;
}
_2899=_2899-1;
focusCellRange(_289b,_289a,_289c,_2899);
}else{
if(_289a<=0){
return;
}
_289a-=1;
focusCellRange(_289b,_2899,_289c,_289a);
}
}
}
}
}
}
}else{
if(formulaCell){
var info=ActiveFormulaInfo;
var row=info.getActiveRow();
var col=info.getStartCol()-1;
if(col>=0){
ActiveFormulaInfo.set(row,col);
focusCellRangeFill(row,col,row,col);
}
}else{
var info=ActiveCellInfo;
var _28a7=info.getStartCol()-1;
focusCell(currRow,_28a7);
}
}
return false;
case 38:
if(formulaCell&&ev.shiftKey){
var _2899=cellRangeStartCol;
var _289a=cellRangeEndCol;
var _289b=cellRangeStartRow;
var _289c=cellRangeEndRow;
var info=ActiveFormulaInfo;
var _28a8=info.getActiveRow();
var _289f=false;
var _28a0=false;
if(_289f){
return;
}else{
if(_28a0){
if(_289b==_28a8){
if(_289c<=0){
return;
}
focusRow(_289b,Row.findNextNonHiddenRow(_289c,false));
}else{
if(_289c==_28a8){
if(_289b<=0){
return;
}
focusRow(_289c,Row.findNextNonHiddenRow(_289b,false));
}else{
var _28a9=new Range(_28a8,_2899,_28a8,_289a);
Merge.extendRange(_28a9);
var _28aa=_28a9.startRow;
var endR=_28a9.endRow;
if(_28aa==_289b){
if(_289c<=0){
return;
}
focusRow(_289b,_289c-1);
}else{
if(endR==_289c){
if(_289b<=0){
return;
}
focusRow(_289c,Row.findNextNonHiddenRow(_289b,false));
}
}
}
}
}else{
if(_289b==_28a8){
var range=new Range(_289c,_2899,_289c,_289a);
Merge.extendRange(range);
if(range.startRow<=0){
return;
}
_289c=Row.findNextNonHiddenRow(range.startRow,false);
focusCellRange(_289b,_2899,_289c,_289a);
}else{
if(_289c==_28a8){
if(_289b<=0){
return;
}
_289b=Row.findNextNonHiddenRow(_289b,false);
focusCellRange(_289c,_2899,_289b,_289a);
}else{
var _28a9=new Range(_28a8,_2899,_28a8,_289a);
Merge.extendRange(_28a9);
var _28aa=_28a9.startRow;
var endR=_28a9.endRow;
if(_28aa==_289b){
var range=new Range(_289c,_2899,_289c,_289a);
Merge.extendRange(range);
if(range.startRow<=0){
return;
}
_289c=Row.findNextNonHiddenRow(range.startRow,false);
focusCellRange(_289b,_2899,_289c,_289a);
}else{
if(endR==_289c){
if(_289b<=0){
return;
}
_289b=Row.findNextNonHiddenRow(_289b,false);
focusCellRange(_289c,_2899,_289b,_289a);
}else{
if(_289c<=0){
return;
}
_289c=Row.findNextNonHiddenRow(_289c,false);
focusCellRange(_289b,_2899,_289c,_289a);
}
}
}
}
}
}
}else{
if(formulaCell){
var info=ActiveFormulaInfo;
var col=info.getActiveCol();
var row=Row.findNextNonHiddenRow(info.getStartRow(),false);
if(row>=0){
ActiveFormulaInfo.set(row,col);
focusCellRangeFill(row,col,row,col);
}
}else{
var info=ActiveCellInfo;
var _28ac=Row.findNextNonHiddenRow(info.getStartRow(),false);
focusCell(_28ac,currCol);
}
}
return false;
case 9:
case 39:
if(formulaCell&&ev.shiftKey){
var _2899=cellRangeStartCol;
var _289a=cellRangeEndCol;
var _289b=cellRangeStartRow;
var _289c=cellRangeEndRow;
var info=ActiveFormulaInfo;
var _289e=info.getActiveCol();
var _289f=false;
var _28a0=false;
if(_28a0){
return;
}else{
if(_289f){
if(_2899==_289e){
focusCol(_2899,_289a+1);
}else{
if(_289a==_289e){
focusCol(_289a,_2899+1);
}else{
var _28a1=new Range(_289b,_289e,_289c,_289e);
Merge.extendRange(_28a1);
var _28a2=_28a1.startCol;
var endC=_28a1.endCol;
if(_28a2==_2899){
focusCol(_2899,_289a+1);
}else{
if(endC==_289a){
focusCol(_289a,_2899+1);
}
}
}
}
}else{
if(_2899==_289e){
_289a=_289a+1;
focusCellRange(_289b,_2899,_289c,_289a);
}else{
if(_289a==_289e){
var range=new Range(_289b,_2899,_289c,_2899);
Merge.extendRange(range);
_2899=range.endCol+1;
focusCellRange(_289b,_289a,_289c,_2899);
}else{
var _28a1=new Range(_289b,_289e,_289c,_289e);
Merge.extendRange(_28a1);
var _28a2=_28a1.startCol;
var endC=_28a1.endCol;
if(_28a2==_2899){
_289a=_289a+1;
focusCellRange(_289b,_2899,_289c,_289a);
}else{
if(endC==_289a){
var range=new Range(_289b,_2899,_289c,_2899);
Merge.extendRange(range);
_2899=range.endCol+1;
focusCellRange(_289b,_289a,_289c,_2899);
}else{
_2899+=1;
focusCellRange(_289b,_289a,_289c,_2899);
}
}
}
}
}
}
}else{
if(formulaCell){
var info=ActiveFormulaInfo;
var row=info.getActiveRow();
var col=info.getEndCol()+1;
if(col<totCols){
ActiveFormulaInfo.set(row,col);
focusCellRangeFill(row,col,row,col);
}
}else{
if(ev.shiftKey){
var info=ActiveCellInfo;
var _28a7=info.getStartCol()-1;
focusCell(currRow,_28a7);
}else{
var info=ActiveCellInfo;
var _28ad=info.getEndCol()+1;
focusCell(currRow,_28ad);
}
}
}
return false;
case 13:
if(isArrayCell(currRow,currCol)&&!isPartOfArray(currRow,currCol,currRow,currCol)){
submitCell(false);
var info=ActiveCellInfo;
var _28ae=Row.findNextNonHiddenRow(info.getEndRow());
focusCell(_28ae,currCol);
return false;
}
if(ev.shiftKey&&!ev.ctrlKey&&!ev.altKey){
var info=ActiveCellInfo;
var row=info.getStartRow();
focusCell(Row.findNextNonHiddenRow(row,false),currCol);
return false;
}
case 40:
if(ev.altKey&&_2888!=13){
pickFromList();
return false;
}
if(formulaCell&&ev.shiftKey){
var _2899=cellRangeStartCol;
var _289a=cellRangeEndCol;
var _289b=cellRangeStartRow;
var _289c=cellRangeEndRow;
var info=ActiveFormulaInfo;
var _28a8=info.getActiveRow();
var _289f=false;
var _28a0=false;
if(_289f){
return;
}else{
if(_28a0){
if(_289b==_28a8){
focusRow(_289b,Row.findNextNonHiddenRow(_289c));
}else{
if(_289c==_28a8){
focusRow(_289c,Row.findNextNonHiddenRow(_289b));
}else{
var _28a9=new Range(_28a8,_2899,_28a8,_289a);
Merge.extendRange(_28a9);
var _28aa=_28a9.startRow;
var endR=_28a9.endRow;
if(_28aa==_289b){
focusCol(_289b,Row.findNextNonHiddenRow(_289c));
}else{
if(endR==_289c){
focusCol(_289c,Row.findNextNonHiddenRow(_289b));
}
}
}
}
}else{
if(_289b==_28a8){
_289c=Row.findNextNonHiddenRow(_289c);
focusCellRange(_289b,_2899,_289c,_289a);
}else{
if(_289c==_28a8){
var range=new Range(_289b,_2899,_289b,_289a);
Merge.extendRange(range);
_289b=Row.findNextNonHiddenRow(range.endRow);
focusCellRange(_289c,_2899,_289b,_289a);
}else{
var _28a9=new Range(_28a8,_2899,_28a8,_289a);
Merge.extendRange(_28a9);
var _28aa=_28a9.startRow;
var endR=_28a9.endRow;
if(_28aa==_289b){
_289c=Row.findNextNonHiddenRow(_289c);
focusCellRange(_289b,_2899,_289c,_289a);
}else{
if(endR==_289c){
var range=new Range(_289b,_2899,_289b,_289a);
Merge.extendRange(range);
_289b=Row.findNextNonHiddenRow(range.endRow);
focusCellRange(_289c,_2899,_289b,_289a);
}else{
_289b=Row.findNextNonHiddenRow(_289b);
focusCellRange(_289c,_2899,_289b,_289a);
}
}
}
}
}
}
if(cellRangeEndRow>=totRows){
appendBlankRows();
}
focusCellRangeFill(cellRangeStartRow,cellRangeStartCol,cellRangeEndRow,cellRangeEndCol);
}else{
if(formulaCell){
var info=ActiveFormulaInfo;
var col=info.getActiveCol();
var row=Row.findNextNonHiddenRow(info.getEndRow());
if(row<totRows){
ActiveFormulaInfo.set(row,col);
focusCellRangeFill(row,col,row,col);
}
}else{
var info=ActiveCellInfo;
var _28ae=Row.findNextNonHiddenRow(info.getEndRow());
focusCell(_28ae,currCol);
}
}
return false;
}
}else{
if(ev.ctrlKey&&ev.shiftKey&&_2888==85){
if(isExprFieldExpanded){
collapseExprField();
}else{
expandExprField();
}
return false;
}else{
if(ev.ctrlKey&&ev.shiftKey&&_2888==13){
var _28af=getCellRange();
var _289b=_28af.startRow;
var _28b0=_28af.startCol;
var _289c=_28af.endRow;
var _28b1=_28af.endCol;
submitCell(true);
focusCellRange(_289b,_28b0,_289c,_28b1);
return false;
}
}
}
}
}
}
if(browser_opera){
if(_2888==9||_2888==13&&!ev.ctrlKey){
hideCellField();
}
}
if(_2888==8){
posOfCaret=getCaretPos(cellField);
var _28b2=(posOfCaret!=cellField.value.length)?cellField.value.substring(0,posOfCaret):cellField.value.substring(0,posOfCaret-1);
var _28b3=cellField.value.substring(0,posOfCaret-1)+cellField.value.substring(posOfCaret,cellField.value.length);
exprField.value=(exprField.value.length!=cellField.value.length)?_28b2:_28b3;
if((!browser_ie&&cellField.value.charCodeAt(posOfCaret-1)==10||browser_ie&&cellField.value.charCodeAt(posOfCaret)==13)||(getSelectedText(cellField).indexOf("\n")!=-1)){
if(isMultilineInCellField()&&currRow<=currRowOfCellfield){
setCellFieldHeight("BACKSPACE","CELLFIELD");
setCellFieldWidth("BACKSPACE");
}
}
if(isTextWrapped){
setCellFieldHeight("BACKSPACE","CELLFIELD");
}
}else{
if(_2888==35&&!ev.altKey||_2888==36&&!ev.altKey){
exprField.value=cellField.value;
}else{
if(_2888==46){
posOfCaret=getCaretPos(cellField);
endPosOfSelection=getSelectionEnd(cellField);
var _28b4=(isTextSelected(cellField))?0:1;
exprField.value=cellField.value.substring(0,posOfCaret)+cellField.value.substring(endPosOfSelection+_28b4,cellField.value.length);
if((!browser_ie&&cellField.value.charCodeAt(posOfCaret)==10)||(browser_ie&&cellField.value.charCodeAt(posOfCaret)==13&&((posOfCaret+2)!=cellField.value.length))||(getSelectedText(cellField).indexOf("\n")!=-1)){
if(isMultilineInCellField()){
setCellFieldHeight("DELETE","CELLFIELD");
setCellFieldWidth("DELETE");
}
}
if(isTextWrapped){
setCellFieldHeight("BACKSPACE","CELLFIELD");
}
}
}
}
if(_2888==37){
posOfCaret=getSelectionStart(cellField);
if(!browser_ie&&cellField.value.charCodeAt(posOfCaret-1)==10||browser_ie&&cellField.value.charCodeAt(posOfCaret)==13){
scrolledHeightForExprField=(EXPRCONTENTHEIGHT*cellField.value.substring(0,posOfCaret-1).split("\n").length)-EXPRCONTENTHEIGHT;
exprField.scrollTop=scrolledHeightForExprField;
}
}else{
if(_2888==39){
posOfCaret=getSelectionStart(cellField);
if(cellField.value.charCodeAt(posOfCaret)==10||browser_ie&&cellField.value.charCodeAt(posOfCaret+1)==10){
scrolledHeightForExprField=(EXPRCONTENTHEIGHT*cellField.value.substring(0,posOfCaret-1).split("\n").length);
exprField.scrollTop=scrolledHeightForExprField;
exprField.scrollLeft=0;
}
}else{
if(_2888==38){
posOfCaret=getSelectionStart(cellField);
var _28b5=cellField.value.substring(0,posOfCaret);
if(_28b5.indexOf("\n")!=-1){
scrolledHeightForExprField=(EXPRCONTENTHEIGHT*cellField.value.substring(0,posOfCaret).split("\n").length)-(2*EXPRCONTENTHEIGHT);
exprField.scrollTop=scrolledHeightForExprField;
}
}else{
if(_2888==40){
posOfCaret=getSelectionStart(cellField);
var _28b5=cellField.value.substring(posOfCaret+1,cellField.value.length);
if(_28b5.indexOf("\n")!=-1){
scrolledHeightForExprField=(EXPRCONTENTHEIGHT*cellField.value.substring(0,posOfCaret-1).split("\n").length);
exprField.scrollTop=scrolledHeightForExprField;
}
}else{
if(_2888==36){
if(ev.ctrlKey||(ev.ctrlKey&&ev.shiftKey)){
scrolledHeightForExprField=0;
exprField.scrollTop=scrolledHeightForExprField;
}
}else{
if(_2888==35){
if((ev.ctrlKey)||(ev.ctrlKey&&ev.shiftKey)){
scrolledHeightForExprField=(EXPRCONTENTHEIGHT*cellField.value.split("\n").length);
exprField.scrollTop=scrolledHeightForExprField;
}
}else{
if(_2888==70){
if(ev.ctrlKey&&ev.shiftKey){
setCaretPos(exprField,exprField.value.length);
return false;
}
}
}
}
}
}
}
}
}
function cellFieldKeyPress(ev){
if(isCellFieldSPANHided()){
if(!exprFieldKeyPressed){
return cellKeyPress(ev);
}else{
return;
}
}
var _28b7=(browser_ie)?window.event.keyCode:ev.which;
posOfCaret=getCaretPos(cellField);
startPosOfSelection=posOfCaret;
endPosOfSelection=getSelectionEnd(cellField);
if(_28b7==13&&(!ev.ctrlKey&&!ev.altKey)){
if(initialiseFormulaAutoComplete.isMenuOpen){
initialiseFormulaAutoComplete.isMenuOpen=false;
return false;
}
}
var id=cellField.id;
if(_28b7==44||_28b7==59){
var _28b9=(cellField.value).substr(0,getCaretPos(cellField));
var _28ba=String.fromCharCode(_28b7);
var _28bb=_28b9+_28ba;
var _28bc=isTextSelected(cellField);
formulaSyntaxTip.showTip(_28bb,$("#"+id),_28b7,_28bc);
}
if(ev.ctrlKey&&(ev.keyCode==13||ev.keyCode==10)||(_28b7==13&&ev.altKey)){
addLineBreak("CELLFIELD");
if($formulaSyntaxDiv){
if(formulaSyntaxTip.isVisible()){
var _28bd=$formulaSyntaxDiv.data("formulaData");
var _28be=_28bd["indx"];
formulaSyntaxTip.setLeftAndTop(_28be,$("#"+id));
}
}
return false;
}
if(_28b7!=8&&_28b7!=0&&!ev.ctrlKey&&!ev.altKey&&!ev.metaKey){
if(!browser_ie){
exprField.value=cellField.value.substring(0,startPosOfSelection)+String.fromCharCode(_28b7)+cellField.value.substring(endPosOfSelection,cellField.value.length);
}else{
if(exprField.value.charCodeAt(startPosOfSelection)!=13){
exprField.value=cellField.value.substring(0,startPosOfSelection)+String.fromCharCode(_28b7)+cellField.value.substring(endPosOfSelection,cellField.value.length);
}else{
exprField.value=cellField.value.substring(0,startPosOfSelection+2)+String.fromCharCode(_28b7)+cellField.value.substring(endPosOfSelection,cellField.value.length);
}
}
setCellFieldWidth();
if(isTextSelected(cellField)&&!isSuggestAvailable){
setCellFieldHeight("KEYUP","CELLFIELD");
}
}
if(browser_nn6){
exprField.scrollTop=scrolledHeightForExprField;
if(!contentNotReachedMaximumheight){
cellField.scrollTop=scrolledHeightForCellField;
}
}
if(browser_opera){
if(_28b7==9||_28b7==13&&!ev.ctrlKey){
hideCellField();
return false;
}
}
}
function cellFieldKeyUp(ev){
if(isCellFieldSPANHided()){
return cellKeyUp(ev);
}
var _28c0=(browser_ie)?window.event.keyCode:ev.which;
if(_28c0==37||_28c0==38||_28c0==39||_28c0==40){
if(isFMenuOpened){
return;
}
}
if(cellField.value.indexOf("=")==0){
var _28c1=isTextSelected(cellField);
if(((_28c0>=32&&_28c0<=126)&&_28c1)||_28c0==35||_28c0==36||_28c0==37||_28c0==39){
var _28c2=(cellField.value).substr(0,getCaretPos(cellField));
formulaSyntaxTip.showTip(_28c2,$(cellField),_28c0,_28c1);
}
}
if(_28c0==13){
setCellFieldWidth();
}
if(browser_opera){
if(_28c0==9||_28c0==13&&!ev.ctrlKey){
hideCellField();
}else{
if(_28c0==27){
if(currCell!=null){
constructURL(currCell,currCellValue);
currCell.setAttribute("cV",currCellValue);
if(currCellFormula!=""){
if(currCellValue!=currCellFormula){
currCell.setAttribute("fn",currCellFormula);
}
}
}else{
var _28c3=getHiddenCellFormula(currRow,currCol);
exprField.value=_28c3;
}
resetGlobalVariables();
focusCell(currRow,currCol);
return false;
}
}
}
if(_28c0==86&&ev.ctrlKey){
exprField.value=cellField.value;
setCellFieldWidth("PASTE");
setCellFieldHeight("PASTE","CELLFIELD");
}
if(_28c0==90&&ev.ctrlKey){
exprField.value=cellField.value;
setCellFieldWidth("UNDO");
setCellFieldHeight("UNDO","CELLFIELD");
}
if(_28c0==89&&ev.ctrlKey){
exprField.value=cellField.value;
setCellFieldWidth("REDO");
setCellFieldHeight("REDO","CELLFIELD");
}
if(_28c0==88&&ev.ctrlKey){
exprField.value=cellField.value;
setCellFieldWidth("CUT");
setCellFieldHeight("CUT","CELLFIELD");
}
}
function exprFieldKeyDown(ev){
if(!READ_WRITE){
return false;
}
var _28c5=(browser_ie)?window.event.keyCode:ev.which;
var id=exprField.id;
var _28c7=$("#"+id);
if(_28c5==113){
_28c7.autocomplete("close");
}
if(_28c5==13||_28c5==9){
if(_28c7.autocomplete("widget").is(":visible")){
initialiseFormulaAutoComplete.isMenuOpen=true;
return false;
}
}
if(ev.altKey&&_28c5==38){
disableAutoComplete(id);
return;
}
var _28c8=ev.shiftKey;
if((_28c8&&_28c5==48)||(_28c8&&_28c5==57)||(_28c8&&_28c5==222)||_28c5==8||_28c5==46){
if((_28c8&&_28c5==48)||(_28c8&&_28c5==57)){
_28c7.autocomplete("close");
}
var _28c9=(exprField.value).substr(0,getCaretPos(exprField));
var _28ca=isTextSelected(exprField);
formulaSyntaxTip.showTip(_28c9,_28c7,_28c5,_28ca,_28c8);
}
if(!isStylesAssignedForCellField){
isCellFieldSPANHided.isHided=false;
initCellFieldWhileEditInExprField();
}
if(ev.altKey&&browser_ie&&_28c5==13||(os_mac&&browser_nn6&&ev.ctrlKey&&_28c5==77)){
posOfCaret=getCaretPos(exprField);
startPosOfSelection=getSelectionStart(exprField);
endPosOfSelection=getSelectionEnd(exprField);
Event.stop(ev);
stopEvt(ev);
addLineBreak("EXPRFIELD");
return;
}
if(!copyStatus&&!cutStatus){
hideFlashDIV();
}
if(_28c5==8){
posOfCaret=getCaretPos(exprField);
var _28cb=posOfCaret;
if(browser_ie&&exprField.value.charCodeAt(posOfCaret)==13){
_28cb=posOfCaret+2;
}
var _28cc=(posOfCaret!=exprField.value.length)?exprField.value.substring(0,_28cb):exprField.value.substring(0,_28cb-1);
var _28cd=exprField.value.substring(0,_28cb-1)+exprField.value.substring(_28cb,exprField.value.length);
var _28ce=(cellField.value.length!=exprField.value.length)?_28cc:_28cd;
cellField.value=_28ce;
if(isCellFieldInEditMode()){
if(exprField.value.charCodeAt(posOfCaret-1)==10||(getSelectedText(exprField).indexOf("\n")!=-1)){
if(isMultilineInCellField()){
setCellFieldHeight("BACKSPACE","EXPRFIELD");
setCellFieldWidth();
}
}
}else{
if(isCellFieldInNewMode()){
if(browser_ie){
var _28cf=cellField.value.substring(0,posOfCaret+2);
if(exprField.value.charCodeAt(posOfCaret)==13){
scrolledHeightForCellField=getCellContentHeightForMultiline(exprField.value.substring(0,posOfCaret-1))-contentHeight;
cellField.scrollTop=scrolledHeightForCellField;
_28cf=cellField.value.substring(0,posOfCaret);
}
cellFieldScrollLeft(_28cf);
}
}
}
}else{
if(_28c5==35||_28c5==36||_28c5==37||_28c5==39){
cellField.value=exprField.value;
}
}
if(_28c5==46){
posOfCaret=getSelectionStart(exprField);
endPosOfSelection=getSelectionEnd(exprField);
var _28d0=(isTextSelected(exprField))?0:1;
var _28d1=exprField.value.substring(0,posOfCaret)+exprField.value.substring(endPosOfSelection+_28d0,exprField.value.length);
cellField.value=_28d1;
var _28cb=(browser_ie||browser_opera)?posOfCaret+1:posOfCaret;
if(isCellFieldInEditMode()){
if((exprField.value.charCodeAt(_28cb)==10)||(getSelectedText(exprField).indexOf("\n")!=-1)){
if(isMultilineInCellField()){
setCellFieldHeight("DELETE","EXPRFIELD");
setCellFieldWidth();
}
}
}
}
if(_28c5==27){
if(editedFormulaCellInfo.isOtherSheet){
var _28d2=editedFormulaCellInfo.cellFieldDetails.ACTUAL_FORMULA_SHEET;
var _28d3=true;
var _28d4=editedFormulaCellInfo.cellFieldDetails.ROW;
var _28d5=editedFormulaCellInfo.cellFieldDetails.COLUMN;
cellField.value="";
doGoto(_28d2,_28d4,_28d4,_28d5,_28d5);
clearCellRangeFill();
editedFormulaCellInfo={"isOtherSheet":false,"cellFieldDetails":{}};
}
if(currCell!=null){
constructURL(currCell,currCellValue);
currCell.setAttribute("cV",currCellValue);
if(currCellFormula!=""){
if(currCellValue!=currCellFormula){
currCell.setAttribute("fn",currCellFormula);
}
}
exprField.value=getCellContent();
}else{
var _28d6=getHiddenCellFormula(currRow,currCol);
exprField.value=_28d6;
}
resetGlobalVariables();
focusCell(currRow,currCol);
return false;
}else{
if(_28c5==9||_28c5==13&&!ev.altKey&&!ev.ctrlKey){
if(!isCellFieldSPANHided()||exprField.value.indexOf("=")==0){
if(getCellContent(currCell,"fn")=="hide"&&jsPUBLIC_VIEW&&!showFormulas){
focusCell(currRow,currCol);
resetGlobalVariables();
}else{
if(editedFormulaCellInfo.isOtherSheet){
var _28d2=editedFormulaCellInfo.cellFieldDetails.ACTUAL_FORMULA_SHEET;
submitCell();
var fRow=editedFormulaCellInfo.cellFieldDetails.ROW;
var fCol=editedFormulaCellInfo.cellFieldDetails.COLUMN;
doGoto(_28d2,fRow,fRow,fCol,fCol);
return false;
}else{
if(!isPartOfArray(currRow,currCol,currRow,currCol)){
submitCell();
}
}
}
}
if(_28c5==9){
var info=ActiveCellInfo;
var col=info.getStartCol();
focusCell(currRow,col+1);
}else{
var info=ActiveCellInfo;
var row=info.getStartRow();
focusCell(Row.findNextNonHiddenRow(row),currCol);
}
if(browser_opera){
hideCellField();
}
return false;
}else{
if(ev.ctrlKey&&ev.shiftKey&&_28c5==85){
if(isExprFieldExpanded){
collapseExprField();
}else{
expandExprField();
}
return false;
}else{
if(ev.ctrlKey&&ev.shiftKey&&_28c5==13){
submitCell(true);
focusCellRange(startRow,startColumn,endRow,endColumn);
return false;
}
}
}
}
if(isCellFieldInNewMode()){
if(_28c5==37){
posOfCaret=getSelectionStart(exprField);
var _28cf=exprField.value.substring(0,posOfCaret);
cellFieldScrollLeft(_28cf);
if(!browser_ie&&exprField.value.charCodeAt(posOfCaret-1)==10||browser_ie&&exprField.value.charCodeAt(posOfCaret)==13){
scrolledHeightForCellField=getCellContentHeightForMultiline(exprField.value.substring(0,posOfCaret-1))-contentHeight;
cellField.scrollTop=scrolledHeightForCellField;
}
}else{
if(_28c5==39){
posOfCaret=getSelectionStart(exprField);
var _28cf=exprField.value.substring(0,posOfCaret);
cellFieldScrollLeft(_28cf);
if(exprField.value.charCodeAt(posOfCaret)==10||browser_ie&&exprField.value.charCodeAt(posOfCaret+1)==10){
scrolledHeightForCellField=getCellContentHeightForMultiline(exprField.value.substring(0,posOfCaret-1));
cellField.scrollTop=scrolledHeightForCellField;
cellField.scrollLeft=0;
}
}else{
if(_28c5==38){
posOfCaret=getSelectionStart(exprField);
var _28dc=exprField.value.substring(0,posOfCaret);
if(_28dc.indexOf("\n")!=-1){
scrolledHeightForCellField=getCellContentHeightForMultiline(_28dc)-(2*contentHeight);
cellField.scrollTop=scrolledHeightForCellField;
}else{
scrolledHeightForCellField=0;
cellField.scrollTop=scrolledHeightForCellField;
}
}else{
if(_28c5==40){
posOfCaret=getSelectionStart(exprField);
var _28dc=exprField.value.substring(posOfCaret+1,exprField.value.length);
if(_28dc.indexOf("\n")!=-1){
scrolledHeightForCellField=getCellContentHeightForMultiline(exprField.value.substring(0,posOfCaret));
cellField.scrollTop=scrolledHeightForCellField;
}else{
scrolledHeightForCellField=0;
cellField.scrollTop=scrolledHeightForCellField;
}
}else{
if(_28c5==36){
cellField.scrollLeft=0;
if(ev.ctrlKey||(ev.ctrlKey&&ev.shiftKey)){
scrolledHeightForCellField=0;
cellField.scrollTop=scrolledHeightForCellField;
}
}else{
if(_28c5==35){
var _28cf=exprField.value.substring(0,posOfCaret);
cellFieldScrollLeft(_28cf);
if((ev.ctrlKey)||(ev.ctrlKey&&ev.shiftKey)){
scrolledHeightForCellField=getCellContentHeightForMultiline(exprField.value);
cellField.scrollTop=scrolledHeightForCellField;
}
}
}
}
}
}
}
}
if(_28c5!=27){
exprFieldKeyPressed=true;
}
resetFillRanges("exprField",ev.shiftKey,_28c5);
}
function exprFieldKeyUp(ev){
var _28de=(browser_ie)?window.event.keyCode:ev.which;
if(exprField.value.indexOf("=")==0){
isExprFunc=true;
tempPos=getCaretPos(exprField);
}
var id=exprField.id;
var _28e0=$("#"+id);
if(_28de==27){
formulaSyntaxTip.hideMe();
}
if(_28de==37||_28de==38||_28de==39||_28de==40){
if(_28e0.autocomplete("widget").is(":visible")){
return;
}
}
if(_28de==35||_28de==36||_28de==37||_28de==39){
var _28e1=(exprField.value).substr(0,getCaretPos(exprField));
formulaSyntaxTip.showTip(_28e1,_28e0,_28de);
}
if(browser_opera){
if(_28de==9||_28de==13&&!ev.altKey&&!ev.ctrlKey){
exprField.blur();
focusCell(currRow,currCol);
return false;
}else{
if(_28de==27){
if(currCell!=null){
constructURL(currCell,currCellValue);
if(currCellFormula!=""){
if(currCellValue!=currCellFormula){
currCell.setAttribute("fn",currCellFormula);
}
}
}else{
var _28e2=getHiddenCellFormula(currRow,currCol);
exprField.value=_28e2;
}
focusCell(currRow,currCol);
resetGlobalVariables();
return false;
}
}
}
if(_28de==86&&ev.ctrlKey){
cellField.value=exprField.value;
if(isCellFieldInEditMode()){
setCellFieldWidth("PASTE");
setCellFieldHeight("PASTE","EXPRFIELD");
}else{
var _28e3=cellField.value.substring(0,(browser_ie)?posOfCaret+2:posOfCaret);
cellFieldScrollLeft(_28e3);
}
}
if(_28de==90&&ev.ctrlKey){
cellField.value=exprField.value;
if(isCellFieldInEditMode()){
setCellFieldWidth("UNDO");
setCellFieldHeight("UNDO","CELLFIELD");
}else{
var _28e3=cellField.value.substring(0,(browser_ie)?posOfCaret+2:posOfCaret);
cellFieldScrollLeft(_28e3);
}
}
if(_28de==89&&ev.ctrlKey){
cellField.value=exprField.value;
if(isCellFieldInEditMode()){
setCellFieldWidth("REDO");
setCellFieldHeight("REDO","CELLFIELD");
}else{
var _28e3=cellField.value.substring(0,(browser_ie)?posOfCaret+2:posOfCaret);
cellFieldScrollLeft(_28e3);
}
}
}
function exprFieldKeyPress(ev){
if(!READ_WRITE){
return false;
}
var _28e5=(browser_ie)?window.event.keyCode:ev.which;
posOfCaret=getCaretPos(exprField);
startPosOfSelection=getSelectionStart(exprField);
endPosOfSelection=getSelectionEnd(exprField);
if((_28e5==10||_28e5==13)&&ev.ctrlKey||(_28e5==13&&ev.altKey)){
addLineBreak("EXPRFIELD");
return false;
}
if(_28e5==13&&(!ev.ctrlKey&&!ev.altKey)){
if(initialiseFormulaAutoComplete.isMenuOpen){
initialiseFormulaAutoComplete.isMenuOpen=false;
return false;
}
}
var _28e6=isTextSelected(exprField);
if(((_28e5>=32&&_28e5<=126)&&_28e6)||_28e5==44||_28e5==59){
var id=exprField.id;
id="#"+id;
var _28e8=$(id);
var _28e9=(exprField.value).substr(0,getCaretPos(exprField));
var _28ea=String.fromCharCode(_28e5);
var _28eb=_28e9+_28ea;
formulaSyntaxTip.showTip(_28eb,_28e8,_28e5,_28e6);
}
if(_28e5!=8&&_28e5!=0&&!(ev.shiftKey&&ev.ctrlKey)&&!ev.metaKey&&!ev.ctrlKey&&!(browser_opera&&(_28e5==27||ev.shiftKey||ev.altKey||_28e5==36||_28e5==35))){
if(!browser_ie){
cellField.value=exprField.value.substring(0,startPosOfSelection)+String.fromCharCode(_28e5)+exprField.value.substring(endPosOfSelection,exprField.value.length);
}else{
if(cellField.value.charCodeAt(startPosOfSelection)!=13){
cellField.value=exprField.value.substring(0,startPosOfSelection)+String.fromCharCode(_28e5)+exprField.value.substring(endPosOfSelection,exprField.value.length);
}else{
cellField.value=exprField.value.substring(0,startPosOfSelection+2)+String.fromCharCode(_28e5)+exprField.value.substring(endPosOfSelection,exprField.value.length);
}
}
if(isTextSelected(exprField)&&!isSuggestAvailable){
setCellFieldHeight("KEYUP","EXPRFIELD");
}
}
if(isCellFieldInEditMode()){
setCellFieldWidth();
}else{
if(isCellFieldInNewMode()){
if(browser_nn6){
cellField.scrollTop=scrolledHeightForCellField;
}
var _28ec=cellField.value.substring(0,(browser_ie)?posOfCaret+2:posOfCaret);
cellFieldScrollLeft(_28ec);
}
}
if(browser_opera){
if(_28e5==9||_28e5==13&&!ev.altKey&&!ev.ctrlKey){
exprField.blur();
return false;
}
}
}
function checkCellFunction(cell){
if(cell.id=exprField.id){
if(cell.value.indexOf("=")==0){
isExprFunc=true;
}
var val=cell.value;
if(isArrayCell(currRow,currCol)){
if(val!=null&&val!="null"){
if(val.charAt(0)=="{"){
val=val.substring(1,val.length-1);
exprField.value=val;
cellField.value=val;
}
}
}
}else{
if(cell.value.indexOf("=")==0){
formulaFill=true;
}
}
if(SAVED&&ALLOW_TO_WRITE){
$("#save").enable();
}
isEditingInExprField=true;
}
function getSuggest(_28ef){
}
function insertInSuggestArr(_28f0,cnt,pos){
}
function deleteInSuggestArr(_28f3,cnt){
}
function getSuggestList(col){
var _28f6=ctxpath+"picklist.do";
var _28f7="col="+col;
_28f7+="&currentTime="+CURRENTTIME;
_28f7+="&currentSheet="+CURRSHEETNAME;
_28f7+="&documentId="+DOCUMENT_ID;
_28f7+="&view="+getObj("VIEW").value;
_28f7+="&docOwner="+CURR_DOC_OWNERNAME;
var _28f8=new getXmlhttp();
_28f8.onreadystatechange=function(){
if(_28f8.readyState==4){
picklistCallBack(_28f8.responseText);
}
};
sendXMLHTTPRequest(_28f8,_28f7,true,true,_28f6);
}
function picklistCallBack(_28f9){
var _28f9=eval("("+_28f9+")");
var _28fa=getSuggestMenuXmlFormat(_28f9);
Menu.create(_28fa,{inputType:"xml"});
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
var _28fe=getCellPosInPage(row,col);
showMenu("autosuggestmenu",{position:"absolute",left:_28fe.left,top:_28fe.top});
}
var xmlFormtForCurrArr="";
function getSuggestMenuXmlFormat(_28ff){
xmlFormtForCurrArr="<menu id=\"autosuggestmenu\"  z-index=\"1000;\">";
if(_28ff.length!=0){
for(var _2900=0;_2900<_28ff.length;_2900+=1){
if(_28ff[_2900].indexOf("&")==-1&&_28ff[_2900].indexOf("<")==-1){
xmlFormtForCurrArr+=" <item onclick='setSuggestValue("+"\""+escapeSpecialChar(_28ff[_2900])+"\""+")'>"+_28ff[_2900]+"</item>";
}
}
}else{
xmlFormtForCurrArr+=" <item>"+"none"+"</item>";
}
xmlFormtForCurrArr+="</menu>";
return xmlFormtForCurrArr;
}
function setSuggestValue(val){
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
scrollCellIntoView(row,col);
val=unescapeSpecialChar(val);
cellField.value=val;
exprField.value=val;
submitCell();
}
function currCellIndicatorClick(){
if(browser_opera){
showDefinedNameDialog();
}
}
function currCellIndicatorKeyDown(ev){
var _2906=(browser_ie)?window.event.keyCode:ev.which;
if(_2906==9){
return false;
}
if(_2906==13){
var ind=currCellIndicator.value.trim();
ind=ind.replace(".","!");
currCellIndicator.blur();
var _2908=ind;
if(_2908.indexOf("!")!=-1){
var _2909=_2908.substring(0,_2908.indexOf("!"));
_2908=_2908.substring(_2908.indexOf("!")+1,_2908.length);
}
if(isDefinedName(_2908)){
gotoCellByName(_2908);
return false;
}
if(isValidLabel(ind)){
if(forCellLblCheck(ind,"Trc")){
gotoCellByLbl(ind);
return false;
}
}
if(ind.indexOf("!")!=-1){
if(_2909.trim().toUpperCase()==CURRSHEETNAME.toUpperCase()){
ind=_2908;
}
}
if(checkSheetName(ind,"Define Name")||!isNaN(ind.charAt(0))){
var _290a=jsTitleMsg.InvalidName+"\n";
_290a+="\t";
_290a+="- "+jsTitleMsg.CellNamecannotstartwithnumbers;
_290a+="\n\t";
_290a+="- "+jsTitleMsg.CellNamecannotbeassameasZohoSheetdefinedcelllabels;
showAlertDialog(_290a);
currCellIndicator.focus();
return;
}
var sheet=CURRSHEETNAME;
var _290c="";
if(isCellRange()){
var _290d=getCellRange();
_290c=constructCellName(_290d.startRow,_290d.startCol,_290d.endRow,_290d.endCol);
}else{
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
_290c=constructCellName(row,col);
}
if(sheet.indexOf(" ")!=-1){
sheet="'"+sheet+"'";
}
cellLoc="$"+sheet+"."+_290c;
addName(ind,cellLoc);
}
if(_2906==27){
closeDialog();
currCellIndicator.blur();
focusCell(currRow,currCol);
}
}
function currCellIndicatorKeyUp(ev){
var _2912=(browser_ie)?window.event.keyCode:ev.which;
if((ev.shiftKey&&ev.ctrlKey&&_2912==78)||_2912==16||_2912==17){
return false;
}
suggestListNames("Trc");
}
var TBLSEL=-1;
function namedRangeSelectionMove(_2913){
var _2914=getObj("definedNamerangesTBL");
if(_2914!=null){
if(_2913==35){
TBLSEL=_2914.rows.length-1;
}else{
if(_2913==36){
TBLSEL=0;
}else{
if(_2913==38){
if(TBLSEL==0||TBLSEL==-1){
TBLSEL=_2914.rows.length-1;
}else{
TBLSEL=TBLSEL-1;
}
}else{
if(_2913==40){
if(TBLSEL==_2914.rows.length-1){
TBLSEL=0;
}else{
TBLSEL=TBLSEL+1;
}
}
}
}
}
return false;
}
}
function showDefinedNameDialog(){
if(isEditingInExprField){
submitCell();
}
if(NAMEDRANGES.length!=0){
var _2915="";
_2915+="<div id='definedNameListDIV' style='overflow: auto; max-height: 100px;min-width :"+getObj("Trc").offsetWidth+"' class='pickList'>";
_2915+="<table id='definedNamerangesTBL'  width='100%' cellspacing='0' cellpadding='0' >";
for(var i=0;i<NAMEDRANGES.length;i++){
var _2917=NAMEDRANGES[i];
namedRanges[i]=_2917["NAME"];
var inVal="'"+namedRanges[i]+"'";
_2915+="<tr id='defNameTR_"+i+"'>";
_2915+="<td id=\"defNameTD_"+i+"\" onClick=\"closeDialog();gotoCellByName("+inVal+");return false;\"><a href=\"javaScript:;\"><span>"+namedRanges[i]+"</span></a></td></tr>";
}
_2915+="</table></div>";
TBLSEL=-1;
showDialog(_2915,"position=relative, srcElement=Trc, closeButton=no, closeOnEscKey=yes, closeOnBodyClick=yes, modal=no");
}
}
function initCellFieldWhileEditInExprField(){
if(currCell){
if(isCellWrapped(currCell)&&isCellFieldInEditMode()){
cellField.setAttribute("wrap","on");
}else{
cellField.setAttribute("wrap","off");
}
initCellFieldStyles();
setDummySpanStyles();
initCellContentDetails();
cellField.value=getCellContent();
initMaxStylePropertyForSheet();
if(isCellWrapped(currCell)){
dummyTextArea.value=cellField.value;
setDummyTextAreaStyles();
isTextWrapped=true;
}
maxCellFieldWidthInExprFieldNewMode=getColWidth(currCol);
}
}
function initCellContentDetails(){
cellContentHeight=contentHeight;
cellContentWidth=getCellValueWidth(cellField.value);
var info=ActiveCellInfo;
var _291a=info.getStartCol();
var _291b=info.getEndCol();
var _291c=info.getStartRow();
var _291d=info.getEndRow();
currRowOfCellfield=_291d;
currColOfCellfield=_291b;
if(_291a<FREEZED_COL&&_291b>FREEZED_COL){
requiredCellWidth=getColLeft(FREEZED_COL)-getColLeft(_291a);
}else{
requiredCellWidth=info.getWidth();
}
if(_291c<FREEZED_ROW&&_291d>FREEZED_ROW){
requiredCellHeight=getRowTop(FREEZED_ROW)-getRowTop(_291c);
}else{
requiredCellHeight=info.getHeight();
}
}
function initCellFieldStyles(){
var _291e={width:ActiveCellInfo.getWidth(),left:ActiveCellInfo.getLeft(),height:ActiveCellInfo.getHeight(),top:ActiveCellInfo.getTop()};
var _291f=Row.isHidden(currRow);
if(ISFREEZED){
var info=ActiveCellInfo;
var _2921=info.getStartCol();
var _2922=info.getEndCol();
var _2923=info.getStartRow();
var _2924=info.getEndRow();
if(_2923<FREEZED_ROW&&_2924>=FREEZED_ROW){
requiredCellHeight=getRowTop(FREEZED_ROW)-getRowTop(_2923);
}else{
requiredCellHeight=info.getHeight();
}
if(_2921<FREEZED_COL&&_2922>FREEZED_COL){
requiredCellWidth=getColLeft(FREEZED_COL)-getColLeft(_2921);
wrapCellFieldValue("NORMAL");
}else{
requiredCellWidth=info.getWidth();
}
_291e.height=requiredCellHeight;
_291e.width=requiredCellWidth;
}
setCellFieldSPANWidth(_291e.width);
setCellFieldSPANHeight(_291e.height);
setCellFieldPosition(_291e.left,_291e.top);
if(browser_safari&&!browser_chrome){
cellField.style.paddingLeft="0px";
cellField.style.paddingRight="0px";
}
cellField.style.borderColor="transparent";
if(!_291f){
cellField.style.backgroundColor=currCell.style.backgroundColor;
cellField.style.color=currCell.style.color;
cellField.style.fontSize=currCell.style.fontSize;
cellField.style.fontFamily=currCell.style.fontFamily;
var _2925=(currCell.className.indexOf("nW")!=-1)?(currCell.className.substring(0,currCell.className.indexOf("nW"))+currCell.className.substring(currCell.className.indexOf("nW")+2,currCell.className.length)):currCell.className;
_2925+=" cF";
cellField.className=_2925;
}
var _2926=!_291f?getCellFormula(currCell):getHiddenCellFormula(currRow,currCol);
var _2927=getCellFormat(currCell);
if((!_291f&&_2926&&_2926.indexOf("=")==0)||isArrayCell(currRow,currCol)||(_2927=="DATE"||_2927=="DATETIME"||_2927=="TIME")){
removeCSSStyle("textAlign",cellField);
}
isStylesAssignedForCellField=true;
}
function setDummySpanStyles(){
if(!Row.isHidden(currRow)){
dummySPAN.style.fontSize=getCurrentStyle(currCell,"fontSize");
dummySPAN.style.fontWeight=getCurrentStyle(currCell,"fontWeight");
dummySPAN.style.fontFamily=getCurrentStyle(currCell,"fontFamily");
contentHeight=getCellValueHeight("$");
}
}
function initMaxStylePropertyForSheet(){
setMaxDimInViewPort();
contentNotReachedMaximumheight=true;
contentNotReachedMaximumWidth=true;
isMouseEventInSheetScrollBar=false;
sheetScrollLeftMaxInViewPort=getSheetScrollLeft();
}
function setCellFieldHeight(event,_2929){
if(!isTextWrapped){
setUnWrappedCellFieldHeight(event,_2929);
}else{
setWrappedCellFieldHeight(event,_2929);
}
}
function setUnWrappedCellFieldHeight(event,_292b){
var _292c=(_292b=="CELLFIELD")?cellField:exprField;
var info=ActiveCellInfo;
var _292e=info.getStartRow();
var _292f=info.getEndRow();
var _2930=info.getHeight();
if(ISFREEZED){
if(_292e<FREEZED_ROW&&_292f>=FREEZED_ROW){
_2930=getRowTop(FREEZED_ROW)-getRowTop(ActiveCellInfo.getStartRow());
}
}
switch(event){
case "KEYUP":
case "CUT":
case "DELETE":
case "BACKSPACE":
if(!isTextSelected(_292c)){
cellContentHeight-=contentHeight;
if(requiredCellHeight>_2930){
decreaseRequiredCellFieldHeight();
}
}else{
var _2931=getCountOfOccrnceOfCharInStr(getSelectedText(_292c),"\n");
while(_2931>0){
cellContentHeight-=contentHeight;
_2931-=1;
if(requiredCellHeight>_2930){
decreaseRequiredCellFieldHeight();
}
}
}
setCellFieldSPANHeight(requiredCellHeight);
break;
case "PASTE":
case "FOCUSMODE":
cellContentHeight=(cellField.value.indexOf("\n")!=-1)?getCellContentHeightForMultiline(cellField.value):contentHeight;
increaseRequiredCellFieldHeight();
setCellFieldSPANHeight(requiredCellHeight);
break;
case "UNDO":
case "REDO":
var _2932=_292c.value.indexOf("\n");
var _2933=_292c.value.length;
cellContentHeight=(_2932!=-1)?getCellContentHeightForMultiline(_292c.value):contentHeight;
if(_2932!=_2933-1){
if(requiredCellHeight<=cellContentHeight){
increaseRequiredCellFieldHeight();
}else{
decreaseRequiredCellFieldHeight();
}
setCellFieldSPANHeight(requiredCellHeight);
}
break;
case "SUGGEST":
if(_292c==cellField){
var _2934=getCellContentHeightForMultiline(_292c.value);
var _2935=requiredCellHeight;
var rowNo=currRowOfCellfield;
if(_2934>_2930){
while(_2934>_2935){
if(isRowExceedsMaxRow(row)){
rowNo+=1;
_2935+=getRowHeight(rowNo);
}else{
break;
}
}
}
setCellFieldSPANHeight(_2935);
}
break;
case "EDITMODE":
cellContentHeight=(cellField.value.indexOf("\n")!=-1)?getCellContentHeightForMultiline(cellField.value):contentHeight;
var info=ActiveCellInfo;
requiredCellHeight=info.getHeight();
setCellFieldSPANHeight(requiredCellHeight);
break;
default:
cellContentHeight+=contentHeight;
increaseRequiredCellFieldHeight();
setCellFieldSPANHeight(requiredCellHeight);
break;
}
}
function setCellFieldWidth(event){
if(!isTextWrapped){
setUnWrappedCellFieldWidth(event);
}else{
setCellFieldHeight(event);
}
}
function setUnWrappedCellFieldWidth(event){
var _2939={};
if(isEditingInExprField){
_2939=exprField;
}else{
_2939=cellField;
}
switch(event){
case "BACKSPACE":
case "DELETE":
var _293a=-1;
var _293b=-1;
var _293c="";
var _293d=-1;
if(event=="BACKSPACE"){
_293a=posOfCaret-1;
_293b=posOfCaret;
}else{
if(event=="DELETE"){
_293a=posOfCaret;
_293b=posOfCaret+1;
}
}
if(browser_ie){
_293c=_2939.value.substring(_2939.value.substring(0,posOfCaret).lastIndexOf("\r\n")+1,((_2939.value.indexOf("\r\n",posOfCaret+1)!=-1)?_2939.value.indexOf("\r\n",posOfCaret):_2939.value.length));
}else{
_293c=_2939.value.substring(_2939.value.substring(0,posOfCaret).lastIndexOf("\n")+1,((_2939.value.indexOf("\n",posOfCaret+1)!=-1)?_2939.value.indexOf("\n",posOfCaret):_2939.value.length));
}
_293d=getCellValueWidth(_293c);
if(_293d>requiredCellWidth){
cellContentWidth=_293d;
}
increaseRequiredCellFieldWidth();
setCellFieldSPANWidth(requiredCellWidth);
break;
case "PASTE":
case "FOCUSMODE":
cellContentWidth=(cellField.value.indexOf("\n")!=-1)?getMaxLineWidth(cellField.value.split("\n")):getCellValueWidth(cellField.value);
increaseRequiredCellFieldWidth();
setCellFieldSPANWidth(requiredCellWidth);
break;
case "UNDO":
case "REDO":
cellContentWidth=(cellField.value.indexOf("\n")!=-1)?getMaxLineWidth(cellField.value.split("\n")):getCellValueWidth(cellField.value);
if(cellContentWidth<requiredCellWidth){
increaseRequiredCellFieldWidth();
}else{
decreaseRequiredCellFieldWidth();
}
setCellFieldSPANWidth(requiredCellWidth);
break;
case "SUGGEST":
var _293e=getColWidth(currCol);
var _293f=(cellField.value.indexOf("\n")!=-1)?getMaxLineWidth(cellField.value.split("\n")):getCellValueWidth(cellField.value);
var _2940=currColOfCellfield;
if(_293f>_293e){
while(_293f>_293e){
if(isColExceedsMaxColumn(_2940)){
_2940+=1;
_293e+=getColWidth(_2940);
}else{
break;
}
}
}
setCellFieldSPANWidth(_293e);
break;
case "EDITMODE":
cellContentWidth=(cellField.value.indexOf("\n")!=-1)?getMaxLineWidth(cellField.value.split("\n")):getCellValueWidth(cellField.value)+10;
var info=ActiveCellInfo;
requiredCellWidth=info.getWidth();
increaseRequiredCellFieldWidth();
setCellFieldSPANWidth(requiredCellWidth);
break;
default:
var _293c="";
var _293d=-1;
var _2942=(browser_safari)?14:10;
if(_2939.value.indexOf("\n")!=-1){
_293c=_2939.value.substring(_2939.value.substring(0,posOfCaret).lastIndexOf("\n")+1,((_2939.value.indexOf("\n",posOfCaret)!=-1)?_2939.value.indexOf("\n",posOfCaret):_2939.value.length));
}else{
_293c=_2939.value;
}
_293d=getCellValueWidth(_293c);
if(_293d>cellContentWidth){
cellContentWidth=_293d;
}
if(cellContentWidth+_2942>requiredCellWidth){
cellContentWidth+=_2942;
increaseRequiredCellFieldWidth();
cellContentWidth-=_2942;
setCellFieldSPANWidth(requiredCellWidth);
}
break;
}
}
function setWrappedCellFieldHeight(event){
var _2944=-1;
var info=ActiveCellInfo;
var _2946=info.getStartRow();
var _2947=info.getEndRow();
var _2948=info.getHeight();
if(ISFREEZED){
if(_2946<FREEZED_ROW&&_2947>=FREEZED_ROW){
_2948=getRowTop(FREEZED_ROW)-getRowTop(ActiveCellInfo.getStartRow());
}
}
if(!isEditingInExprField){
dummyTextArea.value=exprField.value;
}else{
dummyTextArea.value=cellField.value;
}
if((browser_safari||os_mac)&&(dummyTextArea.scrollHeight>_2948)){
if(os_mac){
dummyTextArea.style.width=requiredCellWidth+V_SCROLLBAR_WIDTH;
}else{
if(browser_safari){
dummyTextArea.style.width=requiredCellWidth+V_SCROLLBAR_WIDTH-1;
}
}
}
if(dummyTextArea.value.indexOf(" ")!=-1){
_2944=getCellValueWidth(dummyTextArea.value.substring(dummyTextArea.value.lastIndexOf(" ")+1,dummyTextArea.value.length));
}else{
_2944=getCellValueWidth(dummyTextArea.value);
}
if(_2944+10>getColWidth(currCol)){
cellField.scrollLeft=_2944+50;
}else{
cellField.scrollLeft=0;
}
getWrappedCellFieldHeight(event);
setCellFieldSPANHeight(requiredCellHeight);
}
function cellFieldMouseUp(){
posOfCaret=getCaretPos(cellField);
var value=cellField.value.substring(0,posOfCaret);
if(isEditingInExprField){
initCellContentDetails();
setCellFieldWidth("FOCUSMODE");
setCellFieldHeight("FOCUSMODE","CELLFIELD");
cellField.scrollTop=0;
cellField.scrollLeft=0;
isEditingInExprField=false;
}else{
if(value.indexOf("\n")!=-1){
exprField.scrollTop=EXPRCONTENTHEIGHT*value.split("\n").length-EXPRCONTENTHEIGHT;
}else{
exprField.scrollTop=0;
}
}
}
function exprFieldMouseUp(){
isEditingInExprField=true;
if(isCellFieldInNewMode()){
posOfCaret=getCaretPos(exprField);
var value=exprField.value.substring(0,posOfCaret);
if(value.indexOf("\n")!=-1){
scrolledHeightForCellField=getCellContentHeightForMultiline(value)-contentHeight;
cellField.scrollTop=scrolledHeightForCellField;
}else{
cellField.scrollTop=0;
}
var _294b=exprField.value.substring(0,(browser_ie)?posOfCaret+2:posOfCaret);
cellFieldScrollLeft(_294b);
}
}
function expandExprField(){
collapsedExprField.style.display="none";
expandedExprField.style.display="";
exprField.style.height=EXPRFIELD_EXPAND_HEIGHT+"px";
exprEqualExpandDiv.style.height=EXPRFIELD_EXPAND_HEIGHT-(parseInt(exprEqualTable.offsetHeight)-2);
exprArrowExpandDiv.style.height=EXPRFIELD_EXPAND_HEIGHT-(parseInt(expandedExprField.offsetHeight)+4);
isExprFieldExpanded=true;
resetWorkSheetDim();
exprField.value=cellField.value;
if(isCellFieldSPANHided()){
exprField.value=getCellContent();
}
}
function collapseExprField(){
expandedExprField.style.display="none";
collapsedExprField.style.display="";
exprField.style.height=EXPRFIELD_COLLAPSE_HEIGHT+"px";
exprEqualExpandDiv.style.height="0px";
exprArrowExpandDiv.style.height="0px";
isExprFieldExpanded=false;
resetWorkSheetDim();
exprField.value=cellField.value;
if(isCellFieldSPANHided()){
exprField.value=getCellContent();
}
}
function cellFieldScrollLeft(_294c){
var _294d=(_294c.indexOf("\n")!=-1)?_294c.substring(_294c.lastIndexOf("\n")+1,_294c.length):_294c;
var _294e=getCellValueWidth(_294d);
if((maxCellFieldWidthInExprFieldNewMode-10)<_294e){
cellField.scrollLeft=(_294e-maxCellFieldWidthInExprFieldNewMode)+25;
}else{
cellField.scrollLeft=0;
}
}
function setCellFieldPosition(left,top){
cellField.style.left=left+"px";
cellField.style.top=top+"px";
}
var focusDIVBufferSize=200;
var focusDIVIncrementCount=3;
function setFocusDIVPos(_2951,_2952){
if(isNumber(_2951)&&isNumber(_2952)){
_2951=(_2951-2);
_2952=(_2952-2);
focusDIV.style.left=_2951+"px";
focusDIV.style.top=_2952+"px";
if(ISFREEZED){
focusDIV1.style.left=focusDIV2.style.left=focusDIV3.style.left=_2951+"px";
focusDIV1.style.top=focusDIV2.style.top=focusDIV3.style.top=_2952+"px";
}
}
}
function setFocusDIVDim(width,_2954){
var _2955;
var _2956;
if(isNumber(width)&&isNumber(_2954)&&!isNaN(_2954)&&!isNaN(width)){
_2954=(_2954+3)+"px";
width=(width+3)+"px";
focusDIV.style.height=_2954;
focusDIV.style.width=width;
if(ISFREEZED){
focusDIV1.style.height=focusDIV2.style.height=focusDIV3.style.height=_2954;
focusDIV1.style.width=focusDIV2.style.width=focusDIV3.style.width=width;
}
}
}
function setCellFieldDim(_2957){
if(_2957=="height"){
requiredCellHeight=getRowHeight(currRow);
setCellFieldHeight("FOCUSMODE","CELLFIELD");
}
if(_2957=="width"){
requiredCellWidth=getColWidth(currCol);
setCellFieldHeight("FOCUSMODE");
}
}
function setDummyTextAreaStyles(){
if(!Row.isHidden(currRow)){
dummyTextArea.style.fontSize=getCurrentStyle(currCell,"fontSize");
dummyTextArea.style.fontWeight=getCurrentStyle(currCell,"fontWeight");
dummyTextArea.style.fontFamily=getCurrentStyle(currCell,"fontFamily");
dummyTextArea.style.width=requiredCellWidth+1;
dummyTextArea.style.height=19+"px";
if(browser_ie){
dummyTextArea.style.width=requiredCellWidth+20+"px";
}
if(browser_safari||os_mac){
dummyTextArea.style.width=requiredCellWidth-2+"px";
if(dummyTextArea.scrollTop>0){
if(os_mac){
dummyTextArea.style.width=requiredCellWidth+V_SCROLLBAR_WIDTH+"px";
}else{
if(os_windows&&browser_safari){
dummyTextArea.style.width=requiredCellWidth+V_SCROLLBAR_WIDTH-1+"px";
}
}
}
var _2958=parseInt(dummyTextArea.style.height)+dummyTextArea.scrollTop-2;
if(_2958>parseInt(cellFieldSPAN.style.height)){
setCellFieldSPANHeight(_2958);
}
}
}
}
function decreaseRequiredCellFieldHeight(){
var info=ActiveCellInfo;
var _295a=info.getHeight();
var _295b=info.getStartRow();
var _295c=info.getEndRow();
if(ISFREEZED){
if(_295b<FREEZED_ROW&&_295c>=FREEZED_ROW){
var _295a=getRowTop(FREEZED_ROW)-getRowTop(info.getStartRow());
}
}
while((requiredCellHeight-getRowHeight(currRowOfCellfield))>cellContentHeight){
var _295d=getRowHeight(currRowOfCellfield);
if((requiredCellHeight-_295d)<_295a){
contentNotReachedMaximumheight=true;
break;
}
requiredCellHeight-=_295d;
currRowOfCellfield-=1;
}
}
function increaseRequiredCellFieldHeight(){
if(contentNotReachedMaximumheight){
if(ISFREEZED){
var info=ActiveCellInfo;
var _295f=info.getStartRow();
var _2960=info.getEndRow();
var _2961=getRowTop(FREEZED_ROW)-getRowTop(ActiveCellInfo.getStartRow());
if(_295f<FREEZED_ROW&&_2960>=FREEZED_ROW){
if(_2961<=requiredCellHeight){
contentNotReachedMaximumheight=false;
return;
}
}
}
while(cellContentHeight>requiredCellHeight){
if(isRowExceedsMaxRow(currRowOfCellfield)){
currRowOfCellfield+=1;
if(!isCellFieldContentOverflowsViewPortHeight(currRowOfCellfield)){
var _2962=getRowHeight(currRowOfCellfield);
if(ISFREEZED){
if(_295f<FREEZED_ROW&&_2960>=FREEZED_ROW){
if((requiredCellHeight+_2962)>_2961){
contentNotReachedMaximumheight=false;
break;
}
}
}
requiredCellHeight+=_2962;
}else{
scrollTopCellField();
contentNotReachedMaximumheight=false;
break;
}
}else{
scrollTopCellField();
contentNotReachedMaximumheight=false;
break;
}
}
}else{
scrollTopCellField();
}
}
function increaseRequiredCellFieldWidth(){
if(contentNotReachedMaximumWidth){
while(cellContentWidth>requiredCellWidth){
if(isColExceedsMaxColumn(currColOfCellfield)){
currColOfCellfield+=1;
if(!isCellFieldContentOverflowsViewPortWidth(currColOfCellfield)){
requiredCellWidth+=getColWidth(currColOfCellfield);
}else{
requiredCellWidth=sheetWidthMaxInViewPort-getColLeft(currCol);
wrapCellFieldValue("INCREASEWIDTH");
break;
}
}else{
wrapCellFieldValue("INCREASEWIDTH");
break;
}
}
}
}
function decreaseRequiredCellFieldWidth(){
while((requiredCellWidth-getColWidth(currColOfCellfield))>cellContentHeight){
requiredCellWidth-=getColWidth(currColOfCellfield);
currColOfCellfield-=1;
}
}
function scrollTopCellField(){
var _2963="";
if(isEditingInExprField){
_2963=cellField.value.substring(0,posOfCaret);
}else{
_2963=exprField.value.substring(0,posOfCaret);
}
if(!isTextWrapped){
scrolledHeightForCellField=getCellContentHeightForMultiline(_2963);
}else{
dummyTextArea.value=_2963;
scrolledHeightForCellField=dummyTextArea.scrollHeight+contentHeight;
}
cellField.scrollTop=scrolledHeightForCellField;
}
function getWrappedCellFieldHeight(event){
cellContentHeight=dummyTextArea.scrollHeight;
if(browser_ie&&event=="SCROLLSHEET"){
cellContentHeight=dummyTextArea.scrollTop+19;
}
if(event=="NORMAL"){
cellContentHeight+=contentHeight;
}
if(cellContentHeight>parseInt(cellField.style.height)){
increaseRequiredCellFieldHeight();
}else{
decreaseRequiredCellFieldHeight();
}
}
function wrapCellFieldValue(event){
if(isEditingInExprField){
dummyTextArea.value=cellField.value;
}else{
dummyTextArea.value=exprField.value;
}
setDummyTextAreaStyles();
getWrappedCellFieldHeight(event);
isTextWrapped=true;
contentNotReachedMaximumWidth=false;
setCellFieldSPANHeight(requiredCellHeight);
}
function setCaretPositionInCellField(){
if(isCellEdited()||isEditingInExprField){
if(isEditingInExprField){
setCaretPos(exprField,posOfCaret);
}else{
setCaretPos(cellField,posOfCaret);
}
}
}
function setMaxDimInViewPort(){
sheetWidthMaxInViewPort=getSheetWidth()+getSheetScrollLeft();
sheetHeightMaxInViewPort=getSheetHeight()+getSheetScrollTop();
}
function AdjustScrollInIE(){
var _2966=1000;
if(browser_ie){
dummyTextArea.value=exprField.value;
dummyTextArea.scrollTop=_2966;
}
}
function afterResetSheetDimension(event){
if(isCellEdited()||isEditingInExprField){
exprField.value=cellField.value;
}
if(isCellEdited()){
setMaxDimInViewPort();
if(!isCellWrapped(currCell)){
if(event=="SCROLL"){
if(!contentNotReachedMaximumWidth){
requiredCellWidth=sheetWidthMaxInViewPort-findCellLeft(currCell)-(V_SCROLLBAR_WIDTH-1);
if(requiredCellWidth+getColLeft(currCol)<=getSheetTableWidth()){
setCellFieldSPANWidth(requiredCellWidth);
}
AdjustScrollInIE();
wrapCellFieldValue("SCROLLSHEET");
}
}else{
requiredCellWidth=sheetWidthMaxInViewPort-findCellLeft(currCell)-(V_SCROLLBAR_WIDTH-1);
if((requiredCellWidth+getColLeft(currCol))<=getSheetTableWidth()){
setCellFieldSPANWidth(requiredCellWidth);
}
AdjustScrollInIE();
wrapCellFieldValue("SCROLLSHEET");
}
}
}
}
function addLineBreak(_2968){
if(_2968=="CELLFIELD"){
setCellFieldHeight("NORMAL","CELLFIELD");
cellField.value=cellField.value.substring(0,startPosOfSelection)+"\n"+cellField.value.substring(endPosOfSelection,cellField.value.length);
exprField.value=cellField.value;
if(browser_ie&&(posOfCaret+2)!=cellField.value.length){
posOfCaret-=getCountOfOccrnceOfCharInStr(cellField.value.substring(0,posOfCaret),"\n");
}
(browser_opera)?setCaretPos(cellField,posOfCaret+2):setCaretPos(cellField,posOfCaret+1);
scrolledHeightForExprField=EXPRCONTENTHEIGHT*cellField.value.split("\n").length;
exprField.scrollTop=scrolledHeightForExprField;
if(!contentNotReachedMaximumheight){
cellField.scrollTop=scrolledHeightForCellField;
}
}else{
exprField.value=exprField.value.substring(0,startPosOfSelection)+"\n"+exprField.value.substring(endPosOfSelection,exprField.value.length);
cellField.value=exprField.value;
scrolledHeightForExprField=EXPRCONTENTHEIGHT*cellField.value.split("\n").length;
exprField.scrollTop=scrolledHeightForExprField;
if(isCellFieldInEditMode()){
setCellFieldHeight("NORMAL","EXPRFIELD");
}else{
if(isCellFieldInNewMode()){
scrolledHeightForCellField=getCellContentHeightForMultiline(exprField.value);
cellField.scrollTop=scrolledHeightForCellField;
cellField.scrollLeft=0;
}
}
if(browser_ie&&(posOfCaret+2)!=exprField.value.length){
var count=getCountOfOccrnceOfCharInStr(exprField.value.substring(0,posOfCaret),"\n");
posOfCaret-=count;
}
(browser_opera)?setCaretPos(exprField,posOfCaret+2):setCaretPos(exprField,posOfCaret+1);
}
}
function setCellFieldSPAN(){
var _296a=cellField.style.top;
var _296b=cellField.style.left;
if(ISFREEZED){
var _296c=cellField.id;
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
var _2970=FREEZED_ROW;
var _2971=FREEZED_COL;
var _2972=sheetScrollInfo;
if(row<_2970&&col<_2971){
cellField=getObj("cF1");
cellField.style.left="0px";
cellField.style.top="0px";
}else{
if(row<_2970&&col>=_2971){
cellField=getObj("cF2");
if(_296c=="cF"){
cellField.style.left=_296b;
}else{
var _2973=findSecondPaneXPos();
cellField.style.left=addSTDMode(_2972.scrollLeft+~~((getSheetWidth()-_2973)/2)+_2973);
}
}else{
if(row>=_2970&&col<_2971){
cellField=getObj("cF3");
if(_296c=="cF"){
cellField.style.top=_296a;
}else{
var _2974=findThirdPaneYPos();
cellField.style.top=addSTDMode(_2972.scrollTop+~~((getSheetPaneHeight()-_2974)/2)+_2974);
}
}else{
cellField=getObj("cF");
if(_296c=="cF2"){
cellField.style.left=_296b;
}else{
var _2973=findSecondPaneXPos();
cellField.style.left=addSTDMode(_2972.scrollLeft+~~((getSheetWidth()-_2973)/2)+_2973);
}
if(_296c=="cF3"){
cellField.style.top=_296a;
}else{
var _2974=findThirdPaneYPos();
cellField.style.top=addSTDMode(_2972.scrollTop+~~((getSheetPaneHeight()-_2974)/2)+_2974);
}
}
}
}
}else{
cellField=getObj("cF");
if(cellField){
cellField.style.left=_296b;
cellField.style.top=_296a;
}
}
cellFieldSPAN=cellField;
setFocusInCellField();
}
function showCellFieldSPAN(){
}
function hideCellFieldSPAN(){
hideCellField();
isF2KeyPressed=false;
isDblClicked=false;
}
function showFocusDIV(){
var block="block";
if(ISFREEZED){
if(isRowsOnlyFreezed){
focusDIV2.style.display=block;
}else{
if(isColsOnlyFreezed){
focusDIV3.style.display=block;
}else{
if(isColsAndRowsFreezed){
focusDIV1.style.display=block;
focusDIV2.style.display=block;
focusDIV3.style.display=block;
}
}
}
}
focusDIV.style.display=block;
}
function hideFocusDIV(){
var none="none";
if(ISFREEZED){
focusDIV1.style.display=none;
focusDIV2.style.display=none;
focusDIV3.style.display=none;
}
focusDIV.style.display=none;
}
function isCellFieldSPANHided(){
if(cellField){
if(isUndefined(isCellFieldSPANHided.isHided)){
isCellFieldSPANHided.isHided=true;
}
return isCellFieldSPANHided.isHided;
}
}
function hideCellField(){
cellField.value="";
cellField.className=" cF";
cellField.style.backgroundColor="transparent";
cellField.style.color="transparent";
cellField.style.zIndex=-1;
diminishCellField();
var _2977=findThirdPaneYPos();
var _2978=getSheetScrollTop()+parseInt((getSheetPaneHeight()-_2977)/2)+_2977;
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
var _297c=getSheetPane(row,col);
if(_297c==3||_297c==4){
cellField.style.top=addSTDMode(_2978);
}
var _297d=findSecondPaneXPos();
var _297e=getSheetScrollLeft()+parseInt((getSheetWidth()-_297d)/2)+_297d;
if(_297c==2||_297c==4){
cellField.style.left=_297e+"px";
}
setFocusInCellField();
isCellFieldSPANHided.isHided=true;
}
function diminishCellField(){
var _297f="0px";
if(browser_safari){
_297f="1px";
}
cellField.style.width=_297f;
cellField.style.height=_297f;
}
function resetCellFieldPosition(){
var _2980=getSheetScrollTop();
var _2981=findThirdPaneYPos();
var _2982=_2980+parseInt((getSheetPaneHeight()-_2981)/2)+_2981+"px";
if(!isCellFieldSPANHided()){
if(getRowTop(currRow)+getRowHeight(currRow)>_2980||(getRowTop(currRow))<getSheetPaneHeight()+_2980){
var _2983={width:ActiveCellInfo.getWidth(),left:ActiveCellInfo.getLeft(),height:ActiveCellInfo.getHeight(),top:ActiveCellInfo.getTop()};
_2982=cellField.style.top=_2983.top+"px";
cellField.style.zIndex=3;
}else{
cellField.style.zIndex=-1;
}
}
if(cellField.id=="cF"||cellField.id=="cF3"){
cellField.style.top=_2982;
}
var _2984=getSheetScrollLeft();
var _2985=findSecondPaneXPos();
var _2986=_2984+parseInt((getSheetWidth()-_2985)/2)+_2985+"px";
if(!isCellFieldSPANHided()){
if(getColLeft(currCol)+getColWidth(currCol)>_2984||(getColLeft(currCol))<getSheetWidth()+_2984){
var _2983={width:ActiveCellInfo.getWidth(),left:ActiveCellInfo.getLeft(),height:ActiveCellInfo.getHeight(),top:ActiveCellInfo.getTop()};
_2986=cellField.style.left=_2983.left+"px";
cellField.style.zIndex=3;
}else{
cellField.style.zIndex=-1;
}
}
if(cellField.id=="cF"||cellField.id=="cF2"){
cellField.style.left=_2986;
}
}
function submitCell(isCSE){
if(isEditorClosed||!isSSActive||!READ_WRITE){
return;
}
if(getCellContent(currCell,"fn")=="hide"&&jsPUBLIC_VIEW&&!showFormulas){
resetGlobalVariables();
return;
}
formulaSyntaxTip.hideMe();
var _2988="";
isRangeSelection=false;
if(tempFocusRow!=""&&tempFocusCol!=""){
focusCell(tempFocusRow,tempFocusCol);
tempFocusRow="";
tempFocusCol="";
}
if(isEditingInExprField){
_2988=exprField.value;
}else{
_2988=cellField.value;
}
if(!isNaN(parseInt(_2988))&&currCell){
currCell.style.justify="right";
}
var val=_2988;
if(browser_opera){
if(val=="\r\n"){
val="";
}
}
if(!jsTHROWAWAY_VIEW&&DOCUMENT_ID=="doc_id"&&(val.indexOf("=stock(")!=-1||val.indexOf("=STOCK(")!=-1)){
SAVED=false;
saveForward="submitCell";
autosave();
tempFocusRow=currRow;
tempFocusCol=currCol;
return;
}
if(!isCSE){
isCSE=false;
}
if(isPartOfArray(currRow,currCol,currRow,currCol)&&!isCSE){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return false;
}else{
clearOldArrayPosition(currRow,currCol,currRow,currCol);
}
if(isCSE){
var _298a=getCellRange();
startRow=_298a.startRow;
startColumn=_298a.startCol;
endRow=_298a.endRow;
endColumn=_298a.endCol;
if(!isPartOfArray(startRow,startColumn,endRow,endColumn)){
if(cellRangeContainsMergeCells(startRow,startColumn,endRow,endColumn)){
showAlertDialog(jsTitleMsg.ArrayFormulasAreNotValidInMergedCells);
return false;
}
clearOldArrayPosition(startRow,startColumn,endRow,endColumn);
}else{
if(startRow!=endRow||startColumn!=endColumn){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}else{
var obj=getArray(startRow,startColumn);
if(obj!=null){
startRow=obj[0];
endRow=obj[1];
startColumn=obj[2];
endColumn=obj[3];
}
clearOldArrayPosition(startRow,startColumn,endRow,endColumn);
}
}
}
var hyp=(currCell)?currCell.getAttribute("hyper"):null;
if(hyp=="full"){
document.cellform.tmpData.value=hyp;
}else{
document.cellform.tmpData.value="";
}
document.cellform.cellValue.value=doit(val,true);
if(!editedFormulaCellInfo.isOtherSheet){
document.cellform.column.value=ActiveCellInfo.getStartCol();
document.cellform.row.value=ActiveCellInfo.getStartRow();
cellRangeStartRow=currRow;
cellRangeStartCol=currCol;
cellRangeEndRow=currRow;
cellRangeEndCol=currCol;
if(jsPUBLIC_VIEW){
setCellContent(currCell,val);
if(ISFREEZED){
var _298d;
if(FREEZED_ROW>0){
_298d=getCell(currRow,currCol,sheetPane2Id);
setCellContent(_298d,val);
}
if(FREEZED_COL>0){
_298d=getCell(currRow,currCol,sheetPane3Id);
setCellContent(_298d,val);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_298d=getCell(currRow,currCol,sheetPane1Id);
setCellContent(_298d,val);
}
}
}
var _298e=replace(val,"\n","<br>");
var _298f=false;
if(!isNaN(_298e)){
_298f=true;
}
if(_298f&&currCell){
var _2990=currCell.className;
if(getCSSStyleRegex("textAlign").exec(_2990)==null){
setCellClass(currCell,"tar");
}
}
setCellContent(currCell,val);
if(ISFREEZED){
var _298d;
if(FREEZED_ROW>0){
_298d=getCell(currRow,currCol,sheetPane2Id);
if(_298d){
if(_298f){
var _2990=_298d.className;
if(getCSSStyleRegex("textAlign").exec(_2990)==null){
setCellClass(_298d,"tar");
}
}
setCellContent(_298d,val);
}
}
if(FREEZED_COL>0){
_298d=getCell(currRow,currCol,sheetPane3Id);
if(_298d){
if(_298f){
var _2990=_298d.className;
if(getCSSStyleRegex("textAlign").exec(_2990)==null){
setCellClass(_298d,"tar");
}
}
setCellContent(_298d,val);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_298d=getCell(currRow,currCol,sheetPane1Id);
if(_298d){
if(_298f){
var _2990=_298d.className;
if(getCSSStyleRegex("textAlign").exec(_2990)==null){
setCellClass(_298d,"tar");
}
}
setCellContent(_298d,val);
}
}
}
}
if(isMultilineInCellField()&&!isCellWrapped(currCell)){
var _2991=getMaxLineWidth(_2988.split("\n"));
var info=ActiveCellInfo;
var _2993=info.getStartCol();
if(info.isMerged()){
var _2994=getCellWidth(currCell);
_2991=(_2991>_2994)?(parseInt(getColHead(_2993).style.width)+(_2991-_2994)):0;
}
if(parseInt(getColHead(_2993).style.width)<_2991+10){
setSheetColumnWidth(_2993,_2991+10);
document.cellform.colWidth.value=getActualWidthHeight(_2991+10,"Column");
}else{
document.cellform.colWidth.value="";
}
document.cellform.rowHeight.value="";
}else{
document.cellform.colWidth.value="";
document.cellform.rowHeight.value="";
}
var _2995=getAvailableStartRow();
var _2996=getAvailableEndRow();
document.cellform.actionMode.value="Submit";
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.availableStartRow.value=_2995;
document.cellform.availableEndRow.value=_2996;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
document.cellform.totCols.value=totCols;
document.cellform.isCSE.value=isCSE;
if(isCSE){
document.cellform.startRow.value=startRow;
document.cellform.startColumn.value=startColumn;
document.cellform.endRow.value=endRow;
document.cellform.endColumn.value=endColumn;
}
if(FREEZED_ROW>0&&_2995>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
if($("#fileName")!=null){
document.cellform.tmpSheet.value=encodeURIComponent($("#fileName").text());
}
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2997=getObj("apiKey");
if(_2997!=null){
document.cellform.apiKeyId.value=_2997.value;
}
}
if(editedFormulaCellInfo.isOtherSheet){
document.cellform.currentSheet.value=editedFormulaCellInfo.cellFieldDetails.ACTUAL_FORMULA_SHEET;
document.cellform.currentSelection.value=getCurrentSelection();
document.cellform.column.value=editedFormulaCellInfo.cellFieldDetails.COLUMN;
document.cellform.row.value=editedFormulaCellInfo.cellFieldDetails.ROW;
editedFormulaCellInfo={"isOtherSheet":false,"cellFieldDetails":{}};
cellField.value="";
handleRequest(document.cellform.action,updateCell,document.cellform,true,"POST","",false);
}else{
document.cellform.currentSheet.value=CURRSHEETNAME;
setCellContent(currCell,val);
editedFormulaCellInfo={"isOtherSheet":false,"isSameSheet":false,"cellFieldDetails":{}};
cellField.value="";
importxmlForForm(document.cellform,updateCell,true);
}
resetGlobalVariables();
var info=ActiveCellInfo;
if((info.getEndRow()+1)===totRows){
appendBlankRows();
}
}
function updateCell(_2998,_2999,_299a,val,_299c,_299d){
if(_2999>12000||_2999==0){
handleServerError("ERROR","ConnectionLost",true,true);
return;
}
if(_2999>=300){
errorAlert(_2999,_299a);
return;
}
if(_2998==null||typeof _2998=="undefined"){
recalculate("",true);
return;
}
if(!_2998.hasChildNodes()){
recalculate("",true);
return;
}
if(!_299d){
findResetVariables();
}
var _299e=new Array();
var _299f=null;
var _29a0=null;
var _29a1=null;
var _29a2=null;
var _29a3=null;
var _29a4=null;
var _29a5=null;
var _29a6=null;
var _29a7=null;
var _29a8=null;
var _29a9=null;
var _29aa=null;
var _29ab=null;
var _29ac=null;
var _29ad=null;
var _29ae=null;
var _29af="false";
var _29b0=null;
var _29b1=null;
var docid=null;
var _29b3=false;
var link=null;
var _29b5=null,_29b6,_29b7,_29b8,_29b9;
var _29ba;
var _29bb=-1;
var _29bc=-1;
var _29bd=-1;
var _29be=-1;
var _29bf=null;
var _29c0=[];
var _29c1=false;
if(val!="formulas"&&val!="callBack"&&val!="copyToClip"){
if(READ_WRITE){
btn_enabled();
}
}
if(val){
var value=val.toUpperCase().trim();
if(value=="INSERTROW"||value=="INSERTCOL"||value=="DELETEROW"||value=="DELETECOL"||value=="INSERTCUTROWS"||value=="INSERTCUTCOLS"){
getCharts(DOCUMENT_ID,CURRSHEETNAME,"REGENERATE");
}
}
var _29c3=true;
if(val=="DEFINENAME"){
_29c3=_2998.hasChildNodes();
}else{
_29c3=_2998.firstChild.hasChildNodes();
}
if(_29c3){
if(val=="DEFINENAME"){
var _29c4=_2998.childNodes;
}else{
var _29c4=_2998.firstChild.childNodes;
}
for(var x=0;x<_29c4.length;x++){
node=_29c4.item(x);
switch(node.nodeName){
case "ack":
acknowledgeFunc(node.childNodes[0].nodeValue);
break;
case "error":
if(showErrorPanelMsg==node.firstChild.nodeValue){
handleServerError("ERROR",node.firstChild.nodeValue,true);
return;
}else{
if(node.firstChild.nodeValue=="UndoFailed"||node.firstChild.nodeValue=="SortingFailed"){
if((jsNEW_DOC_VIEW||jsSHARE_VIEW||jsOPEN_DOC_VIEW)&&(DOCUMENT_ID&&DOCUMENT_ID!=""&&DOCUMENT_ID!="doc_id")){
var _29c6=replaceParams(jsMsg["ErrorPanel.reopen"],new Array("<a onclick='javascript:loadDocument(\""+DOCUMENT_ID+"\");' href='#'>","</a>"));
handleServerError("ERROR",jsMsg["ErrorPanel.MainContent"]+" "+_29c6,true);
}else{
handleServerError("ERROR",jsMsg["ErrorPanel.MainContent"]+" "+jsTitleMsg.KindlyReopenFileAndTryAgain,true);
}
}else{
if(node.firstChild.nodeValue=="ConnectionLost"){
var msg=replaceParams(jsMsg["ErrorPanel.ConnectionLost"],new Array("<a onclick='javascript:loadDocument(\""+DOCUMENT_ID+"\", \"\", \"\", \"fsm\");' href='#'>","</a>"));
handleServerError("ERROR",msg,true,false);
}else{
showAlertDialog(node.firstChild.nodeValue);
}
}
}
break;
case "afterRTC":
_29af=node.firstChild.nodeValue;
break;
case "focus":
if(node.attributes){
var _29c8=node.attributes;
for(var cnt=0;cnt<_29c8.length;cnt++){
var _29ca=_29c8.item(cnt);
switch(_29ca.nodeName){
case "type":
_29b5=_29ca.nodeValue;
break;
case "startRow":
_29b6=parseInt(_29ca.nodeValue);
break;
case "endRow":
_29b8=parseInt(_29ca.nodeValue);
break;
case "startCol":
_29b7=parseInt(_29ca.nodeValue);
break;
case "endCol":
_29b9=parseInt(_29ca.nodeValue);
break;
}
}
}
if(_29b6==_29b8&&_29b7==_29b9){
_29b5="cell";
}
break;
case "undo":
var _29cb=updateUndoRangeJson(node.childNodes[0].nodeValue,_299d);
if(_29cb){
return;
}
break;
case "hiddenInfo":
var _29cc=JSON.parse(node.childNodes[0].nodeValue);
updateHiddenRowData(_29cc.row,_29cc.data);
clearHiddenRowFormulas=true;
return;
case "engine":
var add="";
var _29ce="";
var _29cf="";
var _29d0="";
var attrs=node.attributes;
for(var i=0;i<attrs.length;i++){
var _29ca=attrs.item(i);
switch(_29ca.nodeName){
case "docid":
DOCUMENT_ID=_29ca.nodeValue;
FILE_FORMAT=".ods";
break;
case "add":
add=_29ca.nodeValue;
break;
case "rename":
_29ce=_29ca.nodeValue;
break;
case "isPublic":
_29d0=_29ca.nodeValue;
break;
case "tempPublicDocId":
tempPublicDocId=_29ca.nodeValue;
break;
}
}
if(_29d0=="true"){
isInOOMode=true;
}else{
_29cf=node.firstChild.nodeValue;
var _29d3=false;
if(_29cf!=DOCUMENT_NAME){
_29d3=true;
}
DOCUMENT_NAME=_29cf;
if($("#fileName")!=null){
$("#fileName").text(DOCUMENT_NAME);
}
btn_disabled();
}
isEngineSupported=false;
break;
case "namedranges":
var _29d4=node.firstChild.nodeValue;
if(_29d4!=null){
_29d4=eval(_29d4);
if(_29d4!=null&&_29d4!=""){
for(var n=0;n<_29d4.length;n++){
var _29d6=_29d4[n];
updateNamedRanges(_29d6.a,_29d6.n,true,null,_29d6.sr,_29d6.sc,_29d6.er,_29d6.ec,_29d6.s);
}
}
}
break;
case "arrayFormula":
var _29d7=eval("("+(node.childNodes[0].nodeValue)+")");
if(!isUndefined(_29d7[0].ARRAYDETAILS)){
var arr=_29d7[0].ARRAYDETAILS;
if(typeof (arr)=="string"&&arr=="EMPTY"){
arrayDetails=new Array();
}else{
arrayDetails=arr;
}
}
break;
case "border":
if(node.attributes){
var _29ad;
var _29c8=node.attributes;
for(var cnt=0;cnt<_29c8.length;cnt++){
var _29ca=_29c8.item(cnt);
switch(_29ca.nodeName){
case "action":
_29ad=_29ca.nodeValue;
break;
case "startRow":
_29bb=parseInt(_29ca.nodeValue);
break;
case "endRow":
_29bd=parseInt(_29ca.nodeValue);
break;
case "startCol":
_29bc=parseInt(_29ca.nodeValue);
break;
case "endCol":
_29be=parseInt(_29ca.nodeValue);
break;
}
}
if(_29ad=="clearBorders"){
clearBorder(_29bb,_29bc,_29bd,_29be);
}
}
break;
case "rowcol":
var index,count,_29ad,size;
if(node.attributes){
var _29c8=node.attributes;
for(var cnt=0;cnt<_29c8.length;cnt++){
var _29ca=_29c8.item(cnt);
switch(_29ca.nodeName){
case "index":
index=parseInt(_29ca.nodeValue);
break;
case "count":
count=parseInt(_29ca.nodeValue);
break;
case "action":
_29ad=_29ca.nodeValue;
break;
case "size":
size=parseInt(_29ca.nodeValue);
break;
}
}
}
switch(_29ad){
case "insertcol":
insertCol("before",index,1,false,true,true,size);
break;
case "insertrow":
Row.executeShiftOperation("INSERT","above",index,1,false,true,true,size);
break;
case "deleterow":
Row.executeShiftOperation("DELETE",index,count,true,true);
break;
case "deletecol":
deleteCol(index,count,true,true);
break;
}
break;
case "resize":
var index,count,_29ad,size;
if(node.attributes){
var _29c8=node.attributes;
for(var cnt=0;cnt<_29c8.length;cnt++){
var _29ca=_29c8.item(cnt);
switch(_29ca.nodeName){
case "index":
index=parseInt(_29ca.nodeValue);
break;
case "count":
count=parseInt(_29ca.nodeValue);
break;
case "action":
_29ad=_29ca.nodeValue;
break;
case "size":
size=parseInt(_29ca.nodeValue);
break;
}
}
}
switch(_29ad){
case "col":
_29bc=index;
_29be=index;
WIDTHHEIGHTUNDO=true;
width_height_action("width",size,index,index);
break;
case "row":
_29bb=index;
_29bd=index;
WIDTHHEIGHTUNDO=true;
width_height_action("height",size,index,index);
break;
}
break;
case "merge":
case "split":
if(node.attributes){
var _29c8=node.attributes;
for(var cnt=0;cnt<_29c8.length;cnt++){
var _29ca=_29c8.item(cnt);
switch(_29ca.nodeName){
case "startRow":
_29bb=parseInt(_29ca.nodeValue);
break;
case "endRow":
_29bd=parseInt(_29ca.nodeValue);
break;
case "startCol":
_29bc=parseInt(_29ca.nodeValue);
break;
case "endCol":
_29be=parseInt(_29ca.nodeValue);
break;
}
}
if(node.nodeName=="merge"){
mergeCells(_29bb,_29bc,_29bd,_29be,true,true,true);
}else{
splitCells(_29bb,_29bc,_29bd,_29be,true,true);
}
}
break;
case "height":
if(Filter.hasFilter&&_29c1){
Filter.reloadView(node.childNodes[0].nodeValue,_299d);
}else{
setRowsHeightAndModifyDOM(node.childNodes[0].nodeValue,_29c1);
}
break;
case "width":
setWidthThroughJson(node.childNodes[0].nodeValue);
focusSheet();
break;
case "actionSpecificInfo":
var _29dc=parseJSON(node.childNodes[0].nodeValue);
var _29dd=_29dc.rH;
var fC=_29dc.fC;
var range=_29dc.fRange;
var _29e0=_29dc.sN;
var _29e1=false;
if(_29e0===CURRSHEETNAME){
if(_29dd){
if(!Filter.isApplied()){
setRowsHeightAndModifyDOM(_29dd,true);
}else{
Filter.reloadView(_29dd,_299d);
}
_29e1=true;
}
if(_29dc.ifr||_29dc.reConstructIcons){
Filter.remove();
if(range){
Filter.create(_29e0,range,fC);
}
}else{
if(range){
if(_29dc.ifc||_29dc.ifm){
Filter.remove();
Filter.create(_29e0,range,fC);
}else{
var _29e2=Filter.getInstance();
if(_29e2){
_29e2.setRange(range);
}
}
}
}
}
if(_29dc.action==ActionConstants.DELETE_ROW){
Row.executeShiftOperationCallback("DELETE",_29dc);
}else{
if(_29dc.action==ActionConstants.INSERT_ROW){
Row.executeShiftOperationCallback("INSERT",_29dc);
}else{
if(_29dc.action===ActionConstants.INSERT_CUT_ROW){
Row.executeShiftOperationCallback("INSERT_CUT_ROWS",_29dc);
}else{
if(_29dc.action===ActionConstants.INSERT_COPY_ROW){
Row.executeShiftOperationCallback("INSERT_COPIED_ROWS",_29dc);
}else{
if(_29dc.a===ActionConstants.HIDE_ROWS||_29dc.a===ActionConstants.UNHIDE_ROWS){
updateTileCallbackInfo.isCallbackAvailable=true;
var _29e3=_29dc.rangeJSON;
updateTileCallbackInfo.actionDetails={"callbackMethod":function(){
focusCellRange(_29e3.sr,_29e3.sc,_29e3.er,_29e3.ec,undefined,true);
}};
setRowsHeightAndModifyDOM(_29dc.heightJSON,true);
callFocusSheet=false;
}
}
}
}
}
if(_29e1){
return;
}
break;
case "filterInfo":
var _29dc=parseJSON(node.childNodes[0].nodeValue);
var _29ad=_29dc.action;
var _29e0=_29dc.sn;
var _29dd=_29dc.rh;
var fC=_29dc.fc;
var range=_29dc.range;
var _29e4=_29dc.reconstruct;
if(_29e0==CURRSHEETNAME){
if(_29dd){
if(!Filter.isApplied()){
setRowsHeightAndModifyDOM(_29dd,true);
}else{
Filter.reloadView(_29dd,_299d);
}
}
if(_29ad==ActionConstants.UPDATE_FILTER_RANGE){
if(_29e4){
Filter.remove();
Filter.create(_29e0,range,fC);
if(_29dc.ifr&&!_29dc.ifc){
Filter.remove();
}
}else{
var _29e2=Filter.getInstance();
if(_29e2&&range){
_29e2.setRange(range);
}
}
}else{
if(_29dc.ifr){
Filter.remove();
}
if(_29dc.ifc||fC){
Filter.create(_29dc.sn,range,fC);
}
}
}
break;
case "sheet":
if(node.attributes){
var _29c8=node.attributes;
if(_29c8!=null&&_29c8.length>0){
for(var cnt=0;cnt<_29c8.length;cnt++){
var _29ca=_29c8.item(cnt);
switch(_29ca.nodeName){
case "action":
_29ad=_29ca.nodeValue;
break;
case "name":
_29b0=_29ca.nodeValue;
break;
case "docid":
docid=_29ca.nodeValue;
break;
case "commentsUpdate":
_29b3=(_29ca.nodeValue=="true");
break;
case "afterRTC":
_299d=_29ca.nodeValue;
break;
case "cutsheetname":
_29b1=_29ca.nodeValue;
break;
case "bridgeNum":
if(_29ca.nodeValue!=""&&_29ca.nodeValue!="null"){
bridgeNumber=_29ca.nodeValue;
}
break;
case "row":
var _29e5=parseInt(_29ca.nodeValue);
break;
case "totCols":
var _29e6=_29ca.nodeValue;
break;
case "cnt":
var _29e7=_29ca.nodeValue;
break;
}
}
if(_29ad=="DeleteRow"){
}else{
if(_29ad=="InsertRow"){
}else{
if(_29ad=="DeleteCol"){
readRangeDetails(getAvailableStartRow(),_29e6,getAvailableEndRow(),_29e6+_29e7);
}
}
}
}
}
if(_29b0==CURRSHEETNAME){
if(node.hasChildNodes()){
var _29e8=0;
var _29e9=0;
var cells=node.childNodes;
for(var y=0,len=cells.length;y<len;y++){
var cell=cells.item(y);
if(cell.nodeName=="arrayFormula"){
updateArrayFormulaJson(cell.childNodes[0].nodeValue);
}else{
if(cell.nodeName=="borders"){
if(cell.nodeName.indexOf("borders")!=-1){
_29c0[_29c0.length]=cell;
}else{
if(cell.nodeName.indexOf("leftborder")!=-1){
updateBorder(cell,"borderLeft");
}else{
if(cell.nodeName.indexOf("rightborder")!=-1){
updateBorder(cell,"borderRight");
}else{
if(cell.nodeName.indexOf("topborder")!=-1){
updateBorder(cell,"borderTop");
}else{
if(cell.nodeName.indexOf("bottomborder")!=-1){
updateBorder(cell,"borderBottom");
}else{
if(cell.nodeName=="comment"){
if(cell.hasChildNodes()){
var _29ee=cell.firstChild.nodeValue;
_29ef[_29f0]=_29ee;
}
}
}
}
}
}
}
}else{
if(cell.nodeName=="reload"){
_29c1=cell.childNodes[0].nodeValue;
}else{
if(cell.nodeName=="height"){
if(Filter.hasFilter&&_29c1){
Filter.reloadView(cell.childNodes[0].nodeValue,_299d);
}else{
setRowsHeightAndModifyDOM(cell.childNodes[0].nodeValue,_29c1);
}
}else{
if(cell.nodeName=="width"){
setWidthThroughJson(cell.childNodes[0].nodeValue);
}else{
if(cell.nodeName=="webdatarow"){
var attrs=cell.attributes;
var rowNo;
var count;
var _29f2;
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
switch(attr.nodeName){
case "action":
_29f2=attr.nodeValue;
break;
case "row":
rowNo=parseInt(attr.nodeValue);
break;
case "count":
count=parseInt(attr.nodeValue);
break;
}
}
if(_29f2=="DeleteRow"){
Row.executeShiftOperation("DELETE",rowNo,count,true,true);
}else{
Row.executeShiftOperation("INSERT","below",rowNo,count,true,true,true);
}
}else{
if(cell.nodeName=="webdatacol"){
var attrs=cell.attributes;
var colNo;
var count;
var _29f2;
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
switch(attr.nodeName){
case "action":
_29f2=attr.nodeValue;
break;
case "col":
colNo=parseInt(attr.nodeValue);
break;
case "count":
count=parseInt(attr.nodeValue);
break;
}
}
if(_29f2=="DeleteCol"){
deleteCol(colNo,count,true,true);
}else{
insertCol("after",colNo,count,true,true,true,undefined,undefined,undefined,undefined,true);
}
}else{
if(cell.nodeName=="toClip"){
var attr=cell.attributes.item(0);
if(attr!=null){
showClipBoard(decodeURIComponent(replace(attr.nodeValue,"+"," ")));
}
}else{
if(cell.nodeName=="chart"){
if(_299d=="false"){
var ary=eval(cell.childNodes[0].nodeValue);
for(var j=0;j<ary.length;j++){
regenerateChart(ary[j]);
}
}
}
}
}
}
}
}
}
}
}
}
}
}
break;
case "lock":
var attrs=node.attributes;
var len=attrs.length;
var lock=false;
for(var i=0;i<len;i++){
var _29ca=attrs.item(i);
switch(_29ca.nodeName){
case "lock":
lock=_29ca.nodeValue;
break;
case "username":
if(lock){
var _29f9=replaceParams(jsMsg["Sorting.lock"],new Array(_29ca.nodeValue));
showAlertDialog(_29f9);
}
break;
}
}
break;
}
}
}
if(browser_nn6){
if(val=="DEFINENAME"){
var _29fa=(_2998.parentNode.parentNode.parentNode);
var nodes=(_29fa.evaluate("//cell",_29fa,null,XPathResult.ANY_TYPE,null));
}else{
var nodes=(_2998.evaluate("/websheet/sheet/cell",_2998,null,XPathResult.ANY_TYPE,null));
}
var _29fc=nodes.iterateNext();
}else{
if(val=="DEFINENAME"){
var _29fa=(_2998.parentNode.parentNode.parentNode);
var nodes=_2998.selectNodes("//cell");
}else{
var nodes=_2998.selectNodes("/websheet/sheet/cell");
}
var _29fc=nodes.nextNode();
}
var _29fd=[];
var _29fe=[];
var _29ff=[];
var _2a00=[];
var _2a01=[];
var _2a02=[];
var _2a03=[];
var _29ef=[];
var _2a04=[];
var _2a05=[];
var _2a06=[];
var _2a07=[];
var _2a08=[];
var _2a09=[];
var _2a0a=[];
var _2a0b=[];
var _2a0c=[];
var _2a0d=[];
var _2a0e=[];
var _2a0f=[];
var _2a10=[];
var _2a11=[];
var _2a12=[];
var _29f0=0;
var _2a13="";
var _2a14="";
while(_29fc){
var _2a15=_29fc.attributes;
if(_29fc.hasChildNodes()){
yellowflag=true;
for(var i=0;i<_2a15.length;i++){
var _2a16=_2a15[i].nodeName;
switch(_2a16){
case "column":
_29fd[_29f0]=_2a15[i].nodeValue;
break;
case "row":
_29fe[_29f0]=parseInt(_2a15[i].nodeValue);
break;
case "height":
_29ff[_29f0]=_2a15[i].nodeValue;
break;
case "width":
_2a00[_29f0]=_2a15[i].nodeValue;
break;
case "modified":
case "m":
_2a01[_29f0]=_2a15[i].nodeValue;
if(_2a15[i].nodeValue=="original"||_2a15[i].nodeValue=="o"){
yellowflag=false;
}
break;
case "format":
_2a02[_29f0]=_2a15[i].nodeValue;
break;
case "justify":
_2a03[_29f0]=_2a15[i].nodeValue;
break;
case "comment":
break;
case "backcolor":
_2a04[_29f0]=_2a15[i].nodeValue;
_2a14=_2a15[i].nodeValue;
break;
case "charcolor":
_2a05[_29f0]=_2a15[i].nodeValue;
_2a13=_2a15[i].nodeValue;
break;
case "fontweight":
_2a06[_29f0]=_2a15[i].nodeValue;
break;
case "fontstyle":
_2a07[_29f0]=_2a15[i].nodeValue;
break;
case "textdecora":
_2a08[_29f0]=_2a15[i].nodeValue;
break;
case "fontname":
_2a09[_29f0]=_2a15[i].nodeValue;
break;
case "fontsize":
_2a0a[_29f0]=_2a15[i].nodeValue;
break;
case "textwrap":
_2a0b[_29f0]=_2a15[i].nodeValue;
break;
case "vertalign":
_2a0c[_29f0]=_2a15[i].nodeValue;
break;
case "link":
_2a0d[_29f0]=_2a15[i].nodeValue;
break;
case "colspan":
_2a0e[_29f0]=_2a15[i].nodeValue;
break;
case "rowspan":
_2a0f[_29f0]=_2a15[i].nodeValue;
break;
case "strikethrou":
_2a12[_29f0]=_2a15[i].nodeValue;
break;
}
}
if(parseInt(_29fd[_29f0])>parseInt(usedCursCol)){
usedCursCol=parseInt(_29fd[_29f0]);
}
if(parseInt(_29fe[_29f0])>parseInt(usedCursRow)){
usedCursRow=parseInt(_29fe[_29f0]);
}
if(parseInt(_29fe[_29f0])>totRows-1){
Row.executeShiftOperation("INSERT","below",totRows,parseInt(_29fe[_29f0])-(totRows-1),true,true,true);
}
if(parseInt(_29fd[_29f0])>totCols-1){
insertCol("after",totCols-1,parseInt(_29fd[_29f0])-(totCols-1),true,true,true);
}
if(isRowAvailable(_29fe[_29f0])||(ISFREEZED&&_29fe[_29f0]<FREEZED_ROW)){
var elem=getCell(_29fe[_29f0],_29fd[_29f0]);
if(!elem&&val=="webData"){
Row.executeShiftOperation("INSERT","below",totRows,5,true,true,true);
elem=getCell(_29fe[_29f0],_29fd[_29f0]);
if(!elem){
insertCol("append",totCols,5,true,true,false,undefined,undefined,undefined,undefined,true);
elem=null;
}
}
if(elem){
isformula=false;
var data=_29fc.childNodes;
var _2a19=parseInt(_2a0e[_29f0]);
var _2a1a=parseInt(_2a0f[_29f0]);
var row=parseInt(_29fe[_29f0]);
var col=parseInt(_29fd[_29f0]);
var info=Merge.getCellInfo(row,col);
var _2a1e=!!info;
var _2a1f=false;
var _2a20=1;
var _2a21=1;
if(_2a1e){
_2a1f=(row!=info["startRow"]||col!=info["startCol"]);
_2a20=info.getColSpan();
_2a21=info.getRowSpan();
}
if(_2a0f[_29f0]||_2a0e[_29f0]){
var _2a22=false;
if(!_2a1f){
if((_2a19==1&&_2a1a==1)&&_2a1e){
splitCells(row,col,row,col,true,true);
_2a22=true;
}else{
if(((_2a19>1||_2a1a>1)&&!_2a1e)||(_2a19!=_2a20)||(_2a1a!=_2a21)){
mergeCells(row,col,row+_2a1a-1,col+_2a19-1,true,true,true);
_2a22=true;
}
}
}
if(_2a22){
elem=getCell(_29fe[_29f0],_29fd[_29f0]);
}
}
if(!_2a1f){
for(var a=0;a<data.length;a++){
if(_29b0!=CURRSHEETNAME||docid!=DOCUMENT_ID){
break;
}
var dnode=data.item(a);
cvalue="";
if(dnode.hasChildNodes()){
cvalue=dnode.firstChild.nodeValue;
}
if(dnode.nodeName=="formula"){
isformula=true;
if(cvalue.indexOf("=stock(")!=-1||cvalue.indexOf("=STOCK(")!=-1){
isStockConfigured=true;
}
if(elem){
elem.setAttribute("fn",cvalue);
}
if(ISFREEZED){
var _2a25;
if(FREEZED_ROW>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane2Id);
if(_2a25){
_2a25.setAttribute("fn",cvalue);
}
}
if(FREEZED_COL>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane3Id);
if(_2a25){
_2a25.setAttribute("fn",cvalue);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane1Id);
if(_2a25){
_2a25.setAttribute("fn",cvalue);
}
}
}
}else{
if(dnode.nodeName=="value"||dnode.nodeName=="errorcell"){
if(elem){
setCellContent(elem,cvalue);
}
if(ISFREEZED){
var _2a25;
if(FREEZED_ROW>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane2Id);
if(_2a25){
setCellContent(_2a25,cvalue);
}
}
if(FREEZED_COL>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane3Id);
if(_2a25){
setCellContent(_2a25,cvalue);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane1Id);
if(_2a25){
setCellContent(_2a25,cvalue);
}
}
}
var url=cvalue;
var text=cvalue;
if(_2a0d&&_2a0d.length>0){
var link=_2a0d[_29f0];
url=(typeof link=="undefined")?url:link;
if(url){
var str=constructHyperlinkString(url,getCellInnerHTML(elem),true,"",true).linkString;
var _2a29=replace(str,"\n","<br>");
if(elem){
setCellInnerHTML(elem,_2a29);
setHyperLinkStyles(elem,_2a13,_2a14);
elem.setAttribute("hyper","full");
}
if(ISFREEZED){
var _2a25;
if(FREEZED_ROW>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane2Id);
if(_2a25!=null){
setCellInnerHTML(_2a25,_2a29);
setHyperLinkStyles(_2a25,_2a13,_2a14);
_2a25.setAttribute("hyper","full");
}
}
if(FREEZED_COL>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane3Id);
if(_2a25!=null){
setCellInnerHTML(_2a25,_2a29);
setHyperLinkStyles(_2a25,_2a13,_2a14);
_2a25.setAttribute("hyper","full");
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane1Id);
if(_2a25!=null){
setCellInnerHTML(_2a25,_2a29);
setHyperLinkStyles(_2a25,_2a13,_2a14);
_2a25.setAttribute("hyper","full");
}
}
}
}
}else{
constructURL(elem,url,_2a13,_2a14);
if(ISFREEZED){
var _2a25;
if(FREEZED_ROW>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane2Id);
constructURL(_2a25,url,_2a13,_2a14);
}
if(FREEZED_COL>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane3Id);
constructURL(_2a25,url,_2a13,_2a14);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane1Id);
constructURL(_2a25,url,_2a13,_2a14);
}
}
}
if(yellowflag){
_299e.push(elem);
if(ISFREEZED){
var _2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane2Id);
if(_2a25){
_299e.push(_2a25);
}
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane3Id);
if(_2a25){
_299e.push(_2a25);
}
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane1Id);
if(_2a25){
_299e.push(_2a25);
}
}
}
}else{
if(dnode.nodeName=="encvalue"){
if(dnode.hasChildNodes()){
var _2a2a=dnode.firstChild.nodeValue;
if(_2a2a!=null){
if(elem){
elem.setAttribute("cV",_2a2a);
}
if(ISFREEZED){
var _2a25;
if(FREEZED_ROW>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane2Id);
if(_2a25){
_2a25.setAttribute("cV",_2a2a);
}
}
if(FREEZED_COL>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane3Id);
if(_2a25){
_2a25.setAttribute("cV",_2a2a);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane1Id);
if(_2a25){
_2a25.setAttribute("cV",_2a2a);
}
}
}
}
}
}else{
if(dnode.nodeName.indexOf("borders")!=-1){
updateBorder1(dnode);
}else{
if(dnode.nodeName.indexOf("leftborder")!=-1){
updateBorder(dnode,"borderLeft");
}else{
if(dnode.nodeName.indexOf("rightborder")!=-1){
updateBorder(dnode,"borderRight");
}else{
if(dnode.nodeName.indexOf("topborder")!=-1){
updateBorder(dnode,"borderTop");
}else{
if(dnode.nodeName.indexOf("bottomborder")!=-1){
updateBorder(dnode,"borderBottom");
}else{
if(dnode.nodeName=="comment"){
if(dnode.hasChildNodes()){
var _29ee=dnode.firstChild.nodeValue;
_29ef[_29f0]=_29ee;
}
}
}
}
}
}
}
}
}
}
if(!isformula){
if(elem){
elem.removeAttribute("fn");
}
if(ISFREEZED){
var _2a25;
if(FREEZED_ROW>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane2Id);
if(_2a25){
_2a25.removeAttribute("fn");
}
}
if(FREEZED_COL>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane3Id);
if(_2a25){
_2a25.removeAttribute("fn");
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_2a25=getCell(_29fe[_29f0],_29fd[_29f0],sheetPane1Id);
if(_2a25){
_2a25.removeAttribute("fn");
}
}
}
}
}
}
_2a10[_29f0]=elem;
}
}
if(browser_nn6){
_29fc=nodes.iterateNext();
}else{
_29fc=nodes.nextNode();
}
_29f0++;
}
}
for(var i=0;i<_29f0;i++){
elem=_2a10[i];
column=_29fd[i];
row=_29fe[i];
var _2a2b=_2a0f[_29f0];
if((isRowAvailable(row,_2a2b)||(ISFREEZED&&row<FREEZED_ROW))&&!Merge.isCovered(row,column)){
var _2a2c=[];
_2a2c["COMMENT"]=_29ef[i];
_2a2c["FORMAT"]=_2a02[i];
_2a2c["JUSTIFY"]=_2a03[i];
_2a2c["BACKCOLOR"]=_2a04[i];
_2a2c["CHARCOLOR"]=_2a05[i];
_2a2c["FONTWEIGHT"]=_2a06[i];
_2a2c["FONTSTYLE"]=_2a07[i];
_2a2c["TEXTDECORATION"]=_2a08[i];
_2a2c["FONTNAME"]=_2a09[i];
_2a2c["FONTSIZE"]=_2a0a[i];
_2a2c["VERTALIGN"]=_2a0c[i];
_2a2c["HLINK"]=_2a0d[i];
_2a2c["TEXTWRAP"]=_2a0b[i];
_2a2c["HEIGHT"]=_29ff[i];
_2a2c["WIDTH"]=_2a00[i];
_2a2c["STRIKETHROUGH"]=_2a12[i];
setStylesForCell(elem,row,column,_2a2c,_29ad,_29b3,_299f);
if(ISFREEZED){
if(FREEZED_ROW>0){
elem=getCell(row,column,sheetPane2Id);
setStylesForCell(elem,row,column,_2a2c,_29ad,_29b3,_299f);
}
if(FREEZED_COL>0){
elem=getCell(row,column,sheetPane3Id);
setStylesForCell(elem,row,column,_2a2c,_29ad,_29b3,_299f);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
elem=getCell(row,column,sheetPane1Id);
setStylesForCell(elem,row,column,_2a2c,_29ad,_29b3,_299f);
}
}
}
}
if(_29c0){
for(var i=0,len=_29c0.length;i<len;i++){
updateBorder1(_29c0[i]);
}
}
if(!jsTHROWAWAY_VIEW&&_2998.firstChild.hasChildNodes()){
node=_2998.firstChild.lastChild;
if(node.nodeName=="macroChanges"){
var _2a2d=node.firstChild;
if(_2a2d){
var _2a2e=_2a2d.nodeValue;
updateMacroChanges(_2a2e,true);
}
}
}
if(_29af=="false"){
if(_29b5!=null){
if(typeof _29b6=="undefined"){
_29b6=0;
}
if(typeof _29b7=="undefined"){
_29b7=0;
}
if(typeof _29b8=="undefined"){
_29b8=0;
}
if(typeof _29b9=="undefined"){
_29b9=0;
}
if(_29b5=="cell"){
focusCell(_29b6,_29b7);
}else{
if(_29b5=="cellRange"){
focusCellRange(_29b6,_29b7,_29b8,_29b9,undefined,true);
scrollCellIntoView(_29b6,_29b7);
}else{
if(_29b5=="cols"){
focusCol(_29b7,_29b9);
}else{
if(_29b5=="rows"){
focusRow(_29b6,_29b8);
}else{
if(_29b5=="sheet"){
focusAllCells();
}
}
}
}
}
}
}
if(val!="formulas"&&val!="callBack"){
try{
if(_299e.length!=0){
elemsarr[elemsarrIndex]=_299e;
fadeCells(StartFadeAt,elemsarrIndex);
elemsarrIndex++;
}
}
catch(e){
}
}
if(_29ad=="FillSeries"){
calcAutoFormulas();
}
document.getElementById("Tv").value=getCellContent();
if(val=="webData"){
autosave();
}
if(_29b1!=null&&_29b0!=_29b1){
removeSheets(_29b1);
}
if(doAutoSave){
if(jsREMOTE_SAVE_VIEW){
saveremoteGEdoc();
}else{
savefile("autosave");
}
doAutoSave=false;
}
if(doSave){
doSave=false;
savefile(saveParam);
}
focusSheet();
enableUNDO();
if(callUndo){
callUndo=false;
undo();
}else{
if(callRedo){
callRedo=false;
redo();
}
}
if(isCellRange){
var _2a2f=getCellRange();
if((_2a2f.startRow!=_2a2f.endRow)||(_2a2f.startCol!=_2a2f.endCol)){
calcAutoFormulas();
}
}
}
function setContentForCell(){
}
function setStylesForCell(elem,row,_2a32,_2a33,_2a34,_2a35,_2a36){
if(elem){
var _2a37=_2a33["COMMENT"];
var _2a38=_2a33["FORMAT"];
var _2a39=_2a33["JUSTIFY"];
var _2a3a=_2a33["BACKCOLOR"];
var _2a3b=_2a33["CHARCOLOR"];
var _2a3c=_2a33["FONTWEIGHT"];
var _2a3d=_2a33["FONTSTYLE"];
var _2a3e=_2a33["TEXTDECORATION"];
var _2a3f=_2a33["FONTNAME"];
var _2a40=_2a33["FONTSIZE"];
var _2a41=_2a33["VERTALIGN"];
var _2a42=_2a33["HLINK"];
var _2a43=_2a33["TEXTWRAP"];
var _2a44=_2a33["HEIGHT"];
var _2a45=_2a33["WIDTH"];
var _2a46=_2a33["STRIKETHROUGH"];
var _2a47=elem.className;
if(parseInt(_2a32)>parseInt(usedCursCol)){
usedCursCol=_2a32;
}
if(parseInt(row)>parseInt(usedCursRow)){
usedCursRow=row;
}
if(_2a34=="SORT"||_2a34=="FilterRangeSort"||_2a35){
elem.removeAttribute("comment");
_2a47=replace(_2a47," cC","");
}
if(typeof _2a37!="undefined"&&_2a37!=null&&_2a37!="null"){
if(_2a47.indexOf(" cC")==-1){
_2a47=_2a47+" cC";
}
elem.setAttribute("comment",_2a37);
elem.onmouseover=function(ev){
showCellComment(ev,this);
};
elem.onmouseout=function(){
hideCellComment();
};
}
if(_2a38){
if(_2a36=="STANDARD"){
elem.removeAttribute("format");
}else{
elem.setAttribute("format",_2a38);
}
}
if(typeof _2a39!="undefined"&&_2a39!=null&&_2a39!="null"){
elem.style["textAlign"]="";
var regex=getCSSStyleRegex("textAlign");
_2a47=_2a47.replace(regex,"");
if(_2a39!="left"){
if(_2a39=="right"){
_2a47=_2a47+" tar";
}else{
if(_2a39=="center"){
_2a47=_2a47+" tac";
}
}
}
}
if(_2a3a){
if(_2a3a=="rgb(255,255,255)"||_2a3a=="rgb(255, 255, 255)"){
elem.style["backgroundColor"]="";
}else{
elem.style["backgroundColor"]=_2a3a;
}
}
if(_2a3b){
if(_2a3b=="rgb(0,0,0)"||_2a3b=="rgb(0, 0, 0)"){
elem.style["color"]="";
}else{
elem.style["color"]=_2a3b;
}
}
if(_2a3c){
elem.style["fontWeight"]="";
var regex=getCSSStyleRegex("fontWeight");
_2a47=_2a47.replace(regex,"");
if(_2a3c=="bold"){
_2a47=_2a47+" fwb";
}
}
if(_2a3d){
elem.style["fontStyle"]="";
var regex=getCSSStyleRegex("fontStyle");
_2a47=_2a47.replace(regex,"");
if(_2a3d=="italic"){
_2a47=_2a47+" fsi";
}
}
if(_2a3e&&_2a46){
var regex=getCSSStyleRegex("underlineStrikethrough");
_2a47=_2a47.replace(regex,"");
}
if(_2a3e){
elem.style["textDecoration"]="";
var regex=getCSSStyleRegex("textDecoration");
_2a47=_2a47.replace(regex,"");
if(_2a3e=="underline"||_2a3e=="solid"){
_2a47=_2a47+" tdu";
}
}
if(_2a46){
elem.style["strikeThrough"]="";
var regex=getCSSStyleRegex("strikeThrough");
_2a47=_2a47.replace(regex,"");
if(_2a46=="line-through"||_2a46=="solid"){
if(_2a47.indexOf(" tdu")!=-1){
_2a47=_2a47+" tdsu";
}else{
_2a47=_2a47+" tdst";
}
}
}
if(_2a3f){
elem.style["fontFamily"]="";
var regex=getCSSStyleRegex("fontFamily");
_2a47=_2a47.replace(regex,"");
var _2a4a="";
if(_2a3f!=defultFontName){
_2a4a=getMatchedCSSFontStyle(_2a3f);
if(_2a4a==""){
elem.style["fontFamily"]=_2a3f;
}else{
_2a47=_2a47+_2a4a;
}
}
}
if(_2a40){
elem.style["fontSize"]="";
var regex=getCSSStyleRegex("fontSize");
_2a47=_2a47.replace(regex,"");
var _2a4a="";
if(_2a40!=defultFontSize){
var _2a4b=$("#fontSize");
if(_2a4b!=null){
_2a4a=getCssFontSize(_2a40);
if(_2a4a==""){
elem.style["fontSize"]=_2a40;
}else{
_2a47=_2a47+_2a4a;
}
}else{
elem.style["fontSize"]=_2a40;
}
}
}
elem.className=_2a47;
if(_2a41){
elem.style["verticalAlign"]="";
var _2a4c=getCellInnerHTML(elem);
removeCSSStyle("verticalAlign",elem);
if(_2a41=="bottom"){
setFormatforCell(elem," vab",false,"verticalAlign",_2a4c);
}else{
if(_2a41=="middle"){
setFormatforCell(elem," vam",false,"verticalAlign",_2a4c);
}else{
setFormatforCell(elem," vat",false,"verticalAlign",_2a4c);
}
}
}
if(_2a43){
if(_2a43=="wrap"){
wrapCell(elem);
}else{
if(isCellWrapped(elem)){
unWrapCell(elem);
}
}
}
if(_2a44){
if(row<totRows){
setSheetRowHeight(row,parseInt(_2a44));
}
}
if(_2a45){
if(_2a32<totCols){
setSheetColumnWidth(parseInt(_2a32),parseInt(_2a45));
}
}
valueInCell=elem.getAttribute("cV");
}
}
function updateBorder1(_2a4d){
if(_2a4d!=null&&_2a4d.hasChildNodes()){
var _2a4e=_2a4d.firstChild.nodeValue;
var _2a4f=eval(_2a4e);
var len=_2a4f.length;
var _2a51=null;
for(var x=0;x<len;x++){
var info=_2a4f[x];
var row=info.row;
var col=info.col;
var type=info.type;
var val=info.value;
_2a51=getCell(row,col);
if(_2a51){
updateCellBorder1(_2a51,val,type);
}
if(ISFREEZED){
if(FREEZED_ROW>0){
_2a51=getCell(row,col,sheetPane2Id);
if(_2a51){
updateCellBorder1(_2a51,val,type);
}
}
if(FREEZED_COL>0){
_2a51=getCell(row,col,sheetPane3Id);
if(_2a51){
updateCellBorder1(_2a51,val,type);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_2a51=getCell(row,col,sheetPane1Id);
if(_2a51){
updateCellBorder1(_2a51,val,type);
}
}
}
}
}
}
function updateCellBorder1(_2a58,val,type){
if(_2a58!=null&&_2a58!="null"){
if(!is_ie){
_2a58.style[type]="";
}else{
_2a58.style[type+"Color"]="";
_2a58.style[type+"Width"]="";
_2a58.style[type+"Style"]="";
}
if(val=="1px solid rgb(0,0,0)"||val=="1px solid #000"||val=="1px solid #000000"){
if(type=="borderBottom"){
removeCSSStyle("borderBottom",_2a58);
if(_2a58.className.indexOf(" bb1")==-1){
_2a58.className+=" bb1";
}
}else{
if(type=="borderRight"){
removeCSSStyle("borderRight",_2a58);
if(_2a58.className.indexOf(" br1")==-1){
_2a58.className+=" br1";
}
}else{
if(type=="borderTop"){
}else{
if(type=="borderLeft"){
}
}
}
}
}else{
if(val=="2px solid rgb(0,0,0)"||val=="2px solid #000"||val=="2px solid #000000"||val=="2.5px solid rgb(0,0,0)"||val=="2.5px solid #000"||val=="2.5px solid #000000"){
if(type=="borderBottom"){
removeCSSStyle("borderBottom",_2a58);
if(_2a58.className.indexOf(" bb2")==-1){
_2a58.className+=" bb2";
}
}else{
if(type=="borderRight"){
removeCSSStyle("borderRight",_2a58);
if(_2a58.className.indexOf(" br2")==-1){
_2a58.className+=" br2";
}
}else{
if(type=="borderTop"){
}else{
if(type=="borderLeft"){
}
}
}
}
}else{
if(val=="3px double rgb(0,0,0)"||val=="3px double #000"||val=="3px double #000000"){
if(type=="borderBottom"){
removeCSSStyle("borderBottom",_2a58);
if(_2a58.className.indexOf(" bbd")==-1){
_2a58.className+=" bbd";
}
}else{
if(type=="borderRight"){
removeCSSStyle("borderRight",_2a58);
if(_2a58.className.indexOf(" brd")==-1){
_2a58.className+=" brd";
}
}else{
if(type=="borderTop"){
}else{
if(type=="borderLeft"){
}
}
}
}
}else{
if(val==""){
if(type=="borderBottom"){
removeCSSStyle("borderBottom",_2a58);
}else{
if(type=="borderRight"){
removeCSSStyle("borderRight",_2a58);
}else{
if(type=="borderTop"){
}else{
if(type=="borderLeft"){
}
}
}
}
}else{
_2a58.style[type]=val;
}
}
}
}
}
}
function updateCellBorder2(_2a5b,_2a5c,_2a5d){
var _2a5e="1px solid rgb(0,0,0)";
var _2a5f="3px double rgb(0,0,0)";
var _2a60="2px solid rgb(0,0,0)";
if(_2a5b!=null&&_2a5b!="null"){
if(!is_ie){
_2a5b.style[_2a5d]="";
}else{
_2a5b.style[_2a5d+"Color"]="";
_2a5b.style[_2a5d+"Width"]="";
_2a5b.style[_2a5d+"Style"]="";
}
if(_2a5d=="borderTop"){
}else{
if(_2a5d=="borderBottom"){
if(_2a5c==_2a5e){
removeCSSStyle("borderBottom",_2a5b);
if(_2a5b.className.indexOf(" bb1")==-1){
_2a5b.className+=" bb1";
}
}else{
if(_2a5c==_2a5f){
removeCSSStyle("borderBottom",_2a5b);
if(_2a5b.className.indexOf(" bbd")==-1){
_2a5b.className+=" bbd";
}
}else{
if(_2a5c==_2a60){
removeCSSStyle("borderBottom",_2a5b);
if(_2a5b.className.indexOf(" bb2")==-1){
_2a5b.className+=" bb2";
}
}else{
if(_2a5c==""){
removeCSSStyle("borderBottom",_2a5b);
}else{
_2a5b.style[_2a5d]=_2a5c;
}
}
}
}
}else{
if(_2a5d=="borderLeft"){
}else{
if(_2a5d=="borderRight"){
if(_2a5c==_2a5e){
removeCSSStyle("borderRight",_2a5b);
if(_2a5b.className.indexOf(" br1")==-1){
_2a5b.className+=" br1";
}
}else{
if(_2a5c==_2a5f){
removeCSSStyle("borderRight",_2a5b);
if(_2a5b.className.indexOf(" brd")==-1){
_2a5b.className+=" brd";
}
}else{
if(_2a5c==_2a60){
removeCSSStyle("borderRight",_2a5b);
if(_2a5b.className.indexOf(" br2")==-1){
_2a5b.className+=" br2";
}
}else{
if(_2a5c==""){
removeCSSStyle("borderRight",_2a5b);
}else{
_2a5b.style[_2a5d]=_2a5c;
}
}
}
}
}
}
}
}
}
}
function updateBorder(_2a61,_2a62){
var _2a63=_2a61.attributes;
if(_2a63!=null&&_2a63.length>0){
var _2a64="";
var _2a65="";
var _2a66="";
var _2a67=null;
for(var i=0;i<_2a63.length;i++){
var attr=_2a63.item(i);
if(attr.nodeName=="row"){
_2a64=attr.nodeValue;
}else{
if(attr.nodeName=="column"){
_2a65=attr.nodeValue;
}else{
if(attr.nodeName=="borderValue"){
_2a66=attr.nodeValue;
}
}
}
}
_2a67=getCell(_2a64,_2a65);
updateCellBorder2(_2a67,_2a66,_2a62);
if(ISFREEZED){
if(FREEZED_ROW>0){
_2a67=getCell(_2a64,_2a65,sheetPane2Id);
updateCellBorder2(_2a67,_2a66,_2a62);
}
if(FREEZED_COL>0){
_2a67=getCell(_2a64,_2a65,sheetPane3Id);
updateCellBorder2(_2a67,_2a66,_2a62);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_2a67=getCell(_2a64,_2a65,sheetPane1Id);
updateCellBorder2(_2a67,_2a66,_2a62);
}
}
}
}
function deleteCell(_2a6a){
if(!READ_WRITE){
return;
}
if(typeof _2a6a=="undefined"){
_2a6a="ClearContent";
}
var _2a6b;
_2a6b=getCellRange();
if(_2a6a=="ClearContent"){
if(!isPartOfArray(_2a6b.startRow,_2a6b.startCol,_2a6b.endRow,_2a6b.endCol)){
clearOldArrayPosition(_2a6b.startRow,_2a6b.startCol,_2a6b.endRow,_2a6b.endCol);
}else{
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
var _2a6c=getViewPortRoundedDetails(_2a6b.startRow,_2a6b.endRow);
if(_2a6c.isInViewPort){
clearContents(_2a6c.startRowIdx,_2a6b.startCol,_2a6c.endRowIdx,_2a6b.endCol);
}
if(_2a6c.isInFreezedRange){
clearContents(_2a6c.freezedStartRowIdx,_2a6b.startCol,_2a6c.freezedEndRowIdx,_2a6b.endCol);
}
}
if(_2a6a=="ClearStyles"){
var _2a6c=getViewPortRoundedDetails(_2a6b.startRow,_2a6b.endRow);
if(_2a6c.isInViewPort){
clearFormatting(_2a6c.startRowIdx,_2a6b.startCol,_2a6c.endRowIdx,_2a6b.endCol);
}
if(_2a6c.isInFreezedRange){
clearFormatting(_2a6c.freezedStartRowIdx,_2a6b.startCol,_2a6c.freezedEndRowIdx,_2a6b.endCol);
}
}
var _2a6d=getAvailableStartRow();
var _2a6e=getAvailableEndRow();
document.cellform.startColumn.value=_2a6b.startCol;
document.cellform.endColumn.value=_2a6b.endCol;
document.cellform.startRow.value=_2a6b.startRow;
document.cellform.endRow.value=_2a6b.endRow;
currCellValue=getCellContent();
document.cellform.cellValue.value=cellField.value;
document.cellform.actionMode.value="DeleteRange";
document.cellform.formattedCellValue.value=_2a6a;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_2a6d;
document.cellform.availableEndRow.value=_2a6e;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
document.cellform.totCols.value=totCols;
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2a6f=getObj("apiKey");
if(_2a6f!=null){
document.cellform.apiKeyId.value=_2a6f.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
}
function width_height_action(act,size,_2a72,_2a73,_2a74){
var nvp="";
if(isUndefined(_2a74)){
_2a74="false";
}
switch(act){
case "width":
size=(typeof size=="undefined")?getObj("col_width").value:size;
size=parseInt(size);
if(size>0){
if(isCellRange()||typeof _2a72!="undefined"){
var pos=getCellRange();
startCol=(typeof _2a72!="undefined")?_2a72:pos.startCol;
endCol=(typeof _2a73!="undefined")?_2a73:pos.endCol;
}else{
startCol=currCol;
endCol=currCol;
}
if(ISSAMESHEET=="true"){
setSheetColumnsWidth(startCol,endCol,size);
closeDialog();
}
if(typeof startCol!="undefined"){
nvp=nvp+"startColumn="+startCol;
}
if(typeof endCol!="undefined"){
nvp=nvp+"&endColumn="+endCol;
}
nvp=nvp+"&type=col_width&value="+getActualWidthHeight(parseFloat(size),"Column");
nvp+="&startRow="+0+"&endRow="+(totRows-1);
nvp+="&actualSize="+parseFloat(size);
nvp+="&totalRows="+usedCursRow;
nvp+="&curtime="+CURRENTTIME+"&sheetname="+encodeURIComponent(CURRSHEETNAME);
}
break;
case "height":
size=(typeof size==="undefined")?getObj("row_height").value:size;
size=parseInt(size);
if(size>0){
if(isCellRange()||typeof _2a72!="undefined"){
var pos=getCellRange();
startRow=(typeof _2a72!="undefined")?_2a72:pos.startRow;
endRow=(typeof _2a73!="undefined")?_2a73:pos.endRow;
}else{
startRow=currRow;
endRow=currRow;
}
if(ISSAMESHEET=="true"){
if(browser_safari){
if(rowHead.scrollTop!=sheetPane.scrollTop){
setScrollTop(rowHead.scrollTop);
}
}
closeDialog();
}
if(typeof startCol!="undefined"){
nvp=nvp+"startColumn="+startCol;
}
if(typeof endCol!="undefined"){
nvp=nvp+"&endColumn="+endCol;
}
nvp=nvp+"&type=row_height&value="+getActualWidthHeight(parseFloat(size),"Row");
if(typeof startRow!="undefined"){
nvp=nvp+"&startRow="+startRow;
}
if(typeof endRow!="undefined"){
nvp=nvp+"&endRow="+endRow;
}
nvp+="&actualSize="+parseFloat(size);
nvp+="&totalRows="+usedCursRow;
nvp+="&curtime="+CURRENTTIME+"&sheetname="+encodeURIComponent(CURRSHEETNAME);
}else{
return;
}
break;
case "OptimalWidth":
var pos=getCellRange();
if((pos.startCol<=_2a72)&&(_2a72<=pos.endCol)&&(isColSelected()||browser_ie)){
var _2a77=pos.startCol;
var _2a78=pos.endCol;
}else{
var _2a77=_2a72;
var _2a78=_2a73;
}
if(typeof _2a77!="undefined"){
nvp=nvp+"startColumn="+_2a77;
}
if(typeof _2a78!="undefined"){
nvp=nvp+"&endColumn="+_2a78;
}
nvp=nvp+"&type=OptimalWidth&value=";
nvp+="&startRow="+0+"&endRow="+(totRows-1);
nvp+="&actualSize=";
nvp+="&totalRows="+totRows;
nvp+="&curtime="+CURRENTTIME+"&sheetname="+encodeURIComponent(CURRSHEETNAME);
break;
case "OptimalHeight":
var pos=getCellRange();
if((pos.startRow<=_2a72)&&(_2a72<=pos.endRow)&&(isRowSelected()||browser_ie)&&(pos.startCol==0&&pos.endCol==totCols-1)){
var _2a77=pos.startRow;
var _2a78=pos.endRow;
}else{
var _2a77=_2a72;
var _2a78=_2a73;
}
nvp="startColumn="+0+"&endColumn="+(totCols-1)+"&type=OptimalHeight&value=";
if(typeof _2a77!="undefined"){
nvp=nvp+"&startRow="+_2a77;
}
if(typeof _2a78!="undefined"){
nvp=nvp+"&endRow="+_2a78;
}
nvp+="&actualSize=";
nvp+="&totalRows="+usedCursRow;
nvp+="&curtime="+CURRENTTIME+"&sheetname="+encodeURIComponent(CURRSHEETNAME);
break;
case "HIDE_ROWS":
var _2a79=getCellRange();
nvp="startRow="+_2a72+"&endRow="+_2a73+"&startColumn="+_2a79.startCol+"&endColumn="+_2a79.endCol+"&type=hide";
nvp+="&totalRows="+totRows+"&curtime="+CURRENTTIME+"&sheetname="+encodeURIComponent(CURRSHEETNAME);
break;
case "UNHIDE_ROWS":
var _2a79=getCellRange();
nvp="startRow="+_2a72+"&endRow="+_2a73+"&startColumn="+_2a79.startCol+"&endColumn="+_2a79.endCol+"&type=unhide";
nvp+="&totalRows="+totRows+"&curtime="+CURRENTTIME+"&sheetname="+encodeURIComponent(CURRSHEETNAME);
break;
default:
break;
}
nvp+="&fromUNDO="+WIDTHHEIGHTUNDO;
WIDTHHEIGHTUNDO=false;
sendWidthHeightInfoToServer(act,nvp,_2a74);
}
function sendWidthHeightInfoToServer(act,nvp,_2a7c){
var _2a7d=new getXmlhttp();
_2a7d.onreadystatechange=function(){
if(_2a7d.readyState==4){
var _2a7e=-1;
var _2a7f=-1;
var _2a80=-1;
var _2a81=-1;
var _2a82=false;
var _2a83;
if(READ_WRITE){
btn_enabled();
}
var _2a84=_2a7d.responseXML;
if(_2a84!=null&&typeof _2a84!="undefined"){
if(_2a84.firstChild.hasChildNodes()){
var _2a85=_2a84.firstChild.childNodes;
for(var x=0,len=_2a85.length;x<len;x++){
node=_2a85.item(x);
if(node.nodeName=="error"){
if(showErrorPanelMsg==node.firstChild.nodeValue){
handleServerError("ERROR",node.firstChild.nodeValue,true);
return;
}else{
alert(node.firstChild.nodeValue);
}
}
if(node.nodeName=="sheet"){
if(node.attributes){
var _2a88=node.attributes;
var _2a89=_2a88.item(0);
if(_2a89.nodeName=="bridgeNum"){
if(_2a89.nodeValue!=""&&_2a89.nodeValue!="null"){
bridgeNumber=_2a89.nodeValue;
}
}
}
}
if(node.nodeName=="undo"){
updateUndoRangeJson(node.childNodes[0].nodeValue);
}
if(node.nodeName=="height"){
_2a83=node.childNodes[0].nodeValue;
}
if(node.nodeName=="width"){
setWidthThroughJson(node.childNodes[0].nodeValue);
}
if(node.nodeName==="reload"){
_2a82=true;
}
}
}
}
_2a83&&setRowsHeightAndModifyDOM(_2a83,_2a82,true);
drawColsRows();
}
};
nvp+="&docid="+DOCUMENT_ID+"&afterRTC="+_2a7c+"&docowner="+CURR_DOC_OWNERNAME+"&collabid="+COLLAB_ID;
nvp+="&readwrite="+ALLOW_TO_WRITE+"&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+encodeURIComponent(RTCSHEETNAME)+"&collabEditing="+COLLABORATIVE_EDITING+"&bridgeNo="+bridgeNumber+"&isDocSaved="+isDocSaved();
nvp+="&viewType="+getViewType();
if(_2a7c=="false"){
nvp+="&isColSelected="+isColSelected()+"&isRowSelected="+isRowSelected();
}
nvp=appendCSRFToURL(nvp);
if(jsREMOTE_SAVE_VIEW){
nvp+="&RMLOGINNAME="+RMUSER;
nvp+="&userStateId="+USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2a8a=getObj("apiKey");
if(_2a8a!=null){
nvp+="&apiKeyId="+_2a8a.value;
}
}
postAjax(_2a7d,ctxpath+"width_height.do",nvp);
}
function sendMsgtoOpenDoc(docid,_2a8c,_2a8d,_2a8e,_2a8f){
var _2a90=new getXmlhttp();
_2a90.onreadystatechange=function(){
if(_2a90.readyState==4){
}
};
var _2a91="&docid="+docid+"&docname="+_2a8c+"&sender="+_2a8d+"&action=OPENDOC"+"&collabid="+COLLAB_ID;
_2a91+="&docowner="+_2a8e+"&docOwnerId="+_2a8f;
sendXMLHTTPRequest(_2a90,_2a91,true,true,ctxpath+"checkcollab.do");
}
function updateValue(chid,_2a93,msg,_2a95){
if(!isDocumentReadyToEdit){
return;
}
var _2a96=msg["COLLABID"];
var _2a97=msg["ACTION"];
var _2a98=msg["DOCOWNER"];
var docid=msg["DOCID"];
var _2a9a=msg["SHEETNAME"];
var _2a9b=msg["CURRENTTIME"];
var _2a9c=msg["DOCNAME"];
var name=msg["LOGINNAME"];
var _2a9e=msg["EMAILLINK"];
var _2a9f=msg["DOCOWNERID"];
var _2aa0=msg["USERZUID"];
var _2aa1=msg["MERGEOPTION"];
if(_2a95==null||_2a95==""||_2a95==-1){
_2a95=name;
}
if(jsREMOTE_SAVE_VIEW){
_2aa0=name;
}
if(_2a96==""||COLLAB_ID==""){
return;
}
if(name!="webdatascheduler"){
if((!jsREMOTE_SAVE_VIEW&&_2a9b==CURRENTTIME)||name==LOGINNAME||_2a93==zuid){
if(_2a97!="SAVEDOC"){
return;
}
}else{
if(jsREMOTE_SAVE_VIEW&&name==RMUSER){
return;
}
}
}
if(_2a97=="VERSIONREVERT"&&_2a96==COLLAB_ID){
if(isCellEdited()){
focusCell(currRow,currCol);
resetGlobalVariables();
}
ALLOW_TO_WRITE=false;
loadDocument(DOCUMENT_ID);
return;
}
if(_2a97=="CHANGESTATUS"&&_2a96==COLLAB_ID&&docid==DOCUMENT_ID){
var _2aa2=msg["STATUS"];
var _2aa3=msg["CSTATUS"];
for(var i=0;i<SHAREDUSERSLIST.length;i++){
var _2aa5=SHAREDUSERSLIST[i];
var stat=_2aa5["cstatus"];
var name=_2aa5["dname"];
if(_2aa5["uname"]==_2a93){
_2aa5["status"]=_2aa2;
_2aa5["cstatus"]=_2aa3;
}
}
updateSharedUserStatus();
if(!DOC_PANEL.isDocPanelClosed()){
showChatPanel();
}
}
if(_2a97=="PERMISSIONCHANGED"&&_2a96==COLLAB_ID){
var _2aa7=msg["SHEETBASED"];
var perm1=msg["PERMISSION"];
var perm2=jsTitleMsg.ReadOnly;
if(perm1=="Read Only"){
perm2=jsTitleMsg.ReadWrite;
ALLOW_TO_WRITE=false;
}
notify("info",getUsrName(_2a95)+" "+jsMsg.hasChangedPermissionFrom+" "+perm2+" "+jsMsg.to+" "+perm1+" "+jsMsg.forTheDocumentNamed+" \""+escapeSpecialCharacters(_2a9c)+"\"","");
if(docid==DOCUMENT_ID){
loadDocument(docid,_2a9c);
}
return;
}
if(_2a97=="CHAT"&&docid==DOCUMENT_ID&&_2a96==COLLAB_ID){
if(DOC_PANEL.isDocPanelClosed()||DISABLECHAT){
$("#userStatusDiv").addClass("chatBlink");
var _2aaa=msg["MESSAGE"];
_2aaa=unescape(_2aaa);
var _2aab="<hr size='1' color='#CCCCCC' style='margin-top:10px;'><div style='height:25px;text-align:right;'><a href='#' onclick='javascript:if(DOC_PANEL.isDocPanelClosed()) { DOC_PANEL.showDocPanel(\"chat\", showChatPanel());return false; }' style='color:#00F;text-decoration:underline;'>"+jsMsg.EnterDiscussionRoom+"</a></div>";
notify("chat","<div><b>"+getUsrName(_2aa0)+": </b>"+escapeSpecialCharacters(_2aaa)+"</div>",_2aab);
}
updateChatMessage(chid,_2aa0,msg);
return;
}
if(_2a97=="SAVEDOC"&&docid==DOCUMENT_ID&&_2a96==COLLAB_ID){
ISCOLLAB="true";
CURRENTUSER=_2a93;
if(!SAVED){
savefile(undefined,undefined,true);
}
return;
}
var _2aac="true";
var _2aad=msg["SUBMODE"];
var row=msg["ROW"];
var col=msg["COLUMN"];
var _2ab0=msg["ROWHEIGHT"];
var _2ab1=msg["COLWIDTH"];
var _2ab2=msg["CELLVALUE"];
var _2ab3=msg["TEXTAREAVALUE"];
var _2ab4=msg["STARTROW"];
var _2ab5=msg["STARTCOL"];
var endR=msg["ENDROW"];
var endC=msg["ENDCOL"];
C_STARTROW=_2ab4;
C_ENDROW=endR;
C_STARTCOL=_2ab5;
C_ENDCOL=endC;
var count=msg["COUNT"];
var pos=msg["POSITION"];
var _2aba=msg["REQUEST"];
var _2abb=msg["TEMPSHEETNAME"];
RTCSHEETNAME=_2a9a;
ISSAMESHEET="true";
if(docid==DOCUMENT_ID&&_2a9a!=CURRSHEETNAME&&_2a96==COLLAB_ID&&_2aad!="rename"&&_2a97!="USERPRESENCE"){
ISSAMESHEET="false";
var obj=getObj("sheetdiv-"+_2a9a);
if(obj!=null){
obj.innerHTML="<div class='tabItem notify'><div>"+_2a9a+"</div></div>";
obj.removeAttribute("macrochange");
}
}
if(document.cellform){
document.cellform.isSameSheet.value=ISSAMESHEET;
document.cellform.rtcSheetName.value=RTCSHEETNAME;
}
if(_2a96==COLLAB_ID&&docid==DOCUMENT_ID){
if(_2a97=="buttonControl"){
var _2abd=msg["SUBMODE"];
Button.handleCollaboration(msg,_2abd);
}else{
if(_2a97==="REPEAT"){
var nvp="&undoFile="+msg["UNDO_FILE"]+"&U_AO="+msg["U_AO"];
repeat.doAction(msg["ACTIONJSON"],true,nvp);
}else{
if(_2a97==="INSERT_HTML"){
snippet.handleCollaboration(msg,msg["SUBACTION"]);
}else{
if(_2a97=="COMMENT"){
var _2abf=msg["COMMENT"];
commentaction(_2aad,row,col,_2abf,_2aac,name);
}else{
if(_2a97=="Format"){
if(ISSAMESHEET=="true"){
var _2ac0=msg["STYLEVALUE"];
if(_2aad=="BOLD"){
format_new("bold",_2ac0,_2ab4,_2ab5,endR,endC,_2aac);
}else{
if(_2aad=="ITALIC"){
format_new("italic",_2ac0,_2ab4,_2ab5,endR,endC,_2aac);
}else{
if(_2aad=="UNDERLINE"){
format_new("underline",_2ac0,_2ab4,_2ab5,endR,endC,_2aac);
}else{
if(_2aad=="STRIKETHROUGH"){
format_new("strike",_2ac0,_2ab4,_2ab5,endR,endC,_2aac);
}else{
if(_2aad=="FONTFAMILY"){
if(_2ab4==currRow&&_2ab5==currCol){
check($("#fontFace"),_2ac0);
}
format_new("fontFace",_2ac0,_2ab4,_2ab5,endR,endC,_2aac);
}else{
if(_2aad=="FONTSIZE"){
if(_2ab4==currRow&&_2ab5==currCol){
check($("#fontSize"),_2ac0);
}
format_new("fontSize",_2ac0,_2ab4,_2ab5,endR,endC,_2aac);
}else{
if(_2aad=="VALIGN"){
if(_2ac0=="middle"){
format_new("vcenter",_2ac0,_2ab4,_2ab5,endR,endC,_2aac);
}else{
if(_2ac0=="top"){
format_new("vtop",_2ac0,_2ab4,_2ab5,endR,endC,_2aac);
}else{
if(_2ac0=="bottom"){
format_new("vbottom",_2ac0,_2ab4,_2ab5,endR,endC,_2aac);
}
}
}
}else{
if(_2aad=="HALIGN"){
format_new(_2ac0,_2ac0,_2ab4,_2ab5,endR,endC,_2aac);
}else{
if(_2aad=="BACKGROUNDCOLOR"){
format_new("bgcolor",_2ac0,_2ab4,_2ab5,endR,endC,_2aac);
}else{
if(_2aad=="TEXTCOLOR"){
format_new("fontcolor",_2ac0,_2ab4,_2ab5,endR,endC,_2aac);
}else{
if(_2aad=="IsTextWrapped"){
applyWrap(_2ab4,_2ab5,endR,endC,_2ac0,_2aac);
}else{
executeRequest(_2aba,_2aac);
}
}
}
}
}
}
}
}
}
}
}
}else{
executeRequest(_2aba,_2aac);
}
}else{
if(_2a97=="AlignText"){
var _2ac1=msg["ALIGNXML"];
alignText(_2ab4,_2ab5,endR,endC,_2aac);
}else{
if(_2a97=="SORT"||_2a97=="FilterRangeSort"){
var nvp="startColumn="+_2ab5+"&endColumn="+endC+"&startRow="+_2ab4+"&endRow="+endR;
nvp+="&currentTime="+CURRENTTIME+"&currentSheet="+encodeURIComponent(CURRSHEETNAME)+"&documentId="+DOCUMENT_ID;
nvp+="&documentOwner="+CURR_DOC_OWNERNAME+"&collabId="+COLLAB_ID+"&afterRTC="+_2aac;
nvp+="&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+encodeURIComponent(RTCSHEETNAME);
var _2ac2=msg["ACTUALORDER"];
var _2ac3=msg["EXPANDSELECTION"];
var _2ac4=msg["CONTAINSHEADER"];
var _2ac5=msg["CASESENSITIVE"];
var _2ac6=msg["SORTCOLUMNS"];
var _2ac7=msg["NOOFCOLS"];
if(_2ac3=="TRUE"||_2ac3=="FALSE"){
nvp+="&expandSelection="+_2ac3;
}
if(_2ac6=="TRUE"||_2ac6=="FALSE"){
nvp+="&isSortColumns="+_2ac6;
}
nvp+="&containsHeader="+_2ac4;
nvp+="&sensitive="+_2ac5;
nvp+="&numberofColumns="+_2ac7;
var _2ac8=msg["SUBACTION"];
if(_2ac8&&_2ac8!=""){
nvp+="&subActionMode="+_2ac8;
}
var _2ac9=msg["SORTORDERS"];
var _2aca=msg["FIELDS"];
var _2acb=_2ac9.split(",");
var _2acc=_2aca.split(",");
for(var i=0;i<_2acb.length;i++){
var _2acd=_2acb[i];
var field=_2acc[i];
if(_2acd!="null"){
nvp+="&sortorder"+i+"="+_2acd;
}
if(field!="null"){
nvp+="&field"+i+"="+_2acc[i];
}
}
sortvalues(nvp,_2aac);
}else{
if(_2a97=="UNDO"){
undo(_2aac,msg["UNDO_FILE"],msg["U_AO"]);
}else{
if(_2a97=="REDO"){
redo(_2aac,msg["UNDO_FILE"],msg["U_AO"]);
}else{
if(_2a97=="HYPERLINK"){
_2aba=unescape(_2aba);
_2aba+="&afterRTC="+_2aac+"&currtime="+CURRENTTIME+"&collabid="+COLLAB_ID;
_2aba+="&readwrite="+ALLOW_TO_WRITE+"&currsheet="+encodeURIComponent(CURRSHEETNAME);
if(ISSAMESHEET=="true"){
var range=msg["RANGE"];
var text=unescape(msg["TEXT"]);
var url=unescape(msg["URL"]);
setHyperlink(_2aad,_2aba,_2aac,_2ab4,_2ab5,endR,endC,text,url);
}else{
gridListener.listen(6);
_2aba+="&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+encodeURIComponent(RTCSHEETNAME);
importxml(ctxpath+"hyperlink.do",updateCell,true,"POST",_2aba);
}
}else{
if(_2a97=="Border"){
if(ISSAMESHEET=="true"){
var _2ad2=msg["BORDERTYPE"];
setBorder(_2ad2,"","",_2ab4,_2ab5,endR,endC,_2aac);
}else{
executeRequest(_2aba,_2aac);
}
}else{
if(_2a97=="CHARTS"){
if(ISSAMESHEET=="true"){
drawChart(msg,_2aad,_2aac);
}
}else{
if(_2a97=="MergeCells"){
if(ISSAMESHEET=="true"){
if(_2aad=="MERGE"){
mergeCells(_2ab4,_2ab5,endR,endC,false,true,true,_2aac,msg["UNDO_FILE"],msg["U_AO"]);
}else{
if(_2aad=="UNMERGE"){
splitCells(_2ab4,_2ab5,endR,endC,true,false,_2aac);
}
}
}else{
executeRequest(_2aba,_2aac);
}
}else{
if(_2a97=="InsertRow"||_2a97=="InsertCol"||_2a97=="DeleteRow"||_2a97=="DeleteCol"){
if(ISSAMESHEET=="true"){
if(_2a97=="InsertRow"){
Row.executeShiftOperation("INSERT",pos,row,count,true,false,false,undefined,_2aac,msg["UNDO_FILE"],msg["U_AO"]);
}else{
if(_2a97=="InsertCol"){
insertCol(pos,col,count,true,false,false,undefined,_2aac,msg["UNDO_FILE"],msg["U_AO"],true);
}else{
if(_2a97=="DeleteRow"){
Row.executeShiftOperation("DELETE",row,count,true,false,_2aac,msg["UNDO_FILE"],msg["U_AO"]);
}else{
if(_2a97=="DeleteCol"){
deleteCol(col,count,true,false,_2aac,msg["UNDO_FILE"],msg["U_AO"]);
}
}
}
}
}else{
executeRequest(_2aba,_2aac);
}
}else{
if(_2a97=="InsertCopiedRows"||_2a97=="InsertCopiedCols"||_2a97=="InsertCutRows"||_2a97=="InsertCutCols"){
if(ISSAMESHEET=="true"){
if(_2a97=="InsertCopiedRows"){
Row.executeShiftOperation("INSERT_COPIED_ROWS",pos,row,count,_2ab4,endR,endC,_2aac,_2abb,msg["UNDO_FILE"],msg["U_AO"]);
}else{
if(_2a97=="InsertCopiedCols"){
insertCopiedCols(pos,col,count,_2ab5,endC,endR,_2aac,_2abb,msg["UNDO_FILE"],msg["U_AO"]);
}else{
if(_2a97=="InsertCutRows"){
Row.executeShiftOperation("INSERT_CUT_ROWS",pos,row,count,_2ab4,endR,endC,_2aac,_2abb,msg["UNDO_FILE"],msg["U_AO"]);
}else{
if(_2a97=="InsertCutCols"){
insertCutColumns(pos,col,count,_2ab5,endC,endR,_2aac,_2abb,msg["UNDO_FILE"],msg["U_AO"]);
}
}
}
}
}else{
executeRequest(_2aba,_2aac,_2a97,count,undefined,_2abb);
}
}else{
if(_2a97=="WIDTH_HEIGHT"){
var _2ad3=msg["STARTCOLINDEX"];
var _2ad4=msg["ENDCOLINDEX"];
var _2ad5=msg["STARTROWINDEX"];
var _2ad6=msg["ENDROWINDEX"];
var _2ad7=msg["ACTUALVALUE"];
if(_2aad=="row_height"){
width_height_action("height",_2ad7,_2ad5,_2ad6,_2aac);
}else{
if(_2aad=="OptimalWidth"){
width_height_action("OptimalWidth","",_2ad3,_2ad4,_2aac);
}else{
if(_2aad=="OptimalHeight"){
width_height_action("OptimalHeight","",_2ad5,_2ad6,_2aac);
}else{
if(_2aad=="col_width"){
width_height_action("width",_2ad7,_2ad3,_2ad4,_2aac);
}else{
if(_2aad==="hide"){
Row.hide(_2ad5,_2ad6,true,true);
}else{
if(_2aad==="unhide"){
var _2ad8=msg["rowHeightJSON"];
Row.unhide(_2ad5,_2ad6,parseJSON(_2ad8),true,true);
}
}
}
}
}
}
}else{
if(_2a97=="SHEETACTION"){
if(_2aad=="rename"){
var _2ad9=msg["OLDSHEETNAME"];
var _2ada=msg["NEWSHEETNAME"];
if(_2ad9!=CURRSHEETNAME){
ISSAMESHEET="false";
}
renameSheet(_2ad9,_2ada,_2aac,null,ISSAMESHEET);
}else{
if(_2aad=="insert"){
if(isSheetBasedShare){
return;
}
var _2adb=msg["INSERTBEFORE"];
var add=msg["ADD"];
insertSheet(add,_2adb,_2aac);
}else{
if(_2aad=="delete"){
deleteSheet(_2a9a,_2aac);
}else{
if(_2aad=="reorder"){
var _2a9a=msg["SHEETNAME"];
var _2add=msg["POSITION"];
sheetmovement(_2a9a,_2add,_2aac);
}else{
if(_2aad=="duplicate"){
if(isSheetBasedShare){
return;
}
var _2ade=msg["SHEETSEL"];
var _2add=msg["POSITION"];
var _2a9a=msg["SHEETNAME"];
var _2adf=msg["SHEETTOCOPY"];
var value=msg["VALUE"];
duplicatesheet(_2ade,_2add,_2a9a,_2adf,_2aac,value);
}
}
}
}
}
}else{
if(_2a97=="WebDataPaste"){
var _2ae1=msg["WEBDATAID"];
var _2ae2=msg["SHEETID"];
var _2ae3=msg["DATACELLNAME"];
var _2ae4=msg["REFRESHMDATA"];
var nvp="docid="+DOCUMENT_ID+"&docowner="+CURR_DOC_OWNERNAME+"&currentTime="+CURRENTTIME;
nvp+="&sheetname="+CURRSHEETNAME+"&webdataid="+_2ae1+"&bridgeNumber="+bridgeNumber;
nvp+="&cellname="+_2ae3+"&mode="+_2aad+"&isDocSaved="+SAVED;
if(typeof _2ae4!="undefined"){
nvp+="&refreshMData="+_2ae4;
}
if(typeof _2ab5!="undefined"){
nvp+="&startColumn="+_2ab5;
}
if(typeof endC!="undefined"){
nvp+="&endColumn="+endC;
}
if(typeof _2ab4!="undefined"){
nvp+="&startRow="+_2ab4;
}
if(typeof endR!="undefined"){
nvp+="&endRow="+endR;
}
var _2ae5=getAvailableStartRow();
var _2ae6=getAvailableEndRow();
nvp+="&afterRTC="+_2aac+"&view="+getObj("VIEW").value;
nvp+="&allowWrite="+ALLOW_TO_WRITE+"&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+RTCSHEETNAME+"&availableStartRow="+_2ae5+"&availableEndRow="+_2ae6;
if(typeof _2ae2!="undefined"){
nvp+="&sheetid="+_2ae2;
}
importxml(ctxpath+"updatewebdata.do",setWebData,true,"POST",nvp);
}else{
if(_2a97=="INSERTIMAGE"){
var _2ae7=msg["IMAGE_URL"];
var _2ae8=msg["IMAGE_ID"];
var _2ae9=msg["SEQ_NUM"];
var _2aea=msg["IMAGE_TITLE"];
var _2aeb=msg["IMAGE_NAME"];
var _2aec=msg["IMAGE_EXTN"];
var _2aed=msg["IMG_EXT_URL"];
var _2aee=msg["IMAGE_HYPERLINK"];
var _2aef=msg["IMAGE_ALT_TEXT"];
var WIDTH=msg["WIDTH"];
var _2af1=msg["HEIGHT"];
var LEFT=msg["LEFT"];
var TOP=msg["TOP"];
if(_2aad=="NEW"){
if(ISSAMESHEET=="true"){
var img=document.createElement("img");
if(_2aed!=""){
img.src=_2aed;
}else{
img.src=_2ae7;
}
img.id="img_"+_2ae9;
img.name=_2aeb;
img.setAttribute("imgid",_2ae8);
img.setAttribute("imgextn",_2aec);
img.setAttribute("exturl",_2aed);
img.setAttribute("actwd",WIDTH);
img.setAttribute("actht",_2af1);
img.title=_2aea;
img.alt=_2aef;
img.height=_2af1;
img.width=WIDTH;
img.className="img";
img.objType="img";
if(imglink!=""){
}
setImagePermission();
insertImgorChartIsFreezed(img,LEFT,TOP);
ole.init(img.id);
}
var _2af5="MODE=NEW&imgid="+_2ae8+"&left="+LEFT+"&top="+TOP+"&imgurl="+encodeURIComponent(_2ae7);
_2af5+="&width="+WIDTH+"&height="+_2af1;
updateImage(_2af5,_2aac,"true");
}else{
var _2af6=getObj("img_"+_2ae9);
if(_2aad=="MOVE"){
if(ISSAMESHEET=="true"){
if(_2af6!=null){
ole(_2af6.id).sCol=findColInXPos(LEFT);
ole(_2af6.id).sRow=findRowInYPos(TOP);
ole(_2af6.id).sRowDiff=TOP-getRowTop(ole(_2af6.id).sRow);
ole(_2af6.id).sColDiff=LEFT-getColLeft(ole(_2af6.id).sCol);
if(!_2aac){
OLE[_2af6.id].setLeft(LEFT).setSelectLayer().positionActionBar();
OLE[_2af6.id].setTop(TOP).setSelectLayer().positionActionBar();
}else{
OLE[_2af6.id].setLeft(LEFT);
OLE[_2af6.id].setTop(TOP);
}
}
}
var _2af5="MODE=MOVE&imgid="+_2ae8+"&left="+LEFT+"&top="+TOP+"&imgurl="+encodeURIComponent(_2ae7);
}else{
if(_2aad=="UPDATE"){
if(ISSAMESHEET=="true"){
if(_2af6!=null){
ole(_2af6.id).sCol=findColInXPos(LEFT);
ole(_2af6.id).sRow=findRowInYPos(TOP);
ole(_2af6.id).sRowDiff=TOP-getRowTop(ole(_2af6.id).sRow);
ole(_2af6.id).sColDiff=LEFT-getColLeft(ole(_2af6.id).sCol);
if(!_2aac){
OLE[_2af6.id].moveTo(LEFT,TOP).setSelectLayer().positionActionBar();
OLE[_2af6.id].resizeTo(WIDTH,_2af1).setSelectLayer().positionActionBar();
}else{
OLE[_2af6.id].moveTo(LEFT,TOP);
OLE[_2af6.id].resizeTo(WIDTH,_2af1);
}
}
}
var _2af5="MODE=UPDATE&imgid="+_2ae8+"&width="+WIDTH+"&height="+_2af1+"&left="+LEFT+"&top="+TOP+"&imgurl="+encodeURIComponent(_2ae7);
}else{
if(_2aad=="REMOVE"){
if(ISSAMESHEET=="true"){
if(_2af6!=null){
sheetObjectsPane.removeChild(_2af6);
}
}
var _2af5="MODE=REMOVE&imgid="+_2ae8+"&imgurl="+encodeURIComponent(_2ae7);
}
}
}
_2af5+="&imgexturl="+encodeURIComponent(_2aed);
updateImage(_2af5,_2aac,"true");
}
}else{
if(_2a97=="MACROACTION"){
updateMacroRTC(msg);
}else{
if(_2a97=="CONDITIONALFORMAT"){
updateCFRTC(msg);
}else{
if(_2a97=="DEFINENAME"){
var _2af7=msg["CELLNAME"];
var _2af8=msg["CONTENT"];
var _2af9=msg["currentNamesListSPAN"];
if(_2aad=="ADD"){
addName(_2af7,_2af8,_2aac);
}else{
if(_2aad=="MODIFY"){
modifyName(_2af7,_2af8,_2af9,_2aac);
}else{
if(_2aad=="DELETE"){
deleteName(_2af7,_2af8,_2af9,_2aac);
}
}
}
}else{
if(_2a97=="RECALCULATE"){
if(ISSAMESHEET=="true"){
var nvp="&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+encodeURIComponent(RTCSHEETNAME);
recalculate(nvp,_2aac);
}
}else{
if(_2a97=="FREEZEPANES"){
if(ISSAMESHEET=="true"){
if(_2aad=="FREEZE"){
var fR=msg["FREEZEDROW"];
var fC=msg["FREEZEDCOL"];
freezePanes(parseInt(fR),parseInt(fC),_2aac);
}else{
if(_2aad=="UNFREEZE"){
unFreezePanes(_2aac);
}
}
}
}else{
if(_2a97=="USERPRESENCE"){
if(_2a93!=LOGINNAME&&_2a96==COLLAB_ID&&docid==DOCUMENT_ID){
var row=msg["ROW"];
var col=msg["COL"];
var _2a9a=msg["SHEETNAME"];
var _2af5={"user":_2a93,"sheetname":_2a9a,"row":parseInt(row),"col":parseInt(col),"zuid":_2a95};
setTimeout(function(){
Userpresence.show(_2af5);
},500);
}
}else{
if(_2a97=="DOCUMENT_RENAMED"){
var fname=msg["DOCNAME"];
updateDocName(fname);
}else{
if(_2a97=="FORMATCELLS"){
var _2afd=msg["FORMATTYPE"];
var _2afe=msg["DECIMALS"];
var _2aff=msg["LEADINGZEROES"];
var _2b00=msg["THOUSANDSEP"];
var _2b01=msg["LANGUAGE"];
var _2b02=msg["FORMATSTRING"];
var _2b03=msg["NEGATIVEFORMAT"];
var nvp=constructNVP(_2aac,_2ab4,_2ab5,endR,endC);
if(_2afd=="AUTOMATIC"){
nvp+=appendNVPforAuto();
}else{
if(_2afd=="NUMBER"){
nvp+=appendNVPforNumber(undefined,_2b03,_2b00,_2afe,_2aff,_2b01);
}else{
if(_2afd=="CURRENCY"){
var _2b04=msg["SYMBOL"];
nvp+=appendNVPforCurrency(undefined,_2b04,_2b03,_2b00,_2afe,_2aff,_2b01);
}else{
if(_2afd=="DATETIME"||_2afd=="DATE"||_2afd=="TIME"){
var _2b05=msg["FORMAT"];
nvp+=appendNVPforDateTime(undefined,_2afd,_2b05,_2b01);
}else{
if(_2afd=="PERCENTAGE"){
var _2b06=msg["AUTOPERCENT"];
var _2b07=msg["MULTIPLY"];
nvp+=appendNVPforPercentage(undefined,_2afe,_2b06,_2b07,_2b01);
}else{
if(_2afd=="FRACTION"){
var _2b08=msg["FRACTIONTYPE"];
var _2b09=msg["ACCEPT"];
nvp+=appendNVPforFraction(undefined,_2b08,_2b09,_2b01);
}else{
if(_2afd=="SCIENTIFIC"){
nvp+=appendNVPforScientific(undefined,_2afe,_2b01);
}else{
if(_2afd=="TEXT"){
nvp+=appendNVPforText();
}else{
if(_2afd=="REGIONAL"){
var type=msg["TYPE"];
var _2b0b=msg["SUBREGFORMAT"];
nvp+=appendNVPforRegional(undefined,type,_2b01,_2b0b);
}else{
if(_2afd=="SPECIAL"){
nvp+=appendNVPforSpecial(undefined,_2b02);
}else{
if(_2afd=="CUSTOM"){
var _2b0c=msg["CUSFORMAT"];
nvp+=appendNVPforCustom(_2b0c,"",_2aac);
}
}
}
}
}
}
}
}
}
}
}
doFormatCells(nvp,undefined,_2aac);
}else{
if(_2a97=="FILTERS"){
var _2b0d=msg["SHEETNAME"];
if(_2aad=="apply"){
var _2b0e=new Array();
var _2b0f=msg["isAuto"];
var _2b10=msg["cType"];
var _2b11=new Array();
_2b11[0]=msg["fV1"];
if(!_2b0f){
_2b11[1]=msg["fV2"];
_2b11[2]=msg["fO"];
_2b11[3]=msg["fC1"];
_2b11[4]=msg["fC2"];
}
_2b0e["filterCol"]=msg["fC"];
_2b0e["fieldNumber"]=msg["index"];
_2b0e["dataType"]=msg["dT"];
_2b0e["sheetName"]=_2b0d;
if(_2b10=="specialCondition"){
Filter.applyFilter(msg["fC1"],true,_2aac,_2b10,_2b11[0],_2b0e);
}else{
if(_2b0f){
if(_2b10!=="all"){
Filter.selectedItems=JSON.parse(msg["fV1"]);
for(var i=0,len=Filter.selectedItems.length;i<len;i++){
Filter.selectedItems[i]=encodeURIComponent(Filter.selectedItems[i].replace(/\"/g,"\\\""));
}
}
}
Filter.applyFilter(_2b11,_2b0f,_2aac,_2b10,_2b11[0],_2b0e);
}
}else{
if(_2aad=="create"){
var _2b13=msg["RESP"];
_2b13=parseJSON(_2b13);
var range=_2b13.range;
var sN=_2b13.SheetName;
var _2aa2=_2b13.Status;
var _2b15=_2b13.Display;
}
Filter.doFilterAction(_2aad,"",_2aac,range,_2b0d);
}
}else{
if(_2a97=="UPDATE_SAVE_MESSAGE"){
if(ENABLE_SAVE_MESSAGE&&!isReadOnlyViewMode){
var _2b16=msg["LASTMODIFIEDDATE"];
var _2b17=msg["LASTAUTHORNAME"];
updateSaveToolTip(_2b16,_2b17,_2aac);
}
}else{
if(_2a97=="copyToClip"){
return false;
}else{
if(_2a97=="REPLACE"||_2a97=="REPLACEALL"){
var _2b0d=msg["SHEETNAME"];
if(_2aad=="workbook"){
_2b0d=CURRSHEETNAME;
}
var nvp="actionMode="+_2a97+"&row="+row+"&column="+col+"&cellValue="+_2ab2+"&replaceString="+msg["REPLACEVALUE"];
nvp+="&isNext="+msg["ISNEXT"]+"&isMatchCase="+msg["ISMATCHCASE"]+"&isExactMatch="+msg["ISEXACTMATCH"];
nvp+="&traverseMode="+_2aad+"&currentTime="+CURRENTTIME+"&currentSheet="+encodeURIComponent(_2b0d)+"&documentId="+DOCUMENT_ID;
nvp+="&view="+getObj("VIEW").value+"&docOwner="+CURR_DOC_OWNERNAME+"&availableStartRow="+getAvailableStartRow()+"&availableEndRow="+getAvailableEndRow();
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols+"&afterRTC="+_2aac;
if(getObj("apiKey")!=null){
nvp+="&apiKeyId="+getObj("apiKey").value;
}
nvp+="&userStateId="+USERSTATEID+"&collabEdit="+COLLABORATIVE_EDITING+"&collabid="+COLLAB_ID+"&readwrite="+ALLOW_TO_WRITE;
submitSearch(msg["ISNEXT"],_2a97,nvp);
}else{
var _2b18;
if(_2a97=="Submit"||_2a97=="CopyPasteTextArea"){
_2b18=msg["SWITCH_TO_OO"];
var _2b19=msg["FILENAME"];
if(_2a97=="CopyPasteTextArea"){
_2aba+="&actionOwner="+name+"&fileName="+_2b19+"&view="+getViewType();
}
}
executeRequest(_2aba,_2aac,_2a97,_2ab2,_2ab3,_2abb,_2b18);
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
function executeRequest(_2b1a,_2b1b,_2b1c,_2b1d,_2b1e,_2b1f,_2b20){
if(typeof _2b1c=="undefined"){
_2b1c="";
_2b1d="";
_2b1e="";
_2b1f="";
}
_2b1a=unescape(_2b1a);
_2b1a+="&afterRTC="+_2b1b+"&currentTime="+CURRENTTIME+"&bridgeNo="+bridgeNumber+"&collabId="+COLLAB_ID;
_2b1a+="&allowWrite="+ALLOW_TO_WRITE+"&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+RTCSHEETNAME;
_2b1a+="&currentSheet="+CURRSHEETNAME+"&availableStartRow="+getAvailableStartRow()+"&availableEndRow="+getAvailableEndRow();
if(typeof _2b1f!="undefined"){
if(_2b1a.indexOf("?tmpSheet=")!=-1){
var stIdx=_2b1a.indexOf("?tmpSheet=");
var _2b22=_2b1a.substring(0,stIdx)+"?tmpSheet="+_2b1f;
var _2b23=_2b1a.indexOf("&",stIdx);
if(_2b23!=-1){
_2b22+=_2b1a.substring(_2b1a.indexOf("&",stIdx),_2b1a.length);
}
_2b1a=_2b22;
}else{
if(_2b1a.indexOf("&tmpSheet=")!=-1){
var stIdx=_2b1a.indexOf("&tmpSheet=");
var _2b22=_2b1a.substring(0,stIdx)+"&tmpSheet="+_2b1f;
var _2b23=_2b1a.indexOf("&",stIdx+10);
if(_2b23!=-1){
_2b22+=_2b1a.substring(_2b1a.indexOf("&",stIdx+10),_2b1a.length);
}
_2b1a=_2b22;
}else{
_2b1a+="&tmpSheet="+_2b1f;
}
}
}
if(_2b20!=null&&typeof _2b20!="undefined"&&_2b20!=""){
_2b1a+="&switch_to_oo="+_2b20;
}
if(_2b1c=="Submit"){
_2b1a+="&cellValue="+_2b1d;
var url=_2b1a.split("?");
importxml(url[0],updateCell,true,"POST",url[1],ISSAMESHEET);
}else{
if(_2b1c=="CopyPasteTextArea"){
_2b1a+="&textAreaValue="+_2b1e;
}
var url=_2b1a.split("?");
importxml(url[0],updateCell,true,"POST",url[1],ISSAMESHEET);
}
}
function updateCustomMessage(msg){
var _2b26=msg["ACTION"];
var docid=msg["DOCID"];
var names=msg["NAMES"];
var _2b29=msg["DOCNAME"];
var _2b2a=msg["DOCOWNER"];
var _2b2b=msg["USERZUID"];
var _2b2c=msg["LOGINNAME"];
var _2b2d=msg["COLLABID"];
var _2b2e=msg["SUBMODE"];
var _2b2f=msg["EMAILSHARED"];
var _2b30=msg["CURRENTTIME"];
var _2b31=msg["DOCOWNERID"];
if(_2b26=="BLOCK_WINDOW"){
var _2b32=msg["TIME"];
if(DOCUMENT_ID==docid&&zuid==_2b2b&&_2b32!=wmsTriggerTime&&isDocumentRendered&&!jsPUBLIC_VIEW){
errorDocMenutab();
stopActiveSession("ERROR",jsMsg["Banner.WindowBlockErrorMessage"]);
}
}else{
if(_2b26=="MORESHAREDUSERS"){
if(names.trim()!=""&&_2b2d==COLLAB_ID&&docid==DOCUMENT_ID){
if(_2b2d!=""){
DONTNOTIFY=true;
WmsServerCheck.online=true;
}
}
}else{
if(_2b26=="NEWSHARE"){
if(_2b2a!=LOGINNAME){
var _2b33=escapeSpecialCharacters(_2b29);
var _2b34="<hr size='1' color='#CCCCCC' style='margin-top:10px;'><div style='height:25px;text-align:right;'><a href='javascript:;' onclick='loadDocument(\""+docid+"\" , \""+_2b33+"\" , \"\" , \"\" , \"clickHeretoOpen\");' style='color:#00F;text-decoration:underline;'>"+jsMsg.ClickHereToOpen+"</a></div>";
notify("info",_2b2c+" "+jsMsg.hasSharedSpreadsheetToYou+" "+"\""+escapeSpecialCharacters(_2b29)+"\"",_2b34);
}else{
if(docid==DOCUMENT_ID&&_2b2d!=COLLAB_ID){
if(_2b2d!=""){
COLLAB_ID=_2b2d;
WmsServerCheck.online=true;
}
}
}
}else{
if(_2b26=="SHAREREMOVEDBYOWNER"){
if(names==LOGINNAME&&LOGINNAME!=_2b2c&&docid==DOCUMENT_ID){
if(!disableRemoveShareNotify&&!cdview){
var _2b35=jsMsg["Share.dialog.removeShareMsg"];
var _2b36=jsMsg["Share.dialog.accessDenied"];
var _2b37=replaceParams(jsMsg["Share.dialog.closeMessage"],new Array("<b id='cntDwn'>15</b>"));
Share.showDialog(jsTitleMsg.OK,true);
Share.setValues("error",_2b36,_2b35,_2b37);
startCountDown();
}
}else{
for(var i=0;i<SHAREDUSERSLIST.length;i++){
var _2b39=SHAREDUSERSLIST[i];
var name=_2b39["uname"];
if(_2b2b==name){
SHAREDUSERSLIST.splice(i,1);
break;
}
}
updateSharedUserStatus();
if(!DOC_PANEL.isDocPanelClosed()){
showChatPanel();
}
}
}else{
if(_2b26=="PERMISSIONCHANGED"&&_2b2d==COLLAB_ID&&docid==DOCUMENT_ID){
if(!cdview){
var _2b3b=msg["SHEETBASED"];
var _2b3c=msg["PERMISSION_TO"];
var _2b3d=msg["PERMISSION_FROM"];
var _2b3e=true;
var _2b35=jsMsg["Share.dialog.ROtoRW"];
var _2b3f=jsMsg["Share.dialog.reloadButMsg2"];
if((_2b3d=="Co Owner"||_2b3d=="Read/Write")&&_2b3c=="Read Only"){
_2b35=jsMsg["Share.dialog.CO_RWtoRO"];
_2b3f=jsMsg["Share.dialog.reloadButMsg1"];
_2b3e=true;
}else{
if(_2b3d=="Co Owner"&&_2b3c=="Read/Write"){
_2b35=jsMsg["Share.dialog.COtoRW"];
_2b3f=jsTitleMsg.Close;
_2b3e=false;
}else{
if(_2b3d=="Read/Write"&&_2b3c=="Co Owner"){
_2b35=jsMsg["Share.dialog.RWtoCO"];
_2b3f=jsTitleMsg.Close;
_2b3e=false;
}else{
if(_2b3d=="Read Only"&&_2b3c=="Co Owner"){
_2b35=jsMsg["Share.dialog.ROtoCO"];
_2b3f=jsMsg["Share.dialog.reloadButMsg2"];
_2b3e=true;
}
}
}
}
Share.showDialog(_2b3f,_2b3e,_2b3c);
Share.setValues("info",jsMsg["Share.dialog.permissionChanged"],_2b35);
return;
}
}else{
if(_2b26=="SHAREREMOVEDBYUSER"){
if(_2b2c!=LOGINNAME){
for(var i=0;i<SHAREDUSERSLIST.length;i++){
var _2b39=SHAREDUSERSLIST[i];
var name=_2b39["uname"];
if(_2b2b==name){
SHAREDUSERSLIST.splice(i,1);
break;
}
}
if(SHAREDUSERSLIST.length==0){
}else{
updateSharedUserStatus();
}
if(!DOC_PANEL.isDocPanelClosed()){
showChatPanel();
}
}
}else{
if(_2b26=="DOCUMENTDELETED"){
if(_2b2c!=LOGINNAME){
notify("info",_2b2c+" "+jsMsg.hasDeletedSpreadsheetSharedToYou+" "+"\""+escapeSpecialCharacters(_2b29)+"\"","");
if(docid==DOCUMENT_ID){
closeDocument(false);
}
}
}else{
if(_2b26=="OPENDOC"){
if(documentOpened=="false"){
if(docid==COLLAB_DOCUMENT_ID){
openDoc1(docid,_2b29,false,_2b30,_2b2a,_2b31);
}
}
return;
}else{
if(_2b26=="SHAREDUSERSIGNUP"){
if(_2b2c!=LOGINNAME){
if(docid==DOCUMENT_ID){
if(COLLAB_ID.trim()==""){
COLLAB_ID=_2b2d;
COLLABORATIVE_EDITING="ON";
}
if(COLLAB_ID!=""){
DONTNOTIFY=true;
WmsServerCheck.online=true;
}
}
}
}else{
if(_2b26=="DOCCOMMENTS"){
if(_2b2c!=LOGINNAME){
if(_2b2d==COLLAB_ID&&docid==DOCUMENT_ID){
if(_2b2e=="Save"){
var _2b34="";
if(DOC_PANEL.isDocPanelClosed()){
var _2b34="<hr size='1' color='#CCCCCC' style='margin-top:10px;'><div style='height:25px;text-align:right;'><a href='javascript:;' onclick='showCommentsIFrame();' style='color:#00F;text-decoration:underline;'>"+jsMsg.ClickHereToOpen+"</a></div>";
}
notify("info",_2b2c+" "+jsMsg.hasAddedComment,_2b34);
}else{
if(_2b2e=="Edit"){
}else{
if(_2b2e=="Delete"){
}
}
}
if(!DOC_PANEL.isDocPanelClosed()){
DOC_PANEL.refreshDocPanel();
}
}
}
}else{
if(_2b26=="DOCUMENTOPENED"){
if(_2b2c!=LOGINNAME){
if(docid!=DOCUMENT_ID){
var _2b34="<hr size='1' color='#CCCCCC' style='margin-top:10px;'><div style='height:25px;text-align:right;'><a href='javascript:;' onclick='loadDocument("+"\""+docid+"\""+", "+"\""+_2b29+"\""+");' style='color:#00F;text-decoration:underline;'>"+jsMsg.ClickHereToOpen+"</a></div>";
notify("info",_2b2c+" "+jsMsg.hasOpenedDocument+" "+"\""+escapeSpecialCharacters(_2b29)+"\"",_2b34);
}
}
}else{
if(_2b26=="WebDataPaste"&&docid==DOCUMENT_ID){
var _2b40=msg["WEBDATAID"];
var _2b41=msg["SHEETID"];
var _2b42=msg["DATACELLNAME"];
var _2b43=msg["SHEETNAME"];
var _2b2e=msg["SUBMODE"];
RTCSHEETNAME=_2b43;
ISSAMESHEET="true";
if(docid==DOCUMENT_ID&&_2b43!=CURRSHEETNAME){
ISSAMESHEET="false";
var obj=getObj("sheetdiv-"+_2b43);
if(obj!=null){
obj.innerHTML="<div class='tabItem notify'><div>"+_2b43+"</div></div>";
obj.removeAttribute("macrochange");
}
}
if(document.cellform){
document.cellform.isSameSheet.value=ISSAMESHEET;
document.cellform.rtcSheetName.value=RTCSHEETNAME;
}
var nvp="docid="+DOCUMENT_ID+"&docowner="+CURR_DOC_OWNERNAME+"&currentTime="+CURRENTTIME;
nvp+="&sheetname="+CURRSHEETNAME+"&webdataid="+_2b40+"&bridgeNumber="+bridgeNumber;
nvp+="&cellname="+_2b42+"&mode="+_2b2e+"&isDocSaved="+SAVED;
if(typeof startC!="undefined"){
nvp+="&startColumn="+startC;
}
if(typeof endC!="undefined"){
nvp+="&endColumn="+endC;
}
if(typeof startR!="undefined"){
nvp+="&startRow="+startR;
}
if(typeof endR!="undefined"){
nvp+="&endRow="+endR;
}
var _2b46=getAvailableStartRow();
var _2b47=getAvailableEndRow();
nvp+="&afterRTC=true"+"&view="+getObj("VIEW").value;
nvp+="&allowWrite="+ALLOW_TO_WRITE+"&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+RTCSHEETNAME+"&availableStartRow="+_2b46+"&availableEndRow="+_2b47;
if(typeof _2b41!="undefined"){
nvp+="&sheetid="+_2b41;
}
importxml(ctxpath+"updatewebdata.do",setWebData,true,"POST",nvp);
}else{
if(_2b26=="REMOTE_SAVE_MSG"){
var _2b48=msg["statusmsg"];
var _2b49=msg["statuscode"];
var _2b4a=getObj("loading");
if(_2b4a){
_2b4a.innerHTML=_2b48;
_2b4a.style.display="block";
}
if(!IS_SAVEAS){
btn_disabled();
}else{
IS_SAVEAS=false;
}
setTimeout(function(){
hideProgressMessage();
},3000);
}else{
if(_2b26=="UPDATE_COLLABID"&&DOCUMENT_ID==docid&&zuid==_2b2b&&_2b2d!=""){
COLLAB_ID=_2b2d;
updateSharedUserStatus();
}else{
if(_2b26=="DOCUMENT_RENAME"&&DOCUMENT_ID==docid){
updateDocName(_2b29);
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
var reloadFrozenRows=false;
function submitScrollForm(_2b4b,_2b4c,_2b4d,_2b4e,_2b4f){
if(!_2b4b.length){
return;
}
var _2b50;
if(_2b4f){
_2b50=Row.getLoadedRowsInFrozenRange();
if(_2b50[0]===_2b4b[0]){
_2b50=[];
}
if(!_2b4b.length){
_2b4b=_2b50;
}else{
_2b4b=_2b50.concat(_2b4b);
}
}
if(isRespondedInScroll){
var _2b51=getSheetHeight();
var _2b52=getSheetTableHeight();
var _2b53=0;
var _2b54=totCols;
var _2b55=(1.25*ROWS_PER_TILE)*getColMax();
var _2b56=(endRow-startRow)*(_2b54-_2b53);
if(_2b56>_2b55){
var _2b57=ROWS_PER_TILE*totCols;
var _2b58=0;
while(_2b56>_2b55){
_2b56-=_2b57;
_2b58+=1;
}
if(_2b4c=="SCROLLDOWN"){
endRow-=_2b58*ROWS_PER_TILE;
}else{
if(_2b4c=="SCROLLUP"){
startRow+=_2b58*ROWS_PER_TILE;
}
}
}
if(_2b51>_2b52){
while(_2b51>_2b52){
if(totRows>=getRowMax()){
break;
}
_2b52+=getRowHeight(totRows);
totRows+=1;
}
totRows=getCeilRow(totRows);
setSheetTableHeight(getRowTop(totRows-1)+getRowHeight(totRows-1));
endRow=totRows;
}
isChangeMadeAfterScroll=false;
isRespondedInScroll=false;
document.scrollform.startRow.value=startRow;
document.scrollform.endRow.value=endRow-1;
document.scrollform.startCol.value=0;
document.scrollform.endCol.value=totCols-1;
document.scrollform.scrollAction.value=_2b4c;
document.scrollform.scrollStatus.value=_2b4d;
document.scrollform.currentTime.value=CURRENTTIME;
document.scrollform.currentSheet.value=CURRSHEETNAME;
document.scrollform.documentId.value=DOCUMENT_ID;
document.scrollform.documentOwner.value=CURR_DOC_OWNERNAME;
document.scrollform.allowWrite.value=ALLOW_TO_WRITE;
document.scrollform.view.value=getObj("VIEW").value;
document.scrollform.collabId.value=COLLAB_ID;
document.scrollform.afterRTC.value="false";
document.scrollform.collabEditing.value=COLLABORATIVE_EDITING;
document.scrollform.isStockConfigured.value=isStockConfigured;
document.scrollform.isDocSaved.value=SAVED;
document.scrollform.bridgeNo.value=bridgeNumber;
document.scrollform.isSameSheet.value=ISSAMESHEET;
document.scrollform.rtcSheetName.value=RTCSHEETNAME;
document.scrollform.showFormulas.value=showFormulas;
document.scrollform.docOwner.value=CURR_DOC_OWNERNAME;
document.scrollform.docName.value=encodeURIComponent(DOCUMENT_NAME);
document.scrollform.rowsToLoad.value=_2b4b.toString();
document.scrollform.fakeReload.value=_2b4e||null;
document.scrollform.reloadFrozenRows.value=_2b4f||null;
document.scrollform.frozenRows.value=_2b50||null;
document.scrollform.fileFormat.value=FILE_FORMAT;
var _2b59=getObj("apiKey");
var _2b5a=-1;
if(_2b59!=null){
_2b5a=getObj("apiKey").value;
}
document.scrollform.apiKeyId.value=_2b5a;
if(DOCUMENT_VERSION){
document.scrollform.versionId.value=DOCUMENT_VERSION;
}
if(isInOOMode){
document.scrollform.tempPublicDocId.value=tempPublicDocId;
}
importxmlForForm(document.scrollform,updateTile,true,true);
}else{
}
}
function updateTile(_2b5b,_2b5c,_2b5d,val,_2b5f){
if(errorMsgShown){
message("","none");
return;
}
if(_2b5c>=300){
message("","none");
errorAlert(_2b5c,_2b5d);
return;
}
var _2b60=false;
var _2b61=undefined;
if(_2b5b.indexOf("Document.Parse.Error")!=-1){
var _2b62=_2b5b.split("-");
var msg=_2b62[0];
var _2b64=_2b62[1];
if(!isNaN(_2b64)){
_2b64=parseInt(_2b64);
}else{
_2b64=null;
}
var _2b65=_2b62[2];
_2b60=true;
parseError=true;
var _2b66="<a href='mailto:"+jsMsg["SupportMailId"]+"'>"+jsMsg["SupportMailId"]+"</a>";
if(jsOPEN_DOC_VIEW){
if(_2b65=="true"){
var _2b67=returnTimeElaspsedinString(new Date().getTime(),_2b64);
var _2b68="";
if(_2b67.unit.indexOf("second")!=-1){
_2b68=jsMsg["Document.Parse.Error.LastSavedTimeinSeconds"];
}else{
if(_2b67.unit=="minutes"){
_2b68=jsMsg["Document.Parse.Error.LastSavedTimeinMinutes"];
}else{
if(_2b67.unit=="hours"){
_2b68=jsMsg["Document.Parse.Error.LastSavedTimeinHours"];
}else{
if(_2b67.unit=="days"){
_2b68=jsMsg["Document.Parse.Error.LastSavedTimeinDays"];
}
}
}
}
_2b61=replaceParams(_2b68,new Array("<a href='#' onclick='revertVersion(0)'>","</a>",_2b67.count,"<a href='#' onclick='showVersionDetails()'>","</a>",_2b66));
}else{
_2b61=replaceParams(jsMsg["Document.Parse.Error.WithoutVersion"],new Array(_2b66));
}
}else{
if(jsSHARE_VIEW){
_2b61=replaceParams(jsMsg["ShareView.Document.Parse.Error"],new Array("<a href='#' onclick='notifySharedUsers(false)'>","</a>",_2b66));
}
}
}else{
if(_2b5b==showErrorPanelMsg){
_2b60=true;
_2b61=_2b5b;
}
}
if(_2b60){
isDocumentLoading=false;
message("","none");
handleServerError("ERROR",_2b61,true);
return;
}
isRespondedInScroll=true;
var _2b69=parseJSON(_2b5b);
var _2b6a=_2b69[0];
var docId=_2b6a[0];
var _2b6c=_2b6a[1];
var range=_2b6a[2];
var _2b6e=parseJSON(range[0]);
var _2b6f=_2b6e[0];
var _2b70=_2b6e[_2b6e.length-1];
var _2b71=range[1];
var _2b72=range[2];
var _2b73=_2b6a[3];
reloadFrozenRows=false;
var _2b74=_2b69["fakeReload"];
if(_2b74){
var _2b75={"fakeReload":_2b74,"reloadFrozenRows":_2b69["reloadFrozenRows"],"frozenRows":JSON.parse("["+_2b69["frozenRows"]+"]")};
var _2b76=Row.getAvailableRows();
Merge.remove(_2b76[0],0,_2b76[_2b76.length-1],getTotalColumn());
}
var _2b77=_2b69[1];
var _2b78=_2b77[0];
var _2b79=_2b77[1];
var _2b7a=parseJSON(_2b77[2]);
var _2b7b=_2b77[3];
if(_2b77[4]){
var _2b7c=parseJSON(_2b77[4]);
}
if(_2b77[5]&&!(updateTileCallbackInfo.isCallbackAvailable)){
var _2b7d=_2b77[5];
if(_2b7d){
getConditionalFormats(_2b7d,_2b6f,_2b71,_2b70,_2b72);
}
}
if(docId==DOCUMENT_ID&&_2b6c==CURRSHEETNAME){
switch(_2b78){
case 0:
_2b78="SCROLLDOWN";
break;
case 1:
_2b78="SCROLLUP";
break;
}
switch(_2b79){
case 0:
_2b79="UNLOADED_SHEET";
break;
case 1:
_2b79="UNLOADED_PAGE";
break;
case 2:
_2b79="END_OF_PAGE";
break;
case 3:
_2b79="PAGE_AFTER_CURRENT_PAGE";
break;
case 4:
_2b79="START_OF_PAGE";
break;
case 5:
_2b79="PAGE_BEFORE_CURRENT_PAGE";
break;
}
if(!isChangeMadeAfterScroll&&_2b7b){
btn_disabled();
}
hideRowNoInfo();
var _2b7e=getAvailableStartRow();
var _2b7f=getAvailableEndRow();
var _2b80=true;
if(!window.isFakeReloadModeOn){
if(_2b79!="UNLOADED_PAGE"&&!updateTileCallbackInfo.isCallbackAvailable){
switch(_2b79){
case "START_OF_PAGE":
case "PAGE_BEFORE_CURRENT_PAGE":
if(Row.findNextNonHiddenRow(_2b7e,false)!==_2b70){
_2b80=false;
}
break;
case "END_OF_PAGE":
case "PAGE_AFTER_CURRENT_PAGE":
if(Row.findNextNonHiddenRow(_2b7f,true)!==_2b6f){
_2b80=false;
}
break;
}
}
}
window.isFakeReloadModeOn=false;
if(_2b80){
var _2b81=true;
updateRowDetails(_2b6e);
insertTiles(_2b79,_2b73,_2b6e,_2b71,_2b72,_2b81,_2b75);
}else{
}
Merge.update(_2b7a,_2b6f);
if(_2b80&&_2b7c){
var ary=_2b7c;
for(var i=0;i<ary.length;i++){
updateJson(ary[i]);
}
}
if(_2b79=="UNLOADED_SHEET"){
sheetLoadCallBack();
}
var _2b84=false;
if(updateTileCallbackInfo.isCallbackAvailable){
_2b84=true;
updateTileCallbackInfo.isCallbackAvailable=false;
var _2b85=updateTileCallbackInfo.actionDetails;
switch(_2b85.action){
case "FREEZE":
_2b85.callbackMethod(_2b85.freezeeRow,_2b85.freezeeCol,_2b85.afterRTC);
break;
case "SHEET_OPEN":
_2b85.callbackMethod();
break;
default:
_2b85.callbackMethod();
break;
}
if(!jsTHROWAWAY_VIEW){
if(showpivotVar=="showPivotRangeEdit"){
showPivotRangeEdit();
}
showpivotVar="";
}
}
loadXTileIfVacantInViewPort();
focusSheet();
if(_2b84){
updateTileCallbackInfo.actionDetails=undefined;
}
if(browser_safari||browser_ie){
if(!jsEMBED_VIEW){
activateCellField();
}
}
}
message("","none");
}
function updateAvailableRowRange(_2b86,_2b87,_2b88,_2b89){
if(_2b89&&_2b89.reloadFrozenRows){
_2b88=_2b88.slice(_2b89.frozenRows.length);
}
var _2b8a=_2b88[0];
var _2b8b=_2b88[_2b88.length-1];
switch(_2b86){
case "DELETE":
switch(_2b87){
case "UNLOADED_PAGE":
availableStartRow=-1;
availableEndRow=-1;
break;
case "START_OF_PAGE":
case "PAGE_BEFORE_CURRENT_PAGE":
availableEndRow=Row.findNthNonHiddenRow(1,_2b8a,false);
break;
case "END_OF_PAGE":
case "PAGE_AFTER_CURRENT_PAGE":
availableStartRow=Row.findNthNonHiddenRow(1,_2b8b,true);
break;
}
break;
case "INSERT":
switch(_2b87){
case "UNLOADED_PAGE":
case "UNLOADED_SHEET":
availableStartRow=_2b8a;
availableEndRow=_2b8b;
break;
case "START_OF_PAGE":
case "PAGE_BEFORE_CURRENT_PAGE":
availableStartRow=_2b8a;
break;
case "END_OF_PAGE":
case "PAGE_AFTER_CURRENT_PAGE":
availableEndRow=_2b8b;
break;
}
break;
}
if(availableStartRow>0){
availableStartRowAfterFreeze=(getAvailableStartRow()+ROWS_PER_TILE+1);
}
Row.setAvailableRows(Row.getNonHiddenRowsInRange(getAvailableStartRow(),getAvailableEndRow()));
}
function stopActiveSession(_2b8c,_2b8d,_2b8e){
if(_2b8c){
showBannerMessage(_2b8c,_2b8d);
}
READ_WRITE=false;
ALLOW_TO_WRITE=false;
isErrorDoc=true;
if(COLLAB_ID!=""){
WebMessanger.disable();
COLLAB_ID="";
isRegistered=false;
SHAREDUSERSLIST=[];
var _2b8f=getObj("sharedUserStatus");
if(_2b8f){
_2b8f.className="hidden";
}
DOC_PANEL.closeDocPanel();
}
}
function reloadPage(_2b90,_2b91){
var _2b90=_2b90===undefined?getSheetScrollTop():_2b90;
if(!Row.isAllRowsHidden()){
if(_2b90>getSheetTableHeight()){
_2b90=getSheetTableHeight()-getSheetPaneHeight();
}
var _2b92=getRowRangeForPageInView("UNLOADED_PAGE",_2b90);
var _2b93=getFloorRow(_2b92.firstRow);
var _2b94=getCeilRow(_2b92.lastRow);
submitScrollForm(getNonHiddenRowsInPage(_2b93,_2b94-1),"SCROLLDOWN","UNLOADED_PAGE","true",_2b91);
}else{
removeXTiles(getAvailableStartRow(),getAvailableEndRow()+1,"UNLOADED_PAGE");
}
}
var isOpera=navigator.userAgent.indexOf("Opera")>-1;
var isIE=navigator.userAgent.indexOf("MSIE")>1&&!isOpera;
var isMoz=navigator.userAgent.indexOf("Mozilla/5.")==0&&!isOpera;
var popupon=false;
var totalmatch=0;
var matchlist="";
var matcharray;
var position=-1;
var id_array=new Array();
String.prototype.lastIndexOf=function(comp){
var x=this;
var laind=-1;
var index=x.indexOf(comp);
while(index!=-1){
laind=index;
index=x.indexOf(comp,index+comp.length);
}
return laind;
};
function getElementHeight(obj){
return obj.clientHeight;
}
function getElementWidth(obj){
return obj.clientWidth;
}
function setIds(area,ch){
var pos=getAutoFillPos(area);
var _2b9e=pos[1];
var _2b9f=getElementHeight(area);
var _2ba0=getElementWidth(area);
var _2ba1=_2b9e;
var _2ba2=pos[0];
var _2ba3=getObj(ch);
var body="";
for(i=0;i<totalmatch;i++){
var oc="onmousedown='appendPos(\""+area.id+"\",\""+ch+"\")' onmouseover='switchClassOn(this);' onmouseout='switchClassOff(this);'";
if(i==position){
body=body+"<p id='pos"+i+"' "+oc+" class='dropdown-on'>"+matcharray[i]+"</p>";
}else{
body=body+"<p id='pos"+i+"' "+oc+" class='dropdown-off'>"+matcharray[i]+"</p>";
}
}
_2ba3.innerHTML=body;
popupon=true;
_2ba3.style.top=_2ba1+"px";
_2ba3.style.left=_2ba2+"px";
_2ba3.style.display="";
}
function appendPos(n1,ch1){
fillarea(getObj(n1),ch1);
}
function switchClassOff(el){
el.className="dropdown-off";
}
function switchClassOn(el){
var par=el.parentNode;
var prev=getObj("pos"+position);
switchClassOff(prev);
el.className="dropdown-on";
var _i=el.id;
var pos=_i.substring(3,_i.length);
position=parseInt(pos);
}
function adjustpopup(n,ch){
var _2bb0=getObj(ch);
var ids=_2bb0.getElementsByTagName("p");
for(i=0;i<ids.length;i++){
ids[i].className=(i==position)?"dropdown-on":"dropdown-off";
}
var l=n.value.length;
if(isIE){
var r=n.createTextRange();
r.moveEnd("character",l);
r.moveStart("character",l);
r.select();
}
if(isMoz){
n.setSelectionRange(l,l);
}
if(isOpera){
n.setSelection(l,l);
}
}
function hidepopup(ch){
var _2bb5=getObj(ch);
if(_2bb5!=null){
_2bb5.innerHTML="";
_2bb5.style.display="none";
}
popupon=false;
}
function fillarea(area,ch){
var _2bb8=getObj(ch);
var ids=_2bb8.getElementsByTagName("p");
var id=ids[position].innerHTML;
if(area.value==""){
if(area.id=="countryTxt"){
area.value=id;
}else{
area.value=id+", ";
}
}else{
var _2bbb=area.value;
var _2bbc=_2bbb.lastIndexOf(",");
if(_2bbc==-1){
if(area.id=="countryTxt"){
area.value=id;
}else{
area.value=id+", ";
}
}else{
_2bbb=_2bbb.substring(0,_2bbc+1);
if(area.id=="countryTxt"){
area.value=_2bbb+" "+id;
}else{
area.value=_2bbb+" "+id+", ";
}
}
}
hidepopup(ch);
if(area.id=="countryTxt"){
selectCountry();
}
}
function removeElementFromArray(arr,ele){
for(i=0;i<arr.length;i++){
if(arr[i]==ele){
rem=arr.splice(i,1);
}
}
return arr;
}
function autolist(n,e,ch,_2bc2){
if(n.value==""){
hidepopup(ch);
matcharray=new Array();
return 0;
}
if(e.type=="keydown"){
if(popupon==true){
if(e.keyCode==9){
n.backspace=true;
hidepopup(ch);
HTMLArea._stopEvent(e);
}
return 0;
}
}
if(e.type=="blur"){
if(popupon==true){
hidepopup(ch);
}
}
if(e.type=="keyup"){
if(popupon){
if(e.keyCode==27){
hidepopup(ch);
return 0;
}
if(e.keyCode==13){
n.backspace=true;
fillarea(n,ch);
return 0;
}
if(e.keyCode==33){
}
if(e.keyCode==34){
}
if(e.keyCode==36){
}
if(e.keyCode==35){
}
if(e.keyCode==38){
if(position>-1){
if(position!=0){
position--;
}
}
adjustpopup(n,ch);
return 0;
}
if(e.keyCode==40){
if(position<totalmatch-1){
position++;
}
adjustpopup(n,ch);
return 0;
}
if(e.keyCode==37){
}
if(e.keyCode==39){
}
}
var _2bc3=n.value;
var _2bc4=_2bc3.lastIndexOf(",");
if(_2bc4>-1){
_2bc3=_2bc3.substring(_2bc4+1,_2bc3.length);
}
_2bc3=_2bc3.trim();
if(_2bc3==""||_2bc3=="\n"){
return 0;
}
matcharray=new Array();
totalmatch=0;
try{
(_2bc2)?(matcharray=eval(_2bc2+"('"+_2bc3+"')")):void (0);
}
catch(e){
hidepopup(ch);
}
totalmatch=matcharray.length;
if(matcharray&&matcharray.length>0){
position=0;
setIds(n,ch);
}else{
hidepopup(ch);
}
}
return 0;
}
var userArray;
function fillMyUsers(_2bc5){
if(_2bc5==null||!(_2bc5.hasChildNodes())){
return;
}
userArray=new Array();
if(_2bc5.firstChild.hasChildNodes()){
var _2bc6=_2bc5.firstChild.childNodes;
for(var x=0;x<_2bc6.length;x++){
node=_2bc6.item(x);
if(node.nodeName=="document"){
emailstr=node.firstChild.nodeValue;
tempArr=emailstr.split(",");
for(i=0;i<tempArr.length;i++){
userArray.push(tempArr[i]);
}
}
}
}
}
function matchSample(str){
var temp=new Array();
str=escapeSpecialChar(str);
var limit=10;
for(z=0;z<userArray.length;z++){
tmp=escapeSpecialChar(userArray[z],"no");
var re1=new RegExp("^"+str+".*?","gi");
var re2=new RegExp(escapeSpecialChar("(")+str,"gi");
var re3=new RegExp(escapeSpecialChar(" ")+str,"gi");
var m1=re1.exec(tmp);
var m2=re2.exec(tmp);
var m3=re3.exec(tmp);
if((m1&&m1.index==0)||(m2&&m2.index!=-1)||(m3&&m3.index!=-1)){
temp[temp.length]=unescapeSpecialChar(tmp);
if(limit&&temp.length==limit){
break;
}
}
}
return temp;
}
function matchCountry(str){
var temp=new Array();
str=escapeSpecialChar(str);
var limit=10;
for(z=0;z<countryArray.length;z++){
tmp=escapeSpecialChar(countryArray[z],"no");
var re=new RegExp("^"+str+".*?","gi");
var m=re.exec(tmp);
if(m&&m.index==0){
temp[temp.length]=unescapeSpecialChar(tmp);
if(limit&&temp.length==limit){
break;
}
}
}
return temp;
}
function createDummyForAutoFill(){
var span=document.createElement("SPAN");
span.id="_dummyForAutoFill";
span.style.position="absolute";
span.style.top="-100000px";
span.style.left="-100000px";
span.style.whiteSpace="nowrap";
document.body.appendChild(span);
window["_dummyForAutoFill"]=span;
}
function invokeAutoFill(el){
var pos=getAutoFillPos(el);
_suggestLayer.style.display="block";
_suggestLayer.style.left=pos[0]+"px";
_suggestLayer.style.top=pos[1]+"px";
}
function getAutoFillPos(el){
if(browser_ie){
el=window.event.srcElement;
}
var pos=getCaretPosByLine(el);
var x=findPosX(el);
var y=findPosY(el);
var lh=parseInt(el.style.lineHeight);
if(isNaN(lh)){
lh=15;
}
y1=y+(lh*pos[0]);
if(y1>(y+el.offsetHeight)){
y1=y+el.offsetHeight;
}else{
y1+=3;
}
if(typeof _dummyForAutoFill=="undefined"){
createDummyForAutoFill();
}
_dummyForAutoFill.className=el.className;
_dummyForAutoFill.fontFamily=el.style.fontFamily;
_dummyForAutoFill.fontSize=el.style.fontSize;
_dummyForAutoFill.fontWeight=el.style.fontWeight;
_dummyForAutoFill.fontStyle=el.style.fontStyle;
_dummyForAutoFill.innerHTML=getTextByLine(el,pos[0],0,pos[1]);
var x1=x+_dummyForAutoFill.offsetWidth;
if(x1>(x+el.offsetWidth)){
x1=x+el.offsetWidth;
}
return [x1,y1];
}
var copyStatus=false,copyRange=false,cutStatus=false,cutRange=false;
var copyCellRow,copyCellCol;
var copyRangeStartRow,copyRangeStartCol,copyRangeEndRow,copyRangeEndCol;
var tmpSheetName;
var extraRows=0;
var extraCols=2;
var tmpCopyStatus;
var tmpCutStatus;
var flashON=false;
var pasteOnly=false;
var insertCopyRows=false;
var insertCopyCols=false;
var insertCutRows=false;
var insertCutCols=false;
var arrInCopyRange;
function resetCopyPasteVars(){
copyStatus=false;
cutStatus=false;
pasteOnly=false;
flashON=false;
}
function setCopyStatus(){
copyStatus=true;
cutStatus=false;
pasteOnly=false;
}
function setCutStatus(){
cutStatus=true;
copyStatus=false;
pasteOnly=false;
}
function setPasteStatus(){
if(cutStatus){
copyStatus=false;
cutStatus=false;
}
if(copyStatus){
copyStatus=true;
}
}
function copyCells(from,_2be0,_2be1){
if(isRowSelected()){
changebuttonsState("insertRowColumn","disable",["inscolstbtn","inscolsmenu"]);
changebuttonsState("insertRowColumn","enable",["insrowstbtn","insrowsmenu"]);
if(from=="cutCells"){
insertCutRows=true;
insertCopyRows=false;
}else{
insertCopyRows=true;
insertCutRows=false;
}
}
if(isColSelected()){
changebuttonsState("insertRowColumn","enable",["inscolstbtn","inscolsmenu"]);
changebuttonsState("insertRowColumn","disable",["insrowstbtn","insrowsmenu"]);
if(from=="cutCells"){
insertCutCols=true;
insertCopyCols=false;
}else{
insertCopyCols=true;
insertCutCols=false;
}
}
if(isCellRange()){
if(from=="cutCells"){
cutRange=true;
}else{
copyRange=true;
}
var _2be2=getCellRange();
copyRangeStartRow=_2be2.startRow;
copyRangeStartCol=_2be2.startCol;
copyRangeEndRow=_2be2.endRow;
copyRangeEndCol=_2be2.endCol;
}else{
if(from=="cutCells"){
cutRange=false;
}else{
copyRange=false;
}
var info=ActiveCellInfo;
var _2be4=info.getStartCol();
var _2be5=info.getEndCol();
var _2be6=info.getStartRow();
var _2be7=info.getEndRow();
copyCellRow=_2be6;
copyCellCol=_2be4;
copyRangeStartCol=_2be4;
copyRangeEndCol=_2be5;
copyRangeStartRow=_2be6;
copyRangeEndRow=_2be7;
}
if(Filter.isApplied()&&Row.getHiddenRowCount(copyRangeStartRow,copyRangeEndRow)!==0){
isCopiedRowRangeHasFilteredRows=true;
}else{
isCopiedRowRangeHasFilteredRows=false;
}
if(from=="cutCells"&&isPartOfArray(copyRangeStartRow,copyRangeStartCol,copyRangeEndRow,copyRangeEndCol)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
focusCellRange(currRow,currCol,currRow+(copyRangeEndRow-copyRangeStartRow),currCol+(copyRangeEndCol-copyRangeStartCol),undefined,true);
hideCellRangeFillDIV();
return false;
}
var _2be8=(from=="cutCells")?false:true;
arrInCopyRange=getArraysInRange(copyRangeStartRow,copyRangeStartCol,copyRangeEndRow,copyRangeEndCol,_2be8);
tmpSheetName=CURRSHEETNAME;
if(from=="cutCells"){
cutStatus=true;
copyStatus=false;
pasteOnly=false;
focusCellRangeFill(copyRangeStartRow,copyRangeStartCol,copyRangeEndRow,copyRangeEndCol,_2be0);
flashON=true;
}else{
if(from!="fromPasteCell"){
cutStatus=false;
copyStatus=true;
focusCellRangeFill(copyRangeStartRow,copyRangeStartCol,copyRangeEndRow,copyRangeEndCol,true);
flashON=true;
}
cutStatus=false;
copyStatus=true;
}
if(!_2be1){
if(!isDocumentReadyToEdit){
return;
}
tmpCopyStatus=copyStatus;
tmpCutStatus=cutStatus;
if(from=="cutCells"||from=="fromPasteCell"||from=="formatPainter"){
return;
}
var _2be9=swfobject.getFlashPlayerVersion().major;
if(!_2be9&&from!="copyShortCut"){
notify("Info",replaceParams(jsMsg["ClipBoardMessage.OutOfViewPort"],new Array("<a onclick='javascript:copytoclip();' style='color: #2E60AA;' href='#'>","</a>"),""));
return;
}
showProgressMessage(jsMsg["Copying"]);
var _2bea=getSelectedTextToCopy(from);
if(!_2bea){
hideProgressMessage();
return;
}
if(window.clipboardData&&clipboardData.setData){
clipboardData.setData("text",_2bea);
hideProgressMessage();
return;
}else{
if(from=="flash"){
return _2bea;
}else{
if(from=="copyShortCut"){
var _2beb=getObj("cpTextArea");
_2beb.value=_2bea;
_2beb.focus();
_2beb.select();
setTimeout(function(){
cellField.focus();
_2beb.value="";
hideProgressMessage();
},200);
return;
}
}
}
}
}
function copyToTextArea(from){
tmpCopyStatus=copyStatus;
tmpCutStatus=cutStatus;
var _2bed=cellField,_2bee="";
if(isCellRange()){
var _2bef=false;
if((copyRangeStartRow<getAvailableStartRow()||copyRangeEndRow>getAvailableEndRow())&&from!="fromPasteCell"){
_2bef=true;
notify("Info",replaceParams(jsMsg["ClipBoardMessage.OutOfViewPort"],new Array("<a onclick='javascript:copytoclip();' style='color: #2E60AA;' href='#'>","</a>"),""));
}
var range=new Range(copyRangeStartRow,copyRangeStartCol,copyRangeEndRow,copyRangeEndCol);
var iter=range.getIterator();
iter.initData(_2bee);
iter.setDataProcessor(function(val){
var data=this.getData();
data+=val;
return data;
});
iter.addEventListener("onRowAfter",function(row,col){
this.processData("\n");
});
iter.iterate(function(row,col,_2bf8){
var cell=getCell(row,col,getSheetPaneId(getSheetPane(row.col)));
if(cell){
var cV=cell.getAttribute("cV");
if(cV==null){
cV="";
}
this.processData(cV);
if(col!=_2bf8){
this.processData("\t");
}
}
},copyRangeEndCol);
_2bee=iter.getData();
_2bed.value=_2bee;
}else{
if(currCell){
var cV=currCell.getAttribute("cV");
}
if(cV==null||cV=="null"){
cV="";
}
if(isCellFieldSPANHided()&&!isCellEdited()){
_2bed.value=cV;
}
}
if(isCellFieldSPANHided()&&!isCellEdited()){
if(from=="cutCells"||_2bef){
_2bed.value="";
}
getObj("cpTextArea").value=_2bed.value;
_2bed.focus();
_2bed.select();
}
if(browser_safari){
if(isCellFieldSPANHided()&&!isCellEdited()){
setTimeout(function(){
cellField.value="";
},50);
}
}
}
function unsetStatus(){
copyStatus=false;
cutStatus=false;
}
function adjustRowsAndCols(){
var _2bfc=currRow+(copyRangeEndRow-copyRangeStartRow)+1;
var _2bfd=currCol+(copyRangeEndCol-copyRangeStartCol)+1;
if(_2bfc>totRows){
var nRows=(_2bfc-totRows)+extraRows;
appendBlankRows("ROWS_EXCEEDED",_2bfc);
}
if(_2bfd>totCols){
var nCols=(_2bfd-totCols)+extraCols;
insertCol("append",totCols,nCols,true,true,true,undefined,undefined,undefined,undefined,true);
}
}
function cellRangeContainsMergeCells(_2c00,_2c01,_2c02,_2c03){
var _2c04=false;
var iter=Merge.getIterator(_2c00,_2c01,_2c02,_2c03);
iter.initData(_2c04);
iter.setDataProcessor(function(val){
return val;
});
iter.iterate(function(){
this.processData(true);
this.interrupt();
});
_2c04=iter.getData();
return _2c04;
}
function adjustArrayCells(_2c07,_2c08){
var _2c09=getCellRange();
var _2c0a;
var _2c0b;
if(isNumber(_2c07)&&isNumber(_2c08)){
_2c0a=_2c07;
_2c0b=_2c08;
}else{
_2c0a=_2c09.startRow;
_2c0b=_2c09.startCol;
}
var _2c0c=_2c0a+(copyRangeEndRow-copyRangeStartRow);
var _2c0d=_2c0b+(copyRangeEndCol-copyRangeStartCol);
var _2c0e=null;
if(tmpSheetName==CURRSHEETNAME&&cutStatus&&(((_2c0b>=copyRangeStartCol&&_2c0b<=copyRangeEndCol)||(_2c0d>=copyRangeStartCol&&_2c0d<=copyRangeEndCol))&&((_2c0a>=copyRangeStartRow&&_2c0a<=copyRangeEndRow)||(_2c0c>=copyRangeStartRow&&_2c0c<=copyRangeEndRow)))){
_2c0e=arrInCopyRange;
clearOldArrayPosition(copyRangeStartRow,copyRangeStartCol,copyRangeEndRow,copyRangeEndCol);
}
if(isPartOfArray(_2c0a,_2c0b,_2c0c,_2c0d)){
if(_2c0e!=null){
for(var j=0;j<_2c0e.length;j++){
arrayDetails.push(_2c0e[j]);
}
}
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return true;
}
var _2c10=new Array();
for(var i=0;i<arrInCopyRange.length;i++){
var obj=arrInCopyRange[i];
var sRow=_2c0a+obj[0]-copyRangeStartRow;
var eRow=_2c0a+obj[1]-copyRangeStartRow;
var sCol=_2c0b+obj[2]-copyRangeStartCol;
var eCol=_2c0b+obj[3]-copyRangeStartCol;
if(isPartOfArray(sRow,sCol,eRow,eCol)){
if(_2c0e!=null){
for(var j=0;j<_2c0e.length;j++){
arrayDetails.push(_2c0e[j]);
}
}
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return true;
}else{
var arr=new Array();
arr[0]=sRow;
arr[1]=eRow;
arr[2]=sCol;
arr[3]=eCol;
_2c10.push(arr);
}
}
clearOldArrayPosition(_2c0a,_2c0b,_2c0c,_2c0d);
if(tmpSheetName==CURRSHEETNAME){
if(cutStatus){
clearOldArrayPosition(copyRangeStartRow,copyRangeStartCol,copyRangeEndRow,copyRangeEndCol);
}
for(var j=0;j<_2c10.length;j++){
var _2c18=_2c10[j];
var sR=_2c18[0];
var eR=_2c18[1];
var sC=_2c18[2];
var eC=_2c18[3];
updateArrayDetails("SUBMIT",sR,sC,eR,eC);
}
}
return false;
}
function adjustMergeCellsForCopyRange(_2c1d,_2c1e){
if(isPasteAreaContainsMergedCells(_2c1d,_2c1e)){
showAlertDialog(jsTitleMsg.CannotPasteIntoMergedCell);
if(cellDragProps.isDraggable){
dragDIV.style.display="none";
dragDIV1.style.display="none";
dragDIV2.style.display="none";
dragDIV3.style.display="none";
}
return true;
}
var _2c1f=copyRangeEndRow-copyRangeStartRow+1;
var _2c20=copyRangeEndCol-copyRangeStartCol+1;
var _2c21=cellRangeContainsMergeCells(copyRangeStartRow,copyRangeStartCol,copyRangeEndRow,copyRangeEndCol);
if(_2c21){
if(cellDragProps.isDraggable){
var _2c22=cellDragProps.cellDragRange.CSR;
var _2c23=cellDragProps.cellDragRange.CSC;
var _2c24=cellDragProps.cellDragRange.CER;
var _2c25=cellDragProps.cellDragRange.CEC;
focusCellRange(_2c22,_2c23,_2c24,_2c25);
}else{
if(isCellRange()){
var _2c26=getCellRange();
var _2c22=_2c26.startRow;
var _2c23=_2c26.startCol;
focusCellRange(_2c22,_2c23,_2c22+_2c1f-1,_2c23+_2c20-1);
}else{
focusCellRange(currRow,currCol,currRow+_2c1f-1,currCol+_2c20-1);
}
}
}
if(cellDragProps.isDraggable){
var _2c22=cellDragProps.cellDragRange.CSR;
var _2c23=cellDragProps.cellDragRange.CSC;
var _2c24=cellDragProps.cellDragRange.CER;
var _2c25=cellDragProps.cellDragRange.CEC;
}else{
var _2c26=getCellRange();
var _2c22=_2c26.startRow;
var _2c23=_2c26.startCol;
var _2c24=_2c26.endRow;
var _2c25=_2c26.endCol;
}
if(cellRangeContainsMergeCells(_2c22,_2c23,_2c24,_2c25)){
showAlertDialog(jsTitleMsg.CannotPasteIntoMergedCell);
return true;
}
if(_2c21){
var range=new Range(copyRangeStartRow,copyRangeStartCol,copyRangeEndRow,copyRangeEndCol);
var iter=range.getIterator();
iter.addEventListener("onMergeEncounter",function(row,col,_2c2b,_2c2c,_2c2d){
var _2c2e=getCell(row,col);
if(_2c2e){
var objct=this.getMerge();
var _2c30=objct.getRowSpan();
var _2c31=objct.getColSpan();
var _2c32=row-_2c2c;
var _2c33=col-_2c2d;
var _2c34=_2c2b.startRow+_2c32;
var _2c35=_2c2b.startCol+_2c33;
var _2c36=_2c34+_2c30-1;
var _2c37=_2c35+_2c31-1;
mergeCells(_2c34,_2c35,_2c36,_2c37,true,true,true);
}
},_2c26,copyRangeStartRow,copyRangeStartCol);
iter.iterate();
}
return false;
}
function adjustMergeCellsForCopyCell(_2c38,_2c39){
var _2c3a,_2c3b,cols,rows=1,_2c3e,_2c3f;
if(isPasteAreaContainsMergedCells(_2c38,_2c39)){
showAlertDialog(jsTitleMsg.CannotPasteIntoMergedCell);
if(cellDragProps.isDraggable){
dragDIV.style.display="none";
dragDIV1.style.display="none";
dragDIV2.style.display="none";
dragDIV3.style.display="none";
}
return true;
}
var info=Merge.getCellInfo(copyCellRow,copyCellCol);
if(info){
cols=info.getColSpan();
rows=info.getRowSpan();
}
if(cols==1||rows==1){
return false;
}
if(isCellRange()){
var _2c41=getCellRange();
var _2c42=_2c41.endCol-_2c41.startCol+1;
var _2c43=_2c41.endRow-_2c41.startRow+1;
var _2c44=_2c42/cols;
var _2c45=_2c43/rows;
var _2c46=Math.floor(_2c44);
var _2c47=Math.floor(_2c45);
var _2c48=_2c46;
var _2c49=_2c47;
if(_2c46!=_2c44){
_2c48=1;
}
if(_2c47!=_2c45){
_2c49=1;
}
var _2c3b=_2c41.startCol+_2c48*cols;
var _2c3f=_2c41.startRow+_2c49*rows;
if(cellRangeContainsMergeCells(_2c41.startRow,_2c41.startCol,_2c3f,_2c3b)){
showAlertDialog(jsTitleMsg.CannotPasteIntoMergedCell);
return true;
}
for(i=0;i<_2c49;i++){
for(j=0;j<_2c48;j++){
_2c3e=_2c41.startRow+i*rows;
_2c3a=_2c41.startCol+j*cols;
_2c3f=_2c3e+rows-1;
_2c3b=_2c3a+cols-1;
mergeCells(_2c3e,_2c3a,_2c3f,_2c3b,true,true,true);
}
}
}else{
if(cellDragProps.isDraggable){
_2c3e=cellDragProps.cellDragRange.CSR;
_2c3a=cellDragProps.cellDragRange.CSC;
_2c3f=cellDragProps.cellDragRange.CER;
_2c3b=cellDragProps.cellDragRange.CEC;
}else{
_2c3e=currRow;
_2c3a=currCol;
_2c3f=currRow+rows-1;
_2c3b=currCol+cols-1;
}
if(cellRangeContainsMergeCells(_2c3e,_2c3a,_2c3f,_2c3b)){
showAlertDialog(jsTitleMsg.CannotPasteIntoMergedCell);
return true;
}
mergeCells(_2c3e,_2c3a,_2c3f,_2c3b,true,true,true);
return false;
}
return false;
}
function pasteCells(_2c4a,_2c4b){
var _2c4c=getObj("notifier");
if(_2c4c){
hideNotifier();
}
if(copyStatus){
if(copyRange){
if((tmpSheetName==CURRSHEETNAME&&adjustMergeCellsForCopyRange(_2c4a,_2c4b))||adjustArrayCells(_2c4a,_2c4b)){
return false;
}
if(isCellRange()){
if(isNumber(_2c4a)&&isNumber(_2c4b)){
copyRangeToCellRange(_2c4a,_2c4b);
}else{
return copyRangeToCellRange();
}
}else{
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
adjustRowsAndCols();
submitCopyPasteCellRange();
}
}else{
if((tmpSheetName==CURRSHEETNAME&&adjustMergeCellsForCopyCell(_2c4a,_2c4b))||adjustArrayCells(_2c4a,_2c4b)){
return false;
}
if(isCellRange()){
copyCellToCellRange();
}else{
if(isNumber(_2c4a)&&isNumber(_2c4b)){
submitCopyPasteCell(_2c4a,_2c4b);
focusCell(_2c4a,_2c4b);
}else{
submitCopyPasteCell();
}
}
}
document.cellform.actionMode.value="";
}else{
if(cutStatus){
if(isPartOfArray(copyRangeStartRow,copyRangeStartCol,copyRangeEndRow,copyRangeEndCol)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
focusCellRange(currRow,currCol,currRow+(copyRangeEndRow-copyRangeStartRow),currCol+(copyRangeEndCol-copyRangeStartCol),undefined,true);
hideCellRangeFillDIV();
return false;
}else{
if(adjustArrayCells(_2c4a,_2c4b)){
return false;
}
if(cutRange){
adjustRowsAndCols();
if(isNumber(_2c4a)&&isNumber(_2c4b)){
submitCutPasteCellRange(_2c4a,_2c4b);
}else{
submitCutPasteCellRange();
}
}else{
if(isNumber(_2c4a)&&isNumber(_2c4b)){
submitCutPasteCell(_2c4a,_2c4b);
focusCell(_2c4a,_2c4b);
}else{
submitCutPasteCell();
}
}
document.cellform.actionMode.value="";
copyCells("fromPasteCell");
cutStatus=false;
copyStatus=false;
flashON=false;
}
}else{
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
copyCellRow=row;
copyCellCol=col;
if(browser_safari){
cellField.style.width="22px";
cellField.style.height="22px";
cellField.style.fontSize="1px";
}
var _2c50=cellField;
_2c50.focus();
_2c50.select();
setTimeout("pasteCellsFromTextArea()",50);
}
}
if(insertCutRows||insertCutCols||cutStatus){
insertCutRows=false;
insertCutCols=false;
cutStaus=false;
}
changebuttonsState("insertRowColumn","enable",["insrowstbtn","insrowsmenu"]);
changebuttonsState("insertRowColumn","enable",["inscolstbtn","inscolsmenu"]);
}
function pasteCellsFromTextArea(){
if(DOCUMENT_ID=="doc_id"){
var val=cellField.value;
if(val.indexOf("=stock(")!=-1||val.indexOf("=STOCK(")!=-1){
SAVED=false;
saveForward="pasteCellsFromTextArea";
autosave();
return;
}
}
var _2c52=getCellRange();
if(cellRangeContainsMergeCells(_2c52.startRow,_2c52.startCol,_2c52.endRow,_2c52.endCol)){
hideCellField();
showAlertDialog(jsTitleMsg.CannotPasteIntoMergedCell);
return true;
}
if(adjustColsAndRowsForTextArea()){
return true;
}
if(cellField.value.trim()==""){
return true;
}
var _2c53=cellField;
var _2c54=getAvailableStartRow();
var _2c55=getAvailableEndRow();
document.cellform.column.value=copyCellCol;
document.cellform.row.value=copyCellRow;
document.cellform.actionMode.value="CopyPasteTextArea";
document.cellform.textAreaValue.value=doit(_2c53.value);
document.cellform.textAreaValue.value=copypastedoit(document.cellform.textAreaValue.value);
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.availableStartRow.value=_2c54;
document.cellform.availableEndRow.value=_2c55;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
document.cellform.totCols.value=totCols;
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2c56=getObj("apiKey");
if(_2c56!=null){
document.cellform.apiKeyId.value=_2c56.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
if($("#fileName")!=null){
document.cellform.tmpSheet.value=encodeURIComponent($("#fileName").text());
}
importxmlForForm(document.cellform,updateCell,true);
_2c53.blur();
hideCellField();
hideCellRangeFillDIV();
}
function copypastedoit(text){
text=text.replace(String.fromCharCode(8220),"%22");
text=text.replace(String.fromCharCode(8221),"%22");
text=text.replace(String.fromCharCode(8216),"%27");
text=text.replace(String.fromCharCode(8219),"%27");
return text;
}
function adjustColsAndRowsForTextArea(){
var _2c58=0,_2c59=0,cols=0;
var str=cellField.value;
var _2c5c=str.split("\n");
_2c59=_2c5c.length-1;
for(i=0;i<_2c5c.length;i++){
cols=(_2c5c[i].split("\t")).length-1;
if(cols>_2c58){
_2c58=cols;
}
}
if(isPartOfArray(currRow,currCol,currRow+_2c59,currCol+_2c58)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return true;
}
clearOldArrayPosition(currRow,currCol,currRow+_2c59,currCol+_2c58);
if(cols==0){
_2c59=_2c59-1;
}
_2c59=_2c59+currRow;
_2c58=_2c58+currCol;
if(_2c59>totRows){
var nRows=(_2c59-totRows)+extraRows;
appendBlankRows("ROWS_EXCEEDED",totRows+nRows);
usedCursRow=_2c59;
}
if(_2c58>totCols){
var nCols=(_2c58-totCols)+extraCols;
insertCol("append",totCols,nCols,true,true,true,undefined,undefined,undefined,undefined,true);
}
}
function submitCopyPasteCell(_2c5f,_2c60){
var sRow=copyCellRow;
var sCol=copyCellCol;
var eRow=copyCellRow;
var eCol=copyCellCol;
var info=Merge.getCellInfo(copyCellRow,copyCellCol);
if(info){
sRow=info["startRow"];
sCol=info["startCol"];
eRow=info["endRow"];
eCol=info["endCol"];
}
if(isCellRange()){
var _2c66=getCellRange();
document.cellform.tmpData.value="ToRange";
document.cellform.column.value=_2c66.startCol;
document.cellform.row.value=_2c66.startRow;
document.cellform.textAreaValue.value=_2c66.endRow;
document.cellform.formattedCellValue.value=_2c66.endCol;
}else{
document.cellform.tmpData.value="ToCell";
if(isNumber(_2c5f)&&isNumber(_2c60)){
document.cellform.column.value=_2c60;
document.cellform.row.value=_2c5f;
}else{
document.cellform.column.value=ActiveCellInfo.getStartCol();
document.cellform.row.value=ActiveCellInfo.getStartRow();
}
}
var _2c67=getAvailableStartRow();
var _2c68=getAvailableEndRow();
document.cellform.actionMode.value="CopyPaste";
document.cellform.startColumn.value=sCol;
document.cellform.endColumn.value=eCol;
document.cellform.startRow.value=sRow;
document.cellform.endRow.value=eRow;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.tmpSheet.value=tmpSheetName;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_2c67;
document.cellform.availableEndRow.value=_2c68;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
document.cellform.totCols.value=totCols;
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2c69=getObj("apiKey");
if(_2c69!=null){
document.cellform.apiKeyId.value=_2c69.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
hideCellRangeFillDIV();
focusSheet();
}
function submitCopyPasteCellRange(_2c6a,_2c6b){
if(isCellRange()){
if(isNumber(_2c6a)&&isNumber(_2c6b)){
document.cellform.tmpData.value="ToCell";
document.cellform.column.value=_2c6b;
document.cellform.row.value=_2c6a;
}else{
var _2c6c=getCellRange();
document.cellform.tmpData.value="ToRange";
document.cellform.column.value=_2c6c.startCol;
document.cellform.row.value=_2c6c.startRow;
document.cellform.textAreaValue.value=_2c6c.endRow;
document.cellform.formattedCellValue.value=_2c6c.endCol;
}
}else{
document.cellform.column.value=ActiveCellInfo.getStartCol();
document.cellform.row.value=ActiveCellInfo.getStartRow();
document.cellform.tmpData.value="ToCell";
}
var _2c6d=getAvailableStartRow();
var _2c6e=getAvailableEndRow();
document.cellform.actionMode.value="CopyPaste";
document.cellform.startColumn.value=copyRangeStartCol;
document.cellform.endColumn.value=copyRangeEndCol;
document.cellform.startRow.value=copyRangeStartRow;
document.cellform.endRow.value=copyRangeEndRow;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.tmpSheet.value=tmpSheetName;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_2c6d;
document.cellform.availableEndRow.value=_2c6e;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
document.cellform.totCols.value=totCols;
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2c6f=getObj("apiKey");
if(_2c6f!=null){
document.cellform.apiKeyId.value=_2c6f.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
hideCellRangeFillDIV();
}
function submitCopytoClip(_2c70){
var _2c71=getAvailableStartRow();
var _2c72=getAvailableEndRow();
var _2c73=document.cellform;
_2c73.actionMode.value="copyToClip";
_2c73.startColumn.value=_2c70.startCol;
_2c73.endColumn.value=_2c70.endCol;
_2c73.startRow.value=_2c70.startRow;
_2c73.endRow.value=_2c70.endRow;
_2c73.currentTime.value=CURRENTTIME;
_2c73.currentSheet.value=CURRSHEETNAME;
_2c73.tmpSheet.value=tmpSheetName;
_2c73.documentId.value=DOCUMENT_ID;
_2c73.documentOwner.value=CURR_DOC_OWNERNAME;
_2c73.collabId.value=COLLAB_ID;
_2c73.afterRTC.value="false";
_2c73.allowWrite.value=ALLOW_TO_WRITE;
_2c73.collabEditing.value=COLLABORATIVE_EDITING;
_2c73.isStockConfigured.value=isStockConfigured;
_2c73.isDocSaved.value=isDocSaved();
_2c73.bridgeNo.value=bridgeNumber;
_2c73.availableStartRow.value=_2c71;
_2c73.availableEndRow.value=_2c72;
_2c73.isColSelected.value=isColSelected();
_2c73.isRowSelected.value=isRowSelected();
_2c73.totCols.value=totCols;
if(jsREMOTE_SAVE_VIEW){
_2c73.remoteEditorUser.value=RMUSER;
}
var _2c74=_2c73.actionMode.value.toUpperCase();
_2c73.currentSelection.value=getCurrentSelection();
var _2c75=_2c73.action;
_2c75+=((_2c75.indexOf("?")+1)?"&":"?")+"randomNo="+Math.random();
_2c73.view.value=getObj("VIEW").value;
var _2c76=new XMLHttpRequest();
var _2c77=_2c73.elements;
var _2c78=_2c77.length;
var nvp="";
for(var i=0;i<_2c78;i++){
try{
var _2c7b=_2c77[i];
var _2c7c=_2c7b.name;
var rVal=_2c7b.value;
nvp+=_2c7c+"="+rVal+"&";
}
catch(e){
showAlert(e);
}
}
nvp=appendCSRFToURL(nvp);
nvp=nvp.replace(/\+/g,"%2B");
nvp=encodeURI(nvp);
_2c76.onreadystatechange=function(){
if(_2c76.readyState==4){
var _2c7e=_2c76.responseText;
if(_2c7e=="Error"){
showAlertDialog(jsTitleMsg.ErrorOccurred);
return;
}else{
var _2c7f=_2c76.status;
var _2c80=_2c76.statusText;
if(_2c7f>12000||_2c7f==0){
handleServerError("ERROR","ConnectionLost",true,true);
return;
}
if(_2c7f>=300){
errorAlert(_2c7f,_2c80);
return;
}
if(_2c7e==null||typeof _2c7e=="undefined"){
recalculate("",true);
return;
}
var _2c81=parseJSON(_2c7e);
var _2c82=_2c81["dataSelected"];
showClipBoard(_2c82);
return;
}
}
};
_2c76.open("POST",_2c75,true);
_2c76.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_2c76.setRequestHeader("Content-length",nvp.length);
_2c76.send(nvp);
}
function copyRangeToCellRange(_2c83,_2c84){
if(isCellRange()){
var _2c85=getCellRange();
var _2c86=copyRangeEndCol-copyRangeStartCol+1;
var _2c87=copyRangeEndRow-copyRangeStartRow+1;
var _2c88=_2c85.endCol-_2c85.startCol+1;
var _2c89=_2c85.endRow-_2c85.startRow+1;
if(_2c88/_2c86<1||_2c89/_2c87<1){
var a=showConfirmDialog(jsTitleMsg.TheContentCopiedIsBigger+" "+jsTitleMsg.DoYouWantToInsertAnyway);
if(!a){
return false;
}
adjustRowsAndCols();
}
}
submitCopyPasteCellRange(_2c83,_2c84);
return true;
}
function copyCellToCellRange(){
submitCopyPasteCell();
}
function isPasteAreaContainsMergedCells(_2c8b,_2c8c){
if(cellDragProps.isDraggable){
var _2c8d=Merge.getCellInfo(_2c8b,_2c8c);
if(_2c8d){
return true;
}else{
var _2c8e=cellDragProps.cellDragRange.CER-cellDragProps.cellDragRange.CSR;
var _2c8f=cellDragProps.cellDragRange.CEC-cellDragProps.cellDragRange.CSC;
var sR=_2c8b;
var sC=_2c8c;
var eR=sR+_2c8e;
var eC=sC+_2c8f;
if(cellRangeContainsMergeCells(sR,sC,eR,eC)){
return true;
}
}
}else{
if(ActiveCellInfo.isMerged()){
return true;
}else{
var _2c8e=copyRangeEndRow-copyRangeStartRow;
var _2c8f=copyRangeEndCol-copyRangeStartCol;
var sR=ActiveCellInfo.getStartRow();
var sC=ActiveCellInfo.getStartCol();
var eR=sR+_2c8e;
var eC=sC+_2c8f;
if(cellRangeContainsMergeCells(sR,sC,eR,eC)){
return true;
}
}
}
}
function submitCutPasteCell(_2c94,_2c95){
if(isPasteAreaContainsMergedCells(_2c94,_2c95)){
showAlertDialog(jsTitleMsg.CannotPasteIntoMergedCell);
if(cellDragProps.isDraggable){
dragDIV.style.display="none";
dragDIV1.style.display="none";
dragDIV2.style.display="none";
dragDIV3.style.display="none";
}
return true;
}
if(isNumber(_2c94)&&isNumber(_2c95)){
var sRow=_2c94;
var sCol=_2c95;
var info=Merge.getCellInfo(sRow,sCol);
if(info){
sRow=info.startRow;
sCol=info.startCol;
}
document.cellform.column.value=sCol;
document.cellform.row.value=sRow;
}else{
var info=ActiveCellInfo;
var sRow=info.getStartRow();
var sCol=info.getStartCol();
document.cellform.column.value=sCol;
document.cellform.row.value=sRow;
}
if(pasteOnly){
document.cellform.actionMode.value="PasteOnly";
}else{
document.cellform.actionMode.value="CutPaste";
cutStatus=false;
}
var sRow=copyCellRow;
var sCol=copyCellCol;
var eRow=copyCellRow;
var eCol=copyCellCol;
var info=Merge.getCellInfo(copyCellRow,copyCellCol);
if(info){
sRow=info["startRow"];
sCol=info["startCol"];
eRow=info["endRow"];
eCol=info["endCol"];
}
var _2c9b=getAvailableStartRow();
var _2c9c=getAvailableEndRow();
document.cellform.startColumn.value=sCol;
document.cellform.endColumn.value=eCol;
document.cellform.startRow.value=sRow;
document.cellform.endRow.value=eRow;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.tmpSheet.value=tmpSheetName;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_2c9b;
document.cellform.availableEndRow.value=_2c9c;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
document.cellform.totCols.value=totCols;
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2c9d=getObj("apiKey");
if(_2c9d!=null){
document.cellform.apiKeyId.value=_2c9d.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
hideCellRangeFillDIV();
}
function submitCutPasteCellRange(_2c9e,_2c9f){
if(isPasteAreaContainsMergedCells(_2c9e,_2c9f)){
showAlertDialog(jsTitleMsg.CannotPasteIntoMergedCell);
if(cellDragProps.isDraggable){
dragDIV.style.display="none";
dragDIV1.style.display="none";
dragDIV2.style.display="none";
dragDIV3.style.display="none";
}
return true;
}
if(isNumber(_2c9e)&&isNumber(_2c9f)){
var sRow=_2c9e;
var sCol=_2c9f;
var info=Merge.getCellInfo(sRow,sCol);
if(info){
sRow=info.startRow;
sCol=info.startCol;
}
document.cellform.column.value=sCol;
document.cellform.row.value=sRow;
}else{
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
document.cellform.column.value=col;
document.cellform.row.value=row;
}
if(pasteOnly){
document.cellform.actionMode.value="PasteOnly";
}else{
document.cellform.actionMode.value="CutPaste";
cutStatus=false;
}
var _2ca5=getAvailableStartRow();
var _2ca6=getAvailableEndRow();
document.cellform.startColumn.value=copyRangeStartCol;
document.cellform.endColumn.value=copyRangeEndCol;
document.cellform.startRow.value=copyRangeStartRow;
document.cellform.endRow.value=copyRangeEndRow;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.tmpSheet.value=tmpSheetName;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_2ca5;
document.cellform.availableEndRow.value=_2ca6;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
document.cellform.totCols.value=totCols;
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2ca7=getObj("apiKey");
if(_2ca7!=null){
document.cellform.apiKeyId.value=_2ca7.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
hideCellRangeFillDIV();
}
function copyRangeStyle(){
var _2ca8=copyRangeEndRow-copyRangeStartRow;
var _2ca9=copyRangeEndCol-copyRangeStartCol;
for(var i=0;i<=_2ca8;i++){
for(var j=0;j<=_2ca9;j++){
setHeight(currRow+i,currCol+j);
}
}
}
function copyAndClearRangeStyle(){
var _2cac=copyRangeEndRow-copyRangeStartRow;
var _2cad=copyRangeEndCol-copyRangeStartCol;
for(var i=0;i<=_2cac;i++){
for(var j=0;j<=_2cad;j++){
setHeight(currRow+i,currCol+j);
}
}
}
function cutCells(){
copyCells("cutCells",true,false);
}
function getSelectedTextToCopy(from){
var _2cb1="";
if(isCellRange()){
var _2cb2=false;
if((copyRangeStartRow<getAvailableStartRow()||copyRangeEndRow>getAvailableEndRow())&&from!="fromPasteCell"){
var _2cb3=getCellRange();
var cols=0;
var rows=0;
var eRow=_2cb3.endRow;
var eCol=_2cb3.endCol;
if(eRow>usedCursRow){
rows=usedCursRow+1;
}else{
rows=(_2cb3.endRow+1)-_2cb3.startRow;
}
if(eCol>usedCursCol){
cols=usedCursCol;
}else{
cols=(_2cb3.endCol+1)-_2cb3.startCol;
}
var _2cb8=cols*rows;
if(_2cb8>10000){
var _2cb9=jsMsg["copylimit"]+"<br>"+replaceParams(jsMsg["wholerangecopy"],["<a onclick='javascript:copytoclip();' style='color: #2E60AA;' href='#'>","</a>"]);
var _2cba={"type":"warning","iconclass":"ui-components-icon ui-state-warning-icon","position":"southeast","content":_2cb9,"timeout":"15000","animate":true};
$(".ui-znotifier-base").remove();
$(document).znotifier(_2cba);
}
_2cb2=true;
_2cb1=getDataToBeCopied(getCellRange(),_2cb2);
return _2cb1;
}
var obj=getViewPortRoundedDetails(copyRangeStartRow,copyRangeEndRow);
var _2cbc=copyRangeEndCol-copyRangeStartCol;
if(obj.isInFreezedRange){
var range=new Range(obj.freezedStartRowIdx,copyRangeStartCol,obj.freezedEndRowIdx,copyRangeEndCol);
var iter=range.getIterator();
iter.initData(_2cb1);
iter.setDataProcessor(function(val){
var data=this.getData();
data+=val;
return data;
});
iter.addEventListener("onRowAfter",function(row,col){
this.processData("\n");
});
iter.iterate(function(row,col,_2cc5){
var cell=getCell(row,col);
if(cell){
var cV=cell.getAttribute("cV");
if(cV==null){
cV="";
}
if(/\n/.test(cV)){
if(/\"/g.test(cV)){
cV=cV.replace(/\"/g,"\"\"");
}
cV="\""+cV+"\"";
}
this.processData(cV);
if(col!=_2cc5){
this.processData("\t");
}
}
},copyRangeEndCol);
_2cb1=iter.getData();
}
if(obj.isInViewPort){
var range=new Range(obj.startRowIdx,copyRangeStartCol,obj.endRowIdx,copyRangeEndCol);
var iter=range.getIterator();
iter.initData(_2cb1);
iter.setDataProcessor(function(val){
var data=this.getData();
data+=val;
return data;
});
iter.addEventListener("onRowAfter",function(row,col){
this.processData("\n");
});
iter.iterate(function(row,col,_2cce){
var cell=getCell(row,col);
if(cell){
var cV=cell.getAttribute("cV");
if(cV==null){
cV="";
}
if(/\n/.test(cV)){
if(/\"/g.test(cV)){
cV=cV.replace(/\"/g,"\"\"");
}
cV="\""+cV+"\"";
}
this.processData(cV);
if(col!=_2cce){
this.processData("\t");
}
}
},copyRangeEndCol);
_2cb1=iter.getData();
}
}else{
if(currCell){
var cV=currCell.getAttribute("cV");
}
if(cV==null||cV=="null"){
cV="";
}
if(/\n/.test(cV)){
if(/\"/g.test(cV)){
cV=cV.replace(/\"/g,"\"\"");
}
cV="\""+cV+"\"";
}
_2cb1=cV;
}
return _2cb1;
}
function getDataToBeCopied(_2cd2,_2cd3,_2cd4){
var _2cd5="";
var _2cd6=getAvailableStartRow();
var _2cd7=getAvailableEndRow();
var _2cd8=document.cellform;
_2cd8.actionMode.value="copy";
_2cd8.startColumn.value=_2cd2.startCol;
_2cd8.endColumn.value=_2cd2.endCol;
_2cd8.startRow.value=_2cd2.startRow;
_2cd8.endRow.value=_2cd2.endRow;
_2cd8.currentTime.value=CURRENTTIME;
_2cd8.currentSheet.value=CURRSHEETNAME;
_2cd8.afterRTC.value="false";
_2cd8.availableStartRow.value=_2cd6;
_2cd8.availableEndRow.value=_2cd7;
_2cd8.isDocSaved.value=isDocSaved();
_2cd8.documentId.value=DOCUMENT_ID;
_2cd8.isStockConfigured.value=isStockConfigured;
_2cd8.bridgeNo.value=bridgeNumber;
_2cd8.totCols.value=totCols;
_2cd8.tmpSheet.value=tmpSheetName;
_2cd8.documentOwner.value=CURR_DOC_OWNERNAME;
_2cd8.isColSelected.value=isColSelected();
_2cd8.isRowSelected.value=isRowSelected();
_2cd8.allowWrite.value=ALLOW_TO_WRITE;
if(_2cd3){
var _2cd9=_2cd8.actionMode.value.toUpperCase();
_2cd8.currentSelection.value=getCurrentSelection();
var _2cda=_2cd8.action;
_2cda+=((_2cda.indexOf("?")+1)?"&":"?")+"randomNo="+Math.random();
_2cd8.view.value=getObj("VIEW").value;
var _2cdb=new XMLHttpRequest();
var _2cdc=_2cd8.elements;
var _2cdd=_2cdc.length;
var nvp="";
for(var i=0;i<_2cdd;i++){
try{
var _2ce0=_2cdc[i];
var _2ce1=_2ce0.name;
var rVal=_2ce0.value;
nvp+=_2ce1+"="+rVal+"&";
}
catch(e){
showAlert(e);
}
}
nvp=appendCSRFToURL(nvp);
nvp=nvp.replace(/\+/g,"%2B");
nvp=encodeURI(nvp);
_2cdb.open("POST",_2cda,false);
_2cdb.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_2cdb.setRequestHeader("Content-length",nvp.length);
_2cdb.send(nvp);
var _2ce3=_2cdb.responseText;
if(_2ce3=="Error"){
showAlertDialog(jsTitleMsg.ErrorOccurred);
return;
}else{
var _2ce4=_2cdb.status;
var _2ce5=_2cdb.statusText;
if(_2ce4>12000||_2ce4==0){
handleServerError("ERROR","ConnectionLost",true,true);
return;
}
if(_2ce4>=300){
errorAlert(_2ce4,_2ce5);
return;
}
if(_2ce3==null||typeof _2ce3=="undefined"){
recalculate("",true);
return;
}
var _2ce6=parseJSON(_2ce3);
var _2ce7=_2ce6["dataSelected"];
return _2ce7;
}
}
}
function copyButtonMouseMove(){
$("#copyButton").addClass("ui-state-hover");
}
function copyButtonMouseLeave(){
$("#copyButton").removeClass("ui-state-hover");
}
function copyButtonClick(){
var data=copyCells("flash");
if(!data){
return;
}
var ele=document.getElementById("copyButtonDiv");
ele.sendDataToFlash(data);
if(os_mac&&browser_firefox){
$("#copyButton").removeClass("ui-state-hover");
}
hideProgressMessage();
return;
}
function positionFlashForCopyButton(){
var _2cea=$("#copyButton");
var _2ceb=_2cea.offset();
var _2cec={};
var _2ced={menu:"false",wmode:"transparent",allowscriptaccess:"always"};
var _2cee={};
var _2cef=ctxpath+"flash/";
swfobject.embedSWF(_2cef+"copyButton.swf","copyButtonDiv",_2cea.outerWidth(),_2cea.outerHeight(),"9.0.0","",_2cec,_2ced,_2cee,copyButtonFlashLoaded);
}
function copyButtonFlashLoaded(e){
if(e.success){
var _2cf1=$("#copyButton");
var _2cf2=_2cf1.offset();
var _2cf3=document.getElementById(e.id);
var _2cf4=_2cf3.style;
_2cf4.position="absolute";
_2cf4.left=_2cf2.left+"px";
_2cf4.top=_2cf2.top+"px";
_2cf4.width=_2cf1.outerWidth()+"px;";
_2cf4.height=_2cf1.outerHeight()+"px";
_2cf4.zIndex=100000000;
}
return;
}
function submitComputeSum(){
if(isCellRange()){
var _2cf5=false;
var _2cf6=getAvailableStartRow();
var _2cf7=getAvailableEndRow();
var _2cf8=getCellRange();
if(_2cf8.startRow==_2cf8.endRow&&_2cf8.startCol!=_2cf8.endCol){
var _2cf5=true;
var _2cf9=_2cf8.endCol;
var row=_2cf8.endRow;
for(col=_2cf9+1;col<=totCols;col++){
if(col>(totCols-1)){
insertCol("append",totCols,1,false,true,false);
if(col>=getColMax()){
return;
}
}
var _2cfc=getCell(row,col);
if(getCellContentWOF(_2cfc)=="NULL"||((_2cfc.getAttribute("fn")==""||_2cfc.getAttribute("fn")==null)&&_2cfc.getAttribute("cv")=="")){
_2cf9=col;
break;
}
}
document.cellform.actionMode.value="ComputeSUM_C";
document.cellform.column.value=_2cf9;
document.cellform.row.value=row;
}else{
document.cellform.actionMode.value="ComputeSUM";
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
document.cellform.column.value=col;
document.cellform.row.value=row;
}
document.cellform.totCols.value=totCols;
document.cellform.startColumn.value=_2cf8.startCol;
document.cellform.endColumn.value=_2cf8.endCol;
document.cellform.startRow.value=_2cf8.startRow;
document.cellform.endRow.value=_2cf8.endRow;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.availableStartRow.value=_2cf6;
document.cellform.availableEndRow.value=_2cf7;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
document.cellform.bridgeNo.value=bridgeNumber;
if(endRow>=(totRows-1)&&(!_2cf5)){
appendBlankRows("ROWS_EXCEEDED",totRows+1);
scrollCellIntoView(totRows-1,currCol);
}
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2cfe=getObj("apiKey");
if(_2cfe!=null){
document.cellform.apiKeyId.value=_2cfe.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
}else{
initAutoSum();
}
}
function submitCellValueChangeFormat(_2cff,_2d00,_2d01,type){
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
if(_2d00.substring(0,2)=="dt"){
_2d00=$("#"+_2d00).attr("format");
}
var _2d06=getAvailableStartRow();
var _2d07=getAvailableEndRow();
document.cellform.totCols.value=totCols;
document.cellform.column.value=col;
document.cellform.row.value=row;
document.cellform.actionMode.value=_2cff;
document.cellform.formattedCellValue.value=_2d00;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
var _2d08=getCellRange();
document.cellform.startColumn.value=_2d08.startCol;
document.cellform.endColumn.value=_2d08.endCol;
document.cellform.startRow.value=_2d08.startRow;
document.cellform.endRow.value=_2d08.endRow;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.tmpData.value=_2d01;
document.cellform.tmpSheet.value=type;
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_2d06;
document.cellform.availableEndRow.value=_2d07;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2d09=getObj("apiKey");
if(_2d09!=null){
document.cellform.apiKeyId.value=_2d09.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
closeDialog();
}
var fetchFunFlag=0;
function fetchFunctions(){
if((fetchFunFlag==0)||transMode){
var _2d0a=getXMLHttpRequest();
_2d0a.open("GET",ctxpath+"pages/functionslist.jsp?viewType="+getObj("VIEW").value,true);
_2d0a.onreadystatechange=function(){
if(_2d0a.readyState==4){
getObj("tmpFunctionsList").innerHTML=_2d0a.responseText;
fetchFunFlag=1;
var _2d0b=getObj("funcType");
if(_2d0b!=null&&getObj(_2d0b.value)!=null){
getObj("funcList").innerHTML=getObj(_2d0b.value).innerHTML;
}
}
};
_2d0a.send(null);
}else{
var _2d0c=getObj("funcType");
if(_2d0c!=null&&getObj(_2d0c.value)!=null){
getObj("funcList").innerHTML=getObj(_2d0c.value).innerHTML;
}else{
fetchFunFlag=0;
}
}
}
function submitCellValueFormat(_2d0d,sR,sC,eR,eC,_2d12){
if(typeof _2d12=="undefined"){
_2d12="false";
}
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
document.cellform.column.value=col;
document.cellform.row.value=row;
document.cellform.actionMode.value="FormatCell";
document.cellform.totCols.value=totCols;
document.cellform.formattedCellValue.value=_2d0d;
var _2d16=getCellRange();
document.cellform.startColumn.value=_2d16.startCol;
document.cellform.endColumn.value=_2d16.endCol;
document.cellform.startRow.value=_2d16.startRow;
document.cellform.endRow.value=_2d16.endRow;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value=_2d12;
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=getAvailableStartRow();
document.cellform.availableEndRow.value=getAvailableEndRow();
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2d17=getObj("apiKey");
if(_2d17!=null){
document.cellform.apiKeyId.value=_2d17.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
importxmlForForm(document.cellform,updateCell,true);
}
function closeFunctionDialog(){
if(exprField.value!=""&&exprField.value!="="){
submitCell();
resetCellRangeFill("functions");
}else{
setCellContent(currCell,currCellValue);
exprField.value=currCellValue;
cellField.value=currCellValue;
if(currCellFormula!=""&&currCellFormula!=null&&currCellFormula!="null"){
if(currCellValue!=currCellFormula){
currCell.setAttribute("fn",currCellFormula);
exprField.value=currCellFormula;
}
}
resetCellRangeFill("escapefromfunc");
exprField.blur();
formulaCell=false;
isExprFunc=false;
}
isFuncDlgOpen=false;
}
function initAutoSum(){
if(currRow<(getAvailableStartRow())&&currRow<getAvailableEndRow()){
calcAutoSumCellRange("",currRow,currCol,currRow,currCol);
return false;
}else{
if(currRow>(getAvailableStartRow())&&currRow>getAvailableEndRow()){
calcAutoSumCellRange("",currRow,currCol,currRow,currCol);
return false;
}else{
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
var cell=getCell(row,col,undefined,true);
var pos=getCellPos(cell);
}
}
if(pos.row==0&&pos.col==0){
autoSumRes();
return false;
}
if(pos.row==0&&pos.col!=0){
autoSumCalc("colWise",pos.row,pos.col);
return false;
}
if(pos.row!=0&&pos.col==0){
autoSumCalc("rowWise",pos.row,pos.col);
return false;
}
var _2d1d=false;
var _2d1e=false;
var _2d1f=getCell(pos.row,(pos.col-1),undefined,true);
var _2d20=getCell((pos.row-1),pos.col,undefined,true);
var _2d21="";
var _2d22="";
if(_2d1f!=null){
_2d21=getCellContentWOF(_2d1f);
}
if(_2d20!=null){
_2d22=getCellContentWOF(_2d20);
}
if((_2d21==null||_2d21==""||isNaN(_2d21))&&(_2d22==null||_2d22==""||isNaN(_2d22))){
for(var i=(pos.row-1);i>=0;i--){
var _2d24=getCell(i,pos.col,undefined,true);
if(_2d24==null){
continue;
}
var _2d25=getCellContentWOF(_2d24);
if(!isNaN(_2d25)&&_2d25!=null&&_2d25!=""){
_2d1e=true;
break;
}
}
if(!_2d1e){
for(var i=(pos.col-1);i>=0;i--){
var _2d24=getCell(pos.row,i,undefined,true);
if(_2d24==null){
continue;
}
var _2d25=getCellContentWOF(_2d24);
if(!isNaN(_2d25)&&_2d25!=null&&_2d25!=""){
_2d1d=true;
break;
}
}
}
if(_2d1e){
autoSumCalc("rowWise",pos.row,pos.col);
return false;
}else{
if(_2d1d){
autoSumCalc("colWise",pos.row,pos.col);
return false;
}else{
autoSumRes();
return false;
}
}
}
if(_2d1f!=null&&_2d21!=null&&_2d21!=""){
var _2d26=getCellContentWOF(_2d1f);
if(_2d26!=null&&_2d26!=""&&!isNaN(_2d26)){
_2d1d=true;
}
}
if(_2d20!=null&&_2d22!=null&&_2d22!=""){
var _2d27=getCellContentWOF(_2d20);
if(_2d27!=null&&_2d27!=""&&!isNaN(_2d27)){
_2d1e=true;
}
}else{
_2d1d=true;
}
if(_2d1d&&!_2d1e){
autoSumCalc("colWise",pos.row,pos.col);
return false;
}else{
autoSumCalc("rowWise",pos.row,pos.col);
return false;
}
}
function autoSumCalc(basis,row,col){
var _2d2b=null;
var _2d2c=null;
var _2d2d=false;
var _2d2e="";
var _2d2f="";
var _2d30="";
var _2d31="";
var _2d32="";
var _2d33="";
if(basis=="rowWise"){
var _2d34=row;
}
if(basis=="colWise"){
var _2d34=col;
}
for(var i=(_2d34-1);i>=0;i--){
if(basis=="rowWise"){
var _2d36=getCell(i,col,undefined,true);
if(_2d36==null){
continue;
}
var _2d37=getCellContentWOF(_2d36);
_2d32=Merge.getCellInfo(i,col);
if(_2d32){
if((_2d2d&&!isNaN(_2d37)&&_2d37!="")||(!_2d2d)){
if(_2d2e==""){
_2d2e=_2d32.startCol;
}
if(_2d2f==""){
_2d2f=_2d32.endCol;
}
if(_2d32["startCol"]<_2d2e){
_2d2e=_2d32.startCol;
}
if(_2d32["endCol"]>_2d2f){
_2d2f=_2d32.endCol;
}
}
}
}
if(basis=="colWise"){
var _2d36=getCell(row,i,undefined,true);
if(_2d36==null){
continue;
}
var _2d37=getCellContentWOF(_2d36);
_2d32=Merge.getCellInfo(row,i);
if(_2d32){
if((_2d2d&&!isNaN(_2d37)&&_2d37!="")||(!_2d2d)){
if(_2d30==""){
_2d30=_2d32.startRow;
}
if(_2d31==""){
_2d31=_2d32.endRow;
}
if(_2d32["startRow"]<_2d30){
_2d30=_2d32.startRow;
}
if(_2d32["endRow"]>_2d31){
_2d31=_2d32.endRow;
}
}
}
}
if(!_2d2d){
if(!isNaN(_2d37)&&_2d37!=null&&_2d37!=""){
_2d2b=_2d36;
_2d2d=true;
_2d33=i;
}
}else{
if(!isNaN(_2d37)&&_2d37!=null&&_2d37!=""){
if(basis=="rowWise"){
if(i==(getAvailableStartRow())&&(i!=0)){
calcAutoSumCellRange("",currRow,currCol,currRow,currCol);
return false;
}
}
_2d2c=_2d36;
_2d33=i;
}else{
break;
}
}
}
if(_2d2b==null){
autoSumRes();
return false;
}
if(_2d2e==""&&_2d2f==""){
_2d2e=col;
_2d2f=col;
}
if(_2d30==""&&_2d31==""){
_2d30=row;
_2d31=row;
}
if(basis=="rowWise"){
autoSumRes(basis,_2d33,_2d2e,row-1,_2d2f);
}else{
if(basis=="colWise"){
autoSumRes(basis,row,_2d33,row,col-1);
}
}
return false;
}
function autoSumRes(basis,_2d39,_2d3a,endR,endC){
var _2d3d="=SUM(";
if(userLangCode=="de"&&(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW)){
_2d3d="=SUMME(";
}
if(Filter.hasFilteredCols()&&Row.hasHiddenRows()){
_2d3d="=SUBTOTAL(109, ";
}
var _2d3e=_2d3d;
var _2d3f="";
var _2d40="";
if(typeof basis!="undefined"){
_2d40=getCellLabel(_2d39,_2d3a);
_2d3f=getCellLabel(endR,endC);
if(_2d40==_2d3f){
_2d3e=_2d3e+_2d40;
}else{
_2d3e=_2d3e+_2d40+":"+_2d3f;
}
focusCellRangeFill(_2d39,_2d3a,endR,endC);
}
_2d3e=_2d3e+")";
focusCellField(_2d3e,true);
setSelectionRange(cellField,_2d3d.length,(_2d3e.length-1));
}
function calcAutoSumCellRange(basis,_2d42,_2d43,_2d44,_2d45){
var _2d46=new getXmlhttp();
_2d46.onreadystatechange=function(){
if(_2d46.readyState==4){
var _2d47=eval("("+_2d46.responseText+")");
var _2d48=_2d47["sR"];
var _2d49=_2d47["sC"];
var endR=_2d47["eR"];
var endC=_2d47["eC"];
var basis=_2d47["basis"];
if(((endR==currRow-1)&&(endC==currCol))||((endR==currRow)&&(endC==currCol-1))){
autoSumRes(basis,_2d48,_2d49,endR,endC);
}else{
autoSumRes();
}
}
};
var nvp="startRow="+_2d42+"&startCol="+_2d43+"&endRow="+_2d44+"&endCol="+_2d45+"&basis="+basis;
nvp+="&currentTime="+CURRENTTIME+"&currentSheet="+CURRSHEETNAME+"&documentId="+DOCUMENT_ID+"&action="+"altequal";
nvp+="&view="+getObj("VIEW").value+"&docOwner="+CURR_DOC_OWNERNAME;
sendXMLHTTPRequest(_2d46,nvp,true,true,ctxpath+"autosum.do");
}
var sourcecnt=1;
var beforeFillSeriesStartR;
var beforeFillSeriesEndR;
var beforeFillSeriesStartC;
var beforeFillSeriesEndC;
var direction="";
var ctrlkey="FALSE";
var fillseriesrange=false;
var fillRow="",fillCol="";
var fillStartRow,fillStartCol,fillEndRow,fillEndCol;
var cnt=0;
var autoFillSeries=false;
function beforeFillSeries(){
if(isCellEdited()){
submitCell();
}
fillseriesrange=(isCellRange())?true:false;
if(isCellRange()){
var _2d4e=getCellRange();
beforeFillSeriesStartR=_2d4e.startRow;
beforeFillSeriesStartC=_2d4e.startCol;
beforeFillSeriesEndR=_2d4e.endRow;
beforeFillSeriesEndC=_2d4e.endCol;
}else{
var info=ActiveCellInfo;
beforeFillSeriesStartR=info.getStartRow();
beforeFillSeriesStartC=info.getStartCol();
beforeFillSeriesEndR=info.getEndRow();
beforeFillSeriesEndC=info.getEndCol();
}
fillRow=beforeFillSeriesEndR;
fillCol=beforeFillSeriesEndC;
selRow=beforeFillSeriesEndR;
selCol=beforeFillSeriesEndC;
selectionLeft=getEndLeftOfCol(beforeFillSeriesEndC);
selectionTop=getEndTopOfRow(beforeFillSeriesEndR);
if(cellRangeContainsMergeCells(beforeFillSeriesStartR,beforeFillSeriesStartC,beforeFillSeriesEndR,beforeFillSeriesEndC)){
fillSeriesProps.isMergeCellExists=true;
fillSeriesProps.mergedRightColSpan=(beforeFillSeriesEndC-beforeFillSeriesStartC)+1;
fillSeriesProps.mergedRightEndCol=beforeFillSeriesEndC+fillSeriesProps.mergedRightColSpan;
if(fillSeriesProps.mergedRightEndCol>(totCols-1)){
fillSeriesProps.mergedRightEndCol=totCols-1;
}
fillSeriesProps.mergedBottomRowSpan=(beforeFillSeriesEndR-beforeFillSeriesStartR)+1;
fillSeriesProps.mergedBottomEndRow=beforeFillSeriesEndR+fillSeriesProps.mergedBottomRowSpan;
if(fillSeriesProps.mergedBottomEndRow>(totRows-1)){
fillSeriesProps.mergedBottomEndRow=totRows-1;
}
fillSeriesProps.mergedLeftColSpan=(beforeFillSeriesEndC-beforeFillSeriesStartC)+1;
fillSeriesProps.mergedLeftEndCol=beforeFillSeriesStartC-fillSeriesProps.mergedLeftColSpan;
if(fillSeriesProps.mergedLeftEndCol<0){
fillSeriesProps.mergedLeftEndCol=0;
}
fillSeriesProps.mergedTopRowSpan=(beforeFillSeriesEndR-beforeFillSeriesStartR)+1;
fillSeriesProps.mergedTopEndRow=beforeFillSeriesStartR-fillSeriesProps.mergedTopRowSpan;
if(fillSeriesProps.mergedTopRowSpan<0){
fillSeriesProps.mergedTopRowSpan=0;
}
}
}
function focusFillSeries(ev){
if(!READ_WRITE){
return;
}
stopEvt(ev);
beforeFillSeries();
if(browser_ie){
document.attachEvent("onmousemove",selectAutoFill);
document.attachEvent("onmouseup",endAutoFill);
}else{
document.addEventListener("mousemove",selectAutoFill,false);
document.addEventListener("mouseup",endAutoFill,false);
}
}
function selectAutoFill(ev){
clearTextSelection();
autoFillSeries=true;
changeCursor(true,ev);
var _2d52=getCursorPos(ev);
if(ISFREEZED){
if(_2d52.x>sheetLeft+findSecondPaneXPos()){
var x=_2d52.x-sheetLeft+getSheetScrollLeft();
}else{
var x=_2d52.x-sheetLeft;
}
if(_2d52.y>sheetTop+findThirdPaneYPos()){
var y=_2d52.y-sheetTop+getSheetScrollTop();
}else{
var y=_2d52.y-sheetTop;
}
}else{
var x=_2d52.x-sheetLeft+getSheetScrollLeft();
var y=_2d52.y-sheetTop+getSheetScrollTop();
}
var _2d55=beforeFillSeriesStartR;
var _2d56=beforeFillSeriesEndR;
var _2d57=beforeFillSeriesStartC;
var _2d58=beforeFillSeriesEndC;
var _2d59=getCell(_2d56,_2d58);
var _2d5a=getCell(_2d55,_2d57);
if(y>getEndTopOfRow(_2d56)){
var _2d5b=(y>selectionTop)?increaseReqCellTop(y,selRow,selectionTop):decreaseReqCellTop(y,selRow,selectionTop);
selRow=_2d5b.row;
selectionTop=_2d5b.top;
if(isMouseCursorYInViewPort(y)){
clearInterval(sheetScrollTopId);
if(fillSeriesProps.isMergeCellExists){
if(selRow>fillSeriesProps.mergedBottomEndRow){
fillSeriesProps.mergedBottomEndRow=fillSeriesProps.mergedBottomEndRow+fillSeriesProps.mergedBottomRowSpan;
if(fillSeriesProps.mergedBottomEndRow>(totRows-1)){
fillSeriesProps.mergedBottomEndRow=totRows-1;
}
}
focusCellRangeforAutoFill(beforeFillSeriesStartR,beforeFillSeriesStartC,fillSeriesProps.mergedBottomEndRow,beforeFillSeriesEndC);
}else{
focusCellRangeforAutoFill(beforeFillSeriesStartR,beforeFillSeriesStartC,selRow,beforeFillSeriesEndC);
}
}
direction="TO_BOTTOM";
}else{
if(y<getRowTop(_2d55)){
var _2d5b=(y<selectionTop)?decreaseReqCellTop(y,selRow,selectionTop):increaseReqCellTop(y,selRow,selectionTop);
selRow=_2d5b.row;
selectionTop=_2d5b.top;
if(isMouseCursorYInViewPort(y)){
clearInterval(sheetScrollTopId);
if(fillSeriesProps.isMergeCellExists){
if(selRow<fillSeriesProps.mergedTopEndRow){
fillSeriesProps.mergedTopEndRow=fillSeriesProps.mergedTopEndRow-fillSeriesProps.mergedTopRowSpan;
if(fillSeriesProps.mergedTopEndRow<0){
fillSeriesProps.mergedTopEndRow=0;
}
}
focusCellRangeforAutoFill(beforeFillSeriesEndR,beforeFillSeriesStartC,fillSeriesProps.mergedTopEndRow,beforeFillSeriesEndC);
}else{
focusCellRangeforAutoFill(beforeFillSeriesEndR,beforeFillSeriesStartC,selRow,beforeFillSeriesEndC);
}
}
direction="TO_TOP";
}else{
if(x>getEndLeftOfCol(_2d58)){
var _2d5c=(x>selectionLeft)?increaseReqCellLeft(x,selCol,selectionLeft):decreaseReqCellLeft(x,selCol,selectionLeft);
selCol=_2d5c.col;
selectionLeft=_2d5c.left;
if(isMouseCursorXInViewPort(x)){
if(typeof sheetScrollLeftId!="undefined"){
clearInterval(sheetScrollLeftId);
}
if(fillSeriesProps.isMergeCellExists){
if(selCol>fillSeriesProps.mergedRightEndCol){
fillSeriesProps.mergedRightEndCol=fillSeriesProps.mergedRightEndCol+fillSeriesProps.mergedRightColSpan;
if(fillSeriesProps.mergedRightEndCol>(totCols-1)){
fillSeriesProps.mergedRightEndCol=totCols-1;
}
}
focusCellRangeforAutoFill(beforeFillSeriesStartR,beforeFillSeriesStartC,beforeFillSeriesEndR,fillSeriesProps.mergedRightEndCol);
}else{
focusCellRangeforAutoFill(beforeFillSeriesStartR,beforeFillSeriesStartC,beforeFillSeriesEndR,selCol);
}
}
direction="TO_RIGHT";
}else{
if(x<getColLeft(_2d57)){
var _2d5c=(x<selectionLeft)?decreaseReqCellLeft(x,selCol,selectionLeft):increaseReqCellLeft(x,selCol,selectionLeft);
selCol=_2d5c.col;
selectionLeft=_2d5c.left;
if(isMouseCursorXInViewPort(x)){
if(typeof sheetScrollLeftId!="undefined"){
clearInterval(sheetScrollLeftId);
}
if(fillSeriesProps.isMergeCellExists){
if(selCol<fillSeriesProps.mergedLeftEndCol){
fillSeriesProps.mergedLeftEndCol=fillSeriesProps.mergedLeftEndCol-fillSeriesProps.mergedLeftColSpan;
if(fillSeriesProps.mergedLeftEndCol<0){
fillSeriesProps.mergedLeftEndCol=0;
}
}
focusCellRangeforAutoFill(beforeFillSeriesStartR,beforeFillSeriesEndC,beforeFillSeriesEndR,fillSeriesProps.mergedLeftEndCol);
}else{
focusCellRangeforAutoFill(beforeFillSeriesStartR,beforeFillSeriesEndC,beforeFillSeriesEndR,selCol);
}
}
direction="TO_LEFT";
}else{
focusCellRangeforAutoFill(beforeFillSeriesStartR,beforeFillSeriesStartC,beforeFillSeriesEndR,beforeFillSeriesEndC);
direction="";
}
}
}
}
if(ISFREEZED){
if(_2d52.y>sheetTop+findThirdPaneYPos()){
scrollSheetVertical(y,"FILLSERIES");
}
if(_2d52.x>sheetLeft+findSecondPaneXPos()){
scrollSheetHorizontal(x,"FILLSERIES");
}
}else{
scrollSheetVertical(y,"FILLSERIES");
scrollSheetHorizontal(x,"FILLSERIES");
}
}
function endAutoFill(ev){
if(browser_ie){
document.detachEvent("onmousemove",selectAutoFill);
document.detachEvent("onmouseup",endAutoFill);
}else{
document.removeEventListener("mousemove",selectAutoFill,false);
document.removeEventListener("mouseup",endAutoFill,false);
}
if(typeof sheetScrollTopId!="undefined"){
clearInterval(sheetScrollTopId);
}
if(typeof sheetScrollLeftId!="undefined"){
clearInterval(sheetScrollLeftId);
}
changeCursor(false,ev);
hideFillSeriesDIV();
hideFillSeriesSPAN();
var _2d5e=fillStartCol;
var _2d5f=fillEndCol;
var _2d60=fillStartRow;
var _2d61=fillEndRow;
var sc=(_2d5e<_2d5f)?_2d5e:_2d5f;
var ec=(_2d5e>_2d5f)?_2d5e:_2d5f;
var sr=(_2d60<_2d61)?_2d60:_2d61;
var er=(_2d60>_2d61)?_2d60:_2d61;
if(isPartOfArray(sr,sc,er,ec)){
fillSeriesProps.reset();
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
clearOldArrayPosition(sr,sc,er,ec);
if(autoFillSeries){
focusCellRange(_2d60,_2d5e,_2d61,_2d5f,"FILLSERIES");
}
if(direction==""){
return;
}
ctrlkey=(ev.ctrlKey||ev.metaKey)?"TRUE":"FALSE";
var _2d66=(fillseriesrange)?"TRUE":"FALSE";
if(direction=="TO_BOTTOM"){
sourcecnt=beforeFillSeriesEndR-beforeFillSeriesStartR+1;
if(fillSeriesProps.isMergeCellExists){
fillSeriesProps.selectedStartRow=beforeFillSeriesEndR+1;
fillSeriesProps.selectedStartCol=_2d5e;
fillSeriesProps.selectedEndRow=fillSeriesProps.mergedBottomEndRow;
fillSeriesProps.selectedEndCol=_2d5f;
}else{
fillSeriesProps.selectedStartRow=_2d60;
fillSeriesProps.selectedStartCol=_2d5e;
fillSeriesProps.selectedEndRow=_2d61;
fillSeriesProps.selectedEndCol=_2d5f;
}
}else{
if(direction=="TO_TOP"){
sourcecnt=beforeFillSeriesEndR-beforeFillSeriesStartR+1;
_2d60=fillEndRow;
_2d61=fillStartRow;
if(fillSeriesProps.isMergeCellExists){
fillSeriesProps.selectedStartRow=beforeFillSeriesStartR-1;
fillSeriesProps.selectedStartCol=_2d5e;
fillSeriesProps.selectedEndRow=fillSeriesProps.mergedTopEndRow;
fillSeriesProps.selectedEndCol=_2d5f;
}else{
fillSeriesProps.selectedStartRow=_2d60;
fillSeriesProps.selectedStartCol=_2d5e;
fillSeriesProps.selectedEndRow=_2d61;
fillSeriesProps.selectedEndCol=_2d5f;
}
}else{
if(direction=="TO_RIGHT"){
sourcecnt=beforeFillSeriesEndC-beforeFillSeriesStartC+1;
if(fillSeriesProps.isMergeCellExists){
fillSeriesProps.selectedStartRow=_2d60;
fillSeriesProps.selectedStartCol=beforeFillSeriesEndC+1;
fillSeriesProps.selectedEndRow=_2d61;
fillSeriesProps.selectedEndCol=fillSeriesProps.mergedRightEndCol;
}else{
fillSeriesProps.selectedStartRow=_2d60;
fillSeriesProps.selectedStartCol=_2d5e;
fillSeriesProps.selectedEndRow=_2d61;
fillSeriesProps.selectedEndCol=_2d5f;
}
}else{
if(direction=="TO_LEFT"){
sourcecnt=beforeFillSeriesEndC-beforeFillSeriesStartC+1;
_2d5e=fillEndCol;
_2d5f=fillStartCol;
if(fillSeriesProps.isMergeCellExists){
fillSeriesProps.selectedStartRow=_2d60;
fillSeriesProps.selectedStartCol=beforeFillSeriesStartC-1;
fillSeriesProps.selectedEndRow=_2d61;
fillSeriesProps.selectedEndCol=fillSeriesProps.mergedLeftEndCol;
}else{
fillSeriesProps.selectedStartRow=_2d60;
fillSeriesProps.selectedStartCol=_2d5e;
fillSeriesProps.selectedEndRow=_2d61;
fillSeriesProps.selectedEndCol=_2d5f;
}
}
}
}
}
if(cellRangeContainsMergeCells(fillSeriesProps.selectedStartRow,fillSeriesProps.selectedStartCol,fillSeriesProps.selectedEndRow,fillSeriesProps.selectedEndCol)){
fillSeriesProps.reset();
showAlertDialog(jsMsg["FillSeries.YourCannotChangePartOfMergedCell"]);
return false;
}
fillSeriesProps.reset();
var _2d67=predictViewPortRowRange();
var _2d68=_2d67.startRow;
var _2d69=_2d67.endRow;
document.cellform.startColumn.value=_2d5e;
document.cellform.endColumn.value=_2d5f;
document.cellform.startRow.value=_2d60;
document.cellform.endRow.value=_2d61;
document.cellform.actionMode.value="FillSeries";
document.cellform.totCols.value=totCols;
document.cellform.fillDirection.value=direction;
document.cellform.textAreaValue.value=sourcecnt;
document.cellform.formattedCellValue.value=ctrlkey;
document.cellform.rowHeight.value=_2d66;
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_2d68;
document.cellform.availableEndRow.value=_2d69;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2d6a=getObj("apiKey");
if(_2d6a!=null){
document.cellform.apiKeyId.value=_2d6a.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
autoFillSeries=false;
fillseriesrange=false;
isScrollTopSet=false;
isScrollLeftSet=false;
direction="";
ctrlkey="FALSE";
importxmlForForm(document.cellform,updateCell,true);
}
function focusCellRangeforAutoFill(_2d6b,_2d6c,_2d6d,_2d6e){
var adjst=4;
var dim=getCellRangeDIM(_2d6b,_2d6c,_2d6d,_2d6e);
showFillSeriesDIV();
showFillSeriesSPAN();
setFillSeriesDIVPos(dim.left,dim.top);
setFillSeriesDIVDim(dim.width,dim.height);
fillStartRow=_2d6b;
fillStartCol=_2d6c;
fillEndRow=_2d6d;
fillEndCol=_2d6e;
fillRow=_2d6d;
fillCol=_2d6e;
}
function changeCursor(_2d71,ev){
if(READ_WRITE){
if(browser_ie){
var el=ev.srcElement;
}else{
var el=ev.target;
}
if(isFocusDIV(el)){
if(ev.type=="mouseout"){
el.style.cursor="";
el.title="";
return false;
}
var _2d74=getCursorPos(ev);
var orgX=_2d74.x;
var orgY=_2d74.y;
if(ISFREEZED){
if(_2d74.x>sheetLeft+findSecondPaneXPos()){
var x=_2d74.x-sheetLeft+getSheetScrollLeft();
}else{
var x=_2d74.x-sheetLeft;
}
if(_2d74.y>sheetTop+findThirdPaneYPos()){
var y=_2d74.y-sheetTop+getSheetScrollTop();
}else{
var y=_2d74.y-sheetTop;
}
}else{
var x=_2d74.x-sheetLeft+getSheetScrollLeft();
var y=_2d74.y-sheetTop+getSheetScrollTop();
}
var left=parseInt(el.style.left);
var right=left+parseInt(el.style.width);
var top=parseInt(el.style.top);
var _2d7c=top+parseInt(el.style.height);
if(browser_ie){
x-=2;
y-=2;
}
if(x>=left&&x<=(left+2)||x>=(right-3)&&x<=right||y>=top&&y<=(top+2)||y>=(_2d7c-3)&&y<=_2d7c){
el.style.cursor="move";
}else{
if(checkBoundaryForTextInDiv(orgX,orgY,currCell)){
el.style.cursor="pointer";
var title=getHyperLinkInCell(currCell).title;
el.title=title;
}else{
el.style.cursor="";
}
}
}else{
if(isTransSPAN(el)){
var _2d7e=$(el);
if(fPainter.fPaintersingleclick||fPainter.fPainterdoubleclick){
_2d7e.addClass("fpCur");
}else{
_2d7e.removeClass("fpCur");
}
}
}
}
}
function fillSeriesDown(){
if(!READ_WRITE){
return;
}
var _2d7f=getCellRange();
startRow=_2d7f.startRow;
startCol=_2d7f.startCol;
endRow=_2d7f.endRow;
endCol=_2d7f.endCol;
if(isPartOfArray(startRow+1,startCol,endRow,endCol)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
clearOldArrayPosition(startRow+1,startCol,endRow,endCol);
sourcecnt=1;
var _2d80=predictViewPortRowRange();
var _2d81=_2d80.startRow;
var _2d82=_2d80.endRow;
document.cellform.startColumn.value=startCol;
document.cellform.endColumn.value=endCol;
document.cellform.startRow.value=startRow;
document.cellform.endRow.value=endRow;
document.cellform.actionMode.value="FillSeries";
document.cellform.fillDirection.value="TO_BOTTOM";
document.cellform.textAreaValue.value=sourcecnt;
document.cellform.formattedCellValue.value="X";
document.cellform.rowHeight.value="FALSE";
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_2d81;
document.cellform.availableEndRow.value=_2d82;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2d83=getObj("apiKey");
if(_2d83!=null){
document.cellform.apiKeyId.value=_2d83.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
autoFillSeries=false;
fillseriesrange=false;
ctrlkey="FALSE";
importxmlForForm(document.cellform,updateCell,true);
}
function fillSeriesRight(){
if(!READ_WRITE){
return;
}
var _2d84=getCellRange();
startRow=_2d84.startRow;
startCol=_2d84.startCol;
endRow=_2d84.endRow;
endCol=_2d84.endCol;
if(isPartOfArray(startRow,startCol+1,endRow,endCol)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
clearOldArrayPosition(startRow,startCol+1,endRow,endCol);
sourcecnt=1;
var _2d85=predictViewPortRowRange();
var _2d86=_2d85.startRow;
var _2d87=_2d85.endRow;
document.cellform.startColumn.value=startCol;
document.cellform.endColumn.value=endCol;
document.cellform.startRow.value=startRow;
document.cellform.endRow.value=endRow;
document.cellform.actionMode.value="FillSeries";
document.cellform.totCols.value=totCols;
document.cellform.fillDirection.value="TO_RIGHT";
document.cellform.textAreaValue.value=sourcecnt;
document.cellform.formattedCellValue.value="X";
document.cellform.rowHeight.value="FALSE";
document.cellform.documentId.value=DOCUMENT_ID;
document.cellform.currentTime.value=CURRENTTIME;
document.cellform.currentSheet.value=CURRSHEETNAME;
document.cellform.documentOwner.value=CURR_DOC_OWNERNAME;
document.cellform.collabId.value=COLLAB_ID;
document.cellform.afterRTC.value="false";
document.cellform.allowWrite.value=ALLOW_TO_WRITE;
document.cellform.collabEditing.value=COLLABORATIVE_EDITING;
document.cellform.isStockConfigured.value=isStockConfigured;
document.cellform.isDocSaved.value=isDocSaved();
document.cellform.bridgeNo.value=bridgeNumber;
document.cellform.availableStartRow.value=_2d86;
document.cellform.availableEndRow.value=_2d87;
document.cellform.isColSelected.value=isColSelected();
document.cellform.isRowSelected.value=isRowSelected();
if(jsREMOTE_SAVE_VIEW){
document.cellform.remoteEditorUser.value=RMUSER;
document.cellform.userStateId.value=USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _2d88=getObj("apiKey");
if(_2d88!=null){
document.cellform.apiKeyId.value=_2d88.value;
}
}
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
document.cellform.freezedRow.value=FREEZED_ROW;
}
autoFillSeries=false;
fillseriesrange=false;
ctrlkey="FALSE";
importxmlForForm(document.cellform,updateCell,true);
}
function showFillSeriesDIV(){
var block="block";
fillSeriesDIV.style.display=block;
if(ISFREEZED){
if(isRowsOnlyFreezed){
fillSeriesDIV2.style.display=block;
}else{
if(isColsOnlyFreezed){
fillSeriesDIV3.style.display=block;
}else{
if(isColsAndRowsFreezed){
fillSeriesDIV1.style.display=fillSeriesDIV2.style.display=fillSeriesDIV3.style.display=block;
}
}
}
}
}
function showFillSeriesSPAN(){
var block="block";
fillSeriesSPAN.style.display=block;
if(ISFREEZED){
if(isRowsOnlyFreezed){
fillSeriesSPAN2.style.display=block;
}else{
if(isColsOnlyFreezed){
fillSeriesSPAN3.style.display=block;
}else{
if(isColsAndRowsFreezed){
fillSeriesSPAN1.style.display=fillSeriesSPAN2.style.display=fillSeriesSPAN3.style.display=block;
}
}
}
}
}
function hideFillSeriesDIV(){
if(ISFREEZED){
fillSeriesDIV1.style.display=fillSeriesDIV2.style.display=fillSeriesDIV3.style.display="none";
}
fillSeriesDIV.style.display="none";
}
function hideFillSeriesSPAN(){
if(ISFREEZED){
fillSeriesSPAN1.style.display=fillSeriesSPAN2.style.display=fillSeriesSPAN3.style.display="none";
}
fillSeriesSPAN.style.display="none";
}
function setFillSeriesDIVPos(left,top){
left--;
top--;
fillSeriesDIV.style.left=left+"px";
fillSeriesDIV.style.top=top+"px";
if(ISFREEZED){
fillSeriesDIV1.style.left=fillSeriesDIV2.style.left=fillSeriesDIV3.style.left=left+"px";
fillSeriesDIV1.style.top=fillSeriesDIV2.style.top=fillSeriesDIV3.style.top=top+"px";
}
}
function setFillSeriesDIVDim(width,_2d8e){
width++;
_2d8e++;
width=width+"px";
_2d8e=_2d8e+"px";
if(ISFREEZED){
fillSeriesDIV1.style.width=width;
fillSeriesDIV1.style.height=_2d8e;
fillSeriesDIV2.style.width=width;
fillSeriesDIV2.style.height=_2d8e;
fillSeriesDIV3.style.width=width;
fillSeriesDIV3.style.height=_2d8e;
}
fillSeriesDIV.style.width=width;
fillSeriesDIV.style.height=_2d8e;
}
var docid;
var docname;
var docownername;
var docownerid;
var whichview;
function showSpan(_2d8f,which,_2d91,top){
if(_2d8f.trim()=="failure"){
var toPos=document.getElementById("signintablespan1");
if(toPos.style.display=="block"){
toPos.style.display="none";
return;
}
var exp=false;
if(document.all){
exp=true;
}
toPos.style.display="block";
which=which.trim();
if(which=="login"){
toPos.style.top=top;
if(exp){
toPos.style.left=5+"%";
}else{
toPos.style.left=18+"%";
}
}else{
if(which=="public"){
toPos.style.top=top;
if(exp){
toPos.style.left=3+"%";
}else{
toPos.style.left=20+"%";
}
}else{
if(which=="publicview"){
if(exp){
toPos.style.top=15+"%";
toPos.style.left=5+"%";
}else{
toPos.style.top=8+"%";
toPos.style.left=10+"%";
}
}else{
if(which=="signup"){
if(exp){
toPos.style.top=12+"%";
toPos.style.left=43+"%";
}else{
toPos.style.top=5+"%";
toPos.style.left=70+"%";
}
}
}
}
}
if(which.trim()=="signup"){
show1(2);
getObj("cancelsignup").href="javascript:hideCopySpan()";
}else{
show1(1);
getObj("cancelsignup").href="javascript:show1(1)";
}
}else{
if(_2d8f.trim()=="success"){
var _2d95="copy";
var _2d96=new getXmlhttp();
_2d96.open("POST",ctxpath+"copyDoc.do",true);
_2d96.onreadystatechange=function(){
if(_2d96.readyState==4){
copystatus(_2d96.responseText,_2d91);
}
};
_2d96.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
var nvp="copysheet="+_2d95+"&docid="+docid+"&docname="+docname+"&docowner="+docownername;
sendXMLHTTPRequest(_2d96,nvp,true);
}
}
}
function copystatus(_2d98,_2d99){
set_cookie("copyval","false");
if(_2d98==null||typeof _2d98=="undefined"||_2d98.trim()=="null"||_2d98.trim()=="File Not Copied..."){
showSpan("failure","",_2d99);
}else{
location.href=ctxpath+"open.do?docid="+_2d98;
}
}
function copy_setCookie(){
var _2d9a="true";
document.cookie="copyval= "+_2d9a+";";
document.cookie="docid= "+docid+";";
document.cookie="docname= "+docname+";";
document.cookie="docowner= "+docownername+";";
document.cookie="docownerid= "+docownerid+";";
}
function hideCopySpan(){
var toPos=document.getElementById("signintablespan1");
toPos.style.display="none";
}
function validate1(){
var uname=validateUsername(document.copysigninForm.j_username1.value);
if(uname!=null){
showErrormsg(uname,"err_div3");
document.copysigninForm.j_username1.focus();
return false;
}
var pass=validatePassword(document.copysigninForm.j_password1.value);
if(pass!=null){
showErrormsg(pass,"err_div3");
document.copysigninForm.j_password1.focus();
return false;
}
copy_setCookie();
getObj("signstat2").innerHTML="  signing in...";
return true;
}
function show1(index){
switch(parseInt(index)){
case 1:
getObj("copysignin").style.display="block";
getObj("copysignup").style.display="none";
getObj("j_username1").value="";
getObj("j_password1").value="";
getObj("j_username1").focus();
break;
case 2:
getObj("copysignin").style.display="none";
getObj("copysignup").style.display="block";
getObj("j_user1").value="";
getObj("j_pass1").value="";
getObj("repass1").value="";
getObj("j_email1").value="";
getObj("j_user1").focus();
break;
default:
getObj("copysignin").style.display="block";
getObj("copysignup").style.display="none";
getObj("j_username1").value="";
getObj("j_password1").value="";
getObj("j_username1").focus();
break;
}
}
function validatesignup1(){
var uname=validateUsername(getObj("j_user1").value);
if(uname!=null){
showErrormsg(uname,"err_div4");
getObj("j_user1").focus();
return false;
}
var pass=validatePassword(getObj("j_pass1").value);
if(pass!=null){
showErrormsg(pass,"err_div4");
getObj("j_pass1").focus();
return false;
}
var _2da1=validatePassword(getObj("repass1").value);
if(_2da1!=null){
showErrormsg(_2da1,"err_div4");
getObj("repass1").focus();
return false;
}
var _2da2=getObj("j_pass1").value;
var _2da3=getObj("repass1").value;
if(_2da2!=_2da3){
showErrormsg("Passwords doesn't match","err_div4");
return false;
}
var email=validateEmail(getObj("j_email1").value);
if(email!=null){
showErrormsg(email,"err_div4");
getObj("j_email1").focus();
return false;
}
if(whichview.trim()=="signup"){
set_cookie("copyval","false");
}else{
copy_setCookie();
}
getObj("signstat3").innerHTML="  registering...";
return true;
}
function checkuser(obj,_2da6,_2da7){
var _2da8="signin";
var val=obj.value;
var nvp="";
var empty="";
if(val.trim()!=""){
if(obj.id=="j_username1"||obj.id=="j_username"){
_2da8="signin";
nvp="username="+val+"&loginaction="+_2da8;
}else{
if(obj.id=="j_user1"||obj.id=="j_user"){
_2da8="signup";
nvp="username="+val+"&email="+empty+"&loginaction="+_2da8;
}else{
if(obj.id=="j_email1"||obj.id=="j_email"){
_2da8="signup";
nvp="username="+empty+"&email="+val+"&loginaction="+_2da8;
}
}
}
var _2dac=new getXmlhttp();
_2dac.open("POST",ctxpath+"checkUser.do",true);
_2dac.onreadystatechange=function(){
if(_2dac.readyState==4){
signstatus(_2dac.responseText.trim(),_2da6,_2da7);
}
};
_2dac.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
_2dac.send(nvp);
}
}
function signstatus(stat,_2dae,_2daf){
if(stat=="available"){
}else{
getObj(_2dae).style.display="none";
if(stat.trim()!=""){
showErrormsg(stat,_2daf);
}
return false;
}
}
var options="";
var isNew=false;
var chartMenuData="<menu id='ChartConetextMenu' onBeforeLoad = 'chartConetextMenuOpt()' forElement='OLESelectLayer'><item onclick='showChartTab(\"chartType\",ole.getCurrObj().id);return false'><![CDATA["+jsMsg.ChartType+"...]]></item><item onclick='showChartTab(\"chartData\",ole.getCurrObj().id);return false'><![CDATA["+jsMsg.SourceData+"..."+"]]></item><item onclick='showChartTab(\"chartOptions\",ole.getCurrObj().id);return false'><![CDATA["+jsMsg.ChartOptions+"..."+"]]></item><sep></sep><item onclick='publish(ole.getCurrObj().id);return false;'><![CDATA["+jsMsg.ShowChartURL+"]]></item><item onclick='publish(ole.getCurrObj().id);return false;'><![CDATA["+jsMsg.PublishChart+"]]></item><item onclick='revertPublish(ole.getCurrObj().id);return false;'><![CDATA["+jsMsg.RevertPublish+"]]></item><sep></sep><item onclick='saveImage(ole.getCurrObj().id);'><![CDATA["+jsMsg["Image.SaveAsImage"]+"]]></item><item onclick='ole.remove(ole.getCurrObj().id, true);'><![CDATA["+jsMsg.Delete+"]]></item></menu>";
function createChart(chart,mode,_2db2,_2db3,val){
if(typeof _2db3=="undefined"){
_2db3="false";
}
if(_2db3=="false"){
if(!READ_WRITE||!ALLOW_TO_WRITE){
if(mode=="NEW"){
mode="GENERATE";
}else{
if(mode=="EDIT"||mode=="RESIZE"){
mode="REGENERATE";
}else{
if(mode=="DELETE"||mode=="MOVE"||mode=="PUBLISH"||mode=="UNPUBLISH"){
return;
}
}
}
}
}
if(mode!=null){
var _2db5=false;
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
_2db5=true;
}
var _2db6="&docid="+DOCUMENT_ID+"&sheetname="+encodeURIComponent(CURRSHEETNAME)+"&curtime="+CURRENTTIME;
_2db6+="&docowner="+CURR_DOC_OWNERNAME+"&collabid="+COLLAB_ID+"&collabEditing="+COLLABORATIVE_EDITING;
_2db6+="&afterRTC="+_2db3+"&readwrite="+ALLOW_TO_WRITE+"&isSameSheet="+ISSAMESHEET;
_2db6+="&rtcSheetName="+encodeURIComponent(RTCSHEETNAME)+"&isRemoteView="+_2db5+"&viewType="+getViewType();
var top=parseInt(chart["CP_TOP"]);
var left=parseInt(chart["CP_LEFT"]);
var _2db9=parseInt(chart["CP_HEIGHT"]);
var width=parseInt(chart["CP_WIDTH"]);
var sCol=findColInXPos(left);
var sRow=findRowInYPos(top);
var _2dbd=left-getColLeft(sCol);
var _2dbe=top-getRowTop(sRow);
if(mode=="NEW"){
_2db6+="&SCOL="+sCol+"&SROW="+sRow+"&SCOL_DIFF="+_2dbd+"&SROW_DIFF="+_2dbe;
}else{
if(mode=="MOVE"||mode=="RESIZE"){
_2db6+=_2db2;
}
}
_2db6=appendCSRFToURL(_2db6);
if(jsREMOTE_SAVE_VIEW){
_2db6+="&remoteEditorUser="+RMUSER;
}
var _2dbf;
if(mode=="NEW"){
isNew=true;
chart["CP_DOCUMENTSHEET_NAME"]=CURRSHEETNAME;
chart["ONSUCCESSFUNC"]=viewChart;
var _2dc0=ExcelGraph.createInstance(chart);
_2dc0.refreshChart("MODE=NEW"+_2db6,ctxpath+"Chart.do");
}else{
if(mode=="GENERATE"){
if(totalTableWidth<(left+width)){
var diff=(left+width)-totalTableWidth;
var cnt=0;
while(diff>0){
if(totCols+cnt+1>=getColMax()){
break;
}
diff-=getColWidth(totCols+cnt);
cnt+=1;
}
insertCol("append",totCols,cnt,true,true,false,undefined,undefined,undefined,undefined,true);
}
if(totalTableHeight<(top+_2db9)){
appendBlankRows("ROWS_EXCEEDED",findRowInYPos((_2db9+top),true));
}
chart["ONSUCCESSFUNC"]=viewChart;
var _2dc0=ExcelGraph.createInstance(chart);
if(typeof _2db2!="undefined"){
_2dc0.refreshChart("MODE=GENERATE&"+_2db2+_2db6,ctxpath+"Chart.do");
}else{
_2dc0.refreshChart("MODE=GENERATE&GENPUBLICCHART=false"+_2db6,ctxpath+"Chart.do");
}
}else{
if(mode=="REGENERATE"){
chart["ONSUCCESSFUNC"]=viewChart;
if(typeof _2db2!="undefined"){
chart.refreshChart("MODE=REGENERATE&"+_2db2+_2db6,ctxpath+"Chart.do");
}else{
chart.refreshChart("MODE=REGENERATE&GENPUBLICCHART=false"+_2db6,ctxpath+"Chart.do");
}
}else{
if(mode=="EDIT"){
chart["ONSUCCESSFUNC"]=viewChart;
chart.refreshChart("MODE=EDIT"+_2db6,ctxpath+"Chart.do");
}else{
if(mode=="RESIZE"){
chart["ONSUCCESSFUNC"]=viewChart;
chart.refreshChart("MODE=RESIZE"+_2db6,ctxpath+"Chart.do");
}else{
if(mode=="MOVE"){
chart["ONSUCCESSFUNC"]="";
chart.refreshChart("MODE=MOVE"+_2db6,ctxpath+"Chart.do");
}else{
if(mode=="PUBLISH"){
chart["ONSUCCESSFUNC"]=viewChart;
chart["CP_CHART_PUBLICURL"]="true";
chart.refreshChart("MODE=PUBLISH"+_2db6,ctxpath+"Chart.do");
}else{
if(mode=="UNPUBLISH"){
chart["ONSUCCESSFUNC"]=viewChart;
chart["CP_CHART_PUBLICURL"]="false";
chart.refreshChart("MODE=UNPUBLISH"+_2db6,ctxpath+"Chart.do");
}else{
if(mode=="DELETE"){
chart["ONSUCCESSFUNC"]="";
chart.refreshChart("MODE=DELETE"+_2db6,ctxpath+"Chart.do");
}
}
}
}
}
}
}
}
}
}
}
function UpdateCellCharts(_2dc3,_2dc4,val){
var tmp="",_2dc7;
var _2dc8=_2dc3.split(",");
_2dc8.sort();
for(var i=0;i<_2dc8.length;i++){
if(_2dc8[i]!=""&&_2dc8[i]!=tmp){
_2dc7=ExcelGraph.getInstance(_2dc8[i]);
if(_2dc7!=null){
if(_2dc4=="false"||jsREMOTE_SAVE_VIEW){
if(READ_WRITE&&ALLOW_TO_WRITE){
createChart(_2dc7,"REGENERATE","GENPUBLICCHART=true",_2dc4,val);
}else{
createChart(_2dc7,"REGENERATE","",_2dc4,val);
}
}
}
}
tmp=_2dc8[i];
}
}
function RemoveChartCellRange(chart){
var _2dcb=chart["CP_CHARTID"];
var _2dcc=chart["CP_DATARANGE"].split(";");
var tmp="";
for(var a=0;a<_2dcc.length;a++){
var range=_2dcc[a];
var _2dd0=getDataRange(range);
if(_2dd0.type=="CELL"){
var cell=getCell(_2dd0.row,_2dd0.col);
RemoveChartCellRange1(cell,_2dcb);
if(ISFREEZED){
cell=getCell(_2dd0.row,_2dd0.col,sheetPane1Id);
RemoveChartCellRange1(cell,_2dcb);
cell=getCell(_2dd0.row,_2dd0.col,sheetPane2Id);
RemoveChartCellRange1(cell,_2dcb);
cell=getCell(_2dd0.row,_2dd0.col,sheetPane3Id);
RemoveChartCellRange1(cell,_2dcb);
}
}else{
if(_2dd0.type=="RANGE"){
var rows=_2dd0.endRow-_2dd0.startRow+1;
var cols=_2dd0.endCol-_2dd0.startCol+1;
var cell,_2dd4;
for(var i=0;i<rows;i++){
for(j=0;j<cols;j++){
var row=i+_2dd0.startRow;
var col=j+_2dd0.startCol;
cell=getCell(row,col);
RemoveChartCellRange1(cell,_2dcb);
if(ISFREEZED){
cell=getCell(row,col,sheetPane1Id);
RemoveChartCellRange1(cell,_2dcb);
cell=getCell(row,col,sheetPane2Id);
RemoveChartCellRange1(cell,_2dcb);
cell=getCell(row,col,sheetPane3Id);
RemoveChartCellRange1(cell,_2dcb);
}
}
}
}
}
}
}
function RemoveChartCellRange1(cell,_2dd9){
if(cell!=null){
var _2dda=cell.getAttribute("charts");
if(_2dda!=null){
if(_2dda.match(_2dd9)!=null){
tmp=_2dda.replace(_2dd9,"");
cell.setAttribute("charts",tmp);
}
}
}
}
function UpdateChartCellRange(chart){
var _2ddc=chart["CP_DATARANGE"].split(";");
var _2ddd=chart["CP_CHARTID"];
for(var a=0;a<_2ddc.length;a++){
var range=_2ddc[a];
var _2de0=getDataRange(range);
if(_2de0.type=="CELL"){
var cell=getCell(_2de0.row,_2de0.col);
UpdateChartCellRange1(cell,_2ddd);
if(ISFREEZED){
cell=getCell(_2de0.row,_2de0.col,sheetPane1Id);
UpdateChartCellRange1(cell,_2ddd);
cell=getCell(_2de0.row,_2de0.col,sheetPane2Id);
UpdateChartCellRange1(cell,_2ddd);
cell=getCell(_2de0.row,_2de0.col,sheetPane3Id);
UpdateChartCellRange1(cell,_2ddd);
}
}else{
if(_2de0.type=="RANGE"){
var rows=_2de0.endRow-_2de0.startRow+1;
var cols=_2de0.endCol-_2de0.startCol+1;
var cell,_2de4;
for(var i=0;i<rows;i++){
if(isRowAvailable(i+_2de0.startRow)){
for(j=0;j<cols;j++){
var row=i+_2de0.startRow;
var col=j+_2de0.startCol;
cell=getCell(row,col);
if(cell){
UpdateChartCellRange1(cell,_2ddd);
}
if(ISFREEZED){
cell=getCell(row,col,sheetPane1Id);
UpdateChartCellRange1(cell,_2ddd);
cell=getCell(row,col,sheetPane2Id);
UpdateChartCellRange1(cell,_2ddd);
cell=getCell(row,col,sheetPane3Id);
UpdateChartCellRange1(cell,_2ddd);
}
}
}
}
}
}
}
}
function UpdateChartCellRange1(cell,_2de9){
if(cell!=null){
var _2dea=cell.getAttribute("charts");
if(_2dea==null){
cell.setAttribute("charts",_2de9);
}else{
if(_2dea.match(_2de9)==null){
_2dea=_2dea+","+_2de9;
cell.setAttribute("charts",_2dea);
}
}
}
}
var chartLoadingDIV;
function viewChart(_2deb,_2dec){
var chart=_2dec.v("CHARTREF");
var _2dee=_2deb.getScripts();
if(chart["CP_CHART_DBID"]){
var _2def=chart["CP_CHART_DBID"];
}
if(_2dee!=null&&typeof _2dee!="undefined"){
_2dee.splice(0,_2dee.length);
}
if(chart!=null&&(chart.CP_DOCUMENTID!=DOCUMENT_ID||(chart.CP_DOCUMENTSHEET_NAME!=undefined&&CURRSHEETNAME!=chart.CP_DOCUMENTSHEET_NAME))){
return;
}
if(typeof chartLoadingDIV=="undefined"||chartLoadingDIV==null){
var div=document.createElement("div");
div.id="chartLoadingDIV";
div.style.display="none";
div.innerHTML=_2deb.getOnlyHtml();
document.body.appendChild(div);
chartLoadingDIV=getObj("chartLoadingDIV");
}else{
chartLoadingDIV.innerHTML=_2deb.getOnlyHtml();
}
var img=chartLoadingDIV.getElementsByTagName("img")[0];
img.removeAttribute("usemap");
if(getObj(chart.CP_CHARTID)==null){
img.id=chart.CP_CHARTID;
img.className="chart";
img.objType="chart";
var _2df2=chart.CP_TOP;
var _2df3=chart.CP_LEFT;
img.width=chart.CP_WIDTH;
img.height=chart.CP_HEIGHT;
img.chartName=chart.CP_CHART_TITLE;
chart.CP_CHART_DBID=img.getAttribute("dbid");
_2def=chart.CP_CHART_DBID;
setChartPermission();
insertImgorChartIsFreezed(img,_2df3,_2df2);
ole.init(chart.CP_CHARTID).bringToFront();
if(isNew){
ole(chart.CP_CHARTID).setSelectLayer().positionActionBar();
isNew=false;
}
ole(chart.CP_CHARTID).sCol=findColInXPos(_2df3);
ole(chart.CP_CHARTID).sRow=findRowInYPos(_2df2);
ole(chart.CP_CHARTID).sRowDiff=_2df2-getRowTop(ole(chart.CP_CHARTID).sRow);
ole(chart.CP_CHARTID).sColDiff=_2df3-getColLeft(ole(chart.CP_CHARTID).sCol);
}else{
try{
var _2df4=ole(chart.CP_CHARTID).el;
_2df4.src=img.src;
_2df4.width=chart.CP_WIDTH;
_2df4.height=chart.CP_HEIGHT;
_2df4.chartName=chart.CP_CHART_TITLE;
}
catch(e){
}
}
UpdateChartCellRange(chart);
availChartRange[_2def]=chart;
}
function setChartPermission(){
var _2df5=false,_2df6=false,_2df7=false;
switch(getViewType()){
case "SHARE_VIEW":
if(!ALLOW_TO_WRITE){
break;
}
case "NEW_VIEW":
case "OPEN_VIEW":
_2df5=true;
_2df6=true;
case "REMOTE_SAVE_VIEW":
if(!isReadOnlyViewMode){
_2df5=true;
_2df6=true;
_2df7=true;
}
break;
case "REMOTE_VIEW":
_2df5=true;
_2df6=true;
_2df7=true;
case "PUBLIC_VIEW":
if(!isReadOnlyViewMode){
_2df5=true;
_2df6=true;
_2df7=true;
}
break;
}
ole.setObjectProperties("chart",{permissions:{"isDraggable":_2df5,"isResizable":_2df6,"isEditable":_2df7}});
}
var chartDialogState;
function addChart(){
showTab="";
chartDialogState="ADD";
showChartDialog();
}
var currChart;
var chartId;
function editChart(id){
cid=ole.getCurrObj().id;
chartId=cid;
currChart=cid;
chartDialogState="EDIT";
showChartDialog(id);
}
function publishChart(id,_2dfa){
var chart=ExcelGraph.getInstance(id);
if(chart!=null){
createChart(chart,"PUBLISH","",_2dfa);
}
publishChartOptions(id);
}
function unpublishChart(id,_2dfd){
var chart=ExcelGraph.getInstance(id);
if(chart!=null){
createChart(chart,"UNPUBLISH","",_2dfd);
}
publishChartOptions(id);
}
function getAltTextForChart(id){
var chart=ExcelGraph.getInstance(id);
var _2e01="";
if(chart["CP_CHART_TITLE"]!=null&&chart["CP_CHART_TITLE"]!=""){
_2e01=chart["CP_CHART_TITLE"]+" - "+getServerPath();
}else{
_2e01=getServerPath();
}
return _2e01;
}
function getServerPath(){
var url=location.protocol+"//"+SERVERNAME;
if(SERVERPORT!=80&&SERVERPORT!=443){
url=url+":"+SERVERPORT;
}
return url;
}
function getPublishURL(id){
var chart=ExcelGraph.getInstance(id);
var _2e05=chart["CP_CHART_DBID"];
var url=getServerPath()+ctxpath+"publicgraphs/"+_2e05+".png";
return url;
}
function publishChartOptions(id){
var chart=ExcelGraph.getInstance(ole.getCurrObj().id);
try{
var _2e09=getObj("pic_publish_link_span");
if(READ_WRITE&&ALLOW_TO_WRITE){
if(chart["CP_CHART_PUBLICURL"]==null||chart["CP_CHART_PUBLICURL"]=="false"){
if(_2e09){
_2e09.style.display="";
getObj("pic_publish_sep").style.display="";
}
getObj("pic_publish_showlink_span").style.display="none";
getObj("pic_publish_sep").style.display="none";
getObj("pic_publish_revert_span").style.display="none";
}else{
if(_2e09){
_2e09.style.display="none";
getObj("pic_publish_sep").style.display="none";
}
getObj("pic_publish_showlink_span").style.display="";
getObj("pic_publish_sep").style.display="";
getObj("pic_publish_revert_span").style.display="";
}
}else{
if(chart["CP_CHART_PUBLICURL"]!=null&&chart["CP_CHART_PUBLICURL"]=="true"){
getObj("pic_publish_showlink_span").style.display="";
}else{
getObj("pic_publish_showlink_span").style.display="none";
}
getObj("pic_publish_revert_span").style.display="none";
if(_2e09){
_2e09.style.display="none";
getObj("pic_publish_sep").style.display="none";
getObj("chart_public_sep").style.display="none";
}
getObj("chart_public_sep").style.display="";
}
}
catch(e){
}
}
function publish(id,_2e0b){
if(isUnRegisteredUser){
showAlertDialog(replaceParams(jsTitleMsg["IAMError.unconfirmeduser"],[userEmail]));
return;
}
if(typeof _2e0b=="undefined"){
var _2e0b=false;
}
if(!_2e0b){
publishChart(id);
}
var url=getPublishURL(id);
var _2e0d=encodeURIComponent(getAltTextForChart(id));
var _2e0e="<img title=\""+_2e0d+"\" alt=\""+_2e0d+"\" src=\""+url+"\">";
var _2e0f="<div id='picPublishDIV' style='width:420px;padding:5px;line-height:20px;'> "+ole.getCurrObj().type+" "+jsMsg.isPubliclyAvailableNow;
_2e0f+=jsMsg.embedThisInWebpageCopyAndPasteSnippet+":<br>";
_2e0f+="<table width='90%' align='center' cellspacing=0 cellpadding=2>";
_2e0f+="<tr><td style='padding-top:5px;' align='right'><a href='javascript:getObj(\"picPublishURL\").select();'>"+jsMsg.SelectAll+"</a></td></tr>";
_2e0f+="<tr><td style='padding-bottom:10px'><textarea id='picPublishURL' class='picPublishURL' rows='3' onfocus='this.select()'>"+_2e0e+"</textarea></td></tr></table>";
_2e0f+="<div id='revert_publish'>"+jsMsg.ToRevertBackClickRevertPublish+"<br>";
if(!jsPUBLIC_VIEW){
_2e0f+="<div style='margin-top:7px;'><input type='button' class='button' onclick='revertPublish(ole.getCurrObj().id);return false;' value='"+jsTitleMsg.RevertPublish+"'>&nbsp;";
}
_2e0f+="<input type='button' class='button' value='"+jsTitleMsg.Close+"' onclick='closeDialog()'></div></div></div>";
if(!_2e0b){
showURLInDialog(ctxpath+"pages/rangesnippet.jsp?type=chart&title="+doit(_2e0d)+"&alt="+doit(_2e0d)+"&src="+doit(url),"position=absolute,width=500,srcElement=pic_publish_link,modal=yes,title="+jsTitleMsg.PublishChart,positionDialog);
}else{
showURLInDialog(ctxpath+"pages/rangesnippet.jsp?type=chart&title="+doit(_2e0d)+"&alt="+doit(_2e0d)+"&src="+doit(url),"position=absolute,width=500,srcElement=pic_publish_link,modal=yes,title="+jsTitleMsg.PublishedChart+" URL",positionDialog);
}
if(getObj("revert_publish")!=undefined&&!READ_WRITE){
getObj("revert_publish").style.display="none";
}
}
function revertPublish(id){
unpublishChart(id);
closeDialog();
}
var picContextMenuStatus=false;
function chartContextMenu(id){
var chart=ExcelGraph.getInstance(id);
var _2e13=getObj("pic_publish_link_span");
if(!picContextMenuStatus){
createPicContextMenu();
}
if(READ_WRITE&&ALLOW_TO_WRITE){
Menu.picContextMenu.cachedContent="";
if(chart["CP_CHART_PUBLICURL"]==null||chart["CP_CHART_PUBLICURL"]=="false"){
Menu.picContextMenu.data[0].hidden="false";
Menu.picContextMenu.data[1].hidden="false";
Menu.picContextMenu.data[2].hidden="false";
Menu.picContextMenu.data[3].hidden="false";
Menu.picContextMenu.data[4].hidden="false";
Menu.picContextMenu.data[5].hidden="true";
Menu.picContextMenu.data[6].hidden="true";
Menu.picContextMenu.data[7].hidden="true";
}else{
Menu.picContextMenu.data[0].hidden="false";
Menu.picContextMenu.data[1].hidden="false";
Menu.picContextMenu.data[2].hidden="false";
Menu.picContextMenu.data[3].hidden="false";
Menu.picContextMenu.data[4].hidden="true";
Menu.picContextMenu.data[5].hidden="false";
Menu.picContextMenu.data[6].hidden="false";
Menu.picContextMenu.data[7].hidden="true";
}
}
if(jsVERSION_VIEW||jsREMOTE_VIEW||jsPUBLIC_VIEW||jsTHROWAWAY_VIEW||jsGUEST_VIEW||jsREMOTE_SAVE_VIEW||jsTRASH_VIEW){
Menu.picContextMenu.cachedContent="";
Menu.picContextMenu.data[0].hidden="false";
Menu.picContextMenu.data[1].hidden="false";
Menu.picContextMenu.data[2].hidden="false";
Menu.picContextMenu.data[3].hidden="true";
Menu.picContextMenu.data[4].hidden="true";
Menu.picContextMenu.data[5].hidden="true";
Menu.picContextMenu.data[6].hidden="true";
Menu.picContextMenu.data[7].hidden="true";
}
if(jsSHARE_VIEW){
Menu.picContextMenu.data[0].hidden="false";
Menu.picContextMenu.data[1].hidden="false";
Menu.picContextMenu.data[2].hidden="false";
Menu.picContextMenu.data[3].hidden="false";
Menu.picContextMenu.data[4].hidden="true";
Menu.picContextMenu.data[5].hidden="true";
Menu.picContextMenu.data[6].hidden="true";
Menu.picContextMenu.data[7].hidden="true";
Menu.picContextMenu.data[8].hidden="true";
}
if(HIDE_PUBLISH_OPTION){
Menu.picContextMenu.data[3].hidden="true";
Menu.picContextMenu.data[4].hidden="true";
Menu.picContextMenu.data[5].hidden="true";
Menu.picContextMenu.data[6].hidden="true";
}
}
function imageContextMenu(){
if(!picContextMenuStatus){
createPicContextMenu();
}
Menu.picContextMenu.cachedContent="";
Menu.picContextMenu.data[0].hidden="true";
Menu.picContextMenu.data[1].hidden="true";
Menu.picContextMenu.data[2].hidden="true";
Menu.picContextMenu.data[3].hidden="true";
Menu.picContextMenu.data[4].hidden="true";
Menu.picContextMenu.data[5].hidden="true";
Menu.picContextMenu.data[6].hidden="true";
Menu.picContextMenu.data[7].hidden="false";
Menu.picContextMenu.data[8].hidden="false";
}
var currContextMenuPic=null;
function createPicContextMenu(){
var _2e14="<menu id='picContextMenu' forElement='picFocusDIV'>";
_2e14+=" <item hidden = 'true' onclick='showChartTab(\"chartType\",currContextMenuPic);return false'><![CDATA["+jsMsg.ChartType+"..."+"]]></item>";
_2e14+=" <item hidden = 'true' onclick='showChartTab(\"chartData\",currContextMenuPic);return false'><![CDATA["+jsMsg.SourceData+"..."+"]]></item>";
_2e14+=" <item hidden = 'true' onclick='showChartTab(\"chartOptions\",currContextMenuPic);return false'><![CDATA["+jsMsg.ChartOptions+"..."+"]]></item>";
_2e14+=" <sep></sep>";
_2e14+=" <item hidden = 'true' onclick='Picture.publish(currContextMenuPic);return false'><![CDATA["+jsMsg.PublishChart+"]]></item>";
_2e14+=" <item hidden = 'true' onclick='Picture.publish(currContextMenuPic);return false'><![CDATA["+jsMsg.ShowChartURL+"]]></item>";
_2e14+=" <item hidden = 'true' onclick='Picture.revertPublish(currContextMenuPic);return false'><![CDATA["+jsMsg.RevertPublish+"]]></item>";
_2e14+=" <item hidden = 'true' onclick='Picture.resizeToOriginalDim(currContextMenuPic);return false;'><![CDATA["+jsMsg.ResizeToOriginalSize+"]]></item>";
_2e14+=" <sep></sep>";
_2e14+=" <item onclick='Picture.saveImage(currContextMenuPic);return false'><![CDATA["+jsMsg.SaveImage+"]]></item>";
_2e14+=" <item onclick='Picture.remove(currContextMenuPic);return false'><![CDATA["+jsMsg.Delete+"]]></item>";
_2e14+="</menu>";
createContextMenu(_2e14,{inputType:"xml"});
picContextMenuStatus=true;
}
function isPublicView(_2e15){
if(_2e15=="THROWAWAY_VIEW"||_2e15=="PUBLIC_VIEW"||_2e15=="REMOTE_VIEW"||_2e15=="REMOTE_SAVE_VIEW"||_2e15=="GUEST_VIEW"){
return true;
}
return false;
}
function resizeChart(id,width,_2e18,_2e19){
var chart=ExcelGraph.getInstance(id);
chart.CP_WIDTH=width;
chart.CP_HEIGHT=_2e18;
if(_2e18<=0||width<=0){
return;
}
createChart(chart,"RESIZE","",_2e19);
}
function positionChart(id,left,top,_2e1e,_2e1f){
var chart=ExcelGraph.getInstance(id);
chart.CP_LEFT=left;
chart.CP_TOP=top;
ole(id).sCol=findColInXPos(left);
ole(id).sRow=findRowInYPos(top);
if(typeof _2e1f!="undefined"){
ole(id).sRowDiff=_2e1f;
}else{
ole(id).sRowDiff=top-getRowTop(ole(id).sRow);
}
if(typeof sColDiff!="undefined"){
ole(id).sColDiff=_2e1f;
}else{
ole(id).sColDiff=left-getColLeft(ole(id).sCol);
}
chart["CP_SCOL"]=ole(id).sCol;
chart["CP_SCOL_DIFF"]=ole(id).sColDiff;
chart["CP_SROW"]=ole(id).sRow;
chart["CP_SROW_DIFF"]=ole(id).sRowDiff;
createChart(chart,"MOVE","",_2e1e);
}
function updateChart(id,left,top,_2e24){
var chart=ExcelGraph.getInstance(id);
var _2e26=OLE[id].el;
chart.CP_WIDTH=_2e26.width;
chart.CP_HEIGHT=_2e26.height;
var xPos=parseInt(_2e26.style.left);
var yPos=parseInt(_2e26.style.top);
ole(id).sCol=findColInXPos(xPos);
ole(id).sRow=findRowInYPos(yPos);
chart["CP_SCOL_DIFF"]=parseInt(xPos-getColLeft(ole(id).sCol));
chart["CP_SROW_DIFF"]=parseInt(yPos-getRowTop(ole(id).sRow));
ole(id).sColDiff=chart["CP_SCOL_DIFF"];
ole(id).sRowDiff=chart["CP_SROW_DIFF"];
chart.CP_LEFT=xPos;
chart.CP_TOP=yPos;
chart["CP_SCOL"]=ole(id).sCol;
chart["CP_SROW"]=ole(id).sRow;
if(_2e26.height<=0||_2e26.width<=0){
return;
}
createChart(chart,"RESIZE","",_2e24);
}
function removeChart(id,_2e2a){
var chart=ExcelGraph.getInstance(id);
if(typeof _2e2a=="undefined"){
createChart(chart,"DELETE");
}
availChartRange[chart["CP_CHART_DBID"]]=-1;
RemoveChartCellRange(chart);
if(typeof ole.getCurrObj()!="undefined"){
ole.getCurrObj().deSelect();
}
ExcelGraph.removeInstance(id);
}
function regenerateChart(_2e2c){
var chart=ExcelGraph.getInstance(getChartImgId(_2e2c));
if(!chart){
chart=ExcelGraph.getInstance(_2e2c);
}
if(chart){
createChart(chart,"EDIT");
}
}
function getDataRange(range){
range=range.replace(/\!/g,".");
range=range.replace(/\,/g,";");
if(range.indexOf(":")>-1){
if(range.indexOf(";")>-1){
range=range.substring(0,range.indexOf(";")-1);
}
var _2e2f=range.split(":");
for(i=0;i<_2e2f.length;i++){
splitSheetName=_2e2f[i].split(".");
if(splitSheetName.length==2){
if(splitSheetName[0].toLowerCase()==CURRSHEETNAME.toLowerCase()){
range=range.replace(splitSheetName[0]+".","");
}
}
}
var _2e30=getCellPosByLabel(range.split(":")[0]);
var _2e31=getCellPosByLabel(range.split(":")[1]);
return {type:"RANGE",startRow:_2e30.row,startCol:_2e30.col,endRow:_2e31.row,endCol:_2e31.col};
}else{
splitSheetName=range.split(".");
if(splitSheetName.length==2){
if(splitSheetName[0].toLowerCase()==CURRSHEETNAME.toLowerCase()){
range=range.replace(splitSheetName[0]+".","");
}
}
var _2e32=getCellPosByLabel(range.split(":")[0]);
return {type:"CELL",row:_2e32.row,col:_2e32.col};
}
}
function setDataRange(_2e33){
if(isChartDialogOpened&&document.editChartForm){
var frm=document.editChartForm;
if(!isCellRange()&&!rangeFill){
if(frm.dataRange.value==""){
frm.dataRange.value=getCellLabel(currRow,currCol);
}
if(_2e33!="fromInit"){
focusCellRangeFill(currRow,currCol,currRow,currCol);
}
}else{
if(!rangeFill){
var _2e35=getCellRange();
var _2e36=_2e35.startRow;
var _2e37=_2e35.startCol;
var _2e38=_2e35.endRow;
var _2e39=_2e35.endCol;
if(frm.dataRange.value==""){
frm.dataRange.value=getCellLabel(_2e36,_2e37)+":"+getCellLabel(_2e38,_2e39);
}
if(_2e33!="fromInit"){
focusCellRangeFill(_2e36,_2e37,_2e38,_2e39);
}
if(chartDialogState=="ADD"){
if(_2e38-_2e36>_2e39-_2e37){
frm.dataSeries[0].checked=false;
frm.dataSeries[1].checked=true;
}else{
frm.dataSeries[0].checked=true;
frm.dataSeries[1].checked=false;
}
}
}
}
if(chartDialogState=="ADD"&&_2e33=="fromInit"){
autodetectColRowType(getDataRange(frm.dataRange.value));
if((_2e39-_2e37)==1){
var _2e3a=getCellData(getCell(_2e36,_2e39));
if(isNaN(_2e3a)){
frm.chartTitle.value=_2e3a;
}
}else{
if((_2e39-_2e37)==0){
var _2e3a=getCellData(getCell(_2e36,_2e37));
if(isNaN(_2e3a)){
frm.chartTitle.value=_2e3a;
}
}
}
}
}
}
function focusDataRange(){
var range=document.editChartForm.dataRange.value;
if(isValidRange(range)){
if(range!=null&&range.indexOf(";")<0&&range.indexOf(".")==-1&&range.indexOf("!")==-1){
var _2e3c=getCellPosByLabel(range.split(":")[0]);
var _2e3d=getCellPosByLabel(range.split(":")[1]);
focusCellRangeFill(_2e3c.row,_2e3c.col,_2e3d.row,_2e3d.col,true);
}
}else{
return;
}
}
function autodetectColRowType(_2e3e){
if(getFirstRowType(_2e3e)=="NUMBER"){
getObj("firstRowAsLabel").checked=false;
}
if(getFirstColType(_2e3e)=="NUMBER"){
getObj("firstColAsLabel").checked=false;
}
}
function isValidRange(range,mode){
var _2e41=range;
if(_2e41==null||_2e41==""){
if(mode=="submit"){
showAlertDialog(jsTitleMsg.InvalidRange);
}
return false;
}
_2e41=_2e41.replace(/\!/g,".");
_2e41=_2e41.replace(/\,/g,";");
arr=_2e41.split(";");
for(var j=0;j<arr.length;j++){
var temp=0;
if(arr.length==j+1){
if(arr[j]==""){
break;
}
}
shtname=arr[j].split(".");
shtrange=arr[j];
if(shtname.length==2){
var _2e44;
rangeLength=shtname[0].split(":").length;
if(rangeLength==1){
_2e44=shtname[0];
shtrange=shtname[1];
}else{
if(mode=="submit"){
showAlertDialog(jsTitleMsg.InvalidRange);
}
return false;
}
var _2e45=getObj("sheetsTab").getElementsByTagName("TD");
for(var i=0;i<_2e45.length-1;i++){
if(_2e45[i].getAttribute("sheetname")!=null){
var _2e47=_2e45[i].getAttribute("sheetname");
if(_2e47.toLowerCase()==_2e44.toLowerCase()){
temp=1;
}
}
}
if(temp==0){
if(mode=="submit"){
showAlertDialog(jsTitleMsg.SpecifyValidSheetName);
}
return false;
}
}else{
if(shtname.length==3){
var _2e44=shtname[0];
var _2e45=getObj("sheetsTab").getElementsByTagName("TD");
for(var i=0;i<_2e45.length-1;i++){
if(_2e45[i].getAttribute("sheetname")!=null){
var _2e47=_2e45[i].getAttribute("sheetname");
if(_2e47.toLowerCase()==_2e44.toLowerCase()){
temp=1;
}
}
}
if(temp==0){
if(mode=="submit"){
showAlertDialog(jsTitleMsg.SpecifyValidSheetName);
}
return false;
}
multiplesheetname=shtname[1].split(":");
if(multiplesheetname.length==2){
var _2e48=multiplesheetname[1];
if(_2e48.toLowerCase()!=_2e44.toLowerCase()){
if(mode=="submit"){
showAlertDialog(jsTitleMsg.InvalidRange);
}
return false;
}
}else{
if(mode=="submit"){
showAlertDialog(jsTitleMsg.InvalidRange);
}
return false;
}
shtrange=multiplesheetname[0]+":"+shtname[2];
}
}
ranges=shtrange.split(":");
if(ranges.length==2){
var scol=-1;
var srow=-1;
var ecol=-1;
var erow=-1;
if(ranges[0]==""||ranges[1]==""){
if(mode=="submit"){
showAlertDialog(jsTitleMsg.InvalidRange);
}
return false;
}
st=getCellPosByLabel(ranges[0]);
scol=st.col;
srow=st.row;
en=getCellPosByLabel(ranges[1]);
ecol=en.col;
erow=en.row;
if(scol>=0&&ecol>=0&&srow>=0&&erow>=0){
}else{
if(mode=="submit"){
showAlertDialog(jsTitleMsg.InvalidRange);
}
return false;
}
}else{
if(ranges.length==1){
var scol=-1;
var srow=-1;
st=getCellPosByLabel(ranges[0]);
scol=st.col;
srow=st.row;
if(scol>=0&&srow>=0){
}else{
if(mode=="submit"){
showAlertDialog(jsTitleMsg.InvalidRange);
}
return false;
}
}else{
if(mode=="submit"){
showAlertDialog(jsTitleMsg.InvalidRange);
}
return false;
}
}
}
return true;
}
function getCellType(cell){
if(cell==null||typeof cell=="undefined"){
return "NUMBER";
}
var _2e4e=cell.getAttribute("format");
if(_2e4e!=null&&_2e4e!="null"){
var _2e4f=cell.getAttribute("format").toUpperCase();
}else{
var _2e4f="STANDARD";
}
var _2e50=cell.getAttribute("cV");
if(_2e50==null||_2e50=="null"){
_2e50="";
}
if(_2e4f!=null){
if(_2e4f=="DOLLAR"||_2e4f=="YEN"||_2e4f=="EURO"||_2e4f=="POUND"||_2e4f=="RUPEE"){
return "CURRENCY";
}else{
if(_2e4f=="PERCENT"){
return "PERCENT";
}else{
if(_2e4f=="NUMBER"){
var pos1=_2e50.indexOf("$",0);
var pos2=_2e50.indexOf("\xa5",0);
var pos3=_2e50.indexOf("\xa3",0);
if((pos1!=-1&&pos1<2)||(pos2!=-1&&pos2<2)||(pos3!=-1&&pos3<2)){
return "CURRENCY";
}else{
if(_2e50.charAt(_2e50.length-1)=="%"){
return "PERCENT";
}else{
return "NUMBER";
}
}
}else{
if(_2e4f=="STANDARD"){
if(isNaN(_2e50)){
var pos1=_2e50.indexOf("$",0);
var pos2=_2e50.indexOf("\xa5",0);
var pos3=_2e50.indexOf("\xa3",0);
if((pos1!=-1&&pos1<2)||(pos2!=-1&&pos2<2)||(pos3!=-1&&pos3<2)){
return "CURRENCY";
}else{
if(_2e50.charAt(_2e50.length-1)=="%"){
return "PERCENT";
}else{
return "TEXT";
}
}
}else{
return "NUMBER";
}
}
}
}
}
}
return "TEXT";
}
function getCellData(cell){
if(cell==null||typeof cell=="undefined"){
return 0;
}
var _2e55=cell.getAttribute("cV");
if(_2e55==null||_2e55=="null"){
_2e55="";
}
var _2e56=cell.getAttribute("format");
if(_2e56!=null&&_2e56!="null"){
var _2e57=cell.getAttribute("format").toUpperCase();
}else{
var _2e57="STANDARD";
}
_2e55=_2e55.trim();
if(_2e57!=null){
if(_2e57=="STANDARD"||_2e57=="NUMBER"){
var pos1=_2e55.indexOf("$",0);
var pos2=_2e55.indexOf("\xa5",0);
var pos3=_2e55.indexOf("\xa3",0);
if(pos1!=-1&&pos1<2){
_2e57="DOLLAR";
}else{
if(pos2!=-1&&pos2<2){
_2e57="YEN";
}else{
if(pos3!=-1&&pos3<2){
_2e57="POUND";
}else{
if(_2e55.charAt(_2e55.length-1)=="%"){
_2e57="PERCENT";
}
}
}
}
}
if(_2e57=="DOLLAR"||_2e57=="YEN"){
var _2e5b=_2e55.indexOf("$");
if(_2e5b==0){
if(_2e55.charAt(1)=="("){
_2e55="-"+_2e55.substr(2,_2e55.length-3);
}else{
_2e55=_2e55.substr(1,_2e55.length-1);
}
}else{
if(_2e5b==1){
if(_2e55.charAt(0)=="("){
_2e55="-"+_2e55.substr(2,_2e55.length-3);
}else{
_2e55="-"+_2e55.substr(2,_2e55.length-1);
}
}
}
}else{
if(_2e57=="PERCENT"){
_2e55=_2e55.substr(0,_2e55.length-1);
}
}
}
if(_2e55.indexOf(",")>-1){
_2e55=_2e55.replace(/,/g,"");
}
if(_2e57=="PERCENT"){
_2e55=_2e55/100;
_2e55=_2e55+"";
}
return decodeBlankSpaces(_2e55);
}
function decodeBlankSpaces(val){
return val.replace(/(\u00a0)/g," ");
}
function getFirstRowType(_2e5d){
var cols=_2e5d.endCol-_2e5d.startCol+1;
var type="NUMBER";
for(var i=1;i<=cols;i++){
if(isNaN(getCellData(getCell(_2e5d.startRow,i+_2e5d.startCol)))){
type="TEXT";
break;
}
}
return type;
}
function getFirstColType(_2e61){
var rows=_2e61.endRow-_2e61.startRow+1;
var type="NUMBER";
for(var i=1;i<=rows;i++){
if(isNaN(getCellData(getCell(i+_2e61.startRow,_2e61.startCol)))){
type="TEXT";
break;
}
}
return type;
}
function getChartData(range){
var _2e66=getDataRange(range);
var data=new Array();
var _2e68="NUMBER";
var _2e69=false;
var _2e6a=false;
if(_2e66.type=="CELL"){
data[0]=new Array();
data[0][0]="";
data[0][1]="1";
data[1]=new Array();
data[1][0]="1";
var cell=getCell(_2e66.row,_2e66.col);
_2e68=getCellType(cell);
data[1][1]=getCellData(cell);
_2e69=false;
_2e6a=false;
}else{
var rows=_2e66.endRow-_2e66.startRow+1;
var cols=_2e66.endCol-_2e66.startCol+1;
var _2e6e=getCellData(getCell(_2e66.startRow,_2e66.startCol));
if(rows==1||cols==1){
data[0]=new Array();
data[0][0]="";
}
if(rows==1&&cols>1){
data[1]=new Array();
_2e69=false;
if(isNaN(_2e6e)){
_2e68=getCellType(getCell(_2e66.startRow,_2e66.startCol+1));
data[1][0]=_2e6e;
var j=1;
_2e6a=true;
}else{
_2e68=getCellType(getCell(_2e66.startRow,_2e66.startCol));
data[1][0]="1";
var j=0;
_2e6a=false;
}
var i=1;
while(j<cols){
data[0][i]=i;
data[1][i]=getCellData(getCell(_2e66.startRow,j+_2e66.startCol));
i++;
j++;
}
}else{
if(rows>1&&cols==1){
_2e6a=false;
if(isNaN(_2e6e)){
_2e68=getCellType(getCell(_2e66.startRow+1,_2e66.startCol));
data[0][1]=_2e6e;
var k=1;
_2e69=true;
}else{
_2e68=getCellType(getCell(_2e66.startRow,_2e66.startCol));
data[0][1]="1";
var k=0;
_2e69=false;
}
for(var i=k,j=1;i<rows;i++,j++){
val=getCellData(getCell(i+_2e66.startRow,_2e66.startCol));
data[j]=new Array();
data[j][0]=j;
data[j][1]=val;
}
}else{
if(_2e6e.trim().length==0){
var _2e72="TEXT";
var _2e73="TEXT";
}else{
var _2e72=getFirstRowType(_2e66);
var _2e73=getFirstColType(_2e66);
}
data[0]=new Array();
data[0][0]="";
if(_2e72=="TEXT"&&_2e73=="NUMBER"){
_2e69=true;
_2e6a=false;
_2e68=getCellType(getCell(_2e66.startRow+1,_2e66.startCol));
for(var i=1;i<rows;i++){
data[i]=new Array();
data[i][0]=i;
}
for(var i=0;i<rows;i++){
for(var j=0,k=1;j<cols;j++,k++){
data[i][k]=getCellData(getCell(i+_2e66.startRow,j+_2e66.startCol));
}
}
}else{
if(_2e72=="NUMBER"&&_2e73=="TEXT"){
_2e69=false;
_2e6a=true;
_2e68=getCellType(getCell(_2e66.startRow,_2e66.startCol+1));
for(var i=1;i<cols;i++){
data[0][i]=i;
}
for(var i=0,k=1;i<rows;i++,k++){
data[k]=new Array();
for(var j=0;j<cols;j++){
data[k][j]=getCellData(getCell(i+_2e66.startRow,j+_2e66.startCol));
}
}
}else{
if(_2e72=="NUMBER"&&_2e73=="NUMBER"){
_2e69=false;
_2e6a=false;
_2e68=getCellType(getCell(_2e66.startRow,_2e66.startCol));
for(var j=0,l=1;j<cols;j++,l++){
data[0][l]=l;
}
for(var i=0,k=1;i<rows;i++,k++){
data[k]=new Array();
data[k][0]=k;
}
for(var i=0,k=1;i<rows;i++,k++){
for(var j=0,l=1;j<cols;j++,l++){
data[k][l]=getCellData(getCell(i+_2e66.startRow,j+_2e66.startCol));
}
}
}else{
_2e69=true;
_2e6a=true;
_2e68=getCellType(getCell(_2e66.startRow+1,_2e66.startCol+1));
for(var i=0;i<rows;i++){
data[i]=new Array();
for(var j=0;j<cols;j++){
data[i][j]=getCellData(getCell(i+_2e66.startRow,j+_2e66.startCol));
}
}
}
}
}
}
}
}
return {"data":data,"format":_2e68,"firstRowAsLabel":_2e69,"firstColAsLabel":_2e6a};
}
function submitChartData(frm,cid){
var _2e77=frm.chartType.value;
currChart=chartId;
var _2e78=document.editChartForm.ORIENTATION.value;
var _2e79=(frm.dataSeries[0].checked)?"ROWS":"COLS";
var _2e7a=1;
if(frm.legendright.checked){
_2e7a=3;
}else{
if(frm.legendbottom.checked){
_2e7a=1;
}else{
if(frm.legendleft.checked){
_2e7a=4;
}else{
if(frm.legendtop.checked){
_2e7a=2;
}else{
if(frm.legendnone.checked){
_2e7a=0;
}
}
}
}
}
var _2e7b=frm.dataRange.value;
if(!isValidRange(_2e7b,"submit")){
return false;
}
if(chartDialogState=="EDIT"){
var chart=ExcelGraph.getInstance(currChart);
chart["CP_DATARANGE"]=frm.dataRange.value;
chart["CP_DATAIN"]=_2e79;
chart["CP_CHARTTYPEID"]=frm.selChartID.value;
chart["CP_GRAPHTYPE"]=_2e77;
chart["CP_PLOT_ORIENTATION"]=_2e78;
chart["CP_SHOW_LEGEND"]=_2e7a;
chart["CP_CHART_TITLE"]=frm.chartTitle.value;
chart["CP_CHART_X_LABEL"]=frm.xAxisTitle.value;
chart["CP_CHART_Y_LABEL"]=frm.yAxisTitle.value;
chart["CP_LABEL_FORMAT"]=frm.dataLabels.value;
chart["CP_FIRSTCOL_LABEL"]=(frm.firstColAsLabel.checked)?"true":"false";
chart["CP_FIRSTROW_LABEL"]=(frm.firstRowAsLabel.checked)?"true":"false";
createChart(chart,"EDIT");
}else{
var _2e7d=450;
var _2e7e=330;
var _2e7f=Math.round((sheet.offsetHeight)/2-_2e7e/2+getSheetScrollTop());
var _2e80=Math.round((sheet.offsetWidth)/2-_2e7d/2+getSheetScrollLeft());
var chart={CP_DOCUMENTID:DOCUMENT_ID,CP_DOCUMENTSHEETID:DOCUMENTSHEET_ID,CP_DATARANGE:frm.dataRange.value,CP_DATAIN:_2e79,CP_CHARTTYPEID:frm.selChartID.value,CP_GRAPHTYPE:_2e77,CP_PLOT_ORIENTATION:_2e78,CP_SHOW_LEGEND:_2e7a,CP_CHART_TITLE:frm.chartTitle.value,CP_CHART_X_LABEL:frm.xAxisTitle.value,CP_CHART_Y_LABEL:frm.yAxisTitle.value,CP_LABEL_FORMAT:frm.dataLabels.value,CP_WIDTH:_2e7d,CP_HEIGHT:_2e7e,CP_TOP:_2e7f,CP_LEFT:_2e80,CP_FIRSTCOL_LABEL:(frm.firstColAsLabel.checked)?"true":"false",CP_FIRSTROW_LABEL:(frm.firstRowAsLabel.checked)?"true":"false"};
createChart(chart,"NEW");
}
closeChartDialog();
return false;
}
var isChartDialogOpened=false;
var showTab="";
function showChartDialog(id){
if(showTab==""){
showTab="edit";
}
if(jsNEW_DOC_VIEW){
if(SAVECHART=="false"){
if(DOCUMENT_ID=="doc_id"){
SAVED=false;
savefile("autosave");
SAVECHART="true";
}
}
}
if(isCellEdited()){
submitCell();
}
if(isChartDialogOpened||(isChartDialogOpened&&!SAVED)){
closeDialog();
}
isChartDialogOpened=true;
if(chartDialogState=="EDIT"){
showURLInDialog(ctxpath+"pages/editchart.jsp?mode="+showTab,"position=absmiddle,width=590,top=45, title="+jsTitleMsg.EditChart,initChartDetails,"",closeChartDialog);
}else{
showURLInDialog(ctxpath+"pages/editchart.jsp?mode=add","position=absmiddle,width=590,top=45 ,closeOnEscKey=no,title="+jsTitleMsg.AddChart,initChartDetails,"",closeChartDialog);
}
}
function closeChartDialog(){
isChartDialogOpened=false;
closeDialog();
resetCellRangeFill("chartDialog");
clearCellRangeFill();
}
var currChartStep="";
function initChartDetails(ev){
if(chartDialogState=="EDIT"){
if(showTab!="edit"){
currChartTab=showTab;
}else{
currChartTab="chartType";
}
var chart=ExcelGraph.getInstance(currChart);
var _2e84=chart["CP_GRAPHTYPE"];
var _2e85=chart["CP_PLOT_ORIENTATION"];
var frm=document.editChartForm;
frm.chartType.value=_2e84;
frm.ORIENTATION.value=_2e85;
if(typeof chart["CP_CHARTTYPEID"]=="undefined"||chart["CP_CHARTTYPEID"]==null){
if(_2e84.indexOf("BAR")>-1){
chart["CP_CHARTTYPEID"]=_2e84+"_"+_2e85;
}else{
chart["CP_CHARTTYPEID"]=_2e84;
}
}
frm.selChartID.value=chart["CP_CHARTTYPEID"];
initChartType(chartTypeInfo[chart["CP_CHARTTYPEID"]].category,chart["CP_CHARTTYPEID"]);
if(chart["CP_SHOW_LEGEND"]==0){
frm.legendnone.checked=true;
}else{
if(chart["CP_SHOW_LEGEND"]==1){
frm.legendbottom.checked=true;
}else{
if(chart["CP_SHOW_LEGEND"]==2){
frm.legendtop.checked=true;
}else{
if(chart["CP_SHOW_LEGEND"]==3){
frm.legendright.checked=true;
}else{
if(chart["CP_SHOW_LEGEND"]==4){
frm.legendleft.checked=true;
}
}
}
}
}
frm.dataRange.value=chart["CP_DATARANGE"];
if(chart["CP_DATAIN"].toUpperCase()=="ROWS"){
frm.dataSeries[0].checked=true;
frm.dataSeries[1].checked=false;
}else{
frm.dataSeries[1].checked=true;
frm.dataSeries[0].checked=false;
}
if(chart["CP_FIRSTCOL_LABEL"]=="true"){
frm.firstColAsLabel.checked=true;
}else{
frm.firstColAsLabel.checked=false;
}
if(chart["CP_FIRSTROW_LABEL"]=="true"){
frm.firstRowAsLabel.checked=true;
}else{
frm.firstRowAsLabel.checked=false;
}
frm.chartTitle.value=chart["CP_CHART_TITLE"];
frm.xAxisTitle.value=chart["CP_CHART_X_LABEL"];
frm.yAxisTitle.value=chart["CP_CHART_Y_LABEL"];
frm.dataLabels.value=options=chart["CP_LABEL_FORMAT"];
}else{
initChartType("column_charts","BAR_Y");
if(document.editChartForm){
setDataRange("fromInit");
}
setChartInputs("BAR_Y");
currChartStep="chartType";
}
if(showTab!=""&&showTab!="edit"){
showChartTab(showTab);
}
positionDialog();
}
function initChartType(type,_2e88){
if(typeof type=="undefined"||type==""){
type="column_charts";
}
if(typeof _2e88=="undefined"||_2e88==""){
_2e88="BAR_Y";
}
getObj(type).className="selected";
getObj(type+"_table").style.display="";
getObj(_2e88).className="chartSubTypeSel";
showSubTypeName(getObj(_2e88));
showSubTypeDetails(getObj(_2e88));
currChartType=type;
currChartSubType=_2e88;
}
function setChartInputs(_2e89){
document.editChartForm.selChartID.value=_2e89;
document.editChartForm.chartType.value=chartTypeInfo[_2e89].type;
document.editChartForm.ORIENTATION.value=(typeof chartTypeInfo[_2e89].orientation!="undefined")?chartTypeInfo[_2e89].orientation:"Y";
document.editChartForm.SHAPES.value=(typeof chartTypeInfo[_2e89].shapes!="undefined")?chartTypeInfo[_2e89].shapes:"false";
document.editChartForm.ADDXORDER.value=(typeof chartTypeInfo[_2e89].addXOrder!="undefined")?chartTypeInfo[_2e89].addXOrder:"false";
}
var currChartType="";
function toggleChartType(el){
if(currChartType!=""){
getObj(currChartType+"_table").style.display="none";
getObj(currChartType).className="";
}
el.className="selected";
currChartType=el.id;
getObj(el.id+"_table").style.display="";
updateDataLabel(document.editChartForm);
toggleChartSubType("",el);
if(currChartType=="scatter_charts"){
var _2e8b=getObj("firstColAsLabel");
_2e8b.disabled=true;
_2e8b.checked=false;
}else{
var _2e8b=getObj("firstColAsLabel");
_2e8b.disabled=false;
}
}
function updateDataLabel(frm){
var _2e8d=frm.dataLabels.value;
if("L_P"==_2e8d||"P"==_2e8d){
if("pie_charts"!=currChartType){
frm.dataLabels.value="N";
}
}else{
if("B"==_2e8d){
if("bubble_charts"!=currChartType){
frm.dataLabels.value="N";
}
}else{
if("L"==_2e8d){
if("area_charts"==currChartType){
frm.dataLabels.value="N";
}
}
}
}
}
function chartTypeHover(el){
if(el.className=="chartType"){
el.className="chartTypeHover";
}
}
function chartTypeOut(el){
if(el.className=="chartTypeHover"){
el.className="chartType";
}
}
var currChartSubType="";
function toggleChartSubType(el,_2e91){
if(currChartSubType==el.id){
return;
}
if(currChartSubType!=""){
var _2e92=getObj(currChartSubType);
_2e92.className="chartSubType";
_2e92.getElementsByTagName("DIV")[0].style.visibility="hidden";
}
if(typeof _2e91!="undefined"){
var _2e93=_2e91.getAttribute("firstSubType");
showSubTypeName(getObj(_2e93));
showSubTypeDetails(getObj(_2e93));
}else{
var _2e93=el.id;
}
getObj(_2e93).className="chartSubTypeSel";
currChartSubType=_2e93;
setChartInputs(_2e93);
}
function chartSubTypeHover(el){
if(currChartSubType!=el.id){
el.className="chartSubTypeHover";
}
showSubTypeName(el);
showSubTypeDetails(getObj(el.id));
}
function chartSubTypeOut(el){
if(currChartSubType!=el.id){
el.className="chartSubType";
}
if(el.className!="chartSubTypeSel"){
el.getElementsByTagName("DIV")[0].style.visibility="hidden";
}
showSubTypeDetails(getObj(currChartSubType));
}
function showSubTypeName(el){
var _2e97=el.getElementsByTagName("DIV")[0];
_2e97.style.visibility="visible";
_2e97.innerHTML=chartTypeInfo[el.id].name;
}
function showSubTypeDetails(el){
getObj("chartSubTypeDetails").innerHTML="<strong>"+chartTypeInfo[el.id].name+"</strong>: "+chartTypeInfo[el.id].desc;
}
function nextChartStep(){
if(getObj("chartTypeDIV").style.display!="none"){
showChartStep("chartData");
}else{
if(getObj("chartDataDIV").style.display!="none"){
showChartStep("chartOptions");
}
}
}
function previousChartStep(){
if(getObj("chartDataDIV").style.display!="none"){
showChartStep("chartType");
}else{
if(getObj("chartOptionsDIV").style.display!="none"){
showChartStep("chartData");
}
}
}
function showChartStep(id,el){
if(typeof el!="undefined"&&el!=null&&(el.className=="notCrossed"||el.className=="current")){
return;
}
if(currChartStep!=""){
getObj(currChartStep+"Step").className="crossed";
getObj(currChartStep+"DIV").style.display="none";
}
getObj(id+"Step").className="current";
getObj(id+"DIV").style.display="";
switch(id){
case "chartType":
getObj("chartBackBtn").style.display="none";
getObj("chartNextBtn").style.display="";
break;
case "chartData":
getObj("chartBackBtn").style.display="";
getObj("chartNextBtn").style.display="";
setDataRange();
getObj("dataRange").focus();
if(currChartType=="scatter_charts"){
var _2e9b=getObj("firstColAsLabel");
_2e9b.disabled=true;
_2e9b.checked=false;
}else{
var _2e9b=getObj("firstColAsLabel");
_2e9b.disabled=false;
}
break;
case "chartOptions":
getObj("chartBackBtn").style.display="";
getObj("chartNextBtn").style.display="none";
getObj("xAxisTitleTR").style.display=getObj("yAxisTitleTR").style.display=(currChartType=="pie_charts")?"none":"";
toggleDataLabelOptions();
try{
getObj("chartTitle").focus();
}
catch(e){
}
break;
}
currChartStep=id;
}
var currChartTab="";
function showChartTab(id,cid){
if(!isChartDialogOpened){
showTab="edit";
if(id=="chartData"){
showTab="chartData";
}else{
if(id=="chartOptions"){
showTab="chartOptions";
}
}
editChart(cid,id);
return;
}
if(currChartTab!=""){
getObj(currChartTab+"Tab").className="";
getObj(currChartTab+"DIV").style.display="none";
}
getObj(id+"Tab").className="selected";
getObj(id+"DIV").style.display="";
currChartTab=id;
switch(id){
case "chartData":
getObj("dataRange").focus();
focusDataRange();
if(currChartType=="scatter_charts"){
var _2e9e=getObj("firstColAsLabel");
_2e9e.disabled=true;
_2e9e.checked=false;
}else{
var _2e9e=getObj("firstColAsLabel");
_2e9e.disabled=false;
}
break;
case "chartOptions":
getObj("xAxisTitleTR").style.display=getObj("yAxisTitleTR").style.display=(currChartType=="pie_charts")?"none":"";
toggleDataLabelOptions(options);
try{
getObj("chartTitle").focus();
}
catch(e){
}
break;
}
}
function toggleDataLabelOptions(_2e9f){
if(currChartType=="web_charts"||currChartType=="stock_charts"){
getObj("dataLabelsTR").style.display="none";
}else{
getObj("dataLabelsTR").style.display="";
var _2ea0=getObj("dataLabels");
var _2ea1=_2ea0.length;
removeSelectOptions(_2ea0,"ALL");
if(currChartType=="pie_charts"){
addSelectOptions(_2ea0,jsTitleMsg.None,"N","dataLabels_none");
addSelectOptions(_2ea0,jsTitleMsg.ShowValue,"V","dataLabels_value");
addSelectOptions(_2ea0,jsTitleMsg.ShowLabel,"L","dataLabels_label");
addSelectOptions(_2ea0,jsTitleMsg.ShowPercent,"P","dataLabels_percent");
addSelectOptions(_2ea0,jsTitleMsg.ShowLabelPercent,"L_P","dataLabels_label_percent");
}else{
if(currChartType=="area_charts"){
addSelectOptions(_2ea0,jsTitleMsg.None,"N","dataLabels_none");
addSelectOptions(_2ea0,jsTitleMsg.ShowValue,"V","dataLabels_value");
}else{
if(currChartType=="bubble_charts"){
addSelectOptions(_2ea0,jsTitleMsg.None,"N","dataLabels_none");
addSelectOptions(_2ea0,jsTitleMsg.ShowValue,"V","dataLabels_value");
addSelectOptions(_2ea0,jsTitleMsg.ShowLabel,"L","dataLabels_label");
addSelectOptions(_2ea0,jsTitleMsg.ShowBubbleSize,"B","dataLabels_bubble_size");
}else{
addSelectOptions(_2ea0,jsTitleMsg.None,"N","dataLabels_none");
addSelectOptions(_2ea0,jsTitleMsg.ShowValue,"V","dataLabels_value");
addSelectOptions(_2ea0,jsTitleMsg.ShowLabel,"L","dataLabels_label");
}
}
}
if(typeof _2e9f!="undefined"&&_2e9f!=""){
_2ea0.value=_2e9f;
}
}
}
var chartMoreActionsMenuStatus=false;
function showChartMoreActionsMenu(ev){
if((transMode==true)&&(messagetranslated==true)){
chartMoreActionsMenuStatus=false;
}
if(!chartMoreActionsMenuStatus){
var _2ea3="";
_2ea3="<menu id='ChartMoreActionsMenu' forElement='chart_actionBar_moreActions'><item onclick='saveImage(ole.getCurrObj().id);'><![CDATA["+jsMsg["Image.SaveAsImage"]+"]]></item><sep></sep><item onclick='ole.remove(ole.getCurrObj().id, true);'><![CDATA["+jsMsg.Delete+"]]></item></menu>";
Menu.create(_2ea3,{inputType:"xml"});
chartMoreActionsMenuStatus=true;
}
Menu.ChartMoreActionsMenu.cachedContent="";
ole.currObj.resetActionBarState();
showMenu("ChartMoreActionsMenu");
}
function closeChartActionBarMenus(id){
ole(id).hideContextMenu();
if(Menu.ChartMoreActionsMenu&&isMenuOpened("ChartMoreActionsMenu")){
hideContextMenu("ChartMoreActionsMenu");
}
if(Menu.ChartEditOptionsMenu&&isMenuOpened("ChartEditOptionsMenu")){
hideContextMenu("ChartEditOptionsMenu");
}
}
var chartEditOptionsMenuStatus=false;
function showEditOptionsMenu(ev){
if((transMode==true)&&(messagetranslated==true)){
chartEditOptionsMenuStatus=false;
}
if(!chartEditOptionsMenuStatus){
var _2ea6="";
_2ea6="<menu id='ChartEditOptionsMenu' forElement='displayPort'><item onclick='showChartTab(\"chartType\",ole.getCurrObj().id);return false'><![CDATA["+jsMsg.ChartType+"...]]></item><item onclick='showChartTab(\"chartData\",ole.getCurrObj().id);return false'><![CDATA["+jsMsg.SourceData+"..."+"]]></item><item onclick='showChartTab(\"chartOptions\",ole.getCurrObj().id);return false'><![CDATA["+jsMsg.ChartOptions+"..."+"]]></item></menu>";
Menu.create(_2ea6,{inputType:"xml"});
chartEditOptionsMenuStatus=true;
}
Menu.ChartEditOptionsMenu.cachedContent="";
ole.currObj.resetActionBarState();
showMenu("ChartEditOptionsMenu");
}
function chartConetextMenuOpt(){
Menu.ChartConetextMenu.cachedContent="";
var _2ea7=getObj("pic_publish_link_span");
if(_2ea7==null||_2ea7.style.display=="none"){
Menu.ChartConetextMenu.data[4].hidden="false";
Menu.ChartConetextMenu.data[3].hidden="true";
Menu.ChartConetextMenu.data[5].hidden="true";
Menu.ChartConetextMenu.data[6].hidden="false";
}else{
Menu.ChartConetextMenu.data[4].hidden="true";
Menu.ChartConetextMenu.data[5].hidden="false";
Menu.ChartConetextMenu.data[6].hidden="true";
}
if(jsVERSION_VIEW||jsREMOTE_VIEW||jsPUBLIC_VIEW||jsTHROWAWAY_VIEW||jsGUEST_VIEW||jsREMOTE_SAVE_VIEW||jsTRASH_VIEW){
Menu.ChartConetextMenu.data[4].hidden="true";
Menu.ChartConetextMenu.data[5].hidden="true";
Menu.ChartConetextMenu.data[6].hidden="true";
}
if(jsSHARE_VIEW){
Menu.ChartConetextMenu.data[4].hidden="true";
Menu.ChartConetextMenu.data[5].hidden="true";
Menu.ChartConetextMenu.data[6].hidden="true";
Menu.ChartConetextMenu.data[7].hidden="true";
}
if(HIDE_PUBLISH_OPTION){
Menu.ChartConetextMenu.data[3].hidden="true";
Menu.ChartConetextMenu.data[4].hidden="true";
Menu.ChartConetextMenu.data[5].hidden="true";
Menu.ChartConetextMenu.data[6].hidden="true";
}
}
var chartTypeInfo={"BAR_Y":{name:jsMsg["Chart.Type.Column"],desc:jsMsg.ComparesValuesAcrossCategories,type:"BAR",category:"column_charts"},"STACKEDBAR_Y":{name:jsMsg.StackedColumn,desc:jsMsg.ComparesContributionAcrossCategories,type:"STACKEDBAR",category:"column_charts"},"STACKEDBAR_PERCENT_Y":{name:jsMsg.StackCol100,desc:jsMsg.ComparesPercentageAcrossCategories,type:"STACKEDBAR_PERCENT",category:"column_charts"},"BAR3D_Y":{name:jsMsg.Column3D,desc:jsMsg.Column3DDesc,type:"BAR3D",category:"column_charts"},"STACKEDBAR3D_Y":{name:jsMsg.StackedColumn3D,desc:jsMsg.StackedColumn3DDesc,type:"STACKEDBAR3D",category:"column_charts"},"STACKEDBAR3D_PERCENT_Y":{name:jsMsg.StackCol1003D,desc:jsMsg.StackCol1003DDesc,type:"STACKEDBAR3D_PERCENT",category:"column_charts"},"BAR_X":{name:jsMsg.Bar,desc:jsMsg.ComparesValuesAcrossCategories,type:"BAR",orientation:"X",category:"bar_charts"},"STACKEDBAR_X":{name:jsMsg.StackedBar,desc:jsMsg.ComparesContributionAcrossCategories,type:"STACKEDBAR",orientation:"X",category:"bar_charts"},"STACKEDBAR_PERCENT_X":{name:jsMsg.StackBar100,desc:jsMsg.ComparesPercentageAcrossCategories,type:"STACKEDBAR_PERCENT",orientation:"X",category:"bar_charts"},"BAR3D_X":{name:jsMsg.Bar3D,desc:jsMsg.Bar3DDesc,type:"BAR3D",orientation:"X",category:"bar_charts"},"STACKEDBAR3D_X":{name:jsMsg.StackedBar3D,desc:jsMsg.StackedBar3DDesc,type:"STACKEDBAR3D",orientation:"X",category:"bar_charts"},"STACKEDBAR3D_PERCENT_X":{name:jsMsg.StackBar1003D,desc:jsMsg.StackBar1003DDesc,type:"STACKEDBAR3D_PERCENT",orientation:"X",category:"bar_charts"},"XYLINE":{name:jsMsg.Line,desc:jsMsg.LineDesc,type:"XYLINE",addXOrder:"true",category:"line_charts"},"XYLINE_SHAPES":{name:jsMsg.LineMarkers,desc:jsMsg.LineMarkersDesc,type:"XYLINE_SHAPES",addXOrder:"true",shapes:"true",category:"line_charts"},"STEPCHART":{name:jsMsg.Step,desc:jsMsg.StepDesc,type:"STEPCHART",addXOrder:"true",shapes:"true",category:"line_charts"},"PIE":{name:jsMsg.Pie,desc:jsMsg.PieDesc,type:"PIE",category:"pie_charts"},"PIE3D":{name:jsMsg.Pie3D,desc:jsMsg.Pie3DDesc,type:"PIE3D",shapes:"true",category:"pie_charts"},"SCATTER":{name:jsMsg.Scatter,desc:jsMsg.ScatterDesc,type:"SCATTER",addXOrder:"false",shapes:"true",category:"scatter_charts"},"XYLINE_SCATTER":{name:jsMsg.ScatterLine,desc:jsMsg.ScatterLineDesc,type:"XYLINE_SCATTER",addXOrder:"false",category:"scatter_charts"},"XYLINE_SCATTER_SHAPES":{name:jsMsg.ScatterLineMarkers,desc:jsMsg.ScatterLineMarkersDesc,type:"XYLINE_SCATTER_SHAPES",addXOrder:"false",shapes:"true",category:"scatter_charts"},"XYAREA":{name:jsMsg.Area,desc:jsMsg.AreaDesc,type:"XYAREA",addXOrder:"true",shapes:"true",category:"area_charts"},"XYSTACKEDAREA":{name:jsMsg.StackedArea,desc:jsMsg.StackedAreaDesc,type:"XYSTACKEDAREA",addXOrder:"true",shapes:"true",category:"area_charts"},"POLAR":{name:jsMsg.Polar,desc:jsMsg.PolarDesc,type:"POLAR",addXOrder:"false",shapes:"false",category:"web_charts"},"SPIDERWEB":{name:jsMsg.SpiderWeb,desc:jsMsg.SpiderWebDesc,type:"SPIDERWEB",category:"web_charts"},"BUBBLECHART":{name:jsMsg.Bubble,desc:jsMsg.BubbleDesc,type:"BUBBLECHART",category:"bubble_charts"},"OHLCCHART":{name:jsMsg.OHLC,desc:jsMsg.OHLCDesc,type:"OHLCCHART",category:"stock_charts"},"CANDLESTICK":{name:jsMsg.CandleStick,desc:jsMsg.CandleStickDesc,type:"CANDLESTICK",category:"stock_charts"}};
var chartTypes=new Array("BAR_Y","STACKEDBAR_Y","STACKEDBAR_PERCENT_Y","BAR3D_Y","STACKEDBAR3D_Y","STACKEDBAR3D_PERCENT_Y","BAR_X","STACKEDBAR_X","STACKEDBAR_PERCENT_X","BAR3D_X","STACKEDBAR3D_X","STACKEDBAR3D_PERCENT_X","XYLINE","XYLINE_SHAPES","STEPCHART","PIE","PIE3D","SCATTER","XYLINE_SCATTER","XYLINE_SCATTER_SHAPES","XYAREA","XYSTACKEDAREA","POLAR","SPIDERWEB","BUBBLECHART","OHLCCHART","CANDLESTICK");
ole.createObjectProperties("chart",{focusLayer:"OLEFocusLayer",selectLayer:"OLESelectLayer",menuData:chartMenuData,minHeight:10,minWidth:10,hasOrdering:false,actionBar:"ChartActionBar",contextMenu:"ChartConetextMenu",cloneOnCTRLDrag:false,resizeCorners:"all",onResizeEnd:updateChart,onDragEnd:positionChart,onRemove:removeChart,onClone:addChart,onDbClick:showChartTab,onObjectSwitch:closeChartActionBarMenus,onMove:closeChartActionBarMenus,onMoveEnd:positionChart,onDocOpen:closeChartActionBarMenus,onBeforeLoadActionBar:publishChartOptions});
function ExcelGraph(_2ea8){
this.URL="ExcelChart.cc";
this.updateConfig=function(_2ea9){
for(var i in _2ea9){
this[i]=_2ea9[i];
}
};
this.refreshChart=function(_2eab,_2eac){
var _2ead="";
for(var i in this){
if(i.indexOf("CP_")==0){
_2ead+="&"+encodeURIComponent(i.substring(3))+"="+encodeURIComponent(this[i]);
}
}
var _2eaf="";
if(this.data){
for(var i=0;i<this.data.length;i++){
for(var j=0;j<this.data[i].length;j++){
var item=((this.data[i][j]==null)||(this.data[i][j]==""))?" ":this.data[i][j]+"";
var regx=new RegExp(",","g");
item=item.replace(regx,"-,");
_2eaf+=item+" ,";
}
_2eaf+="\n";
}
}
_2ead+="&CHARTDATA="+encodeURIComponent(_2eaf);
if(_2eab!=null){
_2ead+="&"+_2eab;
}
AjaxAPI.sendRequest({URL:((_2eac!=null)?_2eac:this.URL),PARAMETERS:_2ead,ONSUCCESSFUNC:this.ONSUCCESSFUNC,CHARTREF:this});
};
this.updateConfig(_2ea8);
}
ExcelGraph.createInstance=function(_2eb3){
var _2eb4=new ExcelGraph(_2eb3);
_2eb4.CP_CHARTID="ExcelGraph"+ ++ExcelGraph._INSCOUNT;
ExcelGraph._INSTANCES[_2eb4.CP_CHARTID]=_2eb4;
return _2eb4;
};
ExcelGraph._INSCOUNT=0;
ExcelGraph._INSTANCES=new Object();
ExcelGraph.getInstance=function(id){
return this._INSTANCES[id];
};
ExcelGraph.removeInstance=function(id){
delete this._INSTANCES[id];
};
ExcelGraph.updateDiv=function(_2eb7,_2eb8){
var chart=_2eb8.v("CHARTREF");
var div=document.getElementById(chart.DIVTOUPDATE);
div.innerHTML=_2eb7.getOnlyHtml();
};
var Prototype={Version:"1.3.1",emptyFunction:function(){
}};
var Class={create:function(){
return function(){
this.initialize.apply(this,arguments);
};
}};
Object.objExtendFun=function(_2ebb){
return Object.extend.apply(this,[this,_2ebb]);
};
function ProtoObj(){
}
ProtoObj.prototype.extend=Object.objExtendFun;
var Abstract=new Object();
Object.extend=function(_2ebc,_2ebd){
for(property in _2ebd){
_2ebc[property]=_2ebd[property];
}
return _2ebc;
};
Function.prototype.bind=function(_2ebe){
var _2ebf=this;
return function(){
_2ebf.apply(_2ebe,arguments);
};
};
Function.prototype.bindAsEventListener=function(_2ec0){
var _2ec1=this;
return function(event){
_2ec1.call(_2ec0,event||window.event);
};
};
Number.prototype.toColorPart=function(){
var _2ec3=this.toString(16);
if(this<16){
return "0"+_2ec3;
}
return _2ec3;
};
var Try={these:function(){
var _2ec4;
for(var i=0;i<arguments.length;i++){
var _2ec6=arguments[i];
try{
_2ec4=_2ec6();
break;
}
catch(e){
}
}
return _2ec4;
}};
var PeriodicalExecuter=Class.create();
PeriodicalExecuter.prototype={initialize:function(_2ec7,_2ec8){
this.callback=_2ec7;
this.frequency=_2ec8;
this.currentlyExecuting=false;
this.registerCallback();
},registerCallback:function(){
setInterval(this.onTimerEvent.bind(this),this.frequency*1000);
},onTimerEvent:function(){
if(!this.currentlyExecuting){
try{
this.currentlyExecuting=true;
this.callback();
}
finally{
this.currentlyExecuting=false;
}
}
}};
function $(){
var _2ec9=new Array();
for(var i=0;i<arguments.length;i++){
var _2ecb=arguments[i];
if(typeof _2ecb=="string"){
_2ecb=document.getElementById(_2ecb);
}
if(arguments.length==1){
return _2ecb;
}
_2ec9.push(_2ecb);
}
return _2ec9;
}
if(!Array.prototype.push){
Array.prototype.push=function(){
var _2ecc=this.length;
for(var i=0;i<arguments.length;i++){
this[_2ecc+i]=arguments[i];
}
return this.length;
};
}
if(!Function.prototype.apply){
Function.prototype.apply=function(_2ece,_2ecf){
var _2ed0=new Array();
if(!_2ece){
_2ece=window;
}
if(!_2ecf){
_2ecf=new Array();
}
for(var i=0;i<_2ecf.length;i++){
_2ed0[i]="parameters["+i+"]";
}
_2ece.__apply__=this;
var _2ed2=eval("object.__apply__("+_2ed0[i].join(", ")+")");
_2ece.__apply__=null;
return _2ed2;
};
}
Object.extend(String.prototype,{stripTags:function(){
return this.replace(/<\/?[^>]+>/gi,"");
},escapeHTML:function(){
var div=document.createElement("div");
var text=document.createTextNode(this);
div.appendChild(text);
return div.innerHTML;
},unescapeHTML:function(){
var div=document.createElement("div");
div.innerHTML=this.stripTags();
return div.childNodes[0].nodeValue;
}});
var Ajax={getTransport:function(){
return Try.these(function(){
return new ActiveXObject("Msxml2.XMLHTTP");
},function(){
return new ActiveXObject("Microsoft.XMLHTTP");
},function(){
return new XMLHttpRequest();
})||false;
}};
Ajax.Base=function(){
};
Ajax.Base.prototype={setOptions:function(_2ed6){
this.options=Object.extend({method:"post",asynchronous:true,parameters:""},_2ed6||{});
},responseIsSuccess:function(){
return this.transport.status==undefined||this.transport.status==0||(this.transport.status>=200&&this.transport.status<300);
},responseIsFailure:function(){
return !this.responseIsSuccess();
}};
Ajax.Request=Class.create();
Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];
Ajax.Request.prototype=Object.extend((new Ajax.Base()),{initialize:function(url,_2ed8){
this.transport=Ajax.getTransport();
this.setOptions(_2ed8);
this.request(url);
},request:function(url){
var _2eda=this.options.parameters||"";
if(_2eda.length>0){
_2eda+="&_=";
}
if(this.options.method=="get"){
appendParamsToUrl(url,_2eda);
}
this.transport.open(this.options.method,url,this.options.asynchronous);
if(this.options.asynchronous){
this.transport.onreadystatechange=this.onStateChange.bind(this);
setTimeout((function(){
this.respondToReadyState(1);
}).bind(this),10);
}
this.setRequestHeaders();
var body=this.options.postBody?this.options.postBody:_2eda;
this.transport.send(this.options.method=="post"?body:null);
},setRequestHeaders:function(){
var _2edc=["X-Requested-With","XMLHttpRequest","X-Prototype-Version",Prototype.Version];
if(this.options.method=="post"){
_2edc.push("Content-type","application/x-www-form-urlencoded");
if(this.transport.overrideMimeType){
_2edc.push("Connection","close");
}
}
if(this.options.requestHeaders){
_2edc.push.apply(_2edc,this.options.requestHeaders);
}
for(var i=0;i<_2edc.length;i+=2){
this.transport.setRequestHeader(_2edc[i],_2edc[i+1]);
}
},onStateChange:function(){
var _2ede=this.transport.readyState;
if(_2ede!=1){
this.respondToReadyState(this.transport.readyState);
}
},respondToReadyState:function(_2edf){
var event=Ajax.Request.Events[_2edf];
if(event=="Complete"){
(this.options["on"+this.transport.status]||this.options["on"+this.responseIsSuccess()?"Success":"Failure"]||Prototype.emptyFunction)(this.transport);
}
(this.options["on"+event]||Prototype.emptyFunction)(this.transport,this);
if(event=="Complete"){
this.transport.onreadystatechange=Prototype.emptyFunction;
}
}});
Ajax.Updater=Class.create();
Ajax.Updater.ScriptFragment="(?:<script.*?>)((\n|.)*?)(?:</script>)";
Object.extend(Object.extend(Ajax.Updater.prototype,Ajax.Request.prototype),{initialize:function(_2ee1,url,_2ee3){
this.containers={success:_2ee1.success?$(_2ee1.success):$(_2ee1),failure:_2ee1.failure?$(_2ee1.failure):(_2ee1.success?null:$(_2ee1))};
this.transport=Ajax.getTransport();
this.setOptions(_2ee3);
var _2ee4=this.options.onComplete||Prototype.emptyFunction;
this.options.onComplete=(function(){
this.updateContent();
_2ee4(this.transport,this);
}).bind(this);
this.request(url);
},updateContent:function(){
var _2ee5=this.responseIsSuccess()?this.containers.success:this.containers.failure;
var match=new RegExp(Ajax.Updater.ScriptFragment,"img");
var _2ee7=this.transport.responseText.replace(match,"");
var _2ee8=this.transport.responseText.match(match);
if(_2ee5){
if(this.options.insertion){
new this.options.insertion(_2ee5,_2ee7);
}else{
_2ee5.innerHTML=_2ee7;
}
}
if(this.responseIsSuccess()){
if(this.onComplete){
setTimeout((function(){
this.onComplete(this.transport);
}).bind(this),10);
}
}
if(this.options.evalScripts&&_2ee8){
invokeScripts(_2ee8);
}
}});
Ajax.PeriodicalUpdater=Class.create();
Ajax.PeriodicalUpdater.prototype=Object.extend(new Ajax.Base(),{initialize:function(_2ee9,url,_2eeb){
this.setOptions(_2eeb);
this.onComplete=this.options.onComplete;
this.frequency=(this.options.frequency||2);
this.decay=1;
this.updater={};
this.container=_2ee9;
this.url=url;
this.start();
},start:function(){
this.options.onComplete=this.updateComplete.bind(this);
this.onTimerEvent();
},stop:function(){
this.updater.onComplete=undefined;
clearTimeout(this.timer);
(this.onComplete||Ajax.emptyFunction).apply(this,arguments);
},updateComplete:function(_2eec){
if(this.options.decay){
this.decay=(_2eec.responseText==this.lastText?this.decay*this.options.decay:1);
this.lastText=_2eec.responseText;
}
this.timer=setTimeout(this.onTimerEvent.bind(this),this.decay*this.frequency*1000);
},onTimerEvent:function(){
this.updater=new Ajax.Updater(this.container,this.url,this.options);
}});
document.getElementsByClassName=function(_2eed){
var _2eee=document.getElementsByTagName("*")||document.all;
var _2eef=new Array();
for(var i=0;i<_2eee.length;i++){
var child=_2eee[i];
var _2ef2=child.className.split(" ");
for(var j=0;j<_2ef2.length;j++){
if(_2ef2[j]==_2eed){
_2eef.push(child);
break;
}
}
}
return _2eef;
};
if(!window.Element){
var Element=new Object();
}
Object.extend(Element,{toggle:function(){
for(var i=0;i<arguments.length;i++){
var _2ef5=$(arguments[i]);
_2ef5.style.display=(_2ef5.style.display=="none"?"":"none");
}
},hide:function(){
for(var i=0;i<arguments.length;i++){
var _2ef7=$(arguments[i]);
_2ef7.style.display="none";
}
},show:function(){
for(var i=0;i<arguments.length;i++){
var _2ef9=$(arguments[i]);
_2ef9.style.display="";
}
},remove:function(_2efa){
_2efa=$(_2efa);
_2efa.parentNode.removeChild(_2efa);
},getHeight:function(_2efb){
_2efb=$(_2efb);
return _2efb.offsetHeight;
},hasClassName:function(_2efc,_2efd){
_2efc=$(_2efc);
if(!_2efc){
return;
}
var a=_2efc.className.split(" ");
for(var i=0;i<a.length;i++){
if(a[i]==_2efd){
return true;
}
}
return false;
},addClassName:function(_2f00,_2f01){
_2f00=$(_2f00);
Element.removeClassName(_2f00,_2f01);
_2f00.className+=" "+_2f01;
},removeClassName:function(_2f02,_2f03){
_2f02=$(_2f02);
if(!_2f02){
return;
}
var _2f04="";
var a=_2f02.className.split(" ");
for(var i=0;i<a.length;i++){
if(a[i]!=_2f03){
if(i>0){
_2f04+=" ";
}
_2f04+=a[i];
}
}
_2f02.className=_2f04;
},cleanWhitespace:function(_2f07){
var _2f07=$(_2f07);
for(var i=0;i<_2f07.childNodes.length;i++){
var node=_2f07.childNodes[i];
if(node.nodeType==3&&!/\S/.test(node.nodeValue)){
Element.remove(node);
}
}
}});
var Toggle=new ProtoObj();
Toggle.display=Element.toggle;
Abstract.Insertion=function(_2f0a){
this.adjacency=_2f0a;
};
Abstract.Insertion.prototype={initialize:function(_2f0b,_2f0c){
this.element=$(_2f0b);
this.content=_2f0c;
if(this.adjacency&&this.element.insertAdjacentHTML){
this.element.insertAdjacentHTML(this.adjacency,this.content);
}else{
this.range=this.element.ownerDocument.createRange();
if(this.initializeRange){
this.initializeRange();
}
this.fragment=this.range.createContextualFragment(this.content);
this.insertContent();
}
}};
Abstract.Insertion.prototype.extend=Object.objExtendFun;
var Insertion=new ProtoObj();
Insertion.Before=Class.create();
Insertion.Before.prototype=(new Abstract.Insertion("beforeBegin")).extend({initializeRange:function(){
this.range.setStartBefore(this.element);
},insertContent:function(){
this.element.parentNode.insertBefore(this.fragment,this.element);
}});
Insertion.Top=Class.create();
Insertion.Top.prototype=(new Abstract.Insertion("afterBegin")).extend({initializeRange:function(){
this.range.selectNodeContents(this.element);
this.range.collapse(true);
},insertContent:function(){
this.element.insertBefore(this.fragment,this.element.firstChild);
}});
Insertion.Bottom=Class.create();
Insertion.Bottom.prototype=(new Abstract.Insertion("beforeEnd")).extend({initializeRange:function(){
this.range.selectNodeContents(this.element);
this.range.collapse(this.element);
},insertContent:function(){
this.element.appendChild(this.fragment);
}});
Insertion.After=Class.create();
Insertion.After.prototype=(new Abstract.Insertion("afterEnd")).extend({initializeRange:function(){
this.range.setStartAfter(this.element);
},insertContent:function(){
this.element.parentNode.insertBefore(this.fragment,this.element.nextSibling);
}});
var Field={clear:function(){
for(var i=0;i<arguments.length;i++){
$(arguments[i]).value="";
}
},focus:function(_2f0e){
$(_2f0e).focus();
},present:function(){
for(var i=0;i<arguments.length;i++){
if($(arguments[i]).value==""){
return false;
}
}
return true;
},select:function(_2f10){
$(_2f10).select();
},activate:function(_2f11){
$(_2f11).focus();
$(_2f11).select();
}};
var Form={serialize:function(form){
var _2f13=Form.getElements($(form));
var _2f14=new Array();
for(var i=0;i<_2f13.length;i++){
var _2f16=Form.Element.serialize(_2f13[i]);
if(_2f16){
_2f14.push(_2f16);
}
}
return _2f14.join("&");
},getElements:function(form){
var form=$(form);
var _2f18=new Array();
for(tagName in Form.Element.Serializers){
var _2f19=form.getElementsByTagName(tagName);
for(var j=0;j<_2f19.length;j++){
_2f18.push(_2f19[j]);
}
}
return _2f18;
},getInputs:function(form,_2f1c,name){
var form=$(form);
var _2f1e=form.getElementsByTagName("input");
if(!_2f1c&&!name){
return _2f1e;
}
var _2f1f=new Array();
for(var i=0;i<_2f1e.length;i++){
var input=_2f1e[i];
if((_2f1c&&input.type!=_2f1c)||(name&&input.name!=name)){
continue;
}
_2f1f.push(input);
}
return _2f1f;
},disable:function(form){
var _2f23=Form.getElements(form);
for(var i=0;i<_2f23.length;i++){
var _2f25=_2f23[i];
_2f25.blur();
_2f25.disabled="true";
}
},enable:function(form){
var _2f27=Form.getElements(form);
for(var i=0;i<_2f27.length;i++){
var _2f29=_2f27[i];
_2f29.disabled="";
}
},focusFirstElement:function(form){
var form=$(form);
var _2f2b=Form.getElements(form);
for(var i=0;i<_2f2b.length;i++){
var _2f2d=_2f2b[i];
if(_2f2d.type!="hidden"&&!_2f2d.disabled){
Field.activate(_2f2d);
break;
}
}
},reset:function(form){
$(form).reset();
}};
Form.Element={serialize:function(_2f2f){
var _2f2f=$(_2f2f);
var _2f30=_2f2f.tagName.toLowerCase();
var _2f31=Form.Element.Serializers[_2f30](_2f2f);
if(_2f31){
var key=encodeURIComponent(_2f31[0]);
var str="";
if(_2f31[1] instanceof Array){
for(var i=0;i<_2f31[1].length;i++){
str+=key+"="+encodeURIComponent(_2f31[1][i])+"&";
}
return str;
}else{
return key+"="+encodeURIComponent(_2f31[1]);
}
}
},getValue:function(_2f35){
var _2f35=$(_2f35);
var _2f36=_2f35.tagName.toLowerCase();
var _2f37=Form.Element.Serializers[_2f36](_2f35);
if(_2f37){
return _2f37[1];
}
}};
Form.Element.Serializers={input:function(_2f38){
switch(_2f38.type.toLowerCase()){
case "submit":
case "hidden":
case "password":
case "text":
case "textfield":
case "textarea":
return Form.Element.Serializers.textarea(_2f38);
case "checkbox":
case "radio":
return Form.Element.Serializers.inputSelector(_2f38);
}
return false;
},inputSelector:function(_2f39){
if(_2f39.checked){
return [_2f39.name,_2f39.value];
}
},textarea:function(_2f3a){
return [_2f3a.name,_2f3a.value];
},select:function(_2f3b){
var value="";
if(_2f3b.type=="select-one"){
var index=_2f3b.selectedIndex;
if(index>=0){
value=_2f3b.options[index].value||_2f3b.options[index].text;
}
}else{
value=new Array();
for(var i=0;i<_2f3b.length;i++){
var opt=_2f3b.options[i];
if(opt.selected){
value.push(opt.value||opt.text);
}
}
}
return [_2f3b.name,value];
}};
var $F=Form.Element.getValue;
Abstract.TimedObserver=function(){
};
Abstract.TimedObserver.prototype={extend:Object.objExtendFun,initialize:function(_2f40,_2f41,_2f42){
this.frequency=_2f41;
this.element=$(_2f40);
this.callback=_2f42;
this.lastValue=this.getValue();
this.registerCallback();
},registerCallback:function(){
setInterval(this.onTimerEvent.bind(this),this.frequency*1000);
},onTimerEvent:function(){
var value=this.getValue();
if(this.lastValue!=value){
this.callback(this.element,value);
this.lastValue=value;
}
}};
Form.Element.Observer=Class.create();
Form.Element.Observer.prototype=(new Abstract.TimedObserver()).extend({extend:Object.objExtendFun,getValue:function(){
return Form.Element.getValue(this.element);
}});
Form.Observer=Class.create();
Form.Observer.prototype=(new Abstract.TimedObserver()).extend({getValue:function(){
return Form.serialize(this.element);
}});
Abstract.EventObserver=function(){
};
Abstract.EventObserver.prototype={extend:Object.objExtendFun,initialize:function(_2f44,_2f45){
this.element=$(_2f44);
this.callback=_2f45;
this.lastValue=this.getValue();
if(this.element.tagName.toLowerCase()=="form"){
this.registerFormCallbacks();
}else{
this.registerCallback(this.element);
}
},onElementEvent:function(){
var value=this.getValue();
if(this.lastValue!=value){
this.callback(this.element,value);
this.lastValue=value;
}
},registerFormCallbacks:function(){
var _2f47=Form.getElements(this.element);
for(var i=0;i<_2f47.length;i++){
this.registerCallback(_2f47[i]);
}
},registerCallback:function(_2f49){
if(_2f49.type){
switch(_2f49.type.toLowerCase()){
case "checkbox":
case "radio":
_2f49.target=this;
_2f49.prev_onclick=_2f49.onclick||Prototype.emptyFunction;
_2f49.onclick=function(){
this.prev_onclick();
this.target.onElementEvent();
};
break;
case "password":
case "text":
case "textarea":
case "select-one":
case "select-multiple":
_2f49.target=this;
_2f49.prev_onchange=_2f49.onchange||Prototype.emptyFunction;
_2f49.onchange=function(){
this.prev_onchange();
this.target.onElementEvent();
};
break;
}
}
}};
Form.Element.EventObserver=Class.create();
Form.Element.EventObserver.prototype=(new Abstract.EventObserver()).extend({getValue:function(){
return Form.Element.getValue(this.element);
}});
Form.EventObserver=Class.create();
Form.EventObserver.prototype=(new Abstract.EventObserver()).extend({getValue:function(){
return Form.serialize(this.element);
}});
if(!window.Event){
var Event=new Object();
}
Object.extend(Event,{KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(event){
return event.target||event.srcElement;
},isLeftClick:function(event){
return (((event.which)&&(event.which==1))||((event.button)&&(event.button==1)));
},pointerX:function(event){
return event.pageX||(event.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft));
},pointerY:function(event){
return event.pageY||(event.clientY+(document.documentElement.scrollTop||document.body.scrollTop));
},stop:function(event){
if(event.preventDefault){
event.preventDefault();
event.stopPropagation();
}else{
event.returnValue=false;
}
},findElement:function(event,_2f50){
var _2f51=Event.element(event);
while(_2f51.parentNode&&(!_2f51.tagName||(_2f51.tagName.toUpperCase()!=_2f50.toUpperCase()))){
_2f51=_2f51.parentNode;
}
return _2f51;
},observers:false,_observeAndCache:function(_2f52,name,_2f54,_2f55){
if(!this.observers){
this.observers=[];
}
if(_2f52.addEventListener){
this.observers.push([_2f52,name,_2f54,_2f55]);
_2f52.addEventListener(name,_2f54,_2f55);
}else{
if(_2f52.attachEvent){
this.observers.push([_2f52,name,_2f54,_2f55]);
_2f52.attachEvent("on"+name,_2f54);
}
}
},unloadCache:function(){
if(!Event.observers){
return;
}
for(var i=0;i<Event.observers.length;i++){
Event.stopObserving.apply(this,Event.observers[i]);
Event.observers[i][0]=null;
}
Event.observers=false;
},observe:function(_2f57,name,_2f59,_2f5a){
var _2f57=$(_2f57);
_2f5a=_2f5a||false;
if(name=="keypress"&&((navigator.appVersion.indexOf("AppleWebKit")>0)||_2f57.attachEvent)){
name="keydown";
}
this._observeAndCache(_2f57,name,_2f59,_2f5a);
},stopObserving:function(_2f5b,name,_2f5d,_2f5e){
var _2f5b=$(_2f5b);
_2f5e=_2f5e||false;
if(name=="keypress"&&((navigator.appVersion.indexOf("AppleWebKit")>0)||_2f5b.detachEvent)){
name="keydown";
}
if(_2f5b.removeEventListener){
_2f5b.removeEventListener(name,_2f5d,_2f5e);
}else{
if(_2f5b.detachEvent){
_2f5b.detachEvent("on"+name,_2f5d);
}
}
}});
Event.observe(window,"unload",Event.unloadCache,false);
var Position={includeScrollOffsets:false,prepare:function(){
this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;
this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;
},realOffset:function(_2f5f){
var _2f60=0,_2f61=0;
do{
_2f60+=_2f5f.scrollTop||0;
_2f61+=_2f5f.scrollLeft||0;
_2f5f=_2f5f.parentNode;
}while(_2f5f);
return [_2f61,_2f60];
},cumulativeOffset:function(_2f62){
var _2f63=0,_2f64=0;
do{
_2f63+=_2f62.offsetTop||0;
_2f64+=_2f62.offsetLeft||0;
_2f62=_2f62.offsetParent;
}while(_2f62);
return [_2f64,_2f63];
},within:function(_2f65,x,y){
if(this.includeScrollOffsets){
return this.withinIncludingScrolloffsets(_2f65,x,y);
}
this.xcomp=x;
this.ycomp=y;
this.offset=this.cumulativeOffset(_2f65);
return (y>=this.offset[1]&&y<this.offset[1]+_2f65.offsetHeight&&x>=this.offset[0]&&x<this.offset[0]+_2f65.offsetWidth);
},withinIncludingScrolloffsets:function(_2f68,x,y){
var _2f6b=this.realOffset(_2f68);
this.xcomp=x+_2f6b[0]-this.deltaX;
this.ycomp=y+_2f6b[1]-this.deltaY;
this.offset=this.cumulativeOffset(_2f68);
return (this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+_2f68.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+_2f68.offsetWidth);
},overlap:function(mode,_2f6d){
if(!mode){
return 0;
}
if(mode=="vertical"){
return ((this.offset[1]+_2f6d.offsetHeight)-this.ycomp)/_2f6d.offsetHeight;
}
if(mode=="horizontal"){
return ((this.offset[0]+_2f6d.offsetWidth)-this.xcomp)/_2f6d.offsetWidth;
}
},clone:function(_2f6e,_2f6f){
_2f6e=$(_2f6e);
_2f6f=$(_2f6f);
_2f6f.style.position="absolute";
var _2f70=this.cumulativeOffset(_2f6e);
_2f6f.style.top=_2f70[1]+"px";
_2f6f.style.left=_2f70[0]+"px";
_2f6f.style.width=_2f6e.offsetWidth+"px";
_2f6f.style.height=_2f6e.offsetHeight+"px";
}};
var _dbClassNameFunc=document.getElementsByClassName;
document.getElementsByClassName=function(_2f71){
var _2f72=document.getElementsByTagName("*")||document.all;
var _2f73=new Array();
for(var i=0;i<_2f72.length;i++){
var child=_2f72[i];
var _2f76=child.className.split(" ");
for(var j=0;j<_2f76.length;j++){
if(_2f76[j]==_2f71){
_2f73.push(child);
break;
}
}
}
return _2f73;
};
var _ourClassNameFunc=document.getElementsByClassName;
var AjaxAPI=new function(){
};
AjaxAPI.navigFrameName=null;
AjaxAPI.getXMLHttpRequest=function(){
var _2f78=null;
if(window.XMLHttpRequest){
_2f78=new XMLHttpRequest();
}else{
if(window.ActiveXObject){
try{
_2f78=new ActiveXObject("Msxml2.XMLHTTP");
}
catch(e){
_2f78=new ActiveXObject("Microsoft.XMLHTTP");
}
}
}
return _2f78;
};
AjaxAPI.sendRequest=function(_2f79){
_2f79=AjaxOptions.getAsAjaxOptions(_2f79);
var _2f7a=_2f79["URL"];
var _2f7b=AjaxAPI.getXMLHttpRequest();
var _2f7c=_2f79["PARAMETERS"];
var url=_2f79.v("URL");
if(_2f7c&&(_2f79.vu("METHOD")=="GET")){
url=appendParamsToUrl(url,_2f7c);
}
url=appendParamsToUrl(url,"SUBREQUEST=XMLHTTP");
_2f7b.open(_2f79.vu("METHOD"),url,_2f79.isTrue("ASYNCHRONOUS"));
var _2f7e=new Object();
_2f7e["X-Requested-With"]="XMLHttpRequest";
if(_2f79.vu("METHOD")=="POST"){
_2f7e["Content-type"]="application/x-www-form-urlencoded;charset=UTF-8";
}
if(_2f7b.overrideMimeType){
_2f7e["Connection"]="close";
}
AjaxUtils.updateObject(_2f7e,_2f79["REQUESTHEADERS"]);
for(var _2f7f in _2f7e){
_2f7b.setRequestHeader(_2f7f,_2f7e[_2f7f]);
}
var resp=new AjaxResponse(_2f7b);
_2f7b.onreadystatechange=function(){
AjaxUtils.handleAjaxResponse(resp,_2f79);
};
var body=_2f79["POSTBODY"]?_2f79["POSTBODY"]:_2f7c;
body=(_2f79.vu("METHOD")=="POST")?body:null;
if(_2f79["STATUSFUNC"]){
_2f79.fn("STATUSFUNC")(resp,_2f79);
}
_2f7b.send(body);
};
AjaxAPI.sendNavigableRequest=function(_2f82){
if(!(_2f82 instanceof AjaxOptions)){
_2f82=new AjaxOptions(_2f82);
}
if(_2f82["METHOD"]!="GET"){
throw new Error("Currently only Get is supported.");
}
var _2f83=_2f82.encode();
var url=_2f82["URL"];
if(url.indexOf("SUBREQUEST")==-1){
url=appendSubRequestArgs(url);
}
url+="#"+encodeURIComponent(_2f83);
window.frames[ROOT_VIEW_ID+"_RESPONSEFRAME"].location.href=url;
};
AjaxAPI.checkIfBlankPage=function(_2f85){
if((_2f85.location.href=="about:blank")||(_2f85.location.href.indexOf("blank.html")>0)||(_2f85.location.href.indexOf("empty.html")>0)){
return true;
}
return false;
};
AjaxAPI.handleIframeResponse=function(_2f86){
if(AjaxAPI.navigFrameName==null){
AjaxAPI.navigFrameName=_2f86.getAttribute("name");
}
var _2f87=window.frames[_2f86.getAttribute("name")];
if(AjaxAPI.checkIfBlankPage(_2f87)){
return;
}
var _2f88=_2f87.location.hash;
if((_2f88==null)||(_2f88.length<2)){
return;
}
_2f88=_2f88.substring(1);
if(browser_ie){
_2f88=decodeURIComponent(_2f88);
}
var _2f89=new AjaxOptions(_2f88);
_2f89.setV("URL",_2f87.location.href);
var _2f8a=new Object();
_2f8a.iframe=_2f87;
_2f8a.readyState=4;
_2f8a.status=200;
_2f8a.responseText="";
var _2f8b=false;
var _2f8c=_2f87.document.getElementsByTagName("*");
var _2f8d=_2f8c[_2f8c.length-1];
if(_2f8d.nodeName=="PRE"){
var _2f8e=_2f8d.childNodes;
for(var i=0;i<_2f8e.length;i++){
_2f8a.responseText+=_2f8e[i].nodeValue;
}
var _2f90="                    ";
if(_2f8a.responseText.indexOf(_2f90)==0){
_2f8b=true;
}
}
if(!_2f8b){
_2f8a.responseText=_2f8c[0].innerHTML;
}
var resp=new AjaxResponse(_2f8a);
AjaxUtils.handleAjaxResponse(resp,_2f89);
};
AjaxAPI.invokeNavigableAction=function(_2f92){
var _2f93=_2f92.encode();
_2f92.fn("NAVIGFUNCTION_N")(_2f92);
AjaxUtils.ignoreNavigFrameLoad=true;
window.frames["AJAXNAVIG"].location.href=CONTEXT_PATH+"/framework/html/blank.html?"+_2f93;
};
AjaxAPI.submit=function(frm){
try{
var _2f95=frm.attributes;
var _2f96=new AjaxOptions({submittedFrm:frm.name});
for(var i=0;i<_2f95.length;i++){
_2f96.setV(_2f95.item(i).nodeName,_2f95.item(i).nodeValue);
}
if(_2f96["VALIDATEFUNC"]){
if(!_2f96.fn("VALIDATEFUNC")(frm)){
return false;
}
}
var _2f98=Form.serialize(frm);
var _2f99=frm.getAttribute("action");
_2f99=updateStateCookieAndAppendSid(_2f99,null);
_2f99=appendSubRequestArgs(_2f99);
_2f96.update({URL:_2f99,parameters:_2f98});
AjaxAPI.sendRequest(_2f96);
}
catch(e){
StatusMsgAPI.showMsg("Script Error Occurred : "+e,false);
}
return false;
};
AjaxAPI.dummyFunction=function(_2f9a,_2f9b){
return StatusMsgAPI.OPSTATUS.FINISHED;
};
AjaxAPI.refreshView=function(_2f9c,_2f9d){
_2f9d.update({VIEWTOREFRESH_RN:_2f9d.v("SRCVIEW"),NAVIGABLE_RN:false});
alert(_2f9d.v("SRCVIEW"));
ViewAPI.refreshView(_2f9d);
return StatusMsgAPI.OPSTATUS.INPROGRESS;
};
AjaxAPI.closeViewAndRefreshDCA=function(_2f9e,_2f9f){
var _2fa0=_2f9f["SRCVIEW"];
var dca=getContentAreaFromState(_2fa0);
var _2fa2=getParentViewForDCA(dca);
closeView(_2fa0,true);
_2f9f.update({VIEWTOREFRESH_RN:_2fa2});
ViewAPI.refreshView(_2f9f);
return StatusMsgAPI.OPSTATUS.INPROGRESS;
};
AjaxAPI.closeView=function(_2fa3,_2fa4){
var _2fa5=_2fa4["SRCVIEW"];
AjaxUtils.showAjaxResponseOnNextPageLoad(_2fa3.responseText,true);
if(window.opener==null){
closeView(_2fa5);
}else{
window.opener.refreshCurrentView();
window.close();
}
return StatusMsgAPI.OPSTATUS.INPROGRESS;
};
AjaxAPI.forwardView=function(_2fa6,_2fa7){
AjaxUtils.showAjaxResponseOnNextPageLoad(_2fa6.responseText,true);
var _2fa8=_2fa6.getResponseParams(_2fa6.responseText);
var _2fa9=getAsQueryString(_2fa8);
updateViewInCA(_2fa7["VIEWTOFORWARD"],_2fa7["SRCVIEW"],null,getContentAreaFromState(_2fa7["SRCVIEW"]),null,false,null,_2fa9);
return StatusMsgAPI.OPSTATUS.INPROGRESS;
};
AjaxAPI.showInDialog=function(_2faa,_2fab){
showDialog(_2faa.responseText,_2fab["WINPARAMS"]);
return StatusMsgAPI.OPSTATUS.FINISHED;
};
AjaxAPI.setOnNextPageLoadScript=function(_2fac){
setCookie("PERSMSG",_2fac,null,CONTEXT_PATH+"/framework/html");
};
AjaxAPI.showPersMsg=function(count){
var win=window.frames[ROOT_VIEW_ID+"_RESPONSEFRAME"];
if((win==null)||(win.document==null)||(!win.document.isLoaded)){
if(count<50){
setTimeout("AjaxAPI.showPersMsg("+ ++count+")",30);
}
return;
}
var _2faf=getCookie("PERSMSG",win);
if(_2faf!=null){
deleteCookie("PERSMSG",CONTEXT_PATH+"/framework/html",win);
eval(_2faf);
}
};
AjaxAPI.setAjaxAttributes=function(_2fb0){
_2fb0=new AjaxOptions(_2fb0);
var frm=_2fb0.form("FORMNAME");
for(var i in _2fb0){
if((typeof _2fb0[i])!="string"){
continue;
}
existValue=_2fb0[i];
frm.setAttribute(i.toLowerCase(),existValue);
}
if(!frm.onsubmit){
frm.onsubmit=function(){
return AjaxAPI.submit(this);
};
}
frm.requestOptions=_2fb0;
};
AjaxAPI.showRespMsg=function(_2fb3,_2fb4){
var _2fb5=_2fb3.opStatus;
StatusMsgAPI.showOperationStatus(_2fb5);
if(_2fb5==StatusMsgAPI.OPSTATUS.STARTED){
return;
}else{
if(_2fb5==StatusMsgAPI.OPSTATUS.FAILED_SCRIPT){
throw _2fb3["EXCEP"];
}else{
if(_2fb5==StatusMsgAPI.OPSTATUS.FAILED){
var _2fb6=_2fb3.getResponsePart("STATUS_MESSAGE");
if(_2fb6==null){
showDialog(_2fb3.getOnlyHtml(),"title=Error Occured");
}else{
StatusMsgAPI.showMsg(_2fb6,(_2fb5==StatusMsgAPI.OPSTATUS.FINISHED));
}
}else{
if(_2fb5==StatusMsgAPI.OPSTATUS.FINISHED){
var _2fb6=_2fb3.getResponsePart("STATUS_MESSAGE");
if(_2fb6==null){
var _2fb7=_2fb4["PREVRESPONSE_RN"];
if(_2fb7!=null){
_2fb6=_2fb7.getResponsePart("STATUS_MESSAGE");
}
}
if(_2fb6!=null){
StatusMsgAPI.showMsg(_2fb6,(_2fb5==StatusMsgAPI.OPSTATUS.FINISHED));
}
}else{
if(_2fb5==StatusMsgAPI.OPSTATUS.INPROGRESS){
_2fb4["PREVRESPONSE_RN"]=_2fb3;
}
}
}
}
}
_2fb3.invokeScripts();
};
function AjaxOptions(_2fb8){
this.v=function(_2fb9,_2fba){
var value=this[_2fb9.toUpperCase()];
if(value==null){
value=_2fba;
}
if(value==null){
throw new Error("OptionNotPresent:"+_2fb9+" is not present");
}
return value;
};
this.vu=function(_2fbc){
return this.v(_2fbc).toUpperCase();
};
this.isTrue=function(_2fbd,_2fbe){
var value=this.v(_2fbd,_2fbe);
return ((value==true)||(value=="true"));
};
this.fn=function(_2fc0){
var value=this.v(_2fc0);
if(value instanceof Function){
return value;
}
var fun=eval(value);
if(!fun){
throw new Error("FunctionNotPresent: "+value+" is not declared in current window");
}
if(!(fun instanceof Function)){
throw new Error("IllegalOption : "+value+" is not a function.");
}
return fun;
};
this.form=function(_2fc3){
var frm=DOMUtils.getForm(this.v(_2fc3));
if(frm==null){
throw new Error(" FormNotFound : "+this.v(_2fc3)+" not found");
}
return frm;
};
this.setV=function(_2fc5,_2fc6){
this[_2fc5.toUpperCase()]=_2fc6;
};
this.update=function(_2fc7){
for(property in _2fc7){
var val=_2fc7[property];
this[property.toUpperCase()]=val;
}
};
this.encode=function(){
var _2fc9="";
var _2fca=new AjaxOptions();
for(var i in this){
if(this[i] instanceof Object){
continue;
}
if(_2fca[i]==this[i]){
continue;
}
if((i=="URL")||(i=="METHOD")){
continue;
}
var index=i.lastIndexOf("_RN");
if(index==i.length-"_RN".length){
continue;
}
var name=(i=="ONSUCCESSFUNC")?"_OS":i;
_2fc9+=name+"="+this[i]+"&";
}
if(_2fc9.length>1){
_2fc9=_2fc9.substring(0,_2fc9.length-1);
}
return _2fc9;
};
this.update({METHOD:"POST",ASYNCHRONOUS:true,STATUSFUNC:"AjaxAPI.showRespMsg"});
if((typeof _2fb8)=="string"){
_2fb8=parseRequestParams(_2fb8);
for(var i in _2fb8){
_2fb8[i]=_2fb8[i][0];
}
if(_2fb8["_OS"]!=null){
_2fb8["ONSUCCESSFUNC"]=_2fb8["_OS"];
}
}
this.update(_2fb8);
}
AjaxOptions.getAsAjaxOptions=function(_2fcf){
if(!(_2fcf instanceof AjaxOptions)){
_2fcf=new AjaxOptions(_2fcf);
}
return _2fcf;
};
function AjaxResponse(_2fd0){
this.responseText=null;
this.htmlContent=null;
this.scripts=null;
this.transport=_2fd0;
this.opStatus=StatusMsgAPI.OPSTATUS.STARTED;
this.isHttpReqSuccess=function(){
return this.transport.status==undefined||this.transport.status==0||(this.transport.status>=200&&this.transport.status<300);
};
this.getResponsePart=function(_2fd1){
return AjaxUtils.extractFromResponse(this.responseText,_2fd1);
};
this.getResponseParams=function(){
var _2fd2=AjaxUtils.extractFromResponse(this.responseText,"RESPONSE_PARAMS");
return (_2fd2!=null)?eval(_2fd2):{};
};
this.getOnlyHtml=function(){
this.splitResponse();
return this.htmlContent;
};
this.getScripts=function(){
this.splitResponse();
return this.scripts;
};
this.invokeScripts=function(){
if(!this["alreadyInvoked"]){
AjaxUtils.invokeScripts(this.getScripts());
this["alreadyInvoked"]=true;
}
};
this.splitResponse=function(){
if(this.htmlContent!=null){
return;
}
var split=AjaxUtils.separateScriptAndHtml(this.responseText);
this.htmlContent=split["html"];
this.scripts=split["scripts"];
};
}
var AjaxUtils=new function(){
};
AjaxUtils.ignoreNavigFrameLoad=false;
AjaxUtils.handleNavigFrameLoad=function(){
var _2fd4=window.frames["AJAXNAVIG"].location.search;
window.status="handle NavigFrameLoad called. "+_2fd4+" "+AjaxUtils.ignoreNavigFrameLoad;
if(AjaxUtils.ignoreNavigFrameLoad){
AjaxUtils.ignoreNavigFrameLoad=false;
return;
}
if((_2fd4==null)||(_2fd4=="")){
return;
}
var _2fd5=new AjaxOptions(_2fd4);
_2fd5.fn("NAVIGFUN_N")(_2fd5);
};
AjaxUtils.invokeScriptsInHtml=function(html){
var match=new RegExp(Ajax.Updater.ScriptFragment,"img");
var _2fd8=html.match(match);
AjaxUtils.invokeScripts(_2fd8);
};
AjaxUtils.separateScriptAndHtml=function(_2fd9){
var _2fda=new Object();
var match=new RegExp(Ajax.Updater.ScriptFragment,"img");
_2fda["html"]=_2fd9.replace(match,"");
match=new RegExp(Ajax.Updater.ScriptFragment,"img");
_2fda["scripts"]=_2fd9.match(match);
return _2fda;
};
AjaxUtils.invokeScripts=function(_2fdc){
if(_2fdc==null){
return;
}
var div=document.createElement("div");
var _2fde="";
for(var i=0;i<_2fdc.length;i++){
_2fde+="\n"+_2fdc[i];
}
var match=new RegExp("<script>","img");
_2fde=_2fde.replace(match,"<SCRIPT>");
match=new RegExp("</script>","img");
_2fde=_2fde.replace(match,"</SCRIPT>");
div.innerHTML="<html><body>"+_2fde+"</body></html>";
_2fdc=div.getElementsByTagName("SCRIPT");
for(var i=0;i<_2fdc.length;i++){
AjaxUtils.scheduleScript(_2fdc[i].text,_2fdc[i].src);
}
};
AjaxUtils.scheduleScript=function(_2fe1,_2fe2){
var _2fe3=document.createElement("SCRIPT");
if((_2fe2!=null)&&(_2fe2!="")){
_2fe3.src=_2fe2;
}
_2fe3.text=_2fe1;
if(!document.getElementsByTagName("HEAD")[0]){
document.createElement("HEAD").appendChild(_2fe3);
}else{
document.getElementsByTagName("HEAD")[0].appendChild(_2fe3);
}
};
AjaxUtils.handleAjaxResponse=function(_2fe4,_2fe5){
if(_2fe4.transport.readyState!=4){
return;
}
_2fe4.responseText=_2fe4.transport.responseText;
_2fe4.opStatus=StatusMsgAPI.OPSTATUS.INPROGRESS;
if(_2fe5["ORIGOPTIONS"]){
_2fe5=_2fe5["ORIGOPTIONS"];
closeDialog();
}
_2fe4.opStatus=AjaxUtils.internalHandleAjaxResponse(_2fe4,_2fe5);
if(_2fe5["STATUSFUNC"]){
_2fe5.fn("STATUSFUNC")(_2fe4,_2fe5);
}
};
AjaxUtils.internalHandleAjaxResponse=function(_2fe6,_2fe7){
if(_2fe6.responseText.indexOf("__ERROR__LOGIN")>-1){
AjaxUtils.handleReLogin(_2fe6,_2fe7);
return StatusMsgAPI.OPSTATUS.INPROGRESS_LOGIN;
}else{
if((_2fe6.responseText.indexOf("__ERROR__")>-1)||!_2fe6.isHttpReqSuccess()){
return StatusMsgAPI.OPSTATUS.FAILED;
}
}
var _2fe8=StatusMsgAPI.OPSTATUS.FINISHED;
if(_2fe7["ONSUCCESSFUNC"]){
try{
_2fe8=_2fe7.fn("ONSUCCESSFUNC")(_2fe6,_2fe7);
if(!_2fe8){
_2fe8=StatusMsgAPI.OPSTATUS.FINISHED;
}
}
catch(ex){
_2fe6["EXCEP"]=ex;
return StatusMsgAPI.OPSTATUS.FAILED_SCRIPT;
}
}
if(window["updateParentCookie"]){
}
return _2fe8;
};
AjaxUtils.handleReLogin=function(_2fe9,_2fea){
showDialog(_2fe9.responseText,"title=ReLogin(Session Timed Out),modal=yes");
var frm=DOMUtils.getFirstMatchingElement(oDialog.getElementsByTagName("form"),null,"name","login");
if(frm==null){
throw new Error("Login Page should contain a form with name as \"login\"");
}
frm["REQUESTOPTIONS"]=_2fea;
frm.onsubmit=function(){
AjaxUtils.submitReLoginFrm(frm);
return false;
};
return;
};
AjaxUtils.submitReLoginFrm=function(frm){
if(frm.getAttribute("validatefunc")){
if(!(eval(frm.getAttribute("validatefunc"))(frm))){
return false;
}
}
var _2fed=Form.serialize(frm);
AjaxAPI.sendRequest({URL:frm.action,PARAMETERS:_2fed,ORIGOPTIONS:frm["REQUESTOPTIONS"]});
return false;
};
AjaxUtils.updateObject=function(_2fee,_2fef){
if(_2fef==null){
return;
}
for(property in _2fef){
_2fee[property]=_2fef[property];
}
return _2fee;
};
AjaxUtils.extractFromResponse=function(_2ff0,_2ff1){
var div=document.createElement("div");
div.innerHTML=_2ff0;
var _2ff3=DOMUtils.getFirstMatchingElement(div.getElementsByTagName("div"),null,"part",_2ff1);
return (_2ff3!=null)?_2ff3.innerHTML:null;
};
AjaxUtils.showAjaxResponseOnNextPageLoad=function(_2ff4,_2ff5){
var _2ff6=AjaxUtils.extractFromResponse(_2ff4,"STATUS_MESSAGE");
if(_2ff6==null){
return;
}
StatusMsgAPI.showMsgOnNextPageLoad(_2ff6,_2ff5);
};
var StatusMsgAPI=new function(){
};
StatusMsgAPI.showOperationStatus=function(_2ff7){
var el=document.getElementById("mc_loading");
if(el!=null){
if((_2ff7==StatusMsgAPI.OPSTATUS.STARTED)||(_2ff7==StatusMsgAPI.OPSTATUS.INPROGRESS)||(_2ff7==StatusMsgAPI.OPSTATUS.INPROGRESS_LOGIN)){
el.className="mcLoading";
}else{
el.className="mcLoaded";
}
}
};
StatusMsgAPI.showMsgOnNextPageLoad=function(msg,_2ffa){
msg=msg.replace(/\n/g,"\\n");
var regex=new RegExp("'","g");
msg=msg.replace(regex,"\\'");
AjaxAPI.setOnNextPageLoadScript("StatusMsgAPI.showMsg('"+msg+"',"+_2ffa+")");
};
StatusMsgAPI.showMsg=function(_2ffc,_2ffd){
var _2ffe=document.getElementById("mc_messagediv");
if(_2ffe!=null){
_2ffe.className=(_2ffd)?"successMsg":"failureMsg";
var _2fff=document.getElementById("mc_messagetext");
_2fff.innerHTML=_2ffc;
}else{
if(!_2ffd){
showDialog(_2ffc,"title=Error Occured");
}
}
};
StatusMsgAPI.closeMsg=function(){
document.getElementById("mc_messagediv").className="hide";
};
StatusMsgAPI.OPSTATUS=new function(){
this.STARTED=1;
this.INPROGRESS=2;
this.INPROGRESS_LOGIN=3;
this.FINISHED=4;
this.FAILED=5;
this.FAILED_SCRIPT=6;
};
var DOMUtils=new function(){
this.addCSSClass=function(els,_3001){
for(var i=0;i<els.length;i++){
var _3003=els[i].className;
if(_3003==null){
_3003=_3001;
}else{
var index=_3003.indexOf(_3001);
if(index==-1){
_3003=_3003.trim();
_3003+=" "+_3001;
}
}
els[i].className=_3003;
}
};
this.removeCSSClass=function(_3005,_3006){
for(var i=0;i<_3005.length;i++){
var _3008=_3005[i].className;
if(_3008==null){
continue;
}
var index=_3008.indexOf(_3006);
if(index>-1){
if(_3008==_3006){
_3008=null;
}else{
_3008=_3008.substring(0,index)+_3008.substring(index+_3006.length+1);
}
}
_3005[i].className=_3008;
}
};
this.filterElements=function(_300a,_300b,_300c,_300d){
var _300e=new Array();
var j=0;
for(var i=0;i<_300a.length;i++){
if((_300b==null)||(_300a[i].nodeName==_300b)){
if((_300c==null)||(_300a[i].getAttribute(_300c)==_300d)||((_300d=="*")&&(_300a[i].getAttribute(_300c)!=null))){
_300e[j++]=_300a[i];
}
}
}
return _300e;
};
this.getFirstMatchingElement=function(_3011,_3012,_3013,_3014){
for(var i=0;i<_3011.length;i++){
if((_3012==null)||(_3011[i].nodeName==_3012)){
if((_3013==null)||(_3011[i].getAttribute(_3013)==_3014)||((_3014=="*")&&(_3011[i].getAttribute(_3013)!=null))){
return _3011[i];
}
}
}
return null;
};
this.getChildElsWithAttr=function(_3016,_3017,_3018){
var _3019=_3016.getElementsByTagName("*");
return this.filterElements(_3019,null,_3017,_3018);
};
this.getParentWithAttr=function(_301a,_301b){
var _301c=_301a.parentNode;
while((_301c!=null)&&(_301c["getAttribute"]!=null)){
if(_301c.getAttribute(_301b)!=null){
return _301c;
}
_301c=_301c.parentNode;
}
return null;
};
this.getParentWithAttrValue=function(_301d,_301e,_301f){
var _3020=_301d.parentNode;
while(_3020!=null){
if(_3020.getAttribute(_301e)==_301f){
break;
}
_3020=_3020.parentNode;
}
return _3020;
};
this.getForm=function(_3021){
var frm=document.forms[_3021];
if(frm!=null){
return frm;
}
for(var i=0;i<document.forms.length;i++){
if(document.forms[i].name==_3021){
return document.forms[i];
}
}
return null;
};
this.setAttribute=function(_3024,_3025,_3026){
for(var i=0;i<_3024.length;i++){
_3024[i].setAttribute(_3025,_3026);
}
};
this.setProperty=function(_3028,_3029,_302a){
for(var i=0;i<_3028.length;i++){
_3028[i][_3029]=_302a;
}
};
this.fillData=function(_302c,data){
for(var count=0;count<_302c.length;count++){
this.setValueOnEl(_302c[count],data[_302c[count].name]);
}
};
this.setValueOnEl=function(curEl,value){
var type=curEl.type;
var _3032=curEl.nodeName;
if(value==null){
return;
}
if((type=="radio")||(type=="checkbox")){
curEl.checked=(value==curEl.value);
}else{
if(type=="select-one"){
for(var i=0;i<curEl.options.length;i++){
if((curEl.options[i].value&&curEl.options[i].value==value)||(curEl.options[i].innerHTML==value)){
curEl.options[i].selected=true;
}
}
}else{
if((_3032=="DIV")||(_3032=="SPAN")){
curEl.innerHTML=value;
}else{
curEl.value=value;
}
}
}
};
};
LangUtils=new function(){
};
LangUtils.cloneArray=function(_3034){
var _3035=new Array();
for(var i=0;i<_3034.length;i++){
_3035[i]=_3034[i];
}
return _3035;
};
var ParamsParser=function(){
};
function parseRequestParams(_3037){
var _3038=_3037.indexOf("&");
var _3039=_3037.indexOf("?");
if(_3039>=0&&_3039<_3038){
_3037=_3037.substring(_3039+1,_3037.length);
}
var _303a=_3037.split("&");
var _303b=new Object();
for(var count=0;count<_303a.length;count++){
var _303d=_303a[count];
var _303e=_303d.substring(0,_303d.indexOf("="));
var _303f=_303d.substring(_303d.indexOf("=")+1,_303d.length);
if(_303b[_303e]==null){
_303b[_303e]=new Array();
}
var val=_303b[_303e];
val[val.length]=_303f;
}
return _303b;
}
function parseTemplateParams(_3041){
var _3042=parseRequestParams(_3041);
var _3043=new Array();
for(var _3044 in _3042){
var _3045=new Array();
var _3046=_3042[_3044][_3042[_3044].length-1];
_3045[0]=_3044;
if(_3046.indexOf("$R{")>=0){
_3045[1]=_3046.substring(_3046.indexOf("$R{")+3,_3046.length-1);
_3045[2]=1;
}else{
if(_3046.indexOf("$S{")>=0){
_3045[1]=_3046.substring(_3046.indexOf("$S{")+3,_3046.length-1);
_3045[2]=2;
}else{
if(_3046.indexOf("$D{")>=0){
_3045[1]=_3046.substring(_3046.indexOf("$D{")+3,_3046.length-1);
_3045[2]=3;
}else{
_3045[1]=_3042[_3044];
_3045[2]=0;
}
}
}
_3043[_3043.length]=_3045;
}
return _3043;
}
function getURLSuffixed(url){
if(url==null){
return null;
}
if(url.lastIndexOf("?")==-1){
url+="?";
}else{
if(url.indexOf("?")>0&&url.charAt(url.length-1)!="&"){
url+="&";
}
}
return url;
}
function appendParamToUrl(url,_3049,_304a){
if(_304a==null){
return url;
}
return getURLSuffixed(url)+_3049+"="+encodeURIComponent(_304a);
}
function appendParamsToUrl(url,_304c){
if(_304c==null){
return url;
}
return getURLSuffixed(url)+_304c;
}
function hasDataModelTplReference(_304d){
if(_304d==null){
return false;
}
var _304e=parseTemplateParams(_304d);
for(var i=0;i<_304e.length;i++){
var _3050=_304e[i];
if(_3050[2]==3){
return true;
}
}
return false;
}
function splitURL(url){
var _3052=url.indexOf("?");
if(_3052==-1){
return {resource:url,query:""};
}
return {resource:url.substring(0,_3052),query:url.substring(_3052+1)};
}
function getAsQueryString(_3053){
var _3054="";
for(var i in _3053){
_3054+=i+"="+encodeURIComponent(_3053[i])+"&";
}
return _3054;
}
ParamsParser.getAsQueryParam=function(_3056,_3057){
return encodeURIComponent(_3056)+"="+encodeURIComponent(_3057);
};
var PREV_DOCUMENT_ID="";
function resetglobalvariables(){
FILE_FORMAT=null;
DOCUMENT_VIEW="NEW_VIEW";
COLOR_DIV_ID="bg_fill_div";
if(!jsVERSION_VIEW){
wmsCommErrorStatus=DOCUMENT_NAME=DOC_NAME=TAGLIST=currDocPanelId=currFocusFld=funcFocusFld=publicURL=SHEETNAMES=LOCKED_USER=deleteOptions=insertOptions=fileToolbar=formatOptions=stdToolbar=saveAsDialog=saveAsTemplateDialog=importDialog=publishOptionsDialog=moreActionsDialog=exportOptions=DOCUMENT_NAME_URL="";
}
isErrorDoc=picContextMenuStatus=displayAll=DEFAULT_FILENAME_FLAG=isDocumentSemiPublic=doAutoSave=isEdit=isFuncDlgOpen=isStockConfigured=isDocumentPublic=IS_UNSAVED_SHEET=ALL_SHEET_SHARED=INSERT_SHEET_ALLOWED=ALLOW_TO_WRITE=READ_WRITE=DOCUMENT_LOCKED=jsREMOTE_SAVE_VIEW=jsVERSION_VIEW=jsTHROWAWAY_VIEW=jsREMOTE_VIEW=jsPUBLIC_VIEW=jsGUEST_VIEW=jsNEW_DOC_VIEW=jsOPEN_DOC_VIEW=jsSHARE_VIEW=jsTRASH_VIEW=INSERTIMAGE=fromGoTo=savingInProgress=isSheetLoading=PUBLIC_EDIT_MODE=jsEMBED_VIEW=hasOleMoved=allowOrgEdit=false;
panelOpenedFor=defineNameHTML=currentNamesListSPAN=ASSIGNEDTO=FOCUSSEDNAMEINPUTOBJECT="";
wmsErrorMsgShown=isNameDialogOpened=false;
NAMEDRANGES=new Array();
allowExportOrg=showFormulasOrg=allowExport=showFormulas=SAVED=DOC_SHARE_STATE=DOC_BASED_SHARE=savedFlag=OOLOADED=CANREADWRITE=true;
SHEETSWITCH=ENTEREDPERFCHECK=false;
SAVECHART="false";
resetChartVars();
resetCopyPasteVars();
noOfUpdateRequestInProgress=0;
loadoff();
Sheet();
_Sheet_initialize();
versionDetailsNo=0;
resetUNDO();
IMAGEOBJECT=XPOSITION=YPOSITION=lastSavedTime=null;
getObj("waitmsg").style.display="none";
CLONEIMAGE=false;
isEngineSupported=false;
WIDTHHEIGHTUNDO=false;
resetFreezePaneVariables();
isRespondedInScroll=true;
var _3058=new Array();
var _3059=true;
usercell={};
usercolorcode=new Array();
availableStartRow=0;
availableEndRow=-1;
lastSavedTime=null;
errorMsgShown=false;
errorInLoadObject=false;
isDocumentRendered=true;
isAnyOnline=false;
insertCopyCols=false;
insertCopyRows=false;
insertCutCols=false;
insertCutRows=false;
ruleElem=null;
colorElem=null;
isReadOnlyViewMode=false;
fPainter.fPaintersingleclick=false;
fPainter.fPainterdoubleclick=false;
updatedSaveTime="";
isCollabJoined=false;
setTimeout("setWmsBarData()",500);
}
function resetRTCvariables(_305a){
if(!ENABLERTC){
return;
}
var _305b=getObj("sharedUserStatus");
if(_305b!=null){
if(!_305a){
_305b.className="hidden";
}else{
_305b.innerHTML=0+" "+jsTitleMsg.Viewing;
_305b.title=jsTitleMsg.SharedUserStatus;
}
}
getObj("chatLogs").innerHTML="";
COLLABORATIVE_EDITING="OFF";
if(!_305a){
COLLAB_ID="";
}
RTCSHEETNAME=C_STARTROW=C_ENDROW=C_STARTCOL=C_ENDCOL=SHAREDUSERS=LISTOFCOLLABIDS="";
SAVEDOC=RTC_EXISTS="false";
ISSAMESHEET="true";
SHAREDUSERSLIST=new Array();
isCollabJoined=false;
}
Sheet.MODULES={"readhtml":getLayoutResponse,"cache":sheetSaved};
function Sheet(){
this.getLayoutResponse=_Sheet_getLayoutResponse;
this.initialize=_Sheet_initialize;
this.sheetSaved=_Sheet_sheetSaved;
}
function _Sheet_initialize(){
this.httpcomm=new HttpCommunication();
this.httpcomm.setTargetObj(this);
this.httpcomm.setModules(Sheet.MODULES);
}
function _Sheet_getLayoutResponse(_305c,_305d){
switch(_305c){
case "object":
var docid=_305d.DOCUMENT;
var _305f=_305d.SHEET;
if(docid==DOCUMENT_ID&&_305f==CURRSHEETNAME){
removePivotContent();
sheetHTML=_305d.HTML_CONTENT;
getObj("sheetdiv").innerHTML=sheetHTML;
sheetDefault();
}
break;
case "error":
showAlertDialog(jsTitleMsg.ProblemWhileOpeningTheSheet);
break;
}
}
function _Sheet_sheetSaved(_3060,_3061){
switch(_3060){
case "object":
break;
case "error":
break;
}
}
function resetChartVars(){
HTMLCHARTINFO=new Array();
for(var i in ExcelGraph._INSTANCES){
var graph=getObj(i);
ExcelGraph.removeInstance(i);
if(graph!=null){
graph=null;
}
}
var _3064=getObj("chartLoadingDIV");
if(typeof _3064!="undefined"&&_3064!=null){
_3064.innerHTML="";
}
availChartRange={};
}
var isDocumentLoading=false;
function loadDocument(param,_3066,_3067,_3068,_3069){
errorMsgShown=false;
errorInLoadObject=false;
try{
if(ZDBClientUI.selectedTab){
ZDBClientUI.unselectTab();
}
}
catch(e){
}
documentOpened="false";
isDocumentLoading=true;
if(ISMINDLG){
ISMACRODOCCHANGE=true;
}
closeDialog();
DOCUMENT_VERSION=_3067;
NEWDOCNAME=_3066;
if(ACCOUNT_ID==0){
document.location.href=ctxpath+"logout.do";
}
if(!_3067){
parseError=false;
}
if((!SAVED||!MACROSAVED||RECORDINGMACRO)&&ALLOW_TO_WRITE){
checksaved(param);
documentLoadInit();
}else{
documentLoadInit();
if(param=="new.do"||param=="ajaxnew.do"||IMPORTTIME!="IMPORTTIME"){
if(IMPORTTIME!="IMPORTTIME"){
message(jsMsg.Loading,"block","...");
}else{
message(jsMsg.Loading,"block","...");
}
if(IMPORTTIME!="IMPORTTIME"){
_3069="IMPORT";
openDoc1(param,_3066,false,IMPORTTIME,"","",_3069);
}else{
openDoc1(param,_3066);
}
}else{
if(_3067){
message(jsMsg.Loading,"block","...");
openDoc1(param,_3066,_3067);
}else{
if(param!="close"){
initServerCompLoadingActivities();
message(jsMsg.Loading,"block","...");
if(ENABLERTC){
var _306a=new getXmlhttp();
_306a.onreadystatechange=function(){
if(_306a.readyState==4){
if(_306a.responseText=="WMSConnectionExcetion"){
message(jsMsg.Loading,"none");
showAlertDialog(jsTitleMsg.ProblemWhileOpeningTheSheet+". "+jsTitleMsg["Error.Alert.Suffix.WhileOpeningtheDocument"]);
return;
}
var resp=eval(_306a.responseText);
var ret=resp[0];
COLLAB_ID=ret.COLLABID;
SHAREDUSERS=ret.SHAREDUSERS;
var _306d=ret.ISANYONLINE;
var _306e=ret.CURRENTTIME;
var _306f=ret.DOCOWNER;
var _3070=ret.DOCOWNERID;
wmsCommErrorStatus=ret.WMSCommunicationException;
if(COLLAB_ID==""||_306d=="FALSE"){
openDoc1(param,_3066,false,_306e,_306f,_3070);
}else{
COLLABORATIVE_EDITING="ON";
if(_306d.trim().toUpperCase()=="TRUE"){
COLLAB_DOCUMENT_ID=param;
}
setTimeout(function(){
collabopen(param,_3066,false,_306e,_306f,_3070);
},5000);
}
}
};
if(getObj(param)!=null){
getObj(param).blur();
}
if(_3069=="clickHeretoOpen"){
openDoc1(param,_3066,"","","","",_3069);
}else{
openDoc1(param,_3066);
}
}else{
openDoc1(param,_3066);
}
}
}
}
}
return false;
}
function collabopen(docid,_3072,view,_3074,_3075,_3076){
if(isEditorClosed){
}
if(documentOpened=="false"&&docid==COLLAB_DOCUMENT_ID){
openDoc1(docid,_3072,view,_3074,_3075,_3076);
}
}
function openDoc1(param,_3078,_3079,_307a,_307b,_307c,_307d){
var url=document.location.href;
if(url.lastIndexOf("?")>0){
var _307f=url.substring(url.lastIndexOf("/")+1,url.lastIndexOf("?"));
var _3080=url.substring(url.lastIndexOf("=")+1);
if(url.lastIndexOf("&")>0){
var _3081=url.substring(url.lastIndexOf("=")+1);
}
}else{
_307f=url.substring(url.lastIndexOf("/")+1);
}
if(isEditorClosed){
}
if(!SAVED){
submitCell();
}
DOC_PANEL.closeDocPanel();
documentOpened="true";
NEWDOCNAME=_3078;
var url="";
var _3082="";
if(param=="new.do"||param=="ajaxnew.do"){
var _3083=(TEMPLATE_FLAG=="true")?"doctype=template":"";
if(_307f=="open.do"||_307f=="home.do"){
url=ctxpath+_307f;
if(_3083){
url+="?"+_3083;
}
document.location.href=url;
}
}else{
if(param=="open.do"){
document.location.href=ctxpath+"open.do";
}else{
if(_307d=="clickHeretoOpen"||_307d=="IMPORT"){
document.location.href=ctxpath+"open.do?docid="+param;
}else{
if(_3079){
url=ctxpath+"version.do";
_3082+="&doc_id="+param+"&docname="+_3078+"&curtime="+CURRENTTIME+"&mode=view"+"&version="+_3079+"&docowner="+CURR_DOC_OWNERNAME;
bridgeNumber="null";
DOCUMENT_VERSION=_3079;
_3082=appendCSRFToURL(_3082);
AjaxAPI.sendRequest({URL:(url),METHOD:"POST",PARAMETERS:_3082,ONSUCCESSFUNC:this.openDocument});
}else{
toolbarinited=false;
document.location.href=ctxpath+"open.do?docid="+param;
}
}
}
}
isDocumentRendered=false;
}
function loadDocumentObject(param,_3085,_3086,_3087,_3088,_3089,_308a,_308b){
var _308c=new getXmlhttp();
_308c.onreadystatechange=function(){
if(_308c.readyState==4){
if(_308c.status>=300){
errorAlert(_308c.status,_308c.statusText);
return;
}else{
updateLoadObjectResponse(_308c.responseText,_3089,_308b);
}
}
};
DOCUMENT_REQUESTED_TIME=Math.random();
if(!isNaN(param)){
initServerCompLoadingActivities();
var nvp="docid="+param+"&docname="+encodeURIComponent(_3085)+"&docRequestedTime="+DOCUMENT_REQUESTED_TIME+"&curtime="+CURRENTTIME+"&newCurrentTime="+_3086;
if(_3087){
nvp+="&docOwner="+_3087;
}
if(_3088){
nvp+="&docOwnerId="+_3088;
}
if(_308a){
nvp+="&prevDocId="+_308a;
}
if(jsGUEST_VIEW){
nvp+="&viewType=GUEST_VIEW";
}
if(jsPUBLIC_VIEW){
nvp+="&viewType=PUBLIC_VIEW";
}
nvp=appendCSRFToURL(nvp+"&");
postAjax(_308c,ctxpath+"loadObject.do",nvp);
}
}
var errorInLoadObject=false;
var errorMsgShown=false;
var workbooksheets=null;
function updateLoadObjectResponse(_308e,_308f,_3090){
var res=eval("("+_308e+")");
var _3092=res.docRequestedTime;
var docId=res.DOCUMENT_ID;
if(res.workbook){
workbooksheets=res.workbook;
}
if(errorMsgShown){
return;
}
if(res.ERROR==showErrorPanelMsg){
message("","none");
errorMsgShown=true;
var _3094=getObj("waitmsg");
_3094.style.display="none";
isDocumentLoading=false;
if(!jsPUBLIC_VIEW&&!jsGUEST_VIEW){
errorInLoadObject=true;
if(res.MESSAGE.indexOf("Document.Parse.Error")!=-1){
parseError=true;
var _3095=res.VIEW;
DOCUMENT_ID=docId;
CURR_DOC_OWNERNAME=res.DOC_AUTHOR_NAME;
var _3096=res.LAST_MODIFIED_TIME;
if(!isNaN(_3096)){
_3096=parseInt(_3096);
}else{
_3096=null;
}
var _3097=res.HASVERSION;
DOCUMENT_NAME=res.DOCUMENT_NAME;
if($("#fileName")!=null){
$("#fileName").text(DOCUMENT_NAME);
}
var _3098="<a href='mailto:"+jsMsg["SupportMailId"]+"'>"+jsMsg["SupportMailId"]+"</a>";
if(cdview&&_3097&&ALLOW_TO_WRITE){
var _3099=returnTimeElaspsedinString(res.CURRENTTIME,_3096);
var _309a=getI18NLastSavedMsg(_3099.unit,_3099.count);
errMsg=replaceParams(jsMsg["Document.Parse.Error.LastSavedTime"],new Array("<a href='#' onclick='revertVersion(0)'>","</a>",_309a));
}else{
if(_3095=="SHARE_VIEW"){
errMsg=replaceParams(jsMsg["ShareView.Document.Parse.Error"],new Array("<a href='#' onclick='notifySharedUsers(false)'>","</a>",_3098));
jsSHARE_VIEW=true;
}else{
if(_3095=="OPEN_VIEW"){
ALL_SHEET_SHARED=true;
if(_3097){
var _3099=returnTimeElaspsedinString(res.CURRENTTIME,_3096);
var _309b="";
if(_3099.unit.indexOf("second")!=-1){
_309b=jsMsg["Document.Parse.Error.LastSavedTimeinSeconds"];
}else{
if(_3099.unit=="minutes"){
_309b=jsMsg["Document.Parse.Error.LastSavedTimeinMinutes"];
}else{
if(_3099.unit=="hours"){
_309b=jsMsg["Document.Parse.Error.LastSavedTimeinHours"];
}else{
if(_3099.unit=="days"){
_309b=jsMsg["Document.Parse.Error.LastSavedTimeinDays"];
}
}
}
}
errMsg=replaceParams(_309b,new Array("<a href='#' onclick='revertVersion(0)'>","</a>",_3099.count,"<a href='#' onclick='showVersionDetails()'>","</a>",_3098));
}else{
errMsg=replaceParams(jsMsg["Document.Parse.Error.WithoutVersion"],new Array(_3098));
}
}
}
}
handleServerError("ERROR",errMsg,true);
return;
}
}else{
handleServerError("ERROR",showErrorPanelMsg,true);
}
return;
}
if(DOCUMENT_REQUESTED_TIME==_3092){
if(res&&res.CURRENTTIME){
CURRENTTIME=res.CURRENTTIME;
}
if(COLLAB_ID&&COLLAB_ID!=""){
if(typeof _3090=="undefined"||!_3090){
WmsServerCheck.online=true;
}
if(isAnyOnline){
COLLABORATIVE_EDITING="ON";
}
}
docMetaDetails={};
serverCompLoadedActivities();
if(typeof res.BRIDGENO=="undefined"||res.BRIDGENO=="undefined"){
bridgeNumber="null";
}else{
bridgeNumber=res.BRIDGENO;
var obj=getObj("bridgeNo");
if(obj){
obj.value=bridgeNumber;
}
}
tempPublicDocId=res.tempPublicDocId;
if(isUndefined(tempPublicDocId)){
tempPublicDocId="";
isInOOMode=false;
}else{
isInOOMode=true;
}
if(docId==DOCUMENT_ID&&isDocumentRendered&&!_308f){
getNamedRanges();
}
if(jsPUBLIC_VIEW){
editPublicDoc(true,true);
stopLoadSheetObject(res.CURRENTTIME);
}
}else{
stopLoadSheetObject(res.CURRENTTIME);
}
}
function openDocument(_309d,_309e){
if(errorInLoadObject){
errorInLoadObject=false;
message("","none");
return;
}
message(jsMsg.Loading,"none");
var _309f=_309d.responseText;
if(_309f=="INVALID_VERSION"){
showAlertDialog(jsMsg["Version.ViewVersionConflict"]);
return;
}
var _30a0=_309f.substring(_309f.indexOf("<script>dataResponse=")+21,_309f.length-1);
dataResponse=_30a0.substring(0,_30a0.indexOf("</script>"));
var _30a1=_309f.indexOf("<script>")+8;
var _30a2=_309f.indexOf("</script>");
var _30a3=_309f.substring(_30a1,_30a2);
if(_30a3!="null"){
if(_30a3!=VIEW_REQUESTED_TIME){
return;
}
}
if(isEditorClosed){
}
if(window.ZDBWHOLEDIV){
window.ZDBWHOLEDIV=null;
}
BACKUPCOLLABID=COLLAB_ID;
IMPORTACC="0";
getObj("widgetDIV").innerHTML=_309d.getOnlyHtml();
isEditorClosed=false;
resetglobalvariables();
(typeof ole!=="undefined")&&ole.reset();
Filter.clear();
populateValues();
scrollSheetTabToView(CURRSHEETNAME);
updateDocTitle(DOCUMENT_NAME);
if(pivotSheet==true){
setSheetDivDefaultHeight();
showsheet(getObj("sheetdiv-"+CURRSHEETNAME),"open","pivotload");
}
isDocumentLoading=false;
if(DOCUMENT_LOCKED&&!ENABLERTC){
if(LOCKED_USER.indexOf(".")!=-1){
LOCKED_USER=LOCKED_USER.substring(0,LOCKED_USER.indexOf("."));
}
showAlertDialog(LOCKED_USER+" is currently editing this document. You cannot modify and save changes until the user finishes editing.");
}
if(isDocumentPublic){
constructpublicurl();
}
var _30a4=_309f.indexOf("<script>filterM");
if(_30a4!==-1){
var _30a5=_309f.substring(_30a4+23,_309f.indexOf("</script>",_30a4+23));
if(_30a5.trim()!=="null"){
filterMetaInfo=JSON.parse(_30a5);
if(filterMetaInfo.isCriteriaApplied){
Filter.create(CURRSHEETNAME,filterMetaInfo);
}else{
filterMetaInfo=undefined;
}
}
}
btn_disabled();
assignInitialValues();
initUIComponents();
initSheet(ssServer,initSSWidth,initSSHeight,initCols,initRows,initColHeadHeight,initRowHeadWidth,initColWidth,initRowHeight,tablewidth,tableheight);
serverCompLoadedActivities(true);
initBottomBand();
getCommentCalloutPropertyValues();
if(COLLAB_ID!=""){
updateSharedUserStatus();
}
if(pivotSheet!=true){
message("","none");
}
if(jsVERSION_VIEW||isDocumentReadyToEdit){
getNamedRanges();
}
if((BACKGROUNDCOLOR!="#FFFFFF")&&(BACKGROUNDCOLOR!="")){
getObj("bg_fill_div").style["backgroundColor"]=BACKGROUNDCOLOR;
}
if((FONTCOLOR!=="")){
getObj("text_color_div").style["backgroundColor"]=FONTCOLOR;
}
if(isExprFieldExpanded){
expandExprField();
}
if(SET_LASTEDITED_DOCID&&DOCUMENT_ID!="doc_id"){
var dmn=document.domain;
dmn=dmn.substring(dmn.indexOf(".")+1,dmn.length);
set_cookie("ZS_DID",DOCUMENT_ID,null,null,dmn);
}
if(TEMPLATE_FLAG=="true"){
if(CREATE_TEMPLATE_FROM_MENU=="true"){
var _30a7=getObj("isDocTemplate");
_30a7.value="true";
CREATE_TEMPLATE_FROM_MENU="false";
}
var save=getObj("save");
save.onclick=new Function("savefile('template');return false;");
}else{
var save=getObj("save");
save.onclick=new Function("savefile();return false;");
}
if(CREATE_TEMPLATE_FROM_UI=="true"){
$("#fileName").text(filenameFieldId);
var _30a7=getObj("isDocTemplate");
_30a7.value="true";
var save=getObj("save");
save.onclick=new Function("savefile('template');return false;");
CREATE_TEMPLATE_FROM_UI="false";
}
}
function loadOthersforDoc(){
if(isEditorClosed){
}
if(!jsVERSION_VIEW){
if(isSSActive){
getSheetImages();
}else{
getObj("waitmsg").style.display="none";
disableToolBar(READ_WRITE);
}
}else{
getSheetImages(DOCUMENT_VERSION);
}
}
function populateValues(){
var _30a9=getObj("widgethiddenDIV");
var _30aa=_30a9.childNodes;
var _30ab=new Array(_30aa.length);
var _30ac=0;
for(var i=0;i<_30aa.length;i++){
var _30ae=_30aa[i];
if(_30ae.tagName=="INPUT"){
_30ab[_30ac]=_30ae.value;
_30ac++;
}
}
var a1=_30ab[0];
var a2=_30ab[1];
var a3=_30ab[2];
var a4=_30ab[3];
var a5=_30ab[4];
var a6=_30ab[5];
var a7=_30ab[6];
var a8=_30ab[7];
var a12=_30ab[8];
var a9=_30ab[9];
var a14=_30ab[10];
var a10=_30ab[11];
var a11=_30ab[12];
var _30bc=_30ab[13];
var a13=_30ab[14];
var a16=_30ab[15];
var a22=_30ab[16];
var a23=_30ab[17];
var a24=_30ab[18];
var a15=_30ab[19];
var a25=_30ab[20];
var a26=_30ab[21];
var a27=_30ab[22];
var a28=_30ab[23];
var a29=_30ab[24];
var a30=_30ab[25];
var a31=_30ab[26];
var a32=_30ab[27];
var a33=_30ab[28];
var a34=_30ab[29];
var a35=_30ab[30];
var a36=_30ab[31];
var a37=_30ab[33];
var a38=_30ab[34];
var a39=_30ab[35];
var a40=_30ab[36];
var a41=_30ab[37];
var a42=_30ab[38];
var a43=_30ab[39];
var a44=_30ab[40];
var a45=_30ab[41];
var a46=_30ab[42];
var a47=_30ab[43];
var a48=_30ab[44];
var a49=_30ab[45];
var a50=_30ab[46];
var a51=_30ab[47];
var a52=_30ab[48];
var a53=_30ab[50];
var a54=_30ab[51];
var a55=_30ab[52];
var a56=_30ab[53];
var a57=_30ab[54];
var a58=_30ab[55];
var a59=_30ab[56];
var a60=_30ab[57];
var a61=_30ab[58];
var _30e8=new Array();
var _30e9=getObj("sheethiddenDIV2");
if(_30e9!=null){
var _30aa=_30e9.childNodes;
var _30ea=new Array(5);
_30ac=0;
for(var i=0;i<_30aa.length;i++){
var _30ae=_30aa[i];
if(_30ae.tagName=="INPUT"){
_30ea[_30ac]=_30ae.value;
_30ac++;
}
if(_30ac==5){
break;
}
}
var a17=_30ea[1];
var a18=_30ea[2];
var a19=_30ea[3];
var a20=_30ea[4];
var a21=_30ea[0];
}
var _30f0=DOCUMENT_ID;
if(_30bc!="undefined"&&_30bc!="null"){
var _30f1=getServerPath();
_30f1="";
publicURL=_30f1+_30bc;
}
var value="";
if(a1!=null){
DOCUMENT_VIEW=a1;
identifyView();
}
if(a2!=null){
DOCUMENT_LOCKED=false;
if(a2=="true"){
DOCUMENT_LOCKED=true;
}
}
if(a3!=null){
LOCKED_USER=a3;
}
if(a4!=null){
DOCUMENT_ID=a4;
}
if(a5!=null){
DOCUMENT_NAME=DOC_NAME=replaceSplChrs(a5);
}
if(a6!=null){
CURRSHEETNAME=a6;
}
if(a7!=null){
TOTALSHEETS=a7;
}
if(a12!=null){
window["ALLOW_TO_WRITE"]=false;
if(a12=="true"){
window["ALLOW_TO_WRITE"]=true;
}
}
if(a52!=null){
isSheetBasedShare=false;
if(a52=="true"){
isSheetBasedShare=true;
}
}
if(a53=="true"&&ALLOW_TO_WRITE){
wmsCommErrorStatus="true";
}else{
wmsCommErrorStatus="false";
}
if(a54=="true"){
jsEMBED_VIEW=true;
}
if(a55=="true"){
isDocContainsArrayFormula=true;
}
if(a8!=null){
READ_WRITE=false;
if(wmsCommErrorStatus=="true"||(jsTRASH_VIEW)||(jsSHARE_VIEW&&isSheetBasedShare&&!ALLOW_TO_WRITE)||(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE)){
READ_WRITE=false;
}else{
if(a8=="true"){
READ_WRITE=true;
}
}
}
if(!isDocumentReadyToEdit&&DOCUMENT_ID!="doc_id"){
TEMP_READ_WRITE=READ_WRITE;
READ_WRITE=false;
}
if(a9!=null){
isDocumentPublic=false;
if(a9=="true"){
isDocumentPublic=true;
}
}
if(a10!=null){
if(DOCUMENT_ID==="doc_id"||jsVERSION_VIEW){
CURRENTTIME=a10;
}else{
if(a57==="true"){
CURRENTTIME=a10;
}else{
if((a57==="false"||a57==="null")&&!isDocumentReadyToEdit){
CURRENTTIME=a10;
}
}
}
}
if(a11!=null){
HTMLVIEW=false;
if(a11=="true"){
HTMLVIEW=true;
}
}
if(a13!=null){
}
if(a14!=null){
ALL_SHEET_SHARED=false;
if(a14=="true"){
ALL_SHEET_SHARED=true;
}
}
if(a15!=null){
window["IS_REVERT_ALLOWED"]=false;
if(a15=="true"){
window["IS_REVERT_ALLOWED"]=true;
}
}
if(a16!=null){
CURR_DOC_OWNERNAME=a16;
}
if(a17!=null){
initSSWidth=a17;
}
if(a18!=null){
initSSHeight=a18;
}
if(a19!=null){
initColHeadHeight=a19;
}
if(a20!=null){
initRowHeadWidth=a20;
}
if(a21!=null){
ssServer=a21;
}
if(jsSHARE_VIEW){
isVersionPending=true;
}
if(a22!=null){
isDocumentSemiPublic=false;
if(a22=="true"){
isDocumentSemiPublic=true;
}
}
if(a23!=null){
isEdit=false;
if(a23=="true"){
isEdit=true;
}
}
if(a24!=null){
isStockConfigured=a24;
}
if(a25!=null){
if(a25=="true"){
DO_INDEX_SEARCH=true;
}else{
DO_INDEX_SEARCH=false;
}
}
if(browser_ie&&DOCUMENT_NAME.indexOf("'")>-1&&$("#fileName")){
$("#fileName").text(DOCUMENT_NAME);
}
if(a26!=null){
DOCUMENT_NAME_URL=a26;
}
if(a27!=null){
CURR_THEME=a27;
}
if(a28!=null){
DEFAULT_THEME=a28;
}
if(a29!=null){
USE_COMPRESSION=(a29=="true"?true:false);
}
if(a30!=null){
STYLE_PATH=a30;
}
if(a31!=null){
BUILD_VERSION=a31;
}
if(a32!=null){
OOLOADED=(a32=="true"?true:false);
}
if(a33!=null){
CANREADWRITE=(a33=="true"?true:false);
}
if(a34!=null){
if(a34=="true"){
pivotSheet=true;
isSSActive=false;
jQuery.noConflict();
}else{
pivotSheet=false;
isSSActive=true;
$=jQuery;
}
}
if(a35!=null){
allowExport=false;
if(a35=="true"){
allowExport=true;
}
}
if(a36!=null){
showFormulas=false;
if(a36=="true"){
showFormulas=true;
}
}
if(a37!=null){
INSERT_SHEET_ALLOWED=false;
if(a37=="true"){
INSERT_SHEET_ALLOWED=true;
}
}
if(a38!=null&&a38=="false"){
showPublic=false;
}else{
showPublic=true;
}
if(a39!=null&&a39=="false"){
showFormulasOrg=false;
}else{
showFormulasOrg=true;
}
if(a40!=null&&a40=="false"){
allowExportOrg=false;
}else{
allowExportOrg=true;
}
if(a41!=null&&a41=="false"){
allowExportPublic=false;
}else{
allowExportPublic=true;
}
if(a42!=null&&a42=="true"){
displayAll=true;
}else{
displayAll=false;
}
if(a43!=null){
if(a43=="true"){
isTemplatePublic=true;
}
}
if(a45!=null){
isEngineSupported=false;
if(a45=="true"){
isEngineSupported=true;
}
}
if(a50!=null){
var _30f3=a50;
if(_30f3=="COL"){
isColsOnlyFreezed=true;
}else{
if(_30f3=="ROW"){
isRowsOnlyFreezed=true;
}else{
if(_30f3=="ALL"){
isColsAndRowsFreezed=true;
}
}
}
}
if(a51!=null){
FILE_FORMAT=a51;
}
if(a56!=null&&a56=="true"){
allowOrgEdit=true;
}else{
allowOrgEdit=false;
}
cursor_Row_Index=(a58==(null||"null"))?0:parseInt(a58);
cursor_Col_Index=(a59==(null||"null"))?0:parseInt(a59);
position_Bottom=(a60==(null||"null"))?0:parseInt(a60);
position_Left=(a61==(null||"null"))?0:parseInt(a61);
}
function identifyView(){
if(DOCUMENT_VIEW=="NEW_VIEW"){
jsNEW_DOC_VIEW=true;
DEFAULT_FILENAME_FLAG=true;
}
if(DOCUMENT_VIEW=="OPEN_VIEW"){
jsOPEN_DOC_VIEW=true;
}
if(DOCUMENT_VIEW=="SHARE_VIEW"){
jsSHARE_VIEW=true;
}
if(DOCUMENT_VIEW=="TRASH_VIEW"){
jsTRASH_VIEW=true;
}
if(DOCUMENT_VIEW=="GUEST_VIEW"){
jsGUEST_VIEW=true;
}
if(DOCUMENT_VIEW=="PUBLIC_VIEW"){
jsPUBLIC_VIEW=true;
}
if(DOCUMENT_VIEW=="THROWAWAY_VIEW"){
jsTHROWAWAY_VIEW=true;
}
if(DOCUMENT_VIEW=="REMOTE_VIEW"){
jsREMOTE_VIEW=true;
}
if(DOCUMENT_VIEW=="VERSION_VIEW"){
jsVERSION_VIEW=true;
}
if(DOCUMENT_VIEW=="REMOTE_SAVE_VIEW"){
jsREMOTE_SAVE_VIEW=true;
}
}
function constructpublicurl(){
var _30f4=getServerPath();
_30f4="";
var _30f5=getObj("PUBLICURL");
if(_30f5!="undefined"&&_30f5.value!="null"){
publicURL=_30f4+_30f5.value;
}
}
var tempsheetname="";
var tempdocid="";
var isSheetLoading=false;
function showsheet(obj,_30f7,_30f8,_30f9){
if(isEditorClosed){
}
if(typeof obj=="string"){
obj=getObj(obj);
}
if(!isDocumentReadyToEdit){
initServerCompLoadingActivities(true);
}
if(isEditingInExprField||exprFieldKeyPressed||isCellEdited()){
if(isPartOfArray(currRow,currCol,currRow,currCol)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
if(cellField!=null&&cellField.value.indexOf("=")==0||isFuncDlgOpen){
if(isFuncDlgOpen){
editedFormulaCellInfo.cellFieldDetails.CF_VALUE=exprField.value;
}else{
editedFormulaCellInfo.cellFieldDetails.CF_VALUE=cellField.value;
}
editedFormulaCellInfo.cellFieldDetails.CF_TOP=cellField.style.top;
editedFormulaCellInfo.cellFieldDetails.PREV_SHEET=CURRSHEETNAME;
var _30fa=obj.getAttribute("sheetname");
if(!editedFormulaCellInfo.isOtherSheet){
editedFormulaCellInfo.isOtherSheet=true;
editedFormulaCellInfo.isSameSheet=false;
editedFormulaCellInfo.cellFieldDetails={"ACTUAL_FORMULA_SHEET":CURRSHEETNAME,"CF_VALUE":isFuncDlgOpen?exprField.value:cellField.value,"CF_WIDTH":cellField.style.width,"CF_HEIGHT":cellField.style.height,"CF_CLR":cellField.style.color,"CF_BGCLR":cellField.style.backgroundColor,"CF_FONTSIZE":cellField.style.fontSize,"CF_FONTFAMILY":cellField.style.fontFamily,"CF_TOP":cellField.style.top,"CF_LEFT":cellField.style.left,"CF_CLSNAME":cellField.className,"COLUMN":currCol,"ROW":currRow,"CURRPOS":getCaretPos(cellField)};
editedFormulaCellInfo.cellFieldDetails.PREV_SHEET=CURRSHEETNAME;
editedFormulaCellInfo.cellFieldDetails.CURRPOS=getCaretPos(cellField);
}else{
if(editedFormulaCellInfo.cellFieldDetails.ACTUAL_FORMULA_SHEET==_30fa){
editedFormulaCellInfo.cellFieldDetails.PREV_SHEET=CURRSHEETNAME;
editedFormulaCellInfo.isOtherSheet=false;
editedFormulaCellInfo.isSameSheet=true;
editedFormulaCellInfo.cellFieldDetails.CURRPOS=getCaretPos(cellField);
}
}
}else{
submitCell();
}
}
isSheetLoading=true;
if(jsSHARE_VIEW&&obj==null){
return;
}
var _30fb=CURRSHEETNAME;
NOTIFY="false";
if(COLLAB_ID!=""||obj.getElementsByTagName("DIV")[0].className.indexOf(" notify")!=-1){
if(!SAVED){
NOTIFY="true";
}
}
if(jsSHARE_VIEW&&!ALLOW_TO_WRITE){
NOTIFY="false";
}
obj.getElementsByTagName("DIV")[0].className="tabItem selected";
var _30fa=obj.getAttribute("sheetname");
if(!pivotSheet){
var _30fc=getCellRange();
storePreFocus();
}
if(_30fb!=_30fa){
if(typeof _30f9=="undefined"&&!FIND.dialogOpen){
if(isUndefined(editedFormulaCellInfo.cellFieldDetails.CF_VALUE)){
closeDialog();
}
}
if(!hasOleMoved){
resetChartVars();
}
resetFreezePaneVariables();
}
var _30fd=getObj("sheetdiv-"+CURRSHEETNAME);
if(_30fd!=null){
_30fd.getElementsByTagName("DIV")[0].className="tabItem";
}
obj.getElementsByTagName("DIV")[0].className="tabItem selected";
if(obj.getAttribute("macrochange")!=null){
NOTIFY="false";
}
CURRSHEETNAME=_30fa;
if((pivotSheet&&_30f8=="pivotload")||_30fb!=CURRSHEETNAME){
scrollSheetTabToView(CURRSHEETNAME);
if(NOTIFY=="true"){
autosave();
}else{
if(!(pivotSheet&&_30f8=="pivotload")&&typeof _30f9=="undefined"){
message(jsMsg.Loading+"...","block");
}
var obj1=getObj("html-"+CURRSHEETNAME);
if(obj1!=null&&DOCUMENT_ID!=null&&DOCUMENT_ID!="doc_id"&&COLLABORATIVE_EDITING=="OFF"&&COLLAB_ID==""){
if(obj1.value.indexOf("[{REPORT_ID:")!=0){
pivotSheet=false;
isSSActive=true;
$=jQuery;
removePivotContent();
sheetHTML=replaceHTML(obj1.value);
getObj("sheetdiv").innerHTML=sheetHTML;
HTMLVIEW=true;
sheetDefault();
updateOtherSheetMacroChanges(_30fa);
}else{
pivotSheet=true;
isSSActive=false;
menutabs.pivotSheettoggle(pivotSheet);
jQuery.noConflict();
if(isUndefined($)){
$=pivot$;
}
removePivotContent();
var info=eval(obj1.value);
var objid=info[0].REPORT_ID;
var _3101=info[0].REPORT_TYPE;
var _3102=getObj("pivotTitle");
var _3103=getObj("pivotDesc");
_3102.innerHTML=(info[0].REPORT_TITLE!="")?info[0].REPORT_TITLE:"&nbsp;";
_3103.innerHTML=replaceSplChrs(info[0].REPORT_DESCRIPTION);
getObj("eP").style.display="none";
if(_3101=="BaseTable"){
getObj("pivotTableToolbar").style.display="none";
getObj("dataTableToolbar").style.display="none";
}else{
getObj("pivotTableToolbar").style.display="none";
getObj("dataTableToolbar").style.display="none";
}
var _3104=ZDBClientUI.getExistingTab(objid);
if(_3104){
ZDBClientUI.selectTab(_3104);
if(showpivotVar=="refreshPivotRangeEdit"){
editpivotSheet="";
isEditPivotDialogOpen=false;
ZDBClientUI.reloadCurAnalysisView();
}
showpivotVar="";
}
showDBView(_3101,_3104);
ZDBDataGrid.setDocumentEvents(false);
isSheetLoading=false;
}
}else{
if(jsREMOTE_SAVE_VIEW||(jsPUBLIC_VIEW&&!showFormulas)){
HTMLVIEW=false;
sheetopen(_30f7);
}else{
sheetopen(_30f7);
}
}
}
}
}
function sheetopen(_3105,_3106,val,_3108){
if(isEditorClosed){
}
if(typeof _3108=="undefined"){
_3108="false";
}
var url=ctxpath+"loadsheet.do";
var _310a=encodeURIComponent(CURRSHEETNAME);
var _310b="&docid="+DOCUMENT_ID+"&sheetname="+_310a+"&neworopen="+_3105+"&curtime="+CURRENTTIME+"&viewType="+getViewType();
_310b+="&docowner="+CURR_DOC_OWNERNAME+"&collabid="+COLLAB_ID+"&isDocSaved="+isDocSaved()+"&OOLOADED="+OOLOADED;
_310b+="&readwrite="+ALLOW_TO_WRITE+"&afterRTC="+_3108+"&collabEditing="+COLLABORATIVE_EDITING+"&isGadget="+jsGADGET_VIEW+"&fileFormat="+FILE_FORMAT;
_310b+="&docName="+encodeURIComponent(DOCUMENT_NAME);
_310b+="&sheetHeight="+getSheetHeight();
_310b+="&sheetWidth="+getSheetWidth();
_310b+="&tempPublicDocId="+tempPublicDocId;
if(typeof _3106!="undefined"&&_3106!=""){
_310b+="&docauthorid="+_3106;
}
if(_3105=="newreport"){
pivotSheet=true;
isSSActive=false;
_310b+="&pivotType="+PIVOT_TYPE+"&parentTable="+PARENTVIEW_ID;
}
if(window.ZDBWHOLEDIV){
_310b+="&zdbdiv=present";
}
if(jsREMOTE_SAVE_VIEW){
_310b+="&apiKey="+getObj("apiKey").value;
}
if(jsVERSION_VIEW){
_310b+="&version="+DOCUMENT_VERSION;
}
if(docMetaDetails[CURRSHEETNAME]){
_310b+="&USED_ROW="+docMetaDetails[CURRSHEETNAME]["USED_ROW"]+"&USED_COL="+docMetaDetails[CURRSHEETNAME]["USED_COL"]+"&ROW_HT="+docMetaDetails[CURRSHEETNAME]["ROW_HT"];
}
_310b=appendCSRFToURL(_310b);
AjaxAPI.sendRequest({URL:(url),METHOD:"POST",PARAMETERS:_310b,ONSUCCESSFUNC:this.openSheet,NEWOROPEN:_3105});
}
function versionSheetopen(sName){
var url=ctxpath+"loadsheet.do";
if(sName){
var _310e=getObj("sheetdiv-"+CURRSHEETNAME);
if(_310e){
_310e.getElementsByTagName("DIV")[0].className="tabItem";
}
CURRSHEETNAME=sName;
_310e=getObj("sheetdiv-"+CURRSHEETNAME);
if(_310e){
_310e.getElementsByTagName("DIV")[0].className="tabItem selected";
}
message(jsMsg.Loading,"block","...");
}
var _310f=encodeURIComponent(CURRSHEETNAME);
var _3110="&docid="+DOCUMENT_ID+"&sheetname="+_310f+"&curtime="+CURRENTTIME+"&viewType=VERSION_VIEW"+"&docowner="+CURR_DOC_OWNERNAME;
if(jsVERSION_VIEW){
_3110+="&version="+DOCUMENT_VERSION;
}
if(docMetaDetails[CURRSHEETNAME]){
_3110+="&USED_ROW="+docMetaDetails[CURRSHEETNAME]["USED_ROW"]+"&USED_COL="+docMetaDetails[CURRSHEETNAME]["USED_COL"]+"&ROW_HT="+docMetaDetails[CURRSHEETNAME]["ROW_HT"];
}
_3110+="&fileFormat="+FILE_FORMAT;
_3110+="&docName="+encodeURIComponent(DOCUMENT_NAME);
_3110+="&sheetHeight="+getSheetHeight();
_3110+="&sheetWidth="+getSheetWidth();
_3110+="&tempPublicDocId="+tempPublicDocId;
_3110=appendCSRFToURL(_3110);
AjaxAPI.sendRequest({URL:(url),METHOD:"POST",PARAMETERS:_3110,ONSUCCESSFUNC:this.openSheet});
}
var sheetHTML="";
function openSheet(_3111,_3112){
var _3113=fromGoTo;
if(isEditorClosed){
}
(typeof ole!=="undefined")&&ole.reset();
Filter.clear();
var _3114=getObj("cellStatus");
if(_3114){
_3114.innerHTML="";
}
var _3115=_3112["NEWOROPEN"];
sheetHTML=_3111.getOnlyHtml();
if(sheetHTML==showErrorPanelMsg){
handleServerError("ERROR",sheetHTML,true);
message("","none");
return;
}
var _3116=_3111.responseText;
var _3117=_3116.substring(_3116.indexOf("<script>dataResponse=")+21,_3116.length-1);
dataResponse=_3117.substring(0,_3117.indexOf("</script>"));
var _3118=_3116.indexOf("<script>filterM");
if(_3118!==-1){
var _3119=_3116.substring(_3118+23,_3116.indexOf("</script>",_3118+23));
if(_3119.trim()!=="null"){
filterMetaInfo=JSON.parse(_3119);
if(filterMetaInfo.isCriteriaApplied){
Filter.create(CURRSHEETNAME,filterMetaInfo);
}else{
filterMetaInfo=undefined;
}
}
}
commentCallout=getObj("cellCommentCallout");
if((commentCallout!=null)||(commentCallout.style.display!="none")){
commentCallout.style.display="none";
}
var _311a=sheetHTML.indexOf("<!--");
var _311b=sheetHTML.indexOf("-->");
var docid="";
var _311d="";
if(sheetHTML.indexOf("<!-- [{REPORT_ID:")==-1&&_311a!=-1&&_311b!=-1){
var _3117=sheetHTML.substring(_311a+4,_311b);
var info=eval(_3117);
var _311f=info[0];
docid=_311f.DOCUMENT_ID;
var _3120=false;
_311d=_311f.SHEETNAME;
if(docid==DOCUMENT_ID&&_311d==CURRSHEETNAME){
if(pivotSheet){
_3120=true;
}
pivotSheet=false;
isSSActive=true;
$=jQuery;
if(!jsTHROWAWAY_VIEW){
removePivotContent();
}
var _3121=getObj("sheetdiv");
if(browser_nn6){
var _3122=_3121.offsetHeight;
_3121.style.height=_3122+"px";
_3121.style.overflow="hidden";
}
_3121.innerHTML=sheetHTML;
if(_3120){
initUIComponents();
}
sheetDefault();
if(browser_nn6){
_3121.style.height="";
_3121.style.overflow="";
}
updateOtherSheetMacroChanges(_311d);
if(typeof _3115!="undefined"&&_3115=="new"){
fireWorkbook_NewSheetEvent(_311d,false);
}
}
}else{
pivotSheet=true;
isSSActive=false;
var _3123=getObj("pivotTitle");
var _3124=getObj("pivotDesc");
sheetHTML=_3111.getOnlyHtml();
ZDBglobal.designInPopUp=(_3112["NEWOROPEN"]=="newreport");
var _3117=sheetHTML.substring(_311a+4,_311b);
_3117=_3117.replace(/\\/g,"\\\\");
if(!window.ZDBWHOLEDIV){
var info=eval(_3117);
}
var rType=false;
if(typeof info!="undefined"&&info[0].REPORT_TYPE=="BaseTable"){
rType=true;
}
menutabs.pivotSheettoggle(pivotSheet,rType);
jQuery.noConflict();
if(isUndefined($)){
$=pivot$;
}
removePivotContent();
if(!window.ZDBWHOLEDIV){
_3123.innerHTML=(info[0].REPORT_TITLE!="")?info[0].REPORT_TITLE:"&nbsp;";
_3124.innerHTML=replaceSplChrs(info[0].REPORT_DESCRIPTION);
ZDBWHOLEDIV=document.createElement("div");
ZDBWHOLEDIV.innerHTML=sheetHTML;
var x=_3111.getScripts();
var _3127="";
for(var i=x.length-1;i>-1;i--){
_3127+="\n"+x[i];
}
var re=new RegExp(AjaxUtils.scriptFragment,"img");
_3127=_3127.replace(re,"$1");
$("ZDBWholeViewStoreDiv").appendChild(ZDBWHOLEDIV);
if(_3127!=""){
eval(_3127);
}
showDBView(info[0].REPORT_TYPE);
}else{
if(window.ZDBWHOLEDIV&&ZDBglobal.designInPopUp){
var info=eval(_3117);
_3123.innerHTML=(info[0].REPORT_TITLE!="")?info[0].REPORT_TITLE:"&nbsp;";
_3124.innerHTML=replaceSplChrs(info[0].REPORT_DESCRIPTION);
var dbId=info[0].DB_ID;
var objId=info[0].REPORT_ID;
var _312c=info[0].REPORT_TYPE;
ZDBClientUI.createAnalysisView(dbId,objId,"Sheet",_312c,null,"max");
}else{
var info=eval(_3117);
var objid=info[0].REPORT_ID;
var _312c=info[0].REPORT_TYPE;
_3123.innerHTML=(info[0].REPORT_TITLE!="")?info[0].REPORT_TITLE:"&nbsp;";
_3124.innerHTML=replaceSplChrs(info[0].REPORT_DESCRIPTION);
var _312e=ZDBClientUI.getExistingTab(objid);
showDBView(_312c,_312e);
if(_312e){
ZDBClientUI.selectTab(_312e);
if(showpivotVar=="refreshPivotRangeEdit"){
editpivotSheet="";
isEditPivotDialogOpen=false;
ZDBClientUI.reloadCurAnalysisView();
}
showpivotVar="";
}else{
_312c=(_312c=="BaseTable")?"Table":_312c;
ZDBClientUI.fetchViewBasedOnType(objid,objid,CURRSHEETNAME,_312c);
}
}
}
ZDBDataGrid.setDocumentEvents(false);
isSheetLoading=false;
}
var _312f=new Object();
var _3130;
if(workbookData.copySheet){
_3130=copySheetInJson(workbookData.originalSheet,workbookData.copiedSheet);
}else{
_3130=jsonWorkbookObj();
}
var scnt=_3130.sheetcnt;
for(var x=0;x<=scnt;x++){
var sheet=_3130["sheet"+x];
if(sheet!=undefined){
if(sheet.sheetName==_311d){
position_Bottom=sheet.positionBottom;
position_Left=sheet.positionLeft;
var t1=findRowInYPos(getRowTop(position_Bottom)+getSheetHeight(),true);
appendBlankRows("ROWS_EXCEEDED",t1);
if(position_Left<getColMax()){
var t2=findColInXPos(getColLeft(position_Left)+getSheetWidth(),true);
if(t2>totCols){
var diff=(t2-totCols)+1;
insertCol("append",totCols,diff,true,true,true,undefined,undefined,undefined,undefined,true);
}
}
if(((sheet.activeRowIndex==sheet.activeERowIndex)&&(sheet.activeColIndex==sheet.activeEColIndex))||((sheet.activeERowIndex&&sheet.activeEColIndex)===undefined)){
cursor_Row_Index=sheet.activeRowIndex;
cursor_Col_Index=sheet.activeColIndex;
_312f.endCol=sheet.activeColIndex;
_312f.endRow=sheet.activeRowIndex;
if(cursor_Row_Index>position_Bottom&&cursor_Col_Index>position_Left){
if(!_3113){
setScrollTop(getRowTop(position_Bottom));
setScrollLeft(getColLeft(position_Left));
if(editedFormulaCellInfo.isOtherSheet){
return;
}else{
focusCell(cursor_Row_Index,cursor_Col_Index,"",true);
}
}else{
fromGoTo=false;
gotoCell();
}
}else{
if(!_3113){
if(editedFormulaCellInfo.isOtherSheet){
return;
}else{
focusCell(cursor_Row_Index,cursor_Col_Index);
}
setScrollTop(getRowTop(position_Bottom));
setScrollLeft(getColLeft(position_Left));
}else{
fromGoTo=false;
gotoCell();
}
}
}else{
cursor_Row_Index=sheet.activeRowIndex;
cursor_Col_Index=sheet.activeColIndex;
_312f.endRow=sheet.activeERowIndex;
_312f.endCol=sheet.activeEColIndex;
if((cursor_Row_Index+_312f.endRow)>position_Bottom&&(cursor_Col_Index+_312f.endCol>position_Left)){
setScrollTop(getRowTop(position_Bottom));
setScrollLeft(getColLeft(position_Left));
if(cursor_Col_Index!=0){
var _3136=getColHead(0);
var _3137=getRowHead(0);
if(_3136!=null){
_3136.className="";
_3137.className="";
}
}
if(editedFormulaCellInfo.isOtherSheet){
return;
}else{
focusCellRange(cursor_Row_Index,cursor_Col_Index,_312f.endRow,_312f.endCol,"",false,"","",true);
}
}else{
if(editedFormulaCellInfo.isOtherSheet){
return;
}else{
focusCellRange(cursor_Row_Index,cursor_Col_Index,_312f.endRow,_312f.endCol,"",false,"","",true);
}
setScrollTop(getRowTop(position_Bottom));
setScrollLeft(getColLeft(position_Left));
}
}
}
}
}
}
function showDBView(_3138,_3139){
if(!ZDBglobal.designInPopUp){
if((_3139!=null)&&(_3138!="BaseTable")){
ZDBAnalysisView.addOnlyChartArea(_3139.view);
}else{
if(_3138=="BaseTable"){
ZDBClientUI.addOnlyPlaceHolder();
}
}
}
}
function setSheetDivDefaultHeight(){
if(browser_ie){
var _313a=document.body.clientHeight;
}else{
if(browser_nn4||browser_nn6){
var _313a=window.innerHeight;
}
}
var _313b=_313a-findPosY(getObj("sheetdiv"))-getObj("bottomBand").offsetHeight;
var div=document.createElement("div");
div.innerHTML="&nbsp;";
div.style.height=(_313b)+"px";
var _313d=getObj("sheetdiv");
ZDButil.removeAllChildren(_313d);
_313d.appendChild(div);
}
var currSheetOnRightClick="";
var sheetsContextMenuStatus=false;
function showSheetsContextMenu(ev,el){
if(isErrorDoc||!isServerComponentLoaded(true)){
return false;
}
currSheetOnRightClick=el.getAttribute("sheetname");
if(currSheetOnRightClick!=CURRSHEETNAME){
getObj("sheetdiv-"+CURRSHEETNAME).className="";
el.getElementsByTagName("DIV")[0].className="tabItem selected";
showsheet(el,"open","rightclicked");
}
if(!READ_WRITE){
if(!jsTHROWAWAY_VIEW){
return false;
}
}
if(!jsREMOTE_SAVE_VIEW){
if(INSERT_SHEET_ALLOWED){
return false;
}
}
var left,top;
if(browser_ie){
left=window.event.clientX;
top=window.event.clientY;
}else{
if(browser_nn6){
left=ev.pageX;
top=ev.pageY;
}
}
if((transMode==true)&&(messagetranslated==true)){
sheetsContextMenuStatus=false;
}
if(!sheetsContextMenuStatus){
var _3142="";
_3142="<menu id='SheetsContextMenu' onBeforeUnload='menuClose(ev)'>";
_3142+=" <item onclick='insertSheet();return false;'><![CDATA["+jsMsg.Insert+"]]></item>";
_3142+=" <item onclick='deleteSheet();return false;'><![CDATA["+jsMsg.Delete+"]]></item>";
_3142+=" <item onclick='showSheetRenameDialog();return false;'><![CDATA["+jsMsg.Rename+"]]></item>";
_3142+=" <sep></sep>";
_3142+=" <item onclick='copySheet();return false;'><![CDATA["+jsMsg.CopyThisSheet+"]]></item>";
_3142+=" <item onclick='moveSheet();return false;'><![CDATA["+jsMsg.MoveThisSheet+"]]></item>";
_3142+=" <item onclick='shareSheet();return false;'><![CDATA["+jsMsg.ShareThisSheet+"]]></item>";
_3142+=" <sep></sep>";
_3142+=" <item onclick='viewSheetCode();return false;'><![CDATA["+jsMsg["VBAEditor.ViewCode"]+"]]></item>";
_3142+="</menu>";
Menu.create(_3142,{inputType:"xml"});
sheetsContextMenuStatus=true;
}
if(getObj("sheetsTab").getElementsByTagName("TD").length==2){
Menu.SheetsContextMenu.data[5].disabled="true";
}else{
Menu.SheetsContextMenu.data[5].disabled="false";
}
var _3143=false;
if(TOP!=null&&TOP!=""){
if("entrepreneur"==TOP.toString()){
_3143=true;
}
}
if(!jsSHARE_VIEW&&!MKIMODE&&!_3143&&!jsREMOTE_SAVE_VIEW){
top=top-156;
Menu.SheetsContextMenu.data[6].hidden="false";
}else{
top=top-133;
Menu.SheetsContextMenu.data[6].hidden="true";
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
Menu.SheetsContextMenu.data[6].hidden="true";
Menu.SheetsContextMenu.data[7].hidden="true";
Menu.SheetsContextMenu.data[8].hidden="true";
top=top+20;
}
if(jsPUBLIC_VIEW){
Menu.SheetsContextMenu.data[6].hidden="true";
}
if(isSSActive){
Menu.SheetsContextMenu.data[8].disabled="false";
}else{
Menu.SheetsContextMenu.data[8].disabled="true";
}
if(jsSHARE_VIEW&&pivotSheet){
Menu.SheetsContextMenu.data[1].hidden="true";
Menu.SheetsContextMenu.data[4].hidden="true";
top=top+40;
}else{
Menu.SheetsContextMenu.data[1].hidden="false";
Menu.SheetsContextMenu.data[4].hidden="false";
}
if(HIDE_SHARE_OPTION){
Menu.SheetsContextMenu.data[6].hidden="true";
}
Menu.SheetsContextMenu.data[6].hidden="true";
Menu.SheetsContextMenu.cachedContent="";
showMenu("SheetsContextMenu",{position:"absolute",left:left,top:top});
return false;
}
function getSheetName(mode,_3145){
var cnt=1;
if(mode=="add"){
_3145=currSheetOnRightClick+1;
}
if(mode=="rename"){
var name=_3145;
}else{
var name=jsTitleMsg.Sheet+cnt;
}
var _3148=false;
var sn=SHEETNAMESLIST.split(",");
var xx=true;
while(xx){
for(var i=0;i<sn.length;i++){
var value=sn[i];
if(currSheetOnRightClick==value.trim()){
if(currSheetOnRightClick.toUpperCase()==_3145.toUpperCase()){
_3148=false;
break;
}
}
if(name.trim().toUpperCase()==value.trim().toUpperCase()){
_3148=true;
break;
}
}
if(mode=="rename"){
return _3148;
}else{
if(_3148){
cnt++;
name=jsTitleMsg.Sheet+cnt;
_3148=false;
}else{
xx=false;
}
}
}
return name;
}
function insertSheet(add,_314e,_314f,_3150,_3151){
if(!isServerComponentLoaded(true)){
return false;
}
if(isErrorDoc||GoalSeek.dialog){
return;
}
if(typeof _3151=="undefined"){
getSheetsList("insert",add,_314e,_314f,_3150);
return;
}
if(typeof _314f=="undefined"){
_314f="false";
}
var _3152="insert";
if(_3150){
_3152="insertPivot";
}
var _3153="false";
if(typeof add=="undefined"){
_3153="false";
closeDialog();
var name=currSheetOnRightClick;
if(name==""){
name=CURRSHEETNAME;
}
}else{
if(typeof _314e=="undefined"){
_3153="true";
var _3155=getObj("sheetsTab").getElementsByTagName("TD");
for(var i=0;i<_3155.length-1;i++){
if(_3155[i].tagName=="TD"){
var name=_3155[i].getAttribute("sheetname");
break;
}
}
}else{
_3153=add;
name=_314e;
}
}
var obj=getObj("sheetdiv-"+name);
var _3158=obj.parentNode;
var _3159=document.createElement("TD");
TOTALSHEETS=parseInt(TOTALSHEETS)+1;
var _315a="";
if(_3150){
if(_3150=="Pivot"){
_315a="<img src=\"/styles/green/images/spacer.gif\" class=\"pivotTableIcon\"/>";
}
if(_3150=="AnalysisView"){
_315a="<img src=\"/styles/green/images/spacer.gif\" class=\"pivotChartIcon\"/>";
}
sheetname=getObj("pivotLocation").value;
}else{
sheetname=getSheetName("add");
}
if((typeof _314e=="undefined"||_314e==CURRSHEETNAME)&&_314f=="false"){
getObj("sheetdiv-"+CURRSHEETNAME).getElementsByTagName("DIV")[0].className="tabItem";
}else{
}
_3159.setAttribute("sheetname",sheetname);
_3159.id="sheetdiv-"+sheetname;
_3159.title=sheetname;
if((typeof _314e=="undefined"||_314e==CURRSHEETNAME)&&_314f=="false"){
_3159.innerHTML="<div class='tabItem selected'><div id='sheetnames_'"+i+">"+_315a+sheetname+"</div></div>";
}else{
_3159.innerHTML="<div class='tabItem'><div id='sheetnames_'"+i+">"+_315a+sheetname+"</div></div>";
}
_3159.onmousedown=function(event){
return reorderSheet(event,this);
};
_3159.oncontextmenu=function(event){
return showSheetsContextMenu(event,this);
};
if(_3153=="true"){
_3158.insertBefore(_3159,getObj("dummySheetTab"));
}else{
_3158.insertBefore(_3159,obj);
}
toggleSheetsTabNavBar();
var _315d=new getXmlhttp();
_315d.open("POST",ctxpath+"sheetaction.do",false);
_315d.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
name=encodeURIComponent(name);
var _315e=getViewType();
if(jsREMOTE_VIEW){
_315e="REMOTE_SAVE_VIEW";
}
var nvp="sheetname="+encodeURIComponent(sheetname)+"&insertbefore="+name+"&sheetadd="+_3153+"&action="+_3152+"&curtime="+CURRENTTIME+"&docid="+DOCUMENT_ID;
nvp+="&afterRTC="+_314f+"&collabid="+COLLAB_ID+"&docowner="+CURR_DOC_OWNERNAME+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&viewType="+_315e+"&isDocSaved="+isDocSaved()+"&RMLOGINNAME="+RMUSER+"&fileFormat="+FILE_FORMAT;
if(_3150){
var _3160=getObj("pivotName").value.trim();
_3160=encodeURIComponent(_3160);
var _3161=getObj("pivotNameDesc").value.trim();
_3161=replace(_3161,"\r\n","<BR>");
_3161=replace(_3161,"\n","<br>");
_3161=encodeURIComponent(_3161);
var _3162=getObj("pivotDataRange").value.trim();
if(_3162.indexOf("!")!=-1||_3162.indexOf(".")!=-1){
_3162=_3162.replace(/\./g,"!");
var val=_3162.split("!");
pivotsrcSheet=val[0];
_3162=getCellRangeVal(val[1]);
}else{
_3162=getCellRangeVal(_3162);
pivotsrcSheet=CURRSHEETNAME;
}
nvp+="&reportType="+_3150+"&rangeAddr="+_3162+"&thisSheetName="+CURRSHEETNAME+"&reportTitle="+_3160+"&reportDesc="+_3161;
}
sendXMLHTTPRequest(_315d,nvp,true,false);
if(_315d!=null){
if(_315d.responseText==showErrorPanelMsg){
handleServerError("ERROR",_315d.responseText,true);
return;
}
if((typeof _314e=="undefined"||_314e==CURRSHEETNAME)&&_314f=="false"){
if(_3150){
message("","none");
try{
var resp=eval("("+_315d.responseText+")");
PARENTVIEW_ID=resp.parentView;
PIVOT_TYPE=resp.viewType;
}
catch(e){
showAlertDialog("Problem while creating pivot report.");
deleteSheet(sheetname);
return;
}
showsheet(_3159,"newreport");
}else{
showsheet(_3159,"new");
}
}
if(READ_WRITE){
btn_enabled();
}
try{
var xml=_315d.responseXML;
var attrs=xml.childNodes[0].attributes;
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="bridgeNum"){
bridgeNumber=attr.nodeValue;
}
}
}
}
catch(e){
}
if(_314f=="true"||ISMINDLG){
updateSheetAction(104,{SN:sheetname});
}
if(_314f=="true"){
fireWorkbook_NewSheetEvent(sheetname,_314f);
}
getNamedRanges("insertSheet");
if(workbooksheets==null){
constructClientJson();
}else{
addSheetInJson(sheetname,TOTALSHEETS-1);
}
}
IS_UNSAVED_SHEET=true;
}
function deleteSheet(_3169,_316a){
if(typeof _316a=="undefined"){
_316a="false";
}
var _316b="delete";
if(typeof _3169=="undefined"){
var name=currSheetOnRightClick;
}else{
name=_3169;
}
if(name==tmpSheetName){
insertCutRows=false;
insertCopyRows=false;
insertCutCols=false;
insertCopyCols=false;
resetCopyPasteVars();
}
var obj=getObj("sheetdiv-"+name);
var _316e=obj.parentNode;
TOTALSHEETS=parseInt(TOTALSHEETS)-1;
closeDialog();
if(TOTALSHEETS<1){
if(jsSHARE_VIEW&&_316a=="true"){
loadDocument("ajaxnew.do");
}else{
TOTALSHEETS=parseInt(TOTALSHEETS)+1;
showAlertDialog(jsTitleMsg.documentMustContainAtleastOneSheet);
}
return;
}
if(typeof _3169=="undefined"){
var a=showConfirmDialog(jsTitleMsg.TheSelectedSheetDeletedPermanently+"\n"+jsTitleMsg.ToDeleteSelectedSheetClickOK+"\n"+jsTitleMsg.ToCancelDeletionClickCancel);
}else{
var a=true;
}
if(a){
_316e.removeChild(obj);
toggleSheetsTabNavBar();
removePreFocus(name);
setResponseWaitingTime();
var _3170=new getXmlhttp();
_3170.open("POST",ctxpath+"sheetaction.do",true);
_3170.onreadystatechange=function(event){
if(_3170.readyState==4){
clearResponseWaitingTime();
if(_3170.responseText==showErrorPanelMsg){
handleServerError("ERROR",_3170.responseText,true);
return;
}
if(READ_WRITE){
removeSheets(decodeURIComponent(name));
btn_enabled();
}
if(pivotSheet){
try{
ZDBClientUI.removeObjects([ZDBClientUI.selectedTab.view.objId]);
}
catch(e){
}
}
if(workbooksheets==null){
workbooksheets=constructClientJson();
deleteSheetInJson(name);
}else{
deleteSheetInJson(name);
workbookData.preActiveRow=0;
workbookData.preActiveCol=0;
workbookData.posBtm=0;
workbookData.posLft=0;
}
if(_316a=="true"||ISMINDLG){
updateSheetAction(100,{SN:name});
}
var xml=_3170.responseXML;
var attrs=xml.childNodes[0].attributes;
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="name"){
name=attr.nodeValue;
}else{
if(attr.nodeName=="index"){
index=attr.nodeValue;
}else{
if(attr.nodeName=="bridgeNum"){
bridgeNumber=attr.nodeValue;
}
}
}
}
}
if(typeof _3169=="undefined"||_3169==CURRSHEETNAME){
if(pivotsrcSheet!=""){
showsheet(getObj("sheetdiv-"+pivotsrcSheet),"open");
pivotsrcSheet="";
}else{
showsheet(getObj("sheetdiv-"+name),"open");
}
}
getNamedRanges("delSheet");
}
};
_3170.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
if(typeof _3169=="undefined"){
var name=encodeURIComponent(CURRSHEETNAME);
}else{
var name=encodeURIComponent(_3169);
}
var _3176=getViewType();
if(jsREMOTE_VIEW){
_3176="REMOTE_SAVE_VIEW";
}
var nvp="sheetname="+name+"&action="+_316b+"&curtime="+CURRENTTIME+"&docid="+DOCUMENT_ID;
nvp+="&afterRTC="+_316a+"&collabid="+COLLAB_ID+"&docowner="+CURR_DOC_OWNERNAME+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&viewType="+_3176+"&isDocSaved="+isDocSaved()+"&RMLOGINNAME="+RMUSER+"&fileFormat="+FILE_FORMAT+"&totCols="+totCols;
sendXMLHTTPRequest(_3170,nvp,true,false);
}else{
TOTALSHEETS=parseInt(TOTALSHEETS)+1;
}
}
function showSheetRenameDialog(){
var _3178=currSheetOnRightClick;
var _3179="<div class='divSpacing'>"+jsTitleMsg.EnterSheetName+" :</div> <div><input type='text' id='newShName' value='"+_3178+"' maxlength='31' onkeydown='submitFuction(null,event,renameSheet);' style='width:260px' ></div>";
$("#sheetdialog").html(_3179);
$.sheetdialog.open("#sheetdialog",{autoOpen:false,width:300,modal:true,resizable:false,title:jsMsg.Rename,buttons:[{text:jsTitleMsg["OK"],click:function(){
renameSheet();
$.sheetdialog.close(this);
}},{text:jsTitleMsg["Cancel"],click:function(){
$.sheetdialog.close(this);
}}]});
$("#newShName").focus();
$("#newShName").select();
}
function renameSheet(_317a,_317b,_317c,_317d,_317e){
if(!_317d){
getSheetsList("rename",_317a,_317b,_317c,_317e);
return;
}
if(typeof _317c=="undefined"){
_317c="false";
}
closeDialog();
$("#sheetdialog").dialog("close");
if(typeof _317a=="undefined"){
var name=currSheetOnRightClick;
var obj=getObj("sheetdiv-"+name);
var _3181=name;
var _3182=$("#newShName").val();
if(_3182.length>31){
_3182=_3182.substring(0,31);
}
if(_3182&&(_3182.toLowerCase()=="null"||_3182=="undefined")){
showAlertDialog(jsTitleMsg.InvalidSheetName);
return;
}
if(_3182==""){
showAlertDialog(jsTitleMsg["Rename.SheetNameCannotBeEmpty"]);
return;
}
}else{
var name=_317a;
var obj=getObj("sheetdiv-"+name);
var _3181=name;
var _3182=_317b;
}
var _3183="rename";
var _3184=obj.parentNode;
var _3185=_3184.childNodes;
if(_3182==null||_3182=="null"){
return;
}
var _3186="";
if(pivotSheet){
if(ZDBClientUI.selectedTab.view.type=="Pivot"){
_3186="<img src=\"/styles/green/images/spacer.gif\" class=\"pivotTableIcon\"/>";
}
if(ZDBClientUI.selectedTab.view.type=="AnalysisView"){
_3186="<img src=\"/styles/green/images/spacer.gif\" class=\"pivotChartIcon\"/>";
}
if(ZDBClientUI.selectedTab.view.type=="Table"){
_3186="<img src=\"/styles/green/images/spacer.gif\" class=\"tabularDataIcon\"/>";
}
}
_3182=_3182.Rtrim();
if(_3182.trim()!=_3181.trim()){
if(_3182==null||_3182=="null"||_3182=="undefined"||_3182.trim()==""){
obj.innerHTML="<div class='tabItem'><div>"+_3186+_3181+"</div></div>";
}else{
if(checkSheetName(_3182)){
showAlertDialog(jsTitleMsg.SheetNameShouldContain);
return;
}else{
var _3187=getSheetName("rename",_3182);
}
if(_3187){
showAlertDialog(jsTitleMsg.SheetnameAlreadyExists);
obj.innerHTML="<div class='tabItem selected'><div>"+_3186+_3181+"</div></div>";
}else{
if(_317c=="false"||(_317c=="true"&&_317e=="true")){
obj.innerHTML="<div class='tabItem selected'><div>"+_3186+_3182+"</div></div>";
Userpresence.changeUserCellArr({"oldSheetName":CURRSHEETNAME,"sheetName":_3182});
CURRSHEETNAME=_3182;
}
if(_317c=="true"&&_317e=="false"){
obj.innerHTML="<div class='tabItem'><div>"+_3186+_3182+"</div></div>";
}
obj.setAttribute("sheetname",_3182);
obj.id="sheetdiv-"+_3182;
obj.title=_3182;
toggleSheetsTabNavBar();
setResponseWaitingTime();
var _3188=new getXmlhttp();
_3188.open("POST",ctxpath+"sheetaction.do",true);
_3188.onreadystatechange=function(){
if(_3188.readyState==4){
clearResponseWaitingTime();
if(_3188.responseText==showErrorPanelMsg){
handleServerError("ERROR",_3188.responseText,true);
return;
}
if(_3188.responseXML!=null){
if(READ_WRITE){
renameSheets(_3181,_3182);
btn_enabled();
autosave();
}else{
Filter.renameFilterInstance(_3181,_3182);
}
updateCell(_3188.responseXML,_3188.status,_3188.statusText);
if(_317c=="true"||ISMINDLG){
updateSheetAction(102,{OLDSHEETNAME:_3181,NEWSHEETNAME:_3182});
}
getNamedRanges("rename");
changePreFocus("SHEETNAME",_3181,"","","","",_3182);
if(workbooksheets==null){
workbooksheets=constructClientJson();
renameSheetInJson(_3181,_3182);
}else{
renameSheetInJson(_3181,_3182);
}
}
}
};
var _3189=getViewType();
if(jsREMOTE_VIEW){
_3189="REMOTE_SAVE_VIEW";
}
_3188.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var nvp="docid="+DOCUMENT_ID+"&newsheetname="+encodeURIComponent(_3182)+"&oldsheetname="+encodeURIComponent(_3181)+"&action="+_3183+"&curtime="+CURRENTTIME;
nvp+="&afterRTC="+_317c+"&collabid="+COLLAB_ID+"&docowner="+CURR_DOC_OWNERNAME+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&viewType="+_3189+"&isDocSaved="+isDocSaved()+"&RMLOGINNAME="+RMUSER+"&fileFormat="+FILE_FORMAT+"&totCols="+totCols;
nvp+="&aSR="+(getAvailableStartRow())+"&aER="+getAvailableEndRow();
sendXMLHTTPRequest(_3188,nvp,true,false);
}
}
}
}
function checkSheetName(name,type){
if(type=="Cell Reference"){
var regex=new RegExp("^[a-zA-Z0-9_\\u00A1-\\uFFFF!:]+$");
return (!(regex.test(name)));
}else{
if(type=="Define Name"){
var regex=new RegExp("^[a-zA-Z0-9_\\u00A1-\\uFFFF]+$");
return (!(regex.test(name)));
}else{
var regex=new RegExp("^[a-zA-Z0-9_ \\u00A1-\\uFFFF]+$");
return (!(regex.test(name)));
}
}
}
var sheetOnMove=false;
var currSheetOnMove="";
var movingSheet="";
var currSheetOnMoveIdx="";
var isSheetPre=false;
function reorderSheet(ev,el){
if(editedFormulaCellInfo.isOtherSheet){
}else{
workbookData.preSheetName=CURRSHEETNAME;
var _3190=new Object();
if(isCellRange()){
_3190=getCellRange();
workbookData.preActiveRow=_3190.startRow;
workbookData.preActiveCol=_3190.startCol;
workbookData.endRow=_3190.endRow;
workbookData.endCol=_3190.endCol;
}else{
workbookData.preActiveRow=ActiveCellInfo.getStartRow();
workbookData.preActiveCol=ActiveCellInfo.getStartCol();
workbookData.endRow=ActiveCellInfo.getStartRow();
workbookData.endCol=ActiveCellInfo.getStartCol();
}
workbookData.switchSheet=true;
var _3191=getXYPositions();
workbookData.posBtm=_3191.firstRow;
workbookData.posLft=_3191.firstCol;
}
$=jQuery;
if((isErrorDoc&&!allowSheetSwitch)||GoalSeek.dialog){
return;
}
if(window.event){
ev=window.event;
}
if(ev.button==2){
return;
}
if(isSheetPre){
return false;
}
isSheetPre=true;
if(browser_opera&&ev.altKey){
setTimeout(function(){
showSheetsContextMenu(ev,el);
},0);
return false;
}
if(sheetOnMove==true){
endReorderSheet();
}else{
sheetOnMove=true;
currSheetOnMove=el;
var _3192=getObj("sheetsTab").getElementsByTagName("TD");
for(var i=0;i<_3192.length-1;i++){
if(_3192[i]==currSheetOnMove){
currSheetOnMoveIdx=i;
break;
}
}
movingSheet=document.createElement("div");
movingSheet.className="sheetsTab";
movingSheet.style.position="absolute";
movingSheet.style.left=(findPosX(el)-getObj("sheetsTab").scrollLeft)+"px";
movingSheet.style.top=(findPosY(el)-1)+"px";
var _3194=getOuterHTML(el);
movingSheet.innerHTML="<table cellpadding='0' cellspacing='0'><tr>"+_3194+"</tr></table>";
document.body.appendChild(movingSheet);
currSheetOnMove.style.visibility="hidden";
sheetTransPosCnt=0;
sheetTransX=null;
if(typeof sheetTransIntvl!="undefined"){
window.clearInterval(sheetTransIntvl);
}
if(browser_ie){
movingSheetDiffX=window.event.clientX+document.body.scrollLeft-parseInt(movingSheet.style.left);
document.attachEvent("onmousemove",doReorderSheet);
document.attachEvent("onmouseup",endReorderSheet);
}else{
if(browser_nn4||browser_nn6){
movingSheetDiffX=ev.pageX-parseInt(movingSheet.style.left);
window.addEventListener("mousemove",doReorderSheet,false);
window.addEventListener("mouseup",endReorderSheet,false);
}
}
}
}
function doReorderSheet(ev){
if(!isServerComponentLoaded()){
return;
}
if(INSERT_SHEET_ALLOWED){
return false;
}
clearTextSelection();
if(browser_ie){
var _3196=(window.event.clientX-movingSheetDiffX)+document.body.scrollLeft;
}else{
if(browser_nn6){
var _3196=(ev.pageX-movingSheetDiffX);
}
}
var _3197=getObj("sheetsTab");
var _3198=findPosX(_3197);
if(_3196<_3198){
return;
}
if(_3196<_3198+_3197.offsetWidth-currSheetOnMove.offsetWidth){
movingSheet.style.left=_3196+"px";
var _3199=_3196+(movingSheet.offsetWidth/2);
var _319a=_3196+movingSheet.offsetWidth;
var _319b=_3197.getElementsByTagName("TD");
for(var i=0;i<_319b.length-1;i++){
var _319d=_319b[i];
var _319e=findPosX(_319d)-_3197.scrollLeft;
var _319f=_319e;
var _31a0=_319e+(_319d.offsetWidth/2);
var _31a1=_319e+_319d.offsetWidth;
if(_3196+_3197.scrollLeft<findPosX(currSheetOnMove)){
if(_3196>=_319f&&_3196<=_31a0){
_319d.parentNode.insertBefore(currSheetOnMove,_319d);
break;
}
}else{
if(_319a>=_31a0&&_319a<=_31a1){
_319d.parentNode.insertBefore(currSheetOnMove,_319b[i+1]);
break;
}
}
}
}
}
function endReorderSheet(){
var _31a2=getObj("sheetsTab").getElementsByTagName("TD");
for(var i=0;i<_31a2.length-1;i++){
if(_31a2[i]==currSheetOnMove){
var _31a4=i;
break;
}
}
var _31a5="false";
if(typeof _31a4!="undefined"){
if(currSheetOnMoveIdx!=_31a4){
if(_31a4>currSheetOnMoveIdx){
updateSheetOrder(currSheetOnMove.getAttribute("sheetname"),_31a4+1,_31a5);
}else{
updateSheetOrder(currSheetOnMove.getAttribute("sheetname"),_31a4,_31a5);
}
}
}
sheetOnMove=false;
sheetTransX=new Array();
sheetTransPath(parseInt(movingSheet.style.left)+getObj("sheetsTab").scrollLeft,findPosX(currSheetOnMove),(-1*getObj("sheetsTab").scrollLeft));
sheetTransPitStops=(sheetTransX.length>10)?(sheetTransX.length-1)/10:1;
sheetTransPosCnt=0;
sheetTransIntvl=window.setInterval("placeReorderedSheet()",1);
if(browser_ie){
document.detachEvent("onmousemove",doReorderSheet);
document.detachEvent("onmouseup",endReorderSheet);
}else{
if(browser_nn6){
window.removeEventListener("mousemove",doReorderSheet,false);
window.removeEventListener("mouseup",endReorderSheet,false);
}
}
}
var sheetTransX,sheetTransPitStops,sheetTransPosCnt;
function sheetTransPath(x1,x2,_31a8){
var dist=Math.sqrt((x2-x1)*(x2-x1));
var dx=(x2-x1)/dist;
var _31ab;
for(var i=0;i<dist;i++){
_31ab=x1+dx;
sheetTransX[i]=_31ab+_31a8;
x1=_31ab;
}
return sheetTransX;
}
function placeReorderedSheet(){
if(sheetTransX!=null){
if(sheetTransPosCnt<sheetTransX.length-1){
movingSheet.style.left=sheetTransX[sheetTransPosCnt]+"px";
sheetTransPosCnt=sheetTransPosCnt+Math.round(sheetTransPitStops);
}else{
sheetTransPosCnt=0;
sheetTransX=null;
window.clearInterval(sheetTransIntvl);
document.body.removeChild(movingSheet);
movingSheet="";
isSheetPre=false;
currSheetOnMove.style.visibility="";
if(jsREMOTE_SAVE_VIEW){
if(CURRSHEETNAME!=currSheetOnMove.getAttribute("sheetname")){
message(jsMsg.Loading,"block","...");
}
}
showsheet(currSheetOnMove,"open");
currSheetOnMove="";
}
}
}
function updateSheetOrder(name,_31ae,_31af){
var _31b0="reorder";
var _31b1=new getXmlhttp();
_31b1.open("POST",ctxpath+"sheetaction.do",true);
_31b1.onreadystatechange=function(event){
if(_31b1.readyState==4){
var _31b3=_31b1.responseText;
if(_31b3==showErrorPanelMsg){
handleServerError("ERROR",_31b3,true);
return;
}
if(READ_WRITE){
btn_enabled();
}
var xml=_31b1.responseXML;
var attrs=xml.childNodes[0].attributes;
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="bridgeNum"){
bridgeNumber=attr.nodeValue;
}
}
}
scrollSheetTabToView(CURRSHEETNAME);
}
};
_31b1.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
name=encodeURIComponent(name);
var _31b8=getViewType();
if(jsREMOTE_VIEW){
_31b8="REMOTE_SAVE_VIEW";
}
var nvp="sheetname="+name+"&position="+_31ae+"&afterRTC="+_31af+"&action="+_31b0+"&curtime="+CURRENTTIME+"&collabEditing="+COLLABORATIVE_EDITING+"&readwrite="+ALLOW_TO_WRITE+"&collabid="+COLLAB_ID+"&docid="+DOCUMENT_ID+"&docowner="+CURR_DOC_OWNERNAME+"&viewType="+_31b8+"&isDocSaved="+isDocSaved()+"&RMLOGINNAME="+RMUSER+"&fileFormat="+FILE_FORMAT;
sendXMLHTTPRequest(_31b1,nvp,true,false);
}
if(typeof AjaxAPI!="undefined"){
AjaxAPI.showRespMsg=function(_31ba,_31bb){
if(_31ba.opStatus==StatusMsgAPI.OPSTATUS.FAILED){
var _31bc=_31ba.getResponsePart("STATUS_MESSAGE");
if(_31bc==null){
message("","none");
var _31bd=getObj("waitmsg");
_31bd.style.display="none";
isDocumentLoading=false;
var _31be=_31ba.getOnlyHtml();
if(_31be.indexOf("PARSEERROR")!=-1){
parseError=true;
if(errorMsgShown){
return;
}
_31be=_31be.trim();
_31be=eval("("+_31be+")");
errorMsgShown=true;
resetglobalvariables();
DOCUMENT_ID=_31be.DOCUMENT_ID;
DOCUMENT_NAME=_31be.DOCUMENT_NAME;
DOCUMENT_VIEW=_31be.VIEW;
CURR_DOC_OWNERNAME=_31be.DOC_AUTHOR_NAME;
var _31bf=_31be.LAST_MODIFIED_TIME;
if(!isNaN(_31bf)){
_31bf=parseInt(_31bf);
}else{
_31bf=null;
}
var _31c0=_31be.HASVERSION;
if($("#fileName")!=null){
$("#fileName").text(DOCUMENT_NAME);
}
identifyView();
var _31c1="<a href='mailto:"+jsMsg["SupportMailId"]+"'>"+jsMsg["SupportMailId"]+"</a>";
if(jsOPEN_DOC_VIEW){
ALL_SHEET_SHARED=true;
if(_31c0){
var _31c2=returnTimeElaspsedinString(_31be.CURRENTTIME,_31bf);
var _31c3="";
if(_31c2.unit.indexOf("second")!=-1){
_31c3=jsMsg["Document.Parse.Error.LastSavedTimeinSeconds"];
}else{
if(_31c2.unit=="minutes"){
_31c3=jsMsg["Document.Parse.Error.LastSavedTimeinMinutes"];
}else{
if(_31c2.unit=="hours"){
_31c3=jsMsg["Document.Parse.Error.LastSavedTimeinHours"];
}else{
if(_31c2.unit=="days"){
_31c3=jsMsg["Document.Parse.Error.LastSavedTimeinDays"];
}
}
}
}
errMsg=replaceParams(_31c3,new Array("<a href='#' onclick='revertVersion(0)'>","</a>",_31c2.count,"<a href='#' onclick='showVersionDetails()'>","</a>",_31c1));
}else{
errMsg=replaceParams(jsMsg["Document.Parse.Error.WithoutVersion"],new Array(_31c1));
}
}else{
if(jsSHARE_VIEW){
errMsg=replaceParams(jsMsg["ShareView.Document.Parse.Error"],new Array("<a href='#' onclick='notifySharedUsers(false)'>","</a>",_31c1));
}else{
var _31c4={autoOpen:false,minHeight:0,modal:true,resizable:false,title:jsTitleMsg.ErrorOccurred};
ErrorDialog.showdialog(_31ba.getOnlyHtml(),_31c4);
}
}
handleServerError("ERROR",errMsg,true);
message("","none");
return;
}else{
var _31c4={autoOpen:false,minHeight:0,modal:true,resizable:false,title:jsTitleMsg.ErrorOccurred};
ErrorDialog.showdialog(_31ba.getOnlyHtml(),_31c4);
}
}
}
if(_31ba.responseText){
_31ba.invokeScripts();
}
};
}
var sheetsScrollLeft,sheetsScrollRight,sheetsScrollCnt=0;
function scrollSheets(dir){
var _31c6=getObj("sheetsTab");
if(dir=="first"){
_31c6.scrollLeft=0;
}else{
if(dir=="left"){
sheetsSLIntvl=window.setInterval(function(){
var _31c7=getObj("sheetsTab");
_31c7.scrollLeft-=10;
},1);
}else{
if(dir=="right"){
sheetsSRIntvl=window.setInterval(function(){
var _31c8=getObj("sheetsTab");
_31c8.scrollLeft+=10;
},1);
}else{
_31c6.scrollLeft=_31c6.scrollWidth-_31c6.offsetWidth;
}
}
}
}
var sheetTabSLCnt,sheetTabSRCnt;
function scrollSheetTabToView(_31c9){
if(jsGADGET_VIEW){
return;
}
var _31ca=getObj("sheetsTab");
var _31cb=_31ca.offsetWidth;
var _31cc=getObj("sheetdiv-"+_31c9);
var _31cd=_31cc.offsetLeft;
var _31ce=_31cc.offsetWidth;
if(_31cd-_31ca.scrollLeft<0){
_31ca.scrollLeft=(_31cd<_31cb)?0:_31cd;
toggleSheetsTabNavButtons();
}else{
if(_31cd+_31ce-_31ca.scrollLeft>_31cb){
var _31cf=(_31cd+_31ce)-_31cb;
_31ca.scrollLeft=(_31cd>=(_31ca.scrollWidth-_31cb))?_31ca.scrollWidth:_31cf;
toggleSheetsTabNavButtons();
}
}
}
function showSheetsPickList(){
if(isErrorDoc||GoalSeek.dialog){
return;
}
var _31d0="";
_31d0="<menu id='sheetsList' forElement='sheetsMenu'>";
var _31d1=getObj("sheetsTab").getElementsByTagName("TD");
for(var i=0;i<_31d1.length-1;i++){
if(_31d1[i].getAttribute("sheetname")!=null){
var _31d3=(_31d1[i].getElementsByTagName("DIV")[0].className.indexOf("selected")>0)?" imgclass='mainBgImg chked'":"";
var _31d4=_31d1[i].getAttribute("sheetname");
var _31d5="sheetdiv-"+_31d4;
_31d0+="<item onclick='showsheet("+"\""+_31d5+"\""+","+"\"open"+"\""+");'"+_31d3+">"+_31d4+"</item>";
}
}
_31d0+="</menu>";
Menu.create(_31d0,{inputType:"xml"});
showMenu("sheetsList");
}
function toggleSheetsTabNavBar(){
var _31d6=getObj("sheetsTab");
var _31d7=_31d6.getElementsByTagName("TABLE")[0];
if(_31d7.offsetWidth<_31d6.offsetWidth){
getObj("sheetsTabNavBar").style.visibility="hidden";
_31d6.scrollLeft=0;
}else{
if(!isEditorClosed){
getObj("sheetsTabNavBar").style.visibility="visible";
}
}
toggleSheetsTabNavButtons();
}
function toggleSheetsTabNavButtons(){
var _31d8=getObj("sheetsTab");
var _31d9=getObj("sheetsTabNavFirst");
var _31da=getObj("sheetsTabNavPrev");
var _31db=getObj("sheetsTabNavNext");
var _31dc=getObj("sheetsTabNavLast");
var _31dd=_31d9.className;
var _31de=_31da.className;
var _31df=_31db.className;
var _31e0=_31dc.className;
if(_31d8.scrollLeft==0){
_31d9.className+=" disabled";
_31da.className+=" disabled";
_31db.className=(_31df.indexOf(" ")>-1)?_31df.substring(0,_31df.indexOf(" ")):_31df;
_31dc.className=(_31e0.indexOf(" ")>-1)?_31e0.substring(0,_31e0.indexOf(" ")):_31e0;
}else{
if(_31d8.scrollLeft==_31d8.scrollWidth-_31d8.offsetWidth){
_31d9.className=(_31dd.indexOf(" ")>-1)?_31dd.substring(0,_31dd.indexOf(" ")):_31dd;
_31da.className=(_31de.indexOf(" ")>-1)?_31de.substring(0,_31de.indexOf(" ")):_31de;
_31db.className+=" disabled";
_31dc.className+=" disabled";
}else{
_31d9.className=(_31dd.indexOf(" ")>-1)?_31dd.substring(0,_31dd.indexOf(" ")):_31dd;
_31da.className=(_31de.indexOf(" ")>-1)?_31de.substring(0,_31de.indexOf(" ")):_31de;
_31db.className=(_31df.indexOf(" ")>-1)?_31df.substring(0,_31df.indexOf(" ")):_31df;
_31dc.className=(_31e0.indexOf(" ")>-1)?_31e0.substring(0,_31e0.indexOf(" ")):_31e0;
}
}
}
function setSheetsTabDim(){
var _31e1=getObj("sheetsTab");
if(_31e1==null){
return;
}
_31e1.style.width=(_31e1.parentNode.offsetWidth)+"px";
toggleSheetsTabNavBar();
if(browser_ie){
var _31e2=getObj("sheetdiv-"+CURRSHEETNAME);
if(_31e2!=null){
_31e2.getElementsByTagName("DIV")[0].className="tabItem selected";
}
}
_31e1=null;
}
function resetSheetsTabDim(){
var _31e3=getObj("sheetsTab");
if(_31e3==null){
return;
}
_31e3.style.width="1px";
setSheetsTabDim();
_31e3=null;
}
function getViewType(){
var _31e4="NEW_VIEW";
if(jsNEW_DOC_VIEW){
_31e4="NEW_VIEW";
}else{
if(jsOPEN_DOC_VIEW){
_31e4="OPEN_VIEW";
}else{
if(jsTHROWAWAY_VIEW){
_31e4="THROWAWAY_VIEW";
}else{
if(jsPUBLIC_VIEW){
_31e4="PUBLIC_VIEW";
}else{
if(jsGUEST_VIEW){
_31e4="GUEST_VIEW";
}else{
if(jsSHARE_VIEW){
_31e4="SHARE_VIEW";
}else{
if(jsTRASH_VIEW){
_31e4="TRASH_VIEW";
}else{
if(jsVERSION_VIEW){
_31e4="VERSION_VIEW";
}else{
if(jsREMOTE_SAVE_VIEW){
_31e4="REMOTE_SAVE_VIEW";
}else{
if(jsREMOTE_VIEW){
_31e4="REMOTE_VIEW";
}
}
}
}
}
}
}
}
}
}
return _31e4;
}
function assignInitialValues(){
rHTcontextMenuStatus=cHTcontextMenuStatus=contextMenuStatus=ROcontextMenuStatus=false;
bgarr=new Array();
elemsarr=new Object();
fadeStatus=true;
var _31e5=getObj("sheethiddenDIV2");
if(_31e5!=null){
var _31e6=_31e5.childNodes;
var _31e7=new Array(_31e6.length);
var _31e8=0;
try{
for(var i=0;i<_31e6.length;i++){
var _31ea=_31e6[i];
if(_31ea.tagName=="INPUT"){
_31e7[_31e8]=_31ea.value;
_31e8++;
}
}
}
catch(e){
}
var a1=_31e7[6];
var a2=_31e7[5];
var a3=_31e7[7];
var a4=_31e7[8];
var a5=_31e7[9];
var a6=_31e7[10];
var a7=_31e7[11];
var a8=_31e7[12];
var a9=_31e7[13];
var a10=_31e7[14];
var a11=_31e7[15];
var a12=_31e7[16];
var a13=_31e7[17];
var a14=_31e7[18];
var a15=_31e7[19];
var a16=_31e7[20];
var a17=_31e7[21];
var a18=_31e7[22];
if(a1!=null){
initCols=parseInt(a1);
}
if(a2!=null){
initRows=parseInt(a2);
}
if(a3!=null){
initColWidth=parseInt(a3);
}
if(a4!=null){
initRowHeight=parseInt(a4);
}
if(a5!=null){
defCellStyleStr=a5;
defCellStyle=defCellStyleStr.split("-");
}
if(a6!=null){
defCellFormat=a6;
}
if(a7!=null){
defCellHolderProp=a7;
}
if(a8!=null){
tablewidth=a8;
}
if(a9!=null){
tableheight=a9;
}
if(a10!=null){
usedCursCol=parseInt(a10);
}
if(a11!=null){
usedCursRow=parseInt(a11);
}
if(a12!=null){
wholeValAsStringInArrFormt=a12;
}
if(a13!=null){
rowDetailStr=a13;
}
if(a14!=null){
colDetailStr=a14;
}
if(a15!=null){
colMergeDetailStr=a15;
}
if(a16!=null){
isSheetFreezed=(a16=="true")?true:false;
if(isSheetFreezed){
fromOpenFreeze=true;
}
}
if(a17!=null){
persistedFreezedRow=parseInt(a17);
}
if(a18!=null){
persistedFreezedCol=parseInt(a18);
}
rHTcontextMenuStatus=false;
rHT1contextMenuStatus=false;
cHTcontextMenuStatus=false;
cHT1contextMenuStatus=false;
contextMenuStatus=false;
contextMenuStatusFD1=false;
contextMenuStatusFD2=false;
contextMenuStatusFD3=false;
ROcontextMenuStatus=false;
currContextMenuFor="";
isRangeContextMenu=false;
sTcontextMenuStatus=false;
}
}
function disableToolBar(_31fd,val){
if(jsPUBLIC_VIEW||jsGADGET_VIEW||(_31fd&&!isDocumentReadyToEdit)){
return;
}
if(_31fd){
if(_31fd&&!jsPUBLIC_VIEW){
if(getObj("addSheetBtn")!=null){
getObj("addSheetBtn").style.visibility="visible";
}
}
getObj("readymsg").style.display="none";
getObj("Tv").readOnly=false;
getObj("Trc").readOnly=false;
if(isSheetBasedShare){
menutabs.sheetbasedtoggle(false);
}
if(!pivotSheet){
$("#fontFace").enable();
$("#fontSize").enable();
}
}else{
if(!OOLOADED&&CANREADWRITE){
if(getObj("addSheetBtn")!=null){
getObj("addSheetBtn").style.visibility="hidden";
}
ENTEREDPERFCHECK=true;
}
getObj("Tv").readOnly=true;
getObj("Trc").readOnly=true;
if(isSheetBasedShare){
menutabs.sheetbasedtoggle(true);
}
if(!pivotSheet){
$("#fontFace").disable();
$("#fontSize").disable();
}
}
}
function closeReadyforEdit(){
getObj("readymsg").style.display="none";
}
function removeSheets(_31ff){
var obj1=getObj("html-"+_31ff);
var obj2=getObj("save-"+_31ff);
if(obj1!=null&&obj1!="null"){
var _3202=obj1.parentNode;
_3202.removeChild(obj1);
}
if(obj2!=null&&obj2!="null"){
var _3202=obj2.parentNode;
_3202.removeChild(obj2);
}
}
function renameSheets(_3203,_3204){
var rem1=getObj("html-"+_3203);
var rem2=getObj("save-"+_3203);
if(typeof rem1=="object"&&rem1!=null){
rem1.id="html-"+_3204;
rem1.name="html-"+_3204;
}
if(typeof rem2=="object"&&rem2!=null){
rem2.id="save-"+_3204;
rem2.name="save-"+_3204;
}
for(var i=1;i<=ExcelGraph._INSCOUNT;i++){
var chart=ExcelGraph.getInstance("ExcelGraph"+i);
if(chart){
if(_3203==chart.CP_DOCUMENTSHEET_NAME){
chart.CP_DOCUMENTSHEET_NAME=_3204;
}
}
}
Filter.renameFilterInstance(_3203,_3204);
}
function getisSheetWritable(docid,_320a){
if(IPHONE_VIEW||jsVERSION_VIEW){
READ_WRITE=false;
disableToolBar(READ_WRITE);
}else{
if(jsREMOTE_SAVE_VIEW){
if(ISGEEDITOR&&!ALLOW_TO_WRITE){
READ_WRITE=false;
disableToolBar(READ_WRITE);
}else{
READ_WRITE=true;
disableToolBar(READ_WRITE);
}
}else{
if((jsSHARE_VIEW&&isSheetBasedShare&&!ALLOW_TO_WRITE)||ISAPP_READONLYMODE){
READ_WRITE=false;
}else{
if((!jsSHARE_VIEW||!ALLOW_TO_WRITE)&&!jsGUEST_VIEW&&!jsTRASH_VIEW&&wmsCommErrorStatus!="true"){
READ_WRITE=true;
disableToolBar(READ_WRITE);
}else{
var _320b=new getXmlhttp();
_320b.open("POST",ctxpath+"isWritableSheet.do",true);
_320b.onreadystatechange=function(){
if(_320b.readyState==4){
getSheetWritableInfo(_320b.responseXML);
}
};
_320b.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_320a=encodeURIComponent(_320a);
sendXMLHTTPRequest(_320b,"docid="+docid+"&sheetname="+_320a,true,false,"");
}
}
}
}
}
function getSheetWritableInfo(_320c){
if(_320c!=null||(_320c.hasChildNodes())){
var _320d=_320c.firstChild.childNodes;
for(var x=0;x<_320d.length;x++){
node=_320d.item(x);
if(node.nodeName=="sheet"){
var attrs=node.attributes;
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="ISWRITABLE"){
if(attr.nodeValue=="true"&&wmsCommErrorStatus!="true"){
READ_WRITE=true;
}else{
READ_WRITE=false;
}
}
}
}
}
}
}
disableToolBar(READ_WRITE);
}
function currentSheetsList(){
var _3212=getObj("sheetsTab");
var _3213=_3212.getElementsByTagName("DIV");
var _3214=new Array();
var cnt=0;
for(var i=0;i<_3213.length;i++){
var _3217=_3213[i];
if(_3217.id.indexOf("sheetnames_")!=-1){
_3214[cnt++]=_3217.innerHTML;
}
}
return _3214;
}
function duplicatesheet(_3218,_3219,_321a,_321b,_321c,value,_321e){
if(typeof _321e=="undefined"){
getSheetsList("duplicate",_3218,_3219,_321a,_321b,_321c,value);
return;
}
var _321f="duplicate";
var _3220="false";
var pass="yes";
if(typeof _3218=="undefined"){
_3218=getObj("sheetSelect").value;
if(_3218=="-"){
showAlertDialog(jsTitleMsg.CopyProperLocation);
pass="no";
document.getElementById("sheetSelect").focus();
}
}
if(typeof _321b=="undefined"){
_321b=currSheetOnRightClick;
}
if(typeof _321a=="undefined"){
_321a=getObj("newsheetname").value.trim();
if(_321a==null||_321a==""||checkSheetName(_321a)){
showAlertDialog(jsTitleMsg.AllowedSheetName);
pass="no";
document.getElementById("newsheetname").focus();
}
}
var _3222=getObj("sheetsTab").getElementsByTagName("TD");
if(typeof _321c=="undefined"){
var sn=SHEETNAMESLIST.split(",");
for(var i=0;i<sn.length;i++){
var check=sn[i];
if(_321a.trim().toUpperCase()==check.trim().toUpperCase()){
showAlertDialog(jsTitleMsg.SheetnameAlreadyExists);
pass="no";
document.getElementById("newsheetname").focus();
}
}
_321c="false";
}
if(pass=="yes"){
if(typeof _3219=="undefined"){
if(_3218=="At First"){
_3219=0;
}else{
if(_3218=="At End"){
_3219=_3222.length-2;
_3220="true";
}else{
if(_3218=="AfterCurrentSheet"||_3218=="BeforeCurrentSheet"){
var value=_3218;
_3218=currSheetOnRightClick;
}
for(var i=0;i<_3222.length-1;i++){
var _3226=_3222[i].getAttribute("sheetname");
if(_3226==_3218){
_3219=i;
if(_3219==_3222.length-2&&value!="BeforeCurrentSheet"){
_3220="true";
}else{
if(value!="BeforeCurrentSheet"){
_3219++;
}
}
break;
}
}
}
}
}else{
if((_3218=="At End")||(value=="AfterCurrentSheet"&&_3219==TOTALSHEETS)){
_3219--;
_3220="true";
}
}
var sname=_3222[_3219].getAttribute("sheetname");
var obj=getObj("sheetdiv-"+sname);
var _3229=obj.parentNode;
var _322a=document.createElement("TD");
TOTALSHEETS=parseInt(TOTALSHEETS)+1;
if((typeof _321b=="undefined"||_321b==CURRSHEETNAME)&&_321c=="false"){
getObj("sheetdiv-"+CURRSHEETNAME).getElementsByTagName("DIV")[0].className="tabItem";
}
_322a.setAttribute("sheetname",_321a);
_322a.id="sheetdiv-"+_321a;
_322a.title=_321a;
var _322b="";
if(pivotSheet){
if(ZDBClientUI.selectedTab.view.type=="Pivot"){
_322b="<img src=\"/styles/green/images/spacer.gif\" class=\"pivotTableIcon\"/>";
}
if(ZDBClientUI.selectedTab.view.type=="AnalysisView"){
_322b="<img src=\"/styles/green/images/spacer.gif\" class=\"pivotChartIcon\"/>";
}
if(ZDBClientUI.selectedTab.view.type=="Table"){
_322b="<img src=\"/styles/green/images/spacer.gif\" class=\"tabularDataIcon\"/>";
}
}
if((typeof _321b=="undefined"||_321b==CURRSHEETNAME)&&_321c=="false"){
_322a.innerHTML="<div class='tabItem selected'><div id='sheetnames_'>"+_322b+_321a+"</div></div>";
}else{
_322a.innerHTML="<div class='tabItem'><div id='sheetnames_'>"+_322b+_321a+"</div></div>";
}
_322a.onmousedown=function(event){
return reorderSheet(event,this);
};
_322a.oncontextmenu=function(event){
return showSheetsContextMenu(event,this);
};
if(_3218=="At End"){
_3220="true";
}
if(_3220=="true"){
_3229.insertBefore(_322a,getObj("dummySheetTab"));
_3219++;
}else{
_3229.insertBefore(_322a,obj);
}
toggleSheetsTabNavBar();
if(_321c=="false"){
showProgressMessage(jsMsg.CopyingSheet);
}
setResponseWaitingTime();
var _322e=new getXmlhttp();
_322e.open("POST",ctxpath+"sheetaction.do",true);
_322e.onreadystatechange=function(){
if(_322e.readyState==4){
clearResponseWaitingTime();
if(_322e.responseText==showErrorPanelMsg){
handleServerError("ERROR",_322e.responseText,true);
closeDialog();
loadoff();
return;
}
var xml=_322e.responseXML;
if(xml.firstChild.hasChildNodes()){
var _3230=xml.firstChild.childNodes;
for(var x=0;x<_3230.length;x++){
var node=_3230.item(x);
if(node.nodeName=="error"||node.nodeName=="warning"||node.nodeName=="info"){
var attrs=node.attributes;
var _3234="";
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="showInBanner"){
_3234=attr.nodeValue;
}
}
}
errorAlert("",node.firstChild.nodeValue,_3234,node.nodeName);
closeDialog();
loadoff();
return;
}
}
}
_321b=decodeURIComponent(_321b);
if((typeof _321b=="undefined"||_321b==CURRSHEETNAME)&&_321c=="false"){
showsheet(_322a,"open",false);
}
var attrs=xml.childNodes[0].attributes;
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="bridgeNum"){
bridgeNumber=attr.nodeValue;
}
}
}
if(_321c=="true"||ISMINDLG){
updateSheetAction(99,{SN:_321a,SHEETTOCOPY:_321b});
}
hideProgressMessage();
}
};
_322e.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
workbookData.copySheet=true;
workbookData.originalSheet=_3218;
workbookData.copiedSheet=_321a;
_3218=encodeURIComponent(_3218);
var _3237=getViewType();
if(jsREMOTE_VIEW){
_3237="REMOTE_SAVE_VIEW";
}
var nvp="sheetname="+encodeURIComponent(_321a)+"&sheetSel="+_3218+"&sheettocopy="+encodeURIComponent(_321b)+"&position="+_3219+"&value="+value+"&action="+_321f+"&curtime="+CURRENTTIME+"&docid="+DOCUMENT_ID;
nvp+="&afterRTC="+_321c+"&collabid="+COLLAB_ID+"&docowner="+CURR_DOC_OWNERNAME+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&viewType="+_3237+"&isDocSaved="+isDocSaved()+"&RMLOGINNAME="+RMUSER+"&fileFormat="+FILE_FORMAT;
sendXMLHTTPRequest(_322e,nvp,true,false);
IS_UNSAVED_SHEET=true;
}
}
function sheetmovement(_3239,_323a,_323b){
if(typeof _3239=="undefined"){
currentsheetname=getObj("onclicksheetname").value;
_323c=getObj("SelectedSheet").value;
_323b=false;
}else{
currentsheetname=_3239;
var _323c="";
}
var _323d=getObj("sheetsTab").getElementsByTagName("TD");
if(typeof _323a=="undefined"){
if(_323c=="-"){
showAlertDialog(jsTitleMsg.MoveProperLocation);
var pass="no";
document.getElementById("SelectedSheet").focus();
}else{
if(_323c=="MoveStart"){
_323a=0;
}else{
if(_323c=="MoveEnd"){
_323a=_323d.length-1;
}else{
for(var i=0;i<_323d.length-1;i++){
var _3240=_323d[i].getAttribute("sheetname");
if(_3240==_323c){
_323a=i+1;
}
}
}
}
}
}
if(pass!="no"){
closeDialog();
updateSheetOrder(currentsheetname,_323a,_323b);
nextsheetname=_323d[_323a].getAttribute("sheetname");
var _3241=document.getElementById("sheetdiv-"+currentsheetname);
if(_323c=="MoveEnd"||_323a==_323d.length-1){
var _3242=document.getElementById("dummySheetTab");
}else{
var _3242=document.getElementById("sheetdiv-"+nextsheetname);
}
_3241.parentNode.insertBefore(_3241,_3242);
}
}
function viewSheetCode(){
showMacroEditorDialog(currSheetOnRightClick,1,1);
}
var CHANGEDROWS=getObj("changedRows");
function storeChangedRows(val){
clearChangedRows();
getObj("changedRows").value=val;
}
function clearChangedRows(){
getObj("changedRows").value="";
}
function getChangedRows(){
if(getObj("changedRows").value.trim()!=""){
return getObj("changedRows").value.trim();
}else{
return null;
}
}
function closeDocument(_3244){
if(typeof _3244=="undefined"){
_3244=true;
}
if(savingInProgress||isDocumentLoading||isSheetLoading){
return;
}
if(jsTHROWAWAY_VIEW&&!jsGADGET_VIEW){
window.location.reload();
}else{
if(isMacroRecordPanelOpened){
hideMacroRecordPanel("Tagging.togglePanel()");
}else{
if(isMacroRecordPanelOpened){
hideMacroRecordPanel();
}
}
closePivotContent();
closeDialog();
closeDocumentInstance(_3244);
closeSheet();
hideSearchBar();
if(ISMINDLG){
closeEditorDialog();
}
documentLoadInit();
$("#fileName").text("");
updateDocTitle();
btn_disabled();
DOCUMENT_ID="doc_id";
noOfUpdateRequestInProgress=0;
loadoff();
getObj("openmessage").style.display="none";
}
}
function closeDocumentInstance(_3245,_3246){
if(isSaveToMyAccountCalled){
isSaveToMyAccountCalled=false;
return;
}
if(_3245&&(!SAVED||!MACROSAVED||RECORDINGMACRO)&&ALLOW_TO_WRITE){
checksaved("closeButton");
}else{
var nvp="curtime="+CURRENTTIME;
if(jsPUBLIC_VIEW&&isInOOMode){
nvp+="&tempPublicDocId="+tempPublicDocId;
}
if(_3246&&COLLAB_ID!=""&&COLLAB_ID!="null"){
nvp+="&collabId="+COLLAB_ID;
nvp+="&uname="+((jsREMOTE_SAVE_VIEW)?RMUSER:zuid);
}
nvp+="&viewType="+getViewType()+"&docowner="+CURR_DOC_OWNERNAME+"&docId="+DOCUMENT_ID;
var _3248=new getXmlhttp();
_3248.open("POST",ctxpath+"documentclose.do",false);
_3248.onreadystatechange=function(){
if(_3248.readyState==4){
}
};
_3248.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_3248.send(appendCSRFToURL(nvp));
}
}
function documentLoadInit(){
if(COLLAB_ID!=""&&COLLAB_ID!="null"){
Collaboration.quit(COLLAB_ID);
}
resetRTCvariables();
$.ZToolbarHandler.init(["#toolbarContainer","#popupmenu"]);
toolbarinited=false;
getCommentCalloutPropertyValues();
}
function closePivotContent(_3249){
if(pivotSheet){
try{
ZDBDialogUtil.closeDialog();
}
catch(e){
}
var _324a=getObj("dataTableToolbar");
var _324b=getObj("tabularDataWarning");
var _324c=getObj("pivotTableToolbar");
if(_324b!=null){
_324b.style.display="none";
_324b=null;
}
var _324d=getObj("ZDBPLACEHOLDER");
if(_324d!=null){
_324d.style.display="none";
_324d=null;
}
var _324e=getObj("freezeIcon");
if(_324e!=null){
_324e.style.display="none";
_324e=null;
}
var _324f=getObj("linkIcon");
if(_324f!=null){
_324f.style.display="none";
_324f=null;
}
var _3250=getObj("zdbDummyDIV");
if(_3250!=null){
_3250.style.display="none";
_3250=null;
}
var _3251=getObj("zdbDummyCell");
if(_3251!=null){
_3251.style.display="none";
_3251=null;
}
var _3252=getObj("tabEdit");
if(_3252!=null){
_3252.style.display="none";
_3252=null;
}
pivotSheet=false;
resetPageDim();
}
}
var SHEETNAMESLIST;
function getSheetsList(_3253,arg1,arg2,arg3,arg4,arg5,arg6){
var _325a=new getXmlhttp();
_325a.open("POST",ctxpath+"getSheets.do",false);
_325a.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var nvp="curtime="+CURRENTTIME+"&isDocSaved="+isDocSaved()+"&viewType="+getViewType()+"&docowner="+CURR_DOC_OWNERNAME+"&docId="+DOCUMENT_ID;
sendXMLHTTPRequest(_325a,nvp,true,true);
var _325c=_325a.responseText;
var _325d=_325c.split("~");
if(_325d[0]!="null"){
bridgeNumber=_325d[0];
var obj=getObj("bridgeNo");
if(obj){
obj.value=bridgeNumber;
}
}
SHEETNAMESLIST=_325d[1];
if(_3253=="insert"){
insertSheet(arg1,arg2,arg3,arg4,true);
}else{
if(_3253=="rename"){
renameSheet(arg1,arg2,arg3,true,arg4);
}else{
if(_3253=="duplicate"){
duplicatesheet(arg1,arg2,arg3,arg4,arg5,arg6,true);
}
}
}
}
function isDefinedSheet(_325f){
var tab=getObj("sheetsTab").getElementsByTagName("TD");
var _3261=new Array();
for(var i=0;i<tab.length-1;i++){
_3261[i]=tab[i].getAttribute("sheetname");
if(_3261[i].trim().toUpperCase()==_325f.trim().toUpperCase()){
return true;
}
}
return false;
}
function getI18NLastSavedMsg(date,count){
var _3265="";
if(date=="seconds"){
_3265=replaceParams(jsMsg.DurationInSeconds,new Array(count));
}else{
if(date=="minutes"){
_3265=replaceParams(jsMsg.DurationInMinutes,new Array(count));
}else{
if(date=="hours"){
_3265=replaceParams(jsMsg.DurationInHours,new Array(count));
}else{
if(date=="days"){
_3265=replaceParams(jsMsg.DurationInDays,new Array(count));
}
}
}
}
return _3265;
}
function stopLoadSheetObject(ctime){
var nvp="curtime="+ctime;
var _3268=new getXmlhttp();
sendXMLHTTPRequest(_3268,nvp,true,true,ctxpath+"documentclose.do");
}
var saveAsTemplateDialog="";
function showSaveAsTemplateDialog(srcEl){
if(ALL_SHEET_SHARED){
if(saveAsTemplateDialog.length==0){
saveAsTemplateDialog=getObj("saveastemplatemenudiv").innerHTML;
getObj("saveastemplatemenudiv").innerHTML="";
}
showDialog(saveAsTemplateDialog,"position=absmiddle,top=-150, srcElement="+srcEl+", title="+jsTitleMsg.SaveAsNewTemplate+",width=300, modal=yes");
if(getObj("saveAsTemplateMenuFileName")){
getObj("saveAsTemplateMenuFileName").value=$("#fileName").text();
getObj("saveAsTemplateMenuFileName").focus();
getObj("saveAsTemplateMenuFileName").select();
}
}
}
function saveasTemplate(){
if($("#fileName")!=null){
var _326a=getObj("saveAsTemplateMenuFileName");
var _326b=_326a.value;
add="yes";
doc_id="doc_id";
param="saveas";
_326b=_326b.trim();
if(_326b==null||_326b==""){
showAlertDialog(jsTitleMsg["InvalidMsg.TemplateName"]);
_326a.focus();
return false;
}
_326b=replaceDisallowedCharsInDocName(_326b);
_326b=encodeURIComponent(_326b);
showProgressMessage(jsMsg.Saving);
var nvp="fname="+_326b+"&ftype="+getObj("fileExt").value+"&doc_id="+doc_id+"&add="+add+"&param="+param+"&activesheet="+CURRSHEETNAME+"&curtime="+CURRENTTIME+"&unlock="+DOCUMENT_ID+"&oldname="+DOCUMENT_NAME+"&docowner="+CURR_DOC_OWNERNAME;
var _326d=new getXmlhttp();
_326d.open("POST","save.do",true);
_326d.onreadystatechange=function(){
if(_326d.readyState==4){
saved(_326d.responseXML,_326d.status,_326d.statusText,add);
}
};
nvp+="&is_public=false&doc_url="+DOCUMENT_NAME_URL+"&is_shared=false&is_template=true&rowHeight="+encodeURIComponent(getAryMetadata(rowHeightAry));
_326d.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
sendXMLHTTPRequest(_326d,nvp,true);
closeDialog();
}
}
function createNewTemplate(){
var url=document.location.href;
if(url.lastIndexOf("?")>0){
var _326f=url.substring(url.lastIndexOf("/")+1,url.lastIndexOf("?"));
var _3270=url.substring(url.lastIndexOf("=")+1);
if(url.lastIndexOf("&")>0){
var _3271=url.substring(url.lastIndexOf("=")+1);
}
}else{
_326f=url.substring(url.lastIndexOf("/")+1);
}
var _3272=(TEMPLATE_FLAG=="true")?"doctype=template&selectedFolderId=folder":"";
url=ctxpath+"home.do";
if(_3272){
url+="?"+_3272;
}
if(SAVED&&DOCUMENT_ID=="doc_id"){
document.location.href=url;
}else{
if(_326f=="open.do"||_326f=="home.do"){
window.open(url,"_blank");
}
}
TEMPLATE_FLAG="true";
CREATE_TEMPLATE_FROM_MENU="true";
}
function newDocFromTemplate(){
showURLInDialog("pages/newdocfromtemplate.jsp","title="+jsTitleMsg.SystemTemplatesTitle+",position=fixed,top=-130,modal=yes, width=285",CenterItem);
}
function toggleSystemOrMyTemplates(){
var _3273=getObj("toggleSysMyTemplId");
var _3274=_3273.options[_3273.options.selectedIndex].value;
if(_3274==0){
showMyTemplatesToDialog();
}else{
if(_3274==1){
showAlertDialog("Yet to bring system templates");
delColumn();
}
}
}
function showMyTemplatesToDialog(){
var _3275=new getXmlhttp();
var _3276=new Date().getTime();
var nTE=getObj("noTemplateDiv");
var tED=getObj("templateExistDiv");
_3275.onreadystatechange=function(){
if(_3275.readyState==4){
if(_3275.status==200){
if(_3275.responseXML==null||(!_3275.responseXML.hasChildNodes())){
nTE.style.display="";
tED.style.display="none";
}else{
nTE.style.display="none";
tED.style.display="";
showTemplateOnChange(_3275.responseXML);
}
}
}
};
_3275.open("POST","myDocs.do",true);
_3275.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var nvp="curTime="+_3276+"&sortval=modifydes&filterval=all&viewType=mytemplates";
sendXMLHTTPRequest(_3275,nvp,true,false,"");
}
function showTemplateOnChange(_327a){
var _327b=getObj("templatesListId");
delColumn();
if(_327a!=null||_327a.firstChild.hasChildNodes()){
var _327c=_327a.firstChild.childNodes;
for(var x=0;x<_327c.length;x++){
node=_327c.item(x);
if(node.nodeName=="document"){
var attrs=node.attributes;
doc_name=node.firstChild.nodeValue;
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="id"){
doc_id=attr.nodeValue;
}else{
if(attr.nodeName=="abspath"){
abspath=attr.nodeValue;
}else{
if(attr.nodeName=="creaTime"){
creaTime=attr.nodeValue;
}else{
if(attr.nodeName=="docOwner"){
doc_ownername=attr.nodeValue;
}
}
}
}
}
}
var _3281=document.createElement("option");
_3281.text=doc_name;
_3281.value=doc_id;
try{
_327b.add(_3281,null);
}
catch(ex){
_327b.add(_3281);
}
}
}
}
}
function openTemplateFromDialog(){
var _3282=getObj("filenameFieldId2");
var _3283=getObj("templatesListId");
if(_3282.value==""){
showAlertDialog(jsMsg.SelectTemplateToCreateDocument);
return false;
}else{
if(_3283.options.selectedIndex==-1){
showAlertDialog(jsMsg.SelectTemplateToCreateDocument);
return false;
}else{
var _3284=_3283.options[_3283.options.selectedIndex].value;
var _3285=_3282.value.trim();
if(_3285==null||_3285=="null"||_3285=="undefined"||_3285==""){
return;
}
_3285=encodeURIComponent(_3285);
var _3286=new getXmlhttp();
_3286.onreadystatechange=function(){
if(_3286.readyState==4){
if(_3286.status==200){
var _3287=_3286.responseText;
loadDocument(_3287);
}
}
};
var nvp=appendCSRFToURL("doc_change=true&mode=TemplToDoc&docid="+_3284+"&docname="+_3285);
postAjax(_3286,"sbTemplateAction.do",nvp);
return false;
}
}
}
function showFileNameOnChange(){
var _3289=getObj("templatesListId");
var _328a=getObj("filenameFieldId2");
var _328b=_3289.options[_3289.options.selectedIndex].text;
_328a.value=_328b;
_328a.select();
}
function delColumn(){
var _328c=getObj("templatesListId");
for(i=_328c.options.length;i>0;i--){
_328c.remove(_328c.options[i]);
}
}
function makeTemplatePublicConfirm(){
closeDialog();
showURLInDialog("pages/maketemplatepublic.jsp","width=500,position=absmiddle,top=-130,modal=yes,title="+jsTitleMsg.SharePublish,positionDialog);
}
function makeTemplatePublicSubmit(_328d){
var _328e;
if(DOCUMENT_ID=="doc_id"&&_328d!=""){
_328e=_328d;
}else{
if(_328d=="null"&&(DOCUMENT_ID!="doc_id"&&DOCUMENT_ID!="")){
_328e=DOCUMENT_ID;
}else{
if(_328d!="null"&&(DOCUMENT_ID!="doc_id"&&DOCUMENT_ID!="")){
_328e=_328d;
}
}
}
var _328f=false;
if(getObj("semipublic_confirmoption")!=null){
if(getObj("semipublic_confirmoption").checked){
_328f=false;
}else{
_328f=true;
}
}
var _3290=new getXmlhttp();
_3290.onreadystatechange=function(){
if(_3290.readyState==4){
if(_3290.responseText=="Not Authorized"){
showAlertDialog(jsTitleMsg.YouAreNotAuthorizedUserToMakeDocPublic);
return;
}
callpublic("Made Public",_3290.responseText);
public_view(_328f,"Public");
showURLInDialog("pages/maketemplatepublic.jsp?url="+doit(publicURL)+"&isSemi="+_328f,"width=500,position=absmiddle,top=-100,modal=yes,title="+jsTitleMsg.SharePublish,positionDialog);
}
};
var nvp="docs="+_328e+"&html=Make Public&semi="+_328f+"&doc_type=template";
sendXMLHTTPRequest(_3290,nvp,true,true,"makepublic.do");
isTemplatePublic=true;
}
function createTemplateFromUI(){
filenameFieldId=getObj("filenameFieldId1").value;
TEMPLATE_FLAG="true";
CREATE_TEMPLATE_FROM_UI="true";
sessionStorage.setItem("filename",filenameFieldId);
loadDocument("ajaxnew.do");
}
var temp_doc_ownername="";
commentCnt=0;
var viewFlag=false;
var cmt="";
var p="";
if(parent){
p=parent;
}else{
if(opener){
p=opener;
}else{
p=self;
}
}
function showSheetComments(_3292){
if(!transMode){
if(DOCUMENT_ID=="doc_id"){
if(parent){
parent.saveForward="comments";
parent.SAVED=false;
parent.savefile("autosave");
}else{
if(opener){
opener.saveForward="comments";
opener.SAVED=false;
opener.savefile("autosave");
}else{
saveForward="comments";
SAVED=false;
savefile("autosave");
}
}
return;
}
}
if(guestId==null){
guestId="";
}
if(guestId==""){
guestIdQueryStr="";
}else{
guestIdQueryStr="&guestId="+guestId;
}
try{
var _3293=ctxpath+"comments.do?doc_id="+DOCUMENT_ID+"&owner_name="+CURR_DOC_OWNERNAME+guestIdQueryStr+"&inside=yes&isEdit="+isEdit+"&view="+DOCUMENT_VIEW;
if(typeof (getObj("editorTheme").value)!="undefined"){
_3293+="&editorTheme="+getObj("editorTheme").value;
}
getObj("docPanelFrame").src=_3293;
}
catch(e){
}
}
function hideSheetComments(){
getObj("docPanel").style.display="none";
}
function deleteComment(nvp,id){
var _3296="";
var _3297=opener||parent;
if(_3297){
_3296=_3297.ctxpath;
}else{
_3296=ctxpath;
}
if(typeof _3296=="undefined"){
_3296="";
}
var _3298=new getXmlhttp();
_3298.onreadystatechange=function(){
if(_3298.readyState==4){
var _3299=_3298.responseXML;
if(_3299!=null&&_3299.hasChildNodes()&&_3299.firstChild.hasChildNodes()){
var _329a=_3299.firstChild.childNodes;
var _329b=false;
var _329c,_329d,_329e;
for(var x=0;x<_329a.length;x++){
node=_329a.item(x);
if(node.nodeName=="isEdit"){
_329b=node.firstChild.nodeValue;
}else{
if(node.nodeName=="id"){
_329c=node.firstChild.nodeValue;
}else{
if(node.nodeName=="creaTime"){
_329d=node.firstChild.nodeValue;
}else{
if(node.nodeName=="comment"){
_329e=node.firstChild.nodeValue;
}
}
}
}
}
if(_329b){
getObj("comment_text_div_"+_329c).value=_329e;
getObj("comment_text_"+_329c).innerHTML=_3297.escapeSpecialCharacters(_329e);
getObj("comment_on_"+_329c).innerHTML=_329d;
commentEditCancel(_329c);
return;
}
}
if(parent){
if(parent.guestId==null){
parent.guestId="";
}
if(parent.guestId==""){
guestIdQueryStr="";
}else{
guestIdQueryStr="&guestId="+parent.guestId;
}
if(DOC_ID==null||DOC_ID=="doc_id"||DOC_ID==""){
DOC_ID=parent.DOCUMENT_ID;
}
if(currOwnerName==null||currOwnerName==""){
currOwnerName=parent.CURR_DOC_OWNERNAME;
}
if(inside!=null&&inside!=""&&inside!="null"){
guestIdQueryStr+="&inside=yes";
}
var url=_3296+"comments.do?doc_id="+DOC_ID+"&owner_name="+currOwnerName+guestIdQueryStr+"&isEdit="+isEditor+"&view="+parent.DOCUMENT_VIEW;
if(typeof editorTheme!="undefined"){
url+="&editorTheme="+editorTheme;
}
window.location.replace(url);
}else{
if(opener){
if(opener.guestId==null){
parent.guestId="";
}
if(opener.guestId==""){
guestIdQueryStr="";
}else{
guestIdQueryStr="&guestId="+opener.guestId;
}
if(DOC_ID==null||DOC_ID=="doc_id"||DOC_ID==""){
DOC_ID=opener.DOCUMENT_ID;
}
if(currOwnerName==null||currOwnerName==""){
currOwnerName=opener.CURR_DOC_OWNERNAME;
}
if(inside!=null&&inside!=""){
guestIdQueryStr+="&inside=yes";
}
opener.getObj("docPanelFrame").src=_3296+"comments.do?doc_id="+DOC_ID+"&owner_name="+currOwnerName+guestIdQueryStr+"&isEdit="+isEditor+"&view="+opener.DOCUMENT_VIEW;
if(typeof editorTheme!="undefined"){
opener.getObj("docPanelFrame").src+="&editorTheme="+editorTheme;
}
}else{
if(guestId==null){
guestId="";
}
if(guestId==""){
guestIdQueryStr="";
}else{
guestIdQueryStr="&guestId="+guestId;
}
if(DOC_ID==null||DOC_ID=="doc_id"||DOC_ID==""){
DOC_ID=DOCUMENT_ID;
}
if(currOwnerName==null||currOwnerName==""){
currOwnerName=CURR_DOC_OWNERNAME;
}
if(inside!=null&&inside!=""){
guestIdQueryStr+="&inside=yes";
}
getObj("docPanelFrame").src="comments.do?doc_id="+DOC_ID+"&owner_name="+currOwnerName+guestIdQueryStr+"&isEdit="+isEditor+"&view="+DOCUMENT_VIEW;
if(typeof editorTheme!="undefined"){
opener.getObj("docPanelFrame").src+="&editorTheme="+editorTheme;
}
}
}
}
};
var _32a1="";
var _32a2=0;
var _32a3=false;
var _32a4=false;
if(opener){
_32a4=true;
_32a1=opener.DOCUMENT_NAME;
_32a2=opener.CURRENTTIME;
is_public=opener.isDocumentPublic;
is_semipublic=opener.isDocumentSemiPublic;
}else{
if(parent){
_32a3=true;
_32a1=parent.DOCUMENT_NAME;
_32a2=parent.CURRENTTIME;
is_public=parent.isDocumentPublic;
is_semipublic=parent.isDocumentSemiPublic;
}else{
_32a1=DOCUMENT_NAME;
_32a2=CURRENTTIME;
is_public=isDocumentPublic;
is_semipublic=isDocumentSemiPublic;
}
}
if(location.href.indexOf("inside=")!=-1){
if(location.href.indexOf("guestId=")!=-1){
is_public=true;
}
}else{
is_public=true;
}
nvp+="&docName="+_32a1;
if(COLLAB_ID!=""){
is_shared=true;
}else{
is_shared=false;
}
var _32a5=jsTRASH_VIEW?true:false;
nvp+="&is_public="+is_public+"&is_semipublic="+is_semipublic+"&is_shared="+is_shared+"&is_trashed="+_32a5+"&currtime="+_32a2;
_3298.open("POST",_3296+"save_doc_comment.do",true);
_3298.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");
_3298.setRequestHeader("Content-length",nvp.length);
sendXMLHTTPRequest(_3298,nvp,true,true,undefined,_32a3,_32a4);
}
function doc_comment_call(act,_32a7){
if(act=="Save"){
if(DOC_ID==null||DOC_ID=="doc_id"||DOC_ID==""){
if(typeof _32a7!="undefined"){
DOC_ID=_32a7;
}else{
if(parent){
DOC_ID=parent.DOCUMENT_ID;
}else{
if(opener){
DOC_ID=opener.DOCUMENT_ID;
}else{
DOC_ID=DOCUMENT_ID;
}
}
}
}
if(DOC_ID==null||DOC_ID==""||DOC_ID=="null"||DOC_ID=="doc_id"){
if(isEditor){
parent.SAVED=false;
return parent.saveDocument();
}else{
return parent.savefilessamp();
}
}else{
if(parent){
var str=getObj("comment_area").value;
}else{
var str=getObj("comment_area").value;
}
if(str.trim()!=""){
if(str.length>1000){
showAlertDialog(parent.replaceParams(parent.jsTitleMsg["Document.Comments.LengthExceed.AlertMessage"],new Array("1000")));
document.getElementById("comment_area").focus();
return;
}
nvp="type="+act+"&value="+encodeURIComponent(getObj("comment_area").value);
if(viewFlag){
if(getObj("commentAuthor").value==""){
getObj("commentAuthor").value="guest";
}
nvp+="&auth_by="+encodeURIComponent(getObj("commentAuthor").value)+"&auth_id=2";
}else{
nvp+="&auth_by="+currUserName+"&auth_id="+currUserId;
}
nvp+="&document_id="+DOC_ID;
if(currOwnerName==null||currOwnerName==""){
nvp+="&owner_name="+parent.CURR_DOC_OWNERNAME;
}else{
nvp+="&owner_name="+currOwnerName;
}
getObj("comment_area").value="";
deleteComment(nvp);
}
}
}else{
if(act=="Load"){
if(_32a7==null||_32a7==""||_32a7=="null"||_32a7=="doc_id"){
showAlertDialog(jsTitleMsg.TheSpreadsheetIsNotYetSaved+" "+jsTitleMsg.SaveAndContinue);
}else{
nvp="type="+act+"&document_id="+_32a7+"&owner_name="+parent.CURR_DOC_OWNERNAME;
nvp+="&document_id="+DOC_ID;
deleteComment(nvp);
}
}else{
if(act=="Delete"){
if(currOwnerName==null||currOwnerName==""){
owner_name="&owner_name="+parent.CURR_DOC_OWNERNAME;
}else{
owner_name="&owner_name="+currOwnerName;
}
nvp="type="+act+"&comment_id="+_32a7+owner_name;
nvp+="&document_id="+DOC_ID;
deleteComment(nvp,_32a7);
}
}
}
}
function commentEdit(id){
getObj("comment_on_"+id).style.display="none";
getObj("comment_textarea_"+id).style.display="";
getObj("edit_"+id).style.display="none";
getObj("cancel_edit_"+id).style.display="";
getObj("save_edit_"+id).style.display="";
getObj("comment_text_"+id).style.display="none";
getObj("comment_textarea_"+id).focus();
}
function commentEditCancel(id){
getObj("comment_on_"+id).style.display="";
getObj("comment_textarea_"+id).value=getObj("comment_text_div_"+id).value;
getObj("comment_textarea_"+id).style.display="none";
getObj("edit_"+id).style.display="";
getObj("cancel_edit_"+id).style.display="none";
getObj("save_edit_"+id).style.display="none";
getObj("comment_text_"+id).style.display="";
}
function commentEditSave(id){
var owner="";
if(currOwnerName==null||currOwnerName==""){
if(parent){
owner=parent.CURR_DOC_OWNERNAME;
}else{
owner=CURR_DOC_OWNERNAME;
}
}else{
owner=currOwnerName;
}
var _32ad=getObj("comment_textarea_"+id).value;
_32ad=_32ad.trim();
if(_32ad!=""){
nvp="type=Edit&comment_id="+id+"&owner_name="+owner+"&value="+encodeURIComponent(_32ad);
nvp+="&document_id="+DOC_ID;
deleteComment(nvp);
}else{
commentEditCancel(id);
}
}
var rangeEditText="";
var rangeCnt=0;
var rangeEditValue="";
var rangeEditURL="";
function makepublishdialog(_32ae,type){
if(isUnRegisteredUser){
showAlertDialog(replaceParams(jsTitleMsg["IAMError.unconfirmeduser"],[userEmail]));
return;
}
closeDialog();
if(typeof type!="undefined"){
pubType=type;
}
if(_32ae=="fromPublic"){
publicURL=getServerPath()+location.href.substring(location.href.indexOf("/",SERVERSCHEME.length));
if(type=="org"){
showURLInDialog(ctxpath+"pages/makepublish.jsp?url="+doit(publicURL)+"&isPublic=true&isSemi="+isDocumentSemiPublic+"&callFrom=fromPublic&showFormulas="+showFormulasOrg+"&allowExport="+allowExportOrg+"&publicPolicy="+publicPolicy+"&showPublic="+showPublic,"width=500,position=absmiddle,top=-130,title="+jsTitleMsg.EmbedToWebsiteBlog,positionDialog);
}else{
if(zoid==-1){
showURLInDialog(ctxpath+"pages/makepublish.jsp?url="+doit(publicURL)+"&isPublic=true&isSemi="+isDocumentSemiPublic+"&callFrom=fromPublic&showFormulas="+showFormulas+"&allowExport="+allowExportPublic+"&publicPolicy="+publicPolicy+"&showPublic="+showPublic,"width=500,position=absmiddle,top=-130,title="+jsTitleMsg.EmbedToWebsiteBlog,positionDialog);
}else{
showURLInDialog(ctxpath+"pages/makepublish.jsp?url="+doit(publicURL)+"&isPublic=true&isSemi="+isDocumentSemiPublic+"&callFrom=fromPublic&showFormulas="+showFormulasOrg+"&allowExport="+allowExportOrg+"&publicPolicy="+publicPolicy+"&showPublic="+showPublic,"width=500,position=absmiddle,top=-130,title="+jsTitleMsg.EmbedToWebsiteBlog,positionDialog);
}
}
}else{
if(DOCUMENT_ID=="doc_id"){
saveForward="makepublishdialog";
return savefilessamp();
}
if(pubType=="org"&&isDocumentSemiPublic){
showURLInDialog(ctxpath+"pages/makepublish.jsp?url="+doit(publicURL)+"&isPublic=true&showURL=yes&isSemi="+isDocumentSemiPublic+"&showFormulas="+showFormulasOrg+"&allowExport="+allowExportOrg+"&publicPolicy="+publicPolicy+"&showPublic="+showPublic+"&type="+pubType,"width=500,position=absmiddle,top=-70,modal=yes,title="+jsTitleMsg.EmbedToWebsiteBlog,positionDialog);
}else{
if(pubType!="org"&&isDocumentPublic){
if(zoid==-1){
showURLInDialog(ctxpath+"pages/makepublish.jsp?url="+doit(publicURL)+"&isPublic=true&showURL=yes&isSemi="+isDocumentSemiPublic+"&showFormulas="+showFormulas+"&allowExport="+allowExportPublic+"&publicPolicy="+publicPolicy+"&showPublic="+showPublic+"&type="+pubType,"width=500,position=absmiddle,top=-70,modal=yes,title="+jsTitleMsg.EmbedToWebsiteBlog,positionDialog);
}else{
showURLInDialog(ctxpath+"pages/makepublish.jsp?url="+doit(publicURL)+"&isPublic=true&showURL=yes&isSemi="+isDocumentSemiPublic+"&showFormulas="+showFormulasOrg+"&allowExport="+allowExportOrg+"&publicPolicy="+publicPolicy+"&showPublic="+showPublic+"&type="+pubType,"width=500,position=absmiddle,top=-70,modal=yes,title="+jsTitleMsg.EmbedToWebsiteBlog,positionDialog);
}
}else{
makepublishconfirm(pubType);
}
}
}
}
function makepublishconfirm(type){
closeDialog();
var title="";
if(type=="org"){
if(orgDisplayName==null||orgDisplayName==""||orgDisplayName=="Organization"){
title=jsTitleMsg.EmbedwithinOrganization;
}else{
title=replaceParams(jsTitleMsg.EmbedwithinDomain,new Array(orgDisplayName));
}
}else{
if(type=="external"){
title=jsTitleMsg.EmbedToWebsiteBlog;
}else{
title=jsTitleMsg.EmbedToWebsiteBlog;
}
}
if(DOCUMENT_NAME=="untitled"||DOCUMENT_NAME_URL=="untitled"||(DOCUMENT_NAME_URL.indexOf("untitled-")==0&&parseInt(DOCUMENT_NAME_URL.split("untitled-")[1]))){
var _32b2=showPromptDialog(jsTitleMsg.RenameWhilePublish,$("#fileName").text(),"Yes","No");
if(_32b2!=null&&_32b2!=DOCUMENT_NAME){
renameDocument(_32b2,type);
}else{
showURLInDialog(ctxpath+"pages/makepublish.jsp?publicPolicy="+publicPolicy+"&type="+type+"&allowExportOrg="+allowExportOrg+"&showFormulasOrg="+showFormulasOrg,"width=500,position=absmiddle,top=-150,modal=yes,title="+title,positionDialog);
}
}else{
showURLInDialog(ctxpath+"pages/makepublish.jsp?publicPolicy="+publicPolicy+"&type="+type+"&allowExportOrg="+allowExportOrg+"&showFormulasOrg="+showFormulasOrg,"width=500,position=absmiddle,top=-150,modal=yes,title="+title,positionDialog);
}
}
function makepublishsubmit(type){
if(type=="org"&&!isDocumentSemiPublic){
var _32b4=false;
var _32b5=getObj("semipublic_confirmoption");
if(_32b5!=null){
if(_32b5.checked){
_32b4=false;
}else{
_32b4=true;
}
}
showFormulasOrg=true;
var _32b6=getObj("public_formulaoption");
if(_32b6!=null){
if(_32b6.checked){
showFormulasOrg=false;
}else{
showFormulasOrg=true;
}
}
allowExportOrg=true;
var _32b7=getObj("public_exportoption");
if(_32b7!=null){
if(_32b7.checked){
allowExportOrg=true;
}else{
allowExportOrg=false;
}
}
var _32b8=getObj("public_allowOrgEditoption");
if(_32b8!=null){
if(_32b8.checked){
allowOrgEdit=true;
}else{
allowOrgEdit=false;
}
}
showPublic=true;
showPublic="false";
var _32b9=new getXmlhttp();
_32b9.onreadystatechange=function(){
if(_32b9.readyState==4){
var _32ba=_32b9.responseText;
if(_32ba==="Unconfirmed user"){
showAlertDialog(replaceParams(jsTitleMsg["IAMError.unconfirmeduser"],[userEmail]));
return;
}else{
if(_32b9.responseText==="Not Authorized"){
showAlertDialog(jsTitleMsg.YouAreNotAuthorizedUserToMakeDocPublic);
return;
}
}
isDocumentSemiPublic=true;
publicURL=_32b9.responseText;
makepublishdialog("showURL",type);
}
};
closeDialog();
var nvp="docs="+DOCUMENT_ID+"&html=Make Public&semi="+_32b4+"&docName="+encodeURIComponent(DOCUMENT_NAME)+"&showFormulas="+showFormulasOrg+"&allowExport="+allowExportOrg+"&publicPolicy="+publicPolicy+"&showPublic="+showPublic+"&type="+type+"&allowOrgEdit="+allowOrgEdit;
sendXMLHTTPRequest(_32b9,nvp,true,true,ctxpath+"makepublic.do");
}else{
if(!isDocumentPublic){
var _32b4=false;
var _32b5=getObj("semipublic_confirmoption");
if(_32b5!=null){
if(_32b5.checked){
_32b4=false;
}else{
_32b4=true;
}
}
showFormulas=true;
var _32b6=getObj("public_formulaoption");
if(_32b6!=null){
if(_32b6.checked){
showFormulas=false;
}else{
showFormulas=true;
}
}
allowExportPublic=true;
var _32b7=getObj("public_exportoption");
if(_32b7!=null){
if(_32b7.checked){
allowExportPublic=true;
}else{
allowExportPublic=false;
}
}
allowExportOrg=allowExportPublic;
showFormulasOrg=showFormulas;
showPublic=true;
if(type=="org"){
showPublic="false";
_32b4="true";
}else{
if(type=="external"){
showPublic="true";
if(_32b5==null){
_32b4="false";
}
}else{
var _32bc=getObj("showPublicOption");
if(_32bc!=null){
if(_32bc.checked){
showPublic=true;
}else{
showPublic=false;
}
}
}
}
var _32b9=new getXmlhttp();
_32b9.onreadystatechange=function(){
if(_32b9.readyState==4){
var _32bd=_32b9.responseText;
if(_32bd==="Unconfirmed user"){
showAlertDialog(replaceParams(jsTitleMsg["IAMError.unconfirmeduser"],[userEmail]));
return;
}
if(_32bd==="Not Authorized"){
showAlertDialog(jsTitleMsg.YouAreNotAuthorizedUserToMakeDocPublic);
return;
}
isDocumentPublic=true;
isDocumentSemiPublic=_32b4;
publicURL=_32b9.responseText;
makepublishdialog("showURL",type);
}
};
closeDialog();
var nvp="docs="+DOCUMENT_ID+"&html=Make Public&semi="+_32b4+"&docName="+encodeURIComponent(DOCUMENT_NAME)+"&showFormulas="+showFormulas+"&allowExport="+allowExportPublic+"&publicPolicy="+publicPolicy+"&showPublic="+showPublic+"&type="+type;
sendXMLHTTPRequest(_32b9,nvp,true,true,ctxpath+"makepublic.do");
}else{
closeDialog();
makepublishdialog("",type);
}
}
}
function rangePublish(type,_32bf){
if(isUnRegisteredUser){
showAlertDialog(replaceParams(jsTitleMsg["IAMError.unconfirmeduser"],[userEmail]));
return;
}
if(pivotSheet){
if(ZDBClientUI.selectedTab.view.type=="Table"){
showAlertDialog(jsTitleMsg["Pivot.PublishRangeisNotSupported"]);
}else{
showAlertDialog(jsTitleMsg["Pivot.PublishRangeisNotSupported"]);
}
return;
}
closeDialog();
if(_32bf){
var _32c0=ctxpath+"pages/rangesnippet.jsp?action=confirm";
if(type=="org"&&orgDisplayName!=null&&orgDisplayName!=""&&orgDisplayName!="Organization"){
_32c0+="&orgname="+orgDisplayName;
}
if(typeof type!="undefined"){
_32c0+="&type="+type;
}
showURLInDialog(_32c0,"width=500, position=absmiddle, top=-100, modal=yes, title="+jsTitleMsg.PublishRange,positionDialog);
return;
}
if(DOCUMENT_ID!=null&&DOCUMENT_ID!="doc_id"&&DOCUMENT_ID!="DOCUMENT_ID"&&DOCUMENT_ID!=""){
var range=getCellRange();
var _32c2=range.startRow;
var _32c3=range.startCol;
var _32c4=range.endRow;
var _32c5=range.endCol;
var _32c6=getCell(_32c4,_32c5);
if(_32c6==null){
_32c6=getCell(getAvailableEndRow(),getAvailableEndCol());
}
cellColspan=_32c6.colSpan;
if(cellColspan>1){
_32c5=_32c5+cellColspan-1;
}
var _32c7=30;
var _32c8=30;
message(jsMsg.Loading,"block","...");
for(i=_32c2;i<=_32c4;i++){
_32c7+=getRowHeight(i);
}
for(i=_32c3;i<=_32c5;i++){
_32c8+=getColWidth(i);
}
range=_32c2+":"+_32c3+":"+_32c4+":"+_32c5;
dyn_updation="yes";
col_head="yes";
cell_width="yes";
borders="yes";
row_num="yes";
var _32c9="doc_id="+DOCUMENT_ID+"&sheet_name="+encodeURIComponent(CURRSHEETNAME);
_32c9+="&range="+range+"&type="+type;
var _32ca=new getXmlhttp();
_32ca.onreadystatechange=function(){
if(_32ca.readyState==4){
var _32cb=_32ca.responseText;
if(_32cb==="Unconfirmed user"){
message("","none");
showAlertDialog(replaceParams(jsTitleMsg["IAMError.unconfirmeduser"],[userEmail]));
return;
}
if(_32cb=="Not Authorized to publish externally"){
showAlertDialog(jsTitleMsg["Publish.Alert.NotAuthorizedToPublishExternally"]);
return;
}
var src="";
src=SERVERSCHEME+SERVERNAME;
if(SERVERPORT!="80"&&SERVERPORT!="443"){
src+=":"+SERVERPORT;
}
if(type=="org"){
publishURL=src+ctxpath+"publishrange.org?id="+_32ca.responseText;
}else{
publishURL=src+ctxpath+"publishrange.do?id="+_32ca.responseText;
}
publishDlg="<iframe src='"+publishURL+"' frameborder='0' style='height:"+_32c7+"px;width:"+_32c8+"px' marginwidth='0' marginheight='0' scrolling='auto'>&nbsp;</iframe>";
message(jsMsg.Loading,"none");
if(type=="external"){
type="public";
}else{
if(type=="org"){
type="org";
}
}
showRangePublishURL(publishURL,"rangepublish",_32c7,_32c8,type,_32ca.responseText);
}
};
sendXMLHTTPRequest(_32ca,_32c9,true,true,ctxpath+"rangepublish.do");
}else{
saveForward="rangepublish";
savefilessamp();
}
}
function showPublishedRange(){
closeDialog();
if(DOCUMENT_ID!=null&&DOCUMENT_ID!="doc_id"&&DOCUMENT_ID!="DOCUMENT_ID"){
message(jsMsg.Loading,"block","...");
var _32cd="doc_id="+DOCUMENT_ID+"&sheet_name="+CURRSHEETNAME+"&orgName="+orgDisplayName;
var _32ce=new getXmlhttp();
_32ce.onreadystatechange=function(){
if(_32ce.readyState==4){
message(jsMsg.Loading,"none");
isRangeDialog=true;
showDialog(_32ce.responseText,"position=absmiddle, title="+jsTitleMsg.PublishedRanges+", modal=no, closeOnEscKey=no","",closePublsihedRangeDialog);
}
};
postAjax(_32ce,ctxpath+"showpublishrange.do",_32cd);
}else{
showAlertDialog(jsTitleMsg.NoRangesPublishedFromThisSheet);
}
}
function closePublsihedRangeDialog(){
isRangeEdit=false;
closeDialog();
resetCellRangeFill("publishedRange");
}
var callFrom="";
function rangePublishActions(cnt,_32d0,id,_32d2,_32d3,_32d4,_32d5,from){
callFrom=from;
if(_32d0=="Remove"){
a=showConfirmDialog(jsTitleMsg["RangePublish.ShowPublishedRangeDialog.RevertRangePublishAlert.ConfirmMsg"]);
if(a){
var _32d7="doc_id="+DOCUMENT_ID+"&type=Remove&id="+id+"&from="+from;
var _32d8=new getXmlhttp();
_32d8.onreadystatechange=function(){
if(_32d8.readyState==4){
if(typeof cnt!="undefined"){
getObj("RangeRow_"+cnt).style.display="none";
getObj("SnippetRow_"+cnt).style.display="none";
}else{
closeDialog();
}
if(_32d8.responseText=="-1"){
closeDialog();
}
}
};
sendXMLHTTPRequest(_32d8,_32d7,true,true,ctxpath+"updatepublishrange.do");
if(rangeEditText=="range_text_"+cnt){
resetCellRangeFill("publishedRange");
}
}
}else{
if(_32d0=="Cancel_Edit"){
isRangeEdit=false;
rangeEditText="";
rangeEditURL="";
getObj("edit_"+cnt).style.display="";
getObj("cancel_edit_"+cnt).style.display="none";
getObj("range_span_"+cnt).style.display="";
getObj("range_text_"+cnt).value=rangeEditValue;
getObj("range_text_"+cnt).style.display="none";
getObj("update_"+cnt).style.display="none";
getObj("remove_"+cnt).style.display="";
resetCellRangeFill("publishedRange");
}else{
if(_32d0=="Edit"){
isRangeEdit=true;
rangeEditText="range_text_"+cnt;
rangeEditURL=id;
for(i=1;i<=parseInt(rangeCnt);i++){
if(i!=cnt){
getObj("edit_"+i).style.display="";
getObj("cancel_edit_"+i).style.display="none";
getObj("range_span_"+i).style.display="";
getObj("range_text_"+i).style.display="none";
getObj("update_"+i).style.display="none";
getObj("remove_"+i).style.display="";
}
getObj("SnippetRow_"+i).style.display="none";
getObj("hide_snippet_"+i).style.display="none";
getObj("show_snippet_"+i).style.display="";
}
getObj("edit_"+cnt).style.display="none";
getObj("cancel_edit_"+cnt).style.display="";
getObj("range_span_"+cnt).style.display="none";
rangeEditValue=getObj("range_text_"+cnt).value;
getObj("range_text_"+cnt).style.display="";
getObj("range_text_"+cnt).focus();
getObj("update_"+cnt).style.display="";
getObj("remove_"+cnt).style.display="none";
val=getObj("range_text_"+cnt).value;
arr=val.split("!");
if(arr[0]==CURRSHEETNAME){
arr=arr[1].split(":");
st=getCellPosByLabel(arr[0]);
scol=st.col;
srow=st.row;
if(arr.length==2){
en=getCellPosByLabel(arr[1]);
ecol=en.col;
erow=en.row;
}else{
ecol=scol;
erow=srow;
}
focusCellRangeFill(srow,scol,erow,ecol);
}else{
clearCellRangeFill();
}
}else{
if(_32d0=="Update"){
if(getObj("range_text_"+cnt).value==""){
showAlertDialog(jsTitleMsg.SpecifyValidRangeToUpdate);
return;
}
val=getObj("range_text_"+cnt).value;
arr=val.split("!");
if(arr.length!=2){
showAlertDialog(jsTitleMsg.SpecifyValidRangeToUpdate);
return;
}
var temp=0;
var _32df=getObj("sheetsTab").getElementsByTagName("TD");
for(var i=0;i<_32df.length-1;i++){
if(_32df[i].getAttribute("sheetname")!=null){
var _32e0=_32df[i].getAttribute("sheetname");
if(_32e0==arr[0]){
temp=1;
}
}
}
if(temp==0){
showAlertDialog(jsTitleMsg.SpecifyValidSheetName);
return;
}
if(arr[0]==""||arr[1]==""){
showAlertDialog(jsTitleMsg.SpecifyValidRangeToUpdate);
return;
}
arr1=arr[1].split(":");
if(arr1.length>2){
showAlertDialog(jsTitleMsg.SpecifyValidRangeToUpdate);
return;
}
var scol=-1;
var srow=-1;
var ecol=-1;
var erow=-1;
if(arr1.length==2){
if(arr1[0]==""||arr1[1]==""){
showAlertDialog(jsTitleMsg.SpecifyValidRangeToUpdate);
return;
}
st=getCellPosByLabel(arr1[0]);
scol=st.col;
srow=st.row;
en=getCellPosByLabel(arr1[1]);
ecol=en.col;
erow=en.row;
}else{
if(arr1.length==1){
if(arr1[0]==""){
showAlertDialog(jsTitleMsg.SpecifyValidRangeToUpdate);
return;
}
st=getCellPosByLabel(arr1[0]);
scol=st.col;
srow=st.row;
ecol=scol;
erow=srow;
}
}
if(arr[0]==CURRSHEETNAME){
var _32e1=30;
var _32e2=30;
_32e1+=getRowTop(erow)+getRowHeight(erow)-getRowTop(srow);
for(i=scol;i<=ecol;i++){
_32e2+=getColWidth(i);
}
var src="";
src=SERVERSCHEME+SERVERNAME;
if(SERVERPORT!="80"&&SERVERPORT!="443"){
src+=":"+SERVERPORT;
}
src+=ctxpath;
if(callFrom=="org"){
src+="publishrange.org?id="+id;
}else{
src+="publishrange.do?id="+id;
}
src="<iframe src='"+src+"' frameborder='0' style='height:"+_32e1+"px;width:"+_32e2+"px' marginwidth='0' marginheight='0' scrolling='auto'>&nbsp;</iframe>";
getObj("picPublishURL_"+cnt).value=src;
}
var _32d7="doc_id="+DOCUMENT_ID+"&type=Update&id="+id+"&sheet="+arr[0];
_32d7+="&srow="+srow+"&scol="+scol+"&erow="+erow+"&ecol="+ecol+"&from="+from;
var _32d8=new getXmlhttp();
_32d8.onreadystatechange=function(){
if(_32d8.readyState==4){
isRangeEdit=false;
rangeEditText="";
getObj("edit_"+cnt).style.display="";
getObj("cancel_edit_"+cnt).style.display="none";
getObj("range_span_"+cnt).style.display="";
getObj("range_span_"+cnt).innerHTML=getObj("range_text_"+cnt).value;
getObj("range_text_"+cnt).style.display="none";
getObj("update_"+cnt).style.display="none";
getObj("remove_"+cnt).style.display="";
}
};
sendXMLHTTPRequest(_32d8,_32d7,true,true,ctxpath+"updatepublishrange.do");
resetCellRangeFill("publishedRange");
}else{
if(_32d0=="ShowSnippet"){
for(i=1;i<=parseInt(rangeCnt);i++){
if(i!=cnt){
getObj("SnippetRow_"+i).style.display="none";
getObj("hide_snippet_"+i).style.display="none";
getObj("show_snippet_"+i).style.display="";
}
getObj("edit_"+i).style.display="";
getObj("cancel_edit_"+i).style.display="none";
getObj("range_span_"+i).style.display="";
getObj("range_text_"+i).style.display="none";
getObj("update_"+i).style.display="none";
getObj("remove_"+i).style.display="";
}
val=getObj("range_text_"+cnt).value;
arr=val.split("!");
arr1=arr[1].split(":");
var scol=-1;
var srow=-1;
var ecol=-1;
var erow=-1;
if(arr1.length==2){
if(arr1[0]==""||arr1[1]==""){
showAlertDialog(jsTitleMsg.SpecifyValidRangeToUpdate);
return;
}
st=getCellPosByLabel(arr1[0]);
scol=st.col;
srow=st.row;
en=getCellPosByLabel(arr1[1]);
ecol=en.col;
erow=en.row;
}else{
if(arr1.length==1){
if(arr1[0]==""){
showAlertDialog(jsTitleMsg.SpecifyValidRangeToUpdate);
return;
}
st=getCellPosByLabel(arr1[0]);
scol=st.col;
srow=st.row;
ecol=scol;
erow=srow;
}
}
if(arr[0]==CURRSHEETNAME){
var _32e1=30;
var _32e2=30;
_32e1+=getRowTop(erow)+getRowHeight(erow)-getRowTop(srow);
for(i=scol;i<=ecol;i++){
_32e2+=getColWidth(i);
}
var src="";
src=SERVERSCHEME+SERVERNAME;
if(SERVERPORT!="80"&&SERVERPORT!="443"){
src+=":"+SERVERPORT;
}
src+=ctxpath;
if(callFrom=="org"){
src+="publishrange.org?id="+id;
}else{
src+="publishrange.do?id="+id;
}
src="<iframe src='"+src+"' frameborder='0' style='height:"+_32e1+"px;width:"+_32e2+"px' scrolling='auto' marginwidth='0' marginheight='0'>&nbsp;</iframe>";
getObj("picPublishURL_"+cnt).value=src;
}else{
var src="";
src=SERVERSCHEME+SERVERNAME;
if(SERVERPORT!="80"&&SERVERPORT!="443"){
src+=":"+SERVERPORT;
}
src+=ctxpath;
if(callFrom=="org"){
src+="publishrange.org?id="+id;
}else{
src+="publishrange.do?id="+id;
}
src="<iframe src='"+src+"' frameborder='0' style='height:100%;width:100%' scrolling='auto' marginwidth='0' marginheight='0'>&nbsp;</iframe>";
getObj("picPublishURL_"+cnt).value=src;
}
getObj("SnippetRow_"+cnt).style.display="";
getObj("picPublishURL_"+cnt).focus();
getObj("hide_snippet_"+cnt).style.display="";
getObj("show_snippet_"+cnt).style.display="none";
}else{
if(_32d0=="HideSnippet"){
getObj("SnippetRow_"+cnt).style.display="none";
getObj("hide_snippet_"+cnt).style.display="none";
getObj("show_snippet_"+cnt).style.display="";
}
}
}
}
}
}
}
function setPublishRange(){
if(isRangeEdit&&rangeEditText!=""){
if(!isCellRange()){
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
getObj(rangeEditText).value=CURRSHEETNAME+"!"+getCellLabel(row,col);
}else{
var _32e7=getCellRange();
var _32e8=_32e7.startRow;
var _32e9=_32e7.startCol;
var _32ea=_32e7.endRow;
var _32eb=_32e7.endCol;
getObj(rangeEditText).value=CURRSHEETNAME+"!"+getCellLabel(_32e8,_32e9)+":"+getCellLabel(_32ea,_32eb);
}
}
}
function updateRangeEnter(_32ec,ev){
var _32ee;
var _32ef;
if(window.event){
_32ee=window.event.keyCode;
}else{
if(ev){
_32ee=ev.which;
}
}
if(_32ee==13){
var arr=_32ec.id.split("_");
rangePublishActions(arr[2],"Update",rangeEditURL,"","","","",callFrom);
}else{
if(_32ee==27){
var arr=_32ec.id.split("_");
rangePublishActions(arr[2],"Cancel_Edit",rangeEditURL,"","","","",callFrom);
return false;
}else{
if(_32ee==0){
return false;
}
}
}
}
function callpublic(id,val){
var html="";
if(DOCUMENT_ID=="doc_id"){
if(id=="Make Semi Public"){
saveForward="makesemipublic";
return savefilessamp();
}else{
if(id=="Make Public"){
saveForward="makepublic";
return savefilessamp();
}
}
}
var _32f4="";
if(id=="Make Public"){
showURLInDialog(ctxpath+"pages/publish.jsp","width=500, position=absmiddle, top=-100, modal=yes, title="+jsTitleMsg.SharePublish,positionDialog);
}else{
if(id=="Made Public"){
publicURL=val;
if(publicURL!=null&&publicURL!=""){
if(zoid==-1){
publishURL=publicURL.replace("/public/","/publish/");
}else{
publishURL=publicURL+"/embed";
}
publishURL="<iframe src='"+publishURL+"' frameborder='0' scrolling='no' style='height:400px;width:500px'>&nbsp;</iframe>";
}
cnt=0;
}else{
if(id=="Made Publish"){
publicURL=val;
var temp="";
var _32f7=publicURL.length;
var cnt=0;
if(publicURL.length>50){
while(_32f7>cnt){
if(_32f7<cnt+50){
temp+=publicURL.substring(cnt,_32f7);
}else{
temp+=publicURL.substring(cnt,cnt+50);
}
temp+="<br>";
cnt+=50;
}
}else{
temp=val;
}
publishURL="";
if(publicURL!=null&&publicURL!=""){
if(zoid==-1){
publishURL=publicURL.replace("/public/","/publish/");
}else{
publishURL=publicURL+"/embed";
}
publishURL="<iframe src='"+publishURL+"' frameborder='0' scrolling='no' style='height:400px;width:500px'>&nbsp;</iframe>";
}
}else{
if(id=="Cancel Public"){
isDocumentPublic=false;
isDocumentSemiPublic=false;
}
}
}
}
getObj("PUBLICURL").value=publicURL;
}
function changepublic(){
var _32f8="yes";
if(getObj("semipublic_optionurl")!=null){
if(getObj("semipublic_optionurl").checked){
_32f8="no";
}
}
var _32f9=new getXmlhttp();
_32f9.onreadystatechange=function(){
if(_32f9.readyState==4){
var _32fa=_32f9.responseText;
if(_32fa==="Unconfirmed user"){
showAlertDialog(replaceParams(jsTitleMsg["IAMError.unconfirmeduser"],[userEmail]));
return;
}else{
if(_32fa=="Not Authorized"){
showAlertDialog(jsTitleMsg.YouAreNotAuthorizedUser);
return;
}
}
if(_32f8=="yes"){
isDocumentSemiPublic=true;
}else{
isDocumentSemiPublic=false;
}
}
};
var nvp="docs="+DOCUMENT_ID+"&html=Change Public&semi="+_32f8+"&docName="+encodeURIComponent(DOCUMENT_NAME);
sendXMLHTTPRequest(_32f9,nvp,true,true,ctxpath+"makepublic.do");
}
function showembedblog(){
if(getObj("embedblog").style.display=="none"){
getObj("embedblog").style.display="";
getObj("embedblog_btn_exp").style.display="";
getObj("embedblog_btn_col").style.display="none";
}else{
getObj("embedblog").style.display="none";
getObj("embedblog_btn_exp").style.display="none";
getObj("embedblog_btn_col").style.display="";
}
}
function changepublicOptions(obj,_32fd,_32fe){
var _32ff=true;
if(obj!=null){
if(_32fd!="ALLOWEXPORT"&&obj.checked){
_32ff=false;
}else{
if(_32fd=="ALLOWEXPORT"&&obj.checked){
_32ff=true;
}else{
if(_32fd=="ALLOWEXPORT"&&!obj.checked){
_32ff=false;
}else{
if(_32fd=="SHOWPUBLIC"){
if(obj.checked){
showPublic=true;
}else{
showPublic=false;
}
}
}
}
}
if(_32fd=="ALLOWORGEDIT"){
if(obj.checked){
_32ff=true;
}else{
_32ff=false;
}
}
}
var _3300=new getXmlhttp();
_3300.onreadystatechange=function(){
if(_3300.readyState==4){
var _3301=_3300.responseText;
if(_3301==="Unconfirmed user"){
showAlertDialog(replaceParams(jsTitleMsg["IAMError.unconfirmeduser"],[userEmail]));
return;
}
if(_3301=="Not Authorized"){
showAlertDialog(jsTitleMsg.YouAreNotAuthorizedUser);
return;
}
if(_32fe=="org"){
if(_32fd=="ALLOWEXPORT"){
allowExportOrg=_32ff;
}else{
if(_32fd=="SHOWFORMULAS"){
showFormulasOrg=_32ff;
}else{
if(_32fd=="ALLOWORGEDIT"){
allowOrgEdit=_32ff;
}
}
}
}else{
if(_32fd=="ALLOWEXPORT"){
allowExportPublic=_32ff;
allowExportOrg=_32ff;
}else{
if(_32fd=="SHOWFORMULAS"){
showFormulas=_32ff;
showFormulasOrg=_32ff;
}else{
if(_32fd=="ALLOWORGEDIT"){
allowOrgEdit=_32ff;
}
}
}
}
}
};
var nvp="toSpace="+_32fe;
if(_32fd=="SHOWPUBLIC"&&!obj.checked){
nvp+="&docs="+DOCUMENT_ID+"&html=Remove Public";
}else{
if(_32fd=="SHOWPUBLIC"&&obj.checked){
nvp+="&docs="+DOCUMENT_ID+"&html=Add Public";
}else{
nvp+="&docs="+DOCUMENT_ID+"&html=Change Options&propertyName="+_32fd+"&propertyValue="+_32ff;
}
}
sendXMLHTTPRequest(_3300,nvp,true,true,ctxpath+"makepublic.do");
}
var UNDO=0;
var REDO=0;
var undoRedoLock=false;
function resetUNDO(){
UNDO=0;
REDO=0;
undoRedoLock=false;
disableREDO();
disableUNDO();
}
function setREDO(_3303){
REDO=_3303;
enableREDO();
}
function putUNDO(){
UNDO=UNDO+1;
}
function setUNDO(_3304){
UNDO=_3304;
enableUNDO();
}
function addUNDO(){
UNDO=UNDO+1;
}
function getREDO(){
if(REDO==0){
disableREDO();
return false;
}
REDO=REDO-1;
if(REDO==0){
disableREDO();
}
return true;
}
function getUNDO(){
if(UNDO==0){
disableUNDO();
return false;
}
UNDO=UNDO-1;
if(UNDO==0){
disableUNDO();
}
return true;
}
var callRedo=false;
function redo(_3305,_3306,_3307){
if(isUndefined(_3305)){
_3305="false";
if(undoRedoLock){
return;
}
if(getREDO()==false){
repeat.doAction(repeat.LASTACTIONJSON,false);
return;
}
}
if(typeof _3305=="undefined"){
_3305="false";
}
sendUndoRequest("redo",_3305,_3306,_3307);
}
function sendUndoRequest(_3308,_3309,_330a,_330b){
undoRedoLock=true;
showProgressMessage(jsMsg.Updating);
var _330c=new getXmlhttp();
_330c.open("POST",ctxpath+"undo.do",true);
_330c.onreadystatechange=function(){
if(_330c.readyState==4){
noOfUpdateRequestInProgress--;
if(_330c.status==200){
if(_3308=="redo"){
gridListener.listen(3);
}else{
gridListener.listen(2);
}
if(_330c.responseXML!=null){
updateCell(_330c.responseXML,_330c.status,_330c.statusText,undefined,undefined,_3309);
}
}
undoRedoLock=false;
hideProgressMessage();
}
};
var _330d="actionmode="+_3308;
_330d+="&view="+getObj("VIEW").value;
_330d+="&documentid="+DOCUMENT_ID;
_330d+="&currenttime="+CURRENTTIME;
_330d+="&currentsheet="+encodeURIComponent(CURRSHEETNAME);
_330d+="&bridgeNumber="+bridgeNumber;
if("true"==_3309){
_330d+="&U_FN="+_330a;
_330d+="&U_AO="+_330b;
}
_330d+="&afterRTC="+_3309+"&"+csrfParamName+"="+csrfToken;
_330d+="&documentowner="+CURR_DOC_OWNERNAME;
_330d+="&collabid="+COLLAB_ID;
_330d+="&readwrite="+ALLOW_TO_WRITE;
_330d+="&stock="+isStockConfigured;
_330d+="&isdocsaved="+isDocSaved();
_330d+="&isSameSheet="+ISSAMESHEET;
_330d+="&rtcSheetName="+encodeURIComponent(RTCSHEETNAME);
_330d+="&collabediting="+COLLABORATIVE_EDITING;
if(jsREMOTE_SAVE_VIEW){
_330d+="&remoteEditorUser="+RMUSER;
_330d+="&userStateId="+USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _330e=getObj("apiKey");
if(_330e!=null){
_330d+="&apiKey="+_330e.value;
}
}
_330d+="&startRow="+(getAvailableStartRow());
_330d+="&endRow="+getAvailableEndRow();
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
_330d+="&freezedRow="+FREEZED_ROW;
}
_330d+="&totCols="+totCols;
_330c.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_330c.send(_330d);
noOfUpdateRequestInProgress++;
}
var callUndo=false;
function undo(_330f,_3310,_3311){
if(isUndefined(_330f)){
_330f="false";
if(undoRedoLock){
return;
}
if(getUNDO()==false){
return;
}
}
if(isCellEdited()&&_330f=="false"){
callUndo=true;
submitCell();
return;
}
sendUndoRequest("undo",_330f,_3310,_3311);
}
function enableUNDO(){
if(jsGADGET_VIEW||jsTHROWAWAY_VIEW){
return;
}
if(!pivotSheet){
$("#undo").enable();
}
if(UNDO==0){
disableUNDO();
return;
}
}
function disableUNDO(){
if(jsGADGET_VIEW||jsTHROWAWAY_VIEW){
return;
}
if(!pivotSheet){
$("#undo").disable();
}
}
function enableREDO(){
if(jsGADGET_VIEW||jsTHROWAWAY_VIEW){
return;
}
if(!pivotSheet){
$("#redo").enable();
}
if(REDO==0){
disableREDO();
return;
}
}
function disableREDO(){
if(jsGADGET_VIEW||jsTHROWAWAY_VIEW){
return;
}
if(!pivotSheet){
$("#redo").disable();
}
}
var fromUndo=false;
function updateUndoRangeJson(_3312,_3313){
var _3314=eval("("+_3312+")");
var _3315;
for(var x in _3314){
if(!isUndefined(_3314[x].ARRAYDETAILS)){
var arr=_3314[x].ARRAYDETAILS;
if(typeof (arr)=="string"&&arr=="EMPTY"){
arrayDetails=new Array();
}else{
arrayDetails=arr;
}
}
if(!isUndefined(_3314[x].a)){
var _3318=_3314[x];
switch(_3314[x].a){
case ActionConstants.INSERT_COPY_ROW:
getCharts(DOCUMENT_ID,CURRSHEETNAME,"REGENERATE");
break;
case ActionConstants.INSERT_COPY_COLUMN:
if(_3318.fu){
deleteCol(_3318.dsc,_3318.dec-_3318.dsc+1,true,true);
getCharts(DOCUMENT_ID,CURRSHEETNAME,"REGENERATE");
if(_3313!="true"){
if(_3318.sc<_3318.dsc){
focusCellRangeFill(_3318.er,_3318.ec,_3318.sr,_3318.sc,false);
}else{
focusCellRangeFill(_3318.er,_3318.ec-_3318.cnt,_3318.sr,_3318.sc-_3318.cnt,false);
}
insertCopyCols=true;
}else{
blurColHead(_3318.dsc,_3318.dsc+_3318.cnt);
}
}else{
insertCol("before",_3318.dsc,_3318.dec-_3318.dsc+1,false,true,true,undefined,undefined,undefined,undefined,true);
getCharts(DOCUMENT_ID,CURRSHEETNAME,"REGENERATE");
if(_3313!="true"){
hideFlashDIV();
}
}
if(_3313!="true"){
focusCol(_3318.dsc,_3318.dec);
}else{
blurColHead(_3318.dsc,_3318.dsc+_3318.cnt);
}
break;
case ActionConstants.INSERT_CUT_ROW:
getCharts(DOCUMENT_ID,CURRSHEETNAME,"REGENERATE");
break;
case ActionConstants.INSERT_CUT_COLUMN:
if(_3318.fu){
if(_3318.ias){
deleteCol(_3318.dsc,_3318.dec-_3318.dsc+1,true,true);
getCharts(DOCUMENT_ID,CURRSHEETNAME,"REGENERATE");
if(_3313!="true"){
focusCellRangeFill(_3318.er,_3318.ec,_3318.sr,_3318.sc,false);
focusCol(_3318.dsc,_3318.dec);
}else{
blurColHead(_3318.dsc,_3318.dsc+_3318.cnt);
}
}else{
insertCol("before",_3318.sc,_3318.ec-_3318.sc+1,false,true,true,undefined,undefined,undefined,undefined,true);
deleteCol(_3318.dsc,_3318.dec-_3318.dsc+1,true,true);
getCharts(DOCUMENT_ID,CURRSHEETNAME,"REGENERATE");
}
if(_3313!="true"){
insertCutCols=true;
cutStatus=true;
if(!(_3318.ias)){
copyRangeEndCol+=_3318.cnt;
copyRangeStartCol+=_3318.cnt;
}
if(_3318.sc<_3318.dsc){
focusCellRangeFill(_3318.er,_3318.ec,_3318.sr,_3318.sc,false);
focusCol(_3318.dsc-_3318.cnt,_3318.dec-_3318.cnt);
blurColHead(_3318.dsc,_3318.dec);
}else{
focusCellRangeFill(_3318.er,_3318.ec-_3318.cnt,_3318.sr,_3318.sc-_3318.cnt,false);
focusCol(_3318.dsc,_3318.dec);
blurColHead(_3318.sc,_3318.ec);
}
}else{
blurColHead(_3318.dsc,_3318.dsc+_3318.cnt);
blurColHead(_3318.sc,_3318.sc+_3318.cnt);
}
}else{
if(_3318.ias){
insertCol("before",_3318.dsc,_3318.dec-_3318.dsc+1,false,true,true,undefined,undefined,undefined,undefined,true);
getCharts(DOCUMENT_ID,CURRSHEETNAME,"REGENERATE");
if(_3313!="true"){
focusCol(_3318.dsc,_3318.dec);
}else{
blurColHead(_3318.dsc,_3318.dsc+_3318.cnt);
}
}else{
insertCol("before",_3318.dsc,_3318.dec-_3318.dsc+1,false,true,true,undefined,undefined,undefined,undefined,true);
deleteCol(_3318.sc,_3318.ec-_3318.sc+1,true,true);
getCharts(DOCUMENT_ID,CURRSHEETNAME,"REGENERATE");
if(_3313!="true"){
if(_3318.sc<_3318.dsc){
focusCol(_3318.dsc-_3318.cnt,_3318.dec-_3318.cnt);
blurColHead(_3318.sc,_3318.ec);
}else{
focusCol(_3318.dsc,_3318.dec);
blurColHead(_3318.sc,_3318.ec);
blurColHead(_3318.sc+_3318.cnt,_3318.ec+_3318.cnt);
}
}else{
blurColHead(_3318.sc,_3318.sc+_3318.cnt);
}
}
if(_3313!="true"){
insertCutCols=false;
hideFlashDIV();
}
}
break;
default:
var _3319=updateRangeJson(_3314[x]);
if(_3319){
return _3319;
}
}
}
if(!isUndefined(_3314[x].CONDITIONALFORMAT)){
var obj=_3314[x].CONDITIONALFORMAT;
for(var y in obj){
updateCFChangesInHtmlClient(obj[y],_3313,encodeURIComponent(CURRSHEETNAME));
}
}
}
}
function showWebDataDialog(){
if(DOCUMENT_ID!="doc_id"){
showURLInDialog(ctxpath+"pages/externaldata.jsp","title="+jsTitleMsg.ExternalDataDialog+", position=absolute, srcElement=td_moreactions, width=550",fillsheetNames);
isExtDataDialogOpened=true;
tempwebDataUrl="";
webdataUrlType="csv";
extDatamode="configure";
}else{
saveForward="showWebDataDialog";
savefilessamp();
}
}
var webdataUrlType="csv";
var tempwebDataUrl="";
var extDatamode="";
function externalDataUrlWizard(){
getObj("schDiv").style.display="none";
getObj("dataDiv").style.display="none";
getObj("locDiv").style.display="none";
getObj("urlDiv").style.display="";
setclassForTabs("urlTab");
}
function externalDataLocationWizard(){
getObj("urlDiv").style.display="none";
getObj("schDiv").style.display="none";
getObj("dataDiv").style.display="none";
getObj("locDiv").style.display="";
setclassForTabs("locTab");
setBackVal();
}
function setBackVal(){
if(webdataUrlType=="csv"||webdataUrlType=="rss"){
getObj("locBack").onclick=new Function("evt","externalDataUrlWizard()");
}else{
getObj("locBack").onclick=new Function("evt","externalDataSelectionWizard()");
}
}
function externalDataSelectionWizard(){
var wurl="";
if(extDatamode!="edit"){
wurl=getObj("webdataurl").value;
}else{
wurl=getObj("webdataurl_edit").value;
}
if(tempwebDataUrl!=wurl){
tempwebDataUrl=wurl;
var _331d=new getXmlhttp();
_331d.open("POST",ctxpath+"webdata.do",true);
_331d.onreadystatechange=function(){
if(_331d.readyState==4){
showDataSelectionWizard(_331d.responseXML);
}
};
var _331e=getAvailableStartRow();
var _331f=getAvailableEndRow();
_331d.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var nvp=("doc_id="+DOCUMENT_ID+"&mode=parseHtml&webdataurl="+encodeURIComponent(wurl)+"&view="+getObj("VIEW").value+"&currenttime="+CURRENTTIME+"&isDocSaved="+SAVED+"&availableStartRow="+_331e+"&availableEndRow="+_331f);
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
sendXMLHTTPRequest(_331d,nvp,true);
message(jsMsg.Loading,"block","...");
}else{
showDataSelectionWizard(null);
}
}
function showDataSelectionWizard(_3321){
if(_3321!=null){
var _3322=_3321.firstChild.childNodes;
for(var x=0;x<_3322.length;x++){
node=_3322.item(x);
if(node.nodeName=="sheet"){
var attrs=node.attributes;
var _3325=node.childNodes[0].nodeValue;
if(_3325=="NoTableAvailable"||_3325==""){
getObj("selectalltable").style.display="none";
getObj("htmltables").innerHTML=getObj("nodatawarningdiv").innerHTML;
}else{
if(_3325=="UrlNotReachable"){
getObj("selectalltable").style.display="none";
getObj("htmltables").innerHTML=getObj("noreachwarningdiv").innerHTML;
}else{
getObj("selectalltable").style.display="";
getObj("htmltables").innerHTML=node.childNodes[0].nodeValue;
}
}
}
}
}
if(extDatamode=="edit"&&edithtml!="null"){
selectHtmlEditTables();
}else{
getObj("urlDiv").style.display="none";
getObj("locDiv").style.display="none";
getObj("schDiv").style.display="none";
getObj("dataDiv").style.display="";
setclassForTabs("dataTab");
}
message("","none");
}
function externalDataScheduleWizard(){
getObj("urlDiv").style.display="none";
getObj("locDiv").style.display="none";
getObj("dataDiv").style.display="none";
getObj("schDiv").style.display="";
setclassForTabs("schTab");
}
function toggleURLType(type){
var _3327=getObj("csv_hint");
var _3328=getObj("rss_hint");
var _3329=getObj("others_hint");
if(type=="csv"||type=="rss"){
webdataUrlType=type;
if(type=="csv"){
_3328.style.display="none";
_3327.style.display="";
}
if(type=="rss"){
_3327.style.display="none";
_3328.style.display="";
}
_3329.style.display="none";
getObj("dataTab").style.display="none";
getObj("urlNext").onclick=new Function("evt","externalDataLocationWizard()");
}else{
webdataUrlType="html";
getObj("dataTab").style.display="";
_3327.style.display="none";
_3328.style.display="none";
_3329.style.display="";
getObj("urlNext").onclick=new Function("evt","externalDataSelectionWizard()");
}
}
function toggleExtDataTables(type){
var i=0;
while(getObj("scraptbl_"+i)){
if(getObj("scraptbl_"+i).parentNode.parentNode.parentNode.parentNode.style.display!="none"){
toggleExtDataTable(i,type);
toggleExtDataFields(i,(type=="all"));
}
i++;
}
}
function toggleExtDataTable(_332c,type){
getObj("scraptbl_"+_332c).checked=(type=="all");
}
function toggleExtDataFields(_332e,state){
var i=0;
while(getObj("scraptbl_"+_332e+"_"+i)){
getObj("scraptbl_"+_332e+"_"+i).checked=state;
i++;
}
}
function deSelectExtDataTables(el){
var id=el.id;
var state=el.checked;
var _3334=parseInt(id.substring(id.indexOf("_")+1,id.lastIndexOf("_")));
var _3335=parseInt(id.substring(id.lastIndexOf("_")+1,id.length));
var _3336=false;
var i=0;
while(getObj("scraptbl_"+_3334+"_"+i)){
if(getObj("scraptbl_"+_3334+"_"+i).checked){
_3336=true;
break;
}
i++;
}
if(!_3336){
toggleExtDataTable(_3334,"");
}else{
toggleExtDataTable(_3334,"all");
}
}
function toggleScheduleType(type){
if(webdataUrlType=="csv"){
getObj("periodicinterval").value="30min-webData";
}else{
getObj("periodicinterval").value="1hr-webData";
}
getObj("schedule").style.display=(type=="once"||type=="everyopen")?"none":"";
}
var currSchedulePeriod="";
function toggleSchedulePeriod(type){
if(currSchedulePeriod!=type){
getObj("schedule_"+currSchedulePeriod).style.display="none";
getObj("schedule_"+type).style.display="";
currSchedulePeriod=type;
}
}
var isExtDataDialogOpened;
function setExtDataStartCell(){
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
if(isExtDataDialogOpened&&getObj("webdatacell")){
getObj("webdatacell").value=getCellLabel(row,col);
}
if(extDatamode=="edit"&&getObj("webdatacell_edit")){
getObj("webdatacell_edit").value=getCellLabel(row,col);
}
}
function toggleOptionalComment(state){
getObj("optional_comment_div").style.display=(state)?"":"none";
}
function toggleNotifyUser(state){
getObj("notify_user_email").style.display=(state)?"":"none";
}
function fillsheetNames(){
var _333f=getObj("sheetsTab").getElementsByTagName("TD");
sheetCount=0;
for(var i=0;i<_333f.length-1;i++){
if(_333f[i].getAttribute("sheetname")!=null){
sheetName=_333f[i].getAttribute("sheetname");
opt=document.createElement("option");
opt.value=sheetName;
if(sheetName==CURRSHEETNAME){
opt.selected=true;
}
opt.appendChild(document.createTextNode(sheetName));
if(extDatamode=="edit"){
document.getElementById("webdatasheet_edit").appendChild(opt);
getObj("webdataurl_edit").focus();
}else{
document.getElementById("webdatasheet").appendChild(opt);
getObj("webdataurl").focus();
}
}
}
positionDialog();
}
function setclassForTabs(_3341){
var _3342=getObj("urlTab");
if(_3342.className!="notCrossed"){
_3342.className="crossed";
_3342.onclick=new Function("evt","externalDataUrlWizard()");
}
var _3343=getObj("dataTab");
if(_3343.className!="notCrossed"){
_3343.className="crossed";
_3343.onclick=new Function("evt","externalDataSelectionWizard()");
}
var _3344=getObj("locTab");
if(_3344.className!="notCrossed"){
_3344.className="crossed";
_3344.onclick=new Function("evt","externalDataLocationWizard()");
}
var _3345=getObj("schTab");
if(_3345.className!="notCrossed"){
_3345.className="crossed";
_3345.onclick=new Function("evt","externalDataScheduleWizard()");
}
var _3346=getObj(_3341);
_3346.className="current";
_3346.onclick="";
}
function savewebData(){
var _3347=getObj("webdataurl").value;
if(!isValidURL(_3347)){
showAlertDialog(jsTitleMsg.PleaseProvideValidDataurl);
return;
}
var _3348=getObj("webdatacell").value;
if(_3348==""){
showAlertDialog(jsTitleMsg.StartCellCannotBeEmpty);
return;
}
var _3349="";
if(webdataUrlType=="html"){
_3349=getSelectTables();
if(_3349==""){
showAlertDialog(jsTitleMsg.PleaseSelectAtleastOneTable);
return;
}
}
var _334a=getObj("webdatasheet").value;
var mode=webdataUrlType+"save";
var _334c="";
var _334d=getObj("task_type_schedule");
if(_334d!=null&&_334d.checked){
_334c=getScheduleName();
}
var _334e=getAvailableStartRow();
var _334f=getAvailableEndRow();
if(_334a!=CURRSHEETNAME){
showsheet(getObj("sheetdiv-"+_334a),"open");
}
_3347=encodeURIComponent(_3347);
var nvp="doc_id="+DOCUMENT_ID+"&webdataurl="+_3347+"&webdatasheet="+_334a+"&webdatacell="+_3348;
nvp+="&webdatainterval="+_334c+"&mode="+mode+"&bridgeNo="+bridgeNumber+"&currenttime="+CURRENTTIME+"&selecttbls="+_3349;
nvp+="&documentOwner="+CURR_DOC_OWNERNAME+"&collabId="+COLLAB_ID+"&afterRTC=false&view="+getObj("VIEW").value;
nvp+="&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING+"&isDocSaved="+SAVED+"&availableStartRow="+_334e+"&availableEndRow="+_334f;
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
importxml(ctxpath+"webdata.do",setWebData,true,"POST",nvp);
closeDialog();
showProgressMessage(jsMsg.UpdatingWebdata,true);
}
function savewebData_enter(evt){
if(webdataUrlType=="html"){
if(window.event){
evt=window.event;
}
if(evt.keyCode==13){
externalDataSelectionWizard();
}
}else{
if(window.event){
evt=window.event;
}
if(evt.keyCode==13){
externalDataLocationWizard();
}
}
}
function getSelectTables(){
var _3352="";
var tblNo=0;
count=0;
var _3354=new Array();
while(document.getElementById("scraptbl_"+tblNo)){
if(document.getElementById("scraptbl_"+tblNo).checked){
_3354[count]=tblNo;
count++;
var _3355=new Array();
var colNo=0;
colCount=0;
tempcolNo=0;
while(document.getElementById("scraptbl_"+tblNo+"_"+colNo)){
var _3357=0;
if(document.getElementById("scraptbl_"+tblNo+"_"+colNo+"_colspan").colSpan){
_3357=document.getElementById("scraptbl_"+tblNo+"_"+colNo+"_colspan").colSpan;
}
if(document.getElementById("scraptbl_"+tblNo+"_"+colNo).checked){
_3355[colCount]=tempcolNo;
colCount++;
for(i=1;i<_3357;i++){
_3355[colCount]=tempcolNo+1;
colCount++;
tempcolNo++;
}
}else{
for(i=1;i<_3357;i++){
tempcolNo++;
}
}
tempcolNo++;
colNo++;
}
_3352=_3352+"&selectcols_"+tblNo+"="+_3355;
}
tblNo++;
}
return _3354+_3352;
}
function setWebData(_3358,_3359,_335a,val){
if(_3359>=300){
showAlertDialog(jsTitleMsg.ProblemInConfiguringWebData);
return;
}
gridListener.listen(10);
if(_3358==null){
return;
}
updateCell(_3358,_3359,_335a,"webData");
}
function refreshWebData(_335c,_335d){
closeDialog();
if(_335d!=CURRSHEETNAME){
showsheet(getObj("sheetdiv-"+_335d),"open");
}
var _335e=getAvailableStartRow();
var _335f=getAvailableEndRow();
var nvp="doc_id="+DOCUMENT_ID+"&webdataid="+_335c+"&webdatasheet="+_335d+"&mode=refresh"+"&bridgeNo="+bridgeNumber;
nvp+="&currenttime="+CURRENTTIME+"&documentOwner="+CURR_DOC_OWNERNAME+"&collabId="+COLLAB_ID+"&afterRTC=false";
nvp+="&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING+"&view="+getObj("VIEW").value+"&isDocSaved="+SAVED+"&availableStartRow="+_335e+"&availableEndRow="+_335f;
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
importxml(ctxpath+"webdata.do",setWebData,true,"POST",nvp);
setProgressMessage(jsMsg.UpdatingWebdata);
}
function showWebDataDetails(){
if(DOCUMENT_ID!="doc_id"){
if(ALL_SHEET_SHARED){
message(jsMsg.Loading,"block","...");
versionDetailsNo++;
showURLInDialog(ctxpath+"pages/remotedatalist.jsp?docid="+DOCUMENT_ID+"&versionDetailsNo="+versionDetailsNo+"&curtime="+CURRENTTIME,"title="+jsTitleMsg.ExternalDataDetails+",height=150, width=700, srcElement=td_moreactions, position=absolute",positionDialog);
}
}else{
saveForward="showWebDataDetails";
savefilessamp();
}
}
function deleteWebData(_3361,_3362){
var _3363=getAvailableStartRow();
var _3364=getAvailableEndRow();
var nvp="doc_id="+DOCUMENT_ID+"&webdatasheet="+_3361+"&webdatacell="+_3362+"&mode=delete&view="+getObj("VIEW").value+"&isDocSaved="+SAVED+"&availableStartRow="+_3363+"&availableEndRow="+_3364;
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
importxml(ctxpath+"webdata.do",showWebDataDetails,true,"POST",nvp);
}
var ewcellid,editurl,editsheet,editcell,edithtml,editsch;
function editWebData(val,eurl,_3368,ecell,ehtml,esch){
tempwebDataUrl="";
extDatamode="edit";
ewcellid=val;
editurl=eurl;
editsheet=_3368;
editcell=ecell;
edithtml=ehtml;
editsch=esch;
showURLInDialog(ctxpath+"pages/externaldataedit.jsp","title="+jsTitleMsg.EditExternalData+", position=absolute, srcElement=td_moreactions, width=550",fillEditDetails);
}
function fillEditDetails(){
fillsheetNames();
webdataUrlType="csv";
if(edithtml!="null"){
webdataUrlType="html";
getObj("edit_datatab").style.display="";
}
getObj("webdataurl_edit").value=editurl;
getObj("webdatasheet_edit").value=editsheet;
getObj("webdatacell_edit").value=editcell;
if(webdataUrlType=="html"){
externalDataSelectionWizard();
}
selectEditSchedule();
}
function selectEditSchedule(){
if(editsch!="-"){
getObj("task_type_schedule").checked=true;
if(editsch.indexOf("daily")!=-1){
toggleScheduleType("daily");
getObj("repeatinterval").value="daily";
toggleSchedulePeriod("daily");
var _336c=editsch.split("_");
getObj("dailytime").value=getTimeHrs(_336c[1]);
}else{
if(editsch.indexOf("weekly")!=-1){
toggleScheduleType("weekly");
getObj("repeatinterval").value="weekly";
toggleSchedulePeriod("weekly");
var _336d=editsch.split("_");
getObj("weeklyinterval").value=_336d[1];
getObj("weeklytime").value=getTimeHrs(_336d[2]);
}else{
if(editsch.indexOf("monthly")!=-1){
toggleScheduleType("monthly");
getObj("repeatinterval").value="monthly";
toggleSchedulePeriod("monthly");
var _336e=editsch.split("_");
getObj("monthlyinterval").value=_336e[1];
getObj("monthlytime").value=getTimeHrs(_336e[2]);
}else{
toggleScheduleType("periodic");
getObj("periodicinterval").value=editsch;
}
}
}
}
}
function selectHtmlEditTables(){
message("","none");
var tbls=edithtml.split("-");
for(i=0;i<tbls.length;i++){
var _3370=tbls[i].split(",");
for(j=1;j<_3370.length;j++){
var _3371=getObj("scraptbl_"+_3370[0]).parentNode.parentNode.parentNode.parentNode;
if(_3371){
_3371.style.display="";
}
if(getObj("scraptbl_"+_3370[0]+"_"+_3370[j])){
getObj("scraptbl_"+_3370[0]+"_"+_3370[j]).checked=true;
deSelectExtDataTables(getObj("scraptbl_"+_3370[0]+"_"+_3370[j]));
}
}
}
}
function showEditUrlPage(){
getObj("edit_urltab").className="selected";
getObj("edit_datatab").className="";
getObj("edit_schtab").className="";
getObj("editDiv").style.display="";
getObj("editschDiv").style.display="none";
getObj("editdataDiv").style.display="none";
}
function showEditDataPage(){
getObj("edit_urltab").className="";
getObj("edit_datatab").className="selected";
getObj("edit_schtab").className="";
getObj("editDiv").style.display="none";
getObj("editschDiv").style.display="none";
getObj("editdataDiv").style.display="";
externalDataSelectionWizard();
}
function showEditSchedulePage(){
getObj("edit_urltab").className="";
getObj("edit_datatab").className="";
getObj("edit_schtab").className="selected";
getObj("editDiv").style.display="none";
getObj("editschDiv").style.display="";
getObj("editdataDiv").style.display="none";
}
function canceleditWebData(val){
showWebDataDetails();
}
function updateWebData(){
message("","none");
wdCellId=ewcellid;
var _3373=getObj("webdataurl_edit").value;
if(_3373==""){
showAlertDialog(jsTitleMsg.PleaseProvideValidDataurl);
return;
}
var _3374=getObj("webdatasheet_edit").value;
var _3375=getObj("webdatacell_edit").value;
if(_3375==""){
showAlertDialog(jsTitleMsg.StartCellCannotBeEmpty);
return;
}
var _3376="";
if(getObj("task_type_schedule").checked){
_3376=getScheduleName();
}
var tblNo=0;
count=0;
var _3378=new Array();
var _3379="";
if(webdataUrlType=="html"){
mode="htmlsave";
_3379=getSelectTables();
if(_3379==""){
showAlertDialog(jsTitleMsg.PleaseSelectAtleastOneTable);
return;
}
}
closeDialog();
if(_3374!=CURRSHEETNAME){
showsheet(getObj("sheetdiv-"+_3374),"open");
}
_3373=encodeURIComponent(_3373);
var _337a=getAvailableStartRow();
var _337b=getAvailableEndRow();
var nvp="doc_id="+DOCUMENT_ID+"&webdatacellid="+wdCellId+"&webdataurl="+_3373+"&webdatasheet="+_3374+"&webdatacell="+_3375;
nvp+="&webdatainterval="+_3376+"&mode=edit"+"&bridgeNo="+bridgeNumber+"&currenttime="+CURRENTTIME+"&selecttbls="+_3379;
nvp+="&documentOwner="+CURR_DOC_OWNERNAME+"&collabId="+COLLAB_ID+"&afterRTC=false";
nvp+="&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING+"&view="+getObj("VIEW").value+"&isDocSaved="+SAVED+"&availableStartRow="+_337a+"&availableEndRow="+_337b;
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
importxml(ctxpath+"webdata.do",setWebData,true,"POST",nvp);
setProgressMessage(jsMsg.UpdatingWebdata);
}
function getScheduleName(){
var _337d=getObj("repeatinterval").value;
if(_337d=="periodic"){
return getObj("periodicinterval").value;
}else{
if(_337d=="daily"){
var dtime=getObj("dailytime").value;
return "daily_"+getTimeMinutes(dtime);
}else{
if(_337d=="weekly"){
var wtime=getObj("weeklytime").value;
var wday=getObj("weeklyinterval").value;
return "weekly_"+wday+"_"+getTimeMinutes(wtime);
}else{
if(_337d=="monthly"){
var mtime=getObj("monthlytime").value;
var mday=getObj("monthlyinterval").value;
return "monthly_"+mday+"_"+getTimeMinutes(mtime);
}
}
}
}
}
function getTimeMinutes(time){
var _3384=time.split(":");
var _3385=parseInt(_3384[0]*60)+parseInt(_3384[1]);
return _3385;
}
function getTimeHrs(time){
var hrval=parseInt(time)/60+":"+parseInt(time)%60;
return hrval;
}
var image_urls="";
var printOptions="";
var FROMEXPORT=false;
var EXPORTTYPE="";
var TEMPPRTVAR="";
function exportDoc(type,prt,_338a){
if(!allowExport&&prt!="print"){
return;
}
if(pivotSheet){
if(type==".html"&&prt=="print"){
if(ZDBClientUI.selectedTab.view.type=="Table"){
showAlertDialog(jsTitleMsg["Print not supported for this table view."]);
}else{
showAlertDialog(jsTitleMsg["Pivot.PrintNotSupportedForTableOrChart"]);
}
return false;
}
if(type==".csv"||type==".tsv"||type==".xml"||type==".html"||type==".xhtml"){
if(ZDBClientUI.selectedTab.view.type=="Table"){
showAlertDialog(jsTitleMsg["Pivot.ExportNotSupportedForTableView"]);
}else{
showAlertDialog(jsTitleMsg["Pivot.ExportNotSupportedForPivotTableOrChart"]);
}
return false;
}else{
var a=showConfirmDialog(jsTitleMsg["Pivot.ExportNotSupportedDoYouWantToContinue"]);
if(!a){
return false;
}
}
}
if(jsNEW_DOC_VIEW||jsOPEN_DOC_VIEW||jsSHARE_VIEW){
if(DOCUMENT_ID=="doc_id"&&prt!="print"&&SAVED){
return;
}
FROMEXPORT=false;
EXPORTTYPE="";
TEMPPRTVAR="";
if(!SAVED&&ALLOW_TO_WRITE){
FROMEXPORT=true;
EXPORTTYPE=type;
TEMPPRTVAR=prt;
autosave();
return;
}
}
isExportEvent=true;
var range="";
if(prt=="publicHTML"||type=="publicHTML"||ALL_SHEET_SHARED||prt=="print"){
var fname="";
if(!jsGADGET_VIEW){
if(prt=="publicHTML"||type=="publicHTML"){
fname=DOCUMENT_NAME;
}else{
if(jsGUEST_VIEW||jsPUBLIC_VIEW||jsREMOTE_VIEW||jsTHROWAWAY_VIEW||jsVERSION_VIEW||jsREMOTE_SAVE_VIEW){
var _338e=getObj("sp_docName");
fname=(_338e&&_338e.getAttribute("docname"))?_338e.getAttribute("docname"):DOCUMENT_NAME;
_338e=null;
}else{
fname=DOCUMENT_NAME;
}
}
fname=encodeURIComponent(fname);
var sname=encodeURIComponent(CURRSHEETNAME);
}
var _3390=getViewType();
if(prt!="print"){
if(jsREMOTE_VIEW){
_3390="REMOTE_SAVE_VIEW";
}
if(!jsGADGET_VIEW){
var _3391=false;
if(prt!="publicHTML"&&type!="publicHTML"){
if(jsNEW_DOC_VIEW||jsTHROWAWAY_VIEW||jsREMOTE_VIEW){
_3391=true;
}
}
if(isDocumentPublic||isDocumentSemiPublic){
var _3392=true;
}else{
var _3392=false;
}
exurl=ctxpath+"export.do?fname="+fname+"&ftype="+type+"&docid="+DOCUMENT_ID+"&cursheet="+sname+"&curtime="+CURRENTTIME+"&dCount="+_3392+"&docowner="+CURR_DOC_OWNERNAME+"&viewType="+_3390+"&version="+DOCUMENT_VERSION+"&doSave="+ALLOW_TO_WRITE;
var _3393=getObj("apiKey");
if(_3393){
exurl+="&apiKey="+_3393.value;
}
}else{
exurl=ctxpath+"export.do?fname="+jsTitleMsg["Gadget.FileName"]+"&docid="+DOCUMENT_ID+"&curtime="+CURRENTTIME+"&viewType="+_3390+"&ftype="+type;
}
exportFlag=true;
var obj=document.forms.utilFORM;
obj.method="post";
obj.action=exurl;
if(!isPublished){
obj.target="hid_imp_doc";
}
getObj("utilFORMContainer").innerHTML="<input type='hidden' name='"+csrfParamName+"' value='"+csrfToken+"'>";
obj.submit();
exportFlag=false;
closeDialog();
}else{
image_urls="";
if(type!="publicHTML"){
if(isCellRange()){
var _3395=getCellRange();
range="&range="+_3395.startRow+":"+_3395.startCol+":"+_3395.endRow+":"+_3395.endCol;
}
var imgs=sheet.getElementsByTagName("IMG");
for(var i=0;i<imgs.length;i++){
if(typeof imgs[i].id!="undefined"){
var chart=ExcelGraph.getInstance(imgs[i].id);
if(chart!=null){
var X=chart.CP_TOP;
var Y=chart.CP_LEFT;
var W=chart.CP_WIDTH;
var H=chart.CP_HEIGHT;
IMGSrc=imgs[i].src;
image_urls+=IMGSrc+"*"+X+"*"+Y+"*"+W+"*"+H+"+";
}else{
if(imgs[i].id.indexOf("img_")>=0){
var X=imgs[i].style.top;
var Y=imgs[i].style.left;
var W=imgs[i].width;
var H=imgs[i].height;
IMGSrc=imgs[i].src;
image_urls+=IMGSrc+"*"+X+"*"+Y+"*"+W+"*"+H+"+";
}
}
}
}
}
var count=0;
var _339e=document.forms.utilFORM;
if(ole){
var _339f=ole.getObjects("button");
for(x in _339f){
count++;
}
}
if(_338a=="yes"){
}
range+="&viewType="+_3390;
range+="&docId="+DOCUMENT_ID;
var _33a0=CURR_DOC_OWNERNAME;
if(_33a0==""){
_33a0=LOGINNAME;
}
range+="&docowner="+_33a0;
closeDialog();
var _33a1=ctxpath+"preview.do?fname="+fname+"&curtime="+CURRENTTIME+"&sheetName="+sname+"&print_url=print&print=yes&browser_ie="+browser_ie+range+"&feButtonCount="+count+"&CURR_THEME="+CURR_THEME;
if(jsPUBLIC_VIEW&&isInOOMode){
_33a1+="&tempPublicDocId="+tempPublicDocId;
}
if(!browser_safari){
_339e.action=_33a1;
_339e.target="_blank";
_339e.submit();
}else{
window.open(_33a1,"_blank");
}
}
}
}
function showPrintOptions(){
if(printOptions==""){
printOptions=getObj("printdiv").innerHTML;
}
showDialog(printOptions,"position=relative, srcElement=td_print, closeButton=no, closeOnBodyClick=yes");
}
function exportDocs(type){
if(!allowExport){
return;
}
var i=0,_33a4=false;
docids="";
var val="";
while(true){
var elm=document.getElementById(val+"_"+i);
if(elm==null){
break;
}
if(elm.checked){
_33a4=true;
if(docids==""){
docids=elm.value;
}else{
docids=docids+","+elm.value;
}
}
i++;
}
if(!_33a4){
showAlertDialog(jsTitleMsg.SelectAtleastOneDocument);
return;
}
var _33a7=docids.split(",");
if(!MKIMODE&&_33a7.length>10){
showAlertDialog(jsTitleMsg.ExportLimit);
return;
}
var obj=document.forms.utilFORM;
if(!isPublished){
obj.target="hid_imp_doc";
}
obj.method="post";
obj.action=ctxpath+"zipexport.do?docids="+docids+"&type="+type;
getObj("utilFORMContainer").innerHTML="<input type='hidden' name='"+csrfParamName+"' value='"+csrfToken+"'>";
obj.submit();
}
function showChatPanel(){
var _33a9="";
var cnt=0;
for(var i=0;i<SHAREDUSERSLIST.length;i++){
var _33ac=SHAREDUSERSLIST[i];
var stat=_33ac["status"];
var cstat=_33ac["cstatus"];
var uname=_33ac["uname"];
var dname=_33ac["dname"];
_33a9+="<input type='hidden' name='status_"+i+"' value='"+stat+"'>";
_33a9+="<input type='hidden' name='cstatus_"+i+"' value='"+cstat+"'>";
_33a9+="<input type='hidden' name='uname_"+i+"' value='"+uname+"'>";
_33a9+="<input type='hidden' name='dname_"+i+"' value='"+dname+"'>";
if(parseInt(cstat)==1){
cnt=cnt+1;
_33a9+="<input type='hidden' name='usrclr_"+i+"' value='"+Userpresence.getColorCode(uname)+"'>";
}
if(userpremission[uname]){
_33a9+="<input type='hidden' name='mode_"+i+"' value='"+userpremission[uname]+"'>";
}
}
if(ISGEEDITOR){
_33a9+="<input type='hidden' name='isGE' value='true'>";
}
_33a9+="<input type='hidden' name='length' value='"+SHAREDUSERSLIST.length+"'>";
_33a9+="<input type='hidden' name='onlineUsers' value='"+cnt+"'>";
_33a9+="<input type='hidden' name='docid' value='"+DOCUMENT_ID+"'>";
_33a9+="<input type='hidden' name='docowner' value='"+CURR_DOC_OWNERNAME+"'>";
_33a9+="<input type='hidden' name='currenttime' value='"+CURRENTTIME+"'>";
_33a9+="<input type='hidden' name='collabid' value='"+COLLAB_ID+"'>";
_33a9+="<input type='hidden' name='docname' value='"+encodeURIComponent(DOCUMENT_NAME)+"'>";
_33a9+="<input type='hidden' name='loginUserName' value='"+LOGINNAME+"'>";
_33a9+="<input type='hidden' name='isEdit' value='"+isEdit+"'>";
_33a9+="<input type='hidden' name='editorTheme' value='"+getObj("editorTheme").value+"'>";
_33a9+="<input type='hidden' name='RMLOGINNAME' value='"+RMUSER+"'>";
_33a9+="<input type='hidden' name='viewType' value='"+getViewType()+"'>";
_33a9+="<input type='hidden' name='"+csrfParamName+"' value='"+csrfToken+"'>";
if(DISABLECHAT){
_33a9+="<input type='hidden' name='disableChat' value='true'>";
}
var _33b1=document.forms.utilFORM;
_33b1.action=ctxpath+"pages/chat.jsp";
_33b1.target="docPanelFrame";
var _33b2=getObj("utilFORMContainer");
_33b2.innerHTML=_33a9;
_33b1.submit();
}
function toggleChattersList(){
var mode="";
if(mode!="detached"){
if(getObj("chattersList").style.display==""){
getObj("chattersList").style.display="none";
getObj("chattersCollapse").style.display="none";
getObj("chattersExpand").style.display="";
}else{
getObj("chattersList").style.display="";
getObj("chattersCollapse").style.display="";
getObj("chattersExpand").style.display="none";
}
}
}
function updateChatMessage(chid,_33b5,msg){
if(DISABLECHAT){
return false;
}
var uname="";
if(opener){
uname=opener.RMUSER;
}else{
uname=RMUSER;
}
if(_33b5==uname){
return;
}
var _33b8=msg["COLLABID"];
var _33b9=msg["ACTION"];
var _33ba=msg["DOCOWNER"];
var docid=msg["DOCID"];
var _33bc=msg["CURRENTTIME"];
var _33bd=msg["DOCNAME"];
var name=msg["LOGINNAME"];
var _33bf=msg["MESSAGE"];
var _33c0=msg["TIMEELAPSED"];
var _33c1=msg["USERZUID"];
if(jsREMOTE_SAVE_VIEW||_33c1==null||_33c1==""||_33c1==-1){
_33c1=name;
}
_33bf=unescape(_33bf);
_33bf=encodeHtml(_33bf);
var html="<div><b>"+getUsrName(_33c1)+": </b>"+_33bf+"</div>";
if(!DOC_PANEL.isDocPanelClosed()){
appendMessage(html,true);
}else{
appendMessage(html,false);
}
}
function sendChatMessage(ev,_33c4,docid,_33c6,_33c7,_33c8,_33c9,value,dname){
if(browser_ie){
var ev=window.event;
var _33cc=ev.keyCode;
}else{
if(browser_nn6){
var _33cc=ev.which;
}
}
if(_33cc==13&&_33c4!=""&&_33c7!=""&&value.trim()!=""){
var _33cd=new getXmlhttp();
_33cd.onreadystatechange=function(){
if(_33cd.readyState==4){
}
};
var _33ce="docid="+docid+"&docname="+encodeURIComponent(DOCUMENT_NAME)+"&action=chat"+"&chid="+_33c4+"&currenttime="+_33c8;
_33ce+="&loginname="+_33c7+"&msg="+encodeURIComponent(value)+"&docowner="+_33c6+"&RMLOGINNAME="+RMUSER+"&viewType="+getViewType();
postAjax(_33cd,ctxpath+"checkcollab.do",_33ce);
getObj("chatField").value="";
var html="";
var _33d0=chatDetailsIFrame.document.getElementById("chatDetailsDIV");
value=encodeHtml(value);
if(parent){
if(dname==parent.LOGINNAME){
dname=parent.jsTitleMsg.Me;
}
}else{
if(opener){
if(dname==opener.LOGINNAME){
dname=opener.jsTitleMsg.Me;
}
}else{
if(dname==LOGINNAME){
dname=jsTitleMsg.Me;
}
}
}
var html="<div><b>"+dname+": </b>"+value+"</div>";
appendMessage(html,true,_33d0);
}
}
function appendMessage(html,_33d2,_33d3){
var _33d4=true;
var _33d5=getIframeWindow();
if(typeof _33d3!="undefined"){
var _33d6=_33d3;
}else{
if(_33d5==null||typeof _33d5=="undefined"||_33d5==""){
_33d4=false;
}else{
var _33d6=_33d5.document.getElementById("chatDetailsDIV");
}
}
var _33d7=getChatLogsObj();
if(_33d2){
_33d6.innerHTML+=html;
_33d7.innerHTML=_33d6.innerHTML;
}else{
if(_33d4){
_33d7.innerHTML=_33d6.innerHTML+html;
}else{
_33d7.innerHTML+=html;
}
}
if(_33d5==null||typeof _33d5=="undefined"||_33d5==""){
if(typeof chatDetailsIFrame!="undefined"){
chatDetailsIFrame.document.body.scrollTop=chatDetailsIFrame.document.body.scrollHeight;
}
}else{
_33d5.document.body.scrollTop=_33d5.document.body.scrollHeight;
}
}
function getIframeWindow(){
var win="";
for(i=0;i<window.frames.length;i++){
try{
if(window.frames[i].name=="docPanelFrame"){
var _33d9=window.frames[i];
for(j=0;j<_33d9.frames.length;j++){
if(_33d9.frames[j].name=="chatDetailsIFrame"){
win=_33d9.frames[j];
}
}
}
}
catch(e){
}
}
return win;
}
function getChatLogs(){
var _33da=getChatLogsObj();
var win=window.frames["chatDetailsIFrame"];
var _33dc=win.document.getElementById("chatDetailsDIV");
_33dc.innerHTML=_33da.innerHTML;
}
CollabUtil={init:function(_33dd){
if(!_33dd){
_33dd={};
}
WebMessanger.theme=(_33dd.theme)?_33dd.theme:"blue";
if(_33dd.langCode&&_33dd.countryCode){
WebMessanger.setLocale(_33dd.langCode,_33dd.countryCode);
}
if(_33dd.domain){
WebMessanger.setDomain(_33dd.domain);
}
if(_33dd.wmsctxpath){
WebMessanger.setWmsContext(_33dd.wmsctxpath);
}
if(_33dd.rebrandName){
WebMessanger.setRebrand(_33dd.rebrandName);
}
if(_33dd.meetingURL){
WebMessanger.setMeetingUrl(_33dd.meetingURL);
}
if(_33dd.disableMeeting){
WebMessanger.disableMeeting();
}
if(_33dd.disableContacts){
WebMessanger.disableContacts();
}
if(_33dd.disableGroups){
WebMessanger.disableGroups();
}
if(_33dd.disableActiveChat){
WebMessanger.disableActiveChat();
}
if(_33dd.disableProfile){
WebMessanger.disableProfile();
}
var _33de=(_33dd.loginName)?_33dd.loginName:"";
var _zuid=(_33dd.zuid)?_33dd.zuid:-1;
if(jsREMOTE_SAVE_VIEW){
var _33e0=_33dd.rmUser;
WebMessanger.registerWms("ST","",_33e0,_33de);
WmsContactImpl.handleHideContactsUI();
WmsContactImpl.handleNonUser();
}else{
if(jsGADGET_VIEW||jsEMBED_VIEW||jsGUEST_VIEW||jsPUBLIC_VIEW||jsTHROWAWAY_VIEW||jsREMOTE_VIEW){
WebMessanger.registerAnnon("ST",_zuid,"");
WmsContactImpl.handleHideContactsUI();
WmsContactImpl.handleNonUser();
}else{
wmsSilent=(wmsSilent=="true")?true:false;
WebMessanger.registerZuid("ST",_zuid,_33de,wmsSilent);
if(typeof cdview=="string"){
cdview=cdview.toBoolean();
}
if(cdview){
WmsContactImpl.handleHideContactsUI();
WmsContactImpl.handleNonUser();
}
}
}
}};
function Collaboration(){
}
Collaboration.handleUserList=function(chid,list){
if(COLLAB_ID!=chid||COLLAB_ID==""){
return;
}
if(!isCollabJoined&&ALLOW_TO_WRITE){
removeDocOpenLock();
}
isCollabJoined=true;
for(var i=0;i<list.length;i++){
COLLABORATIVE_EDITING="ON";
var _33e4=(jsREMOTE_SAVE_VIEW)?SHAREDUSERSLIST.contains(list[i]):SHAREDUSERSLIST.contains(list[i],"zuid");
if(!_33e4){
SHAREDUSERSLIST[SHAREDUSERSLIST.length]=list[i];
}
}
var _33e5=0;
for(var i=0;i<list.length;i++){
var _33e6=list[i];
var stat=_33e6["cstatus"];
if(stat=="1"){
_33e5=1;
break;
}
}
setTimeout(function(){
updateSharedUserStatus();
if(!DOC_PANEL.isDocPanelClosed()&&panelOpenedFor=="chat"){
showChatPanel();
}
var users="";
var cnt=0;
for(var i=0;i<SHAREDUSERSLIST.length;i++){
var _33eb=SHAREDUSERSLIST[i];
var stat=_33eb["cstatus"];
var name=_33eb["dname"];
if(stat=="1"){
cnt=cnt+1;
_33e5=1;
users=users+name+", ";
}
}
if(users!=""){
users=users.substring(0,users.length-2);
var _33ee="<hr size='1' color='#CCCCCC' style='margin-top:10px;'><div style='height:25px;text-align:right;'><a href='#' onclick='javascript:if(DOC_PANEL.isDocPanelClosed()) { DOC_PANEL.showDocPanel(\"chat\", showChatPanel());return false;} ' style='color:#00F;text-decoration:underline;'>"+jsMsg.EnterDiscussionRoom+"</a></div>";
if(!DONTNOTIFY){
if(cnt>1){
notify("info",users+" "+jsMsg.areCurrentlyPresentDocument,_33ee);
}else{
notify("info",users+" "+jsMsg.isCurrentlyPresentDocument,_33ee);
}
}
DONTNOTIFY=false;
getCollaboratorsMode();
Userpresence.send();
}
},2);
};
Collaboration.handleMessage=function(chid,uname,_33f1,_33f2,msg){
if(msg.ACTION=="SAVEDOC"&&jsREMOTE_SAVE_VIEW){
autosave();
return false;
}
if(uname==RMUSER||uname==""){
return;
}
setTimeout(function(){
updateValue(chid,uname,msg,_33f1);
},2);
};
Collaboration.handlePresence=function(chid,uname,_33f6,user,_33f8){
if(_33f8==0&&COLLAB_ID==chid&&_33f6!=zuid){
setTimeout(function(){
makeOffline(chid,uname,user,_33f8);
},2);
}
if(_33f8==1&&_33f6!=zuid&&COLLAB_ID==chid){
setTimeout(function(){
getCollaboratorsMode(uname);
makeOnline(chid,uname,user,_33f8);
COLLABORATIVE_EDITING="ON";
if(!DOC_PANEL.isDocPanelClosed()&&panelOpenedFor=="chat"){
showChatPanel();
}
},2);
}
};
Collaboration.join=function(chid){
WebMessanger.joinCollab(chid);
};
Collaboration.quit=function(chid){
WebMessanger.quit(chid);
};
Collaboration.onConnect=function(){
};
Collaboration.serverup=function(){
doCollabprocess();
};
Collaboration.serverdown=function(){
};
Collaboration.handleZohoMessage=function(prd,msg,url,_33fe,_33ff,_3400,att,_3402,id,dname,orgs,_3406){
};
Collaboration.handleCustomMessage=function(msg){
setTimeout(function(){
updateCustomMessage(msg);
},2);
};
Collaboration.handleCrossProductMessage=function(prd,msg){
};
Collaboration.openURL=function(url,_340b,_340c,prd){
if(prd=="ST"&&_340c["DOCID"]!=null){
loadDocument(_340c["DOCID"],_340b);
return false;
}else{
return true;
}
};
Collaboration.handleUserAdd=function(chid,_340f){
if(COLLAB_ID!=chid||COLLAB_ID==""){
return;
}
for(var i=0;i<_340f.length;i++){
if(!SHAREDUSERSLIST.contains(_340f[i])){
SHAREDUSERSLIST[SHAREDUSERSLIST.length]=_340f[i];
}
}
if(!jQuery.isEmptyObject(_SharedUserList)){
for(x in _SharedUserList){
for(var i=0;i<SHAREDUSERSLIST.length;i++){
var el=SHAREDUSERSLIST[i];
if(el["uname"]==_SharedUserList[x].uname){
SHAREDUSERSLIST[i]["cstatus"]="1";
updateSharedUserStatus();
delete _SharedUserList[x];
}
}
}
}
};
Collaboration.handleUserDeleted=function(chid,_3413){
if(COLLAB_ID!=chid||COLLAB_ID==""){
return;
}
for(var i=0;i<_3413.length;i++){
for(j=0;j<SHAREDUSERSLIST.length;j++){
var _3415=SHAREDUSERSLIST[j];
var _3416=_3413[i];
if(_3415["uname"]==_3416["uname"]){
rem=SHAREDUSERSLIST.splice(j,1);
if(_3415["cstatus"]==1){
notify("info",_3416["dname"]+" "+jsMsg.hasClosedDocument,"");
}
Userpresence.remove(_3416["uname"]);
updateSharedUserStatus();
if(!DOC_PANEL.isDocPanelClosed()&&panelOpenedFor=="chat"){
showChatPanel();
}
break;
}
}
}
};
Collaboration.handleCollabAdd=function(uname,dname,_3419,time,chid){
};
Collaboration.handleCollabDelete=function(uname,dname,_341e,time,chid){
};
Collaboration.handleIsOnline=function(_3421){
};
Collaboration.handleLogout=function(_3422){
};
Collaboration.goOffline=function(){
showConnectionLostError();
};
Collaboration.handleChatNotifyMessage=function(chid,_3424,_3425){
};
Collaboration.getPageTitle=function(){
return false;
};
Collaboration.handleWmsDisable=function(_3426){
};
Collaboration.handleServiceMessage=function(_3427){
};
Collaboration.handleComposeMail=function(_3428,_3429){
return false;
};
Collaboration.handleLanguageChange=function(_342a){
};
function WmsContactImpl(){
}
WmsContactImpl.handlePresence=function(zuid,uname,dname,scode,_342f){
};
WmsContactImpl.handleAddressBook=function(){
};
WmsContactImpl.handleInvite=function(zuid,uname,dname){
};
WmsContactImpl.notifyInvite=function(zuid,uname,dname){
};
WmsContactImpl.handleAccept=function(zuid,uname,dname,scode,_343a){
};
WmsContactImpl.notifyAccept=function(zuid,uname,dname,scode,_343f){
};
WmsContactImpl.handleReject=function(zuid,uname,dname){
};
WmsContactImpl.notifyRemove=function(zuid,uname,dname){
};
WmsContactImpl.handleDelete=function(zuid,uname,dname){
};
WmsContactImpl.handleContactUpdated=function(){
};
WmsContactImpl.handleStatusMessage=function(_3449,scode){
};
WmsContactImpl.handeAllStatusMessages=function(){
};
WmsContactImpl.handleHideContactsUI=function(){
$("#wmstoolbar").show();
var _344b=$("#wmstoolbar").children().filter(":visible").not("#wmsstatusbar,#wmscollapsebar,#wmscollapsetbar,.wms-colpsbar,#wmscollapsetbar");
$.each(_344b,function(i){
$(_344b[i]).hide();
});
$("#wmscollapsetbar").css({"z-index":"1000"});
$("#wmscollapsetbar").css({height:"20px"});
};
WmsContactImpl.handleShowContactsUI=function(){
$("#wmstoolbar").show();
var _344d=$("#wmstoolbar").children().filter(":hidden").not("#wmsstatusbar,#wmscollapsebar,.wms-ucd,#wmscollapsetbar");
$.each(_344d,function(i){
$(_344d[i]).show();
});
$("#wmscollapsetbar").css({"z-index":"1000"});
$("#wmscollapsetbar").css({height:"20px"});
};
WmsContactImpl.handleGetContacts=function(){
};
WmsContactImpl.handleMPReject=function(_344f,_3450,_3451){
};
WmsContactImpl.handleMPAccept=function(_3452,_3453,_3454){
};
WmsContactImpl.handleMPDelete=function(_3455,_3456,_3457){
};
WmsContactImpl.handleMPAdd=function(_3458,_3459,_345a){
};
WmsContactImpl.handleMPInvite=function(_345b,_345c,_345d){
};
WmsContactImpl.handleLogin=function(_345e,_345f,_3460,_3461){
};
WmsContactImpl.handleLogout=function(_3462,_3463,_3464,_3465){
};
WmsContactImpl.handleGetAccounts=function(_3466){
};
WmsContactImpl.handleInvitations=function(_3467){
};
WmsContactImpl.handleNonUser=function(){
$("#wmsudtlsbar").hide();
$("#wmscollapsebar").hide();
};
function WmsChatUIImpl(){
}
WmsChatUIImpl.handleUserIdle=function(dName,chid){
};
WmsChatUIImpl.handleUserEnteredText=function(dName,chid){
};
WmsChatUIImpl.handleUserTyping=function(dName,chid){
};
WmsChatUIImpl.handleNewChat=function(_346e){
};
WmsChatUIImpl.handleChatMessage=function(_346f){
};
WmsChatUIImpl.isActive=function(chid){
return false;
};
WmsChatUIImpl.handleTranscript=function(chid,_3472){
};
function CustomChat(){
}
CustomChat.handleUserList=function(chid,list){
};
CustomChat.handleMessage=function(msg){
};
CustomChat.handlePresence=function(chid,uname,zuid,dname,_347a){
};
CustomChat.handleUserAdded=function(chid,list,_347d){
};
CustomChat.handleUserDeleted=function(chid,list,_3480){
};
CustomChat.handleTranscript=function(chid,_3482){
};
CustomChat.join=function(chid){
WebMessanger.join(chid);
};
CustomChat.transcript=function(chid,_3485){
WebMessanger.setTimeZoneOffset(_3485);
WebMessanger.customtranscript(chid,true);
};
CustomChat.quit=function(chid){
WebMessanger.quit(chid);
};
CustomChat.handleAttachmentMessage=function(chid,_3488){
};
CustomChat.handleTitleUpdated=function(chid,title){
};
CustomChat.isActive=function(chid,_348c){
return false;
};
CustomChat.handleCloseWin=function(chid){
};
function WmsGroupImpl(){
}
WmsGroupImpl.handleGetGroups=function(){
};
function NotificationApiImpl(){
}
NotificationApiImpl.handleUnreadChatCount=function(count){
};
function WMSTP(){
}
WMSTP.isVideoEnabled=function(){
return false;
};
WMSTP.isAudioEnabled=function(){
return false;
};
WMSTP.handleNewVideo=function(_348f,_3490){
};
WMSTP.handleNewAudio=function(_3491,_3492){
};
WMSTP.handleAVMessage=function(_3493){
};
function WmsUIImpl(){
}
WmsUIImpl.handleFeedHistory=function(){
};
WmsUIImpl.handleUnreadFeeds=function(){
};
function ZohoFeedImpl(){
}
ZohoFeedImpl.handleFeedHistory=function(_3494){
};
ZohoFeedImpl.handleFeedHistoryCount=function(count){
};
ZohoFeedImpl.handleUnreadFeeds=function(_3496){
};
ZohoFeedImpl.handleFeedsInRange=function(_3497){
};
ZohoFeedImpl.handleFeedDelete=function(_3498){
};
ZohoFeedImpl.handleFeedHistoryUI=function(){
return false;
};
ZohoFeedImpl.handleUnreadFeedUI=function(){
return false;
};
ZohoFeedImpl.handleLiveFeedsUI=function(_3499){
return false;
};
function ZTI(){
}
ZTI.handleFailure=function(_349a,data){
};
var uploadedImageUrl=null;
var imgid=null;
var seq_num=null;
var actht=null;
var actwd=null;
var imght=null;
var imgwd=null;
var imgleft=null;
var imgtop=null;
var imgname=null;
var imgexturl=null;
var imgextn=null;
var imgtitle=null;
var imglink=null;
var imgalt=null;
var currentImage=null;
var validURL=null;
var currPic="";
var imageDialog="";
var imgMoreActionsMenuStatus=false;
ImageMenuData="<menu id='ImageConetextMenu' forElement='OLESelectLayer'><item onclick='resizeToOriginalDim(ole.getCurrObj().id);'><![CDATA["+jsMsg.ResizeToOriginalSize+"]]></item> <sep></sep><item onclick='saveImage(ole.getCurrObj().id);'><![CDATA["+jsMsg["Image.SaveImageAs"]+"]]></item><sep></sep><item onclick='ole.currObj.clone(1,parseInt((10 * ole.currObj.cloneCountSinceLastDragOrResize) + ole.currObj.width + 10) ,parseInt((10 * ole.currObj.cloneCountSinceLastDragOrResize) + ole.currObj.height + 10));return false;'><![CDATA["+jsMsg.Clone+"]]></item><item onclick='ole.remove(ole.getCurrObj().id, true);'><![CDATA["+jsMsg.Delete+"]]></item></menu>";
function showImageDialog(){
if(jsNEW_DOC_VIEW){
if(DOCUMENT_ID=="doc_id"){
SAVED=false;
savefile("autosave");
}
}
var nvp="mode=add&viewType="+getViewType();
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
nvp+="&apiKeyId="+getObj("apiKey").value;
nvp+="&docid="+DOCUMENT_ID;
}
showURLInDialog(ctxpath+"pages/insertimage.jsp?"+nvp,"position=absmiddle,width=540,title="+jsTitleMsg.InsertImage,positionDialog,"",doBlurImage);
}
function load_frame(){
var _349d=getObj("hid_imgframe");
var url=_349d.contentWindow.uploadedImageUrl;
if(!url||url.length==0){
return;
}
uploadedImageUrl=url;
if(uploadedImageUrl.indexOf("Error")!=-1){
}
imgid=_349d.contentWindow.imgid;
seq_num=_349d.contentWindow.seq_num;
imght=_349d.contentWindow.imght;
imgwd=_349d.contentWindow.imgwd;
imgleft=_349d.contentWindow.imgleft;
imgtop=_349d.contentWindow.imgtop;
imgname=_349d.contentWindow.imgname;
imgexturl=_349d.contentWindow.imgexturl;
imgextn=_349d.contentWindow.imgextn;
imgtitle=_349d.contentWindow.imgtitle;
imglink=_349d.contentWindow.imglink;
imgalt=_349d.contentWindow.imgalt;
insertImageSelection(url);
if(READ_WRITE&&UPDATEIMAGEINOO){
btn_enabled();
}
}
(function(){
var _349f=getObj("hid_imgframe");
if(_349f){
if(browser_ie){
_349f.attachEvent("onload",load_frame,false);
}else{
_349f.onload=load_frame;
}
}
})();
function insertOrUploadImage(obj,xPos,yPos){
IMAGEOBJECT=obj;
XPOSITION=xPos;
YPOSITION=yPos;
var local=true;
var url="";
var frm=document.forms["frmUpload"];
if(typeof obj=="undefined"||obj==null){
local=getObj("image").checked;
if(local){
url=frm.xfile.value;
validURL=true;
}else{
url=frm.urlfile.value;
validURL=isValidURL(url);
}
url=url.trim();
}
if(url==""||!validURL||typeof obj!="undefined"){
if(typeof obj!="undefined"){
currentImage=obj;
}
if(currentImage==null){
if(!local){
showAlertDialog(jsTitleMsg.InvalidImageLocation);
}else{
showAlertDialog(jsTitleMsg.Selectanimagetoinsert);
}
return;
}
}
var _34a6=getViewType();
if(DOCUMENT_ID=="doc_id"&&(_34a6=="NEW_VIEW"||_34a6=="NEW_DOC_VIEW")){
SAVED=false;
savefile("autosave");
INSERTIMAGE=true;
}else{
IMAGEOBJECT=null;
XPOSITION=null;
YPOSITION=null;
INSERTIMAGE=false;
var _34a7=false;
var imgid="";
var _34a9="";
var _34aa="";
if(url==""||!validURL||typeof obj!="undefined"){
if(typeof obj!="undefined"){
currentImage=obj;
}
_34a7=true;
imgid=currentImage.getAttribute("imgid");
_34aa=currentImage.name;
_34a9=currentImage.getAttribute("imgextn");
}
if(typeof xPos=="undefined"&&xPos==null){
var xPos=findCellLeft(currCell);
}
if(typeof yPos=="undefined"&&yPos==null){
var yPos=findCellTop(currCell);
}
var _34ab=getObj("loadtype");
if(_34ab!=null){
_34ab=_34ab.checked;
}else{
_34ab=false;
}
var _34ac=encodeURIComponent(CURRSHEETNAME);
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
var _34b0=DOCUMENT_ID;
if(jsREMOTE_VIEW){
_34b0="doc_id";
}
var nvp="local="+local+"&xPos="+xPos+"&yPos="+yPos+"&sheetname="+_34ac+"&docid="+_34b0+"&afterRTC=false"+"&docowner="+CURR_DOC_OWNERNAME;
nvp+="&bridgeNo="+bridgeNumber+"&curtime="+CURRENTTIME+"&row="+row+"&col="+col+"&imageurl="+url+"&loadType="+_34ab;
nvp+="&insertAlreadyUploaded="+_34a7+"&imgid="+imgid+"&imgextn="+_34a9+"&imgname="+_34aa;
nvp+="&collabid="+COLLAB_ID+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING+"&viewType="+_34a6;
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
nvp+="&apiKey="+getObj("apiKey").value;
nvp+="&RMLOGINNAME="+RMUSER;
}
if(CLONEIMAGE){
var _34b2=obj.height;
var _34b3=obj.width;
actwd=parseInt(obj.getAttribute("actwd"));
actht=parseInt(obj.getAttribute("actht"));
nvp+="&imgwidth="+_34b3+"&imgheight="+_34b2;
}
nvp+="&isCloned="+CLONEIMAGE;
CLONEIMAGE=false;
currentImage=null;
if(typeof frm=="undefined"||frm==null){
var sCol=findColInXPos(xPos),sRow=findRowInYPos(yPos),_34b6=yPos-getRowTop(sRow),_34b7=xPos-getColLeft(sCol);
if(!_34a7){
ole(imgid).sCol=sCol;
ole(imgid).sRow=sRow;
ole(imgid).sRowDiff=_34b6;
ole(imgid).sColDiff=_34b7;
}
nvp+="&sCol="+sCol+"&sRow="+sRow+"&sColDiff="+_34b7+"&sRowDiff="+_34b6;
var _34b8=getObj("frmUpload");
if(_34b8){
var pNode=_34b8.parentNode;
pNode.removeChild(_34b8);
}
_34b8=document.createElement("form");
_34b8.id="frmUpload";
_34b8.name="frmUpload";
_34b8.action=ctxpath+"ImageUpload.do?"+nvp;
_34b8.method="post";
_34b8.enctype="multipart/form-data";
_34b8.target="hid_imgframe";
_34b8.innerHTML="<input type='hidden' name='"+csrfParamName+"' value='"+csrfToken+"'>";
document.body.appendChild(_34b8);
_34b8.submit();
var pNode=_34b8.parentNode;
pNode.removeChild(_34b8);
}else{
var sCol=findColInXPos(xPos);
var sRow=findRowInYPos(yPos);
var _34b6=yPos-getRowTop(sRow);
var _34b7=xPos-getColLeft(sCol);
nvp+="&sCol="+sCol+"&sRow="+sRow+"&sColDiff="+_34b7+"&sRowDiff="+_34b6;
document.frmUpload.action=ctxpath+"ImageUpload.do?"+nvp;
document.frmUpload.enctype="multipart/form-data";
document.frmUpload.method="post";
document.frmUpload.submit();
}
}
}
function insertImageSelection(_34ba){
if(typeof _34ba=="undefined"||_34ba==null||_34ba.indexOf("Error:")==0){
showAlertDialog(jsTitleMsg.InvalidImageLocation);
return;
}
closeDialog();
if(typeof id!="undefined"){
imgid=id;
}
var img=document.createElement("img");
if(imgexturl!=""){
img.src=imgexturl;
}else{
img.src=_34ba;
}
img.id="img_"+seq_num;
img.name=imgname;
img.setAttribute("imgid",imgid);
img.setAttribute("imgextn",imgextn);
img.setAttribute("exturl",imgexturl);
if(actwd!=null&&actwd!="null"){
img.setAttribute("actwd",actwd);
img.setAttribute("actht",actht);
}else{
img.setAttribute("actwd",imgwd);
img.setAttribute("actht",imght);
}
img.title=imgtitle;
img.alt=imgalt;
img.height=imght;
img.width=imgwd;
img.className="img";
img.objType="img";
if(imglink!=""){
}
setImagePermission();
actwd=null;
actht=null;
insertImgorChartIsFreezed(img,imgleft,imgtop);
ole.init(img.id).bringToFront().setSelectLayer().positionActionBar();
ole(img.id).sCol=findColInXPos(imgleft);
ole(img.id).sRow=findRowInYPos(imgtop);
ole(img.id).sRowDiff=imgtop-getRowTop(ole(img.id).sRow);
ole(img.id).sColDiff=imgleft-getColLeft(ole(img.id).sCol);
}
function setImagePermission(){
var _34bc=false,_34bd=false,_34be=false;
switch(getViewType()){
case "SHARE_VIEW":
if(!ALLOW_TO_WRITE){
break;
}
case "NEW_VIEW":
case "OPEN_VIEW":
_34bc=true;
_34bd=true;
case "REMOTE_SAVE_VIEW":
if(!isReadOnlyViewMode){
_34bc=true;
_34bd=true;
_34be=true;
}
break;
case "REMOTE_VIEW":
_34bc=true;
_34bd=true;
_34be=true;
case "PUBLIC_VIEW":
if(!isReadOnlyViewMode){
_34bc=true;
_34bd=true;
_34be=true;
}
break;
}
ole.setObjectProperties("img",{permissions:{"isDraggable":_34bc,"isResizable":_34bd,"isEditable":_34be}});
}
function positionImage(img,left,top,_34c2,_34c3){
var _34c4=getObj(img);
if(_34c4==null){
return;
}
var _34c5=_34c4.id;
var _34c6=_34c5.substring(4,_34c5.length);
var _34c7=_34c4.getAttribute("imgid");
var _34c8=_34c4.src;
var _34c9=_34c4.getAttribute("exturl");
ole(_34c5).sCol=findColInXPos(left);
ole(_34c5).sRow=findRowInYPos(top);
if(typeof _34c2!="undefined"){
ole(_34c5).sRowDiff=_34c2;
}
if(typeof _34c3!="undefined"){
ole(_34c5).sColDiff=_34c3;
}
ole(_34c5).sRowDiff=top-getRowTop(ole(_34c5).sRow);
ole(_34c5).sColDiff=left-getColLeft(ole(_34c5).sCol);
var _34ca="MODE=MOVE&imgid="+_34c7+"&left="+left+"&top="+top+"&imgurl="+encodeURIComponent(_34c8)+"&seqnum="+_34c6;
_34ca+="&imgexturl="+encodeURIComponent(_34c9);
_34ca+="&sCol="+ole(_34c5).sCol+"&sRow="+ole(_34c5).sRow+"&sColDiff="+ole(_34c5).sColDiff+"&sRowDiff="+ole(_34c5).sRowDiff;
updateImage(_34ca);
}
function resizeImage(img,width,_34cd){
var _34ce=getObj(img);
if(_34ce==null){
return;
}
var _34cf=_34ce.id;
var _34d0=_34cf.substring(4,_34cf.length);
var _34d1=_34ce.getAttribute("imgid");
var _34d2=_34ce.src;
var _34d3=_34ce.getAttribute("exturl");
var xPos=parseInt(_34ce.style.left);
var yPos=parseInt(_34ce.style.top);
ole(_34cf).sCol=findColInXPos(xPos);
ole(_34cf).sRow=findRowInYPos(yPos);
ole(_34cf).sRowDiff=yPos-getRowTop(ole(_34cf).sRow);
ole(_34cf).sColDiff=xPos-getColLeft(ole(_34cf).sCol);
var _34d6="MODE=UPDATE&imgid="+_34d1+"&width="+parseInt(width)+"&height="+parseInt(_34cd)+"&left="+xPos+"&top="+yPos+"&imgurl="+encodeURIComponent(_34d2)+"&seqnum="+_34d0;
_34d6+="&sCol="+ole(_34cf).sCol+"&sRow="+ole(_34cf).sRow+"&sColDiff="+ole(_34cf).sColDiff+"&sRowDiff="+ole(_34cf).sRowDiff;
_34d6+="&imgexturl="+encodeURIComponent(_34d3);
updateImage(_34d6);
}
function removeImage(img){
var _34d8=ole.getCurrObj().el;
if(_34d8==null){
return;
}
var _34d9=_34d8.id;
var _34da=_34d9.substring(4,_34d9.length);
var _34db=_34d8.getAttribute("imgid");
var _34dc=_34d8.src;
var _34dd=_34d8.getAttribute("exturl");
var _34de="MODE=REMOVE&imgid="+_34db+"&imgurl="+encodeURIComponent(_34dc)+"&seqnum="+_34da;
_34de+="&imgexturl="+encodeURIComponent(_34dd);
updateImage(_34de);
ole.conf.onblur();
}
function updateImage(_34df,_34e0,_34e1,mode){
if(typeof _34e0=="undefined"){
_34e0="false";
}
if(typeof _34e1=="undefined"){
_34e1="false";
}
var _34e3="&docid="+DOCUMENT_ID+"&sheetname="+encodeURIComponent(CURRSHEETNAME)+"&curtime="+CURRENTTIME;
_34e3+="&docowner="+CURR_DOC_OWNERNAME+"&collabid="+COLLAB_ID+"&collabEditing="+COLLABORATIVE_EDITING;
_34e3+="&afterRTC="+_34e0+"&readwrite="+ALLOW_TO_WRITE+"&isSameSheet="+ISSAMESHEET;
_34e3+="&rtcSheetName="+encodeURIComponent(RTCSHEETNAME)+"&viewType="+getViewType();
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
_34e3+="&apiKeyId="+getObj("apiKey").value;
_34e3+="&RMLOGINNAME="+RMUSER;
}
var _34e4=new getXmlhttp();
_34e4.onreadystatechange=function(){
if(_34e4.readyState==4){
if(mode!="delete"){
if(READ_WRITE&&UPDATEIMAGEINOO){
btn_enabled();
}
}
}
};
postAjax(_34e4,ctxpath+"UpdateImage.do",_34df+_34e3);
}
function image_check(val){
var frm=document.forms["frmUpload"];
if(val=="image_url"){
frm.xfile.disabled=true;
frm.urlfile.disabled=false;
getObj("loadtypeinput").style.display="";
}else{
if(val=="image"){
frm.urlfile.disabled=true;
frm.xfile.disabled=false;
getObj("loadtypeinput").style.display="none";
}
}
}
function addImage(id){
insertOrUploadImage(getObj("thumb_"+id));
}
function deleteImage(id){
var _34e9="MODE=CHECKDELETE&imgid="+id;
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
_34e9+="&apiKeyId="+getObj("apiKey").value;
_34e9+="&RMLOGINNAME="+RMUSER;
}
var _34ea=new getXmlhttp();
_34ea.onreadystatechange=function(){
if(_34ea.readyState==4){
var _34eb=_34ea.responseText;
var _34ec="MODE=DELETE&imgid="+id;
var a=false;
if(_34eb=="EXISTS"){
a=showConfirmDialog(jsTitleMsg.Thisimageisbeingusedinoneormoreofyourspreadsheets+"\n"+jsTitleMsg.Areyousurewanttodeletethisimage);
}else{
a=true;
}
if(a){
updateImage(_34ec,"false","false","delete");
var _34ee=getObj("thumb_"+id);
if(_34ee!=null){
var _34ef=_34ee.parentNode;
_34ef.removeChild(_34ee);
}
doBlurImage();
var _34f0=getObj("thumbnail-"+id);
if(_34f0!=null){
_34f0.style.display="none";
}
var imgs=sheet.getElementsByTagName("IMG");
for(var i=0;i<imgs.length;i++){
if(imgs[i].getAttribute("imgid")==id){
sheetObjectsPane.removeChild(imgs[i]);
}
}
getObj("noofimgs").innerHTML=parseInt(getObj("noofimgs").innerHTML)-1;
}
}
};
postAjax(_34ea,ctxpath+"UpdateImage.do",_34e9);
}
var currImg="";
function focusImage(id,ev){
if(currImg!=""){
getObj("thumbnail-"+currImg).className="thumbnail";
}
currImg=id;
var _34f5=getObj("thumbnail-"+id);
_34f5.className="thumbnailHover";
currentImage=getObj("thumb_"+id);
var _34f6=(browser_ie||browser_safari||browser_opera||browser_ff3)?15:0;
var left=_34f5.offsetLeft;
var top=_34f5.offsetTop+_34f6;
var width=_34f5.offsetWidth;
var _34fa=_34f5.offsetHeight;
var _34fb=(browser_nn6)?4:0;
var _34fc=getObj("imageActionDIV");
_34fc.style.width=(width-_34fb)+"px";
_34fc.style.left=left+"px";
_34fc.style.top=(top-_34fc.offsetHeight)+"px";
_34fc.style.height="20px";
var _34fd=getObj("imageDescDIV");
_34fd.style.width=(width-_34fb)+"px";
_34fd.style.left=left+"px";
var _34fe=top+_34f5.offsetHeight;
if(browser_safari){
_34fe=_34fe-17;
}
_34fd.style.top=_34fe+"px";
var imgEl=getObj("thumb_"+id);
_34fd.innerHTML=parseInt(imgEl.getAttribute("actwd"))+" X "+parseInt(imgEl.getAttribute("actht"));
if(browser_ie){
window.event.cancelBubble=true;
}else{
if(browser_nn6){
ev.stopPropagation();
}
}
}
function blurImage(id,ev){
if(currImg!=""){
if(browser_ie){
var el=window.event.srcElement;
}else{
if(browser_nn6){
var el=ev.target;
}
}
if(typeof el!="undefined"&&el!=null){
var _3503=isChild(el,getObj("thumbnail-"+id));
var _3504=isChild(el,getObj("imageActionDIV"));
if(!_3503&&!_3504&&el.id!="imageActionDIV"&&el.id!="imageDescDIV"){
doBlurImage();
}
}
}
}
function doBlurImage(){
if(currImg!=""){
getObj("thumbnail-"+currImg).className="thumbnail";
var _3505=getObj("imageActionDIV");
var _3506=getObj("imageDescDIV");
_3505.style.left=_3505.style.top="-100000px";
_3506.style.left=_3506.style.top="-100000px";
currImg="";
currentImage=null;
}
}
var currDragImgEl,ghostImg,imgDiffX,imgDiffY,initialLeft,initialTop;
function dragImage(id,ev){
if(browser_ie){
var ev=window.event;
}
var pos=getCursorPos(ev);
var x=pos.x;
var y=pos.y;
var imgEl=getObj("thumb_"+id);
currDragImgEl=imgEl;
var left=findPosX(imgEl);
var top=findPosY(imgEl);
var _350f=getSheetScrollLeft();
var _3510=getSheetScrollTop();
initialLeft=left+_350f-sheetLeft;
initialTop=top+_3510-sheetTop;
ghostImg=document.createElement("IMG");
ghostImg.src=imgEl.src;
ghostImg.style.opacity="0.75";
ghostImg.style.filter="alpha(opacity=75)";
ghostImg.style.width=imgEl.offsetWidth;
ghostImg.style.height=imgEl.offsetHeight;
ghostImg.style.position="absolute";
ghostImg.style.left=left+_350f-sheetLeft+"px";
ghostImg.style.top=top+_3510-sheetTop+"px";
ghostImg.style.zIndex="100000";
ghostImg.style.cursor="move";
imgDiffX=x-left;
imgDiffY=y-top;
sheetObjectsPane.appendChild(ghostImg);
if(browser_ie){
document.attachEvent("onmousemove",moveImage);
document.attachEvent("onmouseup",dropImage);
}else{
if(browser_nn6){
window.addEventListener("mousemove",moveImage,false);
window.addEventListener("mouseup",dropImage,false);
}
}
}
var imageDragged=false;
function moveImage(ev){
var left=ev.clientX+getSheetScrollLeft()-sheetLeft-imgDiffX;
var top=ev.clientY+getSheetScrollTop()-sheetTop-imgDiffY;
if(initialLeft!=left||initialTop!=top){
ghostImg.style.left=left+"px";
ghostImg.style.top=top+"px";
if(imageDragged){
closeDialog();
}
imageDragged=true;
}
}
function dropImage(){
if(browser_ie){
document.detachEvent("onmousemove",moveImage);
document.detachEvent("onmouseup",dropImage);
}else{
if(browser_nn6){
window.removeEventListener("mousemove",moveImage,false);
window.removeEventListener("mouseup",dropImage,false);
}
}
var left=parseInt(ghostImg.style.left);
var top=parseInt(ghostImg.style.top);
var imgEl=currDragImgEl;
sheetObjectsPane.removeChild(ghostImg);
ghostImg="";
currDragImgEl="";
imageDragged=false;
if(initialLeft!=left||initialTop!=top){
insertOrUploadImage(imgEl,left,top);
}
}
function resizeToOriginalDim(id){
var actWd=parseInt(getObj(id).getAttribute("actwd"));
var actHt=parseInt(getObj(id).getAttribute("actht"));
var img=ole.getCurrObj();
img.resizeTo(actWd,actHt).setSelectLayer();
resizeImage(id,actWd,actHt);
img.focus();
}
function saveImage(id){
if(typeof id!="undefined"){
var type=ole.getCurrObj().type;
var src=getObj(id).src;
if(type=="img"){
var seqNo=id.split("_")[1];
var _351f=getObj(id).getAttribute("imgid");
var _3520=getObj(id).getAttribute("name");
var _3521=_3520.split(".");
var idx1=src.indexOf("u_n=");
var idx2=src.indexOf("&",idx1);
if(idx1==-1){
u_n="";
}else{
if(idx2==-1){
var u_n=src.substring(idx1+4);
}else{
var u_n=src.substring(idx1+4,idx2);
}
}
exURL=ctxpath+"saveImage.do"+"?iVal="+_351f+"&type="+type+"&docowner="+CURR_DOC_OWNERNAME+"&iName="+_3521[0]+"&fileExtn="+_3521[1]+"&viewType="+getViewType()+"&src="+src+"&seqNo="+seqNo+"&read-write="+READ_WRITE+"&un="+u_n;
}else{
if(type=="chart"){
var idx=src.indexOf("ChartDisplay.do?");
if(idx==-1){
u_n="";
}else{
u_n="displayChart";
}
var _351f=getObj(id).getAttribute("dbid");
var _3526=getObj(id).chartName;
exURL=ctxpath+"saveImage.do"+"?iVal="+_351f+"&type="+type+"&docowner="+CURR_DOC_OWNERNAME+"&iName="+_3526+"&viewType="+getViewType()+"&src="+src+"&read-write="+READ_WRITE+"&un="+u_n;
}
}
}
try{
isExportEvent=true;
if(!isPublicView(getViewType())){
if(!SAVED){
saveForward="saveImage";
return savefilessamp();
}
}
window.open(exURL,"_blank");
}
catch(e){
}
}
function cloneImage(type,id,left,top,width,_352c,_352d){
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
var _3531=new getXmlhttp();
_3531.open("POST",ctxpath+"ImageUpload.do",true);
var nvp="isCloned=true&imgid="+getObj(_352d).getAttribute("imgid")+"&dummyId="+id+"&xPos="+left+"&yPos="+top+"&imgheight="+Math.round(_352c)+"&imgwidth="+Math.round(width)+"&"+csrfParamName+"="+csrfToken;
nvp+="&sheetname="+CURRSHEETNAME+"&docid="+DOCUMENT_ID+"&afterRTC=false"+"&docowner="+CURR_DOC_OWNERNAME;
nvp+="&bridgeNo="+bridgeNumber+"&curtime="+CURRENTTIME+"&row="+row+"&col="+col+"&insertAlreadyUploaded="+true;
nvp+="&imageurl="+getObj(_352d).getAttribute("src");
nvp+="&imgextn="+getObj(_352d).getAttribute("imgextn");
nvp+="&collabid="+COLLAB_ID+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING+"&viewType="+getViewType();
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
nvp+="&apiKey="+getObj("apiKey").value;
nvp+="&RMLOGINNAME="+RMUSER;
}
ole(id).sCol=findColInXPos(left);
ole(id).sRow=findRowInYPos(top);
ole(id).sRowDiff=top-getRowTop(ole(id).sRow);
ole(id).sColDiff=left-getColLeft(ole(id).sCol);
nvp+="&sCol="+ole(id).sCol+"&sRow="+ole(id).sRow+"&sColDiff="+ole(id).sColDiff+"&sRowDiff="+ole(id).sRowDiff;
_3531.onreadystatechange=function(){
if(_3531.readyState===4){
var _3533=eval("("+_3531.responseText+")");
var _3534=_3533["DUMMYID"];
var id="img_"+_3533["ID"];
var _3536=_3533["uploadedFileUrl"];
OLE[_3534].synchronizeClones(type,_3534,id);
}
};
_3531.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_3531.send(nvp);
}
function imageOnSync(id){
var _3538=ole(id).el;
var xPos=parseInt(_3538.style.left);
var yPos=parseInt(_3538.style.top);
var _353b=_3538.width;
var _353c=_3538.height;
resizeImage(_3538.id,_353b,_353c);
}
function showMoreActionsMenu(ev){
if(!imgMoreActionsMenuStatus){
var _353e="<menu id='ImageMoreActionsMenu' forElement='image_actionBar_moreActions'><item onclick='saveImage(ole.getCurrObj().id);'><![CDATA["+jsMsg["Image.SaveImageAs"]+"]]></item><sep></sep><item onclick='ole.currObj.clone(1,parseInt((10 * ole.currObj.cloneCountSinceLastDragOrResize) + ole.currObj.width + 10) ,parseInt((10 * ole.currObj.cloneCountSinceLastDragOrResize) + ole.currObj.height + 10));return false;'><![CDATA["+jsMsg.Clone+"]]></item><item onclick='ole.remove(ole.getCurrObj().id, true);'><![CDATA["+jsMsg.Delete+"]]></item></menu>";
Menu.create(_353e,{inputType:"xml"});
imgMoreActionsMenuStatus=true;
}
Menu.ImageMoreActionsMenu.cachedContent="";
ole.currObj.resetActionBarState();
showMenu("ImageMoreActionsMenu");
}
function closeImgActionBarMenus(id){
ole(id).hideContextMenu();
if(Menu.ImageMoreActionsMenu&&isMenuOpened("ImageMoreActionsMenu")){
hideMenu("ImageMoreActionsMenu");
}
}
ole.createObjectProperties("img",{focusLayer:"OLEFocusLayer",selectLayer:"OLESelectLayer",menuData:ImageMenuData,minHeight:10,minWidth:10,hasOrdering:false,actionBar:"ImageActionBar",contextMenu:"ImageConetextMenu",cloneOnCTRLDrag:true,resizeCorners:"all",resizeCornersBehaviour:"Proportional",onResizeStart:image_check,onResizeEnd:resizeImage,onDragEnd:positionImage,onRemove:removeImage,onObjectSwitch:closeImgActionBarMenus,onEditLayerClick:insertImageSelection,onClone:cloneImage,onMove:closeImgActionBarMenus,onMoveEnd:positionImage,onDocOpen:closeImgActionBarMenus,onSync:imageOnSync,onMouseDownOutsideOLEElements:closeImgActionBarMenus});
Menu=function(){
};
Menu.spacerImagePath="images/";
Menu._currMenuId="";
Menu._currMenuItemEl="";
Menu._currMenuItemPath="";
Menu._menuItemlen=4;
Menu._totLevels=0;
Menu._currLevels=1;
Menu._highestOpenedLevel=0;
Menu._currJSONStr="";
Menu._zIndexStart=1000000;
Menu._cursorXPos=0;
Menu._cursorYPos=0;
Menu._currSubMenuPos="";
Menu._subMenuOffsetXConst=5;
Menu._subMenuOffsetYConst=5;
Menu._dummyDIV=null;
Menu._considerShowOn=true;
Menu.create=function(input,_3541,type){
if(typeof _3541=="undefined"||_3541==null){
var _3543="html";
}else{
var _3543=_3541["inputType"];
}
if(_3543=="html"||_3543=="xml"){
if(_3543=="xml"){
var _3544=input;
if(browser_ie){
var _3545=new ActiveXObject("Microsoft.XMLDOM");
_3545.async="false";
_3545.loadXML(_3544);
}else{
if(browser_nn6){
var _3546=new DOMParser();
var _3545=_3546.parseFromString(_3544,"text/xml");
}
}
var x=_3545.documentElement;
}else{
var x=getObj(input).childNodes[0];
if(browser_nn6){
if(x.nodeName=="#text"){
x=getObj(input).childNodes[1];
}
}
}
var id=x.getAttribute("id");
if(typeof type!="undefined"&&type!=null){
var _3549=type;
}else{
if(typeof x.getAttribute("type")!="undefined"&&x.getAttribute("type")!=null){
var _3549=x.getAttribute("type");
}else{
var _3549="normal";
}
}
if(typeof x.getAttribute("forElement")!="undefined"&&x.getAttribute("forElement")!=null){
var forEl=x.getAttribute("forElement");
}else{
if(typeof x.getAttribute("forelement")!="undefined"&&x.getAttribute("forelement")!=null){
var forEl=x.getAttribute("forelement");
}else{
if(_3549=="context"){
var forEl="document.body";
}else{
var forEl="";
}
}
}
var _354b="";
if(typeof x.getAttribute("showOn")!="undefined"&&x.getAttribute("showOn")!=null){
_354b=x.getAttribute("showOn");
}else{
if(typeof x.getAttribute("showon")!="undefined"&&x.getAttribute("showon")!=null){
_354b=x.getAttribute("showon");
}
}
if(typeof x.getAttribute("onBeforeLoad")!="undefined"&&x.getAttribute("onBeforeLoad")!=null){
var _354c=x.getAttribute("onBeforeLoad");
}else{
if(typeof x.getAttribute("onbeforeload")!="undefined"&&x.getAttribute("onbeforeload")!=null){
var _354c=x.getAttribute("onbeforeload");
}else{
var _354c="";
}
}
if(typeof x.getAttribute("onLoad")!="undefined"&&x.getAttribute("onLoad")!=null){
var _354d=x.getAttribute("onLoad");
}else{
if(typeof x.getAttribute("onload")!="undefined"&&x.getAttribute("onload")!=null){
var _354d=x.getAttribute("onload");
}else{
var _354d="";
}
}
if(typeof x.getAttribute("onBeforeUnload")!="undefined"&&x.getAttribute("onBeforeUnload")!=null){
var _354e=x.getAttribute("onBeforeUnload");
}else{
if(typeof x.getAttribute("onbeforeunload")!="undefined"&&x.getAttribute("onbeforeunload")!=null){
var _354e=x.getAttribute("onbeforeunload");
}else{
var _354e="";
}
}
if(typeof x.getAttribute("menuItemType")!="undefined"&&x.getAttribute("menuItemType")!=null){
var _354f=x.getAttribute("menuItemType");
}else{
if(typeof x.getAttribute("menuItemType")!="undefined"&&x.getAttribute("menuItemType")!=null){
var _354f=x.getAttribute("menuItemType");
}else{
var _354f="";
}
}
if(typeof x.getAttribute("onUnload")!="undefined"&&x.getAttribute("onUnload")!=null){
var _3550=x.getAttribute("onUnload");
}else{
if(typeof x.getAttribute("onunload")!="undefined"&&x.getAttribute("onunload")!=null){
var _3550=x.getAttribute("onunload");
}else{
var _3550="";
}
}
this._currJSONStr+="[ ";
this._createJSONStr(_3543,x,1,"root");
this._currJSONStr+=" ]";
}
if(_3543=="jsonstring"){
this._currJSONStr=input;
}
if(_3543=="json"){
var _3551=input;
}else{
var _3551=eval(this._currJSONStr);
}
this[id]={id:id,data:_3551,type:_3549,forElement:forEl,showOn:_354b,levels:this._currLevels,levelIndex:0,menuItemType:_354f,cachedContent:"",isOpened:false,onBeforeLoad:_354c,onLoad:_354d,onBeforeUnload:_354e,onUnload:_3550,show:function(_3552){
Menu.show(this.id,_3552);
},hide:function(){
Menu.hide(this.id);
}};
this._currJSONStr="";
this._currLevels=1;
if(browser_ie){
document.attachEvent("onmousedown",function(){
Menu._mouseDown();
});
}else{
if(browser_nn6){
window.addEventListener("mousedown",function(ev){
Menu._mouseDown(ev);
},false);
}
}
if(forEl.trim().length>0){
if(forEl=="document.body"){
var _3554=document.documentElement;
}else{
var _3554=getObj(forEl);
}
_3554.setAttribute("_menuId",id);
}
if(_3549=="normal"){
if(forEl.trim().length>0){
var evt=(_354b=="")?"click":_354b;
if(browser_ie){
_3554.attachEvent("on"+evt,function(){
var el=window.event.srcElement;
if(el.getAttribute("_menuId")!=null){
Menu[el.getAttribute("_menuId")].show();
}
});
}else{
if(browser_nn6){
_3554.addEventListener(evt,function(ev){
Menu[this.getAttribute("_menuId")].show();
},false);
}
}
}
}else{
if(_3549=="context"){
if(browser_ie){
_3554.attachEvent("oncontextmenu",function(){
Menu._getCursorPos();
Menu[_3554.getAttribute("_menuId")].show();
return false;
});
}else{
if(browser_nn6){
_3554.addEventListener("contextmenu",function(ev){
Menu._getCursorPos(ev);
Menu[this.getAttribute("_menuId")].show();
ev.stopPropagation();
},false);
}
}
}
}
};
Menu._isCursorInsideMenu=function(ev){
this._getCursorPos(ev);
var _355a=false;
for(var i=1;i<=this._highestOpenedLevel;i++){
var _355c=getObj("_menuLevel-"+i);
var x=findPosX(_355c);
var y=findPosY(_355c);
var wd=_355c.offsetWidth;
var ht=_355c.offsetHeight;
if(this._cursorXPos>=x&&this._cursorXPos<=(x+wd)&&this._cursorYPos>=y&&this._cursorYPos<=(y+ht)){
_355a=true;
break;
}
}
return _355a;
};
Menu._isCursorInsideForElement=function(ev){
this._getCursorPos(ev);
var forEl=getObj(this[this._currMenuId].forElement);
var x=findPosX(forEl);
var y=findPosY(forEl);
var wd=forEl.offsetWidth;
var ht=forEl.offsetHeight;
return (this._cursorXPos>=x&&this._cursorXPos<=(x+wd)&&this._cursorYPos>=y&&this._cursorYPos<=(y+ht));
};
Menu._mouseDown=function(ev){
if(this._currMenuId!=""){
if(!this._isCursorInsideMenu(ev)){
if(this[this._currMenuId].type=="normal"){
if(this[this._currMenuId].forElement!=""){
if(!this._isCursorInsideForElement(ev)){
this.hide(ev);
}
}else{
this.hide(ev);
}
}else{
this.hide(ev);
}
}
}
};
Menu._mouseOver=function(ev){
if(this._currMenuId!=""){
var _3569=this[this._currMenuId];
if(this._considerShowOn&&_3569.showOn=="mouseover"){
if(typeof menuMouseOutIntvl!="undefined"&&menuMouseOutIntvl!=null){
clearTimeout(menuMouseOutIntvl);
}
if(!Menu._isCursorInsideMenu(ev)&&!Menu._isCursorInsideForElement(ev)){
menuMouseOutIntvl=setTimeout(function(){
if(Menu._currMenuId!=""){
Menu[Menu._currMenuId].hide();
clearTimeout(menuMouseOutIntvl);
}
},500);
}
}else{
if(!this._isCursorInsideMenu(ev)&&this._currMenuItemEl!=""){
this._itemMouseOut(ev);
}
}
}
};
Menu._createJSONStr=function(_356a,x,_356c,_356d){
for(var i=0,k=0;i<x.childNodes.length;i++){
var node=x.childNodes[i];
if(browser_nn6){
if(node.nodeName=="#text"){
continue;
}
}
var _3571=false;
var _3572=false;
if(_356a=="xml"){
if(node.tagName.toLowerCase()=="sep"){
_3571=true;
}
if(node.tagName.toLowerCase()=="label"){
_3572=true;
}
}else{
if(typeof node.getAttribute("sep")!="undefined"&&node.getAttribute("sep")!=null){
_3571=true;
}
if(typeof node.getAttribute("label")!="undefined"&&node.getAttribute("label")!=null){
_3572=true;
}
}
if(_3571&&_3572){
_3571=true;
}
if(_3571){
var _3573=(node.getAttribute("hidden")==null)?"":node.getAttribute("hidden");
this._currJSONStr+="{";
this._currJSONStr+="type : 'separator', ";
this._currJSONStr+="hidden : '"+_3573+"'";
this._currJSONStr+="}";
if(i!=x.childNodes.length-1){
this._currJSONStr+=", ";
}
k++;
}else{
if(_3572){
var _3574=x.childNodes[i].childNodes[0];
if(_3574.nodeName=="#text"||_3574.nodeName=="#cdata-section"){
var _3573=(node.getAttribute("hidden")==null)?"":node.getAttribute("hidden");
var _3575=(node.getAttribute("imgclass")==null)?"":node.getAttribute("imgclass");
this._currJSONStr+="{";
this._currJSONStr+="type : 'label', ";
this._currJSONStr+="hidden : '"+_3573+"', ";
this._currJSONStr+="imgClass : '"+_3575+"', ";
nodeValue=escapeSpecialChar(_3574.nodeValue.trim());
this._currJSONStr+="content : '"+nodeValue+"' ";
this._currJSONStr+="}";
if(i!=x.childNodes.length-1){
this._currJSONStr+=", ";
}
k++;
}
}else{
var _3574=x.childNodes[i].childNodes[0];
var _3576=x.childNodes[i].childNodes[1];
if(_3574.nodeName=="#text"||_3574.nodeName=="#cdata-section"){
this._currJSONStr+="{";
var rowId=(node.getAttribute("id")==null)?false:node.getAttribute("id");
var _3575=(node.getAttribute("imgclass")==null)?"":node.getAttribute("imgclass");
var _3578=(node.getAttribute("shortcut")==null)?"":node.getAttribute("shortcut");
var href=(node.getAttribute("href")==null)?"":node.getAttribute("href");
var _357a=(node.getAttribute("target")==null)?"":node.getAttribute("target");
var _357b=(x.getAttribute("menuItemType")==null)?"":x.getAttribute("menuItemType");
var _357c=(node.getAttribute("onclick")==null)?(node.getAttribute("onClick")==null)?"":node.getAttribute("onClick"):node.getAttribute("onclick");
if(typeof _357c=="function"){
_357c=String(_357c);
if(browser_ie){
_357c=_357c.substring(_357c.indexOf("{")+1,_357c.length-1).trim();
}
}
var _357d=(node.getAttribute("disabled")==null)?"":node.getAttribute("disabled");
var _3573=(node.getAttribute("hidden")==null)?"":node.getAttribute("hidden");
if(_356d=="root"){
var _357e=_356c;
var _357f="["+k+"]";
}else{
var _357e=_356c+1;
var _357f=_356d+".["+k+"]";
}
if(_357e>this._totLevels){
this._createMenuContainer(_357e);
this._totLevels=_357e;
}
if(_357e>this._currLevels){
this._currLevels=_357e;
}
if(rowId){
this._currJSONStr+="id : '"+rowId+"', ";
}
this._currJSONStr+="index : "+k+", ";
this._currJSONStr+="levelIndex : "+_357e+", ";
this._currJSONStr+="path : '"+_357f+"', ";
this._currJSONStr+="imgClass : '"+_3575+"', ";
this._currJSONStr+="shortCut : '"+_3578+"', ";
this._currJSONStr+="hidden : '"+_3573+"', ";
this._currJSONStr+="disabled : '"+_357d+"', ";
this._currJSONStr+="href : '"+href+"', ";
this._currJSONStr+="target : '"+_357a+"', ";
this._currJSONStr+="onClick : function() { "+_357c+" }, ";
nodeValue=escapeSpecialChar(_3574.nodeValue.trim());
this._currJSONStr+="content : '"+nodeValue+"', ";
if(typeof _3576!="undefined"&&_3576!=null){
this._currJSONStr+="hasSubMenu : true, ";
if(_357c!=""){
this._currJSONStr+="menuItemType : 'button', ";
}else{
this._currJSONStr+="menuItemType : 'normal', ";
}
this._currJSONStr+="cachedContent : '', ";
this._currJSONStr+="subMenu : [";
this._createJSONStr(_356a,_3576,_357e,_357f);
this._currJSONStr+=" ] ";
}else{
this._currJSONStr+="onClick : function() { "+_357c+" }, ";
this._currJSONStr+="hasSubMenu : false, ";
this._currJSONStr+="menuItemType : 'normal', ";
this._currJSONStr+="subMenu : '' ";
}
this._currJSONStr+="}";
if(i!=x.childNodes.length-1){
this._currJSONStr+=", ";
}
k++;
}
}
}
}
};
Menu._createMenuContainer=function(cnt){
var div=document.createElement("DIV");
div.id="_menuLevel-"+cnt;
div.className="menu";
div.style.position="absolute";
div.style.left="-100000px";
div.style.top="-100000px";
div.style.zIndex=Menu._zIndexStart+(cnt*2);
var _3582="<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">";
_3582+="<tr>";
_3582+="<td class=\"tl\"><img src=\""+this.spacerImagePath+"spacer.gif\" width=\"0\" height=\"0\"/></td>";
_3582+="<td class=\"tc\"><img src=\""+this.spacerImagePath+"spacer.gif\" width=\"0\" height=\"0\"/></td>";
_3582+="<td class=\"tr\"><img src=\""+this.spacerImagePath+"spacer.gif\" width=\"0\" height=\"0\"/></td>";
_3582+="</tr>";
_3582+="<tr>";
_3582+="<td class=\"ml\"></td>";
_3582+="<td class=\"mc\" id=\"_menuContentContainer-"+cnt+"\">";
_3582+="<table border=\"0\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">";
_3582+="<tr class=\"menuScroller\" id=\"_menuScrollerTop-"+cnt+"\" onmouseover=\"Menu._scrollerMouseOver(this, event, "+cnt+", 'top')\" onmouseout=\"Menu._scrollerMouseOut(this, event, "+cnt+")\">";
_3582+="<td class=\"start\"></td>";
_3582+="<td class=\"middle\"><img class=\"top\" src=\""+this.spacerImagePath+"spacer.gif\" width=\"1\" height=\"1\"/></td>";
_3582+="<td class=\"end\"></td>";
_3582+="</tr>";
_3582+="<tr>";
_3582+="<td colspan=\"3\">";
_3582+="<div id=\"_menuContent-"+cnt+"\" style=\"overflow:hidden;\"></div>";
_3582+="</td>";
_3582+="</tr>";
_3582+="<tr class=\"menuScroller\" id=\"_menuScrollerDown-"+cnt+"\"  onmouseover=\"Menu._scrollerMouseOver(this, event, "+cnt+", 'down')\" onmouseout=\"Menu._scrollerMouseOut(this, event, "+cnt+")\">";
_3582+="<td class=\"start\"></td>";
_3582+="<td class=\"middle\"><img class=\"down\" src=\""+this.spacerImagePath+"spacer.gif\" width=\"1\" height=\"1\"/></td>";
_3582+="<td class=\"end\"></td>";
_3582+="</tr>";
_3582+="</table>";
_3582+="</td>";
_3582+="<td class=\"mr\"></td>";
_3582+="</tr>";
_3582+="<tr>";
_3582+="<td class=\"bl\"><img src=\""+this.spacerImagePath+"spacer.gif\" width=\"0\" height=\"0\"/></td>";
_3582+="<td class=\"bc\"><img src=\""+this.spacerImagePath+"spacer.gif\" width=\"0\" height=\"0\"/></td>";
_3582+="<td class=\"br\"><img src=\""+this.spacerImagePath+"spacer.gif\" width=\"0\" height=\"0\"/></td>";
_3582+="</tr>";
_3582+="</table>";
div.innerHTML=_3582;
div.oncontextmenu=function(ev){
if(browser_ie){
window.event.cancelBubble=true;
}else{
if(browser_nn6){
ev.stopPropagation();
}
}
};
document.body.appendChild(div);
if(browser_ie6){
}
};
Menu._setIframeProps=function(_3584,left,top,width,_3588){
var _3589=getObj("_menuLevelIFrameHack-"+_3584);
_3589.style.left=left+"px";
_3589.style.top=top+"px";
_3589.style.width=width+"px";
_3589.style.height=_3588+"px";
};
Menu._getCursorPos=function(ev){
if(browser_ie){
var ev=window.event;
}
var _358b=getCursorPos(ev);
this._cursorXPos=_358b.x;
this._cursorYPos=_358b.y;
};
Menu._constructMenu=function(data){
var _358d="<table cellspacing=\"0\" cellpadding=\"0\">";
for(var i=0;i<data.length;i++){
var _358f="";
if(data[i].hidden.toLowerCase()=="true"||data[i].hidden.toLowerCase()=="yes"||data[i].hidden=="1"){
_358f="style='display:none'";
}
if(typeof data[i].type!="undefined"&&data[i].type=="separator"){
_358d+="<tr "+_358f+">";
_358d+="<td class=\"menuSepStart\">";
if(browser_ie){
_358d+="<img src=\""+this.spacerImagePath+"spacer.gif\" width=\"1\" height=\"1\"/>";
}
_358d+="</td>";
_358d+="<td class=\"menuSep\" colspan=\"4\">";
if(browser_ie){
_358d+="<img src=\""+this.spacerImagePath+"spacer.gif\" width=\"1\" height=\"1\"/>";
}
_358d+="</td>";
_358d+="<td class=\"menuSepEnd\"><img src=\""+this.spacerImagePath+"spacer.gif\" width=\"1\" height=\"1\"/>";
if(browser_ie){
_358d+="<img src=\""+this.spacerImagePath+"spacer.gif\" width=\"1\" height=\"1\"/>";
}
_358d+="</td>";
_358d+="</tr>";
}else{
if(typeof data[i].type!="undefined"&&data[i].type=="label"){
_358d+="<tr "+_358f+">";
var _3590=data[i].imgClass;
if(_3590){
_358d+="<td class=\""+_3590+"\">";
}else{
_358d+="<td class=\"menuLabelStart\">";
}
if(browser_ie){
_358d+="<img src=\""+this.spacerImagePath+"spacer.gif\" width=\"1\" height=\"1\"/>";
}
_358d+="</td>";
var _3591=unescapeSpecialChar(data[i].content);
_358d+="<td class=\"menuLabel\" colspan=\"4\">"+_3591+"</span></td>";
_358d+="<td class=\"menuLabelEnd\">";
if(browser_ie){
_358d+="<img src=\""+this.spacerImagePath+"spacer.gif\" width=\"1\" height=\"1\"/>";
}
_358d+="</td>";
_358d+="</tr>";
}else{
var _3590=data[i].imgClass;
var _3591=unescapeSpecialChar(data[i].content);
var _3592=data[i].shortCut;
var _3593=(data[i].hasSubMenu)?"subMenuPtr":"";
var _3594=disabledAttrib="";
if(data[i].disabled.toLowerCase()=="true"||data[i].disabled.toLowerCase()=="yes"||data[i].disabled=="1"){
_3594="disabled";
disabledAttrib="true";
}
var _3595=data[i].id;
var tRow="<tr ";
if(_3595){
tRow="<tr id=\""+_3595+"\" ";
}
if(data[i].disabled=="true"||(data[i].hasSubMenu&&data[i].menuItemType!="button")){
_358d+=tRow+" class=\"menuItemCont-disabled\""+_358f+" disable=\""+disabledAttrib+"\" menuItemType=\""+data[i].menuItemType+"\" path=\""+data[i].path+"\" index=\""+data[i].index+"\" levelIndex=\""+data[i].levelIndex+"\" hasSubMenu=\""+data[i].hasSubMenu+"\" onmouseover=\"Menu._itemMouseOver(this, event)\" onclick=\"Menu._itemClick(this, event)\">";
}else{
_358d+=tRow+" class=\"menuItemCont-mouseover\""+_358f+" disable=\""+disabledAttrib+"\" menuItemType=\""+data[i].menuItemType+"\" path=\""+data[i].path+"\" index=\""+data[i].index+"\" levelIndex=\""+data[i].levelIndex+"\" hasSubMenu=\""+data[i].hasSubMenu+"\" onmouseover=\"Menu._itemMouseOver(this, event)\" onclick=\"Menu._itemClick(this, event)\">";
}
_358d+="<td class=\"menuItemStart\" onmouseover=\"Menu._itemMenuMouseOver(this, event)\"></td>";
_358d+="<td class=\"menuItemImg\" onmouseover=\"Menu._itemMenuMouseOver(this, event)\"><img class=\""+_3590+"\" src=\""+this.spacerImagePath+"spacer.gif\" width=\"1\" height=\"1\"/></td>";
_358d+="<td class=\"menuItem\" onmouseover=\"Menu._itemMenuMouseOver(this, event)\"><span class=\""+_3594+"\">"+_3591+"</span></td>";
_358d+="<td class=\"menuItemShortCut\" onmouseover=\"Menu._itemMenuMouseOver(this, event)\"><span class=\""+_3594+"\">"+_3592+"</span></td>";
if(data[i].menuItemType=="button"){
_358d+="<td class=\"menuItemSubmenuBtn\"  onclick=\"Menu._clearAction(this,event)\" onmouseover=\"Menu._itemSubMenuMouseOver(this, event)\" ><img class=\""+_3593+"\" src=\""+this.spacerImagePath+"spacer.gif\"  width=\"1\" height=\"1\"/></td>";
}else{
_358d+="<td class=\"menuItemSubMenu\"><img class=\""+_3593+"\" src=\""+this.spacerImagePath+"spacer.gif\"  width=\"1\" height=\"1\"/></td>";
_358d+="<td class=\"menuItemEnd\"></td>";
}
_358d+="</tr>";
}
}
}
_358d+="</table>";
return _358d;
};
Menu._itemMouseOver=function(trEl,ev){
var path=trEl.getAttribute("path");
if(path!=this._currMenuItemPath){
var index=trEl.getAttribute("index");
var _359b=parseInt(trEl.getAttribute("levelIndex"));
var _359c=eval(trEl.getAttribute("hasSubMenu"));
var _359d=this._currMenuItemPath;
_359d=_359d.replace(/\[/gi,"");
_359d=_359d.replace(/\]/gi,"");
var _359e=trEl.getAttribute("menuItemType");
prevPathAry=_359d.split(".");
var _359f=prevPathAry.length;
var _35a0=false;
var _35a1=false;
var _35a2=false;
var tdCol=trEl.getElementsByTagName("TD");
if(_359b==_359f){
_35a2=true;
}else{
if(_359b<_359f){
_35a0=true;
if(index==prevPathAry[_359b-1]){
_35a1=true;
}else{
_35a1=false;
}
}
}
if(this._currMenuItemEl!=""){
var _35a4=eval(this._currMenuItemEl.getAttribute("hasSubMenu"));
if(_35a2||(_35a0&&!_35a1)||(_35a1&&!_35a4)){
var tdEl=this._currMenuItemEl.getElementsByTagName("TD");
for(var i=0;i<tdEl.length;i++){
tdEl[i].className=tdEl[i].className.substr(0,tdEl[i].className.indexOf("-"));
}
if(_35a0&&!_35a1){
var _35a7=getObj("_menuContent-"+_359b);
var _35a8=prevPathAry[_359b-1];
var _35a9=_35a7.getElementsByTagName("TABLE")[0].getElementsByTagName("TR")[_35a8];
var tdEl=_35a9.getElementsByTagName("TD");
for(var i=0;i<tdEl.length;i++){
tdEl[i].className=tdEl[i].className.substr(0,tdEl[i].className.indexOf("-"));
}
}
}else{
if(_35a1&&_35a4){
return;
}
}
}
if(!_35a1){
var tdEl=trEl.getElementsByTagName("TD");
if(_359e=="button"){
for(var i=0;i<Menu._menuItemlen;i++){
if(tdEl[i].className.indexOf("mouseover")<0){
tdEl[i].className+="-mouseover";
}
}
for(var i=Menu._menuItemlen;i<tdEl.length;i++){
if(tdEl[i].className.indexOf("Btn-Normal")<0){
tdEl[i].className+="-Normal";
}
}
}else{
for(var i=0;i<Menu._menuItemlen;i++){
if(tdEl[i].className.indexOf("mouseover")<0){
tdEl[i].className+="-mouseover";
}
}
for(var i=Menu._menuItemlen;i<tdEl.length;i++){
tdEl[i].className+="-mouseover";
}
}
this._hideSubMenus(_359b);
if(_359c){
this._showSubMenu(this._currMenuId,path,_359b,trEl);
}
}
this._currMenuItemPath=path;
this._currMenuItemEl=trEl;
}
};
Menu._itemMenuMouseOver=function(tdEl,ev){
var trEl=tdEl.parentNode;
var _35ad=trEl.getAttribute("menuItemType");
var tdCol=trEl.getElementsByTagName("TD");
if(_35ad=="button"){
for(var i=0;i<Menu._menuItemlen;i++){
if(tdCol[i].className.lastIndexOf("-inactive")!=-1){
tdCol[i].className=tdCol[i].className.substr(0,tdCol[i].className.indexOf("-"));
tdCol[i].className+="-mouseover";
}
}
for(var i=Menu._menuItemlen;i<tdCol.length;i++){
if(tdCol[i].className.indexOf("Btn-Mouseover")!=-1){
tdCol[i].className=tdCol[i].className.substr(0,tdCol[i].className.indexOf("-"));
tdCol[i].className+="-Normal";
}
}
}
};
Menu._itemSubMenuMouseOver=function(tdEl,ev){
var trEl=tdEl.parentNode;
var _35b3=trEl.getAttribute("menuItemType");
var tdCol=trEl.getElementsByTagName("TD");
if(_35b3=="button"){
for(var i=0;i<Menu._menuItemlen;i++){
if(tdCol[i].className.lastIndexOf("-mouseover")!=-1){
tdCol[i].className=tdCol[i].className.substr(0,tdCol[i].className.indexOf("-"));
tdCol[i].className+="-inactive";
}
}
tdEl=trEl.getElementsByTagName("TD");
for(var i=Menu._menuItemlen;i<tdEl.length;i++){
if(tdEl[i].className.indexOf("-Normal")!=-1){
tdCol[i].className=tdCol[i].className.substr(0,tdCol[i].className.indexOf("-"));
tdCol[i].className+="-Mouseover";
}
}
}
};
Menu._itemMouseOut=function(){
if(this._currMenuItemPath!=""){
var _35b6=this._currMenuItemPath;
_35b6=_35b6.replace(/\[/gi,"");
_35b6=_35b6.replace(/\]/gi,"");
var _35b7=_35b6.split(".");
var _35b8=_35b7.length;
if(_35b8==this._highestOpenedLevel){
var tdEl=this._currMenuItemEl.getElementsByTagName("TD");
for(var i=0;i<tdEl.length;i++){
tdEl[i].className=tdEl[i].className.substr(0,tdEl[i].className.indexOf("-"));
}
if(_35b8>1){
var _35bb=getObj("_menuContent-"+(_35b8-1)).getElementsByTagName("TABLE")[0].getElementsByTagName("TR")[_35b7[_35b7.length-2]];
this._currMenuItemEl=_35bb;
this._currMenuItemPath=_35bb.getAttribute("path");
}else{
this._currMenuItemEl="";
this._currMenuItemPath="";
}
}
}
};
Menu._itemClick=function(trEl,ev){
if(trEl.getAttribute("disable")!="true"&&trEl.getAttribute("disable")!="yes"&&trEl.getAttribute("disable")!="1"){
var _35be=jsonPath(this[this._currMenuId].data,"$."+trEl.getAttribute("path"))[0];
_35be.onClick();
if(!(trEl.getAttribute("menuitemtype")!="button"&&trEl.getAttribute("hasSubMenu")=="true")){
this.hide(ev);
}
if(_35be.href.trim().length>0){
var _35bf=(_35be.target=="")?"_self":_35be.target;
var _35c0=window.open(_35be.href,_35bf);
_35c0.focus();
}
}else{
if(browser_ie){
window.event.cancelBubble=true;
}else{
if(browser_nn6){
ev.stopPropagation();
}
}
}
};
Menu._clearAction=function(tdEl,ev){
if(browser_ie){
window.event.cancelBubble=true;
}else{
if(ev.stopPropagation){
ev.stopPropagation();
}
}
};
Menu._showSubMenu=function(_35c3,path,_35c5,trEl){
var _35c7=this[_35c3].data;
var _35c8=jsonPath(_35c7,"$."+path);
if(_35c8[0].cachedContent.trim().length==0){
var _35c9=_35c8[0].cachedContent=this._constructMenu(_35c8[0].subMenu);
}else{
var _35c9=_35c8[0].cachedContent;
}
var _35ca=_35c5+1;
var _35cb=getObj("_menuLevel-"+_35ca);
if(browser_ie){
_35cb.getElementsByTagName("TABLE")[0].border="1";
}
getObj("_menuContent-"+_35ca).innerHTML=_35c9;
if(browser_ie){
_35cb.getElementsByTagName("TABLE")[0].border="0";
}
var _35cc=getObj("_menuLevel-"+_35c5);
var _35cd=getObj("_menuContent-"+_35c5);
var _35ce=findPosX(_35cc);
var _35cf=_35cc.offsetWidth;
var x=_35ce+_35cf;
var page=findDocDim();
var _35d2=document.documentElement.scrollTop;
var _35d3=document.documentElement.scrollLeft;
if(this._currSubMenuPos=="right"){
if(x+_35cb.offsetWidth>page.width+_35d3){
x=_35ce+_35d3-_35cb.offsetWidth+this._subMenuOffsetXConst;
this._currSubMenuPos="left";
}else{
x=x-this._subMenuOffsetXConst;
this._currSubMenuPos="right";
}
}else{
x=_35ce-_35cb.offsetWidth+this._subMenuOffsetXConst;
}
if(x<0){
x=this._subMenuOffsetXConst;
this._currSubMenuPos="right";
}
var y=findPosY(trEl)+this._subMenuOffsetYConst-_35cd.scrollTop;
var _35d5;
var _35d6=findClientDim();
if(_35cb.offsetHeight>_35d6.height-50){
_35d5=true;
getObj("_menuScrollerTop-"+_35ca).style.display="";
getObj("_menuScrollerDown-"+_35ca).style.display="";
getObj("_menuContent-"+_35ca).style.height=((_35d6.height-50<0)?_35d6.height:_35d6.height-50)+"px";
y=5;
}else{
getObj("_menuScrollerTop-"+_35ca).style.display="none";
getObj("_menuScrollerDown-"+_35ca).style.display="none";
getObj("_menuContent-"+_35ca).style.height="";
}
if(!_35d5&&y+_35cb.offsetHeight>page.height+_35d2){
y=page.height+_35d2-_35cb.offsetHeight;
}
if(y<0){
y=0;
}
if(browser_ie6){
}
if(browser_nn6&&x>page.width){
_35cb.style.position="";
_35cb.style.width=(_35cb.childNodes[0].offsetWidth)+"px";
_35cb.style.position="absolute";
}
_35cb.style.left=x+"px";
_35cb.style.top=y+"px";
if(_35ca>this._highestOpenedLevel){
this._highestOpenedLevel=_35ca;
}
};
Menu._hideSubMenus=function(_35d7,_35d8){
if(typeof _35d8=="undefined"||params==null){
var _35d8=this._highestOpenedLevel;
}
for(var i=_35d7+1;i<=_35d8;i++){
var _35da=getObj("_menuLevel-"+i);
_35da.style.left="-100000px";
_35da.style.top="-100000px";
getObj("_menuContent-"+i).innerHTML="";
getObj("_menuContent-"+i).style.height="";
getObj("_menuContent-"+i).scrollTop=0;
}
this._highestOpenedLevel=_35d7;
};
Menu._getXRelativeToPage=function(x,page,_35dd){
if(x-document.documentElement.scrollLeft+_35dd.offsetWidth>page.width){
x=page.width-_35dd.offsetWidth;
this._currSubMenuPos="left";
}else{
this._currSubMenuPos="right";
}
return x;
};
Menu._getXRelativeToElement=function(forEl,x,page,_35e1){
var _35e2=x;
if(x-document.documentElement.scrollLeft+_35e1.offsetWidth>page.width){
x=_35e2+forEl.offsetWidth-_35e1.offsetWidth;
this._currSubMenuPos="left";
}else{
this._currSubMenuPos="right";
}
return x;
};
Menu.show=function(id,_35e4){
var _35e5=this[id].onBeforeLoad;
if(_35e5!=""){
var _35e6=eval(_35e5);
if(_35e6==false){
return;
}
}
var data=jsonPath(this[id].data,"$.*");
if(this[id].cachedContent.trim().length==0){
var _35e8=this[id].cachedContent=this._constructMenu(data);
}else{
var _35e8=this[id].cachedContent;
}
var _35e9=getObj("_menuLevel-1");
if(browser_ie){
_35e9.getElementsByTagName("TABLE")[0].border="1";
}
getObj("_menuContent-1").innerHTML=_35e8;
if(browser_ie){
_35e9.getElementsByTagName("TABLE")[0].border="0";
}
var page=findDocDim();
var _35eb=document.documentElement.scrollTop;
var _35ec=document.documentElement.scrollLeft;
if(typeof _35e4=="undefined"||_35e4==null){
this._considerShowOn=true;
if(this[id].type=="context"){
var x=this._cursorXPos;
var y=this._cursorYPos;
x=this._getXRelativeToPage(x,page,_35e9);
}else{
if(this[id].type=="normal"){
if(this[id].forElement!=""){
var forEl=getObj(this[id].forElement);
var x=findPosX(forEl);
var y=findPosY(forEl)+forEl.offsetHeight;
x=this._getXRelativeToElement(forEl,x,page,_35e9);
}else{
var x=0;
var y=0;
}
}
}
}else{
this._considerShowOn=false;
if(_35e4["position"]=="relative"){
if(typeof _35e4["forElement"]!="undefined"&&_35e4["forElement"]!=null){
var forEl=getObj(_35e4["forElement"]);
var x=findPosX(forEl);
var y=findPosY(forEl)+forEl.offsetHeight;
x=this._getXRelativeToElement(forEl,x,page,_35e9);
}else{
var x=0;
var y=0;
}
}else{
if(_35e4["position"]=="absolute"){
var x=parseInt(_35e4["left"]);
var y=parseInt(_35e4["top"]);
x=this._getXRelativeToPage(x,page,_35e9);
}
}
}
if(isNaN(x)&&isNaN(y)){
var x=0;
var y=0;
}
var _35f0;
var _35f1=findClientDim();
if(_35e9.offsetHeight>_35f1.height-50){
_35f0=true;
getObj("_menuScrollerTop-1").style.display="";
getObj("_menuScrollerDown-1").style.display="";
getObj("_menuContent-1").style.height=((_35f1.height-50<0)?_35f1.height:_35f1.height-50)+"px";
y=5;
}else{
getObj("_menuScrollerTop-1").style.display="none";
getObj("_menuScrollerDown-1").style.display="none";
getObj("_menuContent-1").style.height="";
getObj("_menuContent-1").scrollTop=0;
}
if(!_35f0&&y+_35e9.offsetHeight>page.height+_35eb){
if((typeof _35e4=="undefined"||_35e4==null)&&this[id].type=="normal"&&this[id].forElement!=""){
y=findPosY(forEl)-_35e9.offsetHeight;
}else{
if(typeof _35e4!="undefined"&&_35e4["position"]=="relative"&&(typeof _35e4["forElement"]!="undefined"&&_35e4["forElement"]!=null)){
y=findPosY(forEl)-_35e9.offsetHeight;
}else{
y=page.height+_35eb-_35e9.offsetHeight;
}
}
}
if(x<0){
x=0;
}
if(y<0){
y=0;
}
if(browser_ie6){
}
if(browser_nn6&&x>page.width){
_35e9.style.position="";
_35e9.style.width=(_35e9.childNodes[0].offsetWidth)+"px";
_35e9.style.position="absolute";
}
_35e9.style.left=x+"px";
_35e9.style.top=y+"px";
this._currMenuId=id;
this._highestOpenedLevel=1;
this[id].isOpened=true;
if(browser_ie){
document.attachEvent("onmouseover",function(){
Menu._mouseOver();
});
}else{
if(browser_nn6){
window.addEventListener("mouseover",function(ev){
Menu._mouseOver(ev);
},false);
}
}
var _35f3=this[id].onLoad;
if(_35f3!=""){
eval(_35f3);
}
};
Menu.hide=function(ev){
if(this._currMenuId!=""&&this[this._currMenuId].isOpened){
var _35f5=this[this._currMenuId].onBeforeUnload;
if(_35f5!=""){
var _35f6=eval(_35f5);
if(_35f6==false){
return;
}
}
for(var i=1;i<=this._highestOpenedLevel;i++){
var _35f8=getObj("_menuLevel-"+i);
_35f8.style.left="-100000px";
_35f8.style.top="-100000px";
if(browser_ie){
_35f8.getElementsByTagName("TABLE")[0].border="1";
}
getObj("_menuContent-"+i).innerHTML="&nbsp;";
getObj("_menuContent-"+i).style.height="";
if(browser_ie){
_35f8.getElementsByTagName("TABLE")[0].border="0";
}
if(browser_ie6){
}
}
this[this._currMenuId].isOpened=false;
var _35f9=this[this._currMenuId].onUnload;
this._currMenuId="";
this._currMenuItemPath="";
this._currSubMenuPos="";
this._highestOpenedLevel=0;
if(browser_ie){
document.detachEvent("onmouseover",function(){
Menu._mouseOver();
});
}else{
if(browser_nn6){
window.removeEventListener("mouseover",function(ev){
Menu._mouseOver(ev);
},false);
}
}
if(_35f9!=""){
eval(_35f9);
}
}
};
Menu._scrollerMouseOver=function(el,ev,_35fd,_35fe){
this._itemMouseOut(ev);
var tdEl=el.getElementsByTagName("TD");
for(var i=0;i<tdEl.length;i++){
if(tdEl[i].className.indexOf("-")<0){
tdEl[i].className+="-mouseover";
}
}
var divEl=el.getElementsByTagName("IMG");
if(divEl[0].className.indexOf("-")<0){
divEl[0].className+="-mouseover";
}
if(typeof menuScrollerIntvl!="undefined"&&menuScrollerIntvl!=null){
clearInterval(menuScrollerIntvl);
}
if(_35fe=="top"){
menuScrollerIntvl=setInterval("Menu._scrollTop("+_35fd+")",1);
}else{
menuScrollerIntvl=setInterval("Menu._scrollDown("+_35fd+")",1);
}
};
Menu._scrollerMouseOut=function(el,ev,_3604){
var tdEl=el.getElementsByTagName("TD");
for(var i=0;i<tdEl.length;i++){
if(tdEl[i].className.indexOf("-")>-1){
tdEl[i].className=tdEl[i].className.substr(0,tdEl[i].className.indexOf("-"));
}
}
var divEl=el.getElementsByTagName("IMG");
if(divEl[0].className.indexOf("-")>-1){
divEl[0].className=divEl[0].className.substr(0,divEl[0].className.indexOf("-"));
}
if(typeof menuScrollerIntvl!="undefined"&&menuScrollerIntvl!=null){
clearInterval(menuScrollerIntvl);
}
};
Menu._scrollTop=function(_3608){
getObj("_menuContent-"+_3608).scrollTop-=5;
};
Menu._scrollDown=function(_3609){
getObj("_menuContent-"+_3609).scrollTop+=5;
};
function createMenu(input,_360b){
Menu.create(input,_360b,"normal");
}
function showMenu(_360c,_360d){
if(typeof _360d!="undefined"&&typeof _360d!=null){
Menu[_360c].show(_360d);
}else{
Menu[_360c].show();
}
}
function hideMenu(_360e){
Menu[_360e].hide();
}
function isMenuOpened(_360f){
return Menu[_360f].isOpened;
}
function createContextMenu(input,_3611){
Menu.create(input,_3611,"context");
}
function showContextMenu(_3612){
Menu[_3612].show();
}
function hideContextMenu(_3613){
Menu[_3613].hide();
}
function jsonPath(obj,expr,arg){
var P={resultType:arg&&arg.resultType||"VALUE",result:[],normalize:function(expr){
var subx=[];
return expr.replace(/[\['](\??\(.*?\))[\]']/g,function($0,$1){
return "[#"+(subx.push($1)-1)+"]";
}).replace(/'?\.'?|\['?/g,";").replace(/;;;|;;/g,";..;").replace(/;$|'?\]|'$/g,"").replace(/#([0-9]+)/g,function($0,$1){
return subx[$1];
});
},asPath:function(path){
var x=path.split(";"),p="$";
for(var i=1,n=x.length;i<n;i++){
p+=/^[0-9*]+$/.test(x[i])?("["+x[i]+"]"):("['"+x[i]+"']");
}
return p;
},store:function(p,v){
if(p){
P.result[P.result.length]=P.resultType=="PATH"?P.asPath(p):v;
}
return !!p;
},trace:function(expr,val,path){
if(expr){
var x=expr.split(";"),loc=x.shift();
x=x.join(";");
if(val&&val.hasOwnProperty(loc)){
P.trace(x,val[loc],path+";"+loc);
}else{
if(loc==="*"){
P.walk(loc,x,val,path,function(m,l,x,v,p){
P.trace(m+";"+x,v,p);
});
}else{
if(loc===".."){
P.trace(x,val,path);
P.walk(loc,x,val,path,function(m,l,x,v,p){
typeof v[m]==="object"&&P.trace("..;"+x,v[m],p+";"+m);
});
}else{
if(/,/.test(loc)){
for(var s=loc.split(/'?,'?/),i=0,n=s.length;i<n;i++){
P.trace(s[i]+";"+x,val,path);
}
}else{
if(/^\(.*?\)$/.test(loc)){
P.trace(P.eval(loc,val,path.substr(path.lastIndexOf(";")+1))+";"+x,val,path);
}else{
if(/^\?\(.*?\)$/.test(loc)){
P.walk(loc,x,val,path,function(m,l,x,v,p){
if(P.eval(l.replace(/^\?\((.*?)\)$/,"$1"),v[m],m)){
P.trace(m+";"+x,v,p);
}
});
}else{
if(/^(-?[0-9]*):(-?[0-9]*):?([0-9]*)$/.test(loc)){
P.slice(loc,x,val,path);
}
}
}
}
}
}
}
}else{
P.store(path,val);
}
},walk:function(loc,expr,val,path,f){
if(val instanceof Array){
for(var i=0,n=val.length;i<n;i++){
if(i in val){
f(i,loc,expr,val,path);
}
}
}else{
if(typeof val==="object"){
for(var m in val){
if(val.hasOwnProperty(m)){
f(m,loc,expr,val,path);
}
}
}
}
},slice:function(loc,expr,val,path){
if(val instanceof Array){
var len=val.length,start=0,end=len,step=1;
loc.replace(/^(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)$/g,function($0,$1,$2,$3){
start=parseInt($1||start);
end=parseInt($2||end);
step=parseInt($3||step);
});
start=(start<0)?Math.max(0,start+len):Math.min(len,start);
end=(end<0)?Math.max(0,end+len):Math.min(len,end);
for(var i=start;i<end;i+=step){
P.trace(i+";"+expr,val,path);
}
}
},eval:function(x,_v,_3653){
try{
return $&&_v&&eval(x.replace(/@/g,"_v"));
}
catch(e){
throw new SyntaxError("jsonPath: "+e.message+": "+x.replace(/@/g,"_v").replace(/\^/g,"_a"));
}
}};
var $=obj;
if(expr&&obj&&(P.resultType=="VALUE"||P.resultType=="PATH")){
P.trace(P.normalize(expr).replace(/^\$;/,""),obj,"$");
return P.result.length?P.result:false;
}
}
var namedRanges=new Array();
var fromUsrInfo=false;
var VIEWUNAME="";
var VIEWUPOS="";
function callGoToJsp(){
namedRanges=new Array();
for(var i=0;i<NAMEDRANGES.length;i++){
var _3656=NAMEDRANGES[i];
namedRanges[i]=_3656["NAME"];
namedRanges[i]=encodeURIComponent(namedRanges[i]);
}
namedRanges=namedRanges.sort();
var _3657=getXMLHttpRequest();
_3657.open("POST",ctxpath+"pages/goto.jsp",true);
_3657.onreadystatechange=function(){
if(_3657.readyState==4){
showDialog(_3657.responseText,"closeOnBodyClick=yes, width=300px, title="+jsTitleMsg.Goto,function(){
window.setTimeout(function(){
getObj("cellRef").focus();
},100);
});
}
};
_3657.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_3657.send("namedRanges="+namedRanges);
}
function suggestListNames(_3658){
if(typeof _3658=="undefined"){
var val=getObj("cellRef").value.trim().toUpperCase();
}else{
var val=currCellIndicator.value.trim().toUpperCase();
}
if(NAMEDRANGES.length!=0){
var count=0;
for(var i=0;i<NAMEDRANGES.length;i++){
if(typeof _3658=="undefined"){
var x=getObj("definedNameTR_"+i);
}else{
var x=getObj("defNameTR_"+i);
}
if(namedRanges[i].toUpperCase().indexOf(val)!=0){
x.style.display="none";
}else{
count++;
x.style.display="";
}
}
var _365d=getObj("definedNameListDIV");
if(_365d!=null){
if(count==0){
_365d.style.display="none";
}else{
_365d.style.display="";
}
}
}
}
function gotoCellInit(val){
var _365f=getObj("cellRef");
var ref=(val)?val:_365f.value.trim();
ref=ref.replace(/\$/g,"").replace(".","!");
gotoCellByParam(ref);
}
function gotoCellByParam(ref){
var _3662=ref;
if(_3662.indexOf("!")!=-1){
_3662=_3662.substring(_3662.indexOf("!")+1,_3662.length);
}
if(isDefinedName(_3662)){
gotoCellByName(_3662);
return false;
}
if(isDefinedSheet(ref)){
ref=ref+"!A1";
}
if(forCellLblCheck(ref,"cellRef")){
gotoCellByLbl(ref);
}
}
var lbl;
function gotoCellByLbl(_3663){
lbl=_3663;
lbl=lbl.replace(".","!");
var _3664=true;
var _3665=CURRSHEETNAME;
if(lbl.indexOf("!")!=-1){
_3665=lbl.substring(0,lbl.indexOf("!"));
_3665=getRequiredSheetNames(_3665).sheetName;
lbl=lbl.substring(lbl.indexOf("!")+1,lbl.length);
_3664=false;
}
if(_3665==CURRSHEETNAME){
if(lbl.indexOf(":")>1){
var _3666=lbl.substring(0,lbl.indexOf(":"));
pos=getCellPosByLabel(_3666);
}else{
pos=getCellPosByLabel(lbl);
}
if(pos.col>totCols-1){
showAlertDialog(jsTitleMsg.NotYetCreatedCell);
var _3667=getObj("cellRef");
if(_3667!=null){
_3667.focus();
_3667.select();
}
return false;
}
}
if(lbl.indexOf(":")>1){
rangeFocus(lbl);
}
if(_3664||_3665==CURRSHEETNAME){
gotoCell();
}else{
fromGoTo=true;
showsheet("sheetdiv-"+_3665,"open");
}
}
var namedsR=-1;
var namedsC;
var namedeR;
var namedeC;
function gotoCellByName(_3668){
for(var i=0;i<NAMEDRANGES.length;i++){
var _366a=NAMEDRANGES[i];
var named=_366a["NAME"];
if(named.toUpperCase()==_3668.toUpperCase()){
var _366c=_366a["REFSHEET"];
if(!_366c){
var _366d=getXMLHttpRequest();
_366d.open("POST",ctxpath+"namedRanges.do",false);
var _366e=encodeURIComponent(CURRSHEETNAME);
var nvp="action=READ&docid="+DOCUMENT_ID+"&cellName="+named+"&curtime="+CURRENTTIME+"&sheetname="+_366e+"&row="+currRow+"&column="+currCol+"&bridgeNo="+bridgeNumber+"&docowner="+CURR_DOC_OWNERNAME;
nvp+="&viewType="+getViewType()+"&isStockConfigured="+isStockConfigured+"&isDocSaved="+SAVED+"&fileFormat="+FILE_FORMAT;
nvp+="&availableStartRow="+getAvailableStartRow();
nvp+="&availableEndRow="+getAvailableEndRow();
nvp=appendCSRFToURL(nvp);
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols;
if(jsPUBLIC_VIEW){
nvp+="&loadObject="+LOAD_OBJECT_IN_PUBLIC;
}
_366d.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_366d.send(nvp);
var resp=_366d.responseXML;
var _3671=resp;
var _3672=new Array();
if(_366d.responseText!="Not Authorized"){
updateNamedRangesFromXml(_3671,"read",_3672);
}
var _3673="";
if(_3672.length>0){
_366a=_3672[0];
}
}
_366c=_366a["REFSHEET"];
namedsR=_366a["STARTROW"];
namedsC=_366a["STARTCOLUMN"];
namedeR=_366a["ENDROW"];
namedeC=_366a["ENDCOLUMN"];
break;
}
}
if(!_366c){
return;
}
if(_366c.indexOf("'")==0){
_366c=_366c.substring(1,(_366c.length-1));
}
if(_366c!=""&&isDefinedSheet(_366c)){
if(_366c!=CURRSHEETNAME){
fromGoTo=true;
showsheet("sheetdiv-"+_366c,"open");
}else{
gotoCell();
}
}else{
closeDialog();
}
}
function rangeFocus(val,_3675){
var range=new Array();
range=val.split(":");
var pos1=getCellPosByLabel(range[0]);
var pos2=getCellPosByLabel(range[1]);
if(pos1.col<0||pos2.col<0){
return false;
}
if(typeof _3675=="undefined"){
namedsR=pos1.row;
namedsC=pos1.col;
namedeR=pos2.row;
namedeC=pos2.col;
}
return true;
}
function doGoto(_3679,sR,eR,sC,eC,_367e){
namedsR=sR;
namedsC=sC;
namedeR=eR;
namedeC=eC;
if(_3679!=CURRSHEETNAME&&isDefinedSheet(_3679)){
fromGoTo=true;
showsheet("sheetdiv-"+_3679,"open",false,_367e);
}else{
gotoCell();
}
}
function gotoCell(){
if(getObj("cellRef")!=null){
getObj("cellRef").blur();
}
var _367f=getRowMax();
var _3680=getColMax();
if(namedsR==-1){
pos=getCellPosByLabel(lbl);
if(pos.row>=_367f){
pos.row=_367f-1;
}
if(pos.col>=_3680){
pos.col=_3680-1;
}
focusCell(pos.row,pos.col);
if(!ISMACROEDITOROPEN&&!FIND.dialogOpen){
closeDialog();
}
}else{
if(namedsR>=_367f){
namedsR=_367f-1;
}
if(namedeR>=_367f){
namedeR=_367f-1;
}
if(namedsC>=_3680){
namedsC=_3680-1;
}
if(namedeC>=_3680){
namedeC=_3680-1;
}
if(namedsR==namedeR&&namedsC==namedeC){
focusCell(parseInt(namedsR),parseInt(namedsC));
}else{
focusCellRange(parseInt(namedsR),parseInt(namedsC),parseInt(namedeR),parseInt(namedeC));
}
if(!ISMACROEDITOROPEN){
closeDialog();
}
namedsR=-1;
namedsC=namedeR=namedeC=0;
}
if(fromUsrInfo){
if(VIEWUNAME!=""&&typeof VIEWUPOS.row!="undefined"){
if(VIEWUPOS.isSameSheet+""=="true"){
highlightUserDiv();
fromUsrInfo=false;
}
}
}else{
scrollCellIntoView(currRow,currCol);
}
if(FIND.isFromFind){
focusSearchBarEl();
FIND.isFromFind=false;
}
}
var fromTrc=false;
function isValidLabel(_3681){
fromTrc=true;
if(_3681.indexOf("!")==-1){
if(_3681.indexOf(":")>1){
return rangeFocus(_3681);
}
}else{
var _3682=_3681.substring(0,_3681.indexOf("!"));
if(isDefinedSheet(_3682)){
_3681=_3681.substring(_3681.indexOf("!")+1,_3681.length);
if(_3681.indexOf(":")>1){
return rangeFocus(_3681);
}
}else{
return false;
}
}
return true;
}
function forCellLblCheck(_3683,Obj){
var cellN=false;
var nPL=false;
var _3687=getObj(Obj);
if(_3683.indexOf("!")!=-1){
var _3688=_3683.substring(0,_3683.indexOf("!"));
if(_3688.indexOf(" ")!=-1&&_3688.indexOf("'")==0){
_3688=_3688.substring(1,_3688.length-1);
}
if(!isDefinedSheet(_3688)){
showAlertDialog(jsTitleMsg.InvalidCellReference);
if(_3687){
_3687.focus();
_3687.select();
}
return false;
}
_3683=_3683.substring(_3683.indexOf("!")+1,_3683.length);
}
if(_3683.indexOf(":")>1){
var _3689=new Array();
_3689=_3683.split(":");
if(isCellLabel(_3689[0])&&isCellLabel(_3689[1])){
nPL=true;
if(rangeFocus(_3683,true)){
cellN=true;
}
}
}else{
if(isCellLabel(_3683)){
nPL=true;
var pos4=getCellPosByLabel(_3683);
cellN=true;
if(pos4.row<0||pos4.col<0){
nPL=false;
}
}
}
if(!cellN){
if(nPL){
showAlertDialog(jsTitleMsg.NotYetCreatedCell);
}else{
if(Obj=="Trc"){
return false;
}else{
showAlertDialog(jsTitleMsg.InvalidCellReference);
}
}
if(_3687){
_3687.focus();
_3687.select();
}
}
return cellN;
}
function gotoUsrPos(usr){
if(usr){
var _368c=getUserPositionStr(usr);
if(_368c!=""){
gotoCellByLbl(_368c);
}
}
}
var PREFOCUS=new Array();
var doStorePreFocus=true;
function focusPreCellRange(_368d){
var cR=getPreFocusCellRange(_368d);
if(cR!=null){
focusCellRange(cR.SR,cR.SC,cR.ER,cR.EC);
window.setTimeout("scrollCellIntoView()",1000);
}
}
function getPreFocusCellRange(_368f){
var _3690=null;
for(var i=0;i<PREFOCUS.length;i++){
var _3692=PREFOCUS[i];
var _3693=_3692["REFSHEET"];
if(_3693==_368f.toUpperCase().trim()){
var sR=_3692["SR"];
var sC=_3692["SC"];
var eR=_3692["ER"];
var eC=_3692["EC"];
_3690={"REFSHEET":_368f,"SR":sR,"SC":sC,"ER":eR,"EC":eC};
break;
}
}
return _3690;
}
function storePreFocus(){
if(!doStorePreFocus){
doStorePreFocus=true;
return;
}
var _3698=getCellRange();
addPreFocus(CURRSHEETNAME,_3698.startRow,_3698.startCol,_3698.endRow,_3698.endCol);
}
function addPreFocus(_3699,sR,sC,eR,eC){
var _369e=isPreFocusPresent(_3699);
if(typeof eR=="undefined"||eR==""||eR==null){
eR=sR;
}
if(typeof eC=="undefined"||eC==""||eC==null){
eC=sC;
}
if(_369e){
changePreFocus("RANGE",_3699,sR,sC,eR,eC);
}else{
var _369f=new Array();
_369f["REFSHEET"]=_3699.toUpperCase().trim();
_369f["SR"]=sR;
_369f["SC"]=sC;
_369f["ER"]=eR;
_369f["EC"]=eC;
PREFOCUS.push(_369f);
}
}
function isPreFocusPresent(_36a0){
var _36a1=false;
for(var i=0;i<PREFOCUS.length;i++){
var _36a3=PREFOCUS[i];
var _36a4=_36a3["REFSHEET"];
if(_36a4==_36a0.toUpperCase().trim()){
_36a1=true;
break;
}
}
return _36a1;
}
function changePreFocus(_36a5,_36a6,sR,sC,eR,eC,_36ab){
var _36ac=isPreFocusPresent(_36a6);
if(_36ac){
_36a5=_36a5.toUpperCase().trim();
for(var i=0;i<PREFOCUS.length;i++){
var _36ae=PREFOCUS[i];
var _36af=_36ae["REFSHEET"];
if(_36af==_36a6.toUpperCase().trim()){
switch(_36a5){
case "SHEETNAME":
_36ae["REFSHEET"]=_36ab.toUpperCase().trim();
break;
case "RANGE":
_36ae["SR"]=sR;
_36ae["SC"]=sC;
_36ae["ER"]=eR;
_36ae["EC"]=eC;
break;
}
break;
}
}
}
}
function removePreFocus(_36b0){
for(var i=0;i<PREFOCUS.length;i++){
var _36b2=PREFOCUS[i];
var _36b3=_36b2["REFSHEET"];
if(_36b3==_36b0.toUpperCase().trim()){
PREFOCUS.splice(i,1);
doStorePreFocus=false;
break;
}
}
}
function viewUsrCellinfo(usr){
if(usr){
var _36b5=getUserPositionStr(usr);
if(_36b5==""){
return false;
}
fromUsrInfo=true;
VIEWUNAME=usr;
var arr=new Array();
arr=_36b5.split(".");
var sName=arr[0];
var _36b8=getCellPosByLabel(arr[1]);
VIEWUPOS=_36b8;
VIEWUPOS.isSameSheet=(sName.trim().toUpperCase()==getCurrentSheetName().trim().toUpperCase())?"true":"false";
var _36b9=getNearerCellPos(_36b8.row,_36b8.col);
var _36ba=getCellLabel(_36b9.row,_36b9.col);
gotoCellByLbl(sName+"."+_36ba);
}
}
var pivotOptionsMenu="";
createtype="";
function showPivotOptions(){
if(typeof Menu["pivotMenu"]=="undefined"||Menu["pivotMenu"]==null){
var _36bb="<menu id=\"pivotMenu\" forElement=\"td_pivot\">";
_36bb+="<item onclick=\"createPivot('report')\">"+jsMsg.CreatePivotTable+"</item>";
_36bb+="<item onclick=\"createPivot('chart')\">"+jsMsg.CreatePivotChart+"</item>";
_36bb+=" <sep></sep>";
_36bb+="<item onclick=\"managePivots()\">"+jsMsg.ViewPivotReportsList+"</item>";
_36bb+="</menu>";
Menu.create(_36bb,{inputType:"xml"});
}
if(pivotSheet&&ZDBClientUI.selectedTab.view.type!="Table"){
Menu.pivotMenu.data[0].disabled="true";
Menu.pivotMenu.data[1].disabled="true";
}else{
Menu.pivotMenu.data[0].disabled="false";
Menu.pivotMenu.data[1].disabled="false";
}
Menu.pivotMenu.cachedContent="";
Menu["pivotMenu"].show();
}
function createPivot(type){
createtype=type;
if(DOCUMENT_ID!="doc_id"){
autosave();
showURLInDialog(ctxpath+"pages/managepivot.jsp?mode=create&docid="+DOCUMENT_ID+"&docowner="+CURR_DOC_OWNERNAME,"title=Create Pivot Report, top=-100, width=550",showCreatePivot,"",closePivotDialog);
}else{
saveForward="createPivot";
savefilessamp();
}
}
function managePivots(){
if(DOCUMENT_ID!="doc_id"){
showURLInDialog(ctxpath+"pages/managepivot.jsp?mode=edit&docid="+DOCUMENT_ID+"&docowner="+CURR_DOC_OWNERNAME,"title="+jsTitleMsg["Pivot.View.PivotReportsList"]+", top=-100, width=550, modal=yes",showManagePivot,"",closePivotDialog);
}else{
saveForward="managePivot";
savefilessamp();
}
}
function setPivotDialogOpen(){
isPivotDialogOpen=true;
}
function resetPivotDialogOpen(){
isPivotDialogOpen=false;
}
function showCreatePivot(){
getObj("createPivotTab").className="selected";
getObj("managePivotTab").className="";
getObj("createPivotContent").style.display="";
getObj("managePivotContent").style.display="none";
if(pivotSheet==true){
getObj("pivotDataRange").value=CURRSHEETNAME;
getObj("pivotDataRange").readOnly=true;
}else{
if(!isCellRange()){
}else{
var range=getCellRange();
getObj("pivotDataRange").value=CURRSHEETNAME+"!"+getCellLabel(range.startRow,range.startCol)+":"+getCellLabel(range.endRow,range.endCol);
focusCellRangeFill(range.startRow,range.startCol,range.endRow,range.endCol);
}
}
if(createtype=="report"){
getObj("tableReport").checked="checked";
getObj("pivotLocation").value=getPivotSheetName("Table");
getObj("newpivotsheethint").innerHTML=jsMsg["Pivot.ReportWillBePlacedInNewWorksheet"];
}else{
getObj("chartReport").checked="checked";
getObj("pivotLocation").value=getPivotSheetName("Chart");
getObj("newpivotsheethint").innerHTML=jsMsg["Pivot.ChartWillBePlacedInNewWorksheet"];
}
getObj("pivotName").focus();
}
function showManagePivot(){
isPivotDialogOpen=false;
getObj("createPivotTab").className="";
getObj("managePivotTab").className="selected";
getObj("createPivotContent").style.display="none";
getObj("managePivotContent").style.display="";
}
var pivotActionsMenu="";
function showPivotActionsMenu(el,_36bf){
if(typeof Menu["pivotActions"]=="undefined"||Menu["pivotActions"]==null){
var _36c0="<menu id=\"pivotActions\">";
_36c0+="<item onclick=\"editPivotProps()\">Edit Pivot Properties...</item>";
_36c0+="<item onclick=\"deleteSheet('"+_36bf+"')\">Delete Pivot</item>";
_36c0+="</menu>";
Menu.create(_36c0,{inputType:"xml"});
}
var x=findPosX(el);
var y=findPosY(el)+el.offsetHeight;
Menu["pivotActions"].show({"position":"absolute","left":x,"top":y});
}
function editPivotProps(){
showURLInDialog(ctxpath+"pages/editpivotprops.jsp","position=absmiddle, top=-100, width=550, title= "+jsTitleMsg["PivotProperties.EditPivotProperties"]+", modal=yes",initPivotProps);
}
function initPivotProps(){
getObj("pivotName").value=getObj("pivotTitle").innerHTML;
var _36c3=replace(getObj("pivotDesc").innerHTML,"<br>","\n");
_36c3=replace(_36c3,"<BR>","\r\n");
getObj("pivotNameDesc").value=_36c3;
getObj("pivotName").focus();
}
function updatePivotProps(){
var _36c4=getObj("pivotName").value.trim();
if(_36c4==""){
showAlertDialog(jsTitleMsg["Pivot.Titlecannotbeleftblank"]);
getObj("pivotName").focus();
return;
}
if(_36c4.length>250){
showAlertDialog(jsTitleMsg["Pivot.Titleshouldnotexceed"]);
getObj("pivotName").focus();
return;
}
var _36c5=new getXmlhttp();
_36c5.open("POST",ctxpath+"sheetaction.do",true);
_36c5.onreadystatechange=function(){
if(_36c5.readyState==4){
try{
loadoff();
closeDialog();
var _36c6=_36c5.responseText;
if(_36c6==showErrorPanelMsg){
handleServerError("ERROR",_36c6,true);
return;
}
_36c6=_36c6.replace(/\\/g,"\\\\");
var resp=eval("("+_36c6+")");
status=resp.status;
if(status=="failure"){
showAlertDialog(jsTitleMsg["Pivot.ProblemWhileUpdatingPivotProperties"]);
return;
}
getObj("pivotTitle").innerHTML=resp.title;
getObj("pivotDesc").innerHTML=resp.desc;
resetWorkSheetDim();
removeSheets(CURRSHEETNAME);
}
catch(e){
showAlertDialog(jsTitleMsg["Pivot.ProblemWhileUpdatingPivotProperties"]);
return;
}
}
};
_36c5.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var nvp="sheetname="+encodeURIComponent(CURRSHEETNAME)+"&action=updatePivotProps&curtime="+CURRENTTIME+"&docid="+DOCUMENT_ID+"&fileFormat="+FILE_FORMAT;
var _36c4=getObj("pivotName").value.trim();
_36c4=encodeURIComponent(_36c4);
var _36c9=getObj("pivotNameDesc").value.trim();
_36c9=replace(_36c9,"\r\n","<BR>");
_36c9=replace(_36c9,"\n","<br>");
_36c9=encodeURIComponent(_36c9);
nvp+="&docowner="+CURR_DOC_OWNERNAME+"&reportTitle="+_36c4+"&reportDesc="+_36c9;
sendXMLHTTPRequest(_36c5,nvp,true,false);
loadon();
}
function showDataTableSortOptions(val){
if(typeof Menu["dataTableSortOptions"]=="undefined"||Menu["pivotActions"]==null){
var _36cb="<menu id=\"dataTableSortOptions\" forElement=\"td_data_table_sort\">";
_36cb+="<item onclick=\"sortDataTable('"+val+"','asc')\">Sort A - Z</item>";
_36cb+="<item onclick=\"sortDataTable('"+val+"','desc')\">Sort Z - A</item>";
_36cb+="<sep></sep>";
_36cb+="<item onclick=\"unSortDataTable('"+val+"')\">Remove Sort</item>";
_36cb+="</menu>";
Menu.create(_36cb,{inputType:"xml"});
}
Menu["dataTableSortOptions"].show();
}
function sortDataTable(val,_36cd){
if(_36cd=="asc"){
ZDBMenu.sortColumn(this,1);
}else{
if(_36cd=="desc"){
ZDBMenu.sortColumn(this,2);
}
}
}
function unSortDataTable(){
ZDBMenu.sortColumn(this,"remove");
}
function showDataTableAddOptions(event){
if(typeof Menu["dataTableAddOptions"]=="undefined"||Menu["pivotActions"]==null){
var _36cf="<menu id=\"dataTableAddOptions\" forElement=\"td_data_table_add\">";
_36cf+="<item onclick=\"addDataTableRow()\">Insert Row</item>";
_36cf+="<item onclick=\"addDataTableCol()\">Insert Column</item>";
_36cf+="</menu>";
Menu.create(_36cf,{inputType:"xml"});
}
Menu["dataTableAddOptions"].show();
}
function showDataTableDelOptions(event){
if(typeof Menu["dataTableDelOptions"]=="undefined"||Menu["pivotActions"]==null){
var _36d1="<menu id=\"dataTableDelOptions\" forElement=\"td_data_table_delete\">";
_36d1+="<item onclick=\"deleteDataTableRow('"+event+"');\">Delete Row(s)</item>";
_36d1+="<item onclick=\"deleteDataTableCol()\">Delete Col(s)</item>";
_36d1+="</menu>";
Menu.create(_36d1,{inputType:"xml"});
}
Menu["dataTableDelOptions"].show();
}
function addDataTableCol(){
ZDBClientUI.showAddColDlg();
}
function addDataTableFormulaCol(event){
ZDBDerivedField.showDerivedFieldExprEditor(event);
}
function addDataTableRow(){
ZDBMenu.addRow();
}
function deleteDataTableCol(){
ZDBClientUI.deleteColumns();
}
function deleteDataTableRow(event){
ZDBMenu.deleteRows(event);
}
function closePivotDialog(){
closeDialog();
isPivotDialogOpen=false;
resetCellRangeFill("publishedRange");
}
var pivotsrcSheet="";
function proceedToCreateReport(){
isPivotDialogOpen=false;
var _36d4=getObj("pivotName").value.trim();
if(_36d4==""){
showAlertDialog(jsTitleMsg["Pivot.Titlecannotbeleftblank"]);
getObj("pivotName").focus();
return;
}
if(_36d4.length>250){
showAlertDialog(jsTitleMsg["Pivot.Titleshouldnotexceed"]);
getObj("pivotName").focus();
return;
}
var _36d5=getObj("pivotLocation").value.trim();
if(!validateReportName(_36d5)){
getObj("pivotLocation").focus();
return;
}
var _36d6=getObj("pivotDataRange").value.trim();
if(_36d6==""){
showAlertDialog(jsTitleMsg["Pivot.DataRangeshouldnotbeblank"]);
getObj("pivotDataRange").focus();
return;
}
if(!pivotSheet&&!isValidRange(_36d6)){
showAlertDialog(jsTitleMsg["Pivot.SpecifyAvalidDataRange"]);
getObj("pivotDataRange").focus();
return;
}
var _36d7=getObj("tableReport").checked?"Pivot":"AnalysisView";
insertSheet(true,undefined,undefined,_36d7);
message(jsMsg.Updating,"block","");
}
function validateReportName(_36d8){
if(_36d8&&_36d8.trim()!=""){
if(checkSheetName(_36d8)){
showAlertDialog(jsTitleMsg["Pivot.LocationName"]);
return false;
}else{
var obj=getObj("sheetdiv-"+CURRSHEETNAME);
var _36da=obj.parentNode;
var _36db=_36da.childNodes;
var _36dc=false;
for(var i=0;i<_36db.length;i++){
var node=_36db.item(i);
var attrs=node.attributes;
var value="";
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="sheetname"){
value=attr.nodeValue;
}
}
if(_36d8.trim().toUpperCase()==value.trim().toUpperCase()){
_36dc=true;
break;
}
}
}
}
if(_36dc){
showAlertDialog(jsTitleMsg["Pivot.Location.SheetNameAlreadyExists"]);
return false;
}
}else{
showAlertDialog(jsTitleMsg["Pivot.Location.LocationNameCannotBeBlank"]);
return false;
}
return true;
}
function getCellRangeAsStr(){
var range=getCellRange();
return getCellLabel(range.startRow,range.startCol)+":"+getCellLabel(range.endRow,range.endCol);
}
function getCellRangeVal(val){
var arr=val.split(":");
var st=getCellPosByLabel(arr[0]);
var scol=st.col;
var srow=st.row;
var ecol=st.col;
var erow=st.row;
if(arr.length==2){
var en=getCellPosByLabel(arr[1]);
ecol=en.col;
erow=en.row;
}
return srow+":"+scol+":"+erow+":"+ecol;
}
function showPivotReport(val){
var prtbl=getObj("managePivotTable");
var rws=prtbl.rows;
var _36ef=false;
for(var i=0;i<rws.length;i++){
var rObj=rws.item(i);
if(rObj){
if(rObj.id=="prhead"||val=="All"||val==rObj.id){
rObj.style.display="";
if(val==rObj.id||(val=="All"&&rObj.id!="prhead"&&rObj.id!="noPivotRow")){
_36ef=true;
}
}else{
rObj.style.display="none";
}
}
}
if(_36ef){
getObj("noPivotRow").style.display="none";
}else{
getObj("noPivotRow").style.display="";
var _36f2=getObj("noPivotsMessage");
switch(val.toLowerCase()){
case "all":
_36f2.innerHTML=jsMsg["Pivot.View.PivotReportsList.All"]+"<br><a href='javascript:createPivot(\"report\");'>"+jsMsg["Pivot.View.ClickHereToCreate"]+"</a>";
break;
case "analysisview":
_36f2.innerHTML=jsMsg["Pivot.View.PivotReportsList.Charts"]+"<br><a href='javascript:createPivot(\"chart\");'>"+jsMsg["Pivot.View.ClickHereToCreate"]+"</a>";
break;
case "pivot":
_36f2.innerHTML=jsMsg["Pivot.View.PivotReportsList.Tables"]+"<br><a href='javascript:createPivot(\"report\");'>"+jsMsg["Pivot.View.ClickHereToCreate"]+"</a>";
break;
}
}
}
var editPivotDialog="",editpivotSheet="";
rangeDet="";
showpivotVar="";
function editPivotData(){
editpivotSheet=CURRSHEETNAME;
var _36f3=new getXmlhttp();
_36f3.open("POST",ctxpath+"sheetaction.do",true);
_36f3.onreadystatechange=function(){
if(_36f3.readyState==4){
try{
loadoff();
if(_36f3.responseText==showErrorPanelMsg){
handleServerError("ERROR",_36f3.responseText,true);
return;
}
var resp=eval("("+_36f3.responseText+")");
status=resp.status;
if(status=="failure"){
range=resp.range;
if(range==""){
showAlertDialog(jsTitleMsg["Pivot.SourceDataSheetIsNotAvailable"]);
return;
}
showAlertDialog(jsTitleMsg["Pivot.ProblemWhileGettingSourceData"]);
return;
}
range=resp.range;
rangeDet=range.split("!");
if(!rangeDet[1]){
showAlertDialog(replaceParams(jsTitleMsg["Pivot.SourceSheetForThisReport"],new Array(rangeDet[0])));
editpivotSheet="";
isEditPivotDialogOpen=false;
}else{
showpivotVar="showPivotRangeEdit";
showsheet(getObj("sheetdiv-"+rangeDet[0]),"open","");
}
}
catch(e){
return;
}
}
};
_36f3.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var nvp="sheetname="+encodeURIComponent(CURRSHEETNAME)+"&action=getPivotRange&curtime="+CURRENTTIME+"&docid="+DOCUMENT_ID;
nvp+="&viewType="+getViewType();
nvp+="&docowner="+CURR_DOC_OWNERNAME+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING+"&fileFormat="+FILE_FORMAT;
sendXMLHTTPRequest(_36f3,nvp,true,false);
loadon();
}
function showPivotRangeEdit(){
showURLInDialog(ctxpath+"pages/editpivotRange.jsp","position=middle , width=400, title= "+replaceParams(jsTitleMsg["Pivot.SourceDataTitle"],new Array(getObj("pivotTitle").innerHTML)),filleditDataRange,"",cancelEditPivotData);
}
function filleditDataRange(){
var _36f6=getObj("editpivotDataRange");
_36f6.value=range;
if(range.indexOf("!")==-1){
_36f6.readOnly=true;
}else{
_36f6.focus();
}
isEditPivotDialogOpen=true;
val=getObj("editpivotDataRange").value;
arr=val.split("!");
if(arr[0]==CURRSHEETNAME){
arr=arr[1].split(":");
st=getCellPosByLabel(arr[0]);
scol=st.col;
srow=st.row;
if(arr.length==2){
en=getCellPosByLabel(arr[1]);
ecol=en.col;
erow=en.row;
}else{
ecol=scol;
erow=srow;
}
focusCellRangeFill(srow,scol,erow,ecol);
}
dontCancelEditPivotData=false;
}
function cancelEditPivotData(){
if(dontCancelEditPivotData){
return;
}
pivotSheet=true;
showpivotVar="refreshPivotRangeEdit";
showsheet(getObj("sheetdiv-"+editpivotSheet),"open","");
editpivotSheet="";
isEditPivotDialogOpen=false;
}
var dontCancelEditPivotData=false;
function proceedEditPivotData(){
var _36f7=new getXmlhttp();
_36f7.open("POST",ctxpath+"sheetaction.do",true);
_36f7.onreadystatechange=function(){
if(_36f7.readyState==4){
if(_36f7.status==200){
if(_36f7.responseText==showErrorPanelMsg){
handleServerError("ERROR",_36f7.responseText,true);
return;
}
try{
loadoff();
var resp=eval("("+_36f7.responseText+")");
status=resp.status;
if(status=="failure"){
showAlertDialog(jsTitleMsg["Pivot.ProblemWhileEditingSourceData"]);
return;
}
}
catch(e){
showAlertDialog(jsTitleMsg["Pivot.ProblemWhileEditingSourceData"]);
return;
}
dontCancelEditPivotData=true;
showpivotVar="refreshPivotRangeEdit";
pivotSheet=true;
showsheet(getObj("sheetdiv-"+editpivotSheet),"open","");
}
}
};
var _36f9=getObj("editpivotDataRange").value.trim();
if(_36f9==""){
showAlertDialog(jsTitleMsg["Pivot.DataRangeshouldnotbeblank"]);
getObj("editpivotDataRange").focus();
return;
}
if(!pivotSheet&&!isValidRange(_36f9)){
showAlertDialog(jsTitleMsg["Pivot.SpecifyAvalidDataRange"]);
getObj("editpivotDataRange").focus();
return;
}
var _36fa="";
var _36fb="";
if(_36f9.indexOf("!")!=-1){
var val=_36f9.split("!");
if(val[1].split(":")[0].trim()==""||val[1].split(":")[1].trim()==""){
showAlertDialog(jsTitleMsg["Pivot.DataRangeFormat"]);
getObj("editpivotDataRange").focus();
return;
}
_36fa=val[0];
_36fb=getCellRangeVal(val[1]);
}else{
if(_36f9.split(":")[0].trim()==""||_36f9.split(":")[1].trim()==""){
showAlertDialog(jsTitleMsg["Pivot.DataRangeFormat"]);
getObj("editpivotDataRange").focus();
return;
}
_36fa=CURRSHEETNAME;
_36fb=getCellRangeVal(_36f9);
}
_36f7.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var nvp="sheetname="+editpivotSheet+"&datasheetname="+encodeURIComponent(_36fa)+"&action=editPivot&curtime="+CURRENTTIME+"&docid="+DOCUMENT_ID;
nvp+="&viewType="+getViewType();
nvp+="&docowner="+CURR_DOC_OWNERNAME+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&newRange="+_36fb+"&fileFormat="+FILE_FORMAT;
sendXMLHTTPRequest(_36f7,nvp,true,false);
loadon();
}
function viewReportSchema(){
}
function refreshPivotData(){
var _36fe=new getXmlhttp();
_36fe.open("POST",ctxpath+"sheetaction.do",true);
_36fe.onreadystatechange=function(){
if(_36fe.readyState==4){
try{
loadoff();
if(_36fe.responseText==showErrorPanelMsg){
handleServerError("ERROR",_36fe.responseText,true);
return;
}
var resp=eval("("+_36fe.responseText+")");
status=resp.status;
if(status=="failure"){
showAlertDialog(jsTitleMsg["Pivot.ProblemWhileRefreshingData"]);
return;
}
}
catch(e){
showAlertDialog(jsTitleMsg["Pivot.ProblemWhileRefreshingData"]);
return;
}
ZDBClientUI.reloadCurAnalysisView();
}
};
_36fe.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var nvp="sheetname="+encodeURIComponent(CURRSHEETNAME)+"&action=refreshPivot&curtime="+CURRENTTIME+"&docid="+DOCUMENT_ID;
nvp+="&viewType="+getViewType();
nvp+="&docowner="+CURR_DOC_OWNERNAME+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING+"&fileFormat="+FILE_FORMAT;
sendXMLHTTPRequest(_36fe,nvp,true,false);
loadon();
}
function createPivotChart(){
}
function clonePivotReport(){
}
function tooglePivotDesignView(){
var _3701=getObj("pivotDesignExpImg");
var _3702=getObj("pivotDesignCollImg");
var _3703=getObj("pivotDesignContainer");
var _3704=getObj("pivotReportContainer");
if(_3703.style.display=="none"){
_3701.style.display="";
_3702.style.display="none";
_3704.style.display="none";
_3703.style.width="420px";
_3703.style.display="";
_3704.style.display="";
getObj("attachedSwipeArea").style.display="";
getObj("GraphFieldHolder").style.display="";
}else{
_3701.style.display="none";
_3702.style.display="";
_3703.style.display="none";
getObj("attachedSwipeArea").style.display="none";
getObj("GraphFieldHolder").style.display="none";
}
}
function togglePivotConfigTab(el){
var tabId=el.id;
var _3707=getObj("pivotLayoutConfig");
var _3708=getObj("pivotFiltersConfig");
var _3709=getObj("pivotLayoutConfigTab");
var _370a=getObj("pivotFiltersConfigTab");
if(tabId=="pivotFiltersConfigTab"){
_370a.className="selected";
_3709.className="first";
_3708.style.display="";
_3707.style.display="none";
}else{
_370a.className="";
_3709.className="first selected";
_3708.style.display="none";
_3707.style.display="";
}
}
function setPivotContainersDim(){
var _370b=getObj("pivotFieldsListContainer");
var _370c=getObj("ZDBAnalysisFieldHolder");
_370c.style.height="1px";
_370c.style.height=(_370b.offsetHeight-getObj("pivotFieldsListHead").offsetHeight-20-120)+"px";
setPivotReportContainerDim();
}
function setPivotReportContainerDim(){
var _370d=getObj("defaultAnalysisView");
var _370e=getObj("defaultAnalysisView");
var _370f=getObj("pivotReportView");
_370e.style.width=_370f.style.width="1px";
_370e.style.height=_370f.style.height="1px";
var adjst=(browser_nn6||browser_opera||browser_safari)?2:0;
_370e.style.width=_370f.style.width=(_370d.offsetWidth-adjst)+"px";
_370e.style.height=_370f.style.height=(_370d.offsetHeight-adjst)+"px";
}
function resetPivotContainersDim(){
setPivotContainersDim();
}
function getPivotSheetName(type){
if(type=="Table"){
type=jsMsg["Pivot.PivotTable.Location.Table"];
}else{
type=jsMsg["Pivot.PivotChart.Location.Chart"];
}
var obj=getObj("sheetdiv-"+CURRSHEETNAME);
var _3713=obj.parentNode;
var cnt=1;
var name=replaceParams(jsMsg["Pivot.Location.Table"],new Array(type,cnt));
var _3716=_3713.childNodes;
var _3717=false;
var xx=true;
while(xx){
for(var i=0;i<_3716.length;i++){
var node=_3716.item(i);
var attrs=node.attributes;
var value="";
if(attrs!=null&&attrs.length>0){
for(var z=0;z<attrs.length;z++){
var attr=attrs.item(z);
if(attr.nodeName=="sheetname"){
value=attr.nodeValue;
break;
}
}
if(name.trim().toUpperCase()==value.trim().toUpperCase()){
_3717=true;
break;
}
}
}
if(_3717){
cnt++;
name=replaceParams(jsMsg["Pivot.Location.Table"],new Array(type,cnt));
_3717=false;
}else{
xx=false;
}
}
return name;
}
function extractFromResponse(_371f,_3720){
var index=(_371f.length>1000)?(_371f.length-1000):0;
index=_371f.indexOf(_3720+"_START",index);
if(index==-1){
index=(_371f.length>1000)?1000:_371f.length;
index=_371f.lastIndexOf(_3720+"_START",index);
}
if(index==-1){
return null;
}
index=index+_3720.length+"_START".length;
var _3722=_371f.indexOf(_3720+"_END",index);
if(index==-1){
return null;
}
return _371f.substring(index,_3722).trim();
}
function setrepTypeChanges(obj){
if(obj.id=="tableReport"){
getObj("pivotLocation").value=getPivotSheetName("Table");
getObj("newpivotsheethint").innerHTML=jsMsg["Pivot.ReportWillBePlacedInNewWorksheet"];
}else{
if(obj.id=="chartReport"){
getObj("pivotLocation").value=getPivotSheetName("Chart");
getObj("newpivotsheethint").innerHTML=jsMsg["Pivot.ChartWillBePlacedInNewWorksheet"];
}
}
}
function removePivotContent(){
try{
if(ZDBClientUI.selectedTab){
if(!pivotSheet){
hidePivotToolbars();
}
ZDBClientUI.unselectTab();
var _3724=getObj("sheetdiv");
ZDButil.removeAllChildren(_3724);
}
}
catch(e){
}
}
function hideWarningBanner(){
getObj("tabularDataWarning").style.display="none";
hidepivotWarningBanner="hide";
resetWorkSheetDim();
var _3725=new getXmlhttp();
postAjax(_3725,ctxpath+"hidepivotbanner.do","doc_id="+DOCUMENT_ID);
}
function cancelEditPivot(){
if(dontCancelPivotDesign){
return;
}
var div=$("ZDBDesignDiv");
div.style.display="none";
document.body.appendChild(div);
var view=ZDBClientUI.selectedTab.view;
if(view.objId>-1){
swipeEffects.hideOrShow($("ZDBAnalysisPreview"));
ZDBAnalysisView.addOnlyChartArea();
ZDBClientUI.reloadCurAnalysisView();
}else{
ZDBglobal.designInPopUp=false;
deleteSheet(CURRSHEETNAME);
}
}
function initPivotDesign(){
var view=ZDBClientUI.selectedTab.view;
var _3729=view.workArea;
var _372a=(browser_ie)?0:parseInt(getCurrentStyle(_3729.parentNode,"borderTopWidth"))+parseInt(getCurrentStyle(_3729.parentNode,"borderBottomWidth"));
_3729.style.height=(_3729.parentNode.offsetHeight-_372a)+"px";
if(browser_ie){
var _372b=23;
_3729.style.height=(getObj("_DIALOG_CONTENT").offsetHeight/3+_372b)+"px";
}
_3729.style.width=_3729.parentNode.offsetWidth+"px";
view.legendHolderArea.style.width="15%";
var _372c=view.attachedSwipeArea;
var _372d=(browser_ie)?0:parseInt(getCurrentStyle(_372c.parentNode,"borderTopWidth"))+parseInt(getCurrentStyle(_372c.parentNode,"borderBottomWidth"));
_372c.style.height=(_372c.parentNode.offsetHeight-_372d)+"px";
_372c.style.display="block";
_3729.style.display="";
resetWorkSheetDim();
message("","none");
autosave();
}
function hidePivotToolbars(){
getObj("pivotTableToolbar").style.display="none";
getObj("dataTableToolbar").style.display="none";
getObj("pivotReportHeader").style.display="none";
getObj("pivotReportIndent").style.display="none";
getObj("tabularDataWarning").style.display="none";
}
var isZohoDBServiceOn;
function initZohoDBService(){
setZohoDBServiceDim();
}
function setZohoDBServiceDim(){
if(browser_ie){
var _372e=document.body.clientWidth;
var _372f=document.body.clientHeight;
}else{
if(browser_nn4||browser_nn6){
var _372e=window.innerWidth;
var _372f=window.innerHeight;
}
}
var _3730=_372f-findPosY(getObj("sheetdiv"))-getObj("bottomBand").offsetHeight;
getObj("sheetdiv").style.height=_3730+"px";
}
function resetZohoDBServiceDim(){
setZohoDBServiceDim();
}
var isSaveButtonEnabled=false;
var mdlnames=new Array();
var minbarhtml="";
var dynele=document.createElement("DIV");
var macrodialog=null;
var runMacroList;
var xMinVal=0;
var yMinVal=0;
var minWidth=0;
var dlghtml="";
var module_content=new Array();
var callback_load="loadAllMacro";
var sheetOperations=new Array();
var custommdlcnt=0;
var currentMdl=new Object();
var ISMACROEDITOROPEN=false;
var macroActionsMenuStatus=false;
var errorObj=new Object();
errorObj.ISERROR=false;
var MacroPanelState=new Object();
MacroPanelState.explorer=true;
MacroPanelState.tabs="";
MacroPanelState.find=false;
var gotoform=$("#gotoform");
var checkMacroTriggerObj={isMacroTrigger:false,isAutoSaveForMacro:false};
function disableSaveButton(){
isSaveButtonEnabled=false;
if(SAVED==false){
btn_disabled();
isSaveButtonEnabled=true;
}
}
function enableSaveButton(){
if(MACRO_DOC_SAVED&&!MACROSAVED){
if(READ_WRITE){
btn_enabled();
}
}
}
function closeScriptDialog(){
ISMACROEDITOROPEN=false;
editAreaLoader.delete_instance("macrotextid");
enableSaveButton();
}
function closeEditorDialog(){
if(ISMINDLG){
dynele.style.display="none";
}
if(!MACRO_DOC_SAVED){
if(!jsVERSION_VIEW&&!jsPUBLIC_VIEW&&!jsGUEST_VIEW&&ALLOW_TO_WRITE){
var a=showConfirmDialog(jsTitleMsg.DoYouWantToSaveChanges);
if(a){
saveMacro();
}else{
MACROSAVED=true;
}
}
}
clearErrorAndMsg();
MacroPanelState.tabs="";
MACRO_DOC_SAVED=true;
ISMINDLG=false;
closeDialog();
}
function showMacroEditorDialog(_3732,_3733,_3734,show){
if(jsPUBLIC_VIEW&&!READ_WRITE){
return;
}
VBAEDITORMODULENAME="";
VBAEDITORLINENO="";
VBAEDITORMODULETYPE="";
VBAEDITORSHOW="";
var _3736=$("#fileName");
if(_3736!=null&&typeof _3736!="undefined"){
if(DOCUMENT_ID=="doc_id"){
saveForward="showVBAEditor";
VBAEDITORMODULENAME=_3732;
VBAEDITORLINENO=_3733;
VBAEDITORMODULETYPE=_3734;
VBAEDITORSHOW=show;
return savefilessamp();
}
}
var _3737=getObj("macroPanel");
if(_3737&&_3737.style.display!="none"){
var _3738="showMacroEditorDialog(";
if(typeof _3732!="undefined"&&_3732!="undefined"&&_3732!=""){
_3738+="'"+_3732+"'";
if(typeof _3733!="undefined"&&_3733!="undefined"&&_3733!=""){
_3738+=",'"+_3733+"'";
}else{
_3738+=",''";
}
if(typeof _3734!="undefined"&&_3734!="undefined"&&_3734!=""){
_3738+=",'"+_3734+"'";
}
}
_3738+=")";
hideMacroRecordPanel(_3738);
return;
}
var _3739=findDocDim();
var width=_3739.width-300;
if(width<950){
width=950;
}
var left=(_3739.width-width)/2;
if(typeof show!="undefined"&&show!=""){
MacroPanelState.tabs=show;
MacroPanelState.lineNo=_3733;
}else{
MacroPanelState.lineNo="";
}
if(!ISMINDLG&&!ISMACROEDITOROPEN||ISMACRODOCCHANGE){
if(ISMINDLG){
dynele.style.display="none";
}
currentMdl=new Object();
ISMACRODOCCHANGE=false;
MacroPanelState.tabs=closetabs;
callback_load="loadAllMacro";
message(jsMsg.Loading+"...","block");
var _373c=new getXmlhttp();
_373c.open("POST",ctxpath+"pages/macroeditor.jsp",true);
_373c.onreadystatechange=function(){
if(_373c.readyState==4){
message(jsMsg.Loading,"none");
dlghtml=_373c.responseText;
showDialog(dlghtml,"position=absolute,left="+left+",top=35, modal=yes, closeOnEscKey=no, closeButton=no, width="+width+" ,height="+(_3739.height-70),initEditArea,closeScriptDialog);
}
};
var _373d=getCurrentSelection();
var url="docowner="+CURR_DOC_OWNERNAME+"&viewType="+getObj("VIEW").value+"&docid="+DOCUMENT_ID+"&currenttime="+CURRENTTIME+"&currentSheetName="+CURRSHEETNAME+"&currentSelection="+_373d+"&bridgeNo="+bridgeNumber+"&afterRTC=false"+"&docname="+encodeURIComponent(DOCUMENT_NAME)+"&width="+width;
if(DOCUMENT_VERSION){
url+="&versionId="+DOCUMENT_VERSION;
}
if(typeof _3732!="undefined"&&_3732!=""){
url=url+"&modulename="+_3732;
if(!(isUndefined(_3733)||(_3733==null)||(_3733=="")||!isNaN(_3733))){
url=url+"&macroName="+_3733;
}else{
url=url+"&lineNo="+_3733;
}
}
_373c.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_373c.send(url);
}else{
if(ISMINDLG){
dynele.style.display="none";
}
if(!ISMACROEDITOROPEN){
callback_load="loadOldMacro";
if(typeof _3732!="undefined"&&_3732!=""){
currentMdl.PREVIOUS=currentMdl.CURRENT;
currentMdl.CURRENT=_3732;
currentMdl.CTYPE=_3734;
currentMdl.LINE=_3733;
currentMdl.CURLINE=null;
}
if(macrodialog!=null){
if(is_ie){
dlghtml=macrodialog.outerHTML+runMacroList.outerHTML;
}else{
dlghtml=getOuterHTML(macrodialog)+getOuterHTML(runMacroList);
}
macrodialog=null;
}
showDialog(dlghtml,"position=absolute,left="+left+",top=35, modal=yes, closeOnEscKey=no, closeButton=no, width="+width+" ,height="+(_3739.height-70),initEditArea,closeScriptDialog);
}else{
toggleEditor();
if(typeof _3732!="undefined"&&_3732!=""){
loadMacro(_3732,_3734,_3733);
}
}
}
ISMINDLG=false;
ISMACROEDITOROPEN=true;
}
function runCodeMacro(_373f,_3740,_3741,_3742){
if(getObj("run_td").getAttribute("iconDisabled")=="true"){
return;
}
if(!isMacroSupport()){
return;
}
if(typeof _3742=="undefined"){
_3742=false;
}
var _3743=DOCUMENT_NAME;
if(_3740=="saverun"){
if(jsVERSION_VIEW||jsPUBLIC_VIEW||jsGUEST_VIEW){
return;
}
if(DOCUMENT_ID=="doc_id"){
_3743=showPromptDialog(jsTitleMsg.TheSpreadsheetIsNotYetSaved+" "+jsTitleMsg.KindlySaveAndContinue,jsTitleMsg.UntitledSpreadsheet);
}
}
if(!((_3743=="")||(_3743==null))){
var _3744=getObj("busydiv");
if(_3744){
_3744.innerHTML=jsMsg.Running+"...";
_3744.style.display="";
}
var _3745=new getXmlhttp();
_3745.open("POST",ctxpath+"macro.do",true);
_3745.onreadystatechange=function(){
if(_3745.readyState==4){
checkMacroTriggerObj["isMacroTrigger"]=false;
if(_3740=="saverun"){
macroBtn_disabled();
isSaveButtonEnabled=false;
}else{
MACRO_DOC_SAVED=true;
}
if(checkMacroTriggerObj["isAutoSaveForMacro"]){
savefile();
}
_3744.style.display="none";
if(_3745.responseText.trim().length>0){
var _3746=eval("("+_3745.responseText+")");
if((_3740=="saverun")&&(DOCUMENT_ID=="doc_id")){
getObj("docNameSpan").innerHTML=_3743;
}
if(typeof _3746.MACROTABLE!="undefined"){
if(_3746.MACROTABLE=="NOMACROS"){
disableError();
disableMessage();
showAlertDialog(jsTitleMsg.NoMacrosFound);
}else{
closeAllPopup();
updateMacros(_3746);
getObj("RunMacroList").style.display="";
}
}else{
updateMacroChanges(_3745.responseText,false);
}
if(typeof _3746.TAGID!="undefined"){
handleDocmentAction("ADD",_3746);
}
}
}
if(enableSaveButtonForMacro&&READ_WRITE){
btn_enabled();
enableSaveButtonForMacro=false;
}else{
if(_3740=="saverun"&&!enableSaveButtonForMacro){
btn_disabled();
}
}
};
_3745.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var i;
var url=getMacroUrl()+"&action="+_3740+"&modulename="+_373f+"&lineNo="+_3741+"&docName="+_3743+"&afterRTC="+_3742;
var eA=window.frames["frame_macrotextid"].editArea;
var _374a=false;
var _374b="<Modules>";
if(!MACRO_DOC_SAVED){
for(i=0;i<mdlnames.length;i++){
if(eA.files[mdlnames[i]]["compare_edited_text"]!=editAreaLoader.getFile("macrotextid",mdlnames[i]).text){
eA.files[mdlnames[i]]["compare_edited_text"]=editAreaLoader.getFile("macrotextid",mdlnames[i]).text;
_374b+="<Module Name=\""+mdlnames[i]+"\"><![CDATA["+encodeURIComponent(editAreaLoader.getFile("macrotextid",mdlnames[i]).text)+"]]></Module>";
_374a=true;
}
}
}
_374b+="</Modules>";
if(_374a){
url+="&modulecontent="+_374b;
}
if(_3740=="saverun"){
url+="&rowHeight="+encodeURIComponent(getAryMetadata(rowHeightAry));
}
var _374c=getCurrentSelection();
checkMacroTriggerObj["isMacroTrigger"]=true;
_3745.send(url+"&changeflag="+_374a+"&currentSelection="+_374c);
}
}
function runmacro(_374d,_374e,_374f,_3750,_3751,_3752,_3753,_3754,_3755){
if(!ISMACROEDITOROPEN){
closeDialog();
}
if(isSheetBasedShare&&_374f.toString()!="true"){
return;
}
var _3756=getObj("busydiv");
var _3757;
if(_3756){
_3756.style.display="";
if(!_3755){
_3756.innerHTML=jsMsg.Running+" - '"+_374e+"'";
}else{
Button.visualiseMacroExecution(arguments[2]);
_3757=arguments[2];
arguments[2]=undefined;
}
}else{
if(!_3755){
showProgressMessage(jsMsg.Running+" - '"+_374e+"'");
}else{
Button.visualiseMacroExecution(arguments[2]);
_3757=arguments[2];
arguments[2]=undefined;
}
}
if(typeof _374f=="undefined"){
_374f=false;
}else{
if(_3750=="run"||_3750=="saverun"){
notify("info",replaceParams(jsTitleMsg.UserhasModifiedTheModule,new Array(_3751,escapeSpecialCharacters(_374e))));
}
}
if(!isMacroSupport()){
return;
}
if(typeof _3750=="undefined"){
_3750="run";
}
var _3758=true;
var objml=getObj("MacroList");
if(objml!=null&&objml.style.display!="none"){
closeMacroList();
_3758=false;
}
var _375a=new getXmlhttp();
_375a.open("POST",ctxpath+"macro.do",true);
_375a.onreadystatechange=function(){
if(_375a.readyState==1&&_3758==false){
if(!ISMINDLG&&ISMACROEDITOROPEN){
var eA=window.frames["frame_macrotextid"].editArea;
var range=editAreaLoader.getSelectionRange("macrotextid");
eA.textarea.focus();
editAreaLoader.setSelectionRange("macrotextid",range.start,range.end);
}
}
if(_375a.readyState==4){
checkMacroTriggerObj["isMacroTrigger"]=false;
var _375d=getObj("RunMacroList");
if(_3755){
Button.removeVisuals(_3757);
_3757=undefined;
}
if(_375d){
_375d.style.display="none";
}
var _375e=_375a.responseText;
updateMacroChanges(_375e,_3758,_374f,_3754);
if(!ISMACROEDITOROPEN){
}
if(enableSaveButtonForMacro&&READ_WRITE){
btn_enabled();
enableSaveButtonForMacro=false;
}
if(checkMacroTriggerObj["isAutoSaveForMacro"]){
savefile();
}
if(_3756){
_3756.style.display="none";
setTimeout(function(){
_3756.innerHTML="Updating";
},5);
}else{
if(!_3755){
hideProgressMessage();
}
}
}
};
_375a.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var i;
var _3760;
if(_3753){
_3760=_3753;
}else{
_3760=getCurrentSelection();
}
if(typeof _3754=="undefined"){
_3754=CURRSHEETNAME;
}
var url="docowner="+CURR_DOC_OWNERNAME;
url+="&collabid="+COLLAB_ID;
url+="&readwrite="+ALLOW_TO_WRITE;
url+="&collabEditing="+COLLABORATIVE_EDITING;
url+="&viewType="+getObj("VIEW").value;
url+="&docid="+DOCUMENT_ID;
url+="&currenttime="+CURRENTTIME;
url+="&currentSheetName="+_3754;
url+="&bridgeNo="+bridgeNumber;
url+="&"+csrfParamName+"="+csrfToken;
url+="&action="+_3750+"&modulename="+_374d+"&macroname="+_374e+"&currentSelection="+_3760+"&afterRTC="+_374f;
url+="&aSR="+getAvailableStartRow();
url+="&aER="+getAvailableEndRow();
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
url+="&FR="+FREEZED_ROW;
}
url+="&TC="+totCols;
url+="&TR="+totRows;
url+="&docName="+DOCUMENT_NAME;
if(typeof _3752!="undefined"){
var _3762="<Modules>";
url+="&changeflag=true";
for(var x in _3752){
if(typeof x!="undefined"){
_3762+="<Module Name=\""+_3752[x].Name+"\"><![CDATA["+_3752[x].Content+"]]></Module>";
if(_374f==true){
if(ISMACROEDITOROPEN){
var eA=window.frames["frame_macrotextid"].editArea;
editAreaLoader.getFile("macrotextid",_3752[x].Name).text=_3752[x].Content;
eA.files[_3752[x].Name]["compare_edited_text"]=_3752[x].Content;
if(_3752[x].Name==editAreaLoader.getCurrentFile("macrotextid").id){
if(!ISMINDLG){
eA.textarea.value=_3752[x].Content;
var y=showConfirmDialog(replaceParams(jsTitleMsg.UserhasModifiedTheModule,new Array(_3751,_3752[x].Name))+"\n"+jsTitleMsg.DoYouWantToReloadIt);
if(y){
var range=editAreaLoader.getSelectionRange("macrotextid");
eA.textarea.focus();
eA.display_file(editAreaLoader.getCurrentFile("macrotextid").id);
editAreaLoader.setSelectionRange("macrotextid",range.start,range.end);
}
}
}
}else{
if(ISMINDLG){
var i=getModuleIndex(_3752[x].Name);
if(i!=null){
module_content[i]=_3752[x].Content;
}
if(ISMACROEDITOROPEN){
var eA=window.frames["frame_macrotextid"].editArea;
editAreaLoader.getFile("macrotextid",_3752[x].Name).text=_3752[x].Content;
eA.files[_3752[x].Name]["compare_edited_text"]=_3752[x].Content;
if(_3752[x].Name==editAreaLoader.getCurrentFile("macrotextid").id){
eA.textarea.value=_3752[x].Content;
}
}
}
}
}
}
}
_3762+="</Modules>";
url+="&modulecontent="+_3762;
}
checkMacroTriggerObj["isMacroTrigger"]=true;
_375a.send(url);
}
var previousMdl="";
function loadMacro(_3767,_3768,_3769){
var eA=window.frames["frame_macrotextid"].editArea;
var _376b;
if(typeof currentMdl.PREVIOUS!="undefined"&&currentMdl.PREVIOUS!=""){
_376b=getObj("tr_"+currentMdl.PREVIOUS);
currentMdl.PREVIOUS="";
}else{
if(typeof currentMdl.CURRENT!="undefined"){
_376b=getObj("tr_"+currentMdl.CURRENT);
}
}
if(_376b){
_376b.cells[_376b.cells.length-1].getElementsByTagName("A")[0].className="";
}
clearModuleHiglight();
if(errorObj.ISERROR==true){
enableError();
if(typeof errorObj.MODULENAME!="undefined"&&errorObj.MODULENAME!=""&&errorObj.MODULENAME!="unknown"){
if(errorObj.MODULENAME==_3767){
showMacroError();
}else{
disableError();
}
}
}
currentMdl.CURRENT=_3767;
var trobj=getObj("tr_"+_3767);
if(trobj!=null){
var a=trobj.cells[trobj.cells.length-1].getElementsByTagName("A")[0].className="scriptExplrSeletedObject";
}
currentMdl.CTYPE=_3768;
eA.execCommand("switch_to_file",_3767);
getObj("modulename").innerHTML=_3767;
if(!jsVERSION_VIEW&&!jsPUBLIC_VIEW&&!jsGUEST_VIEW&&ALLOW_TO_WRITE){
if(_3768==5){
getObj("events").style.display="none";
getObj("arrow").style.display="none";
}else{
getObj("arrow").style.display="";
getObj("events").style.display="";
}
if(_3768==1){
getObj("sheetevents").style.display="";
getObj("workbookevents").style.display="none";
}else{
if(_3768==2){
getObj("sheetevents").style.display="none";
getObj("workbookevents").style.display="";
}
}
if(typeof _3769!="undefined"){
eA.execCommand("go_to_line",_3769);
}
}
}
function saveMacro(_376e,_376f,_3770,_3771){
if(jsVERSION_VIEW||jsPUBLIC_VIEW||jsGUEST_VIEW){
return;
}
if(typeof _376e=="undefined"){
_376e=false;
}
if(!_376e&&!ALLOW_TO_WRITE){
return;
}
var _3772=DOCUMENT_NAME;
if(DOCUMENT_ID=="doc_id"){
_3772=showPromptDialog(jsTitleMsg.TheSpreadsheetIsNotYetSaved+" "+jsTitleMsg.KindlySaveAndContinue,jsTitleMsg.UntitledSpreadsheet);
}
if(!((_3772=="")||(_3772==null))){
var url=getMacroUrl()+"&action=save";
var _3774="<Modules>";
var eA;
if(window.frames["frame_macrotextid"]){
eA=window.frames["frame_macrotextid"].editArea;
}
if(!_376e){
var i;
if(ISMACROEDITOROPEN){
for(i=0;i<mdlnames.length;i++){
if(eA.files[mdlnames[i]]["compare_edited_text"]!=editAreaLoader.getFile("macrotextid",mdlnames[i]).text){
eA.files[mdlnames[i]]["compare_edited_text"]=editAreaLoader.getFile("macrotextid",mdlnames[i]).text;
_3774+="<Module Name=\""+mdlnames[i]+"\"><![CDATA["+encodeURIComponent(editAreaLoader.getFile("macrotextid",mdlnames[i]).text)+"]]></Module>";
}
}
}else{
for(i=0;i<mdlnames.length;i++){
_3774+="<Module Name=\""+mdlnames[i]+"\"><![CDATA["+encodeURIComponent(module_content[i])+"]]></Module>";
}
}
}else{
for(var x in _376f){
if(typeof x!="undefined"){
_3774+="<Module Name=\""+_376f[x].Name+"\"><![CDATA["+_376f[x].Content+"]]></Module>";
if(ISMACROEDITOROPEN){
editAreaLoader.getFile("macrotextid",_376f[x].Name).text=_376f[x].Content;
eA.files[_376f[x].Name]["compare_edited_text"]=_376f[x].Content;
if(_376f[x].Name==editAreaLoader.getCurrentFile("macrotextid").id){
eA.textarea.value=_376f[x].Content;
if(!ISMINDLG){
var y=showConfirmDialog(replaceParams(jsTitleMsg.UserhasModifiedTheModule,new Array(_3770,_376f[x].Name))+"\n"+jsTitleMsg.DoYouWantToReloadIt);
if(y){
var range=editAreaLoader.getSelectionRange("macrotextid");
eA.textarea.focus();
eA.display_file(editAreaLoader.getCurrentFile("macrotextid").id);
editAreaLoader.setSelectionRange("macrotextid",range.start,range.end);
}
}
}
}
if(ISMINDLG){
var i=getModuleIndex(_376f[x].Name);
if(i!=null){
module_content[i]=_376f[x].Content;
}
}
}
}
}
_3774+="</Modules>";
var _377a=getObj("busydiv");
if(_377a){
_377a.innerHTML=jsMsg.Saving;
_377a.style.display="";
}
var _377b=new getXmlhttp();
_377b.open("POST",ctxpath+"macro.do",true);
_377b.onreadystatechange=function(){
if(_377b.readyState==4){
checkMacroTriggerObj["isMacroTrigger"]=false;
macroBtn_disabled();
isSaveButtonEnabled=false;
if(!enableSaveButtonForMacro&&READ_WRITE){
btn_disabled();
}
if(checkMacroTriggerObj["isAutoSaveForMacro"]){
savefile();
}
if(typeof _3771!="undefined"&&!_376e){
if(_3771=="insertmacro"){
showManageMacros("create");
}else{
if(_3771=="listmacro"){
showManageMacros("show");
}else{
savefile(_3771);
}
}
}
if(_377a){
_377a.style.display="none";
}
var _377c=_377b.responseText;
if((DOCUMENT_ID=="doc_id")&&(_377c.trim().length!=0)){
if(ISMACROEDITOROPEN){
getObj("docNameSpan").innerHTML=_3772;
}
handleDocmentAction("ADD",eval("("+_377c+")"));
}
if(ISMACROEDITOROPEN){
for(i=0;i<mdlnames.length;i++){
eA.files[mdlnames[i]]["compare_edited_text"]=editAreaLoader.getFile("macrotextid",mdlnames[i]).text;
}
}
}
};
url+="&afterRTC="+_376e+"&changeflag=true&docName="+_3772+"&modulecontent="+_3774;
url+="&rowHeight="+encodeURIComponent(getAryMetadata(rowHeightAry));
_377b.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
checkMacroTriggerObj["isMacroTrigger"]=true;
_377b.send(url);
}
}
function tempSaveMacro(_377d,param){
if(!MACRO_DOC_SAVED){
var url=getMacroUrl()+"&action=tempsave";
var _3780="<Modules>";
var eA;
if(ISMACROEDITOROPEN){
eA=window.frames["frame_macrotextid"].editArea;
for(i=0;i<mdlnames.length;i++){
if(eA.files[mdlnames[i]]["compare_edited_text"]!=editAreaLoader.getFile("macrotextid",mdlnames[i]).text){
eA.files[mdlnames[i]]["compare_edited_text"]=editAreaLoader.getFile("macrotextid",mdlnames[i]).text;
_3780+="<Module Name=\""+mdlnames[i]+"\"><![CDATA["+encodeURIComponent(editAreaLoader.getFile("macrotextid",mdlnames[i]).text)+"]]></Module>";
}
}
}else{
for(i=0;i<mdlnames.length;i++){
_3780+="<Module Name=\""+mdlnames[i]+"\"><![CDATA["+encodeURIComponent(module_content[i])+"]]></Module>";
}
}
_3780+="</Modules>";
var _3782=new getXmlhttp();
_3782.open("POST",ctxpath+"macro.do",true);
_3782.onreadystatechange=function(){
if(_3782.readyState==4){
checkMacroTriggerObj["isMacroTrigger"]=false;
MACRO_DOC_SAVED=true;
isSaveButtonEnabled=true;
if(checkMacroTriggerObj["isAutoSaveForMacro"]){
savefile();
}
if(_377d=="show"){
showManageMacros(param);
}
}
};
url+="&afterRTC=false&changeflag=true&docName="+docname+"&modulecontent="+_3780;
_3782.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
checkMacroTriggerObj["isMacroTrigger"]=true;
_3782.send(url);
}
}
function prepare(_3783){
if(window.frames["frame_macrotextid"]){
var eA=window.frames["frame_macrotextid"].editArea;
if(eA.textarea!=null&&typeof eA.textarea!="undefined"){
var range=editAreaLoader.getSelectionRange("macrotextid");
eA.textarea.focus();
editAreaLoader.setSelectionRange("macrotextid",range.start,range.end);
var _3786=editAreaLoader.getCurrentFile("macrotextid").id;
runCodeMacro(_3786,_3783,eA.get_selection_infos()["line_start"]);
}
}
}
function closeMacroList(){
getObj("RunMacroList").style.display="none";
if(!ISMACROEDITOROPEN){
closeDialog();
}
}
function deleteMacro(_3787,_3788,_3789,_378a,_378b){
if(typeof _3789=="undefined"){
_3789=false;
}
if(_3789==false){
var x=showConfirmDialog(replaceParams(jsTitleMsg.AreYouSureToDeleteMacro,new Array(_3788)));
}
if(x==true||_3789==true){
var _378d=new getXmlhttp();
_378d.open("POST",ctxpath+"macro.do",true);
_378d.onreadystatechange=function(){
if(_378d.readyState==4){
checkMacroTriggerObj["isMacroTrigger"]=false;
if(READ_WRITE){
btn_enabled();
}
if(checkMacroTriggerObj["isAutoSaveForMacro"]){
savefile();
}
if(_3789==false){
if(_378d.responseText!="Failed"){
deleteMacroRow(_3787,_3788);
if(ISMINDLG&&!ISMACROEDITOROPEN){
var i=getModuleIndex(_3787);
module_content[i]=_378d.responseText;
}
}
}
}
};
_378d.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var i;
var url=getMacroUrl()+"&action=delete&modulename="+_3787+"&macroname="+_3788+"&afterRTC="+_3789;
if(_3789==true){
url+="&changeflag=true&modulecontent=<Modules><Module Name=\""+_3787+"\"><![CDATA["+encodeURIComponent(_378a)+"]]></Module></Modules>";
if(ISMACROEDITOROPEN){
if(window.frames["frame_macrotextid"]){
var eA=window.frames["frame_macrotextid"].editArea;
editAreaLoader.getFile("macrotextid",_3787).text=_378a;
eA.files[_3787]["compare_edited_text"]=_378a;
if(_3787==editAreaLoader.getCurrentFile("macrotextid").id){
eA.textarea.value=_378a;
if(!ISMINDLG){
var y=showConfirmDialog(replaceParams(jsTitleMsg.UserhasModifiedTheModule,new Array(_378b,_3787))+"\n"+jsTitleMsg.DoYouWantToReloadIt);
if(y){
var range=editAreaLoader.getSelectionRange("macrotextid");
eA.textarea.focus();
eA.display_file(editAreaLoader.getCurrentFile("macrotextid").id);
editAreaLoader.setSelectionRange("macrotextid",range.start,range.end);
}
}
}
}
}
if(ISMINDLG){
var i=getModuleIndex(_3787);
module_content[i]=_378a;
}
deleteMacroRow(_3787,_3788);
}
checkMacroTriggerObj["isMacroTrigger"]=true;
_378d.send(url);
}
}
function sheetEvent(_3794){
var _3795="\n";
if(is_ie){
_3795="\r\n";
}
var event=_3794.options[_3794.selectedIndex].value;
if(event!="none"){
var _3797=editAreaLoader.getCurrentFile("macrotextid").text;
var exp=new RegExp("Sub\\s+"+event,"i");
var j=exp.exec(_3797);
var i;
if(j!=null){
i=_3797.indexOf("\n",j.index)+1;
}else{
var start="";
var end="";
if(_3797.charAt(_3797.length-1)!="\n"){
start=_3795;
}
start+=_3794[_3794.selectedIndex].getAttribute("param");
if(event=="Worksheet_Change"){
start+=_3795+"Application.EnableEvents = false";
start+=_3795+"On Error Goto ENEV";
start+=_3795+"REM add your code below";
start+=_3795;
end+=_3795+"ENEV:";
end+=_3795+"Application.EnableEvents = true";
}else{
end+=_3795;
}
end+=_3795+"End Sub"+_3795;
window.frames["frame_macrotextid"].editArea.textarea.value+=(start+end);
_3797=window.frames["frame_macrotextid"].editArea.textarea.value;
i=_3797.length-end.length;
}
window.frames["frame_macrotextid"].editArea.area_select(i,0);
_3794.selectedIndex=0;
MacroBtn_enabled();
}
}
function initEditArea(){
var _379d=getObj("mdlcontDIV");
_379d.style.display="";
if(macrodialog==null){
macrodialog=_379d.cloneNode(true);
}
var frm=_379d.getElementsByTagName("IFRAME")[0];
if(frm!=null){
frm.parentNode.removeChild(frm);
}
var _379f=findDocDim();
var _37a0=getObj("macroBrowser");
var txted=getObj("macrotextid");
var _37a2=_379d.offsetHeight;
var _37a3=5;
if(_37a0){
if(is_ie){
_37a0.style.height=getObj("objbrowser").offsetHeight+"px";
}else{
_37a0.style.height=getObj("objbrowser").offsetHeight-_37a3+"px";
txted.style.display="none";
}
}
txted.style.height="100%";
if(MACROSAVED){
macroBtn_disabled();
}
editAreaLoader.init({id:"macrotextid",syntax:"vb",start_highlight:true,allow_resize:"no",allow_toggle:false,font_size:10,font_family:"monospace",max_undo:20,EA_load_callback:callback_load,height:_37a2,replace_tab_by_spaces:4});
}
function updateMacroRTC(msg){
var _37a5=msg["SUBMODE"];
if((_37a5=="run")||(_37a5=="saverun")){
if(typeof msg["MODULENAME"]!="undefined"){
runmacro(msg["MODULENAME"],msg["MACRONAME"],true,_37a5,msg["LOGINNAME"],msg["MODULECONTENT"],msg["CURRENTSELECTION"],msg["CURRENTSHEETNAME"]);
}
}else{
if(_37a5=="save"){
if(typeof msg["MODULECONTENT"]!="undefined"){
saveMacro(true,msg["MODULECONTENT"],msg["LOGINNAME"]);
}
}else{
if(_37a5=="insert"){
insertMacro(true,msg["MACRONAME"],msg["NEWMODULCONTENT"],msg["LOGINNAME"]);
}else{
if(_37a5=="delete"){
deleteMacro(msg["MODULENAME"],msg["MACRONAME"],true,msg["MODULECONTENT"],msg["LOGINNAME"]);
}else{
if(_37a5=="recordedmacro"){
updateRecordedMacro(msg["MODULCONTENT"],msg["LOGINNAME"]);
}
}
}
}
}
}
function updateRecordedMacro(_37a6,_37a7){
var url=getMacroUrl()+"&action=recordedmacro";
var eA;
if(window.frames["frame_macrotextid"]){
eA=window.frames["frame_macrotextid"].editArea;
}
var _37aa="<Modules><Module Name=\"Macros\"><![CDATA["+_37a6+"]]></Module></Modules>";
if(ISMACROEDITOROPEN){
if(!ISMINDLG&&editAreaLoader.getCurrentFile("macrotextid").id=="Macros"){
eA=window.frames["frame_macrotextid"].editArea;
eA.textarea.value=_37a6;
var y=showConfirmDialog(replaceParams(jsTitleMsg.UserhasModifiedTheModule,new Array(_37a7,"Macros"))+"\n"+jsTitleMsg.DoYouWantToReloadIt);
if(y){
var range=editAreaLoader.getSelectionRange("macrotextid");
eA.textarea.focus();
eA.display_file("Macros");
editAreaLoader.setSelectionRange("macrotextid",range.start,range.end);
}
}
}
if(ISMINDLG){
var i=getModuleIndex("Macros");
if(i!=null){
module_content[i]=_37a6;
}
}
var _37ae=new getXmlhttp();
_37ae.open("POST",ctxpath+"macro.do",true);
_37ae.onreadystatechange=function(){
if(_37ae.readyState==4){
checkMacroTriggerObj["isMacroTrigger"]=false;
if(enableSaveButtonForMacro&&READ_WRITE){
btn_enabled();
enableSaveButtonForMacro=false;
}
if(checkMacroTriggerObj["isAutoSaveForMacro"]){
savefile();
}
if(ISMACROEDITOROPEN){
MACROSAVED=false;
}
}
};
url+="&afterRTC=true&changeflag=true&docName="+docname+"&modulecontent="+_37aa;
_37ae.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
checkMacroTriggerObj["isMacroTrigger"]=true;
_37ae.send(url);
}
function deleteMacroRow(_37af,_37b0){
var trele=getObj(_37af+"."+_37b0);
if(trele){
var _37b2=trele.parentNode;
_37b2.removeChild(trele);
isSaveButtonEnabled=true;
if(_37b2.rows.length==1){
var tr=getObj("nomacrotr");
tr.style.display="";
}
}
}
function getMacroUrl(){
var url="docowner="+CURR_DOC_OWNERNAME;
url+="&collabid="+COLLAB_ID;
url+="&readwrite="+ALLOW_TO_WRITE;
url+="&collabEditing="+COLLABORATIVE_EDITING;
url+="&viewType="+getObj("VIEW").value;
url+="&docid="+DOCUMENT_ID;
url+="&currenttime="+CURRENTTIME;
url+="&currentSheetName="+CURRSHEETNAME;
url+="&bridgeNo="+bridgeNumber;
url+="&"+csrfParamName+"="+csrfToken;
url+="&aSR="+getAvailableStartRow();
url+="&aER="+getAvailableEndRow();
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
nvp+="&FR="+FREEZED_ROW;
}
url+="&TC="+totCols;
url+="&TR="+totRows;
return url;
}
function toggleEditor(){
if(RECORDINGMACRO){
return;
}
if(!ISMINDLG){
ISMINDLG=true;
var _37b5=getObj("mdlcontDIV");
if(_37b5!=null){
macrodialog=_37b5.cloneNode(true);
runMacroList=getObj("RunMacroList").cloneNode(true);
}
ISMACROEDITOROPEN=true;
currentMdl.CURLINE=editAreaLoader.getSelectionRange("macrotextid");
for(i=0;i<mdlnames.length;i++){
module_content[i]=(editAreaLoader.getFile("macrotextid",mdlnames[i]).text);
}
var _37b6=getObj("titlebar");
if(minbarhtml==""){
document.getElementsByTagName("body")[0].appendChild(dynele);
minbarhtml="<table width=\"100%\" height=\"25\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"scriptEditorDialog\">";
minbarhtml+="<tr><td class=\"scriptEditorDialogTitleBar\">"+_37b6.innerHTML+"</td></tr></table>";
dynele.id="mindlg";
}
dynele.innerHTML=minbarhtml;
dynele.style.position="absolute";
dynele.style.left=findPosX(_37b6)+"px";
dynele.style.top=findPosY(_37b6)+"px";
dynele.style.display="";
var _37b7=getObj("minidlg");
if(findPosX(_37b6)>findPosX(_37b7)){
xMinVal=-((findPosX(_37b6)-findPosX(_37b7))/8);
}else{
if(findPosX(_37b6)<findPosX(_37b7)){
xMinVal=(findPosX(_37b7)-findPosX(_37b6))/8;
}
}
if(findPosY(_37b6)!=findPosY(_37b7)){
yMinVal=(findPosY(_37b6)-findPosY(_37b7))/8;
}
var _37b8=findDocDim();
dynele.style.width=(_37b8.width-300);
minWidth=(_37b8.width-450)/8;
minimizedlg("firstTime");
setTimeout(hideDialog,50);
closeDialog();
if(ole.isActive()){
ole.conf.onfocus();
}else{
setFocusInCellField();
}
}else{
if(ISMACROEDITOROPEN){
if(ISMACRODOCCHANGE){
closeEditorDialog();
showMacroEditorDialog();
}else{
ISMINDLG=false;
recallDialog();
window.frames["frame_macrotextid"].editArea.textarea.focus();
if(typeof currentMdl.CURLINE!="undefined"&&currentMdl.CURLINE!=null){
if(typeof currentMdl.CURLINE.start!="undefined"){
editAreaLoader.setSelectionRange("macrotextid",currentMdl.CURLINE.start,currentMdl.CURLINE.end);
}else{
window.frames["frame_macrotextid"].editArea.execCommand("go_to_line",currentMdl.CURLINE);
}
}
if(MACROSAVED){
macroBtn_disabled();
}
}
}else{
showMacroEditorDialog();
}
dynele.style.display="none";
}
}
function minimizedlg(){
var _37b9=getObj("minidlg");
dynele.style.left=(parseInt(dynele.style.left)+xMinVal)+"px";
dynele.style.top=(parseInt(dynele.style.top)-yMinVal)+"px";
dynele.style.width=(parseInt(dynele.style.width)-minWidth)+"px";
if(parseInt(dynele.style.top)>findPosY(_37b9)+yMinVal){
setTimeout(minimizedlg,50);
}else{
dynele.innerHTML=getObj("minimizediv").innerHTML;
dynele.style.top="0px";
dynele.style.left=findPosX(_37b9)+"px";
dynele.style.height="25px";
dynele.style.width="150px";
}
}
function updateChartList(_37ba){
if(chartList.length==0){
chartList=_37ba.split(",");
}else{
_37ba=_37ba.split(",");
for(var j=0;j<_37ba.length;j++){
for(var i=0;i<chartList.length;i++){
if(chartList[i]==_37ba[i]){
break;
}
}
if(i==chartList.length){
chartList.push(_37ba[j]);
}
}
}
}
function objectExplorer(obj){
if(obj.id=="objHead"){
var _37be=getObj("obList");
if(_37be.style.display=="none"){
_37be.style.display="block";
getObj("col1").style.display="block";
getObj("exp1").style.display="none";
}else{
_37be.style.display="none";
getObj("col1").style.display="none";
getObj("exp1").style.display="block";
}
}else{
var _37bf=getObj("macList");
if(_37bf.style.display=="none"){
_37bf.style.display="block";
getObj("exp2").style.display="block";
getObj("col2").style.display="none";
}else{
_37bf.style.display="none";
getObj("exp2").style.display="none";
getObj("col2").style.display="block";
}
}
}
function showInsertMethod(){
closeAllPopup();
$("#insertdiv").show();
$("#insertdiv").css({width:"23.5%",top:"40%",left:"40%"});
var _37c0=getObj("functionname");
_37c0.value="";
_37c0.focus();
}
function setType(ele){
document.forms["insertform"].methodtype.value=ele.value;
}
function insertMethod(){
var _37c2="\n";
if(is_ie){
_37c2="\r\n";
}
var name=document.forms["insertform"].functionname.value;
name=name.trim();
if(name.length==0){
showAlertDialog(jsTitleMsg.ProcedureNameCannotBeEmpty);
document.forms["insertform"].functionname.focus();
return false;
}
var _37c4=checkMacroName(name);
if(_37c4>0){
if(_37c4==1){
showAlertDialog(jsTitleMsg.ProcedureNameCannotContainMsg);
}else{
if(_37c4==2){
showAlertDialog(jsTitleMsg.ProcedureNameStartWithMsg);
}else{
showAlertDialog(jsTitleMsg.ProcedureNameInEnglish);
}
}
document.forms["insertform"].functionname.select();
return false;
}
getObj("insertdiv").style.display="none";
var _37c5=window.frames["frame_macrotextid"].editArea.textarea.value;
var start="";
if(_37c5.charAt(_37c5.length-1)!="\n"){
start=_37c2;
}
start+=document.forms["insertform"].insertscope.value+" "+document.forms["insertform"].methodtype.value+" "+name+"()"+_37c2;
var end=_37c2+"End "+document.forms["insertform"].methodtype.value+_37c2;
window.frames["frame_macrotextid"].editArea.textarea.value+=(start+end);
_37c5=window.frames["frame_macrotextid"].editArea.textarea.value;
var pos=_37c5.length-end.length;
window.frames["frame_macrotextid"].editArea.area_select(pos,0);
MacroBtn_enabled();
window.frames["frame_macrotextid"].editArea.execCommand("check_undo",true);
return false;
}
function closeInsertDiv(){
getObj("insertdiv").style.display="none";
window.frames["frame_macrotextid"].editArea.textarea.focus();
}
function setScope(ele){
document.forms["insertform"].insertscope.value=ele.value;
}
function editor_undo(){
window.frames["frame_macrotextid"].editArea.execCommand("undo");
}
function editor_redo(){
window.frames["frame_macrotextid"].editArea.execCommand("redo");
}
function editor_find(){
window.frames["frame_macrotextid"].editArea.execCommand("show_search");
}
function editor_goto(){
var _37ca=parseInt($("#lineNo").text());
if(isNaN(_37ca)){
var obj=getObj("lineNo");
var _37ca=obj.value;
if(isNaN(_37ca)){
showAlertDialog(jsTitleMsg.PleaseEnterAnInteger);
$("#lineNo").select();
return false;
}
}
closeGotoDiv();
window.frames["frame_macrotextid"].editArea.execCommand("go_to_line",_37ca+"");
return false;
}
function closeGotoDiv(){
$("#lineNo").text("");
getObj("gotodiv").style.display="none";
window.frames["frame_macrotextid"].editArea.textarea.focus();
}
function showGoto(){
$("#gotodiv").css({position:"absolute",left:"45%",top:"30%"});
$("#gotodiv").show();
$("#lineNo").focus();
$("#lineNo").select();
}
function expandObjectExplorer(expl){
var _37cd=getObj(expl);
var _37ce=_37cd.parentNode;
var _37cf=_37cd.getAttribute("expand");
var start;
var end=end=_37ce.rows.length;
if(expl=="ObjectExplore"){
start=1;
if(custommdlcnt!=0){
end=end-custommdlcnt-1;
}
}else{
start=_37ce.rows.length-custommdlcnt;
}
if(_37cf=="true"){
for(var i=start;i<end;i++){
_37ce.rows[i].style.display="";
}
_37cd.setAttribute("expand","false");
_37cd.cells[0].getElementsByTagName("img")[0].className="mainBgImg macroItemCol";
if(expl=="ObjectExplore"){
_37cd.cells[1].getElementsByTagName("IMG")[0].className="mainBgImg scriptExplrObjectOpenFolder";
}else{
_37cd.cells[1].getElementsByTagName("IMG")[0].className="mainBgImg scriptExplrModuleOpenFolder";
}
}else{
for(var i=start;i<end;i++){
_37ce.rows[i].style.display="none";
}
_37cd.setAttribute("expand","true");
_37cd.cells[0].getElementsByTagName("img")[0].className="mainBgImg macroItemExp";
if(expl=="ObjectExplore"){
_37cd.cells[1].getElementsByTagName("IMG")[0].className="mainBgImg scriptExplrObjectFolder";
}else{
_37cd.cells[1].getElementsByTagName("IMG")[0].className="mainBgImg scriptExplrModuleFolder";
}
}
}
function macroBtn_disabled(){
MACROSAVED=true;
MACRO_DOC_SAVED=true;
if(getObj("save_img")!=null&&getObj("save_td")!=null){
getObj("save_img").src=IMAGE_PATH+"save_disabled.gif";
if(getObj("saverun_td").getAttribute("iconDisabled")=="false"){
getObj("saverun_img").src=IMAGE_PATH+"saveRunDisabled.gif";
}
getObj("save_td").setAttribute("displayState","disabled");
var _37d3=getIconText(getObj("save_td"));
if(_37d3!=""){
_37d3.className="disabled";
}
}
if(jsREMOTE_SAVE_VIEW||isEdit){
if(getObj("save_img")!=null){
getObj("save_img").src=IMAGE_PATH+"save_disabled.gif";
}
}
}
function MacroBtn_enabled(){
if(MACROSAVED){
if(getObj("save_img")!=null&&getObj("save_td")!=null){
getObj("save_img").src=IMAGE_PATH+"save.gif";
if(getObj("saverun_td").getAttribute("iconDisabled")=="false"){
getObj("saverun_img").src=IMAGE_PATH+"saveRun.gif";
}
getObj("save_td").setAttribute("displayState","enabled");
var _37d4=getIconText(getObj("save_td"));
if(_37d4!=""){
_37d4.className="";
}
}
if(jsREMOTE_SAVE_VIEW||isEdit){
if(getObj("save_img")!=null){
getObj("save_img").src=IMAGE_PATH+"save.gif";
}
}
}
MACROSAVED=false;
MACRO_DOC_SAVED=false;
}
function loadOldMacro(){
if(!jsVERSION_VIEW&&!jsPUBLIC_VIEW&&!jsGUEST_VIEW&&ALLOW_TO_WRITE){
disableRun();
}
var _37d5=MacroPanelState.tabs;
if((is_ie&&browser_ie6)||(!is_ie)){
document.getElementById("frame_macrotextid").style.width="100%";
}
var _37d6=getObj("scriptEditorToolbar");
registerIconEvents(_37d6.getElementsByTagName("TD"));
if(MacroPanelState.explorer==false){
var _37d7=getObj("objbrowser");
_37d7.style.display="";
hideObjectExplorer();
}
for(var i=0;i<mdlnames.length;i++){
var _37d9={id:mdlnames[i],text:module_content[i],syntax:"vb"};
editAreaLoader.openFile("macrotextid",_37d9);
}
if(sheetOperations.length!=0){
for(var x in sheetOperations){
if(typeof sheetOperations[x].ACTION!="undefined"){
updateSheetChangesInEditor(sheetOperations[x]);
}
}
sheetOperations=new Array();
}
handleError(errorObj,false,true);
if(typeof _37d5!="undefined"&&_37d5!=""){
eval(_37d5);
if(MacroPanelState.lineNo!=""){
window.frames["frame_macrotextid"].editArea.execCommand("go_to_line",MacroPanelState.lineNo);
}
}
if(typeof currentMdl.CURRENT!="undefined"&&currentMdl.CURRENT!=null){
if(typeof currentMdl.CURLINE!="undefined"&&currentMdl.CURLINE!=null){
loadMacro(currentMdl.CURRENT,currentMdl.CTYPE);
window.frames["frame_macrotextid"].editArea.textarea.focus();
editAreaLoader.setSelectionRange("macrotextid",currentMdl.CURLINE.start,currentMdl.CURLINE.end);
}else{
loadMacro(currentMdl.CURRENT,currentMdl.CTYPE,currentMdl.LINE);
}
}else{
loadMacro("Macros",5);
}
}
function updateSheetOperations(obj){
sheetOperations.push(obj);
}
function getModuleIndex(mname){
var i;
for(i=0;i<mdlnames.length;i++){
if(mdlnames[i]==mname){
return i;
}
}
return null;
}
function showObjectExplorer(){
getObj("frame_macrotextid").style.width="1px";
var _37de=getObj("hideimg");
var _37df=getObj("expandimg");
var _37e0=getObj("objbrowser");
MacroPanelState.explorer=true;
_37df.style.display="none";
_37e0.style.display="";
_37de.style.display="";
_37de.parentNode.parentNode.className="scriptObjExporerShow";
window.frames["frame_macrotextid"].editArea.manage_width();
}
function hideObjectExplorer(){
var _37e1=getObj("objbrowser");
if(_37e1.style.display=="none"){
showObjectExplorer();
return;
}
var _37e2=getObj("hideimg");
var _37e3=getObj("expandimg");
_37e3.style.display="";
_37e1.style.display="none";
_37e2.style.display="none";
_37e2.parentNode.parentNode.className="scriptObjExporerHide";
MacroPanelState.explorer=false;
window.frames["frame_macrotextid"].editArea.manage_width();
}
function showMacroHelp(){
var _37e4=getObj("helpwindow");
if(_37e4.style.display=="none"){
_37e4.style.display="";
getObj("macroHelpExpColImg").className="mainBgImg macroHelpExp";
}else{
_37e4.style.display="none";
getObj("macroHelpExpColImg").className="mainBgImg macroHelpCol";
}
}
function closetabs(){
MacroPanelState.tabs="";
window.frames["frame_macrotextid"].editArea.execCommand("hidden_tabs");
}
function showWarning(){
var td=getObj("warningtd");
if(td){
window.frames["frame_macrotextid"].editArea.execCommand("show_tabs","warningtab");
MacroPanelState.tabs=showWarning;
}
}
function enableWarning(){
var td=getObj("warningtd");
if(td){
td.setAttribute("displayState","enabled");
window.frames["frame_macrotextid"].editArea.execCommand("close_empty","warn");
td.firstChild.src=IMAGE_PATH+td.getAttribute("imgName")+".gif";
td.title=replaceParams(jsTitleMsg.nWarning,new Array("1"));
showWarning();
}
}
function disableWarning(){
var td=getObj("warningtd");
if(td){
td.setAttribute("displayState","disabled");
td.firstChild.src=IMAGE_PATH+td.getAttribute("imgName")+"_disabled.gif";
window.frames["frame_macrotextid"].editArea.execCommand("show_empty","warn");
td.title=jsTitleMsg.ZeroWarnings;
}
}
function enableError(){
var td=getObj("errortd");
if(td){
td.setAttribute("displayState","enabled");
td.firstChild.src=IMAGE_PATH+td.getAttribute("imgName")+".gif";
window.frames["frame_macrotextid"].editArea.execCommand("close_empty","error");
td.title=replaceParams(jsTitleMsg.nError,new Array("1"));
}
}
function showMacroError(){
var td=getObj("errortd");
if(td){
window.frames["frame_macrotextid"].editArea.execCommand("show_tabs","errortab");
MacroPanelState.tabs=showMacroError;
}
}
function disableError(){
var td=getObj("errortd");
if(td){
td.setAttribute("displayState","disabled");
window.frames["frame_macrotextid"].editArea.execCommand("show_empty","error");
td.firstChild.src=IMAGE_PATH+td.getAttribute("imgName")+"_disabled.gif";
td.title=jsTitleMsg.ZeroErrors;
}
}
function showMessage(){
var td=getObj("msgboxtd");
if(td){
window.frames["frame_macrotextid"].editArea.execCommand("show_tabs","msgboxtab");
MacroPanelState.tabs=showMessage;
}
}
function enableMessage(){
var td=getObj("msgboxtd");
if(td){
td.setAttribute("displayState","enabled");
window.frames["frame_macrotextid"].editArea.execCommand("close_empty","msg");
td.firstChild.src=IMAGE_PATH+td.getAttribute("imgName")+".gif";
if(errorObj.MSGCNT==1){
td.title=replaceParams(jsTitleMsg.nMessage,new Array(""+errorObj.MSGCNT));
}else{
td.title=replaceParams(jsTitleMsg.nMessages,new Array(""+errorObj.MSGCNT));
}
}
}
function disableMessage(){
var td=getObj("msgboxtd");
if(td){
td.setAttribute("displayState","disabled");
window.frames["frame_macrotextid"].editArea.execCommand("show_empty","msg");
td.firstChild.src=IMAGE_PATH+td.getAttribute("imgName")+"_disabled.gif";
td.title=jsTitleMsg.ZeroMessages;
}
}
function enableEvents(){
var _37ee=getObj("busydiv");
_37ee.innerHTML=jsMsg.EnableEvents;
var _37ef=new getXmlhttp();
_37ef.open("POST",ctxpath+"macro.do",true);
_37ef.onreadystatechange=function(){
if(_37ef.readyState==4){
checkMacroTriggerObj["isMacroTrigger"]=false;
if(enableSaveButtonForMacro&&READ_WRITE){
btn_enabled();
enableSaveButtonForMacro=false;
}
if(checkMacroTriggerObj["isAutoSaveForMacro"]){
savefile();
}
_37ee.style.display="none";
disableWarning();
}else{
_37ee.style.display="";
}
};
_37ef.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
checkMacroTriggerObj["isMacroTrigger"]=true;
_37ef.send(getMacroUrl()+"&action=enableEvents");
}
function showMsgBox(ele){
var obj=getObj("msgboxtr");
if(obj.style.display=="none"){
obj.style.display="";
document.getElementById("msgBoxInd").style.paddingBottom="10px";
ele.value=jsTitleMsg.HideMessages;
}else{
obj.style.display="none";
ele.value=jsTitleMsg.ShowMessages;
}
}
function insertMessage(msg){
if(typeof errorObj.MSGCNT=="undefined"){
errorObj.MSGCNT=1;
}else{
errorObj.MSGCNT++;
}
if(!ISMINDLG&&ISMACROEDITOROPEN){
window.frames["frame_macrotextid"].editArea.execCommand("insert_msg",msg);
}
}
function clearMessage(){
if(typeof errorObj.MSGCNT!="undefined"){
errorObj.MSGCNT=0;
}
if(!ISMINDLG&&ISMACROEDITOROPEN){
window.frames["frame_macrotextid"].editArea.execCommand("clear_msg");
}
}
function insertError(obj){
if(!ISMINDLG&&ISMACROEDITOROPEN){
window.frames["frame_macrotextid"].editArea.execCommand("insert_error",obj);
}
}
function isMacroSupport(){
if(!isSSActive){
try{
var type=ZDBClientUI.selectedTab.view.type;
if(typeof type!="undefined"&&type!=null){
if(type=="Table"){
showAlertDialog(jsTitleMsg.CannotRunWhenCurrentTS);
return false;
}
if(type=="Pivot"){
showAlertDialog(jsTitleMsg.CannotRunWhenCurrentPT);
return false;
}
if(type=="AnalysisView"){
showAlertDialog(jsTitleMsg.CannotRunWhenCurrentPC);
return false;
}
}
}
catch(e){
return true;
}
}
return true;
}
function showCreateMacro(){
var _37f5=getObj("createMacroContent");
var _37f6=getObj("createMacroExp");
var _37f7=getObj("createMacroCol");
if(_37f5.style.display=="none"){
_37f5.style.display="";
_37f6.style.display="";
_37f7.style.display="none";
focusModuleName();
}else{
_37f5.style.display="none";
_37f6.style.display="none";
_37f7.style.display="";
}
}
function higlightModule(ele){
clearModuleHiglight();
ele.className="scriptExplrSeletedObject";
if(ele.parentNode.parentNode.getAttribute("expand")=="true"){
expandObjectExplorer(ele.parentNode.parentNode.id);
}
var _37f9=getObj("tr_"+currentMdl.CURRENT);
if(_37f9){
_37f9.cells[_37f9.cells.length-1].getElementsByTagName("A")[0].className="scriptExplrPrevSeletedObject";
}
}
function clearModuleHiglight(){
var _37fa=getObj("ObjectExplore");
var _37fb=getObj("ModuleExplore");
if(_37fa){
_37fa.cells[_37fa.cells.length-1].getElementsByTagName("A")[0].className="";
}
if(_37fb){
_37fb.cells[_37fb.cells.length-1].getElementsByTagName("A")[0].className="";
}
}
function checkMacroName(_37fc){
var regex=new RegExp("[\\u00A1-\\uFFFF]+");
if(regex.test(_37fc)){
return 3;
}
regex=new RegExp("^[a-zA-Z0-9_]+$");
if(regex.test(_37fc)){
var regex=new RegExp("^[a-zA-Z][a-zA-Z0-9_]*$");
if(regex.test(_37fc)){
return 0;
}else{
return 2;
}
}else{
return 1;
}
}
function closeAllPopup(){
getObj("RunMacroList").style.display="none";
getObj("insertdiv").style.display="none";
getObj("gotodiv").style.display="none";
}
function cancelError(){
clearErrorAndMsg();
closeDialog();
}
function clearErrorAndMsg(){
errorObj=new Object();
if(typeof msgboxArray!="undefined"){
msgboxArray=new Array();
}
errorObj.ISERROR=false;
}
var helpMenuStatus=false;
function showHelpMenu(){
if((transMode==true)&&(messagetranslated==true)&&(helpMenuStatus==true)){
Menu.helpMenu.cachedContent="";
helpMenuStatus=false;
}
if(!helpMenuStatus){
var _37fe="";
macroActionsMenuStatus=true;
_37fe="<menu id='helpMenu' forElement='macro_help' onBeforeUnload='menuClose(ev)'>";
if(!HIDE_MACRO_HELP_LINK){
_37fe+=" <item onclick='showHelp()'><![CDATA["+jsMsg.VBAProgramming+"]]></item>";
_37fe+=" <item onclick='showHelp(\"vbaobjectexplorer.do\")'><![CDATA["+jsMsg.VBAObjectExplorer+"]]></item>";
_37fe+=" <sep></sep>";
_37fe+=" <item onclick='showHelp()'><![CDATA["+jsMsg.WhatIsMacro+"]]></item>";
_37fe+=" <item onclick='showHelp(\"SampleMacros\")'><![CDATA["+jsMsg.SampleMacros+"]]></item>";
_37fe+=" <item onclick='showHelp(\"UserMacros\")'><![CDATA["+jsMsg.UserContributedMacros+"]]></item>";
}else{
_37fe+=" <item onclick='showHelp(\"vbaobjectexplorer.do\")'><![CDATA["+jsMsg.VBAObjectExplorer+"]]></item>";
}
_37fe+="</menu>";
Menu.create(_37fe,{inputType:"xml"});
}
showMenu("helpMenu");
}
function showHelp(path){
var url;
if(typeof path!="undefined"){
if(path=="SampleMacros"){
url=jsMsg["Macros.Help.WikiURL"]+"Sample-Macros.html";
}else{
if(path=="UserMacros"){
url=jsMsg["Macros.Help.WikiURL"]+"User-Contributed-Macros.html";
}else{
url=ctxpath+path;
}
}
}else{
url=jsMsg["Macros.Help.WikiURL"];
}
window.open(url);
}
function disableRun(){
var _3801=getObj("run_td");
if(isSSActive){
_3801.setAttribute("iconDisabled","false");
_3801.getElementsByTagName("IMG")[0].className="mainBgImg runMacro";
getObj("saverun_td").setAttribute("iconDisabled","false");
if(MACROSAVED){
getObj("saverun_img").src=IMAGE_PATH+"saveRunDisabled.gif";
}else{
getObj("saverun_img").src=IMAGE_PATH+"saveRun.gif";
}
var _3802=getIconText(getObj("saverun_td"));
if(_3802!=""){
_3802.className="";
}
_3802=getIconText(getObj("run_td"));
if(_3802!=""){
_3802.className="";
}
}else{
_3801.setAttribute("iconDisabled","true");
_3801.getElementsByTagName("IMG")[0].className="mainBgImg runMacroDisabled";
getObj("saverun_td").setAttribute("iconDisabled","true");
getObj("saverun_img").src=IMAGE_PATH+"saveAndRunDisabled.gif";
var _3802=getIconText(getObj("saverun_td"));
if(_3802!=""){
_3802.className="disabled";
}
_3802=getIconText(getObj("run_td"));
if(_3802!=""){
_3802.className="disabled";
}
}
}
var othersheetChanges=new Object();
var sheetName={};
var selectedRange=null;
var chartList;
var msgboxArray=new Array();
var refreshSheet=false;
var tileReloaded=false;
var enableSaveButtonForMacro=false;
function fireWorkbook_OpenEvent(){
if(DOCUMENT_ID=="doc_id"||!isSSActive){
return;
}
var _3803=getCurrentSelection();
var _3804=new getXmlhttp();
_3804.open("POST",ctxpath+"macro.do",true);
_3804.onreadystatechange=function(){
if(_3804.readyState==4){
checkMacroTriggerObj["isMacroTrigger"]=false;
var _3805=_3804.responseText;
updateMacroChanges(_3805,true);
if(enableSaveButtonForMacro&&READ_WRITE){
btn_enabled();
enableSaveButtonForMacro=false;
}
if(checkMacroTriggerObj["isAutoSaveForMacro"]){
savefile();
}
}
};
_3804.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var url=getMacroUrl()+"&afterRTC=false&action=Workbook_Open&currentSelection="+_3803;
checkMacroTriggerObj["isMacroTrigger"]=true;
_3804.send(url);
}
function fireWorkbook_NewSheetEvent(_3807,_3808){
if(typeof _3808=="undefined"){
_3808="false";
}
var _3809="A1";
var _380a=new getXmlhttp();
_380a.open("POST",ctxpath+"macro.do",true);
_380a.onreadystatechange=function(){
if(_380a.readyState==4){
checkMacroTriggerObj["isMacroTrigger"]=false;
var _380b=_380a.responseText;
updateMacroChanges(_380b,true);
if(enableSaveButtonForMacro&&READ_WRITE){
btn_enabled();
enableSaveButtonForMacro=false;
}
if(checkMacroTriggerObj["isAutoSaveForMacro"]){
savefile();
}
}
};
_380a.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var url="docowner="+CURR_DOC_OWNERNAME+"&collabid="+COLLAB_ID+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING+"&viewType="+getObj("VIEW").value+"&docid="+DOCUMENT_ID;
url+="&aSR="+getAvailableStartRow();
url+="&aER="+getAvailableEndRow();
if(FREEZED_ROW>0&&getAvailableStartRow()>ROWS_PER_TILE){
nvp+="&FR="+FREEZED_ROW;
}
url+="&TC="+totCols;
url+="&TR="+totRows;
checkMacroTriggerObj["isMacroTrigger"]=true;
_380a.send(url+"&currenttime="+CURRENTTIME+"&action=Workbook_NewSheet"+"&currentSelection="+_3809+"&currentSheetName="+_3807+"&bridgeNo="+bridgeNumber+"&afterRTC="+_3808+"&"+csrfParamName+"="+csrfToken);
}
function focusSelectedRange(){
if(selectedRange){
var _380d=selectedRange.SR;
var _380e=selectedRange.SC;
var _380f=selectedRange.ER;
var _3810=selectedRange.EC;
if((_380f<getRowMax())&&(_380f>=totRows)){
appendBlankRows("ROWS_EXCEEDED",_380f);
}
if((_380f<totRows)&&(_3810<totCols)){
focusCell(_380d,_380e);
if(!((_380d===_380f)&&(_380e===_3810))){
focusCellRange(_380d,_380e,_380f,_3810);
scrollCellIntoView();
}
blurColHead(0,totCols-1);
selectColHead(_380e,_3810);
blurRowHead(0,totRows-1);
selectRowHead(_380d,_380f);
selectedRange=null;
}
}
}
function updateMacroChanges(_3811,_3812,_3813,sname){
if(typeof _3813=="undefined"){
_3813=false;
}
refreshSheet=false;
tileReloaded=false;
chartList=new Array();
msgboxArray=new Array();
var url="";
if(_3811.trim().length==0){
return;
}
var _3816=parseJSON(_3811);
if(typeof (_3816.mc)=="undefined"){
return;
}
if(_3816.e==true){
if(typeof _3816.ISMACROEXIST!="undefined"){
showAlertDialog(replaceParams(jsTitleMsg["Button.CannotFindMacro"],new Array(_3816.MACRONAME)));
return;
}else{
errorObj=new Object();
errorObj.MESSAGE=_3816.m;
errorObj.MODULENAME=_3816.mn;
errorObj.LINE=_3816.l;
errorObj.COLUMN=_3816.c;
errorObj.ISERROR=true;
errorObj.MODULETYPE=_3816.mt;
}
}else{
errorObj.ISERROR=false;
}
var _3817=isUndefined(_3816.isOO);
var _3818=_3816.mc;
if(_3818.length>0){
gridListener.listen(12);
}
var x;
for(x=0;x<_3818.length;x++){
if(_3817){
updateJson(_3818[x]);
}else{
updateMacroChangesInHtmlClient(_3818[x],_3813,sname);
}
}
if(!_3817){
if(chartList.length!=0){
UpdateCellCharts(chartList.join(","));
}
if(refreshSheet==true){
refreshNonVisibleCellChanges();
}
focusSelectedRange();
if(sheetName&&typeof sheetName.sheetName!="undefined"){
var _381a="open";
if(sheetName.action=="INSERT"){
_381a="new";
}else{
showsheet(getObj("sheetdiv-"+sheetName.sheetName),_381a,"false",true);
}
sheetName={};
}
}else{
if(!isUndefined(_3816[ActionConstants.ENABLE_EVENTS])){
handleWarningTab(_3816[ActionConstants.ENABLE_EVENTS]);
}
if(!isUndefined(_3816.mar)&&getAvailableEndRow()<_3816.mar){
appendBlankRows("ROWS_EXCEEDED",_3816.mar+1);
}
if(_3816.rt==true){
reloadPage();
}
if(_3816.ds==true){
isSaveButtonEnabled=true;
enableSaveButtonForMacro=true;
}
if(!isUndefined(_3816.ARRAYDETAILS)){
var arr=_3816.ARRAYDETAILS;
if(typeof (arr)=="string"&&arr=="EMPTY"){
arrayDetails=new Array();
}else{
arrayDetails=arr;
}
}
}
handleError(errorObj,_3812);
}
function handleWarningTab(_381c){
var td=getObj("warningtd");
if(td){
if(_381c==false){
enableWarning();
}else{
if(td.style.display!="none"){
disableWarning();
}
}
}
}
function updateMacroChangesInHtmlClient(_381e,_381f,sname){
var _3821=_381e.A;
var _3822=_381e.SA;
if(typeof _3821=="undefined"){
return;
}
if(_381f){
if(_3821==106){
var _3823=_381e.SN;
if(CURRSHEETNAME==_3823){
for(var i=0;i<_381e.SC.length;i++){
updateMacroChangesInHtmlClient(_381e.SC[i]);
}
}else{
var _3825=getObj("sheetdiv-"+_3823);
if(_3825!=null){
_3825.innerHTML="<div class='tabItem notify'><div>"+_3823+"</div></div>";
_3825.setAttribute("macrochange","true");
}
if(!othersheetChanges[_3823]){
othersheetChanges[_3823]=new Array();
}
othersheetChanges[_3823].push(_381e.SC);
btn_enabled();
}
}else{
if(sname==CURRSHEETNAME||(_3821==97&&(_3822==104||_3822==98))||(_3821==107)){
updateMacroChangesInHtmlClient(_381e);
}else{
var _3825=getObj("sheetdiv-"+sname);
if(_3825!=null){
_3825.innerHTML="<div class='tabItem notify'><div>"+sname+"</div></div>";
_3825.setAttribute("macrochange","true");
}
if(_3821==95){
var resp;
if(!othersheetChanges[sname]){
othersheetChanges[sname]=new Array();
resp=new Array();
}else{
resp=othersheetChanges[sname].pop();
}
resp.push(_381e);
othersheetChanges[sname].push(resp);
}
btn_enabled();
}
}
return;
}
if(_3821==106){
var _3823=_381e.SN;
var _3825=getObj("sheetdiv-"+_3823);
if(_3825!=null){
_3825.innerHTML="<div class='tabItem notify'><div>"+_3823+"</div></div>";
_3825.setAttribute("macrochange","true");
}
if(!othersheetChanges[_3823]){
othersheetChanges[_3823]=new Array();
}
othersheetChanges[_3823].push(_381e.SC);
btn_enabled();
}else{
if(_3821==97){
sheetName=handleSheetAction(_3822,_381e);
updateSheetAction(_3822,_381e);
isSaveButtonEnabled=true;
}else{
if(_3821==69&&!tileReloaded){
handleRangeFormatAction(_3822,_381e);
isSaveButtonEnabled=true;
}else{
if(_3821==36&&!tileReloaded){
handleRangeBorderAction(_3822,_381e);
isSaveButtonEnabled=true;
}else{
if(_3821==56&&!tileReloaded){
handleRangeHyperlinkAction(_3822,_381e);
isSaveButtonEnabled=true;
}else{
if(_3821==35&&!tileReloaded){
handleRangeCommentAction(_3822,_381e);
isSaveButtonEnabled=true;
}else{
if(_3821==78&&!tileReloaded){
handleLayoutFormatAction(_3822,_381e);
isSaveButtonEnabled=true;
}else{
if(_3821==0&&!tileReloaded){
handleRangeSubmitAction(_3822,_381e);
calcAutoFormulas();
isSaveButtonEnabled=true;
}else{
if(_3821==37&&!tileReloaded){
handleRangeMergeAction(_3822,_381e);
isSaveButtonEnabled=true;
}else{
if(_3821==95){
if(_3822==46){
selectedRange=_381e;
}
}else{
if(_3821==85&&!tileReloaded){
handleInsertRangeAction(_3822,_381e);
isSaveButtonEnabled=true;
}else{
if(_3821==84&&!tileReloaded){
handleDeleteRangeAction(_3822,_381e);
isSaveButtonEnabled=true;
}else{
if(_3821==79){
handleDocmentAction(_3822,_381e);
}else{
if(_3821==70){
handleChartsAction(_3822,_381e);
}else{
if(_3821==67){
handleNameAction(_3822,_381e);
}else{
if(_3821==107){
msgboxArray.push(_381e);
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
function handleNameAction(_3827,_3828){
if(_3827==81){
var cnt=NAMEDRANGES.length;
if(isNameDialogOpened){
var _382a=getObj("namesListTbl");
var _382b=getObj("namesListTBody");
var tr=document.createElement("TR");
var td=document.createElement("TD");
td.style.padding="0px";
var div=document.createElement("DIV");
if(cnt==0){
var _382f=getObj("nameTR_0");
var _3830=_382f.parentNode;
_3830.removeChild(_382f);
}
tr.id="nameTR_"+cnt;
tr.className="trOdd";
var html=constructNameTrHTML(cnt,_3828.NAME,_3828.ADDRESS);
div.innerHTML=html;
td.appendChild(div);
tr.appendChild(td);
_382b.appendChild(tr);
}
var _3832=new Array();
_3832["NAME"]=_3828.NAME;
_3832["CONTENT"]=_3828.ADDRESS;
_3832["STARTROW"]=_3828.SR;
_3832["STARTCOLUMN"]=_3828.SC;
_3832["ENDROW"]=_3828.ER;
_3832["ENDCOLUMN"]=_3828.EC;
_3832["REFSHEET"]=_3828.REFSHEET;
NAMEDRANGES.push(_3832);
var _3833=getCellRange();
if(_3833.startRow==_3828.SR&&_3833.startCol==_3828.SC&&_3833.endRow==_3828.ER&&_3833.endCol==_3828.EC&&CURRSHEETNAME==_3828.REFSHEET){
displayCellName(_3828.SR,_3828.SC,_3828.ER,_3828.EC,_3828.REFSHEET);
}
}else{
if(_3827==83){
if(isNameDialogOpened){
var cnt=-1;
for(var i=0;i<NAMEDRANGES.length;i++){
var _3835=getObj("nameTD_"+i);
if(_3835==null){
cnt=-1;
}
var title=_3835.getAttribute("title");
if(_3828.NAME.toUpperCase().trim()==title.toUpperCase().trim()){
cnt=_3835.id.substring(_3835.id.lastIndexOf("_")+1);
cnt=parseInt(cnt);
break;
}
}
if(cnt==-1){
return;
}
var _382f=getObj("nameTR_"+cnt);
var _3830=_382f.parentNode;
_3830.removeChild(_382f);
if(NAMEDRANGES.length>0){
resetDNIds();
}else{
reconstructNamesListHTML();
}
}
for(var i=0;i<NAMEDRANGES.length;i++){
var _3837=NAMEDRANGES[i];
var name=_3837["NAME"];
if(_3828.NAME.toUpperCase().trim()==name.toUpperCase().trim()){
NAMEDRANGES.splice(i,1);
break;
}
}
if(currCellIndicator.value==_3828.NAME){
var _3839=getCellRange();
var _383a=_3839.startRow;
var _383b=_3839.startCol;
var _383c=_3839.endRow;
var _383d=_3839.endCol;
if(_383a-_383c==0&&_383b-_383d==0){
currCellIndicator.value=getColHeadLabel(_383d+1)+getRowHeadLabel(_383c);
}else{
if(_383a<=_383c&&_383b<=_383d){
currCellIndicator.value=(_383c-_383a+1)+"R x "+(_383d-_383b+1)+"C";
}else{
if(_383c<_383a&&_383d<_383b){
currCellIndicator.value=(_383a-_383c+1)+"R x "+(_383b-_383d+1)+"C";
}else{
if(_383a<=_383c&&_383b>_383d){
currCellIndicator.value=(_383c-_383a+1)+"R x "+(_383b-_383d+1)+"C";
}else{
if(_383c<_383a&&_383b<=_383d){
currCellIndicator.value=(_383a-_383c+1)+"R x "+(_383d-_383b+1)+"C";
}
}
}
}
}
}
}else{
if(_3827==82){
var _383e=new Array();
var _383f=new Array();
_383f.NAME=_3828.OLDNAME;
for(var i=0;i<NAMEDRANGES.length;i++){
_3837=NAMEDRANGES[i];
var name=_3837["NAME"];
if(_3828.OLDNAME.toUpperCase().trim()==name.toUpperCase().trim()){
_383e.NAME=_3828.NEWNAME;
_383e.ADDRESS=_3837["CONTENT"];
_383e.STARTROW=_3837["STARTROW"];
_383e.STARTCOL=_3837["STARTCOLUMN"];
_383e.ENDROW=_3837["ENDROW"];
_383e.ENDCOL=_3837["ENDCOLUMN"];
_383e.REFSHEET=_3837["REFSHEET"];
break;
}
}
handleNameAction(83,_383f);
handleNameAction(81,_383e);
}
}
}
}
function refreshChartUpdatedViaMacro(range){
var _3841=range.split(";");
for(var a=0;a<_3841.length;a++){
var range=_3841[a];
var _3843=getDataRange(range);
if(_3843.type=="CELL"){
if(_3843.row>totRows||_3843.col>totCols){
refreshSheet=true;
break;
}
}else{
if(_3843.type=="RANGE"){
if(_3843.endRow>totRows||_3843.endCol>totCols){
refreshSheet=true;
break;
}
}
}
}
}
function handleChartsAction(_3844,_3845){
if(_3844==71||_3844==75){
var _3846=new getXmlhttp();
_3846.open("POST",ctxpath+"getCharts.do",true);
_3846.onreadystatechange=function(){
if(_3846.readyState==4){
if(_3844==71){
getChartsInfo(_3846.responseXML,"REGENERATE");
var imgid=getChartImgId(_3845.CHART_DBID);
var chart=ExcelGraph.getInstance(imgid);
OLE[imgid].resizeTo(parseInt(chart.CP_WIDTH),parseInt(chart.CP_HEIGHT));
OLE[imgid].moveTo(parseInt(chart.CP_LEFT),parseInt(chart.CP_TOP));
if(ole.isActive()){
if(OLE[ole.getCurrObj().id]==OLE[imgid]){
OLE[imgid].setSelectLayer();
OLE[imgid].positionActionBar(true);
}
}
}
if(_3844==75){
getChartsInfo(_3846.responseXML);
}
}
};
var _3849=encodeURIComponent(CURRSHEETNAME);
var _384a=false;
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
_384a=true;
}
_3846.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_3846.send("docid="+DOCUMENT_ID+"&sheetname="+_3849+"&isRemoteView="+_384a+"&docOwner="+CURR_DOC_OWNERNAME+"&chartDBId="+_3845.CHART_DBID);
}else{
if(_3844==73){
var imgid=getChartImgId(_3845.CHART_DBID);
var chart=ExcelGraph.getInstance(imgid);
refreshChartUpdatedViaMacro(_3845.CHART_RANGE);
if(refreshSheet==false){
RemoveChartCellRange({CP_DATARANGE:_3845.CHART_RANGE,CP_CHARTID:imgid});
}
sheetObjectsPane.removeChild(getObj(imgid));
ExcelGraph.removeInstance(imgid);
}else{
if(_3844==72){
var imgid=getChartImgId(_3845.CHART_DBID);
refreshChartUpdatedViaMacro(_3845.NEWRANGE);
if(refreshSheet==false){
RemoveChartCellRange({CP_DATARANGE:_3845.OLDRANGE,CP_CHARTID:imgid});
UpdateChartCellRange({CP_DATARANGE:_3845.NEWRANGE,CP_CHARTID:imgid});
}
}else{
if(_3844==74){
var imgid=getChartImgId(_3845.CHART_DBID);
if(typeof (_3845.CHART_X_POSITION)!="undefined"){
OLE[imgid].setLeft(_3845.CHART_X_POSITION);
}
if(typeof (_3845.CHART_Y_POSITION)!="undefined"){
OLE[imgid].setTop(_3845.CHART_Y_POSITION);
}
if(ole.isActive()){
if(OLE[ole.getCurrObj().id]==OLE[imgid]){
OLE[imgid].setSelectLayer();
OLE[imgid].positionActionBar(true);
}
}
}
}
}
}
}
function handleDocmentAction(_384d,_384e){
if(_384d==81){
var _384f=_384e.DOCNAME;
var docId=_384e.DOCID;
var _3851=getObj("mydocstbl");
if(_3851.rows.length==1){
var extd=_3851.rows[0];
if(extd.id==""){
_3851.deleteRow(0);
}
}
var trObj=_3851.insertRow(0);
trObj.id="mydoc-"+docId;
var _3854=_3851.rows.length+1;
trObj.className=(_3854%2==0)?"trEven":"trOdd";
var td=document.createElement("td");
td.style.paddingLeft="4px";
td.style.width="14px";
td.innerHTML="<input type='checkbox' id='mydocs_"+(_3851.rows.length-1)+"' value="+docId+">";
trObj.appendChild(td);
td=document.createElement("TD");
td.className="fileName";
var a=document.createElement("A");
a.href=ctxpath+"open.do?docid="+docId;
a.id=docId;
a.title=_384f;
if(is_ie){
a.onclick=function(){
return loadDocument(this.id,this.title);
};
}else{
a.setAttribute("onclick","return loadDocument(\""+docId+"\", \""+_384f+"\");");
}
var _3857=document.createTextNode(_384f);
a.appendChild(_3857);
td.appendChild(a);
trObj.appendChild(td);
td=document.createElement("TD");
td.align="right";
td.style.paddingLeft="4px";
var _3858="spacer.gif";
var _3859="Modified: 1 min ago";
td.innerHTML="<a href=\"#\" onClick=\"return false;\"><img class=\"mainBgImg\" src=\""+IMAGE_PATH+_3858+"\"/></a><a href=\"#\" _contextmenuid=\"mySheetsDocMenu\" id=sbAct_"+docId+" onClick=\"showMySheetsDocMenu(this.id);return false;\"><img class=\"mainBgImg sidebar_actions\" src=\""+IMAGE_PATH+"spacer.gif\"/></a>";
trObj.appendChild(td);
if(DOCUMENT_ID=="doc_id"&&_384e.ISCURRENTDOCUMENT==true){
DOCUMENT_ID=docId;
DOCUMENT_NAME=_384f;
$("#fileName").text(_384f);
document.title=_384f+" - "+jsTitleMsg.ZohoSheetdocName;
}
var _385a=getObj("mysheetspan");
var _385b=_385a.innerHTML;
var _385c=_385b.substring(_385b.indexOf("(")+1,_385b.length-1);
_385c=parseInt(_385c)+1;
_385a.innerHTML="("+_385c+")";
if(typeof _384e.TAGID!="undefined"){
var _385d=getObj("websheettags");
var tag=document.createElement("A");
tag.href="javascript:void(0)";
tag.id=_384e.TAGID;
tag.className="tagmenulinks";
tag.innerHTML=_384f;
_385d.appendChild(tag);
_385d.appendChild(document.createElement("span"));
}
}else{
if(_384d==80){
handleWarningTab(_384e.ISENABLE);
}
}
}
function handleInsertRangeAction(_385f,_3860){
var _3861=_3860.SR;
var _3862=_3860.SC;
var _3863=_3860.ER;
var _3864=_3860.EC;
if(_385f==91){
if(_3863>totRows){
refreshSheet=true;
return;
}
Row.executeShiftOperation("INSERT","above",_3861,_3863-_3861+1,true,true,true);
}else{
if(_385f==92){
if(_3864>totCols){
refreshSheet=true;
return;
}
insertCol("before",_3862,_3864-_3862+1,true,true,true);
}else{
if(_385f==87){
if(_3863>totRows||_3864>totCols){
refreshSheet=true;
return;
}
insertCells();
isSaveButtonEnabled=true;
tileReloaded=true;
}else{
if(_385f==89){
if(_3863>totRows||_3864>totCols){
refreshSheet=true;
return;
}
insertCells();
isSaveButtonEnabled=true;
tileReloaded=true;
}
}
}
}
getCharts(DOCUMENT_ID,CURRSHEETNAME,"REGENERATE");
}
function handleDeleteRangeAction(_3865,_3866){
var _3867=_3866.SR;
var _3868=_3866.SC;
var _3869=_3866.ER;
var _386a=_3866.EC;
if(_3865==91){
if(_3869>totRows){
refreshSheet=true;
return;
}
Row.executeShiftOperation("DELETE",_3867,_3869-_3867+1,true,true);
}else{
if(_3865==92){
if(_386a>totCols){
refreshSheet=true;
return;
}
deleteCol(_3868,_386a-_3868+1,true,true);
}else{
if(_3865==86){
if(_3869>totRows||_386a>totCols){
refreshSheet=true;
return;
}
deleteCells();
isSaveButtonEnabled=true;
tileReloaded=true;
}else{
if(_3865==88){
if(_3869>totRows||_386a>totCols){
refreshSheet=true;
return;
}
deleteCells();
isSaveButtonEnabled=true;
tileReloaded=true;
}
}
}
}
getCharts(DOCUMENT_ID,CURRSHEETNAME,"REGENERATE");
}
function handleRangeMergeAction(_386b,_386c){
var _386d=getViewPortRoundedDetails(_386c.SR,_386c.ER);
if(_386d.isInFreezedRange){
rangeMergeAction(_386d.freezedStartRowIdx,_386c.SC,_386d.freezedEndRowIdx,_386c.EC,_386b,_386c);
}
if(_386d.isInViewPort){
rangeMergeAction(_386d.startRowIdx,_386c.SC,_386d.endRowIdx,_386c.EC,_386b,_386c);
}
}
function rangeMergeAction(_386e,_386f,_3870,_3871,_3872,_3873){
if(_3870>=totRows){
var _3874=_3870;
_3870=totRows-1;
appendBlankRows("ROWS_EXCEEDED",_3874+1);
btn_enabled();
}
if(_3871>=totCols){
_3871=totCols-1;
}
if(_3872==1){
mergeCells(_386e,_386f,_3870,_3871,true,true,true,false);
}else{
if(_3872==0){
splitCells(_386e,_386f,_3870,_3871,true,true,false);
}
}
}
function rangeSubmitAction(_3875,_3876,_3877,_3878,_3879,_387a){
if(_3877>=totRows){
var _387b=_3877;
_3877=totRows-1;
appendBlankRows("ROWS_EXCEEDED",_387b+1);
btn_enabled();
}
for(var _387c=_3875;_387c<=_3875+(_3877-_3875);_387c++){
for(var _387d=_3876;_387d<=_3876+(_3878-_3876);_387d++){
if(isRowAvailable(_387c)&&_387d<totCols){
cellObj=getCell(_387c,_387d);
setCellContentAndFormat(cellObj,_387a,_3879);
var _387e=","+cellObj.getAttribute("charts");
if(_387e!=null){
UpdateCellCharts(_387e,"false");
}
if(ISFREEZED){
if(FREEZED_ROW>0&&_387c<ROWS_PER_TILE){
cellObj=getCell(_387c,_387d,sheetPane2Id);
setCellContentAndFormat(cellObj,_387a,_3879);
}
if(FREEZED_COL>0){
cellObj=getCell(_387c,_387d,sheetPane3Id);
setCellContentAndFormat(cellObj,_387a,_3879);
}
if(FREEZED_ROW>0&&FREEZED_COL>0&&_387c<ROWS_PER_TILE){
cellObj=getCell(_387c,_387d,sheetPane1Id);
setCellContentAndFormat(cellObj,_387a,_3879);
}
}
}
}
}
}
function handleRangeSubmitAction(_387f,_3880){
if(typeof _3880.SR!="undefined"){
var _3881=getViewPortRoundedDetails(_3880.SR,_3880.ER);
if(_3881.isInFreezedRange){
rangeSubmitAction(_3881.freezedStartRowIdx,_3880.SC,_3881.freezedEndRowIdx,_3880.EC,_387f,_3880);
}
if(_3881.isInViewPort){
rangeSubmitAction(_3881.startRowIdx,_3880.SC,_3881.endRowIdx,_3880.EC,_387f,_3880);
}
}else{
var row=_3880.R;
var _3883=_3880.C;
if(!Merge.isCovered(row,_3883)){
if(row>=totRows){
appendBlankRows("ROWS_EXCEEDED",row+1);
btn_enabled();
return;
}
if(isRowAvailable(row)&&_3883<totCols){
cellObj=getCell(row,_3883);
setCellContentAndFormat(cellObj,_3880,_387f);
var _3884=","+cellObj.getAttribute("charts");
if(_3884!=null){
UpdateCellCharts(_3884,"false");
}
if(ISFREEZED){
if(FREEZED_ROW>0&&row<ROWS_PER_TILE){
cellObj=getCell(row,_3883,sheetPane2Id);
setCellContentAndFormat(cellObj,_3880,_387f);
}
if(FREEZED_COL>0){
cellObj=getCell(row,_3883,sheetPane3Id);
setCellContentAndFormat(cellObj,_3880,_387f);
}
if(FREEZED_ROW>0&&FREEZED_COL>0&&row<ROWS_PER_TILE){
cellObj=getCell(row,_3883,sheetPane1Id);
setCellContentAndFormat(cellObj,_3880,_387f);
}
}
}
}
}
}
function rangeFormatAction(_3885,_3886,_3887,_3888,_3889,_388a){
if(_3887>=totRows){
var _388b=_3887;
_3887=totRows-1;
appendBlankRows("ROWS_EXCEEDED",_388b+1);
btn_enabled();
}
if(_3888>=totCols){
_3888=totCols-1;
}
for(var _388c=_3885;_388c<=_3885+(_3887-_3885);_388c++){
for(var _388d=_3886;_388d<=_3886+(_3888-_3886);_388d++){
cellObj=getCell(_388c,_388d);
if(cellObj!=null&&cellObj!="null"){
setCellFormat(cellObj,_388a,_3889);
}
if(ISFREEZED){
if(FREEZED_ROW>0){
cellObj=getCell(_388c,_388d,sheetPane2Id);
if(cellObj!=null&&cellObj!="null"){
setCellFormat(cellObj,_388a,_3889);
}
}
if(FREEZED_COL>0){
cellObj=getCell(_388c,_388d,sheetPane3Id);
if(cellObj!=null&&cellObj!="null"){
setCellFormat(cellObj,_388a,_3889);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
cellObj=getCell(_388c,_388d,sheetPane1Id);
if(cellObj!=null&&cellObj!="null"){
setCellFormat(cellObj,_388a,_3889);
}
}
}
}
}
}
function handleRangeFormatAction(_388e,_388f){
if(typeof _388f.SR!="undefined"){
var _3890=getViewPortRoundedDetails(_388f.SR,_388f.ER);
if(_3890.isInFreezedRange){
rangeFormatAction(_3890.freezedStartRowIdx,_388f.SC,_3890.freezedEndRowIdx,_388f.EC,_388e,_388f);
}
if(_3890.isInViewPort){
rangeFormatAction(_3890.startRowIdx,_388f.SC,_3890.endRowIdx,_388f.EC,_388e,_388f);
}
}else{
var row=_388f.R;
var _3892=_388f.C;
if(row>totRows-1){
appendBlankRows("ROWS_EXCEEDED",row+1);
btn_enabled();
return;
}
if(_3892>totCols-1){
_3892=totCols-1;
}
cellObj=getCell(row,_3892);
if(cellObj!=null&&cellObj!="null"){
setCellFormat(cellObj,_388f,_388e);
}
if(ISFREEZED){
if(FREEZED_ROW>0){
cellObj=getCell(row,_3892,sheetPane2Id);
if(cellObj!=null&&cellObj!="null"){
setCellFormat(cellObj,_388f,_388e);
}
}
if(FREEZED_COL>0){
cellObj=getCell(row,_3892,sheetPane3Id);
if(cellObj!=null&&cellObj!="null"){
setCellFormat(cellObj,_388f,_388e);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
cellObj=getCell(row,_3892,sheetPane1Id);
if(cellObj!=null&&cellObj!="null"){
setCellFormat(cellObj,_388f,_388e);
}
}
}
}
}
function rangeBorderAction(_3893,_3894,_3895,_3896,_3897,_3898){
if(_3895>=totRows){
var _3899=_3895;
_3895=totRows-1;
appendBlankRows("ROWS_EXCEEDED",_3899+1);
btn_enabled();
}
if(_3896>totCols-1){
_3896=totCols-1;
}
if(_3897==13||_3897==14){
var col=0;
if(_3897==14){
col=_3896;
}else{
if(_3897==13){
if(_3894==0){
return;
}
col=_3894-1;
}
}
for(var _389b=_3893;_389b<=_3893+(_3895-_3893);_389b++){
setBorderByMacro(_389b,col,14,_3898);
}
}else{
if(_3897==16||_3897==17){
var _389b=0;
if(_3897==17){
_389b=_3895;
}else{
if(_3897==16){
if(_3893==0){
return;
}
_389b=_3893-1;
}
}
for(var _389c=_3894;_389c<=_3894+(_3896-_3894);_389c++){
setBorderByMacro(_389b,_389c,17,_3898);
}
}else{
if(_3897==20||_3897==22){
var _389d="";
if(_3897==22){
_389d=17;
}else{
if(_3897==20){
_389d=14;
}
}
for(var _389b=_3893;_389b<=_3893+(_3895-_3893);_389b++){
for(var _389c=_3894;_389c<=_3894+(_3896-_3894);_389c++){
setBorderByMacro(_389b,_389c,_389d,_3898);
}
}
if(_3897==20){
for(var _389b=_3893;_389b<=_3893+(_3895-_3893);_389b++){
if(_3894==0){
return;
}
setBorderByMacro(_389b,_3894-1,14,_3898);
}
}else{
if(_3897==22){
for(var _389c=_3894;_389c<=_3894+(_3896-_3894);_389c++){
if(_3893==0){
return;
}
var _389b=_3893-1;
setBorderByMacro(_3893-1,_389c,17,_3898);
}
}
}
}else{
if(_3897==19){
if(_3894!=0){
var col=_3894-1;
for(var _389b=_3893;_389b<=_3893+(_3895-_3893);_389b++){
setBorderByMacro(_389b,col,14,_3898);
}
}
for(var _389b=_3893;_389b<=_3893+(_3895-_3893);_389b++){
setBorderByMacro(_389b,_3896,14,_3898);
}
if(_3893!=0){
var _389b=_3893-1;
for(var _389c=_3894;_389c<=_3894+(_3896-_3894);_389c++){
setBorderByMacro(_389b,_389c,17,_3898);
}
}
for(var _389c=_3894;_389c<=_3894+(_3896-_3894);_389c++){
setBorderByMacro(_3895,_389c,17,_3898);
}
}
}
}
}
}
function handleRangeBorderAction(_389e,_389f){
if(typeof _389f.SR!="undefined"){
var _38a0=getViewPortRoundedDetails(_389f.SR,_389f.ER);
if(_38a0.isInFreezedRange){
rangeBorderAction(_38a0.freezedStartRowIdx,_389f.SC,_38a0.freezedEndRowIdx,_389f.EC,_389e,_389f);
}
if(_38a0.isInViewPort){
rangeBorderAction(_38a0.startRowIdx,_389f.SC,_38a0.endRowIdx,_389f.EC,_389e,_389f);
}
}else{
if(typeof _389f.BL!="undefined"){
setBorderByMacro(_389f.R,_389f.C!=0?_389f.C-1:_389f.C,14,_389f.BL);
}
if(typeof _389f.BT!="undefined"){
setBorderByMacro(_389f.R!=0?_389f.R-1:_389f.R,_389f.C,17,_389f.BT);
}
if(typeof _389f.BB!="undefined"){
setBorderByMacro(_389f.R,_389f.C,17,_389f.BB);
}
if(typeof _389f.BR!="undefined"){
setBorderByMacro(_389f.R,_389f.C,14,_389f.BR);
}
}
}
function setBorderByMacro(row,_38a2,side,_38a4){
cellObj=getCell(row,_38a2);
if(cellObj!=null&&cellObj!="null"){
cellObj=getCell(row,_38a2);
setBorderByMacroCode(cellObj,_38a4,side);
}
if(ISFREEZED){
if(FREEZED_ROW>0){
cellObj=getCell(row,_38a2,sheetPane2Id);
if(cellObj!=null&&cellObj!="null"){
setBorderByMacroCode(cellObj,_38a4,side);
}
}
if(FREEZED_COL>0){
cellObj=getCell(row,_38a2,sheetPane3Id);
if(cellObj!=null&&cellObj!="null"){
setBorderByMacroCode(cellObj,_38a4,side);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
cellObj=getCell(row,_38a2,sheetPane1Id);
if(cellObj!=null&&cellObj!="null"){
setBorderByMacroCode(cellObj,_38a4,side);
}
}
}
}
function handleRangeHyperlinkAction(_38a5,_38a6){
var row=_38a6.R;
var _38a8=_38a6.C;
var url=_38a6.URL;
var _38aa=_38a6.TEXT;
if(row>=totRows){
appendBlankRows("ROWS_EXCEEDED",row);
btn_enabled();
return;
}
if(_38a8>=totCols){
btn_enabled();
return;
}
if(_38a5==81){
hyperlink("add",row,_38a8,url,_38aa);
var info=ActiveCellInfo;
var _38ac=info.getStartRow();
var _38ad=info.getStartCol();
if(row==_38ac&&_38a8==_38ad){
exprField.value=getCell(row,_38a8).getAttribute("cV");
}
}else{
if(_38a5==82){
if(!isUndefined(url)){
var _38ae=getCell(row,_38a8).getAttribute("cV");
if(url==""){
hyperlink("remove",row,_38a8,url,_38ae);
}else{
hyperlink("add",row,_38a8,url,_38ae);
var info=ActiveCellInfo;
var _38ac=info.getStartRow();
var _38ad=info.getStartCol();
if(row==_38ac&&_38a8==_38ad){
exprField.value=_38ae;
}
}
}
if(_38aa){
if(!url||url==""){
hyperlink("add",row,_38a8,"",_38aa);
var info=ActiveCellInfo;
var _38ac=info.getStartRow();
var _38ad=info.getStartCol();
if(row==_38ac&&_38a8==_38ad){
exprField.value=_38aa;
}
}else{
hyperlink("remove",row,_38a8,url,_38aa);
}
}
}
}
}
function handleRangeCommentAction(_38af,_38b0){
var row=_38b0.R;
var _38b2=_38b0.C;
if(row>=totRows){
appendBlankRows("ROWS_EXCEEDED",row+1);
btn_enabled();
return;
}
if(_38b2>=totCols){
return;
}
addcomment(_38af==81?"add":"remove",row,_38b2,_38b0.COMMENT);
}
function handleLayoutFormatAction(_38b3,_38b4){
if(_38b3==41){
setWidthThroughJson(_38b4["94"]);
var _38b5=getCellRange();
focusCellRange(_38b5.startRow,_38b5.startCol,_38b5.endRow,_38b5.endCol,undefined,true);
}else{
if(_38b3==10){
setRowsHeightAndModifyDOM(_38b4["94"]);
var _38b5=getCellRange();
focusCellRange(_38b5.startRow,_38b5.startCol,_38b5.endRow,_38b5.endCol,undefined,true);
}
}
}
function getHyperlinkObjectFromURL(_38b6,_38b7,url,text,_38ba){
var str=url;
if(url==null||url=="null"){
return "";
}
if((url.indexOf("http"+"://",0)>-1&&url.length>7)||(url.indexOf("https://",0)>-1&&url.length>8)||(url.indexOf("ftp://",0)>-1&&url.length>6)||(url.indexOf("telnet://",0)>-1&&url.length>9)||(url.indexOf("nntp://",0)>-1&&url.length>7)||(url.indexOf("rlogin://",0)>-1&&url.length>9)||(url.indexOf("gopher://",0)>-1&&url.length>9)||(url.indexOf("url://",0)>-1&&url.length>6)||(url.indexOf("mailto:",0)>-1&&url.length>7)){
str="<a idx='link' href='"+url+"' title='"+url+"'"+ancStyle+">"+text+"</a>";
}else{
if(url.indexOf("www.",0)>-1&&url.length>4){
str="<a idx='link' href='http"+"://"+url+"' title='http"+"://"+url+"'"+ancStyle+">"+text+"</a>";
}
}
return str;
}
function setBorderByMacroCode(_38bc,_38bd,_38be){
var _38bf=_38bd.L;
var _38c0=_38bd["41"];
var _38c1=_38bd["7"];
if(typeof _38bf!="undefined"){
var _38c2=true;
var _38c3="";
var _38c4="";
if(_38bf=="double"){
_38c2=false;
if(_38be==13){
_38c3=" bld";
_38c4="borderLeftStyle";
}else{
if(_38be==14){
_38c3=" brd";
_38c4="borderRightStyle";
}else{
if(_38be==16){
_38c3=" btd";
_38c4="borderTopStyle";
}else{
if(_38be==17){
_38c3=" bbd";
_38c4="borderBottomStyle";
}
}
}
}
}else{
if(_38bf=="continuous"){
_38c2=false;
if(_38be==13){
_38c3=" bl1";
_38c4="borderLeftStyle";
}else{
if(_38be==14){
_38c3=" br1";
_38c4="borderRightStyle";
}else{
if(_38be==16){
_38c3=" bt1";
_38c4="borderTopStyle";
}else{
if(_38be==17){
_38c3=" bb1";
_38c4="borderBottomStyle";
}
}
}
}
}else{
if(_38bf=="none"){
_38c2=true;
if(_38be==13){
_38bc.style["borderLeftStyle"]="";
_38bc.style["borderLeftColor"]="";
removeCSSStyle("borderLeft",_38bc);
}else{
if(_38be==14){
_38bc.style["borderRightStyle"]="";
_38bc.style["borderRightColor"]="";
removeCSSStyle("borderRight",_38bc);
}else{
if(_38be==16){
_38bc.style["borderTopStyle"]="";
_38bc.style["borderTopColor"]="";
removeCSSStyle("borderTop",_38bc);
}else{
if(_38be==17){
_38bc.style["borderBottomStyle"]="";
_38bc.style["borderBottomColor"]="";
removeCSSStyle("borderBottom",_38bc);
}
}
}
}
}
}
}
if(_38c2==false){
_38bc.style[_38c4]="";
if(_38be==13){
removeCSSStyle("borderLeft",_38bc);
}else{
if(_38be==14){
removeCSSStyle("borderRight",_38bc);
}else{
if(_38be==16){
removeCSSStyle("borderTop",_38bc);
}else{
if(_38be==17){
removeCSSStyle("borderBottom",_38bc);
}
}
}
}
setFormatforCell(_38bc,_38c3,_38c2,_38c4);
}
}
if(typeof _38c0!="undefined"){
var _38c3="";
var _38c4="";
if(_38c0=="thin"){
if(_38be==13){
_38c3=" bl1";
_38c4="borderLeftStyle";
}else{
if(_38be==14){
_38c3=" br1";
_38c4="borderRightStyle";
}else{
if(_38be==16){
_38c3=" bt1";
_38c4="borderTopStyle";
}else{
if(_38be==17){
_38c3=" bb1";
_38c4="borderBottomStyle";
}
}
}
}
}else{
if(_38c0=="medium"){
if(_38be==13){
_38c3=" bl2";
_38c4="borderLeftStyle";
}else{
if(_38be==14){
_38c3=" br2";
_38c4="borderRightStyle";
}else{
if(_38be==16){
_38c3=" bt2";
_38c4="borderTopStyle";
}else{
if(_38be==17){
_38c3=" bb2";
_38c4="borderBottomStyle";
}
}
}
}
}else{
if(_38c0=="thick"){
if(_38be==13){
_38c3=" bl3";
_38c4="borderLeftStyle";
}else{
if(_38be==14){
_38c3=" br3";
_38c4="borderRightStyle";
}else{
if(_38be==16){
_38c3=" bt3";
_38c4="borderTopStyle";
}else{
if(_38be==17){
_38c3=" bb3";
_38c4="borderBottomStyle";
}
}
}
}
}
}
}
_38bc.style[_38c4]="";
if(_38be==13){
_38c4="borderLeft";
removeCSSStyle("borderLeft",_38bc);
}else{
if(_38be==14){
_38c4="borderRight";
removeCSSStyle("borderRight",_38bc);
}else{
if(_38be==16){
_38c4="borderTop";
removeCSSStyle("borderTop",_38bc);
}else{
if(_38be==17){
_38c4="borderBottom";
removeCSSStyle("borderBottom",_38bc);
}
}
}
}
setFormatforCell(_38bc,_38c3,false,_38c4);
}
if(typeof _38c1!="undefined"){
var _38c4="";
if(_38be==13){
_38c4="borderLeftColor";
}else{
if(_38be==14){
_38c4="borderRightColor";
}else{
if(_38be==16){
_38c4="borderTopColor";
}else{
if(_38be==17){
_38c4="borderBottomColor";
}
}
}
}
_38bc.style[_38c4]=_38c1;
if(_38c1=="rgb(0, 0, 0)"){
_38bc.style[_38c4]="";
}
}
}
function setCellFormat(_38c5,_38c6,_38c7){
var _38c8=false;
if(_38c5==currCell){
_38c8=true;
}
if(_38c7==38){
var _38c9=_38c6.SV;
var _38ca=true;
if(_38c9==true){
_38ca=false;
setFormatforCell(_38c5," fwb",_38ca,"fontWeight");
}else{
_38ca=true;
removeCSSStyle("fontWeight",_38c5);
}
_38c5.style["fontWeight"]="";
if(_38c8==true){
if(_38c9==true){
if(!$("#bold").is(":checked")){
$("#formatData").zbutton("check","#bold");
}
}else{
$("#formatData").zbutton("uncheck","#bold");
}
}
}else{
if(_38c7==8){
var value=_38c6.SV;
_38c5.style["color"]=value;
if(value=="rgb(0,0,0)"){
_38c5.style["color"]="";
}
if(_38c8==true){
$("#fontcolor").children("span:first").css("border-bottom-color",value);
}
}else{
if(_38c7==7){
var value=_38c6.SV;
_38c5.style["backgroundColor"]=value;
if(value=="rgb(255,255,255)"){
_38c5.style["backgroundColor"]="";
}
if(_38c8==true){
$("#bgcolor").children("span:first").css("border-bottom-color",value);
}
}else{
if(_38c7==1){
var _38c9=_38c6.SV;
var _38ca=true;
if(_38c9==true){
_38ca=false;
setFormatforCell(_38c5," fsi",_38ca,"fontStyle");
}else{
_38ca=true;
removeCSSStyle("fontStyle",_38c5);
}
_38c5.style["fontStyle"]="";
if(_38c8==true){
if(_38c9==true){
if(!$("#italic").is(":checked")){
$("#formatData").zbutton("check","#italic");
}
}else{
$("#formatData").zbutton("uncheck","#italic");
}
}
}else{
if(_38c7==3){
var value=_38c6.SV;
var index=getLocalDDIndex(fontFamilyObj,value);
if(index==-1){
check($("#fontFace"),val);
}
if(_38c8==true){
$("#fontFace").zcombo("selectedIndex",index);
}
_38c5.style["fontFamily"]=value;
}else{
if(_38c7==4){
var value=_38c6.SV;
check($("#fontSize"),val);
removeCSSStyle("fontSize",_38c5);
_38c5.style["fontSize"]=value+"pt";
}else{
if(_38c7==2){
var _38c9=_38c6.SV;
var _38ca=true;
var _38cd=" tdu";
if(_38c9=="double"){
_38ca=false;
_38cd=" tdu";
setFormatforCell(_38c5,_38cd,_38ca,"textDecoration");
}else{
if(_38c9=="single"){
_38ca=false;
_38cd=" tdu";
setFormatforCell(_38c5,_38cd,_38ca,"textDecoration");
}else{
_38ca=true;
removeCSSStyle("textDecoration",_38c5);
}
}
_38c5.style["textDecoration"]="";
if(_38c8==true){
if(_38ca==false){
if(!$("#underline").is(":checked")){
$("#formatData").zbutton("check","#underline");
}
}else{
$("#formatData").zbutton("uncheck","#underline");
}
}
}else{
if(_38c7==77){
var _38c9=_38c6.SV;
var _38ca=true;
if(_38c9==true){
_38ca=false;
setFormatforCell(_38c5," tdst",_38ca,"strikeThrough");
}else{
_38ca=true;
removeCSSStyle("strikeThrough",_38c5);
}
_38c5.style["textDecoration"]="";
}else{
if(_38c7==6){
var _38c9=_38c6["6"];
var _38ca=true;
var _38cd="";
if(_38c9=="general"){
_38c9=getTextAlignment(_38c5);
}
if(_38c9=="left"){
_38ca=false;
_38cd="";
}else{
if(_38c9=="right"){
_38ca=true;
_38cd=" tar";
}else{
if(_38c9=="center"){
_38ca=true;
_38cd=" tac";
}
}
}
_38c5.style["textAlign"]="";
removeCSSStyle("textAlign",_38c5);
if(_38ca==true){
setFormatforCell(_38c5,_38cd,false,"textAlign",getCellInnerHTML(_38c5));
}
}else{
if(_38c7==5){
var _38c9=_38c6.SV;
var _38ca=true;
var _38cd=" vat";
if(_38c9=="middle"){
_38cd=" vam";
}else{
if(_38c9=="bottom"){
_38cd=" vab";
}
}
var _38ce=getCellInnerHTML(_38c5);
_38c5.style["verticalAlign"]="";
removeCSSStyle("verticalAlign",_38c5);
setFormatforCell(_38c5,_38cd,false,"verticalAlign",_38ce);
}else{
if(_38c7==9){
var _38c9=_38c6.SV;
var _38cd="";
if(_38c9==true){
_38cd=" W";
}else{
_38cd=" nW";
}
removeCSSStyle("wrapText",_38c5);
setFormatforCell(_38c5,_38cd,false,"wrapText");
if(_38c8==true){
if(_38c9==true){
if(!$("#wraptext").is(":checked")){
$("#formatData").zbutton("check","#wraptext");
}
}else{
$("#formatData").zbutton("check","#wraptext");
}
}
}else{
if(_38c7==108){
var _38c9=_38c6.SV;
if(_38c9==true){
_38c5.setAttribute("format","PERCENT");
}else{
_38c5.removeAttribute("format");
}
if(_38c8==true){
if(_38c9==true){
if(!$("#PERCENT").is(":checked")){
$("#formatData").zbutton("check","#PERCENT");
}
}else{
$("#formatData").zbutton("check","#PERCENT");
}
}
}else{
if(_38c7==33){
setCellContentAndFormat(_38c5,_38c6,_38c7);
}
}
}
}
}
}
}
}
}
}
}
}
}
}
function setCellContentAndFormat(_38cf,_38d0,_38d1){
setCellFormat(_38cf,_38d0,6);
_38d0.SV=_38d0["5"];
setCellFormat(_38cf,_38d0,5);
_38cf.removeAttribute("fn");
if(_38d0["93"]!=""){
_38cf.setAttribute("fn",_38d0["93"]);
}
if(_38cf==currCell){
exprField.value=_38d0["93"];
}
if(_38d0["94"]==""){
_38cf.removeAttribute("hyper");
setCellContent(_38cf,"");
}else{
var _38d2=_38d0["94"].split(" ");
var buff="";
var _38d4=false;
var _38d5=false;
for(var i=0;i<_38d2.length;i++){
var text=getHyperlinkObjectFromURL(getCellPos(_38cf).col,getCellPos(_38cf).row,_38d2[i],_38d2[i],false);
buff+=text;
if(i+1!=_38d2.length){
buff+=" ";
}
if(text==_38d2[i]){
_38d5=true;
}
if(text!=_38d2[i]){
_38d4=true;
}
}
if(_38d0["94"].charAt(_38d0["94"].length-1)==" "){
buff+=" ";
}
setCellContent(_38cf,_38d0["94"]);
if(_38d5==true&&_38d4==true){
_38cf.setAttribute("hyper","multi");
}else{
if(_38d5==true){
_38cf.setAttribute("hyper","null");
}else{
if(_38d4==true){
_38cf.setAttribute("hyper","full");
}
}
}
setCellContent(_38cf,buff);
}
if(_38d0["94"].indexOf("%")==_38d0["94"].length-1){
_38d0.SV=true;
setCellFormat(_38cf,_38d0,108);
}else{
_38d0.SV=false;
setCellFormat(_38cf,_38d0,108);
}
if(typeof _38d0.AS=="undefined"){
return;
}
_38d0.SV=_38d0["38"];
setCellFormat(_38cf,_38d0,38);
_38d0.SV=_38d0["8"];
setCellFormat(_38cf,_38d0,8);
_38d0.SV=_38d0["7"];
setCellFormat(_38cf,_38d0,7);
_38d0.SV=_38d0["1"];
setCellFormat(_38cf,_38d0,1);
_38d0.SV=_38d0["3"];
setCellFormat(_38cf,_38d0,3);
_38d0.SV=_38d0["4"];
setCellFormat(_38cf,_38d0,4);
_38d0.SV=_38d0["2"];
setCellFormat(_38cf,_38d0,2);
_38d0.SV=_38d0["77"];
setCellFormat(_38cf,_38d0,77);
_38d0.SV=_38d0["9"];
setCellFormat(_38cf,_38d0,9);
if(typeof _38d0.COMMENT!="undefined"){
handleRangeCommentAction("ADD",_38d0);
}else{
handleRangeCommentAction("REMOVE",_38d0);
}
}
function getTextAlignment(_38d8){
var cV=_38d8.getAttribute("cV");
if(cV==null||cV=="null"||cV==""){
return "left";
}
if(cV.indexOf("$")==0||cV.indexOf("%")==cV.length-1||isNaN(cV)==false){
return "right";
}
return "left";
}
function getLocalDDIndex(obj,val){
var len=obj.options.length;
var index=-1;
var _38de=isNaN(val);
for(var i=0;i<len;i++){
if(_38de==true){
if(obj.options[i].value.toLowerCase()==val.toLowerCase()){
index=i;
break;
}
}else{
if(parseInt(obj.options[i].value)==val){
index=i;
break;
}
}
}
return index;
}
function updateSheetAction(_38e0,_38e1){
var _38e2=getObj("sheetobject");
if(_38e2||ISMINDLG){
if(_38e0==104||_38e0==99){
if(ISMINDLG&&!ISMACROEDITOROPEN){
updateSheetOperations(_38e0,_38e1.SN,_38e1.SHEETTOCOPY);
return;
}
var _38e3=document.createElement("TD");
var _38e4=document.createElement("TD");
var tdObj=document.createElement("TD");
var trObj=document.createElement("TR");
trObj.id="tr_"+_38e1.SN;
tdObj.innerHTML="<img src=\"../images/spacer.gif\" class=\"mainBgImg scriptExplrSheet\"/>&nbsp;";
tdObj.innerHTML+="<a href=\"javascript:loadMacro('"+_38e1.SN+"','1')\">"+_38e1.SN+"</a>";
_38e4.innerHTML="<img class='mainBgImg scriptExplrTreeBottomEnd' src='../images/spacer.gif'>";
trObj.appendChild(_38e3);
trObj.appendChild(_38e4);
trObj.appendChild(tdObj);
var _38e7=_38e2.getElementsByTagName("tr")[_38e2.rows.length-custommdlcnt-2];
_38e7.cells[1].getElementsByTagName("IMG")[0].className="mainBgImg scriptExplrTree";
_38e2.getElementsByTagName("TBODY")[0].insertBefore(trObj,_38e2.getElementsByTagName("tr")[_38e2.rows.length-custommdlcnt-1]);
if(_38e0==104){
_38e8={id:_38e1.SN,text:"REM Sheet Module",syntax:"vb"};
module_content.push("REM Sheet Module");
}else{
var _38e9;
if(ISMACROEDITOROPEN){
_38e9=editAreaLoader.getFile("macrotextid",_38e1.SHEETTOCOPY).text;
}else{
var i=getModuleIndex(_38e1.SHEETTOCOPY);
if(i!=null){
_38e9=module_content[i];
}
}
mdlnames.push(_38e1.SN);
module_content.push(_38e9);
_38e8={id:_38e1.SN,text:_38e9,syntax:"vb"};
}
editAreaLoader.openFile("macrotextid",_38e8);
}else{
if(_38e0==100){
if(ISMINDLG&&!ISMACROEDITOROPEN){
updateSheetOperations(_38e0,_38e1.SN);
return;
}
if(ISMACROEDITOROPEN){
editAreaLoader.closeFile("macrotextid",_38e1.SN);
}
if(_38e1.SN==currentMdl.CURRENT){
currentMdl=new Object();
}
var deltr=getObj("tr_"+_38e1.SN);
if(deltr){
if(deltr.cells[1].firstChild.className=="mainBgImg scriptExplrTreeBottomEnd"){
deltr.parentNode.rows[deltr.parentNode.rows.length-custommdlcnt-3].cells[1].firstChild.className="mainBgImg scriptExplrTreeBottomEnd";
}
deltr.parentNode.removeChild(deltr);
var i=0;
var _38ec=mdlnames;
var _38ed=module_content;
mdlnames=new Array();
module_content=new Array();
var j=0;
for(i=0;i<_38ec.length;i++){
if(_38ec[i]!=_38e1.SN){
mdlnames[j]=_38ec[i];
module_content[j]=_38ed[i];
j++;
}
}
}
}else{
if(_38e0==102){
if(ISMINDLG&&!ISMACROEDITOROPEN){
updateSheetOperations(_38e0,_38e1.OLDSHEETNAME,_38e1.NEWSHEETNAME);
return;
}
var rentr=getObj("tr_"+_38e1.OLDSHEETNAME);
if(rentr!=null){
rentr.id="tr_"+_38e1.NEWSHEETNAME;
var tdObj=rentr.cells[rentr.cells.length-1];
tdObj.innerHTML="<img src=\"../images/spacer.gif\" class=\"mainBgImg scriptExplrSheet\"/>&nbsp;";
tdObj.innerHTML+="<a href=\"javascript:loadMacro('"+_38e1.NEWSHEETNAME+"','1')\">"+_38e1.NEWSHEETNAME+"</a>";
}
var i=getModuleIndex(_38e1.OLDSHEETNAME);
if(i!=null){
var _38e8={id:_38e1.NEWSHEETNAME,text:editAreaLoader.getFile("macrotextid",_38e1.OLDSHEETNAME).text,syntax:"vb"};
editAreaLoader.openFile("macrotextid",_38e8);
editAreaLoader.closeFile("macrotextid",_38e1.OLDSHEETNAME);
mdlnames[i]=_38e1.NEWSHEETNAME;
if(_38e1.OLDSHEETNAME==currentMdl.CURRENT){
currentMdl.CURRENT=_38e1.NEWSHEETNAME;
}
}
}
}
}
}
_38e2=getObj("modulsttable");
if(_38e2){
var i=0,id,len=_38e2.rows.length;
if(_38e0==99){
var html,newtr;
var rows=len,td,td1;
for(i=0;i<len;i++){
id=_38e2.rows[i].id;
if(id.indexOf(_38e1.SHEETTOCOPY+".")==0){
newtr=_38e2.insertRow(_38e2.rows.length);
if(rows%2==0){
newtr.className="trEven";
}else{
newtr.className="trOdd";
}
newtr.id=id.replace(_38e1.SHEETTOCOPY+".",_38e1.SN+".");
var x;
for(x=0;x<_38e2.rows[i].cells.length;x++){
td1=document.createElement("TD");
html=replace(_38e2.rows[i].cells[x].innerHTML,_38e1.SHEETTOCOPY+".",_38e1.SN+".");
html=replace(html,"'"+_38e1.SHEETTOCOPY+"'","'"+_38e1.SN+"'");
td1.innerHTML=html;
newtr.appendChild(td1);
}
rows=rows+1;
}
}
}else{
if(_38e0==100){
for(i=0;i<_38e2.rows.length;i++){
id=_38e2.rows[i].id;
if(id.indexOf(_38e1.SN+".")==0){
_38e2.rows[i].parentNode.removeChild(_38e2.rows[i]);
i=i-1;
}
}
}else{
if(_38e0==102){
for(i=0;i<len;i++){
id=_38e2.rows[i].id;
if(id.indexOf(_38e1.OLDSHEETNAME+".")==0){
var x;
for(x=0;x<_38e2.rows[i].cells.length;x++){
html=replace(_38e2.rows[i].cells[x].innerHTML,_38e1.OLDSHEETNAME+".",_38e1.NEWSHEETNAME+".");
html=replace(html,"'"+_38e1.OLDSHEETNAME+"'","'"+_38e1.NEWSHEETNAME+"'");
_38e2.rows[i].cells[x].innerHTML=html;
}
}
}
}
}
}
}
}
function handleSheetAction(_38f8,_38f9){
if(_38f8==104||_38f8==99){
if(isSheetBasedShare){
return;
}
var _38fa=_38f9.SN;
var _38fb=_38f9.POSITION;
var _38fc=document.createElement("TD");
_38fc.setAttribute("sheetname",_38fa);
_38fc.id="sheetdiv-"+_38fa;
_38fc.title=_38fa;
_38fc.innerHTML="<div class='tabItem'><div id='sheetnames_"+_38fb+"'>"+_38fa+"</div></div>";
_38fc.onmousedown=function(event){
return reorderSheet(event,this);
};
_38fc.oncontextmenu=function(event){
return showSheetsContextMenu(event,this);
};
var obj=getObj("sheetdiv-"+CURRSHEETNAME);
var _3900=obj.parentNode;
if(_38fb==parseInt(TOTALSHEETS)+1){
_3900.insertBefore(_38fc,getObj("dummySheetTab"));
}else{
var _3901=getObj("sheetsTab").getElementsByTagName("TD");
_3900.insertBefore(_38fc,_3901[_38fb-1]);
}
toggleSheetsTabNavBar();
TOTALSHEETS=parseInt(TOTALSHEETS)+1;
isSaveButtonEnabled=true;
IS_UNSAVED_SHEET=true;
return {sheetName:_38fa,action:_38f8};
}else{
if(_38f8==100){
var _38fa=_38f9.SN;
var _38fb=_38f9.POSITION;
var obj=getObj("sheetdiv-"+_38fa);
var _3900=obj.parentNode;
_3900.removeChild(obj);
TOTALSHEETS=parseInt(TOTALSHEETS)-1;
toggleSheetsTabNavBar();
removeSheets(name);
isSaveButtonEnabled=true;
if(_38fa!=CURRSHEETNAME){
return {};
}
var _3901=getObj("sheetsTab").getElementsByTagName("TD");
if(_38fb==parseInt(TOTALSHEETS)+1){
return {sheetName:_3901[0].getAttribute("title"),action:_38f8};
}else{
return {sheetName:_3901[_38fb-1].getAttribute("title"),action:_38f8};
}
}else{
if(_38f8==102){
var _3902=_38f9.OLDSHEETNAME;
var _3903=_38f9.NEWSHEETNAME;
var obj=getObj("sheetdiv-"+_3902);
var _3900=obj.parentNode;
if(_3902==CURRSHEETNAME){
obj.innerHTML="<div class='tabItem selected'><div>"+_3903+"</div></div>";
CURRSHEETNAME=_3903;
}else{
obj.innerHTML="<div class='tabItem'><div>"+_3903+"</div></div>";
}
obj.setAttribute("sheetname",_3903);
obj.id="sheetdiv-"+_3903;
obj.title=_3903;
toggleSheetsTabNavBar();
isSaveButtonEnabled=true;
renameSheets(_3902,_3903);
return {sheetName:_3903,action:_38f8};
}else{
if(_38f8==101){
var _38fa=_38f9.SN;
var _38fb=_38f9.POSITION;
var obj=getObj("sheetdiv-"+_38fa);
var _3900=obj.parentNode;
_3900.removeChild(obj);
if(_38fb==parseInt(TOTALSHEETS)+1){
_3900.insertBefore(obj,getObj("dummySheetTab"));
}else{
var _3901=getObj("sheetsTab").getElementsByTagName("TD");
_3900.insertBefore(obj,_3901[_38fb-1]);
}
toggleSheetsTabNavBar();
isSaveButtonEnabled=true;
if(_38fa!=CURRSHEETNAME){
return {};
}
return {sheetName:_38fa,action:_38f8};
}else{
if(_38f8==98){
var _38fa=_38f9.SN;
return {sheetName:_38fa,action:_38f8};
}
}
}
}
}
}
function handleError(_3904,_3905,_3906){
if(_3904.ISERROR==false&&msgboxArray.length==0){
disableError();
disableMessage();
return;
}
if(_3904.ISERROR==false){
disableError();
}
if(msgboxArray.length==0){
disableMessage();
}
if(typeof _3905=="undefined"){
_3905=false;
}
var msg="";
if(msgboxArray.length!=0){
clearMessage();
msg="[";
for(x in msgboxArray){
if(typeof msgboxArray[x].M!="undefined"){
if(_3905==true){
msg+="{\"M\":\""+encodeURIComponent(escapeSpecialCharacters(msgboxArray[x].M))+"\",";
msg+="\"L\":\""+msgboxArray[x].L+"\",";
msg+="\"MT\":\""+msgboxArray[x].MT+"\",";
msg+="\"MN\":\""+msgboxArray[x].MN+"\"},";
}else{
insertMessage(msgboxArray[x]);
}
}
}
msg+="]";
}
if(_3905==true){
var url="";
if(_3904.ISERROR==true){
url="error="+encodeURIComponent(_3904.MESSAGE)+"&modulename="+_3904.MODULENAME+"&lineno="+_3904.LINE+"&modtype="+_3904.MODULETYPE;
}
if(msg!=""||url!=""){
var _3909=new getXmlhttp();
_3909.open("POST",ctxpath+"pages/macroerror.jsp",true);
_3909.onreadystatechange=function(){
if(_3909.readyState==4){
var title=jsTitleMsg.Error;
if(!_3904.ISERROR){
title=jsTitleMsg.MessageBox;
}
showDialog(_3909.responseText,"position=absmiddle, width=450, title="+title,positionDialog);
}
};
_3909.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
url=url+"&isSheetBasedShare="+isSheetBasedShare;
if(msg!=""){
url+="&msg="+encodeURIComponent(msg);
}
_3909.send(url);
}
}else{
if(msgboxArray.length!=0){
enableMessage();
}
if(typeof _3906=="undefined"){
_3906=false;
}
if(_3904.ISERROR==true){
insertError(_3904);
if(typeof _3904.MODULENAME!="undefined"&&_3904.MODULENAME!="unknown"){
loadMacro(_3904.MODULENAME,_3904.MODULETYPE,""+_3904.LINE);
}
enableError();
if(!_3906||MacroPanelState.tabs!=""){
showMacroError();
}
}else{
if(msgboxArray.length!=0){
if(!_3906||MacroPanelState.tabs!=""){
showMessage();
}
}
}
}
}
function updateOtherSheetMacroChanges(_390b){
var _390c=othersheetChanges[_390b];
if(typeof _390c=="undefined"){
return;
}
for(var x in _390c){
for(var y in _390c[x]){
if(_390c[x][y].A){
updateMacroChangesInHtmlClient(_390c[x][y]);
}
}
}
focusSelectedRange();
var _390f=getObj("sheetdiv-"+_390b);
if(_390f!=null){
_390f.removeAttribute("macrochange");
}
delete othersheetChanges[_390b];
}
function refreshNonVisibleCellChanges(){
if(DOCUMENT_ID=="doc_id"||getObj("VIEW").value=="PUBLIC_VIEW"){
sheetopen("open");
refreshSheet=false;
return;
}
var _3910=new getXmlhttp();
_3910.open("POST",ctxpath+"save.do",true);
var _3911=$("#fileName").text();
_3911=encodeURIComponent(_3911);
var ftype=getObj("fileExt").value;
var _3913=encodeURIComponent(CURRSHEETNAME);
var nvp="fname="+_3911+"&ftype="+ftype+"&doc_id="+DOCUMENT_ID+"&add=no"+"&param="+"&activesheet="+_3913+"&curtime="+CURRENTTIME+"&newVersion=false"+"&versionLabel="+"&reName=no"+"&docowner="+CURR_DOC_OWNERNAME;
if(ISCOLLAB=="true"){
nvp+="&iscollab="+ISCOLLAB+"&collabid="+COLLAB_ID+"&currentuser="+CURRENTUSER;
}
_3910.onreadystatechange=function(){
if(_3910.readyState==4){
isSaveButtonEnabled=false;
btn_disabled();
macroBtn_disabled();
sheetopen("open",getObj("CURRENT_DOC_OWNER_ID").value);
refreshSheet=false;
}
};
_3910.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var _3915=false;
if(COLLAB_ID!=""){
_3915=true;
}
var _3916=(zoid==-1&&isDocumentPublic)?!isDocumentSemiPublic:isDocumentPublic;
nvp+="&is_public="+_3916+"&doc_url="+DOCUMENT_NAME_URL+"&is_shared="+_3915;
sendXMLHTTPRequest(_3910,nvp,true);
}
var showAferBlind="";
var recordedMacroLineNo="";
var dottedEleId="";
var isMacroRecordPanelOpened=false;
var CURRENTLYRECORDEDMACRO;
function recordMacro(_3917,_3918,_3919){
var _391a=new getXmlhttp();
_391a.open("POST",ctxpath+"recordmacro.do",true);
_391a.onreadystatechange=function(){
if(_391a.readyState==4){
var _391b=_391a.responseText.trim();
if(_391b=="new"){
closeDialog();
RECORDINGMACRO=true;
menutabswidgets.initmacroswidgets("disable");
CURRENTLYRECORDEDMACRO=_3917;
var _391c=getObj("macroRecordedPanel");
_391c.style.opacity="1";
_391c.style.display="none";
_391c.style.filter="alpha(opacity=100)";
var _391d=getObj("macroRecordingPanel");
_391d.style.opacity="1";
_391d.style.display="";
if($("#stoprecordmacro").is("hidden")){
$("#macroBuildPort").zbutton("show","#stoprecordmacro");
}else{
$("#macroBuildPort").zbutton("hide","#stoprecordmacro");
}
_391d.style.filter="alpha(opacity=100)";
if(dottedEleId==""||getObj(dottedEleId)==null){
dottedEleId=addDottedProgress(getObj("recordmsg"));
}
showDottedProgress(dottedEleId);
blindDown("macroPanel",resetPageDim);
isMacroRecordPanelOpened=true;
}else{
showAlertDialog(jsTitleMsg.MacroNameAlreadyExists);
getObj("macroname").select();
}
}
};
var range=getCellRange();
var url="action=start&column="+currCol+"&row="+currRow+"&startrow="+range.startRow+"&startcol="+range.startCol+"&endrow="+range.endRow+"&endcol="+range.endCol+"&macroName="+_3917+"&docid="+DOCUMENT_ID+"&currenttime="+CURRENTTIME+"&currentSheetName="+encodeURIComponent(CURRSHEETNAME)+"&description="+encodeURIComponent(_3918)+"&loginname="+LOGINNAME+"&use_rel_ref="+_3919+"&"+csrfParamName+"="+csrfToken;
_391a.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_391a.send(url);
}
function showRecordingMacro(){
resetPageDim();
}
function showRecordedMsg(){
fadeOut("macroRecordingPanel",50);
fadeIn("macroRecordedPanel",50);
}
function stopRecording(_3920,param){
(isCellEdited()||isFormulaCell())&&submitCell();
if(typeof _3920=="undefined"){
_3920="stop";
}
if(_3920=="cancel"){
var x=showConfirmDialog(jsTitleMsg.RecordMacroConfirmCancel);
if(x==false){
return;
}
}else{
if(_3920=="stop"){
stopDottedProgress(dottedEleId);
menutabswidgets.initmacroswidgets("enable");
if(Button.isMacroToBeAssigned&&CURRENTLYRECORDEDMACRO!=null&&RECORDINGMACRO){
Button.isMacroToBeAssigned=false;
Button(Button.detailsToBeAssigned).sendAssignedMacro("Macros."+CURRENTLYRECORDEDMACRO);
Button.detailsToBeAssigned=null;
}
}
}
var _3923=new getXmlhttp();
_3923.open("POST",ctxpath+"recordmacro.do",true);
_3923.onreadystatechange=function(){
if(_3923.readyState==4){
if(_3920=="save"){
savefile(param);
}else{
if(_3920=="cancel"){
if(!$("#stoprecordmacro").is("hidden")){
$("#macroBuildPort").zbutton("hide","#stoprecordmacro");
}
hideMacroRecordPanel();
}else{
if(_3920=="stop"){
if(!$("#stoprecordmacro").is("hidden")){
$("#macroBuildPort").zbutton("hide","#stoprecordmacro");
}
setTimeout(showRecordedMsg,1000);
var _3924=getObj("stopButtons");
var _3925=_3923.responseText.trim();
if(!isNaN(_3925)){
recordedMacroLineNo=_3925;
}else{
recordedMacroLineNo="1";
}
_3924.style.display="";
if(ISMINDLG){
ISMACRODOCCHANGE=true;
}
MACROSAVED=false;
}
}
}
}
};
_3923.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_3923.send("action="+_3920+"&docid="+DOCUMENT_ID+"&currenttime="+CURRENTTIME+"&docowner="+CURR_DOC_OWNERNAME+"&collabid="+COLLAB_ID+"&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING+"&afterRTC=false"+"&"+csrfParamName+"="+csrfToken);
RECORDINGMACRO=false;
if(_3920!="save"){
return false;
}
}
function showRecordedMacro(){
if(!isNaN(recordedMacroLineNo)){
showMacroEditorDialog("Macros",recordedMacroLineNo,5);
}else{
showMacroEditorDialog("Macros","1",5);
}
recordedMacroLineNo="";
}
function showManageMacros(mode){
if(mode=="create"||mode=="record"){
if(DOCUMENT_ID=="doc_id"){
if(mode=="create"){
saveForward="showCreateMacro";
}else{
saveForward="showRecordMacro";
}
return savefilessamp();
}
}
if(!MACRO_DOC_SAVED){
tempSaveMacro("show",mode);
}else{
var _3927=getObj("macroPanel");
if(_3927){
if(_3927.style.display!="none"){
hideMacroRecordPanel("showManageMacros('"+mode+"')");
return;
}
}
var title="";
if(mode=="run"){
title=jsTitleMsg.RunMacro;
}else{
if(mode=="show"){
title=jsTitleMsg.Macros;
}else{
if(mode=="create"||mode=="record"){
title=jsTitleMsg.CreateMacro;
}
}
}
var _3929="mode="+mode+"&docowner="+CURR_DOC_OWNERNAME+"&currentSelection="+getCurrentSelection()+"&afterRTC=false&viewType="+getObj("VIEW").value+"&docid="+DOCUMENT_ID+"&currentSheetName="+encodeURIComponent(CURRSHEETNAME)+"&bridgeNo="+bridgeNumber+"&currenttime="+CURRENTTIME+"&docname="+encodeURIComponent(DOCUMENT_NAME);
if(DOCUMENT_VERSION){
_3929+="&versionId="+DOCUMENT_VERSION;
}
showURLInDialog(ctxpath+"pages/managemacros.jsp?"+_3929,((mode=="run")?"closeButton=no, modal=no":"width=450, position=absmiddle, title="+title+", modal=yes"),((mode=="create"||mode=="record")?focusModuleName:resizeMacrosList),"",enableSaveButton);
}
}
function insertMacro(_392a,_392b,_392c,_392d){
if(typeof _392a=="undefined"){
_392a=false;
}
var _392e;
var _392f="";
if(!_392a){
var _3930=getObj("macroname");
_392e=(_3930.value).trim();
if(_392e.length==0){
showAlertDialog(jsTitleMsg.MacroNameCannotBeEmpty);
_3930.focus();
return false;
}
var _3931=checkMacroName(_392e);
if(_3931>0){
if(_3931==1){
showAlertDialog(jsTitleMsg.MacroNameCannotContainMsg);
}else{
if(_3931==2){
showAlertDialog(jsTitleMsg.MacroNameStartWithMsg);
}else{
showAlertDialog(jsTitleMsg.MacroNameInEnglish);
}
}
_3930.select();
return false;
}
_392f=(getObj("description").value).trim();
}else{
_392e=_392b;
}
if(_392a==false){
var _3932=false;
if(document.forms["CreateMacroForm"].use_rel_ref.checked){
_3932=true;
}
if(document.forms["CreateMacroForm"].inserttype.value=="record"){
recordMacro(_392e,_392f,_3932);
return false;
}
}
var _3933=new getXmlhttp();
_3933.open("POST",ctxpath+"macro.do",true);
_3933.onreadystatechange=function(){
if(_3933.readyState==4){
var _3934=_3933.responseText;
if(_3934.indexOf("Failed")<0){
var _3935=eval("("+_3934+")");
if(_392a==false){
if(!(_3935.ISMACRO=="OLD")){
if(Button.isMacroToBeAssigned){
Button.isMacroToBeAssigned=false;
Button(Button.detailsToBeAssigned).sendAssignedMacro("Macros."+_392e);
Button.detailsToBeAssigned=null;
}
}
if(_3935.ISMACRO=="OLD"){
showAlertDialog(jsTitleMsg.MacroNameAlreadyExists);
_3930.select();
return false;
}else{
if(ISMINDLG&&!ISMACROEDITOROPEN){
var i=getModuleIndex("Macros");
if(i!=null){
module_content[i]+="\nSub "+_392e+"()\n \nEnd Sub\n";
}
}
}
showMacroEditorDialog("Macros",_3935.LINENO,5);
isSaveButtonEnabled=true;
}else{
if(_3935.ISMACRO=="NEW"){
tabObj=getObj("modulsttable");
if(tabObj){
var td1=document.createElement("TD");
td1.innerHTML="<a title=\"Macros."+_392e+"\" href=\"javascript:showMacroEditorDialog('Macros','"+_3935.LINENO+"','5')\">"+_392e+"</a> ";
td1.width="60%";
var td2=document.createElement("TD");
td2.innerHTML="<a href=\"javascript:runmacro('Macros','"+_392e+"');\" class=\"trActionLink\">"+jsMsg.Run+"</a><span style=\"padding: 0px 5px;\" class=\"linkSep\">|</span>";
td2.innerHTML+=" <a href=\"javascript:showMacroEditorDialog('Macros','"+_3935.LINENO+"','5')\" class=\"trActionLink\">"+jsMsg.Edit+"</a><span style=\"padding: 0px 5px;\" class=\"linkSep\">|</span>";
td2.innerHTML+=" <a class='trActionLink' href=\"javascript:deleteMacro('Macros','"+_392e+"')\">jsMsg.Delete</a>";
td2.width="40%";
var rows=tabObj.rows.length;
if(rows==1){
var _393a=getObj("nomacrotr");
if(_393a!=null){
_393a.style.display="none";
}
}
var trObj=tabObj.insertRow(tabObj.rows.length);
trObj.appendChild(td1);
trObj.appendChild(td2);
trObj.className=(rows%2==0)?"trEven":"trOdd";
trObj.id="Macros."+_392e;
}
}
}
}
}
};
_3933.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var url=getMacroUrl()+"&afterRTC="+_392a+"&action=insert&macroname="+_392e;
if(_392f!=""){
url=url+"&description="+encodeURIComponent(_392f);
}
_3933.send(url);
if(_392a){
if(ISMACROEDITOROPEN){
var eA=window.frames["frame_macrotextid"].editArea;
editAreaLoader.getFile("macrotextid","Macros").text=_392c;
eA.files["Macros"]["compare_edited_text"]=_392c;
if("Macros"==editAreaLoader.getCurrentFile("macrotextid").id){
eA.textarea.value=_392c;
if(!ISMINDLG){
var y=showConfirmDialog(replaceParams(jsTitleMsg.UserHasBeenInsertedNewMacro,new Array(_392d,_392b))+"\n"+jsTitleMsg.DoYouWantToReloadIt);
if(y){
var range=editAreaLoader.getSelectionRange("macrotextid");
eA.textarea.focus();
eA.display_file(editAreaLoader.getCurrentFile("macrotextid").id);
editAreaLoader.setSelectionRange("macrotextid",range.start,range.end);
}
}
}
}
if(ISMINDLG){
var i=getModuleIndex("Macros");
module_content[i]=_392c;
}
}
return false;
}
function resizeMacrosList(){
if(getObj("modulsttable").offsetHeight<70){
getObj("macrosListWithActions").style.height="75px";
}
positionDialog();
}
function focusModuleName(){
getObj("macroname").focus();
positionDialog();
}
function showCreateMacroTab(){
var ele=getObj("CreateMacroTab");
$("#createmacChld").width($("#createmacCnt").width());
if(ele.className!="selected"){
ele.className="selected";
getObj("ShowMacroTab").className="";
$("#createMacroContent").show();
getObj("macrosListContent").style.display="none";
}
if(jsVERSION_VIEW||jsPUBLIC_VIEW||jsGUEST_VIEW){
getObj("information").style.display="";
}else{
focusModuleName();
}
}
function showMacrosListTab(){
var ele=getObj("ShowMacroTab");
if(ele.className!="selected"){
getObj("CreateMacroTab").className="";
ele.className="selected";
$("#createMacroContent").hide();
getObj("macrosListContent").style.display="";
if(jsVERSION_VIEW||jsPUBLIC_VIEW||jsGUEST_VIEW){
getObj("information").style.display="none";
}
resizeMacrosList();
}
}
function showRecordBtn(){
var btn=getObj("RecordButton");
if(btn.style.display=="none"){
btn.style.display="";
getObj("CreateButton").style.display="none";
getObj("use_rel_ref_tr").style.display="";
}
document.forms["CreateMacroForm"].inserttype.value="record";
}
function showWriteBtn(){
var btn=getObj("CreateButton");
if(btn.style.display=="none"){
btn.style.display="";
getObj("RecordButton").style.display="none";
getObj("use_rel_ref_tr").style.display="none";
}
document.forms["CreateMacroForm"].inserttype.value="create";
}
function blindupcallback(){
resetPageDim();
if(showAferBlind!=""){
setTimeout(evalfunction,10);
}
if(!$("#recordmacro").is(":enabled")){
$("#macroBuildPort").zbutton("show","#stoprecordmacro");
}
}
function evalfunction(){
eval(showAferBlind);
showAferBlind="";
}
function hideMacroRecordPanel(func){
if(typeof func!="undefined"){
showAferBlind=func;
}else{
showAferBlind="";
}
blindUp("macroPanel",blindupcallback);
isMacroRecordPanelOpened=false;
}
function showMacros(){
params="&docid="+DOCUMENT_ID+"&docOwner="+CURR_DOC_OWNERNAME+"&bridgeNo="+bridgeNumber+"&viewType="+getViewType()+"&currentSheetName="+encodeURIComponent(CURRSHEETNAME)+"&currentSelection="+getCurrentSelection();
showURLInDialog(ctxpath+"pages/runmacros.jsp?currenttime="+CURRENTTIME+params,"closeOnEscKey=yes,title="+jsTitleMsg.RunMacroListTitle+",width=250, modal=no,top=-100",checkFunctionList);
}
function checkFunctionList(){
if(typeof noofmacros!="undefined"&&noofmacros==false){
closeDialog();
showAlertDialog(jsTitleMsg.NoMacrosFound);
}else{
var ele1=getObj("macrolisttable");
if(ele1.offsetHeight>150){
getObj("MacroList1").style.height=300+"px";
}
positionDialog();
}
}
function updateMacros(_3947){
var ele=getObj("MacroList1");
var _3949=ele.getElementsByTagName("table")[0];
while(_3949.rows.length>=1){
_3949.deleteRow(0);
}
for(var x in _3947.MACROTABLE){
if(typeof _3947.MACROTABLE[x].MODULENAME!="undefined"){
var tr=_3949.insertRow(_3949.rows.length);
var td1=document.createElement("TD");
td1.className="macroListView";
td1.innerHTML="<a href=\"javascript:runmacro('"+_3947.MACROTABLE[x].MODULENAME+"','"+_3947.MACROTABLE[x].MACRONAME+"');\" style='width:100%;' title='"+replaceParams(jsTitleMsg.RunMacroName,new Array(_3947.MACROTABLE[x].MACRONAME))+"'>"+_3947.MACROTABLE[x].MACRONAME+"</a>";
tr.appendChild(td1);
}
}
}
function getAttribute(elm,aname){
try{
var _394f=elm.getAttribute(aname);
}
catch(exept){
}
if(!_394f){
for(var i=0;i<elm.attributes.length;i++){
var _3951=elm.attributes[i].name.toLowerCase();
if(_3951==aname){
_394f=elm.attributes[i].value;
return _394f;
}
}
}
return _394f;
}
function setAttribute(elm,attr,val){
if(attr=="class"){
elm.setAttribute("className",val);
elm.setAttribute("class",val);
}else{
elm.setAttribute(attr,val);
}
}
function getChildren(elem,_3956,_3957,_3958,_3959,depth){
if(!_3959){
var _3959="single";
}
if(!depth){
var depth=-1;
}
if(elem){
var _395b=elem.childNodes;
var _395c=null;
var _395d=new Array();
for(var x=0;x<_395b.length;x++){
strTagName=new String(_395b[x].tagName);
children_class="?";
if(strTagName!="undefined"){
child_attribute=getAttribute(_395b[x],_3957);
if((strTagName.toLowerCase()==_3956.toLowerCase()||_3956=="")&&(_3957==""||child_attribute==_3958)){
if(_3959=="all"){
_395d.push(_395b[x]);
}else{
return _395b[x];
}
}
if(depth!=0){
_395c=getChildren(_395b[x],_3956,_3957,_3958,_3959,depth-1);
if(_3959=="all"){
if(_395c.length>0){
_395d=_395d.concat(_395c);
}
}else{
if(_395c!=null){
return _395c;
}
}
}
}
}
if(_3959=="all"){
return _395d;
}
}
return null;
}
function isChildOf(elem,_3960){
if(elem){
if(elem==_3960){
return true;
}
while(elem.parentNode!="undefined"){
return isChildOf(elem.parentNode,_3960);
}
}
return false;
}
function getMouseX(e){
if(e!=null&&typeof (e.pageX)!="undefined"){
return e.pageX;
}else{
return (e!=null?e.x:event.x)+document.documentElement.scrollLeft;
}
}
function getMouseY(e){
if(e!=null&&typeof (e.pageY)!="undefined"){
return e.pageY;
}else{
return (e!=null?e.y:event.y)+document.documentElement.scrollTop;
}
}
function calculeOffsetLeft(r){
return calculeOffset(r,"offsetLeft");
}
function calculeOffsetTop(r){
return calculeOffset(r,"offsetTop");
}
function calculeOffset(_3965,attr){
var _3967=0;
while(_3965){
_3967+=_3965[attr];
_3965=_3965.offsetParent;
}
return _3967;
}
function get_css_property(elem,prop){
if(document.defaultView){
return document.defaultView.getComputedStyle(elem,null).getPropertyValue(prop);
}else{
if(elem.currentStyle){
var prop=prop.replace(/-\D/gi,function(_396a){
return _396a.charAt(_396a.length-1).toUpperCase();
});
return elem.currentStyle[prop];
}else{
return null;
}
}
}
var move_current_element;
function start_move_element(e,id,frame){
var _396e=(e.target||e.srcElement).id;
if(id){
_396e=id;
}
if(!frame){
frame=window;
}
if(frame.event){
e=frame.event;
}
move_current_element=frame.document.getElementById(_396e);
move_current_element.frame=frame;
frame.document.onmousemove=move_element;
frame.document.onmouseup=end_move_element;
mouse_x=getMouseX(e);
mouse_y=getMouseY(e);
move_current_element.start_pos_x=mouse_x-(move_current_element.style.left.replace("px","")||calculeOffsetLeft(move_current_element));
move_current_element.start_pos_y=mouse_y-(move_current_element.style.top.replace("px","")||calculeOffsetTop(move_current_element));
return false;
}
function end_move_element(e){
move_current_element.frame.document.onmousemove="";
move_current_element.frame.document.onmouseup="";
move_current_element=null;
}
function move_element(e){
if(move_current_element.frame&&move_current_element.frame.event){
e=move_current_element.frame.event;
}
var _3971=getMouseX(e);
var _3972=getMouseY(e);
var _3973=_3972-move_current_element.start_pos_y;
var _3974=_3971-move_current_element.start_pos_x;
var _3975=move_current_element.frame.document.body.offsetWidth-move_current_element.offsetWidth;
max_top=move_current_element.frame.document.body.offsetHeight-move_current_element.offsetHeight;
_3973=Math.min(Math.max(0,_3973),max_top);
_3974=Math.min(Math.max(0,_3974),_3975);
move_current_element.style.top=_3973+"px";
move_current_element.style.left=_3974+"px";
return false;
}
var nav=editAreaLoader.nav;
function getSelectionRange(_3976){
return {"start":_3976.selectionStart,"end":_3976.selectionEnd};
}
function setSelectionRangeElement(_3977,start,end){
_3977.focus();
start=Math.max(0,Math.min(_3977.value.length,start));
end=Math.max(start,Math.min(_3977.value.length,end));
if(nav["isOpera"]){
_3977.selectionEnd=1;
_3977.selectionStart=0;
_3977.selectionEnd=1;
_3977.selectionStart=0;
}
_3977.selectionStart=start;
_3977.selectionEnd=end;
if(nav["isIE"]){
set_IE_selection(_3977);
}
}
function get_IE_selection(_397a){
if(_397a&&_397a.focused){
if(!_397a.ea_line_height){
var div=document.createElement("div");
div.style.fontFamily=get_css_property(_397a,"font-family");
div.style.fontSize=get_css_property(_397a,"font-size");
div.style.visibility="hidden";
div.innerHTML="0";
document.body.appendChild(div);
_397a.ea_line_height=div.offsetHeight;
document.body.removeChild(div);
}
var range=document.selection.createRange();
var _397d=range.duplicate();
try{
_397d.moveToElementText(_397a);
}
catch(e){
}
_397d.setEndPoint("EndToEnd",range);
if(_397d.parentElement()==_397a){
var elem=_397a;
var _397f=0;
while(elem.parentNode){
_397f+=elem.scrollTop;
elem=elem.parentNode;
}
var _3980=range.offsetTop-calculeOffsetTop(_397a)+_397f;
var _3981=Math.round((_3980/_397a.ea_line_height)+1);
var _3982=Math.round(range.boundingHeight/_397a.ea_line_height);
var _3983=_397d.text.length-range.text.length;
var tab=_397a.value.substr(0,_3983).split("\n");
_3983+=(_3981-tab.length)*2;
_397a.selectionStart=_3983;
var _3985=_397a.selectionStart+range.text.length;
tab=_397a.value.substr(0,_3983+range.text.length).split("\n");
_3985+=(_3981+_3982-1-tab.length)*2;
_397a.selectionEnd=_3985;
}
}
if(_397a){
setTimeout("get_IE_selection(document.getElementById('"+_397a.id+"'));",50);
}
}
function IE_textarea_focus(){
event.srcElement.focused=true;
}
function IE_textarea_blur(){
event.srcElement.focused=false;
}
function set_IE_selection(_3986){
var _3987=_3986.value.substr(0,_3986.selectionStart).split("\n").length-1;
var _3988=_3986.value.substr(0,_3986.selectionEnd).split("\n").length-1;
var range=document.selection.createRange();
range.moveToElementText(_3986);
range.setEndPoint("EndToStart",range);
range.moveStart("character",_3986.selectionStart-_3987);
range.moveEnd("character",_3986.selectionEnd-_3988-(_3986.selectionStart-_3987));
range.select();
}
editAreaLoader.waiting_loading["elements_functions.js"]="loaded";
EditAreaLoader.prototype.start_resize_area=function(){
document.onmouseup=editAreaLoader.end_resize_area;
document.onmousemove=editAreaLoader.resize_area;
editAreaLoader.toggle(editAreaLoader.resize["id"]);
var _398a=editAreas[editAreaLoader.resize["id"]]["textarea"];
var div=document.getElementById("edit_area_resize");
if(!div){
div=document.createElement("div");
div.id="edit_area_resize";
div.style.border="dashed #888888 1px";
}
var width=_398a.offsetWidth-2;
var _398d=_398a.offsetHeight-2;
div.style.display="block";
div.style.width=width+"px";
div.style.height=_398d+"px";
var _398e=_398a.parentNode;
_398e.insertBefore(div,_398a);
_398a.style.display="none";
editAreaLoader.resize["start_top"]=calculeOffsetTop(div);
editAreaLoader.resize["start_left"]=calculeOffsetLeft(div);
};
EditAreaLoader.prototype.end_resize_area=function(e){
document.onmouseup="";
document.onmousemove="";
var div=document.getElementById("edit_area_resize");
var _3991=editAreas[editAreaLoader.resize["id"]]["textarea"];
var width=Math.max(editAreas[editAreaLoader.resize["id"]]["settings"]["min_width"],div.offsetWidth-4);
var _3993=Math.max(editAreas[editAreaLoader.resize["id"]]["settings"]["min_height"],div.offsetHeight-4);
if(editAreaLoader.nav["isIE"]==6){
width+=2;
_3993+=2;
}
_3991.style.width=width+"px";
_3991.style.height=_3993+"px";
div.style.display="none";
_3991.style.display="inline";
_3991.selectionStart=editAreaLoader.resize["selectionStart"];
_3991.selectionEnd=editAreaLoader.resize["selectionEnd"];
editAreaLoader.toggle(editAreaLoader.resize["id"]);
return false;
};
EditAreaLoader.prototype.resize_area=function(e){
var allow=editAreas[editAreaLoader.resize["id"]]["settings"]["allow_resize"];
if(allow=="both"||allow=="y"){
new_y=getMouseY(e);
var _3996=Math.max(20,new_y-editAreaLoader.resize["start_top"]);
document.getElementById("edit_area_resize").style.height=_3996+"px";
}
if(allow=="both"||allow=="x"){
new_x=getMouseX(e);
var _3997=Math.max(20,new_x-editAreaLoader.resize["start_left"]);
document.getElementById("edit_area_resize").style.width=_3997+"px";
}
return false;
};
editAreaLoader.waiting_loading["resize_area.js"]="loaded";
EditAreaLoader.prototype.get_regexp=function(_3998){
res="(\\b)(";
for(i=0;i<_3998.length;i++){
if(i>0){
res+="|";
}
res+=this.get_escaped_regexp(_3998[i]);
}
res+=")(\\b)";
reg=new RegExp(res);
return res;
};
EditAreaLoader.prototype.get_el_regexp=function(_3999){
res="(\\b)(";
for(i=0;i<_3999.length;i++){
if(i>0){
res+="|";
}
var temp=_3999[i].split(" ");
for(j=0;j<temp.length;j++){
if(j>0){
res+="( )+";
}
res+=temp[j];
}
}
res+=")(\\b)";
reg=new RegExp(res);
return res;
};
EditAreaLoader.prototype.get_escaped_regexp=function(str){
return str.replace(/(\.|\?|\*|\+|\\|\(|\)|\[|\]|\}|\{|\$|\^|\|)/g,"\\$1");
};
EditAreaLoader.prototype.init_syntax_regexp=function(){
var _399c=new Object();
for(var lang in this.load_syntax){
if(!this.syntax[lang]){
this.syntax[lang]=new Object();
this.syntax[lang]["keywords_reg_exp"]=new Object();
this.keywords_reg_exp_nb=0;
if(this.load_syntax[lang]["KEYWORDS"]){
param="g";
if(this.load_syntax[lang]["KEYWORD_CASE_SENSITIVE"]===false){
param+="i";
}
for(var i in this.load_syntax[lang]["KEYWORDS"]){
if(typeof (this.load_syntax[lang]["KEYWORDS"][i])=="function"){
continue;
}
if(i=="endline"){
this.syntax[lang]["keywords_reg_exp"][i]=new RegExp(this.get_el_regexp(this.load_syntax[lang]["KEYWORDS"][i]),param);
}else{
this.syntax[lang]["keywords_reg_exp"][i]=new RegExp(this.get_regexp(this.load_syntax[lang]["KEYWORDS"][i]),param);
}
this.keywords_reg_exp_nb++;
}
}
if(this.load_syntax[lang]["OPERATORS"]){
var str="";
var nb=0;
for(var i in this.load_syntax[lang]["OPERATORS"]){
if(typeof (this.load_syntax[lang]["OPERATORS"][i])=="function"){
continue;
}
if(nb>0){
str+="|";
}
str+=this.get_escaped_regexp(this.load_syntax[lang]["OPERATORS"][i]);
nb++;
}
if(str.length>0){
this.syntax[lang]["operators_reg_exp"]=new RegExp("("+str+")","g");
}
}
if(this.load_syntax[lang]["DELIMITERS"]){
var str="";
var nb=0;
for(var i in this.load_syntax[lang]["DELIMITERS"]){
if(typeof (this.load_syntax[lang]["DELIMITERS"][i])=="function"){
continue;
}
if(nb>0){
str+="|";
}
str+=this.get_escaped_regexp(this.load_syntax[lang]["DELIMITERS"][i]);
nb++;
}
if(str.length>0){
this.syntax[lang]["delimiters_reg_exp"]=new RegExp("("+str+")","g");
}
}
var _39a1=new Array();
this.syntax[lang]["quotes"]=new Object();
var _39a2=new Array();
if(this.load_syntax[lang]["QUOTEMARKS"]){
for(var i in this.load_syntax[lang]["QUOTEMARKS"]){
if(typeof (this.load_syntax[lang]["QUOTEMARKS"][i])=="function"){
continue;
}
var x=this.get_escaped_regexp(this.load_syntax[lang]["QUOTEMARKS"][i]);
this.syntax[lang]["quotes"][x]=x;
_39a2[_39a2.length]="("+x+"(?:[^"+x+"\\\\]*(\\\\\\\\)*(\\\\"+x+"?)?)*("+x+"|$))";
_39a1.push(x);
}
}
this.syntax[lang]["macrocomments"]=new Object();
if(this.load_syntax[lang]["COMMENT_SINGLE"]){
for(var i in this.load_syntax[lang]["COMMENT_SINGLE"]){
if(typeof (this.load_syntax[lang]["COMMENT_SINGLE"][i])=="function"){
continue;
}
var x=this.get_escaped_regexp(this.load_syntax[lang]["COMMENT_SINGLE"][i]);
_39a2[_39a2.length]="("+x+"(.|\\r|\\t)*(\\n|$))";
_39a1.push(x);
this.syntax[lang]["macrocomments"][x]="\n";
}
}
if(this.load_syntax[lang]["COMMENT_MULTI"]){
for(var i in this.load_syntax[lang]["COMMENT_MULTI"]){
if(typeof (this.load_syntax[lang]["COMMENT_MULTI"][i])=="function"){
continue;
}
var start=this.get_escaped_regexp(i);
var end=this.get_escaped_regexp(this.load_syntax[lang]["COMMENT_MULTI"][i]);
_39a2[_39a2.length]="("+start+"(.|\\n|\\r)*?("+end+"|$))";
_39a1.push(start);
_39a1.push(end);
this.syntax[lang]["macrocomments"][i]=this.load_syntax[lang]["COMMENT_MULTI"][i];
}
}
if(_39a2.length>0){
this.syntax[lang]["comment_or_quote_reg_exp"]=new RegExp("("+_39a2.join("|")+")","gi");
}
if(_39a1.length>0){
this.syntax[lang]["syntax_trace_regexp"]=new RegExp("((.|\n)*?)(\\\\*("+_39a1.join("|")+"|$))","gmi");
}
if(this.load_syntax[lang]["SCRIPT_DELIMITERS"]){
this.syntax[lang]["script_delimiters"]=new Object();
for(var i in this.load_syntax[lang]["SCRIPT_DELIMITERS"]){
if(typeof (this.load_syntax[lang]["SCRIPT_DELIMITERS"][i])=="function"){
continue;
}
this.syntax[lang]["script_delimiters"][i]=this.load_syntax[lang]["SCRIPT_DELIMITERS"];
}
}
this.syntax[lang]["custom_regexp"]=new Object();
if(this.load_syntax[lang]["REGEXPS"]){
for(var i in this.load_syntax[lang]["REGEXPS"]){
if(typeof (this.load_syntax[lang]["REGEXPS"][i])=="function"){
continue;
}
var val=this.load_syntax[lang]["REGEXPS"][i];
if(!this.syntax[lang]["custom_regexp"][val["execute"]]){
this.syntax[lang]["custom_regexp"][val["execute"]]=new Object();
}
this.syntax[lang]["custom_regexp"][val["execute"]][i]={"regexp":new RegExp(val["search"],val["modifiers"]),"class":val["class"]};
}
}
if(this.load_syntax[lang]["STYLES"]){
_399c[lang]=new Object();
for(var i in this.load_syntax[lang]["STYLES"]){
if(typeof (this.load_syntax[lang]["STYLES"][i])=="function"){
continue;
}
if(typeof (this.load_syntax[lang]["STYLES"][i])!="string"){
for(var j in this.load_syntax[lang]["STYLES"][i]){
_399c[lang][j]=this.load_syntax[lang]["STYLES"][i][j];
}
}else{
_399c[lang][i]=this.load_syntax[lang]["STYLES"][i];
}
}
}
var style="";
for(var i in _399c[lang]){
if(_399c[lang][i].length>0){
style+="."+lang+" ."+i.toLowerCase()+" span{"+_399c[lang][i]+"}\n";
style+="."+lang+" ."+i.toLowerCase()+"{"+_399c[lang][i]+"}\n";
}
}
this.syntax[lang]["styles"]=style;
}
}
};
editAreaLoader.waiting_loading["reg_syntax.js"]="loaded";
var dontCancelPivotDesign=false;
function dbIntegOverrides(){
initializeMainView(window,"ZDBDataSheetView","","themesDirectory");
ZDBDataGrid.prototype.baseSetModified=ZDBDataGrid.prototype.setModified;
ZDBDataGrid.setDocumentEvents=ZDBDataGrid.setDocumentEventsInteg;
ZDBDataGrid.prototype.setModified=function(){
this.baseSetModified();
btn_enabled();
};
ZDBDataGrid.prototype.baseSaved=ZDBDataGrid.prototype.saved;
ZDBDataGrid.prototype.saved=function(){
this.baseSaved();
autosave();
};
ZDBDataGrid.prototype.showSavedMsg=ZDButil.dummyFunc;
ZDBClientUI.resizeAllDInst=function(){
ZDBClientUI.resizePlaceHolder();
if(ZDBClientUI.selectedTab){
ZDBClientUI.selectedTab.resize();
}
};
ZDBClientUI.resizePlaceHolder=function(){
var _39a9=this.placeHolder;
if((this.selectedTab!=null)&&(this.selectedTab.view.type!="Table")){
_39a9=this.selectedTab.view.workArea;
}
if(_39a9==null){
_39a9=this.placeHolder;
}
if(!ZDBglobal.designInPopUp){
if(_39a9.parentNode){
var width=_39a9.parentNode.offsetWidth;
if((width==null)||(width<1)){
return;
}
_39a9.style.width=width+"px";
_39a9.style.height=_39a9.parentNode.offsetHeight+"px";
}
_39a9.style.display="block";
}
ZDBglobal.placeHolderWidth=_39a9.offsetWidth;
ZDBglobal.placeHolderHeight=_39a9.offsetHeight;
};
ZDBClientUI.getNameForNewView=function(view,_39ac){
var dd=new Date();
view.newName=dd.getTime();
view.newDesc="";
return true;
};
ZDBMsgBox.showSuccess=function(msg){
};
ZDBglobal.designInPopUp=false;
ZDBglobal.integrated=true;
ZDBglobal.tipZIndex=110;
ZDBglobal.hideMoveHint=true;
ZDBAnalysisView.origHandleSave=ZDBAnalysisView.handleSave;
ZDBAnalysisView.handleSave=function(_39af,_39b0){
var div=$("ZDBDesignDiv");
div.style.display="none";
try{
dontCancelPivotDesign=true;
closeDialog();
}
finally{
dontCancelPivotDesign=false;
}
document.body.appendChild(div);
ZDBAnalysisView.origHandleSave(_39af,_39b0);
ZDBAnalysisView.addOnlyChartArea();
ZDBAnalysisView.refreshView();
pivotsrcSheet="";
};
ZDBAnalysisView.editDesign=function(){
getObj("eP").style.display="none";
setSheetDivDefaultHeight();
dollarToggle(true);
ZDBglobal.designInPopUp=true;
var div=$("ZDBDesignDiv");
ZDButil.removeAllChildren(div);
ZDBClientUI.layoutMode="max";
var view=ZDBClientUI.selectedTab.view;
view.descripPanel.parentNode.style.display="";
view.dropAreaPanel.style.display="";
var _39b4=view.workArea;
if((_39b4.parNode!=null)&&(_39b4.parNode!=_39b4.parentNode)){
_39b4.parNode.appendChild(_39b4);
}
_39b4.style.display="none";
var _39b5=view.attachedSwipeArea;
_39b5.style.display="none";
_39b5.appendChild(view.fieldsListEl);
div.appendChild(view.analysisArea);
div.style.display="block";
var _39b6=findDocDim();
var _39b7=_39b6.width-100;
if(browser_ie){
var _39b8=_39b6.height/2;
}else{
var _39b8=_39b6.height-100;
}
var _39b9="";
if(view.objId>-1){
_39b9="Edit Pivot Design - "+getObj("pivotTitle").innerHTML;
}else{
_39b9="Design Pivot - "+getObj("pivotTitle").innerHTML;
}
showDialog(div,"position=absolute,left="+50+",top="+35+",title="+_39b9+",width="+_39b7+",height="+_39b8+",modal=yes",initPivotDesign,cancelEditPivot);
};
ZDBAnalysisView.addOnlyChartArea=function(view){
ZDBglobal.designInPopUp=false;
getObj("pivotReportHeader").style.display="";
getObj("pivotReportIndent").style.display="";
getObj("eP").style.display="none";
getObj("tabularDataWarning").style.display="none";
var _39bb=getObj("sheetdiv");
ZDButil.removeAllChildren(_39bb);
_39bb.style.display="";
if(view==null){
view=ZDBClientUI.selectedTab.view;
}
var _39bc=view.workArea;
if(_39bc.parNode==null){
_39bc.parNode=_39bc.parentNode;
}
_39bb.appendChild(_39bc);
pivotSheet=true;
isSSActive=false;
if(view.type=="Pivot"){
getObj("gR1C3Extension").style.display="";
getObj("gR3C1Extension").style.display="";
getObj("ZDBPivotNavigConInteg").style.display="";
}else{
getObj("gR1C3Extension").style.display="none";
getObj("gR3C1Extension").style.display="none";
getObj("ZDBPivotNavigConInteg").style.display="none";
if(jsPUBLIC_VIEW||jsGUEST_VIEW||jsTRASH_VIEW){
getObj("pivotTableToolbar").style.display="none";
}
}
resetWorkSheetDim();
if(browser_ie){
iconMouseOut(getObj("comments"));
}
message("","none");
autosave();
};
ZDBClientUI.addOnlyPlaceHolder=function(){
ZDBglobal.designInPopUp=false;
getObj("pivotReportHeader").style.display="none";
getObj("pivotReportIndent").style.display="none";
getObj("eP").style.display="none";
getObj("pivotTableToolbar").style.display="none";
if(hidepivotWarningBanner=="show"){
getObj("tabularDataWarning").style.display="";
}
var _39bd=getObj("sheetdiv");
ZDButil.removeAllChildren(_39bd);
_39bd.style.display="";
message("","none");
_39bd.appendChild(ZDBClientUI.placeHolder);
pivotSheet=true;
isSSActive=false;
resetWorkSheetDim();
autosave();
try{
getObj("dateButton").style.visibility="hidden";
}
catch(e){
}
};
ZDBAnalysisView.prototype.setChartDimensions=function(){
this.chartArea.style.height=this.workArea.style.height;
var _39be=new Object();
if(this.isSizeChanged(_39be)){
this.updateDimVars();
}
};
ZDBAnalysisView.prototype.resizeView=function(){
if(this.gridObj!=null){
this.gridObj.resizeGrid(parseInt(this.workArea.style.width),parseInt(this.chartArea.style.height));
}else{
var _39bf=new Object();
if(this.isSizeChanged(_39bf)){
this.refreshView();
this.oldWidth=_39bf.width;
this.oldHeight=_39bf.height;
}
}
};
ZDBAnalysisView.prototype.isSizeChanged=function(_39c0){
_39c0.width=this.workArea.style.width;
_39c0.height=this.chartArea.style.height;
return ((_39c0.width!=this.oldWidth)||(_39c0.height!=this.oldHeight));
};
window.ZDBToolTip=new function(){
this.init=function(){
};
this.hideTip=this.init;
this.showTip=this.init;
};
if(typeof AjaxAPI!="undefined"){
AjaxAPI.showRespMsg=function(_39c1,_39c2){
if(_39c1.opStatus==StatusMsgAPI.OPSTATUS.FAILED){
var _39c3=_39c1.getResponsePart("STATUS_MESSAGE");
var _39c4=_39c1.getOnlyHtml();
if(_39c4.indexOf("PARSEERROR")!=-1){
return;
}
if(_39c3==null){
message("","none");
var _39c5={autoOpen:false,minHeight:0,modal:true,resizable:false,title:jsTitleMsg.ErrorOccurred};
ErrorDialog.showdialog(_39c4,_39c5);
}
}
if(_39c1.responseText){
_39c1.invokeScripts();
}
};
}
ZDBComboBox.baseShowOptionList=ZDBComboBox.showOptionList;
DNDEvents.baseShowMoveToDropArea=DNDEvents.showMoveToDropArea;
ZDBDialogUtil.baseSetElementIndex=ZDBDialogUtil.setElementIndex;
ZDBComboBox.showOptionList=function(el){
this.baseShowOptionList(el);
ZDBComboBox.optionList.style.zIndex=100120;
};
DNDEvents.showMoveToDropArea=function(el){
this.baseShowMoveToDropArea(el);
el.style.zIndex=101000;
};
ZDBDialogUtil.setElementIndex=function(dlg){
this.baseSetElementIndex(dlg);
var _39c9=100;
try{
_39c9=parseInt(dlg.style.zIndex);
}
catch(e){
}
dlg.style.zIndex=100000+_39c9;
};
}
DOC_PANEL={docPanel:"",docPanelTab:"",docPanelFrame:"",docPanelsInfo:[{panelId:"comments",action:"showSheetComments()"},{panelId:"chat",action:"showChatPanel()"}],docPanelDim:[],init:function(){
this.docPanel=$("#docPanel");
var _39ca=getObj("docPanel");
this.docPanelFrame=$("#docPanelFrame");
this.docPanelDim.width=parseInt(getCurrentStyle(_39ca,"width"))+parseInt(getCurrentStyle(_39ca,"paddingLeft"))+parseInt(getCurrentStyle(_39ca,"paddingRight"));
this.docPanelDim.height=parseInt(getCurrentStyle(_39ca,"height"))+parseInt(getCurrentStyle(_39ca,"paddingTop"))+parseInt(getCurrentStyle(_39ca,"paddingBottom"));
},showDocPanel:function(_39cb,_39cc){
if(!_39cc){
var panel=this.getDocPanelByPanelId(_39cb);
_39cc=panel.action;
}
if(!this.isDocPanelClosed()&&_39cb==this.currDocPanelId){
this.closeDocPanel();
return;
}
if(this.isDocPanelClosed()){
resetHScrollDim("DOCPANEL_OPEN");
this.docPanel.css("display","");
this.setDocPanelDim();
resetWorkSheetDim();
resetSheetsTabDim();
}
if(_39cb=="chat"){
this.currDocPanelId="chat";
panelOpenedFor="chat";
$("#docPanelFrame").attr("scrolling","no");
$("#docpanel_refresh").css("display","none");
if(SHAREDUSERSLIST.length>0){
$("#userStatusDiv").removeClass("chatBlink");
$("#userStatusDiv").addClass("userOnline");
}
}else{
this.currDocPanelId="comments";
panelOpenedFor="comments";
$("#docPanelFrame").attr("scrolling","auto");
$("#docpanel_refresh").css("display","");
}
eval(_39cc);
},closeDocPanel:function(){
if(!this.isDocPanelClosed()){
resetHScrollDim("DOCPANEL_CLOSE");
this.docPanel.css("display","none");
resetWorkSheetDim();
resetSheetsTabDim();
}
},getDocPanelByPanelId:function(_39ce){
for(var i=0;i<this.docPanelsInfo.length;i++){
if(this.docPanelsInfo[i].panelId==_39ce){
return this.docPanelsInfo[i];
break;
}
}
},isDocPanelClosed:function(){
return ((this.docPanel==null||this.docPanel.css("display")=="none")?true:false);
},setDocPanelDim:function(){
var _39d0=findClientDim();
var _39d1=_39d0.width;
var _39d2=_39d0.height;
if(this.docPanelFrame!=null){
this.docPanelFrame.css("height","1px");
var _39d3=$("#docPanel").height()-$("#docPanel td")[1].offsetHeight-(parseInt($("#docPanel").css("padding-top"))/2);
if(_39d3<0){
_39d3=0;
}
this.docPanelFrame.css("height",_39d3+"px");
}
},resetDocPanelDim:function(){
this.setDocPanelDim();
},refreshDocPanel:function(){
$("#docPanelFrame").attr("src",$("#docPanelFrame").attr("src"));
}};
var statusToolsInfo=[{toolId:"comments",action:"DOC_PANEL.showDocPanel('comments')"},{toolId:"chat",action:"DOC_PANEL.showDocPanel('chat')"}];
var currStatusTool="";
function setWmsBarData(){
WebMessanger.disableWMSStatus();
$("#wmsstatusbar").css("min-width","40%");
$("#wmsstatusbar").css("padding","0");
var html=$("#statusBarContainer").html();
$("#statusBarContainer").html("");
WebMessanger.setServiceStatus(html);
initBottomBand();
}
function registerStatusBarTools(){
for(var i=0;i<statusToolsInfo.length;i++){
var tool=getObj(statusToolsInfo[i].toolId);
if(tool){
tool.onclick=function(){
for(var i=0;i<statusToolsInfo.length;i++){
if(statusToolsInfo[i].toolId==this.id){
eval(statusToolsInfo[i].action);
break;
}
}
};
}
}
}
function statusToolMouseOver(tool){
var _39d9=getIconBaseClass(tool);
if(tool.className==_39d9+" opened"){
return;
}
tool.className=_39d9+" hover";
}
function statusToolMouseOut(tool){
var _39db=getIconBaseClass(tool);
if(tool.className==_39db+" opened"){
return;
}
tool.className=_39db;
}
function statusToolMouseDown(tool){
var _39dd=getIconBaseClass(tool);
if(tool.className==_39dd+" opened"){
return;
}
tool.className=_39dd+" mouseDown";
}
function statusToolClick(tool){
if(tool){
var _39df=getIconBaseClass(tool);
if(currStatusTool!=""){
currStatusTool.className=_39df;
}
if(currStatusTool==tool){
tool.className=_39df;
currStatusTool="";
}else{
tool.className=_39df+" opened";
currStatusTool=tool;
}
}
}
function getStatusText(){
return getObj("status").innerHTML;
}
function setStatusText(_39e0){
getObj("status").innerHTML=(_39e0.trim().length==0)?"&nbsp;":_39e0;
}
Button=function(){
if(typeof arguments[0]=="undefined"||Button[arguments[0]]==null){
return Button.init(arguments[0]);
}else{
if(Button[arguments[0]]!=null){
return Button[arguments[0]];
}
}
};
Button.dateObj;
Button.tempLeft;
Button.tempWidth;
Button.isMacroToBeAssigned=false;
Button.detailsToBeAssigned;
Button.tempEl;
Button.menuData;
Button.diffX=20;
Button.emptySpaceCount;
Button.prevObjId;
Button.isOnInitialEdit;
Button.isInitialSizeChangedOnEdit;
Button.isExecuting;
Button.elementInEditMode;
Button.menuData="<menu id='OLEButtonContextMenu' forElement='OLESelectLayer'><item onclick='Button.editLabel(ole.getCurrObj().id, false);return false;'><![CDATA["+jsMsg["Button.EditLabel"]+"]]></item> <sep></sep><item onclick='ole.currObj.clone(1, Button.header.xOffsetOnClone, Button.header.yOffsetOnClone);return false;'><![CDATA["+jsMsg.Clone+"]]></item><item onclick='ole.remove(ole.currObj.id,true);ole.conf.onblur();return false;'><![CDATA["+jsMsg.Delete+"]]></item></menu>";
Button.init=function(id,_39e2){
Button[id]=new _Button(id,_39e2,arguments[2]);
Button[id].setText(_39e2.LABEL);
getObj(id).objType="button";
ole.init(id).bringToFront();
ole(id).sCol=findColInXPos(ole(id).left);
ole(id).sRow=findRowInYPos(ole(id).top);
ole(id).sColDiff=ole(id).left-getColLeft(ole(id).sCol);
ole(id).sRowDiff=ole(id).top-getRowTop(ole(id).sRow);
Button.setPermission();
};
Button.getURL=function(){
var _39e3="&DOCID="+DOCUMENT_ID;
_39e3+="&CURRENT_TIME="+CURRENTTIME;
_39e3+="&bridgeNo="+bridgeNumber;
_39e3+="&docowner="+CURR_DOC_OWNERNAME;
_39e3+="&viewType="+getViewType();
_39e3+="&docname="+encodeURIComponent(DOCUMENT_NAME);
_39e3+="&collabid="+COLLAB_ID;
_39e3+="&collabEditing="+COLLABORATIVE_EDITING;
_39e3+="&readwrite="+ALLOW_TO_WRITE;
_39e3+="&"+csrfParamName+"="+csrfToken;
return _39e3;
};
Button.assignMacroId=null;
Button.duplicateid=null;
Button.elementBelowCursor=null;
Button.tempCursor=null;
Button.onCtrlKeyDown=function(ev){
var el=getObj(Button.elementBelowCursor);
if(el!=undefined&&el!=null&&!Button[el.id].isInEditMode){
var _39e6=ole.getObjectPermissions(el.id,["isDraggable","isResizable"]);
if(ole(el.id).isEnabled&&(_39e6.isDraggable||_39e6.isResizable)){
el.className+=" feButtonCtrlKeyDown";
}
}
};
Button.onCtrlKeyUp=function(ev){
var el=getObj(Button.elementBelowCursor);
if(el!=undefined&&el!=null&&!Button[el.id].isInEditMode){
el.className="feButton";
}
};
Button.onBeforeDrag=function(id){
if(!isUndefined(Button.tempEl)){
Button.tempEl.className="feButton";
Button.tempEl=undefined;
}
};
Button.onObjectSwitch=function(id){
ole(id).hideContextMenu();
Button.closeActionBarMenus(id);
};
Button.onBeforeLoadActionBar=function(id){
Button[id].switchState(Button[id].isMacroAssigned);
};
Button.onFocusLayerMouseDown=function(){
if(Button.elementInEditMode!=null&&!isUndefined(Button.elementInEditMode)){
ole(Button.elementInEditMode.id).resetActionBarState();
Button.elementInEditMode.switchModes(false);
}
};
Button.ondoubleclick=function(id,ev,_39ee){
var _39ef=getObj("feButtonWidthCalculator");
_39ef.innerHTML=Button[id].textElement.value;
ole(id).setWidth(_39ef.offsetWidth+20).setSelectLayer();
Button.resize(id,ole(id).width,ole(id).height);
};
Button.onClick=function(ev,el){
var _39f2=false,ev,_39f3;
if(!Button[el.id].isInEditMode){
if(typeof Button[el.id]!="undefined"&&Button[el.id]!=null){
if(window.event){
_39f2=window.event.ctrlKey;
}else{
_39f2=(ev.ctrlKey||(ev.modifiers==2)||(ev.modifiers==3)||(ev.modifiers>5));
}
var _39f4=false;
if(!isReadOnlyViewMode&&typeof Button[el.id].moduleName!="undefined"&&Button[el.id].moduleName!=""&&Button[el.id].moduleName!="null"&&OLE[el.id].isEnabled&&!jsTRASH_VIEW&&!isErrorDoc){
runmacro(Button[el.id].moduleName,Button[el.id].macroName,Button[el.id].id,undefined,undefined,undefined,undefined,undefined,true);
_39f4=true;
}
var _39f5=ole.getObjectPermissions(el.id,["isDraggable","isResizable"]);
if(!_39f4&&!(_39f5.isDraggable||_39f5.isResizable)){
el.className="feButton";
}
}
}else{
if(Button[el.id].isInEditMode){
if(browser_ie){
ev=window.event;
mouseEventVal=ev.button;
_39f3=ev.srcElement;
}else{
if(browser_nn6){
mouseEventVal=ev.which;
_39f3=ev.target;
}
}
if(!(_39f3.tagName=="INPUT")){
Button[el.id].switchModes(true);
}
}
}
stopEvt(ev);
};
Button.onMouseDown=function(ev,el){
var _39f8,ev,_39f9;
if(window.event){
_39f8=window.event.ctrlKey;
}else{
_39f8=(ev.ctrlKey||(ev.modifiers==2)||(ev.modifiers==3)||(ev.modifiers>5));
}
var _39fa;
if(browser_ie){
ev=window.event;
_39fa=ev.button;
_39f9=ev.srcElement;
}else{
if(browser_nn6){
_39fa=ev.which;
_39f9=ev.target;
}
}
var _39fb=ev.metaKey;
if(!ole(el.id).isExposed){
if(_39f8||_39fb){
ole(el.id).setSelectLayer().positionActionBar(true);
Button.tempEl=el;
ole.startDrag(ev,true);
el.className="feButton";
stopEvt(ev);
}
if(!_39f8&&(_39fa==1)){
var _39fc=ole.getObjectPermissions(el.id,["isDraggable","isResizable"]);
if(Button[el.id].isMacroAssigned||!(_39fc.isDraggable||_39fc.isResizable)){
el.className="feButtonMouseDown";
}
}
}
};
Button.removeVisuals=function(id){
if(!OLE[id]){
return;
}
if(!ole(id).isEnabled){
ole(id).el.getElementsByTagName("span")[0].style.display="none";
ole(id).el.getElementsByTagName("span")[1].style.opacity=1;
if(browser_ie){
ole(id).el.getElementsByTagName("span")[1].style.filter="alpha(opacity="+100+")";
}
ole(id).setWidth(ole(id).width-16).enable().el.style.cursor="";
ole(id).el.className="feButton";
Button[id].isExecuting=false;
}
};
Button.visualiseMacroExecution=function(id){
if(ole(id).isEnabled){
ole(id).el.getElementsByTagName("span")[0].style.display="";
if(browser_ie){
ole(id).el.getElementsByTagName("span")[1].style.filter="alpha(opacity="+20+")";
}
ole(id).disable().setWidth(ole(id).width+16).el.style.cursor="default";
Button[id].isExecuting=true;
}
};
Button.onObjMouseOver=function(elId,ev){
Button.elementBelowCursor=elId;
if(Button[elId].isMacroAssigned&&!Button[elId].isInEditMode&&OLE[elId].isEnabled){
ole(elId).el.className="feButton feButtonMouseOver";
}
};
Button.onMouseOut=function(id,ev){
var _3a03=Button[id];
if(_3a03.isMacroAssigned&&!_3a03.isExecuting){
ole(id).el.className="feButton";
}
Button.elementBelowCursor=null;
};
Button.editMacro=function(id){
showMacroEditorDialog(Button(id).moduleName,Button(id).macroName);
ole(id).resetActionBarState();
};
Button.prevKeyCode;
Button.sendInfoToServer=function(_3a05,_3a06){
var _3a07=arguments[2];
var _3a08=new getXmlhttp();
_3a08.open("POST",ctxpath+"button.do",true);
_3a08.onreadystatechange=function(){
if(_3a08.readyState==4){
btn_enabled();
var _3a09=eval("("+_3a08.responseText+")");
if(_3a09.LABEL){
_3a09.LABEL=decodeURIComponent(replace(_3a09.LABEL,"+"," "));
}
if(_3a09.SHEETNAME){
_3a09.SHEETNAME=decodeURIComponent(replace(_3a09.SHEETNAME,"+"," "));
}
if(typeof _3a09.BRIDGENO!="undefined"){
bridgeNumber=_3a09.BRIDGENO;
}
if(typeof _3a06!="undefined"){
var id=_3a09.ID;
switch(_3a06){
case "AssignMacro":
if(_3a09.AFTERRTC=="false"){
Button(id).assignMacro(_3a09);
ole(id).deSelect();
Button(id).setContextMenu();
}
break;
case "insert":
if(_3a09.AFTERRTC=="false"){
Button.init(id,_3a09);
Button.editLabel(id,true);
}
break;
case "delete":
if(_3a09.AFTERRTC=="false"){
if(typeof Button[id]!="undefined"&&Button[id]!=null){
Button[id]=null;
}
}
break;
case "clone":
if(_3a09.AFTERRTC=="false"){
ole(_3a09.dummyId).synchronizeClones(_3a07,_3a09.dummyId,id);
}
break;
}
}
}
};
_3a08.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_3a08.send(_3a05+Button.getURL());
};
Button.handleSelectedObjects=function(id){
if(ole.currObj==OLE[id]){
ole(id).setSelectLayer().positionActionBar(true);
}
if(ole.currFocusObj==OLE[id]){
}
};
Button.handleCollaboration=function(obj,_3a0d){
var id=obj["ID"];
if(obj["LABEL"]){
obj["LABEL"]=decodeURIComponent(replace(obj["LABEL"],"+"," "));
}
if(obj["SHEETNAME"]){
obj["SHEETNAME"]=decodeURIComponent(replace(obj["SHEETNAME"],"+"," "));
}
switch(_3a0d){
case "add":
if(obj["SHEETNAME"]==CURRSHEETNAME){
Button.init(obj["ID"],obj);
Button[obj["ID"]].switchModes(false);
Button.handleSelectedObjects(id);
}
var nvp="ACTION=add&WIDTH="+obj["WIDTH"]+"&HEIGHT="+obj["HEIGHT"]+"&LEFT="+obj["LEFT"]+"&TOP="+obj["TOP"];
nvp+="&dummyId=dummy1&afterRTC=true&SHEETNAME="+encodeURIComponent(obj["SHEETNAME"]);
Button.sendInfoToServer(nvp,"insert");
break;
case "AssignMacro":
if(obj["SHEETNAME"]==CURRSHEETNAME){
Button(id).assignMacro(obj).setContextMenu();
}
Button.sendAssignedMacro(id,obj["MODULENAME"]+"."+obj["MACRONAME"],true,obj["SHEETNAME"]);
break;
case "SetCaption":
if(obj["SHEETNAME"]==CURRSHEETNAME){
Button(id).setText(obj.LABEL);
ole(id).setLeft(obj.LEFT).setWidth(obj.WIDTH);
Button.handleSelectedObjects(id);
}
var nvp="ACTION=SetCaption";
nvp+="&CAPTION="+encodeURIComponent(obj.LABEL)+"&NAME="+id+"&WIDTH="+obj.WIDTH+"&LEFT="+obj.LEFT+"&afterRTC="+true+"&SHEETNAME="+encodeURIComponent(obj["SHEETNAME"]);
Button.sendInfoToServer(nvp);
break;
case "move":
if(obj["SHEETNAME"]==CURRSHEETNAME){
ole(id).moveTo(obj["LEFT"],obj["TOP"]);
Button.handleSelectedObjects(id);
}
Button.move(id,obj["LEFT"],obj["TOP"],true,obj["SHEETNAME"]);
break;
case "resize":
if(obj["SHEETNAME"]==CURRSHEETNAME){
ole(id).resizeTo(obj["WIDTH"],obj["HEIGHT"]);
Button.handleSelectedObjects(id);
}
Button.resize(id,obj["WIDTH"],obj["HEIGHT"],true,obj["SHEETNAME"]);
break;
case "delete":
if(obj["SHEETNAME"]==CURRSHEETNAME){
if(ole.isActive()){
if(id===ole.getCurrObj().id){
ole.conf.onblur();
}
ole.remove(id,false,true);
}else{
ole.remove(id,false,false);
}
}
Button.remove(id,true,obj["SHEETNAME"]);
break;
case "clone":
var nvp="ACTION=clone";
if(obj["SHEETNAME"]==CURRSHEETNAME){
Button.init(obj["ID"],obj,true);
if(obj["ISMACROASSIGNED"]==true){
Button(id).assignMacro(obj);
nvp+="&FUNCTION="+obj["MODULENAME"]+"."+obj["MACRONAME"];
}
Button[obj["ID"]].switchModes(false).setContextMenu();
ole(id).setHeight(obj["HEIGHT"]).setWidth(obj["WIDTH"]).setLeft(obj["LEFT"]).setTop(obj["TOP"]);
Button.handleSelectedObjects(id);
}
nvp+="&NAME="+obj["ID"]+"&CAPTION="+encodeURIComponent(obj["LABEL"])+"&HEIGHT="+obj["HEIGHT"]+"&WIDTH="+obj["WIDTH"]+"&dummyId="+obj["ID"]+"&afterRTC="+true+"&LEFT="+obj["LEFT"]+"&TOP="+obj["TOP"]+"&SHEETNAME="+obj["SHEETNAME"];
Button.sendInfoToServer(nvp,"clone",obj["CLONETYPE"]);
break;
}
};
Button.addButton=function(_3a10,_3a11){
var _3a12=$("#fileName");
if(_3a12!=null&&typeof _3a12!="undefined"){
if(DOCUMENT_ID=="doc_id"){
saveForward="Button.addButton";
return savefilessamp();
}
}
var btnWd=85;
var btnHt=25;
var top=Math.round(((sheet.offsetHeight-btnHt)/2)+getSheetScrollTop());
var left=Math.round(((sheet.offsetWidth-btnWd)/2)+getSheetScrollLeft());
var nvp="ACTION=add";
nvp+="&WIDTH=85&HEIGHT=25";
if(!_3a10){
_3a10=false;
}
if(!_3a11){
_3a11=CURRSHEETNAME;
}
top=((top-50)>0)?top-50:top;
nvp+="&TOP="+top+"&LEFT="+left+"&dummyId=dummy1&afterRTC="+_3a10+"&SHEETNAME="+encodeURIComponent(_3a11);
Button.sendInfoToServer(nvp,"insert");
};
Button.setProps=function(id,_3a19){
var obj=getObj(id);
obj.className="feButton feButtonCtrlKeyDown";
obj.style.display="";
obj.style.position="absolute";
obj.style.height=_3a19.HEIGHT+"px";
obj.style.left=_3a19.LEFT+"px";
obj.style.width=_3a19.WIDTH+"px";
obj.style.top=_3a19.TOP+"px";
};
Button.onSync=function(id,_3a1c,left,top,_3a1f,width){
Button[id]=Button[_3a1c];
Button[id].id=Button[id].el.id=id;
Button[id].Label=getObj(id).getElementsByTagName("TD")[4];
Button[id].editableLabel=getObj(id).getElementsByTagName("TD")[5];
Button[id].textElement=ole(id).el.getElementsByTagName("input")[0];
Button[id].textElement.onkeydown=function(ev){
Button(id).setCaption(ev);
};
Button[id].setContextMenu();
Button[_3a1c]=null;
var _3a22=CURRSHEETNAME;
var nvp="ACTION=synchronize";
nvp+="&CAPTION="+encodeURIComponent(Button[id].caption)+"&NAME="+id+"&WIDTH="+ole(Button[id].id).width+"&LEFT="+ole(Button[id].id).left+"&TOP="+ole(Button[id].id).top+"&HEIGHT="+ole(Button[id].id).height+"&SHEETNAME="+encodeURIComponent(_3a22);
Button.sendInfoToServer(nvp);
};
Button.create=function(_3a24){
var id=_3a24.ID;
Button.init(id,_3a24,true);
Button(id).switchModes(false).checkMacroAssigned(_3a24);
};
Button.remove=function(id,_3a27,_3a28){
Button.closeActionBarMenus(id);
if(!_3a27){
_3a27=false;
}
if(!_3a28){
_3a28=CURRSHEETNAME;
}
var nvp="ACTION=delete&NAME="+id+"&afterRTC="+_3a27+"&SHEETNAME="+encodeURIComponent(_3a28);
Button.sendInfoToServer(nvp,"delete");
};
Button.clone=function(_3a2a,id,left,top,wd,ht,_3a30,_3a31,_3a32){
if(!_3a31){
_3a31=false;
}
if(!_3a32){
_3a32=CURRSHEETNAME;
}
var nvp="ACTION=clone&NAME="+this.id+"&CAPTION="+encodeURIComponent(Button(_3a30).caption)+"&HEIGHT="+ht+"&WIDTH="+wd+"&dummyId="+id+"&afterRTC="+_3a31+"&CLONETYPE="+_3a2a+"&SHEETNAME="+encodeURIComponent(_3a32);
if(_3a2a==3){
if(!Button[_3a30].isMacroAssigned){
getObj(id).className="feButton feButtonCtrlKeyDown";
}else{
getObj(id).className="feButton";
}
}
if(Button(_3a30).isMacroAssigned){
nvp+="&FUNCTION="+Button(_3a30).moduleName+"."+Button(_3a30).macroName;
}
if(_3a2a!=2){
nvp+="&LEFT="+(left)+"&TOP="+(top);
}
Button[id]=new _Button(id);
if(Button(_3a30).isMacroAssigned){
Button[id].isMacroAssigned=true;
Button[id].setMacroName(Button(_3a30).moduleName,Button(_3a30).macroName);
ole(id).setDesignMode(false);
}
Button[id].caption=Button(_3a30).caption;
ole(Button[id].setContextMenu().id).setSelectLayer().positionActionBar();
Button.sendInfoToServer(nvp,"clone",_3a2a);
};
Button.move=function(id,left,top,_3a37,_3a38){
if(!_3a37){
_3a37=false;
}
if(!_3a38){
_3a38=CURRSHEETNAME;
}
if(OLE[id]){
ole(id).sCol=findColInXPos(left);
ole(id).sRow=findRowInYPos(top);
ole(id).sRowDiff=top-getRowTop(ole(id).sRow);
ole(id).sColDiff=left-getColLeft(ole(id).sCol);
}
var nvp="ACTION=move&TOP="+top+"&LEFT="+left+"&NAME="+id;
if(!_3a37){
nvp+="&HEIGHT="+ole(id).height+"&WIDTH="+ole(id).width;
}
nvp+="&afterRTC="+_3a37+"&SHEETNAME="+encodeURIComponent(_3a38);
Button.sendInfoToServer(nvp);
};
Button.resize=function(id,width,_3a3c,_3a3d,_3a3e){
if(!_3a3d){
_3a3d=false;
}
if(!_3a3e){
_3a3e=CURRSHEETNAME;
}
if(OLE[id]){
ole(id).sCol=findColInXPos(ole(id).left);
ole(id).sRow=findRowInYPos(ole(id).top);
ole(id).sRowDiff=ole(id).top-getRowTop(ole(id).sRow);
ole(id).sColDiff=ole(id).left-getColLeft(ole(id).sCol);
}
var nvp="ACTION=resize&WIDTH="+width+"&HEIGHT="+_3a3c+"&afterRTC="+_3a3d+"&SHEETNAME="+encodeURIComponent(_3a3e)+"&NAME="+id;
if(!_3a3d){
nvp+="&LEFT="+ole(id).left+"&TOP="+ole(id).top;
}
Button.sendInfoToServer(nvp);
};
Button.sendAssignedMacro=function(id,macro,_3a42,_3a43){
if(!_3a42){
_3a42=false;
}
if(!_3a43){
_3a43=CURRSHEETNAME;
}
var nvp="ACTION=AssignMacro";
nvp+="&FUNCTION="+macro+"&NAME="+id+"&afterRTC="+_3a42+"&SHEETNAME="+encodeURIComponent(_3a43);
Button.sendInfoToServer(nvp,"AssignMacro");
};
Button.onmousedownOutside=function(id,ev){
Button(id).switchModes(false).setTextInLabel();
ole(id).resetActionBarState();
Button.assignMacroId=id;
Button.prevObjId=id;
};
Button.onSelectLayerMouseDown=function(id,ev){
if(browser_ie){
ev=window.event;
var el=ev.srcElement;
}else{
if(browser_nn6){
var el=ev.target;
}
}
if(el.className=="textCursor"){
Button.editLabel(id,false);
}else{
Button(id).switchModes(false).setTextInLabel();
ole(id).resetActionBarState();
}
};
Button.closeActionBarMenus=function(id){
OLE[id]&&ole(id).hideContextMenu();
if(Menu.assignMacroMenu&&isMenuOpened("assignMacroMenu")){
hideMenu("assignMacroMenu");
}
if(Menu.changeMacroMenu&&isMenuOpened("changeMacroMenu")){
hideMenu("changeMacroMenu");
}
if(Menu.buttonMoreActionsMenu&&isMenuOpened("buttonMoreActionsMenu")){
hideMenu("buttonMoreActionsMenu");
}
};
Button.onBeforeResize=function(id,ht,wd,ev){
Button(id).switchModes(false).setTextInLabel();
ole(id).resetActionBarState();
Button.closeActionBarMenus(id);
return this;
};
Button.getOffsetOnClone=function(el){
var _3a50=(10*el.cloneCountSinceLastDragOrResize);
return _3a50;
};
Button.showMoreActionsMenu=function(ev){
if((transMode==true)&&(messagetranslated==true)){
buttonMoreActionsMenuStatus=false;
}
if(!buttonMoreActionsMenuStatus){
var _3a52="";
_3a52="<menu id='buttonMoreActionsMenu' forElement='button_actionBar_moreActions'>";
_3a52+="<item onclick='ole.currObj.clone(1,"+Button.header.xOffsetOnClone+","+Button.header.yOffsetOnClone+");'><![CDATA["+jsMsg.Clone+"]]></item>";
_3a52+="<item onclick='ole.remove(ole.currObj.id, true);ole.conf.onblur();return false;'><![CDATA["+jsMsg.Delete+"]]></item>";
_3a52+="</menu>";
Menu.create(_3a52,{inputType:"xml"});
buttonMoreActionsMenuStatus=true;
}
ole.currObj.resetActionBarState();
Menu.buttonMoreActionsMenu.cachedContent="";
showMenu("buttonMoreActionsMenu");
};
Button.showManageMacros=function(mode){
Button.isMacroToBeAssigned=true;
Button.detailsToBeAssigned=ole.currObj.id;
showManageMacros(mode);
};
Button.clearMacroAllocationDetails=function(){
Button.isMacroToBeAssigned=false;
Button.detailsToBeAssigned=null;
};
Button.editLabel=function(id,isNew){
Button.closeActionBarMenus(id);
if(isNew){
var wd=85;
var ht=25;
ole.setAsCurrObj(id).setWidth(wd).setHeight(ht);
}
Button[id].switchModes(true,isNew);
};
var assignMacroMenuStatus=false,changeMacroMenuStatus=false,buttonMoreActionsMenuStatus=false;
Button.showAssignMacroMenu=function(ev){
Button(ole.currObj.id).switchModes(false);
var _3a59="";
assignMacroMenuStatus=true;
_3a59="<menu id='assignMacroMenu' forElement='button_actionBar_assignMacro'>";
_3a59+=" <item onclick='Button.showMacroList(ole.currObj.id)'><![CDATA["+jsMsg["Button.AssignExistingMacro"]+"...]]></item>";
_3a59+="<item onclick='Button.showMacroList(ole.currObj.id)'><![CDATA["+jsMsg["Button.AssignNewMacro"]+"]]>";
_3a59+="<menu><item onclick='Button.showManageMacros(\"create\")'><![CDATA["+jsMsg["Button.Macro.Write"]+"...]]></item>";
_3a59+="<item onclick='Button.showManageMacros(\"record\")'><![CDATA["+jsMsg.RecordMacro+"...]]></item></menu></item>";
_3a59+="</menu>";
Menu.create(_3a59,{inputType:"xml"});
if(!RECORDINGMACRO){
Menu.assignMacroMenu.data[0].disabled="false";
Menu.assignMacroMenu.data[1].disabled="false";
Menu.assignMacroMenu.data[1].subMenu[0].disabled="false";
Menu.assignMacroMenu.data[1].subMenu[1].disabled="false";
}else{
Menu.assignMacroMenu.data[0].disabled="true";
Menu.assignMacroMenu.data[1].disabled="true";
Menu.assignMacroMenu.data[1].subMenu[0].disabled="true";
Menu.assignMacroMenu.data[1].subMenu[1].disabled="true";
}
Menu.assignMacroMenu.cachedContent="";
showMenu("assignMacroMenu");
};
Button.showChangeMacroMenu=function(ev){
Button(ole.currObj.id).switchModes(false);
var _3a5b="";
changeMacroMenuStatus=true;
_3a5b="<menu id='changeMacroMenu' forElement='button_actionBar_changeMacro'>";
_3a5b+=" <item onclick='Button.showMacroList(ole.currObj.id)'><![CDATA["+jsMsg["Button.AssignExistingMacro"]+"...]]></item>";
_3a5b+="<item onclick='Button.showMacroList(ole.currObj.id)'><![CDATA["+jsMsg["Button.AssignNewMacro"]+"]]>";
_3a5b+="<menu><item onclick='Button.showManageMacros(\"create\")'><![CDATA["+jsMsg["Button.Macro.Write"]+"...]]></item>";
_3a5b+="<item onclick='Button.showManageMacros(\"record\")'><![CDATA["+jsMsg.RecordMacro+"...]]></item></menu></item>";
_3a5b+="</menu>";
Menu.create(_3a5b,{inputType:"xml"});
if(RECORDINGMACRO){
Menu.changeMacroMenu.data[0].disabled="true";
Menu.changeMacroMenu.data[1].disabled="true";
Menu.changeMacroMenu.data[1].subMenu[0].disabled="true";
Menu.changeMacroMenu.data[1].subMenu[1].disabled="true";
}else{
Menu.changeMacroMenu.data[0].disabled="false";
Menu.changeMacroMenu.data[1].disabled="false";
Menu.changeMacroMenu.data[1].subMenu[0].disabled="false";
Menu.changeMacroMenu.data[1].subMenu[1].disabled="false";
}
Menu.changeMacroMenu.cachedContent="";
showMenu("changeMacroMenu");
};
Button.showMacroList=function(id){
var url="docowner="+CURR_DOC_OWNERNAME;
url+="&collabid="+COLLAB_ID;
url+="&readwrite="+ALLOW_TO_WRITE;
url+="&collabEditing="+COLLABORATIVE_EDITING;
url+="&viewType="+getObj("VIEW").value;
url+="&docid="+DOCUMENT_ID;
url+="&currenttime="+CURRENTTIME;
url+="&currentSheetName="+encodeURIComponent(CURRSHEETNAME);
url+="&bridgeNo="+bridgeNumber;
url+="&currentSelection="+getCurrentSelection();
url+="&afterRTC=false";
Button.detailsToBeAssigned=id;
Button.isMacroToBeAssigned=true;
showURLInDialog(ctxpath+"pages/AssignMacro.jsp?"+url,"position=absolute,width=350, title="+jsMsg["Button.ActionBar.AssignMacro"]+", modal=yes",Button.macroListOnLoad,"",positionDialog);
};
Button.macroListOnLoad=function(){
positionDialog();
if(typeof noofmacros!="undefined"&&noofmacros==false){
getObj("noMacrosDiv").style.display="";
getObj("macroExistDiv").style.display="none";
getObj("assignMacroOkButton").style.display="none";
getObj("feButtonDlgBoxHsep").style.display="none";
}else{
getObj("noMacrosDiv").style.display="none";
getObj("macroExistDiv").style.display="";
getObj("assignMacroOkButton").style.display="";
}
};
Button.assignMacro=function(id){
var _3a5f=getObj("macroListId");
if(_3a5f.options.selectedIndex<0){
showAlertDialog(jsTitleMsg["Button.Alert.AssignMacro"]);
return;
}
Button(id).sendAssignedMacro(_3a5f.options[_3a5f.options.selectedIndex].value);
closeDialog();
};
Button.setPermission=function(){
var _3a60=false,_3a61=false,_3a62=false;
switch(getViewType()){
case "SHARE_VIEW":
if(!IS_WHOLE_DOCUMENT_SHARED_IN_READ_WRITE){
break;
}
case "NEW_VIEW":
case "OPEN_VIEW":
_3a60=true;
_3a61=true;
}
ole.setObjectProperties("button",{permissions:{"isDraggable":_3a60,"isResizable":_3a61,"isEditable":_3a62}});
};
function _Button(id,_3a64){
if(getObj(id)&&arguments[2]){
var _3a65=getObj(id).parentNode;
if(_3a65){
_3a65.removeChild(getObj(id));
}
}
this.el=getObj("BUTTON").cloneNode(true);
this.el.id=this.id=id;
this.el.objType="button";
this.isMacroAssigned=false;
this.macroName;
this.moduleName;
this.isMacroAssigned;
this.isInEditMode;
sheetObjectsPane.appendChild(this.el);
if(!isUndefined(_3a64)){
Button.setProps(id,_3a64);
}
this.Label=this.el.getElementsByTagName("TD")[4];
this.editableLabel=this.el.getElementsByTagName("TD")[5];
this.textElement=this.el.getElementsByTagName("input")[0];
this.textElement.onkeydown=function(ev){
Button(id).setCaption(ev);
};
return this;
}
_Button.prototype={checkMacroAssigned:function(_3a67){
if(typeof _3a67.MACRONAME!="undefined"&&_3a67.MACRONAME!=""&&_3a67.MACRONAME!="null"){
this.isMacroAssigned=true;
}else{
this.isMacroAssigned=false;
}
var _3a68=ole.getObjectPermissions(this.id,["isDraggable","isResizable"]);
if(this.isMacroAssigned||!(_3a68.isDraggable||_3a68.isResizable)){
ole(this.setMacroName(_3a67.MODULENAME,_3a67.MACRONAME).id).setDesignMode(false);
Button(this.id).setContextMenu();
ole(this.id).el.className="feButton";
}else{
ole(this.id).el.className="feButton feButtonCtrlKeyDown";
}
return this;
},setMacroName:function(_3a69,_3a6a){
this.macroName=_3a6a;
this.moduleName=_3a69;
return this;
},setText:function(_3a6b){
var obj=getObj(this.id);
this.caption=_3a6b;
this.textElement.value=_3a6b;
this.Label.childNodes[1].innerHTML=revertQuote(revertSplChrs(_3a6b));
return this;
},insert:function(_3a6d){
var id=_3a6d.ID;
Button.init(id,_3a6d);
return this;
},runMacro:function(){
if((this.id).isExposed){
if(this.MODULENAME!=""&&this.MODULENAME!="null"){
runmacro(this.MODULENAME,this.MACRONAME);
}
}
return this;
},setCaption:function(evt){
var _3a70,_3a71,_3a72,_3a73,_3a74,_3a75,wd,_3a77,newWd,_3a79,_3a7a;
if(browser_ie){
var evt=window.event;
}
_3a75=getObj("feButtonWidthCalculator");
_3a79=evt.ctrlKey;
_3a7a=evt.altKey;
_3a70=0;
_3a71=false;
if(getPrintableCharacterKeyCodes().indexOf(evt.keyCode)!=-1){
if(!((evt.keyCode==8)&&(evt.keyCode==46))){
_3a72=String.fromCharCode(evt.keyCode);
_3a75.innerHTML=this.textElement.value+_3a72;
}
}
if(evt.keyCode==32){
Button.emptySpaceCount++;
}else{
if(evt.keyCode==8||evt.keyCode==46){
_3a75.innerHTML=this.textElement.value;
}
}
if(evt.keyCode==8){
var _3a7b=this.textElement.value;
if(_3a7b.charAt(getCaretPos(this.textElement)-1)==" "){
Button.emptySpaceCount--;
}
}
if(evt.keyCode==46){
var _3a7b=this.textElement.value;
if(_3a7b.charAt(getCaretPos(this.textElement))==" "){
Button.emptySpaceCount--;
}
}
wd=ole(this.id).width;
_3a77=wd-Button.diffX;
newWd=_3a75.offsetWidth+(4*Button.emptySpaceCount);
_3a73=getSelectedText(this.textElement);
if(_3a73.length>0){
if(_3a79){
}
if(_3a7a){
}
if(!(_3a79||_3a7a)){
if(getPrintableCharacterKeyCodes().indexOf(evt.keyCode)!=-1){
_3a75.innerHTML=_3a73;
_3a74=_3a75.offsetWidth;
newWd=newWd-_3a74;
}
}
_3a71=true;
}
var left=parseInt(ole(this.id).left);
if(evt.keyCode==27){
this.setText(this.caption).switchModes(false);
ole(this.id).resetActionBarState().displayAssociativeElements("block","none").setSelectLayer().positionActionBar();
activateCellField();
return this;
}
if(!(evt.keyCode==13)&&(!ole(this.id).isResizedOnce)){
if((newWd)>=_3a77){
ole(this.id).setWidth(wd+6+_3a70).setLeft(left-3-(_3a70/2));
Button.isInitialSizeChangedOnEdit=true;
}else{
if(newWd<(_3a77-20)&&(ole(this.id).width>85)){
if(Button.isInitialSizeChangedOnEdit&&(getPrintableCharacterKeyCodes().indexOf(evt.keyCode)!=-1)){
if(_3a71){
ole(this.id).setWidth(newWd+20+Button.diffX).setLeft(left+(parseInt((wd-(newWd+20+Button.diffX))/2)));
}else{
ole(this.id).setWidth(wd-20).setLeft(left+10);
}
}
}
}
}
if((evt.keyCode==13)||(evt.keyCode==9)){
this.switchModes(false).setTextInLabel();
ole(this.id).resetActionBarState().displayAssociativeElements("block","none").setSelectLayer().positionActionBar();
ole.focus();
return this;
}
_3a75.innerHTML="";
},setTextInLabel:function(_3a7d,_3a7e){
var _3a7f=this.textElement;
var _3a80=_3a7f.value;
_3a80=_3a80.trim();
if(!_3a7d){
_3a7d=false;
}
if(!_3a7e){
_3a7e=CURRSHEETNAME;
}
this.caption=_3a80;
this.Label.childNodes[1].innerHTML=revertQuote(revertSplChrs(_3a80));
var nvp="ACTION=SetCaption";
nvp+="&CAPTION="+encodeURIComponent(_3a80)+"&NAME="+this.id+"&WIDTH="+ole(this.id).width+"&LEFT="+ole(this.id).left+"&TOP="+ole(this.id).top+"&HEIGHT="+ole(this.id).height+"&afterRTC="+_3a7d+"&SHEETNAME="+encodeURIComponent(_3a7e);
Button.sendInfoToServer(nvp);
return this;
},switchModes:function(_3a82,isNew){
var _3a84=this.textElement;
if(!_3a82){
this.Label.style.display="";
this.editableLabel.style.display="none";
ole(this.id).mask().el.className="feButton";
if(!this.isMacroAssigned){
ole(this.id).el.className+=" feButtonCtrlKeyDown";
}
this.isInEditMode=false;
Button.emptySpaceCount=0;
Button.elementInEditMode=null;
if(Button.isOnInitialEdit){
ole(this.id).setHeight(parseInt(ole(this.id).height));
Button.isOnInitialEdit=false;
}
Button.isInitialSizeChangedOnEdit=true;
}else{
if(_3a82){
if(isNew){
Button.isOnInitialEdit=true;
Button.isInitialSizeChangedOnEdit=false;
}
Button.elementInEditMode=this;
Button.closeActionBarMenus(this.id);
Button.emptySpaceCount=0;
this.isInEditMode=true;
this.Label.style.display="none";
this.editableLabel.style.display="";
var _3a85=_3a84.value.length;
ole(this.id).expose();
ole(this.id).displayAssociativeElements("none","none","none");
ole(this.id).el.className+=" feButtonEdit";
var _3a86=getObj("feButtonWidthCalculator");
_3a86.innerHTML=_3a84.value;
if(!ole(this.id).isResizedOnce){
if((ole(this.id).width>=85)&&(ole(this.id).width<_3a86.offsetWidth)){
ole(this.id).setWidth(_3a86.offsetWidth+30);
}else{
if(ole(this.id).width<85){
ole(this.id).setWidth(85);
}
}
}
var _3a87=ole(this.id);
var _3a88=findThirdPaneYPos();
var _3a89=findSecondPaneXPos();
if(_3a87.top-_3a88<getSheetScrollTop()){
setScrollTop(_3a87.top-_3a88);
}else{
if(_3a87.top>getSheetScrollTop()+getSheetHeight()){
setScrollTop(_3a87.top+_3a87.height-getSheetHeight());
}
}
if(_3a87.left-_3a89<getSheetScrollLeft()){
setScrollLeft(_3a87.left-_3a89);
}else{
if(_3a87.left>getSheetScrollLeft()+getSheetWidth()){
setScrollLeft(_3a87.left+_3a87.width-getSheetWidth());
}
}
if(!browser_safari&&!browser_opera){
_3a84.focus();
}
if(browser_safari||!browser_ie||browser_opera){
setCaretPos(_3a84,_3a85);
}else{
if(browser_ie){
setCaretPos(_3a84,_3a85);
}
}
}
}
return this;
},assignMacro:function(_3a8a){
if(_3a8a.MODULENAME==""){
this.isMacroAssigned=false;
this.moduleName="";
this.macroName="";
return this;
}
ole(_3a8a.ID).setDesignMode(false).el.className="feButton";
this.moduleName=_3a8a.MODULENAME;
this.macroName=_3a8a.MACRONAME;
this.isMacroAssigned=true;
this.switchState(true);
return this;
},switchState:function(_3a8b){
var _3a8c=ole(this.id).getActionBar();
if(_3a8b){
_3a8c.getElementsByTagName("TD")[2].style.display="none";
_3a8c.getElementsByTagName("TD")[3].style.display="";
_3a8c.getElementsByTagName("TD")[5].style.display="";
_3a8c.getElementsByTagName("TD")[6].style.display="";
}else{
_3a8c.getElementsByTagName("TD")[2].style.display="";
_3a8c.getElementsByTagName("TD")[3].style.display="none";
_3a8c.getElementsByTagName("TD")[5].style.display="none";
_3a8c.getElementsByTagName("TD")[6].style.display="none";
}
return this;
},sendAssignedMacro:function(macro,_3a8e,_3a8f){
if(!_3a8e){
_3a8e=false;
}
if(!_3a8f){
_3a8f=CURRSHEETNAME;
}
var nvp="ACTION=AssignMacro";
nvp+="&FUNCTION="+macro+"&NAME="+this.id+"&afterRTC="+_3a8e+"&SHEETNAME="+encodeURIComponent(_3a8f);
Button.sendInfoToServer(nvp,"AssignMacro");
return this;
},assignNewMacro:function(_3a91){
if(_3a91!=""){
_3a91="Macros."+_3a91;
}
return this.sendAssignedMacro(_3a91);
},showContextMenu:function(ev){
if(browser_ie){
var ev=window.event;
}
if(!this.isInEditMode){
ole(this.id).showContextMenu(ev).setSelectLayer().positionActionBar(true).el.className="feButton";
}
return this;
},setContextMenu:function(){
if(is_ie){
ole(this.id).el.oncontextmenu=function(){
Button(this.id).showContextMenu(event);
};
}else{
ole(this.id).el.setAttribute("oncontextmenu","Button(\""+this.id+"\").showContextMenu(event);");
}
return this;
}};
ole.createObjectProperties("button",{focusLayer:"OLEFocusLayer",selectLayer:"OLESelectLayer",menuData:Button.menuData,minHeight:10,minWidth:10,hasOrdering:false,actionBar:"OLEActionBar",contextMenu:"OLEButtonContextMenu",cloneOnCTRLDrag:true,resizeCorners:["E","S","SE"],onResizeStart:Button.onBeforeResize,onResizeEnd:Button.resize,onDragStart:Button.onBeforeDrag,onDragEnd:Button.move,onRemove:Button.remove,onClone:Button.clone,onSync:Button.onSync,onCtrlKeyDown:Button.onCtrlKeyDown,onCtrlKeyUp:Button.onCtrlKeyUp,onmouseover:Button.onObjMouseOver,onmouseout:Button.onMouseOut,onEditLayerClick:Button.onEditLayerClick,onObjectSwitch:Button.onObjectSwitch,ondoubleclick:Button.ondoubleclick,onMove:Button.closeActionBarMenus,onMoveEnd:Button.move,onedit:Button.editLabel,onDocOpen:Button.closeActionBarMenus,onMouseDownOutsideOLEElements:Button.onmousedownOutside,onBeforeLoadActionBar:Button.onBeforeLoadActionBar,onFocusLayerMouseDown:Button.onFocusLayerMouseDown});
Button.header={xOffsetOnClone:20,yOffsetOnClone:20};
var ISFREEZED=false;
var FREEZED_ROW=0;
var FREEZED_COL=0;
var FREEZE_TYPE="";
var isRowsOnlyFreezed=false;
var isColsOnlyFreezed=false;
var isColsAndRowsFreezed=false;
var firstPaneLeft=0;
var firstPaneTop=0;
var secondPaneLeft=0;
var secondPaneTop=0;
var thirdPaneLeft=0;
var thirdPaneTop=0;
var fourthPaneLeft=0;
var fourthPaneTop=0;
var freezedRowsHeight=0;
var freezedColsWidth=0;
var vFreezeCue,hFreezeCue;
var freezeStatus={};
var submitBeforeFreeze="";
var visibleRowsInFrozenRange=[];
var sheetPane1,sheetPane2,sheetPane3;
var sheetTable1,sheetTable2,sheetTable3;
var colHead1,colHeadTable1;
var rowHead1,rowHeadTable1;
var currTableId,currTableObj;
var focusDIV1,focusDIV2,focusDIV3;
var transSPAN1,transSPAN2,transSPAN3;
var cellRangeFillDIV1,cellRangeFillDIV2,cellRangeFillDIV3;
var cellRangeFillSPAN1,cellRangeFillSPAN2,cellRangeFillSPAN3;
var fillSeriesDIV1,fillSeriesDIV2,fillSeriesDIV3;
var fillSeriesSPAN1,fillSeriesSPAN2,fillSeriesSPAN3;
var filterIconsPane,filterIconsPane1,filterIconsPane2,filterIconsPane3;
var availableStartRowAfterFreeze;
var sheetPaneId="sP";
var sheetPane1Id="sP1";
var sheetPane2Id="sP2";
var sheetPane3Id="sP3";
var rowHeadId="rH";
var rowHead1Id="rH1";
var colHeadId="cH";
var colHead1Id="cH1";
var mCCId="mCC";
var mCC1Id="mCC1";
var mCC2Id="mCC2";
var mCC3Id="mCC3";
function resetFreezePaneVariables(){
ISFREEZED=false;
FREEZED_ROW=0;
FREEZED_COL=0;
isRowsOnlyFreezed=false;
isColsOnlyFreezed=false;
isColsAndRowsFreezed=false;
firstPaneLeft=0;
firstPaneTop=0;
secondPaneLeft=0;
secondPaneTop=0;
thirdPaneLeft=0;
thirdPaneTop=0;
fourthPaneLeft=0;
fourthPaneTop=0;
freezedRowsHeight=0;
freezedColsWidth=0;
hideElement(vFreezeCue);
hideElement(hFreezeCue);
isSheetFreezed=false;
persistedFreezedRow=0;
persistedFreezedCol=0;
frozenRows=[];
}
function freeze(row,col){
if(ISFREEZED){
unFreezePanes();
return;
}
if(isWholeSheetSelected()){
return;
}
var info=ActiveCellInfo;
row=isUndefined(row)?isRowSelected()?info.getActiveRow():info.getStartRow():row;
col=isUndefined(col)?isColSelected()?info.getActiveCol():info.getStartCol():col;
if(row>5||col>5){
showAlertDialog(jsTitleMsg["FreezePanes.limitedupto5rowsand5columns"]);
return;
}
if(row==0&&col==0){
return;
}else{
if(saveDocBeforeFreeze){
freezePanes(row,col,true);
saveDocBeforeFreeze=false;
}else{
freezePanes(row,col);
}
}
}
function setFreezePaneVars(row,col){
ISFREEZED=true;
FREEZED_ROW=row;
FREEZED_COL=col;
if(row==0){
isColsOnlyFreezed=true;
}else{
if(col==0){
isRowsOnlyFreezed=true;
}else{
isColsAndRowsFreezed=true;
}
}
var _3a98=freezedRowsHeight=getRowTop(row);
var _3a99=freezedColsWidth=getColLeft(col);
firstPaneLeft=firstPaneTop=secondPaneTop=thirdPaneLeft=0;
secondPaneLeft=fourthPaneLeft=_3a99;
thirdPaneTop=fourthPaneTop=_3a98;
}
function freezeTopRow(){
freezePanes(1,0);
}
function freezeFirstColumn(){
freezePanes(0,1);
}
function freezePanes(row,col,_3a9c){
$("#freezePane").zbutton("hide","#freeze");
$("#freezePane").zbutton("hide","#freezetoprow");
$("#freezePane").zbutton("hide","#freezefirstcol");
$("#unfreeze").zbutton("show");
if(isCellEdited()){
if(_3a9c=="true"){
submitBeforeFreeze="AFTERRTCFREEZE";
}else{
submitBeforeFreeze="FREEZE";
}
if(!cellField.value.indexOf("=")==0&&!editedFormulaCellInfo.isOtherSheet){
submitCell();
}
}
if(!isRowInAvailableRowRange(row)){
updateTileCallbackInfo.isCallbackAvailable=true;
updateTileCallbackInfo.actionDetails={"action":"FREEZE","callbackMethod":freezePanes,"freezeeRow":row,"freezeeCol":col,"afterRTC":_3a9c};
scrollRowIntoView(0);
return false;
}
if(((!SAVED&&ALLOW_TO_WRITE&&!jsREMOTE_SAVE_VIEW)||(DOCUMENT_ID=="doc_id"&&SAVED&&ALLOW_TO_WRITE)||((jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW)&&!isDocSaved()))&&!fromOpenFreeze){
freezeStatus["saveBeforeFreeze"]=true;
freezeStatus["ROW"]=row;
freezeStatus["COL"]=col;
if(_3a9c){
saveDocBeforeFreeze=true;
}
SAVED=false;
autosave();
return;
}
if(col>=0){
}
if(row>=0){
}
if(jsEMBED_VIEW){
if(getSheetScrollTop()==0){
setFreezeCues(row,col);
doFreeze(true,fromOpenFreeze,_3a9c,row,col);
}
}else{
setFreezeCues(row,col);
doFreeze(true,fromOpenFreeze,_3a9c,row,col);
}
}
function freezeCallBack(_3a9d,row,col,_3aa0){
if(_3a9d){
setFreezePaneVars(row,col);
restrictTextSelection(sheetTable1);
restrictTextSelection(sheetTable2);
restrictTextSelection(sheetTable3);
if(fromGoTo){
fromGoTo=false;
gotoCell();
}else{
if(editedFormulaCellInfo.isOtherSheet||editedFormulaCellInfo.isSameSheet){
if(editedFormulaCellInfo.cellFieldDetails.ACTUAL_FORMULA_SHEET!=CURRSHEETNAME){
return;
}else{
focusCell(editedFormulaCellInfo.cellFieldDetails.ROW,editedFormulaCellInfo.cellFieldDetails.COLUMN);
focusCellField(cellField.value);
}
}else{
focusCell(Row.isHidden(row)?Row.findNextNonHiddenRow(row):row,col);
}
}
}else{
var _3aa1=getAvailableStartRow();
resetFreezePaneVariables();
if(_3aa1>ROWS_PER_TILE-1||getSheetScrollTop()>0){
}else{
focusCell(currRow,currCol);
}
}
rHTcontextMenuStatus=cHTcontextMenuStatus=contextMenuStatus=ROcontextMenuStatus=false;
}
function unFreezePanes(_3aa2){
if(isCellEdited()){
if(_3aa2=="true"){
submitBeforeFreeze="AFTERRTCUNFREEZE";
}else{
submitBeforeFreeze="UNFREEZE";
}
submitCell();
}
$("#freezePane").zbutton("show","#freeze");
$("#freezePane").zbutton("show","#freezetoprow");
$("#freezePane").zbutton("show","#freezefirstcol");
$("#unfreeze").zbutton("hide");
doFreeze(false,false,_3aa2);
}
function doFreeze(_3aa3,_3aa4,_3aa5,row,col){
if(typeof _3aa5=="undefined"){
_3aa5="false";
}
if(_3aa3){
blurSheetHeadTables();
if(row==0){
freezeCols(col);
}else{
if(col==0){
freezeRows(row);
}else{
freezeColsAndRows(row,col);
}
}
}else{
mergeSheetPanes();
hideSheetPanes();
resetSheetPaneDim();
}
if(_3aa4){
freezeCallBack(_3aa3,row,col,true);
fromOpenFreeze=false;
}else{
if(!_3aa3){
row=FREEZED_ROW;
col=FREEZED_COL;
}
var _3aa8=new getXmlhttp();
_3aa8.onreadystatechange=function(){
if(_3aa8.readyState==4){
freezeCallBack(_3aa3,row,col);
}
};
var _3aa9=encodeURIComponent(CURRSHEETNAME);
var _3aaa="&docid="+DOCUMENT_ID+"&sheetname="+_3aa9+"&curtime="+CURRENTTIME+"&viewType="+getViewType()+"&readwrite="+ALLOW_TO_WRITE;
_3aaa+="&docowner="+CURR_DOC_OWNERNAME+"&afterRTC="+_3aa5+"&collabid="+COLLAB_ID+"&collabEditing="+COLLABORATIVE_EDITING;
_3aaa+="&isFreeze="+_3aa3+"&freezedRow="+row+"&freezedCol="+col+"&freezetype='JUNK'";
if(jsREMOTE_SAVE_VIEW){
_3aaa+="&RMLOGINNAME="+RMUSER;
}
sendXMLHTTPRequest(_3aa8,_3aaa,true,true,ctxpath+"freezepanes.do");
}
}
function freezeRows(row){
splitRowHead(row);
splitSheetPane("ROWS");
setSheetPanesDim("ROWS");
showSheetPanes("ROWS");
}
function freezeCols(col){
splitColHead(col);
splitSheetPane("COLS");
setSheetPanesDim("COLS");
showSheetPanes("COLS");
}
function freezeColsAndRows(row,col){
splitRowHead(row);
splitColHead(col);
splitSheetPane("ROWS/COLS");
setSheetPanesDim("ROWS/COLS");
showSheetPanes("ROWS/COLS");
}
function splitRowHead(row){
rowHeadTable1.innerHTML=rowHeadTable.innerHTML;
var _3ab0=getRowTop(row);
rowHead1.style.height=_3ab0+"px";
rowHeadTable1.style.height=rowHeadTable.style.height;
rowHead.style.top=_3ab0+"px";
rowHead.style.height=(parseInt(rowHead.style.height)-_3ab0)+"px";
rowHeadTable.style.top=(-1*_3ab0)+"px";
thirdPaneTop=fourthPaneTop=_3ab0;
}
function splitColHead(col){
colHeadTable1.innerHTML=colHeadTable.innerHTML;
var _3ab2=getColLeft(col);
colHead1.style.width=_3ab2+"px";
colHeadTable1.style.width=colHeadTable.style.width;
colHead.style.left=_3ab2+"px";
colHead.style.width=(parseInt(colHead.style.width)-_3ab2)+"px";
colHeadTable.style.left=(-1*_3ab2)+"px";
secondPaneLeft=fourthPaneLeft=_3ab2;
}
function splitSheetPane(_3ab3,_3ab4){
var _3ab5=secondPaneLeft+"px";
var _3ab6=(-1*secondPaneLeft)+"px";
var _3ab7=thirdPaneTop+"px";
var _3ab8=(-1*thirdPaneTop)+"px";
switch(_3ab3){
case "ROWS":
if(!_3ab4){
var _3ab9=getTile(0).cloneNode(true);
sheetTable2.appendChild(_3ab9);
}
getObj(mCC2Id).innerHTML=getObj(mCCId).innerHTML;
Merge.bindDOMObjcts(sheetPane2Id);
sheetTable.style.top=_3ab8;
sheetTable2.style.width=sheetTable.style.width;
sheetTable2.style.height=sheetTable.style.height;
sheetPane2.style.left=sheetPane2.style.top="0px";
sheetPane.style.left="0px";
sheetPane.style.top=_3ab7;
focusDIV.style.marginTop=_3ab8;
fillSeriesDIV.style.marginTop=_3ab8;
cellRangeFillDIV.style.marginTop=_3ab8;
getObj("cF").style.marginTop=_3ab8;
getObj(mCCId).style.marginTop=_3ab8;
sheetObjectsPane.style.top=_3ab8;
filterIconsPane.style.top=_3ab8;
filterIconsPane3.style.top=_3ab8;
for(var i=0;i<getChildNodesLength(userPresencePane);i++){
getChildNode(userPresencePane,i).style.marginTop=_3ab8;
}
break;
case "COLS":
sheetTable3.innerHTML=sheetTable.innerHTML;
getObj(mCC3Id).innerHTML=getObj(mCCId).innerHTML;
Merge.bindDOMObjcts(sheetPane3Id);
sheetTable.style.left=_3ab6;
sheetTable3.style.width=sheetTable.style.width;
sheetTable3.style.height=sheetTable.style.height;
sheetPane3.style.left=sheetPane3.style.top="0px";
sheetPane.style.left=_3ab5;
sheetPane.style.top="0px";
focusDIV.style.marginLeft=_3ab6;
fillSeriesDIV.style.marginLeft=_3ab6;
cellRangeFillDIV.style.marginLeft=_3ab6;
getObj("cF").style.marginLeft=_3ab6;
getObj(mCCId).style.marginLeft=_3ab6;
sheetObjectsPane.style.left=_3ab6;
filterIconsPane.style.left=_3ab6;
filterIconsPane2.style.left=_3ab6;
for(var i=0;i<getChildNodesLength(userPresencePane);i++){
getChildNode(userPresencePane,i).style.marginLeft=_3ab6;
}
break;
case "ROWS/COLS":
if(!_3ab4){
var _3abb=getTile(0).cloneNode(true);
var _3abc=getTile(0).cloneNode(true);
sheetTable1.appendChild(_3abb);
sheetTable2.appendChild(_3abc);
}
sheetTable3.innerHTML=sheetTable.innerHTML;
var _3abd=getObj(mCCId).innerHTML;
getObj(mCC1Id).innerHTML=_3abd;
getObj(mCC2Id).innerHTML=_3abd;
getObj(mCC3Id).innerHTML=_3abd;
Merge.bindDOMObjcts(sheetPane1Id);
Merge.bindDOMObjcts(sheetPane2Id);
Merge.bindDOMObjcts(sheetPane3Id);
sheetTable2.style.left=sheetTable.style.left=_3ab6;
sheetTable3.style.top=sheetTable.style.top=_3ab8;
sheetTable1.style.width=sheetTable2.style.width=sheetTable3.style.width=sheetTable.style.width;
sheetTable1.style.height=sheetTable2.style.height=sheetTable3.style.height=sheetTable.style.height;
sheetPane1.style.left=sheetPane1.style.top="0px";
sheetPane2.style.left=_3ab5;
sheetPane2.style.top="0px";
sheetPane3.style.left="0px";
sheetPane3.style.top=_3ab7;
sheetPane.style.left=_3ab5;
sheetPane.style.top=_3ab7;
focusDIV2.style.marginLeft=focusDIV.style.marginLeft=_3ab6;
focusDIV3.style.marginTop=focusDIV.style.marginTop=_3ab8;
fillSeriesDIV2.style.marginLeft=fillSeriesDIV.style.marginLeft=_3ab6;
fillSeriesDIV3.style.marginTop=fillSeriesDIV.style.marginTop=_3ab8;
cellRangeFillDIV2.style.marginLeft=cellRangeFillDIV.style.marginLeft=_3ab6;
cellRangeFillDIV3.style.marginTop=cellRangeFillDIV.style.marginTop=_3ab8;
getObj("cF2").style.marginLeft=_3ab6;
getObj("cF3").style.marginTop=_3ab8;
var cF=getObj("cF");
cF.style.marginLeft=_3ab6;
cF.style.marginTop=_3ab8;
getObj(mCC2Id).style.marginLeft=_3ab6;
getObj(mCC3Id).style.marginTop=_3ab8;
getObj(mCCId).style.marginLeft=_3ab6;
getObj(mCCId).style.marginTop=_3ab8;
filterIconsPane.style.left=_3ab6;
filterIconsPane.style.top=_3ab8;
filterIconsPane2.style.left=_3ab6;
filterIconsPane3.style.top=_3ab8;
sheetObjectsPane.style.left=_3ab6;
sheetObjectsPane.style.top=_3ab8;
for(var i=0;i<getChildNodesLength(userPresencePane);i++){
var _3abf=getChildNode(userPresencePane,i);
_3abf.style.marginLeft=_3ab6;
_3abf.style.marginTop=_3ab8;
}
for(var i=0;i<getChildNodesLength(userPresencePane3);i++){
getChildNode(userPresencePane3,i).style.marginTop=_3ab8;
}
for(var i=0;i<getChildNodesLength(userPresencePane2);i++){
getChildNode(userPresencePane2,i).style.marginLeft=_3ab6;
}
}
Filter.hasFilter&&Filter.replicateInAllPanes(true);
}
function setSheetPanesDim(_3ac0,mode){
switch(_3ac0){
case "ROWS":
sheetPane2.style.width=sheet.style.width;
sheetPane2.style.height=thirdPaneTop+"px";
sheetPane.style.height=(parseInt(sheet.style.height)-thirdPaneTop)+"px";
break;
case "COLS":
sheetPane3.style.width=secondPaneLeft+"px";
sheetPane3.style.height=sheetPane.style.height;
sheetPane.style.width=(parseInt(sheet.style.width)-secondPaneLeft)+"px";
break;
case "ROWS/COLS":
var _3ac2=(parseInt(sheet.style.width)-secondPaneLeft)+"px";
var _3ac3=(parseInt(sheet.style.height)-thirdPaneTop)+"px";
sheetPane1.style.width=secondPaneLeft+"px";
sheetPane1.style.height=thirdPaneTop+"px";
sheetPane2.style.width=_3ac2;
sheetPane2.style.height=thirdPaneTop+"px";
sheetPane3.style.width=secondPaneLeft+"px";
sheetPane3.style.height=_3ac3;
sheetPane.style.width=_3ac2;
sheetPane.style.height=_3ac3;
}
}
function resetSheetPanesDim(){
var _3ac4=(parseInt(sheetPane.style.width)-secondPaneLeft)+"px";
var _3ac5=(parseInt(sheetPane.style.height)-thirdPaneTop)+"px";
if(isColsOnlyFreezed){
colHead.style.width=_3ac4;
setSheetPanesDim("COLS");
}else{
if(isRowsOnlyFreezed){
rowHead.style.height=_3ac5;
setSheetPanesDim("ROWS");
}else{
if(isColsAndRowsFreezed){
colHead.style.width=_3ac4;
rowHead.style.height=_3ac5;
setSheetPanesDim("ROWS/COLS");
}
}
}
setHFreezeCueWidth();
setVFreezeCueHeight();
}
function resetSheetPaneDim(){
colHead.style.width=sheetPane.style.width=(parseInt(sheetPane.style.width)+secondPaneLeft)+"px";
rowHead.style.height=sheetPane.style.height=(parseInt(sheetPane.style.height)+thirdPaneTop)+"px";
}
function showSheetPanes(_3ac6){
if(_3ac6=="COLS"){
colHead1.style.display="";
sheetPane3.style.display="";
}else{
if(_3ac6=="ROWS"){
rowHead1.style.display="";
sheetPane2.style.display="";
}else{
colHead1.style.display="";
rowHead1.style.display="";
sheetPane1.style.display="";
sheetPane2.style.display="";
sheetPane3.style.display="";
}
}
}
function hideSheetPanes(){
rowHead1.style.display="none";
colHead1.style.display="none";
sheetPane1.style.display="none";
sheetPane2.style.display="none";
sheetPane3.style.display="none";
}
function setFreezeCues(row,col){
if((row-1)>=0){
hFreezeCue.style.left="0px";
setHFreezeCuePos(getRowTop(row)-1);
setHFreezeCueWidth();
}
if((col-1)>=0){
setVFreezeCuePos(getColLeft(col)-1);
vFreezeCue.style.top="0px";
setVFreezeCueHeight();
}
}
function setHFreezeCueWidth(){
hFreezeCue.style.width=getSheetTableWidth()+"px";
}
function setVFreezeCueHeight(){
vFreezeCue.style.height=getSheetTableHeight()+"px";
}
function setHFreezeCuePos(top){
hFreezeCue.style.top=top+"px";
}
function setVFreezeCuePos(left){
vFreezeCue.style.left=left+"px";
}
function findSecondPaneXPos(){
return secondPaneLeft;
}
function findThirdPaneYPos(){
return thirdPaneTop;
}
function findFourthPaneXYPos(){
return {x:fourthPaneLeft,y:fourthPaneTop};
}
function getFreezedRowsHeight(){
if(isRowsOnlyFreezed||isColsAndRowsFreezed){
freezedRowsHeight=parseInt(sheetPane1.style.height);
return freezedRowsHeight;
}else{
return 0;
}
}
function getFreezedColsWidth(){
if(isColsOnlyFreezed||isColsAndRowsFreezed){
freezedColsWidth=parseInt(sheetPane1.style.width);
return freezedColsWidth;
}else{
return 0;
}
}
function mergeColHeads(){
var _3acb=getColLeft(FREEZED_COL);
colHeadTable1.innerHTML="";
colHead1.style.width="0px";
colHeadTable1.style.width="0px";
colHead.style.left="0px";
colHead.style.width=(parseInt(colHead.style.width)+_3acb)+"px";
colHeadTable.style.left="0px";
}
function mergeRowHeads(){
var _3acc=getRowTop(FREEZED_ROW);
rowHeadTable1.innerHTML="";
rowHead1.style.height="0px";
rowHeadTable1.style.height="0px";
rowHead.style.top="0px";
rowHead.style.height=(parseInt(rowHead.style.height)+_3acc)+"px";
rowHeadTable.style.top="0px";
}
function mergeSheetPanes(){
if(isColsOnlyFreezed||isColsAndRowsFreezed){
mergeColHeads();
}
if(isRowsOnlyFreezed||isColsAndRowsFreezed){
mergeRowHeads();
}
sheetTable1.innerHTML=sheetTable2.innerHTML=sheetTable3.innerHTML="";
sheetTable.style.top=sheetTable.style.left="0px";
sheetTable1.style.top=sheetTable1.style.left="0px";
sheetTable2.style.top=sheetTable2.style.left="0px";
sheetTable3.style.top=sheetTable3.style.left="0px";
colHead.style.left=sheetPane.style.left=sheetPane2.style.left=sheetPane3.style.left="0px";
rowHead.style.top=sheetPane.style.top=sheetPane2.style.top=sheetPane3.style.top="0px";
sheetPane2.scrollLeft=0;
sheetPane3.scrollTop=0;
colHead.style.width=(parseInt(colHead.style.width)+secondPaneLeft)+"px";
rowHead.style.height=(parseInt(rowHead.style.height)+thirdPaneTop)+"px";
focusDIV.style.marginLeft=fillSeriesDIV.style.marginLeft=cellRangeFillDIV.style.marginLeft="0px";
focusDIV2.style.marginLeft=fillSeriesDIV2.style.marginLeft=cellRangeFillDIV2.style.marginLeft="0px";
focusDIV.style.marginTop=fillSeriesDIV.style.marginTop=cellRangeFillDIV.style.marginTop="0px";
focusDIV3.style.marginTop=fillSeriesDIV3.style.marginTop=cellRangeFillDIV3.style.marginTop="0px";
var cF=getObj("cF");
cF.style.marginLeft=getObj("cF2").style.marginLeft="0px";
cF.style.marginTop=getObj("cF3").style.marginTop="0px";
var mCC=getObj(mCCId);
var mCC1=getObj(mCC1Id);
var mCC2=getObj(mCC2Id);
var mCC3=getObj(mCC3Id);
mCC.style.marginLeft=mCC2.style.marginLeft="0px";
mCC.style.marginTop=mCC3.style.marginTop="0px";
mCC1.innerHTML=mCC2.innerHTML=mCC3Id.innerHTML="";
Merge.unBindDOMObjcts();
sheetObjectsPane.style.left=sheetObjectsPane.style.top="";
filterIconsPane.style.left=filterIconsPane.style.top="";
filterIconsPane2.innerHTML=filterIconsPane3.innerHTML=filterIconsPane1.innerHTML="";
for(var i=0;i<getChildNodesLength(userPresencePane);i++){
var _3ad3=getChildNode(userPresencePane,i);
_3ad3.style.marginLeft=_3ad3.style.marginTop="0px";
}
for(var i=0;i<getChildNodesLength(userPresencePane3);i++){
getChildNode(userPresencePane3,i).style.marginTop="0px";
}
for(var i=0;i<getChildNodesLength(userPresencePane2);i++){
getChildNode(userPresencePane2,i).style.marginLeft="0px";
}
}
function insertImgorChartIsFreezed(img,left,top){
img.style.left=parseInt(left)+"px";
img.style.top=parseInt(top)+"px";
sheetObjectsPane.appendChild(img);
}
function reloadSheetPanes(){
var _3ad7=getFreezeType();
setFreezePaneVars(FREEZED_ROW,FREEZED_COL);
splitSheetPane(_3ad7,true);
setSheetPanesDim(_3ad7);
var _3ad8=getRowTop(FREEZED_ROW);
var _3ad9=getSheetHeight();
rowHead1.style.height=rowHead.style.top=_3ad8+"px";
rowHeadTable1.style.height=_3ad8+"px";
rowHeadTable.style.top=-_3ad8+"px";
rowHead.style.height=_3ad9-_3ad8+"px";
}
function getFreezeType(){
if(FREEZED_ROW===0){
return "COLS";
}else{
if(FREEZED_COL===0){
return "ROWS";
}else{
return "ROWS/COLS";
}
}
}
var currFormatType="";
var isAutomatic=false;
var isNumberFormat=false;
var isCurrency=false;
var isDateTime=false;
var isPercentage=false;
var isFraction=false;
var isScientific=false;
var isText=false;
var isRegional=false;
var isSpecial=false;
var isCustom=false;
var dateTimeSelectObj;
var dateTimeSelectDefaultObj;
var formatNumberSelectObj;
var formatNumberSelectDefaultObj;
var formatCodesArr=new Array();
var customFormatString="";
var isRegionalFormatChange=true;
var isDialogShow=true;
var cusFormatStore;
var isAnyCategorySelected=false;
var isDateTimeFormatChange=true;
function resetFormatType(){
isAutomatic=false;
isNumberFormat=false;
isCurrency=false;
isDateTime=false;
isPercentage=false;
isFraction=false;
isScientific=false;
isText=false;
isRegional=false;
isSpecial=false;
isCustom=false;
}
function setFormatType(){
resetFormatType();
if(currFormatType=="format_automatic"){
isAutomatic=true;
isAnyCategorySelected=true;
}else{
if(currFormatType=="format_numbers"){
isNumberFormat=true;
isAnyCategorySelected=true;
if(getObj("decimals_format_numbers").value<0){
$("#decimals_format_numbers").zspinner("setValue",2);
}
if(getObj("leading_zeroes_format_numbers").value<0){
$("#leading_zeroes_format_numbers").zspinner("setValue",1);
}
}else{
if(currFormatType=="format_currency"){
isCurrency=true;
isAnyCategorySelected=true;
if(getObj("decimals_format_currency").value<0){
$("#decimals_format_currency").zspinner("setValue",2);
}
if(getObj("leading_zeroes_format_currency").value<0){
$("#leading_zeroes_format_currency").zspinner("setValue",1);
}
}else{
if(currFormatType=="format_datetime"){
isDateTime=true;
isAnyCategorySelected=true;
}else{
if(currFormatType=="format_percentage"){
isPercentage=true;
isAnyCategorySelected=true;
if(getObj("decimals_format_percentage").value<0){
$("#decimals_format_percentage").zspinner("setValue",2);
}
}else{
if(currFormatType=="format_fraction"){
isFraction=true;
isAnyCategorySelected=true;
}else{
if(currFormatType=="format_scientific"){
isScientific=true;
isAnyCategorySelected=true;
if(getObj("decimals_format_scientific").value<0){
$("#decimals_format_scientific").zspinner("setValue",2);
}
}else{
if(currFormatType=="format_text"){
isText=true;
isAnyCategorySelected=true;
}else{
if(currFormatType=="format_regional"){
isRegional=true;
isAnyCategorySelected=true;
}else{
if(currFormatType=="format_special"){
isSpecial=true;
isAnyCategorySelected=true;
}else{
if(currFormatType=="format_custom"){
isCustom=true;
isAnyCategorySelected=true;
}
}
}
}
}
}
}
}
}
}
}
}
function showFormatCellsDialog(_3ada){
if(isUndefined(_3ada)){
_3ada="";
}
var _3adb=getXMLHttpRequest();
_3adb.onreadystatechange=function(){
if(_3adb.readyState==4){
var _3adc=_3adb.responseText;
showDialog(_3adc,"position=absmiddle,width=575,title="+jsTitleMsg.FormatCells+",closeOnEscKey=yes,modal=yes",positionDialog,destroyZohoCompInDialog);
if(_3ada=="showCustomTab"){
currFormatType="format_custom";
setFormatType();
toggleFormatType(getObj(currFormatType));
}else{
updateFormatCellsDialog();
}
getObj("div_language_format_numbers").hidden="true";
getObj("div_language_format_currency").hidden="true";
getObj("div_language_format_datetime").hidden="true";
getObj("div_language_format_percentage").hidden="true";
getObj("div_language_format_scientific").hidden="true";
}
};
if(isCellRange()){
var _3add=getCellRange();
var _3ade=_3add.startRow;
var _3adf=_3add.startCol;
var _3ae0=_3add.endRow;
var _3ae1=_3add.endCol;
if(!isRowInViewPort(_3ade)){
focusCellRange(_3ae0,_3adf,_3ade,_3ae1);
}else{
if(!isColInViewPort(_3adf)){
focusCellRange(_3ade,_3ae1,_3ae0,_3adf);
}
}
}else{
var _3ade=currRow;
var _3adf=currCol;
var _3ae0=currRow;
var _3ae1=currCol;
if(!isRowInViewPort(_3ade)){
focusCell(_3ade,_3adf);
}else{
if(!isColInViewPort(_3adf)){
focusCell(_3ade,_3adf);
}
}
}
var nvp="sr="+_3ade+"&er="+_3ae0+"&sc="+_3adf+"&ec="+_3ae1+"&currRow="+currRow+"&currCol="+currCol+"&isColSelected="+isColumnSelected;
nvp+="&currenttime="+CURRENTTIME+"&sheetname="+encodeURIComponent(CURRSHEETNAME);
nvp+="&action="+_3ada+"&docid="+DOCUMENT_ID+"&viewType="+getViewType()+"&docowner="+CURR_DOC_OWNERNAME;
postAjax(_3adb,ctxpath+"pages/formatcells.jsp",nvp);
}
function updateFormatCellsDialog(){
var _3ae3=document.forms["formatCellsForm"];
var _3ae4=_3ae3.formatType.value;
currFormatType=_3ae4;
setFormatType();
var _3ae5=_3ae3.formatString.value;
var _3ae6=_3ae3.negFrmt.value;
var _3ae7=_3ae3.langCntry.value;
var _3ae8=_3ae3.isGroupingUsed.value;
var _3ae9=_3ae3.decimals.value;
var _3aea=_3ae3.leadingzeroes.value;
var _3aeb=_3ae3.symbol.value;
var _3aec=_3ae3.dateFrmt.value;
var _3aed=_3ae3.timeFrmt.value;
var _3aee=_3ae3.regionalFrmt.value;
customFormatString=_3ae5;
if(isAutomatic){
}else{
if(isNumberFormat||isCurrency){
setSelectedOption(_3ae3["language_"+_3ae4],_3ae7);
if(isNumberFormat){
$("#decimals_format_numbers").zspinner("setValue",_3ae9);
$("#leading_zeroes_format_numbers").zspinner("setValue",_3aea);
$("#negative_format_numbers").zcombo("setSelectedIndex",_3ae6);
}
if(isCurrency){
$("#decimals_format_currency").zspinner("setValue",_3ae9);
$("#leading_zeroes_format_currency").zspinner("setValue",_3aea);
$("#negative_format_currency").zcombo("setSelectedIndex",_3ae6);
}
if(_3ae8=="true"){
_3ae3["thousands_"+_3ae4].checked=true;
}else{
_3ae3["thousands_"+_3ae4].checked=false;
}
setSelectedOption(_3ae3["language_"+_3ae4],_3ae7);
if(isCurrency){
setSelectedOption(_3ae3["currencySymbol"],_3aeb);
}
}else{
if(isDateTime){
setSelectedOption(_3ae3["time"],_3aed);
setSelectedOption(_3ae3["date"],_3aec);
setSelectedOption(_3ae3["language_"+_3ae4],_3ae7);
}else{
if(isPercentage){
$("#decimals_format_percentage").zspinner("setValue",_3ae9);
setSelectedOption(_3ae3["language_"+_3ae4],_3ae7);
}else{
if(isFraction){
setSelectedOption(_3ae3["fraction_Format"],_3ae5);
}else{
if(isScientific){
$("#decimals_format_scientific").zspinner("setValue",_3ae9);
setSelectedOption(_3ae3["language_"+_3ae4],_3ae7);
}else{
if(isRegional){
setSelectedOption(_3ae3["country"],_3ae7);
setSelectedOption(_3ae3["regionalFormat"],_3aee);
}else{
if(isCustom){
customFormatString=_3ae5;
}
}
}
}
}
}
}
}
toggleFormatType(getObj(_3ae4));
getObj("formatCategory").focus();
}
function showCustomFormatDialog(){
var _3aef=getXMLHttpRequest();
_3aef.onreadystatechange=function(){
if(_3aef.readyState==4){
var _3af0=_3aef.responseText;
showDialog(_3af0,"position=absmiddle,title="+jsTitleMsg.FormatCells+",closeOnEscKey=no,modal=yes",undefined,callFormatCellsDialogOnClose);
}
};
postAjax(_3aef,ctxpath+"pages/custom.jsp","");
}
function callFormatCellsDialogOnClose(){
if(isDialogShow){
showFormatCellsDialog("showCustomTab");
}
}
function toggleFormatType(list){
if(list!=null){
if(currFormatType!=""){
getObj(currFormatType+"_table").style.display="none";
getObj(currFormatType).className="";
}
if(list.id=="formatCategory"){
list=(list.options[list.selectedIndex].value);
}else{
list=list.value;
}
var el=getObj(list);
el.className="selected";
currFormatType=el.id;
setFormatType();
$("#"+el.id+"_table").show();
setSelectedOption(getObj("formatCategory"),currFormatType);
if(isCustom){
submitCustomFormatData(undefined,"readCustomFormats");
}else{
submitCustomFormatData(undefined,"generate");
}
}
}
function toggleformatPreviewTab(id){
if(id=="tab1"){
getObj("previewDIV").style.display="";
getObj("formatCodeDIV").style.display="none";
var _3af4=getObj(id);
if((_3af4.className).indexOf("selected")==-1){
_3af4.className+=" selected";
var _3af5=getObj("tab2").className;
var _3af6=_3af5.replace("selected","");
getObj("tab2").className=_3af6;
}
}else{
if(id=="tab2"){
getObj("formatCodeDIV").style.display="";
getObj("previewDIV").style.display="none";
var _3af7=getObj(id);
if((_3af7.className).indexOf("selected")==-1){
_3af7.className+=" selected";
var _3af5=getObj("tab1").className;
var _3af6=_3af5.replace("selected","");
getObj("tab1").className=_3af6;
}
}
}
}
function setSelectedOption(obj,value){
if(obj!=undefined){
for(i=0;i<obj.options.length;i++){
var _3afa=obj.options[i].value.toUpperCase();
if(_3afa==value.toUpperCase()){
obj.selectedIndex=i;
return true;
}
}
}
return false;
}
function setSelectedOptionIndex(obj,value){
obj.selectedIndex=value;
return true;
}
function getSelectedOptionIndex(obj){
var _3afe=obj.selectedIndex;
return _3afe;
}
function getSelectedOption(obj){
var index=obj.selectedIndex;
var _3b01;
if(index!=-1){
_3b01=obj.options[index].value;
}
return _3b01;
}
var currentcustomFormatSPAN="";
function customFormatActions(cnt,obj){
var id=obj.id;
var _3b05=id.split("_")[1];
cnt=_3b05;
var _3b06=getObj("customFormatSPAN_"+cnt);
if(id.indexOf("customFormatEditTD_")!=-1){
resetEditCustomFormat();
currentcustomFormatSPAN=_3b06;
_3b06.style.display="none";
getObj("customFormatEditTD_"+cnt).style.display="none";
getObj("customFormatDeleteTD_"+cnt).style.display="none";
getObj("customFormatINPUT_"+cnt).innerHTML=_3b06.innerHTML;
getObj("customFormatINPUT_"+cnt).style.display="";
getObj("customFormatUpdateTD_"+cnt).style.display="";
getObj("customFormatCancelTD_"+cnt).style.display="";
getObj("customFormatINPUT_"+cnt).focus();
}else{
if(id.indexOf("customFormatUpdateTD_")!=-1){
var _3b07=getObj("customFormatINPUT_"+cnt).value;
if(_3b07.trim()==""){
getObj("customFormatINPUT_"+cnt).focus();
showAlertDialog(jsMsg["FormatCells.CustomFormat.AlertMessage"]);
return;
}
if(isCustomFormatExists(_3b07)){
getObj("customFormatINPUT_"+cnt).focus();
return;
}
var _3b08=getObj("customFormatTR_"+cnt);
var index=parseInt(_3b08.getAttribute("index"));
updateCustomFormat(index,_3b07);
}else{
if(id.indexOf("customFormatCancelTD_")!=-1){
var _3b0a=getObj("customFormatINPUT_"+cnt);
_3b06.style.display="";
getObj("customFormatEditTD_"+cnt).style.display="";
getObj("customFormatDeleteTD_"+cnt).style.display="";
_3b0a.style.display="none";
getObj("customFormatUpdateTD_"+cnt).style.display="none";
getObj("customFormatCancelTD_"+cnt).style.display="none";
}else{
if(id.indexOf("customFormatDeleteTD_")!=-1){
var _3b08=getObj("customFormatTR_"+cnt);
var index=parseInt(_3b08.getAttribute("index"));
deleteCustomFormat(index,cnt);
}
}
}
}
}
function updateCustomFormatEnter(obj,e){
var key;
var _3b0e;
if(window.event){
key=window.event.keyCode;
}else{
if(e){
key=e.which;
}else{
return true;
}
}
_3b0e=String.fromCharCode(key);
if(key==13){
if(obj.id=="customFormat"){
submitCustomFormatData(undefined,"saveCustomFormats");
}else{
var arr=obj.id.split("_");
var cnt=arr[1];
var _3b11=getObj("customFormatTR_"+cnt);
var _3b12=getObj(_3b11).innerHTML;
if((_3b12).trim()==""){
showAlertDialog(jsMsg["FormatCells.CustomFormat.AlertMessage"]);
return;
}
var index=_3b11.getAttribute("index");
var _3b14=getObj("customFormatINPUT_"+cnt).value;
updateCustomFormat(index,_3b14);
}
}
}
function updateCustomFormat(index,_3b16){
var nvp=constructNVP();
nvp+="&index="+index;
var reg=/^\[.*\]$/g;
if(reg.exec(_3b16)){
_3b16=_3b16+" ";
}
nvp+="&format="+_3b16;
doFormatCells(nvp,"updateCustomFormats");
}
function deleteCustomFormat(index,cnt){
var nvp=constructNVP();
nvp+="&index="+index;
doFormatCells(nvp,"deleteCustomFormats",cnt);
}
function resetCustomFormatTRIndex(cnt){
var _3b1d=getObj("customFormatTbl");
var _3b1e=_3b1d.rows.length;
var index=0;
for(var i=0;i<_3b1e;i++){
var _3b21=_3b1d.rows[i];
_3b21.setAttribute("index",index);
index++;
}
}
function submitCustomFormatData(_3b22,_3b23,obj){
if(_3b22=="negative_format_numbers"||_3b22=="negative_format_currency"){
setStyleToSelectfromOption(_3b22);
}
isRegionalFormatChange=_3b22=="regionalFormat"?false:true;
isDateTimeFormatChange=_3b22=="dateTimeFormat"?false:true;
var nvp=constructNVP();
if(_3b23=="generate"||_3b23=="refresh"){
_3b22=document.forms["formatCellsForm"];
}else{
if(isDateTime){
var _3b26=getObj("date");
var _3b27=getObj("time");
var _3b28=getSelectedOptionIndex(_3b26);
var _3b29=getSelectedOptionIndex(_3b27);
if((_3b26.options[_3b28].value=="none")&&(_3b27.options[_3b29].value=="none")){
showAlertDialog(jsMsg["FormatCells.DateTime.AlertMessage"]);
return false;
}
}
}
if(isAutomatic){
nvp+=appendNVPforAuto(_3b22);
}else{
if(isNumberFormat){
nvp+=appendNVPforNumber(_3b22);
}else{
if(isCurrency){
nvp+=appendNVPforCurrency(_3b22);
}else{
if(isDateTime){
nvp+=appendNVPforDateTime(_3b22);
}else{
if(isPercentage){
nvp+=appendNVPforPercentage(_3b22);
}else{
if(isFraction){
nvp+=appendNVPforFraction(_3b22);
}else{
if(isScientific){
nvp+=appendNVPforScientific(_3b22);
}else{
if(isText){
nvp+=appendNVPforText(_3b22);
}else{
if(isRegional){
nvp+=appendNVPforRegional(_3b22);
}else{
if(isSpecial){
nvp+=appendNVPforSpecial(_3b22);
}else{
if(isCustom){
if(_3b23!="readCustomFormats"){
if(_3b23=="saveCustomFormats"||_3b23=="saveAndApplyCustomFormats"){
var _3b2a=getObj("customFormat").value;
_3b2a=_3b2a.replace(/,/g,"");
if(_3b2a.trim()==""){
getObj("customFormat").focus();
showAlertDialog(jsMsg["FormatCells.CustomFormat.AlertMessage"]);
return;
}
if(_3b23=="saveAndApplyCustomFormats"){
getObj("UpdatingFrmt").style.display="block";
}
}
var _3b2b=appendNVPforCustom(_3b22,_3b23);
if(!_3b2b){
return;
}else{
nvp+=_3b2b;
}
}
}
}
}
}
}
}
}
}
}
}
}
doFormatCells(nvp,_3b23);
return false;
}
function constructNVP(_3b2c,_3b2d,_3b2e,endR,endC){
if(isUndefined(_3b2c)){
_3b2c="false";
}
var _3b31=getAvailableStartRow();
var _3b32=getAvailableEndRow();
if(isUndefined(_3b2d)){
if(isCellRange()){
var _3b33=getCellRange();
_3b2d=_3b33.startRow;
_3b2e=_3b33.startCol;
endR=_3b33.endRow;
endC=_3b33.endCol;
}else{
_3b2d=endR=currRow;
if(isCellMerged(currRow,currCol)){
_3b2e=getMergedStartCol(currRow,currRow,currCol);
endC=getMergedEndCol(currRow,currRow,currCol);
}else{
_3b2e=endC=currCol;
}
}
}
var nvp="docid="+DOCUMENT_ID+"&sheetname="+encodeURIComponent(CURRSHEETNAME)+"&curtime="+CURRENTTIME+"&viewType="+getViewType();
nvp+="&readwrite="+ALLOW_TO_WRITE+"&docowner="+CURR_DOC_OWNERNAME+"&collabid="+COLLAB_ID+"&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&currentSelection="+getCurrentSelection();
nvp+="&afterRTC="+_3b2c+"&startColumn="+_3b2e+"&endColumn="+endC+"&startRow="+_3b2d+"&endRow="+endR+"&currRow="+currRow+"&currCol="+currCol+"&isDocSaved="+isDocSaved();
nvp+="&availableStartRow="+_3b31+"&availableEndRow="+_3b32+"&totCols="+totCols;
nvp+="&isColSelected="+isColSelected()+"&isRowSelected="+isRowSelected();
if(_3b2c=="true"){
nvp+="&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+encodeURIComponent(RTCSHEETNAME);
}
return nvp;
}
function appendNVPforAuto(_3b35){
var nvp="&formatType=AUTOMATIC";
return nvp;
}
function appendNVPforNumber(_3b37,_3b38,_3b39,_3b3a,_3b3b,_3b3c){
var nvp="&formatType=NUMBER";
if(!isUndefined(_3b37)){
_3b38=$("#negative_format_numbers").zcombo("getSelectedIndex");
_3b39=_3b37.thousands_format_numbers.checked;
_3b3a=$("#decimals_format_numbers").zspinner("getValue");
_3b3b=$("#leading_zeroes_format_numbers").zspinner("getValue");
_3b3c=getSelectedOption(_3b37.language_format_numbers);
updateAllLanguageOptions(_3b3c);
}
nvp+="&negFrmt="+_3b38+"&thousandsep="+_3b39+"&decimals="+_3b3a+"&leadingzeroes="+_3b3b+"&language="+_3b3c;
return nvp;
}
function appendNVPforCurrency(_3b3e,_3b3f,_3b40,_3b41,_3b42,_3b43,_3b44){
var nvp="&formatType=CURRENCY";
if(!isUndefined(_3b3e)){
_3b3f=getSelectedOption(_3b3e.currencySymbol);
_3b40=getSelectedOption(_3b3e.negative_format_currency);
_3b41=_3b3e.thousands_format_currency.checked;
_3b42=$("#decimals_format_currency").zspinner("getValue");
_3b43=$("#leading_zeroes_format_currency").zspinner("getValue");
_3b44=getSelectedOption(_3b3e.language_format_currency);
updateAllLanguageOptions(_3b44);
}
nvp+="&symbol="+_3b3f+"&negFrmt="+_3b40+"&thousandsep="+_3b41+"&decimals="+_3b42+"&leadingzeroes="+_3b43+"&language="+_3b44;
return nvp;
}
function appendNVPforDateTime(_3b46,_3b47,_3b48,_3b49,_3b4a){
var nvp="&formatType=DATETIME";
var _3b4c="";
if(!isUndefined(_3b46)&&_3b4a!="true"){
var _3b4d=getSelectedOption(_3b46.date);
var _3b4e=getSelectedOption(_3b46.time);
if(_3b4e=="none"){
nvp="&formatType=DATE";
}else{
_3b4c=_3b4e;
}
if(_3b4d=="none"){
if(_3b4e!="none"){
nvp="&formatType=TIME";
}
}else{
if(_3b4c!=""){
_3b4c=_3b4d+" "+_3b4c;
}else{
_3b4c=_3b4d;
}
}
_3b49=getSelectedOption(_3b46.language_format_datetime);
updateAllLanguageOptions(_3b49);
}else{
_3b4c=_3b48;
nvp="&formatType="+_3b47;
}
nvp+="&format="+_3b4c+"&language="+_3b49;
return nvp;
}
function appendNVPforPercentage(_3b4f,_3b50,_3b51,_3b52,_3b53){
var nvp="&formatType=PERCENTAGE";
if(!isUndefined(_3b4f)){
_3b50=$("#decimals_format_percentage").zspinner("getValue");
_3b53=getSelectedOption(_3b4f.language_format_percentage);
updateAllLanguageOptions(_3b53);
}
nvp+="&decimals="+_3b50+"&language="+_3b53;
return nvp;
}
function appendNVPforFraction(_3b55,_3b56){
if(!isUndefined(_3b55)){
format=getSelectedOption(_3b55["fraction_Format"]);
}else{
format=_3b56;
}
var nvp="&formatType=FRACTION"+"&format="+format;
return nvp;
}
function appendNVPforScientific(_3b58,_3b59,_3b5a){
var nvp="&formatType=SCIENTIFIC";
if(!isUndefined(_3b58)){
_3b59=$("#decimals_format_scientific").zspinner("getValue");
_3b5a=getSelectedOption(_3b58.language_format_scientific);
updateAllLanguageOptions(_3b5a);
}
nvp+="&decimals="+_3b59+"&language="+_3b5a;
return nvp;
}
function appendNVPforText(_3b5c){
var nvp="&formatType=TEXT";
return nvp;
}
function appendNVPforRegional(_3b5e,_3b5f,_3b60,_3b61){
var nvp="&formatType=REGIONAL";
if(!isUndefined(_3b5e)){
_3b60=getSelectedOption(_3b5e["country"]);
_3b61=getSelectedOption(_3b5e["regionalFormat"]);
}
nvp+="&language="+_3b60+"&format="+_3b61;
return nvp;
}
function appendNVPforCustom(_3b63,_3b64,_3b65){
var nvp="&formatType=CUSTOM";
if(_3b65!="true"){
if(_3b64=="saveCustomFormats"||_3b64=="saveAndApplyCustomFormats"){
_3b63=getObj("customFormat").value;
if(_3b64=="saveCustomFormats"&&cusFormatStore!=undefined){
if(isCustomFormatExists(_3b63)){
getObj("customFormat").focus;
return false;
}
}
}else{
var _3b67=getObj("customFormats");
if(!_3b67){
closeDialog(destroyZohoCompInDialog);
return false;
}else{
_3b63=getObj("customFormats").value;
}
}
}
var reg=/^\[.*\]$/g;
if(reg.exec(_3b63)){
_3b63=_3b63+" ";
}
nvp+="&format="+doit(_3b63,false);
return nvp;
}
function doFormatCells(nvp,_3b6a,_3b6b){
if(!isAnyCategorySelected&&_3b6b!="true"){
closeDialog(destroyZohoCompInDialog);
return;
}
if(isUndefined(_3b6a)){
_3b6a="";
loadon();
}
isDialogShow=_3b6a=="saveAndApplyCustomFormats"?false:true;
var _3b6c;
var _3b6d=new getXmlhttp();
_3b6d.onreadystatechange=function(){
if(_3b6d.readyState==4){
var _3b6e=_3b6d.responseText;
if(_3b6e==showErrorPanelMsg){
handleServerError("ERROR",_3b6d.responseText,true);
}else{
if(_3b6a=="generate"||_3b6a=="refresh"){
var _3b6f=_3b6d.responseXML;
var nodes=_3b6f.firstChild.childNodes;
var _3b71;
var _3b72;
var _3b73;
var _3b74;
var _3b75;
var _3b76;
var _3b77;
for(var i=0;i<nodes.length;i++){
var _3b79=nodes[i].nodeName;
if(_3b79=="formatCode"){
var _3b7a=nodes[i].firstChild.nodeValue;
}else{
if(_3b79=="preview"){
var _3b7b=nodes[i].firstChild.nodeValue;
}else{
if(_3b79=="color"){
var color=nodes[i].firstChild.nodeValue;
}else{
if(_3b79=="firstOption"){
_3b71=nodes[i].firstChild.nodeValue;
}else{
if(_3b79=="secondOption"){
_3b72=nodes[i].firstChild.nodeValue;
}else{
if(_3b79=="thirdOption"){
_3b73=nodes[i].firstChild.nodeValue;
}else{
if(_3b79=="fourthOption"){
_3b74=nodes[i].firstChild.nodeValue;
}else{
if(_3b79=="fifthOption"){
_3b75=nodes[i].firstChild.nodeValue;
}else{
if(_3b79=="regionalFormat"){
_3b76=JSON.parse((nodes[i].firstChild.nodeValue));
}else{
if(_3b79=="dateTimePatterns"){
_3b77=JSON.parse((nodes[i].firstChild.nodeValue));
}
}
}
}
}
}
}
}
}
}
}
if(isCurrency){
var _3b7d=$("#negative_format_currency option");
$("#negative_format_currency option").eq(0).text(_3b71);
$("#negative_format_currency option").eq(1).text(_3b72);
$("#negative_format_currency option").eq(2).text(_3b73);
$("#negative_format_currency option").eq(3).text(_3b74);
$("#negative_format_currency option").eq(4).text(_3b75);
$("#negative_format_currency").zcombo("refresh");
}
if(isNumberFormat){
$("#negative_format_numbers option").eq(0).text(_3b71);
$("#negative_format_numbers option").eq(1).text(_3b72);
$("#negative_format_numbers option").eq(2).text(_3b73);
$("#negative_format_numbers option").eq(3).text(_3b74);
$("#negative_format_numbers option").eq(4).text(_3b75);
$("#negative_format_numbers").zcombo("refresh");
}
var size=0;
if(isRegionalFormatChange&&isRegional){
var _3b7f=getObj("regionalFormat");
for(var key in _3b76){
size=size+1;
var _3b81=key;
var _3b82=_3b76[key];
_3b7f.options[size-1]=new Option(jsMsg[_3b81],_3b81);
if(size==1){
_3b7f.options[0].selected="selected";
}
}
if(size==0){
_3b7f.options.length=0;
_3b7b="";
_3b7a="";
}else{
var _3b83=document.forms["formatCellsForm"];
setSelectedOption(_3b83["regionalFormat"],_3b83.regionalFrmt.value);
_3b83.regionalFrmt.value="";
submitCustomFormatData("regionalFormat","generate");
}
}
if(isDateTimeFormatChange&&isDateTime){
var _3b84=getObj("date");
var _3b85=getObj("time");
var _3b86=_3b77["datePatterns"];
var _3b87=_3b77["timePatterns"];
_3b84.options.length=_3b86.length;
_3b85.options.length=_3b87.length;
for(var i=0;i<_3b86.length;i++){
_3b84.options[i]=new Option(_3b86[i],_3b86[i]);
_3b84.options[0].selected="selected";
}
for(var i=0;i<_3b87.length;i++){
_3b85.options[i]=new Option(_3b87[i],_3b87[i]);
_3b85.options[0].selected="selected";
}
var _3b83=document.forms["formatCellsForm"];
var _3b88=_3b83.dateFrmt.value;
var _3b89=_3b83.timeFrmt.value;
setSelectedOption(_3b83["time"],_3b89);
setSelectedOption(_3b83["date"],_3b88);
if(_3b89=="none"&&_3b88=="none"){
getObj("previewDIV").innerHTML="";
getObj("formatCodeText").value="";
return;
}
_3b83.dateFrmt.value="";
_3b83.timeFrmt.value="";
submitCustomFormatData("dateTimeFormat","generate");
}
getObj("previewDIV").innerHTML=escapeSpecialCharacters(_3b7b);
if(color!="null"){
getObj("previewDIV").style.color=color;
}else{
getObj("previewDIV").style.color="#000000";
}
getObj("formatCodeText").value=_3b7a;
}else{
if(_3b6a=="readCustomFormats"){
var _3b8a=0;
var _3b8b=0;
var _3b8c="selected";
var _3b8d=getObj("customFormatsTD");
var _3b8e=false;
if(_3b6e!=""){
var _3b8f=JSON.parse(_3b6e);
var _3b90=_3b8f.USERLEVELCUSTOMFORMATS;
cusFormatStore=_3b90;
var _3b91=_3b8f.DOCUMENTLEVELCUSTOMFORMATS;
var temp1="submit";
var temp="generate";
var _3b94="<select id='customFormats' size='9' style='width:100%' onchange="+"\"return submitCustomFormatData(undefined,"+"'"+temp+"'"+");"+"\""+"ondblclick="+"\"return submitCustomFormatData(undefined,"+"'"+temp1+"'"+");"+"\""+">";
var _3b95=getViewType();
if(!(_3b95=="PUBLIC_VIEW"||_3b95=="REMOTE_VIEW"||_3b95=="REMOTE_SAVE_VIEW")){
if(_3b90){
_3b8a=_3b90.length;
if(_3b8a>0){
_3b8d.vAlign="top";
var _3b96="";
_3b94+="<optgroup label='"+jsMsg["FormatCells.UserLevelFormats"]+"'>";
for(var i=0;i<_3b8a;i++){
if(i){
_3b8c="";
}
_3b96=_3b90[i];
if(_3b96 instanceof Array){
_3b96=addDotInLastOfFmtCode(_3b90[i]);
}else{
_3b96=escapeSpecialCharacters(addDotInLastOfFmtCode(_3b90[i]));
}
_3b94+="<option value='"+_3b90[i]+"'"+"title ='"+_3b90[i]+"'"+_3b8c+">"+_3b96+"</option>";
}
_3b8c="";
_3b94+="</optgroup>";
getObj("manageBtn").style.display="block";
}
}
}
if(_3b91!=undefined){
_3b8b=_3b91.length;
if(_3b8b>0){
_3b8d.vAlign="top";
if(!(_3b95=="PUBLIC_VIEW"||_3b95=="REMOTE_VIEW"||_3b95=="REMOTE_SAVE_VIEW")){
_3b94+="<optgroup label='"+jsMsg["FormatCells.DocumentLevelFormats"]+"'>";
}
for(var i=0;i<_3b8b;i++){
if(i!=0){
_3b8c="";
}
if(customFormatString!=""&&_3b91[i]==customFormatString){
_3b8c="selected";
_3b8e=true;
customFormatString="";
}
_3b94+="<option value='"+_3b91[i]+"'"+"title ='"+_3b91[i]+"'"+_3b8c+">"+escapeSpecialCharacters(addDotInLastOfFmtCode(_3b91[i]))+"</option>";
}
_3b8c="";
_3b94+="</optgroup>";
if(_3b8a==0){
getObj("manageBtn").style.display="none";
getObj("addBtn").style.display="block";
}
}
}
_3b94+="</select>";
_3b8d.innerHTML=_3b94;
}
if(_3b8b==0&&_3b8a==0){
_3b8d.vAlign="middle";
_3b8d.className="manageFrmt";
_3b8d.innerHTML="0 "+jsMsg["FormatCells.CustomFormats"]+"<br /><a href='#' onclick='showCustomFormatDialog()' class='dialogLink'>"+jsMsg["AddNew"]+"</a>";
getObj("manageBtn").style.display="none";
getObj("addBtn").style.display="none";
getObj("previewDIV").innerHTML="";
getObj("formatCodeText").value="";
}else{
submitCustomFormatData(undefined,"generate");
}
if(_3b95=="PUBLIC_VIEW"||_3b95=="REMOTE_VIEW"||_3b95=="REMOTE_SAVE_VIEW"){
getObj("manageBtn").style.display="none";
getObj("addBtn").style.display="none";
}
}else{
if(_3b6a=="saveCustomFormats"){
if(_3b6e=="FormatNotSupported"){
showAlertDialog(jsMsg["FormatCells.CustomFormat.AlertMessage"]);
return;
}
var _3b97=getObj("customFormat");
var _3b8f=JSON.parse(_3b6e);
if(jQuery.isEmptyObject(_3b8f)){
showAlertDialog(jsMsg["FormatCells.CustomFormat.AlertMessage"]);
return;
}
var cnt=_3b8f.COUNT;
var _3b99=_3b8f.CUSTOMFORMAT;
if(isCustomFormatExists(_3b99)){
getObj("customFormat").focus();
return;
}
var _3b9a=getObj("customFormatTR");
if(_3b9a!=null&&!isUndefined(_3b9a)){
var _3b9b=_3b9a.parentNode;
_3b9b.removeChild(_3b9a);
}
var _3b9c=getObj("customFormatTbl");
var _3b9d=_3b9c.rows.length;
var _3b9e=getObj("customFormatTBody");
if(cusFormatStore!=undefined){
cusFormatStore.push(_3b99);
}else{
cusFormatStore=new Array();
cusFormatStore.push(_3b99);
}
_3b9a=document.createElement("TR");
_3b9a.id="customFormatTR_"+_3b9d;
_3b9a.className="trOdd ht";
_3b9a.setAttribute("index",cnt);
var _3b9f=_3b99;
if(_3b9f instanceof Array){
_3b9f=_3b99;
}else{
_3b9f=escapeSpecialCharacters(_3b99);
}
var _3ba0=document.createElement("TD");
_3ba0.className="breakWrap";
_3ba0.style.width="250px";
_3ba0.style.valign="top";
_3ba0.id="customFormatTD_"+_3b9d;
_3ba0.innerHTML="<textarea style='display: none;'  id='customFormatINPUT_"+_3b9d+"' onkeypress='javascript:updateCustomFormatEnter(this, event);' class='editCusFormat'></textarea><span title='"+_3b9f+"' id='customFormatSPAN_"+_3b9d+"'>"+_3b9f+"</span></td>";
_3b9a.appendChild(_3ba0);
var _3ba1=document.createElement("TD");
_3ba1.style.width="80px";
_3ba1.style.valign="top";
_3ba1.align="center";
_3ba1.innerHTML="<a href='javascript:void(0);'  onclick='customFormatActions(0, this);' id='customFormatEditTD_"+_3b9d+"' class='trActionLink'>Edit</a><a href='javascript:void(0);'   onclick='customFormatActions(0, this);' style='display: none;' id='customFormatUpdateTD_"+_3b9d+"' class='trActionLink'>Update</a><span class='linkSep'> | </span><a href='javascript:void(0);' onclick='customFormatActions(0, this);' style='display: none;' id='customFormatCancelTD_"+_3b9d+"' class='trActionLink'  >Cancel</a><a href='javascript:void(0);' onclick='customFormatActions(0, this);' id='customFormatDeleteTD_"+_3b9d+"' class='trActionLink'  >Delete</a>";
_3b9a.appendChild(_3ba1);
_3b9e.appendChild(_3b9a);
_3b97.value="";
}else{
if(_3b6a=="updateCustomFormats"){
if(_3b6e=="FormatNotSupported"){
showAlertDialog(jsMsg["FormatCells.CustomFormat.AlertMessage"]);
return;
}
var _3b8f=JSON.parse(_3b6e);
if(jQuery.isEmptyObject(_3b8f)){
showAlertDialog(jsMsg["FormatCells.CustomFormat.AlertMessage"]);
return;
}
var cnt=_3b8f.COUNT;
var _3b99=_3b8f.CUSTOMFORMAT;
var _3ba2=getObj("customFormatSPAN_"+cnt);
var _3b97=getObj("customFormatINPUT_"+cnt);
removeFormatFromClientStore(_3ba2.innerHTML);
cusFormatStore.push(_3b97.value);
var _3ba3=_3b99;
if(_3ba3 instanceof Array){
_3ba3=_3b99;
}else{
_3ba3=escapeSpecialCharacters(_3b99);
}
_3ba2.innerHTML=_3ba3;
_3ba2.style.display="";
getObj("customFormatEditTD_"+cnt).style.display="";
getObj("customFormatDeleteTD_"+cnt).style.display="";
_3b97.style.display="none";
getObj("customFormatUpdateTD_"+cnt).style.display="none";
getObj("customFormatCancelTD_"+cnt).style.display="none";
}else{
if(_3b6a=="deleteCustomFormats"){
var cnt=parseInt(_3b6e);
var _3b9a=getObj("customFormatTR_"+cnt);
removeFormatFromClientStore(getObj("customFormatSPAN_"+cnt).innerHTML);
var _3b9b=_3b9a.parentNode;
_3b9b.removeChild(_3b9a);
var _3b9c=getObj("customFormatTbl");
var _3ba4=_3b9c.rows.length;
if(_3ba4==0){
var _3b9e=getObj("customFormatTBody");
_3b9a=document.createElement("TR");
_3b9a.id="customFormatTR";
_3b9a.className="trOdd";
var _3ba5="<td align='center' height='305'> 0 "+jsMsg["FormatCells.CustomFormats"]+"</td>";
_3b9a.innerHTML=_3ba5;
_3b9e.appendChild(_3b9a);
}else{
resetCustomFormatIds();
}
}else{
if(_3b6a=="saveAndApplyCustomFormats"){
isDialogShow=false;
if(_3b6b!="true"&&_3b6e=="FormatNotSupported"){
getObj("UpdatingFrmt").style.display="none";
showAlertDialog(jsMsg["FormatCells.CustomFormat.AlertMessage"]);
return;
}
if(_3b6b!="true"){
getObj("UpdatingFrmt").style.display="none";
closeDialog(destroyZohoCompInDialog);
}
}
if(ISSAMESHEET=="true"){
var _3ba6=JSON.parse(_3b6d.responseText);
updateJson(_3ba6);
if(_3b6b!="true"){
var _3b95=getViewType();
if(_3b95!="THROWAWAY_VIEW"){
setUNDO(_3ba6.undoJson.u);
}
focusSheet();
repeat.setLastAction(_3ba6.repeatJson);
}
}
if(READ_WRITE){
btn_enabled();
}
if(_3b6b!="true"){
isAnyCategorySelected=false;
isDateTimeFormatChange=true;
closeDialog(destroyZohoCompInDialog);
}
loadoff();
}
}
}
}
}
}
}
};
nvp+="&action="+_3b6a;
nvp+="&actionMode="+"FORMATCELLS";
nvp=appendCSRFToURL(nvp);
postAjax(_3b6d,ctxpath+"formatcells.do",nvp);
}
function setStyleToSelectfromOption(ele){
var _3ba8=document.getElementById(ele);
var jEle="#"+ele;
var i=$(jEle).zcombo("getSelectedIndex");
_3ba8.style.color=_3ba8.options[i].style.color;
$(jEle).zcombo("refresh");
}
function addDotInLastOfFmtCode(_3bab){
var _3bac=30;
if(_3bab.length>_3bac){
_3bab=_3bab.slice(0,_3bac-_3bab.length);
_3bab=_3bab+"...";
}
return _3bab;
}
function isCustomFormatExists(_3bad){
if(cusFormatStore!=undefined){
for(var i=0;i<cusFormatStore.length;i++){
if(cusFormatStore[i]==_3bad){
showAlertDialog(jsMsg["FormatCells.CustomFormat.AlreadyExist"]);
return true;
}
}
}
}
function removeFormatFromClientStore(_3baf){
if(cusFormatStore!=undefined){
for(var i=0;i<cusFormatStore.length;i++){
if(cusFormatStore[i]==_3baf){
cusFormatStore.splice(i,1);
}
}
}
}
function resetEditCustomFormat(){
if(currentcustomFormatSPAN==""){
return;
}
var _3bb1=currentcustomFormatSPAN.id.split("_")[1];
getObj("customFormatSPAN_"+_3bb1).style.display="";
getObj("customFormatEditTD_"+_3bb1).style.display="";
getObj("customFormatDeleteTD_"+_3bb1).style.display="";
getObj("customFormatINPUT_"+_3bb1).style.display="none";
getObj("customFormatUpdateTD_"+_3bb1).style.display="none";
getObj("customFormatCancelTD_"+_3bb1).style.display="none";
}
function updateAllLanguageOptions(_3bb2){
getObj("language_format_numbers").value=_3bb2;
getObj("language_format_currency").value=_3bb2;
getObj("language_format_datetime").value=_3bb2;
getObj("language_format_percentage").value=_3bb2;
getObj("language_format_scientific").value=_3bb2;
}
function resetCustomFormatIds(){
var _3bb3=getObj("customFormatTBody");
var _3bb4=_3bb3.getElementsByTagName("TR");
var len=0;
var i=0;
var index=0;
while(_3bb4.length>len){
var trObj=_3bb4[len];
if(trObj.id.indexOf("customFormatTR_")!=-1){
trObj.id="customFormatTR_"+i;
trObj.setAttribute("index",i);
var _3bb9=trObj;
var _3bba=_3bb9.getElementsByTagName("TD");
for(var j=0;j<_3bba.length;j++){
var tdObj=_3bba[j];
if(tdObj.id.indexOf("customFormatTD_")!=-1){
tdObj.id="customFormatTD_"+i;
}
}
var _3bbd=_3bb9.getElementsByTagName("SPAN");
for(var k=0;k<_3bbd.length;k++){
var _3bbf=_3bbd[k];
if(_3bbf.id.indexOf("customFormatSPAN_")!=-1){
_3bbf.id="customFormatSPAN_"+i;
}
}
var _3bc0=_3bb9.getElementsByTagName("TEXTAREA");
for(var m=0;m<_3bc0.length;m++){
var _3bc2=_3bc0[m];
if(_3bc2.id.indexOf("customFormatINPUT_")!=-1){
_3bc2.id="customFormatINPUT_"+i;
}
}
var _3bc3=_3bb9.getElementsByTagName("A");
for(var n=0;n<_3bc3.length;n++){
var aObj=_3bc3[n];
if(aObj.id.indexOf("customFormatEditTD_")!=-1){
aObj.id="customFormatEditTD_"+i;
if(browser_ie){
aObj.onclick=function(){
customFormatActions(i,this);
};
}else{
aObj.setAttribute("onclick","customFormatActions("+i+", this);");
}
}
if(aObj.id.indexOf("customFormatUpdateTD_")!=-1){
aObj.id="customFormatUpdateTD_"+i;
if(browser_ie){
aObj.onclick=function(){
customFormatActions(i,this);
};
}else{
aObj.setAttribute("onclick","customFormatActions("+i+", this);");
}
}
if(aObj.id.indexOf("customFormatCancelTD_")!=-1){
aObj.id="customFormatCancelTD_"+i;
if(browser_ie){
aObj.onclick=function(){
customFormatActions(i,this);
};
}else{
aObj.setAttribute("onclick","customFormatActions("+i+", this);");
}
}
if(aObj.id.indexOf("customFormatDeleteTD_")!=-1){
aObj.id="customFormatDeleteTD_"+i;
if(browser_ie){
aObj.onclick=function(){
customFormatActions(i,this);
};
}else{
aObj.setAttribute("onclick","customFormatActions("+i+", this);");
}
}
}
i++;
}
len++;
}
}
function destroyZohoCompInDialog(){
var menus=$("[id^=__negative_format_]");
var c;
$.each(menus,function(i){
if($(menus[i]).attr("id")=="__negative_format_currencyMenu"){
c=$((menus[i])).attr("id","__negative_format_currencyMenu");
c.remove();
}
if($(menus[i]).attr("id")=="__negative_format_numbersMenu"){
c=$((menus[i])).attr("id","__negative_format_numbersMenu");
c.remove();
}
});
}
function showReadonlyHint(_3bc9){
if(typeof _3bc9=="undefined"){
_3bc9="";
}
var _3bca=getObj("notifyInfoMsg"+_3bc9);
var _3bcb=getObj("readonlyInfoMessage");
if(_3bca!=null&&_3bcb!=null){
var _3bcc=getObj("infoMsgAro");
var _3bcd=getObj("infoMsgContainer");
if(!ALLOW_TO_WRITE){
if(jsSHARE_VIEW){
_3bcd.innerHTML=jsMsg["ToolbarInfo.Title.Readonly.ShareView"];
}else{
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
_3bcd.innerHTML=jsMsg["ToolbarInfo.Title.Readonly.RemoteView"];
}
}
}
_3bcb.style.visibility="hidden";
_3bcb.style.display="";
_3bcc.style.left=_3bcb.offsetWidth-15;
_3bcb.style.top=(_3bca.offsetTop+_3bca.offsetHeight)-10;
_3bcb.style.left=(_3bca.offsetLeft+_3bca.offsetWidth)-_3bcb.offsetWidth-5;
_3bcb.style.visibility="visible";
}
}
function hideReadonlyHint(){
var _3bce=getObj("readonlyInfoMessage");
if(_3bce!=null){
_3bce.style.display="none";
}
}
var cookieStatusShown=false;
var cookieEnabled=true;
function checkCookieSettings(){
var exp=new Date();
exp.setTime(exp.getTime()-1);
document.cookie="testcookie"+"; expires="+exp.toGMTString();
cookieEnabled=navigator.cookieEnabled;
document.cookie="testcookie=testcookie";
cookieEnabled=(document.cookie.indexOf("testcookie")!=-1)?true:false;
if(!cookieEnabled){
handleServerError("ERROR",replaceParams(jsMsg["Banner.Cookie.Disabled.Message"],new Array("<a target='_blank' href='"+jsMsg.ZohoHomeURL+"zoho_faq.html#13'>","</a>")),true,false);
cookieStatusShown=true;
}
}
var guestStatusShown=false;
function checkGuestViewSettings(){
if(jsGUEST_VIEW){
$("#eP").css("border-top","1px solid #BFCAFF");
var _3bd0=iamurlWithServiceURL+encodeURIComponent("?guestId="+encodeURIComponent(guestEncStr));
var _3bd1="";
var msg=jsMsg["GuestView.banner.info.forReadWriteView"];
if(!IS_WHOLE_DOCUMENT_SHARED_IN_READ_WRITE){
msg=jsMsg["GuestView.banner.info.forReadOnlyView"];
menutabs.sheetbasedtoggle(true);
}
_3bd1=replaceParams(msg,new Array(CURR_DOC_OWNERNAME+"'s","<span class=''>","<a target='_self' href='"+_3bd0+"'>","</a>",guestId,"</span>","<strong>","</strong>"));
handleServerError("INFO",_3bd1,true,true);
guestStatusShown=true;
if(!LOAD_OBJECT_IN_PUBLIC){
getNamedRanges();
}
}
}
function checkTrashViewSettings(){
if(jsTRASH_VIEW){
READ_WRITE=false;
allowSheetSwitch=true;
}
}
var publicMsgShown=false;
function checkPublicViewSettings(){
if(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE){
var _3bd3=getObj("pubEditBtn");
if(_3bd3){
_3bd3.disabled=false;
}
READ_WRITE=false;
ALLOW_TO_WRITE=false;
exprField.readOnly=true;
allowSheetSwitch=true;
if(isPublished){
resizeHScrollbarToDefaultWidth();
editPublicDoc(true,true);
}
if(!isPublished){
var _3bd4="";
if(isPublicEditDoc){
_3bd4="PublicView.Banner.OrgEditDocument.Info";
}else{
_3bd4="PublicView.Banner.ReadOnly.Info";
}
if(!isPublicViewDoc){
var _3bd5=replaceParams(jsMsg[_3bd4],new Array("<strong>","</strong>"));
showBannerMessage("INFO",_3bd5);
publicMsgShown=true;
}
editPublicDoc(true,true);
}
if(!LOAD_OBJECT_IN_PUBLIC){
getNamedRanges();
}
}
}
function setReadOnlyViewSettings(){
if(!jsREMOTE_VIEW&&!jsTHROWAWAY_VIEW&&!jsPUBLIC_VIEW){
READ_WRITE=false;
ALLOW_TO_WRITE=false;
exprField.readOnly=true;
allowSheetSwitch=true;
isReadOnlyViewMode=true;
disableDocMenutab();
hideBannerMessage();
}
}
function documentUtilities(){
if(!cookieStatusShown){
checkCookieSettings();
}
if(!guestStatusShown){
checkGuestViewSettings();
}
checkTrashViewSettings();
if(!publicMsgShown){
checkPublicViewSettings();
}
if(!ALLOW_TO_WRITE&&READ_ONLY_VIEW_MODE){
setReadOnlyViewSettings();
}
if(wmsCommErrorStatus=="true"&&!wmsErrorMsgShown){
wmsErrorMsgShown=true;
handleServerError("ERROR",replaceParams(jsMsg["Banner.ReadOnly.Info.DueToWMSCommunicationException"],new Array("<a href='#' onclick='loadDocument("+DOCUMENT_ID+")'>","</a>")),true,true);
}
}
function isServerComponentLoaded(_3bd6){
if(isDocumentReadyToEdit){
return true;
}else{
return false;
}
}
var TEMP_READ_WRITE=true;
function initServerCompLoadingActivities(_3bd7){
isDocumentReadyToEdit=false;
if(!_3bd7){
TEMP_READ_WRITE=READ_WRITE;
READ_WRITE=false;
}
exprField.readOnly=true;
}
function serverCompLoadedActivities(_3bd8){
isDocumentReadyToEdit=true;
if(!_3bd8){
READ_WRITE=TEMP_READ_WRITE;
}
var _3bd9=getObj("waitmsg");
if(_3bd9!=null){
_3bd9.style.display="none";
}
if(READ_WRITE){
exprField.readOnly=false;
}
if(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE){
READ_WRITE=false;
}
}
function isSheetEditable(_3bda){
if(isServerComponentLoaded(_3bda)){
return READ_WRITE;
}else{
return false;
}
}
function editPublicDoc(_3bdb,_3bdc){
if(_3bdb&&!PUBLIC_EDIT_MODE){
if(_3bdc){
PUBLIC_EDIT_MODE=true;
READ_WRITE=true;
ALLOW_TO_WRITE=false;
exprField.readOnly=false;
isReadOnlyViewMode=false;
setImagePermission();
setChartPermission();
findCallBack();
var _3bdd=getObj("pubEditBtn");
if(_3bdd){
_3bdd.disabled=true;
_3bdd.className="button-disabled";
}
if(!isPublished){
if(isPublicEditDoc){
initPublicDocEdit();
}else{
if(allowExport){
var _3bde=replaceParams(jsMsg["PublicView.Banner.Interactive.Info.SaveToMyAccount.Enabled"],new Array("<strong>","</strong>"));
}else{
var _3bde=replaceParams(jsMsg["PublicView.Banner.Interactive.Info.SaveToMyAccount.Disabled"],new Array("<strong>","</strong>"));
}
showBannerMessage("INFO",_3bde);
}
}
showSaveMessage("disable");
}else{
if(isInOOMode){
editPublicDoc(true,true);
}else{
loadDocumentObject(DOCUMENT_ID,DOCUMENT_NAME,CURRENTTIME,CURR_DOC_OWNERNAME,undefined,true);
}
}
}
if(!isPublished){
resetWorkSheetDim();
}
}
function initPublicDocEdit(){
message(jsMsg.Loading,"block",DOCUMENT_NAME);
var _3bdf=new getXmlhttp();
_3bdf.open("POST",ctxpath+"createpubliccollab.do",true);
_3bdf.onreadystatechange=function(){
if(_3bdf.readyState==4){
var _3be0=_3bdf.responseText;
if(_3be0!=null&&_3be0.trim()!=""){
if(_3be0=="WMS_COMMUNICATION_FAILURE"){
handleServerError("ERROR",replaceParams(jsMsg["Banner.ReadOnly.Info.DueToWMSCommunicationException"],new Array("<a href='"+publicURL+"'","</a>")),true,true);
PUBLIC_EDIT_MODE=false;
}else{
if(_3be0=="INTERNAL_SERVER_ERROR"){
handleServerError("ERROR",jsMsg["error.internal"],true,true);
PUBLIC_EDIT_MODE=false;
}else{
if(_3be0=="COLLABORATORS_LIMIT_EXCEEDED"){
if(_3be1){
_3be1.style.display="";
}
ALLOW_TO_WRITE=false;
var _3be2=getObj("pubEditBtn");
if(_3be2){
_3be2.disabled=false;
_3be2.className="button";
}
PUBLIC_EDIT_MODE=false;
handleServerError("ERROR",jsMsg["Public.Collaborators.Limit.Exceeded"],true,true);
}else{
var _3be1=getObj("pubSaveToAcc");
if(_3be1){
_3be1.style.display="none";
}
ALLOW_TO_WRITE=true;
hideBannerMessage();
var _3be3=getObj("saveMsgPanel");
if(ENABLE_SAVE_MESSAGE&&_3be3){
_3be3.style.display="";
}
var res=eval("("+_3be0+")");
var _3be5=res.COLLAB_ID;
var _zuid=res.ZUID;
if(_zuid){
zuid=_zuid;
}
var _3be7=res.CURRENT_TIME;
if(_3be7&&_3be7!="null"){
CURRENTTIME=_3be7;
}
if(_3be5!=-1){
COLLAB_ID=""+_3be5;
if(ctxpath!="/"){
WebMessanger.setWmsContext("wmssheet");
}
WebMessanger.registerZuid("ST",zuid,LOGINNAME,wmsSilentRegister);
getObj("chat").style.display="";
INSERT_SHEET_ALLOWED=false;
var _3be8=getObj("addSheetBtnTable").getElementsByTagName("td")[0];
_3be8.innerHTML="<a href='javascript:void(0)' class='add_sheet' onClick=javascript:insertSheet('add'); return false; title='"+jsMsg["AddSheet"]+"'><img src='"+IMAGE_PATH+"spacer.gif'></a>";
isReadOnlyViewMode=false;
setImagePermission();
setChartPermission();
sheetopen("open");
}
}
}
}
}
}
};
var param="docid="+DOCUMENT_ID+"&docowner="+CURR_DOC_OWNERNAME+"&docName="+DOCUMENT_NAME+"&currSheet="+CURRSHEETNAME;
_3bdf.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
sendXMLHTTPRequest(_3bdf,param,true,false);
}
var FIND={action:"FIND",startRow:0,startCol:0,startSheet:"",isFirstFind:true,isFromFind:false,isNext:true,dialogOpen:false};
function showSearchBar(){
if(FIND.dialogOpen){
getObj("searchText").focus();
return false;
}
var _3bea=getXMLHttpRequest();
_3bea.open("POST",ctxpath+"pages/find.jsp",true);
_3bea.onreadystatechange=function(){
if(_3bea.readyState==4){
showDialog(_3bea.responseText,"position=absmiddle, title="+jsMsg["Find.Dialog.Title"]+", closeOnEscKey=yes",findCallBack,closeFindDialog);
}
};
FIND.dialogOpen=true;
_3bea.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_3bea.send();
return false;
}
function findCallBack(){
if(FIND.dialogOpen){
getObj("searchText").focus();
getObj("radDown").checked=true;
if(!FIND.isNext){
getObj("radUp").checked=true;
}
clearSearch();
findResetVariables();
FindAndReplaceToggle("Disable");
}
positionDialog();
return false;
}
function searchWord(el){
if(FIND.isNext){
searchNext(el);
}else{
searchPrevious(el);
}
return false;
}
function replaceWord(el){
if((jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE)||isReadOnlyViewMode){
return false;
}
submitSearch(el,"REPLACE");
clearSearch();
return false;
}
function searchNext(el){
FIND.isNext=true;
submitSearch(el,"FIND");
clearSearch();
return false;
}
function searchPrevious(el){
FIND.isNext=false;
submitSearch(el,"FIND");
clearSearch();
return false;
}
function replaceAllWord(el){
if((jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE)||isReadOnlyViewMode){
return false;
}
submitSearch(el,"REPLACEALL");
clearSearch();
return false;
}
function FindAndReplaceToggle(_3bf0){
if(_3bf0=="Enable"){
$("#findBtn").enable();
$("#replaceBtn").enable();
$("#replaceAllBtn").enable();
}else{
$("#findBtn").disable();
$("#replaceBtn").disable();
$("#replaceAllBtn").disable();
}
}
function searchBarKeyUp(ev,el){
var _3bf3=getObj("searchText");
if((_3bf3.value=="")&&(_3bf3.value.length==0)){
FindAndReplaceToggle("Disable");
}else{
if((jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE)||isReadOnlyViewMode){
$("#replaceBtn").disable();
$("#replaceAllBtn").disable();
}else{
FindAndReplaceToggle("Enable");
}
}
}
function searchBarKeyDown(ev,el){
var _3bf6=ev.keyCode;
switch(_3bf6){
case 114:
if(ev.shiftKey){
searchPrevious(el);
}else{
searchNext(el);
}
stopEvt(ev);
break;
case 70:
if(ev.ctrlKey){
if(browser_ie){
disableKeys(ev);
}
stopEvt(ev);
}
break;
case 13:
if(el.id=="searchText"){
searchWord(el);
}else{
if(el.id=="replaceText"){
replaceWord(el);
}else{
if(el.id=="searchArea"){
searchNext(el);
}
}
}
break;
}
return false;
}
function submitSearch(el,_3bf8,_3bf9){
var url=ctxpath+"find.do";
FIND.action=_3bf8;
if(((jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE)||isReadOnlyViewMode)&&_3bf8!="FIND"&&!_3bf9){
return false;
}
if(!_3bf9){
var _3bfb=getObj("searchText").value;
var _3bfc=getObj("replaceText").value;
if(_3bfb==""){
return false;
}
if(!_3bfc){
_3bfc="";
}
var info=ActiveCellInfo;
var row=info.getStartRow();
var col=info.getStartCol();
var _3bf9="actionMode="+_3bf8;
_3bf9+="&row="+row;
_3bf9+="&column="+col;
_3bf9+="&cellValue="+encodeURIComponent(_3bfb);
_3bf9+="&replaceString="+encodeURIComponent(_3bfc);
_3bf9+="&isNext="+FIND.isNext;
_3bf9+="&isMatchCase="+getObj("matchCase").checked.toString();
_3bf9+="&isExactMatch="+getObj("exactMatch").checked.toString();
_3bf9+="&traverseMode="+getObj("searchArea").value;
_3bf9+="&currentTime="+CURRENTTIME;
_3bf9+="&currentSheet="+CURRSHEETNAME;
_3bf9+="&documentId="+DOCUMENT_ID;
_3bf9+="&view="+getObj("VIEW").value;
_3bf9+="&docOwner="+CURR_DOC_OWNERNAME;
_3bf9+="&availableStartRow="+getAvailableStartRow();
_3bf9+="&availableEndRow="+getAvailableEndRow();
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
_3bf9+="&freezedRow="+FREEZED_ROW;
}
_3bf9+="&totCols="+totCols;
var _3c00=true;
if(!getObj("afterRTC").value||getObj("afterRTC").value=="false"){
_3c00=false;
}
_3bf9+="&afterRTC="+_3c00;
if(getObj("apiKey")!=null){
_3bf9+="&apiKeyId="+getObj("apiKey").value;
}
if(jsREMOTE_SAVE_VIEW){
_3bf9+="&RMLOGINNAME="+RMUSER;
}
_3bf9+="&userStateId="+USERSTATEID;
_3bf9+="&collabEdit="+COLLABORATIVE_EDITING;
_3bf9+="&collabid="+COLLAB_ID;
_3bf9+="&readwrite="+ALLOW_TO_WRITE;
}
if(_3bf8=="REPLACEALL"){
showProgressMessage(jsMsg.Updating);
}
var _3c01=new getXmlhttp();
_3c01.onreadystatechange=function(){
if(_3c01.readyState==4){
if(_3c01.responseText){
var _3c02=eval("("+_3c01.responseText+")");
var _3c03=false;
if(_3c02.clientUpdateJson){
if(READ_WRITE){
btn_enabled();
}
updateJson(_3c02.clientUpdateJson);
setUNDO(_3c02.undoJson.u);
_3c03=true;
}
searchCallBack(_3c02.cellRef,el,_3c03);
}
}
};
sendXMLHTTPRequest(_3c01,_3bf9,true,true,url);
return false;
}
function searchCallBack(_3c04,el,_3c06){
currSearchBarEl=el;
hideProgressMessage();
if(!_3c06&&(!_3c04||_3c04.row==-1)){
showSearchResult("NO_DATA_FOUND");
}else{
var row=parseInt(_3c04.row);
var col=parseInt(_3c04.col);
var _3c09=_3c04.sheet;
var _3c0a=getSheetIndex(_3c09);
if(row>-1&&col>-1){
if(FIND.action=="FIND"){
if(getObj("searchArea").value=="row"){
if(FIND.isNext&&((col<currCol)||(row==currRow&&col==currCol))){
getObj("searchEndMsg").innerHTML=replaceParams(jsMsg["Find.EndOfReach"],new Array(jsMsg["Find.End"],jsMsg["Find.Row"],jsMsg["Find.Start"]));
showSearchResult("END_OF_AREA");
}else{
if(!FIND.isNext&&((col>currCol)||(row==currRow&&col==currCol))){
getObj("searchEndMsg").innerHTML=replaceParams(jsMsg["Find.EndOfReach"],new Array(jsMsg["Find.Start"],jsMsg["Find.Row"],jsMsg["Find.End"]));
showSearchResult("END_OF_AREA");
}
}
}else{
if(getObj("searchArea").value=="column"){
if(FIND.isNext&&((row<currRow)||(row==currRow&&col==currCol))){
getObj("searchEndMsg").innerHTML=replaceParams(jsMsg["Find.EndOfReach"],new Array(jsMsg["Find.End"],jsMsg["Find.Column"],jsMsg["Find.Start"]));
showSearchResult("END_OF_AREA");
}else{
if(!FIND.isNext&&((row>currRow)||(row==currRow&&col==currCol))){
getObj("searchEndMsg").innerHTML=replaceParams(jsMsg["Find.EndOfReach"],new Array(jsMsg["Find.Start"],jsMsg["Find.Column"],jsMsg["Find.End"]));
showSearchResult("END_OF_AREA");
}
}
}else{
if(getObj("searchArea").value=="sheet"){
if(FIND.isNext){
if(row<currRow||((row==currRow)&&(col<=currCol))){
getObj("searchEndMsg").innerHTML=replaceParams(jsMsg["Find.EndOfReach"],new Array(jsMsg["Find.End"],jsMsg["Find.Sheet"],jsMsg["Find.Start"]));
showSearchResult("END_OF_AREA");
}
}else{
if(row>currRow||((row==currRow)&&(col>=currCol))){
getObj("searchEndMsg").innerHTML=replaceParams(jsMsg["Find.EndOfReach"],new Array(jsMsg["Find.Start"],jsMsg["Find.Sheet"],jsMsg["Find.End"]));
showSearchResult("END_OF_AREA");
}
}
}else{
if(getObj("searchArea").value=="workbook"){
var _3c0b=getSheetIndex();
if(FIND.isNext){
if(_3c0a<_3c0b||(_3c0a==_3c0b&&(row<currRow||(row==currRow&&col<=currCol)))){
getObj("searchEndMsg").innerHTML=replaceParams(jsMsg["Find.EndOfReach"],new Array(jsMsg["Find.End"],jsMsg["Find.Message.Workbook"],jsMsg["Find.Start"]));
showSearchResult("END_OF_AREA");
}
}else{
if(_3c0a>_3c0b||(_3c0a==_3c0b&&(row>currRow||(row==currRow&&col>=currCol)))){
getObj("searchEndMsg").innerHTML=replaceParams(jsMsg["Find.EndOfReach"],new Array(jsMsg["Find.Start"],jsMsg["Find.Message.Workbook"],jsMsg["Find.End"]));
showSearchResult("END_OF_AREA");
}
}
}
}
}
}
}else{
if(FIND.action=="REPLACEALL"&&FIND.dialogOpen){
var _3c0c=_3c04.replacedCount;
if(_3c0c&&parseInt(_3c0c)>1){
getObj("statusMsg").innerHTML=replaceParams(jsMsg["Find.replaceMsg"],new Array(_3c0c));
}else{
getObj("statusMsg").innerHTML=jsMsg["Find.replaceMsgForOne"];
}
showSearchResult("REPLACE_NOTIFY");
}
}
if(FIND.action!="REPLACEALL"){
var lbl=getCellLabel(row,col);
var val=_3c09+"."+lbl;
FIND.isFromFind=true;
if(FIND.action=="REPLACE"&&_3c06){
setTimeout("gotoCellInit('"+val+"')",300);
}else{
gotoCellInit(val);
}
moveDialogBox(row,col);
if(FIND.isFirstFind){
FIND.startCol=col;
FIND.startRow=row;
FIND.startSheet=_3c04.sheet;
FIND.isFirstFind=false;
}
}
}
}
}
function showSearchResult(_3c0f){
if(_3c0f=="NO_DATA_FOUND"){
getObj("searchNoDataMsg").style.display="";
}else{
if(_3c0f=="END_OF_AREA"){
getObj("searchEndOfAreaMsg").style.display="";
}else{
if(_3c0f=="REPLACE_NOTIFY"){
getObj("searchStatusMsg").style.display="";
}
}
}
}
function findResetVariables(el){
FIND.startCol=0;
FIND.startRow=0;
FIND.startSheet="";
FIND.isFirstFind=true;
FIND.isFromFind=false;
FIND.isNext=true;
if(el&&el.id=="radUp"){
FIND.isNext=false;
}
}
function closeFindDialog(){
FIND.dialogOpen=false;
closeDialog();
return false;
}
function clearSearch(){
var _3c11=getObj("searchNoDataMsg");
if(_3c11.style.display==""){
_3c11.style.display="none";
}
var _3c12=getObj("searchEndOfAreaMsg");
if(_3c12.style.display==""){
_3c12.style.display="none";
}
var _3c13=getObj("searchStatusMsg");
if(_3c13.style.display==""){
_3c13.style.display="none";
}
return false;
}
function focusSearchBarEl(){
currSearchBarEl.focus();
return false;
}
function moveDialogBox(row,col){
var box=getObj("_DIALOG_LAYER");
var _3c17=clientDim.width;
var _3c18=clientDim.height;
var _3c19=getCellPosInPage(row,col);
var _3c1a=getCell(row,col);
var _3c1b=0;
var _3c1c=0;
if(_3c1a){
_3c1b=getCellWidth(_3c1a);
_3c1c=getCellHeight(_3c1a);
}
var _3c1d=box.offsetLeft+box.offsetWidth;
var _3c1e=box.offsetTop+box.offsetHeight;
var _3c1f=_3c19.left+_3c1b;
var _3c20=_3c19.top+_3c1c;
var left=box.offsetLeft;
if((box.offsetLeft<=_3c1f&&_3c1f<=_3c1d)&&(box.offsetTop<=_3c19.top&&_3c19.top<=_3c1e)){
if(_3c1f+box.offsetWidth>_3c17){
box.style.left=(_3c19.left-box.offsetWidth)+"px";
}else{
box.style.left=_3c1f+"px";
}
}
return;
}
function hideSearchBar(){
var _3c22=getObj("searchBar");
if(_3c22.style.display==""||_3c22.style.display=="block"){
_3c22.style.display="none";
getObj("searchText").blur();
resetEditorDim();
setFocusInCellField();
}
findResetVariables();
}
function getSheetIndex(_3c23){
if(!_3c23){
_3c23=CURRSHEETNAME;
}
var _3c24=getObj("sheetsTab").getElementsByTagName("TD");
for(var i=0;i<_3c24.length-1;i++){
var _3c26=_3c24[i].getAttribute("sheetname");
if(_3c26==_3c23){
return i;
}
}
}
function getSheetNameByIndex(index){
var _3c28=getObj("sheetsTab").getElementsByTagName("TD");
for(var i=0;i<_3c28.length-1;i++){
var _3c2a=_3c28[i].getAttribute("sheetname");
if(i==index){
return _3c2a;
}
}
return CURRSHEETNAME;
}
Userpresence=function(){
};
var colorcodes=["6BA125","076CB0","FC7A0A","F3CC03","D70005","5E8C5E","476FB3","CFA012","DF4620","5D39A5"];
var colorcodeidx=0;
var usercolorcode=new Array();
var userpremission=new Array();
var userpresenceintvl;
var usercell={};
Userpresence.send=function(){
window.clearInterval(userpresenceintvl);
if(COLLAB_ID==""||COLLAB_ID=="null"||SHAREDUSERSLIST.length==0){
return;
}
var nvp="docid="+DOCUMENT_ID+"&curtime="+CURRENTTIME+"&sheetname="+encodeURIComponent(CURRSHEETNAME)+"&collabid="+COLLAB_ID+"&r="+currRow+"&c="+currCol;
if(jsREMOTE_SAVE_VIEW){
nvp+="&RMLOGINNAME="+RMUSER;
}
var _3c2c=new getXmlhttp();
_3c2c.open("POST",ctxpath+"userpresence.do",true);
_3c2c.onreadystatechange=function(){
if(_3c2c.readyState==4){
}
};
_3c2c.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_3c2c.send(nvp);
};
Userpresence.show=function(_3c2d){
if(!_3c2d){
return;
}
var user=_3c2d["user"];
var _3c2f=_3c2d["sheetname"];
var row=_3c2d["row"];
var col=_3c2d["col"];
if(_3c2f==CURRSHEETNAME){
if(Userpresence.isPresent(user)){
Userpresence.change(_3c2d);
}else{
Userpresence.create(_3c2d);
}
}else{
Userpresence.remove(user);
}
usercell[user]=_3c2f.trim()+"-"+row+"-"+col;
};
Userpresence.create=function(_3c32){
var user=_3c32["user"];
var _3c34=_3c32["zuid"];
var _3c35=Userpresence.getColorCode(user);
var _3c36=document.createElement("DIV");
_3c36.id=user+"_uPD";
_3c36.className="uPD";
_3c36.style.borderColor="#"+_3c35;
var _3c37=document.createElement("DIV");
_3c37.id=user+"_uPND";
_3c37.className="uPND";
_3c37.style.borderColor="#"+_3c35;
_3c37.style.background="#"+_3c35;
_3c37.style.display="none";
_3c37.innerHTML=getUsrName(_3c34);
_3c36.appendChild(_3c37);
var _3c38=document.createElement("DIV");
_3c38.className="uPID";
_3c38.style.borderTopColor="#"+_3c35;
_3c36.appendChild(_3c38);
var prop=Userpresence.getProperty(_3c32);
Userpresence.setProperty(_3c36,prop);
Userpresence.append(_3c36,prop,user);
};
Userpresence.append=function(el,prop,user){
if(el){
var elId=el.id;
for(var i=1;i<=4;i++){
var id=(i==4)?"":i;
el.id=elId+id;
Userpresence.getParentDiv(id).appendChild(el.cloneNode(true));
Userpresence.registerEvent(getObj(el.id),prop);
}
el="";
Userpresence.handleFreezePane(user);
}
};
Userpresence.change=function(_3c40){
var user=_3c40["user"];
var prop=Userpresence.getProperty(_3c40);
for(var i=1;i<=4;i++){
var eleId=(i==4)?"":i;
var _3c45=Userpresence.getUserPresenceDiv(user,eleId);
if(_3c45){
Userpresence.setProperty(_3c45,prop);
Userpresence.registerEvent(_3c45,prop);
}
}
Userpresence.handleFreezePane(user);
};
Userpresence.remove=function(user){
if(!Userpresence.isPresent(user)){
return;
}
for(var i=1;i<=4;i++){
var id=(i==4)?"":i;
var el=Userpresence.getUserPresenceDiv(user,id);
if(el){
Userpresence.getParentDiv(id).removeChild(el);
}
}
};
Userpresence.isOwnDiv=function(el){
return (el.className=="uPD"||el.className=="uPND"||el.className=="uPID");
};
Userpresence.isPresent=function(user){
var el=Userpresence.getUserPresenceDiv(user);
if(el){
return true;
}
return false;
};
Userpresence.getUserPresenceDiv=function(user,_3c4e){
_3c4e=(_3c4e)?_3c4e:"";
return getObj(user+"_uPD"+_3c4e);
};
Userpresence.getUserPresenceDivArr=function(user){
if(!Userpresence.isPresent(user)){
return;
}
var arr=new Array();
for(var i=1;i<=4;i++){
var id=(i==4)?"":i;
var el=Userpresence.getUserPresenceDiv(user,id);
arr.push(el);
}
return arr;
};
Userpresence.getParentDiv=function(id){
var _3c55;
switch(id){
case 1:
_3c55=userPresencePane1;
break;
case 2:
_3c55=userPresencePane2;
break;
case 3:
_3c55=userPresencePane3;
break;
default:
_3c55=userPresencePane;
}
return _3c55;
};
Userpresence.getProperty=function(_3c56){
var row=_3c56["row"];
var col=_3c56["col"];
var _3c59=getCellDIM(parseInt(row),parseInt(col));
var _3c5a=((_3c59.height)+3);
var width=((_3c59.width)+3);
var left=((_3c59.left)-2);
var top=((_3c59.top)-2);
var res={"row":row,"col":col,"left":left,"top":top,"width":width,"height":_3c5a};
return res;
};
Userpresence.setProperty=function(el,prop){
if(!el){
return;
}
el.style.left=prop.left+"px";
el.style.top=prop.top+"px";
el.style.width=prop.width+"px";
el.style.height=prop.height+"px";
};
Userpresence.registerEvent=function(el,prop){
var _3c63=getChildNode(el,0);
el.onmouseover=function(ev){
Userpresence.showUserNameDIV(_3c63);
showCellComment(ev,getCell(prop.row,prop.col));
};
el.onmouseout=function(){
Userpresence.hideUserNameDIV(_3c63);
hideCellComment();
};
el.onmousedown=function(){
};
};
Userpresence.handleFreezePane=function(user){
var _3c66;
var _3c67=Userpresence.getUserPresenceDivArr(user);
var _3c68=_3c67[3];
if(ISFREEZED){
var _3c69=_3c67[0];
var _3c6a=_3c67[1];
var _3c6b=_3c67[2];
var top=(-1*thirdPaneTop)+"px";
var left=(-1*secondPaneLeft)+"px";
if(isRowsOnlyFreezed){
_3c68.style.marginTop=_3c66=top;
Userpresence.setNameDIVTop(_3c6a);
}else{
if(isColsOnlyFreezed){
_3c68.style.marginLeft=left;
Userpresence.setNameDIVTop(_3c6b);
}else{
if(isColsAndRowsFreezed){
_3c68.style.marginTop=_3c6b.style.marginTop=_3c66=top;
_3c68.style.marginLeft=_3c6a.style.marginLeft=left;
Userpresence.setNameDIVTop(_3c69);
Userpresence.setNameDIVTop(_3c6a);
Userpresence.setNameDIVTop(_3c6b,_3c66);
}
}
}
}
Userpresence.setNameDIVTop(_3c68,_3c66);
};
Userpresence.setNameDIVTop=function(el,_3c6f){
_3c6f=(_3c6f)?parseInt((_3c6f.indexOf("px")==-1)?_3c6f:_3c6f.substring(0,_3c6f.lastIndexOf("px"))):0;
var elTop=el.style.top.substring(0,el.style.top.lastIndexOf("px"));
getChildNode(el,0).style.top=((parseInt(elTop)+_3c6f)>0)?"-20px":"";
};
Userpresence.getColorCode=function(user){
if(usercolorcode[user]){
return usercolorcode[user];
}else{
if(colorcodeidx>=colorcodes.length){
colorcodeidx=0;
}
usercolorcode[user]=colorcodes[colorcodeidx++];
return usercolorcode[user];
}
};
Userpresence.showUserNameDIV=function(el){
if(el){
if(el.innerHTML!=LOGINNAME){
el.style.display="";
}
}
};
Userpresence.hideUserNameDIV=function(el){
if(el){
el.style.display="none";
}
};
Userpresence.highlight=function(){
};
Userpresence.changeUserCellArr=function(_3c74){
if(!_3c74){
return;
}
var _3c75=_3c74["sheetName"];
var row=_3c74["row"];
var col=_3c74["col"];
var _3c78=_3c74["oldSheetName"];
var sName=(_3c78)?_3c78:_3c75;
for(x in usercell){
var _3c7a=usercell[x].split("-");
if(_3c7a[0].trim().toUpperCase()==sName.trim().toUpperCase()){
if(_3c78){
_3c7a[0]=_3c75;
}
if(row){
_3c7a[1]=row;
}
if(col){
_3c7a[2]=col;
}
usercell[x]=_3c7a[0]+"-"+_3c7a[1]+"-"+_3c7a[2];
}
}
};
function updateJson(_3c7b){
if(!isUndefined(_3c7b[ActionConstants.SHEETACTION])){
updateSheetActionJson(_3c7b[ActionConstants.SHEETACTION]);
updateSheetChangesInEditor(_3c7b[ActionConstants.SHEETACTION]);
}
if(!isUndefined(_3c7b[ActionConstants.NAMED_RANGE])){
updateNamedRanges(_3c7b[ActionConstants.NAMED_RANGE].a,_3c7b[ActionConstants.NAMED_RANGE].n,true,null,_3c7b[ActionConstants.NAMED_RANGE].sr,_3c7b[ActionConstants.NAMED_RANGE].sc,_3c7b[ActionConstants.NAMED_RANGE].er,_3c7b[ActionConstants.NAMED_RANGE].ec,_3c7b[ActionConstants.NAMED_RANGE].s);
}
if(!isUndefined(_3c7b[ActionConstants.WORKBOOK_ACTION])){
updateWorkbookActionJson(_3c7b[ActionConstants.WORKBOOK_ACTION]);
}
if(!isUndefined(_3c7b[ActionConstants.SELECT])){
doGoto(_3c7b[ActionConstants.SELECT].s,_3c7b[ActionConstants.SELECT].sr,_3c7b[ActionConstants.SELECT].er,_3c7b[ActionConstants.SELECT].sc,_3c7b[ActionConstants.SELECT].ec,(_3c7b.a==ActionConstants.MACRO));
}
if(!isUndefined(_3c7b.s)&&CURRSHEETNAME!=_3c7b.s){
return;
}
if(!isUndefined(_3c7b[ActionConstants.RANGE])){
for(var i=0;i<_3c7b[ActionConstants.RANGE].length;i++){
updateRangeJson(_3c7b[ActionConstants.RANGE][i]);
}
}
if(!isUndefined(_3c7b[ActionConstants.CLEARSTYLES])){
for(var i=0;i<_3c7b[ActionConstants.CLEARSTYLES].length;i++){
var _3c7d=_3c7b[ActionConstants.CLEARSTYLES][i];
if(!isUndefined(_3c7d.sr)){
clearFormatting(_3c7d.sr,_3c7d.sc,_3c7d.er,_3c7d.ec);
}
}
}
if(!isUndefined(_3c7b[ActionConstants.CLEARALL])){
for(var i=0;i<_3c7b[ActionConstants.CLEARALL].length;i++){
var _3c7e=_3c7b[ActionConstants.CLEARALL][i];
if(!isUndefined(_3c7e.sr)){
clearAll(_3c7e.sr,_3c7e.sc,_3c7e.er,_3c7e.ec,_3c7e.ws,_3c7e.wd);
}
}
}
if(!isUndefined(_3c7b[ActionConstants.RANGE_STYLE])){
for(var i=0;i<_3c7b[ActionConstants.RANGE_STYLE].length;i++){
if(!isUndefined(_3c7b[ActionConstants.RANGE_STYLE][i].r)){
updateCellStyle(_3c7b[ActionConstants.RANGE_STYLE][i].r,_3c7b[ActionConstants.RANGE_STYLE][i].c,_3c7b[ActionConstants.RANGE_STYLE][i]);
}else{
updateRangeStyleJson(_3c7b[ActionConstants.RANGE_STYLE][i]);
}
}
}
if(!isUndefined(_3c7b[ActionConstants.CELL])){
var _3c7f=elemsarrIndex;
elemsarrIndex++;
elemsarr[_3c7f]=new Array();
for(var i=0;i<_3c7b[ActionConstants.CELL].length;i++){
if(!isUndefined(_3c7b[ActionConstants.CELL][i].r)){
updateCellData(_3c7b[ActionConstants.CELL][i].r,_3c7b[ActionConstants.CELL][i].c,_3c7b[ActionConstants.CELL][i],_3c7f);
}else{
updateRangeDataJson(_3c7b[ActionConstants.CELL][i],_3c7f);
}
}
if(elemsarr[_3c7f].length!=0){
fadeCells(StartFadeAt,_3c7f);
}else{
elemsarr[_3c7f]=null;
if(_3c7f<elemsarrIndex){
elemsarrIndex=_3c7f;
}
}
}
if(!isUndefined(_3c7b[ActionConstants.ERROR])){
focusCell(_3c7b[ActionConstants.ERROR][ActionConstants.INSERT_ROW],_3c7b[ActionConstants.ERROR][ActionConstants.INSERT_COL]);
if(!isUndefined(_3c7b[ActionConstants.ERROR][ActionConstants.VALUE])){
focusCellField(_3c7b[ActionConstants.ERROR][ActionConstants.VALUE]);
}
if(!isUndefined(_3c7b[ActionConstants.ERROR][ActionConstants.ERROR_MESSAGE])){
alert(_3c7b[ActionConstants.ERROR][ActionConstants.ERROR_MESSAGE]);
}
}
if(!isUndefined(_3c7b[ActionConstants.BORDERS])){
var _3c80=false;
for(var i=0;i<_3c7b[ActionConstants.BORDERS].length;i++){
if(!isUndefined(_3c7b[ActionConstants.BORDERS][i].r)){
if(!isUndefined(_3c7b.sr)){
_3c80=isOutsideActionRange(_3c7b[ActionConstants.BORDERS][i].r,_3c7b[ActionConstants.BORDERS][i].c,_3c7b.sr,_3c7b.sc,_3c7b.er,_3c7b.ec);
}
updateCellBorder(_3c7b[ActionConstants.BORDERS][i].r,_3c7b[ActionConstants.BORDERS][i].c,_3c7b[ActionConstants.BORDERS][i],_3c80);
}else{
if(!isUndefined(_3c7b.sr)){
_3c80=isOutsideActionRange(_3c7b[ActionConstants.BORDERS][i].sr,_3c7b[ActionConstants.BORDERS][i].sc,_3c7b.sr,_3c7b.sc,_3c7b.er,_3c7b.ec)&&isOutsideActionRange(_3c7b[ActionConstants.BORDERS][i].er,_3c7b[ActionConstants.BORDERS][i].ec,_3c7b.sr,_3c7b.sc,_3c7b.er,_3c7b.ec);
}
updateRangeBorderJson(_3c7b[ActionConstants.BORDERS][i],_3c80);
}
}
}
if(!isUndefined(_3c7b[ActionConstants.HEIGHT])){
setRowsHeightAndModifyDOM(_3c7b[ActionConstants.HEIGHT]);
focusSheet();
}
if(!isUndefined(_3c7b[ActionConstants.WIDTH])){
updateWidthJson(_3c7b[ActionConstants.WIDTH]);
focusSheet();
}
if(!isUndefined(_3c7b[ActionConstants.DEBUG_MSG])){
msgboxArray.push(_3c7b[ActionConstants.DEBUG_MSG]);
}
if(!isUndefined(_3c7b[ActionConstants.CHART])){
for(var i=0;i<_3c7b[ActionConstants.CHART].length;i++){
if(!isUndefined(_3c7b[ActionConstants.CHART][i].a)){
updateChartJson(_3c7b[ActionConstants.CHART][i]);
}
}
}
}
function updateRangeJson(_3c81){
if(_3c81.a!=ActionConstants.UNDOREDOCOUNT&&_3c81.a!=ActionConstants.SELECT&&_3c81.a!=ActionConstants.SWITCH_SHEET&&typeof _3c81.s!="undefined"&&CURRSHEETNAME!=_3c81.s){
return;
}
switch(_3c81.a){
case ActionConstants.ITALIC:
updateRangeFormat(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec,"fontStyle",_3c81.v);
break;
case ActionConstants.UNDERLINE:
updateRangeFormat(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec,"textDecoration",_3c81.v);
break;
case ActionConstants.FONTFAMILY:
updateRangeFormat(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec,"fontFamily",_3c81.v);
break;
case ActionConstants.FONTSIZE:
updateRangeFormat(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec,"fontSize",_3c81.v);
break;
case ActionConstants.VALIGN:
updateRangeFormat(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec,"verticalAlign",_3c81.v);
break;
case ActionConstants.HALIGN:
updateRangeFormat(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec,"textAlign",_3c81.v);
break;
case ActionConstants.COLOR:
updateRangeFormat(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec,"backgroundColor",_3c81.v);
break;
case ActionConstants.TEXTCOLOR:
updateRangeFormat(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec,"color",_3c81.v);
break;
case ActionConstants.WRAP:
setWrapPropertyForCellRange(_3c81.sr,_3c81.er,_3c81.sc,_3c81.ec,_3c81.v);
break;
case ActionConstants.HEIGHT:
setRowsHeightAndModifyDOM([_3c81]);
focusSheet();
break;
case ActionConstants.UNDOREDOCOUNT:
setUNDO(_3c81.u);
setREDO(_3c81.r);
break;
case ActionConstants.CLEARSTYLES:
clearFormatting(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec);
break;
case ActionConstants.CLEARCONTENTS:
if(isUndefined(_3c81.sr)){
clearContents(_3c81.r,_3c81.c,_3c81.r,_3c81.c);
}else{
clearContents(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec);
}
break;
case ActionConstants.BORDERS:
applyBorder(_3c81.v,_3c81.bs,_3c81.bc,_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec);
break;
case ActionConstants.MERGE_SPLIT:
var merge=_3c81.v;
var _3c83=parseInt(_3c81.sr);
var _3c84=parseInt(_3c81.sc);
var _3c85=parseInt(_3c81.er);
var _3c86=parseInt(_3c81.ec);
if(!merge){
var _3c87=true;
if(ActiveCellInfo.isMerged()){
if(_3c83>=ActiveCellInfo.getStartRow()&&_3c84>=ActiveCellInfo.getStartCol()){
if(_3c85<=ActiveCellInfo.getEndRow()&&_3c86<=ActiveCellInfo.getEndCol()){
_3c87=false;
_3c83=ActiveCellInfo.getStartRow();
_3c84=ActiveCellInfo.getStartCol();
_3c85=ActiveCellInfo.getEndRow();
_3c86=ActiveCellInfo.getEndCol();
}
}
}
splitCells(_3c83,_3c84,_3c85,_3c86,_3c87,true);
}else{
mergeCells(_3c83,_3c84,_3c85,_3c86,true,false,true);
}
break;
case ActionConstants.BOLD:
updateRangeFormat(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec,"fontWeight",_3c81.v);
break;
case ActionConstants.WIDTH:
setSheetColumnsWidth(_3c81.sc,_3c81.ec,_3c81.v);
focusSheet();
break;
case ActionConstants.INSERT_ROW:
if(_3c81.useUpdateJSON){
Row.executeShiftOperationCallback("INSERT",_3c81);
}
break;
case ActionConstants.INSERT_COL:
if(!isUndefined(_3c81.c)&&_3c81.c==1){
var _3c88=_3c81.sc;
}
if(isUndefined(_3c81.ec)){
insertCol("before",_3c81.sc,1,false,true,true,parseInt(_3c81.v),undefined,undefined,undefined,true,_3c88);
}else{
insertCol(_3c81.pos,_3c81.sc,_3c81.ec-_3c81.sc+1,false,true,true,undefined,undefined,undefined,undefined,true,_3c88);
}
getCharts(DOCUMENT_ID,CURRSHEETNAME,"REGENERATE");
break;
case ActionConstants.DELETE_ROW:
if(_3c81.useUpdateJSON){
Row.executeShiftOperationCallback("DELETE",_3c81);
}
break;
case ActionConstants.DELETE_COL:
deleteCol(_3c81.sc,_3c81.ec-_3c81.sc+1,true,true);
getCharts(DOCUMENT_ID,CURRSHEETNAME,"REGENERATE");
focusCol(_3c81.sc,_3c81.ec);
break;
case ActionConstants.CELL_STYLENAME:
setDefaultFormatForCell(getCell(_3c81.r,_3c81.c));
break;
case ActionConstants.CELL_COMMENT:
if(_3c81.r){
addcomment(_3c81.m,_3c81.r,_3c81.c,_3c81.v);
}else{
addcomment(_3c81.m,_3c81.sr,_3c81.sc,_3c81.v);
}
break;
case ActionConstants.CLEARALL:
clearAll(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec,_3c81.ws,_3c81.wd);
break;
case ActionConstants.SWITCH_SHEET:
doGoto(_3c81.s,_3c81.sr,_3c81.er,_3c81.sc,_3c81.ec);
break;
case ActionConstants.UNDO_MESSAGE:
showAlertDialog(jsTitleMsg[_3c81.v]);
break;
case ActionConstants.STRIKETHROUGH:
updateRangeFormat(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec,"strikeThrough",_3c81.v);
break;
case ActionConstants.DELETE_RANGE:
deleteCells();
break;
case ActionConstants.INSERT_RANGE:
insertCells();
break;
case ActionConstants.SELECT:
selectedRange=_3c81;
break;
case ActionConstants.DEBUG_MSG:
msgboxArray.push(_3c81);
break;
case ActionConstants.CLEAR_ANNOTATION:
removeRangeComments(_3c81.sr,_3c81.sc,_3c81.er,_3c81.ec);
break;
case ActionConstants.REPEAT_ACTION:
repeat.setLastAction(_3c81.v);
break;
}
}
function updateRangeDataJson(_3c89,_3c8a){
for(var rowNo=_3c89.sr;rowNo<=_3c89.er;rowNo++){
if(isRowAvailable(rowNo,_3c89.rs)||(ISFREEZED&&rowNo<FREEZED_ROW)){
for(var colNo=_3c89.sc;colNo<=_3c89.ec;colNo++){
updateCellData(rowNo,colNo,_3c89,_3c8a);
}
}
}
}
function updateCellData(rowNo,colNo,_3c8f,_3c90){
var _3c91=getCell(rowNo,colNo);
if(_3c91){
var _3c92=!isUndefined(_3c8f.cs);
var _3c93=!isUndefined(_3c8f.rs);
if(_3c92||_3c93){
var _3c94=(_3c92)?parseInt(_3c8f.cs):1;
var _3c95=(_3c93)?parseInt(_3c8f.rs):1;
var info=Merge.getCellInfo(rowNo,colNo);
var _3c97=!!info;
var _3c98=false;
var _3c99=1;
var _3c9a=1;
if(_3c97){
_3c98=(rowNo!=info["startRow"]||colNo!=info["startCol"]);
_3c99=info.getColSpan();
_3c9a=info.getRowSpan();
}
if(!_3c98){
if((_3c94==1&&_3c95==1)&&_3c97){
splitCells(rowNo,colNo,rowNo,colNo,true,true);
_3c91=getCell(rowNo,colNo);
}else{
if(((_3c94>1||_3c95>1)&&!_3c97)||(_3c94!=_3c99)||(_3c95!=_3c9a)){
mergeCells(rowNo,colNo,(rowNo+_3c95-1),(colNo+_3c94-1),true,true,true);
_3c91=getCell(rowNo,colNo);
}
}
}
}
var _3c9b=false;
if(!isUndefined(_3c8f.m)){
_3c9b=_3c8f.m;
}
if(!Merge.isCovered(rowNo,colNo)){
if(_3c91){
updateCellDataJson(_3c91,_3c8f);
if(_3c9b&&(!ISFREEZED||(rowNo>=FREEZED_ROW&&colNo>=FREEZED_COL))){
elemsarr[_3c90].push(_3c91);
}
}
if(ISFREEZED){
var _3c9c;
if(FREEZED_ROW>0){
_3c9c=getCell(rowNo,colNo,sheetPane2Id);
if(_3c9c){
updateCellDataJson(_3c9c,_3c8f);
if(_3c9b&&rowNo<FREEZED_ROW){
elemsarr[_3c90].push(_3c9c);
}
}
}
if(FREEZED_COL>0){
_3c9c=getCell(rowNo,colNo,sheetPane3Id);
if(_3c9c){
updateCellDataJson(_3c9c,_3c8f);
if(_3c9b&&colNo<FREEZED_COL){
elemsarr[_3c90].push(_3c9c);
}
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_3c9c=getCell(rowNo,colNo,sheetPane1Id);
if(_3c9c){
updateCellDataJson(_3c9c,_3c8f);
if(_3c9b&&colNo<FREEZED_COL&&rowNo<FREEZED_ROW){
elemsarr[_3c90].push(_3c9c);
}
}
}
}
}
}
}
function updateCellDataJson(cell,_3c9e){
if(cell){
var _3c9f=cell.className;
if(!isUndefined(_3c9e[ActionConstants.COMMENT])){
if(_3c9f.indexOf(" cC")==-1){
_3c9f=_3c9f+" cC";
}
cell.setAttribute("comment",_3c9e[ActionConstants.COMMENT]);
cell.onmouseover=function(ev){
showCellComment(ev,this);
};
cell.onmouseout=function(){
hideCellComment();
};
}else{
cell.removeAttribute("comment");
_3c9f=replace(_3c9f," cC","");
}
var _3ca1="";
if(!isUndefined(_3c9e.f)){
var _3ca2=_3c9e.f.substring(1,_3c9e.f.length-1);
cell.setAttribute("fn",_3ca2);
_3ca1=_3ca2;
}else{
cell.removeAttribute("fn");
}
if(cell==currCell){
exprField.value=_3ca1;
}
if(!isUndefined(_3c9e.v)){
var _3ca3=_3c9e.v.substring(1,_3c9e.v.length-1);
cell.setAttribute("cV",_3ca3);
}else{
cell.removeAttribute("cV");
}
if(!isUndefined(_3c9e.ev)){
var _3ca4=_3c9e.ev.substring(1,_3c9e.ev.length-1);
if(_3c9e.ev==null){
_3ca4="Null";
}else{
if(_3c9e.ev.constructor.toString().indexOf("Array")!=-1){
_3ca4="["+_3c9e.ev+"]";
}
}
var link=_3c9e.l;
if(link){
if(_3c9e.hl){
setHyperLinkForCell("add",cell,_3ca4,constructHyperlinkString(link,escapeSpecialCharacters(_3ca4),true,"",true).linkString);
}else{
constructURL(cell,_3ca4);
}
}else{
setCellContent(cell,_3ca4);
}
}
if(!isUndefined(_3c9e[ActionConstants.HALIGN])){
cell.style["textAlign"]="";
var regex=getCSSStyleRegex("textAlign");
var _3c9f=_3c9f.replace(regex,"");
if(_3c9e[ActionConstants.HALIGN]!=0){
if(_3c9e[ActionConstants.HALIGN]==2){
_3c9f=_3c9f+" tar";
}else{
if(_3c9e[ActionConstants.HALIGN]==1){
_3c9f=_3c9f+" tac";
}
}
}
}
if(!isUndefined(_3c9e["ft"])){
if(_3c9e["ft"]=="0"){
cell.removeAttribute("format");
}else{
cell.setAttribute("format",_3c9e["ft"]);
}
}
cell.className=_3c9f;
if(!isUndefined(_3c9e["ptc"])){
cell.style["color"]=_3c9e["ptc"];
}
}
}
function updateRangeStyleJson(_3ca7){
for(var rowNo=_3ca7.sr;rowNo<=_3ca7.er;rowNo++){
if(isRowAvailable(rowNo,_3ca7.rs)||(ISFREEZED&&rowNo<FREEZED_ROW)){
for(var colNo=_3ca7.sc;colNo<=_3ca7.ec;colNo++){
updateCellStyle(rowNo,colNo,_3ca7);
}
}
}
}
function updateCellStyle(rowNo,colNo,_3cac){
var _3cad=getCell(rowNo,colNo);
if(_3cad){
if(!Merge.isCovered(rowNo,colNo)){
if(_3cad){
updateCellStyleJson(_3cad,_3cac,rowNo,colNo);
}
if(ISFREEZED){
var _3cae;
if(FREEZED_ROW>0){
_3cae=getCell(rowNo,colNo,sheetPane2Id);
if(_3cae){
updateCellStyleJson(_3cae,_3cac,rowNo,colNo,sheetPane2Id);
}
}
if(FREEZED_COL>0){
_3cae=getCell(rowNo,colNo,sheetPane3Id);
if(_3cae){
updateCellStyleJson(_3cae,_3cac,rowNo,colNo,sheetPane3Id);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_3cae=getCell(rowNo,colNo,sheetPane1Id);
if(_3cae){
updateCellStyleJson(_3cae,_3cac,rowNo,colNo,sheetPane1Id);
}
}
}
}
}
}
function updateCellStyleJson(cell,_3cb0,rowNo,_3cb2,_3cb3){
if(cell){
var _3cb4=cell.className;
var _3cb5="cD";
if(!isUndefined(_3cb0[ActionConstants.WRAP])&&_3cb0[ActionConstants.WRAP]==1){
_3cb5=_3cb5+" W";
}else{
_3cb5=_3cb5+" nW";
}
if(!isUndefined(_3cb0[ActionConstants.BOLD])&&_3cb0[ActionConstants.BOLD]==1){
_3cb5=_3cb5+" fwb";
}
if(!isUndefined(_3cb0[ActionConstants.ITALIC])&&_3cb0[ActionConstants.ITALIC]==1){
_3cb5=_3cb5+" fsi";
}
if(!isUndefined(_3cb0[ActionConstants.UNDERLINE])&&_3cb0[ActionConstants.UNDERLINE]==1){
_3cb5=_3cb5+" tdu";
}
if(!isUndefined(_3cb0[ActionConstants.FONTFAMILY])){
cssStyle=getMatchedCSSFontStyle(_3cb0[ActionConstants.FONTFAMILY]);
if(cssStyle==""){
cell.style["fontFamily"]=_3cb0[ActionConstants.FONTFAMILY];
}else{
_3cb5=_3cb5+cssStyle;
cell.style["fontFamily"]="";
}
}else{
cell.style["fontFamily"]="";
}
if(!isUndefined(_3cb0[ActionConstants.FONTSIZE])){
cssStyle=getMatchedCSSFontSize(_3cb0[ActionConstants.FONTSIZE]);
if(cssStyle==""){
cell.style["fontSize"]=_3cb0[ActionConstants.FONTSIZE];
}else{
_3cb5=_3cb5+cssStyle;
cell.style["fontSize"]="";
}
}else{
cell.style["fontSize"]="";
}
if(!isUndefined(_3cb0[ActionConstants.HALIGN])&&_3cb0[ActionConstants.HALIGN]!=0){
switch(_3cb0[ActionConstants.HALIGN]){
case 0:
break;
case 1:
_3cb5=_3cb5+" tac";
break;
case 2:
_3cb5=_3cb5+" tar";
break;
}
}
if(!isUndefined(_3cb0[ActionConstants.COLOR])&&_3cb0[ActionConstants.COLOR]!="#FFFFFF"){
cell.style["backgroundColor"]=_3cb0[ActionConstants.COLOR];
}else{
cell.style["backgroundColor"]="";
}
if(!isUndefined(_3cb0[ActionConstants.TEXTCOLOR])&&_3cb0[ActionConstants.TEXTCOLOR]!="#000000"){
cell.style["color"]=_3cb0[ActionConstants.TEXTCOLOR];
}else{
cell.style["color"]="";
}
if(_3cb4.indexOf(" cC")!=-1){
_3cb5=_3cb5+" cC";
}
if(!isUndefined(_3cb0[ActionConstants.VALIGN])){
var _3cb6=getCellInnerHTML(cell);
var _3cb7="";
switch(_3cb0[ActionConstants.VALIGN]){
case 0:
_3cb7="";
break;
case 1:
_3cb7=" vam";
break;
case 2:
_3cb7=" vab";
}
alignCellVertically(cell,_3cb7,_3cb6);
_3cb5=_3cb5+_3cb7;
}
cell.className=_3cb5;
}
}
function isOutsideActionRange(rowNo,colNo,_3cba,_3cbb,_3cbc,_3cbd){
return ((rowNo<_3cba||rowNo>_3cbc)&&(colNo<_3cbb||colNo>_3cbd));
}
function updateRangeBorderJson(_3cbe,_3cbf){
for(var rowNo=_3cbe.sr;rowNo<=_3cbe.er;rowNo++){
if(isRowAvailable(rowNo,_3cbe.rs)||(ISFREEZED&&rowNo<FREEZED_ROW)){
for(var colNo=_3cbe.sc;colNo<=_3cbe.ec;colNo++){
updateCellBorder(rowNo,colNo,_3cbe,_3cbf);
}
}
}
}
function updateCellBorder(rowNo,colNo,_3cc4,_3cc5){
var _3cc6=getCell(rowNo,colNo);
if(_3cc6){
if(!Merge.isCovered(rowNo,colNo)){
updateCellBorderJson(_3cc6,_3cc4,_3cc5);
if(ISFREEZED){
var _3cc7;
if(FREEZED_ROW>0){
_3cc7=getCell(rowNo,colNo,sheetPane2Id);
if(_3cc7){
updateCellBorderJson(_3cc7,_3cc4,_3cc5);
}
}
if(FREEZED_COL>0){
_3cc7=getCell(rowNo,colNo,sheetPane3Id);
if(_3cc7){
updateCellBorderJson(_3cc7,_3cc4,_3cc5);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_3cc7=getCell(rowNo,colNo,sheetPane1Id);
if(_3cc7){
updateCellBorderJson(_3cc7,_3cc4,_3cc5);
}
}
}
}
}
}
function updateCellBorderJson(cell,_3cc9,_3cca){
if(cell){
var _3ccb=cell.className;
var _3ccc=false;
if(_3cca==true){
_3ccb=_3ccb.replace(/( b[br][12d])(\b)/gi,"");
_3ccc=true;
}
if(!isUndefined(_3cc9[ActionConstants.BORDER_RIGHT])){
var _3ccd=getBorderStyleName(_3cc9[ActionConstants.BORDER_RIGHT],14);
if(_3ccd!=""){
_3ccb=_3ccb+_3ccd;
removeCSSStyle("borderRight",cell);
_3ccc=true;
}else{
cell.style["borderRight"]=_3cc9[ActionConstants.BORDER_RIGHT];
}
}else{
removeCSSStyle("borderRight",cell);
}
if(!isUndefined(_3cc9[ActionConstants.BORDER_BOTTOM])){
var _3ccd=getBorderStyleName(_3cc9[ActionConstants.BORDER_BOTTOM],17);
if(_3ccd!=""){
_3ccb=_3ccb+_3ccd;
removeCSSStyle("borderBottom",cell);
_3ccc=true;
}else{
cell.style["borderBottom"]=_3cc9[ActionConstants.BORDER_BOTTOM];
}
}else{
removeCSSStyle("borderBottom",cell);
}
if(_3ccc){
cell.className=_3ccb;
}
}
}
function getBorderStyleName(_3cce,_3ccf){
if(_3cce=="1"||_3cce=="2"||_3cce=="d"){
switch(_3ccf){
case 13:
return " bl"+_3cce;
case 14:
return " br"+_3cce;
case 16:
return " bt"+_3cce;
case 17:
return " bb"+_3cce;
}
}
return "";
}
function getCssFontSize(value){
var _3cd1="";
switch(value){
case "8pt":
_3cd1=" f8";
break;
case "9pt":
_3cd1=" f9";
break;
case "10pt":
_3cd1=" f10";
break;
case "11pt":
_3cd1=" f11";
break;
case "12pt":
_3cd1=" f12";
break;
case "14pt":
_3cd1=" f14";
break;
case "16pt":
_3cd1=" f16";
break;
case "18pt":
_3cd1=" f18";
break;
case "20pt":
_3cd1=" f20";
break;
case "22pt":
_3cd1=" f22";
break;
case "24pt":
_3cd1=" f24";
break;
case "26pt":
_3cd1=" f26";
break;
}
return _3cd1;
}
function updateRangeFormat(_3cd2,_3cd3,_3cd4,_3cd5,_3cd6,_3cd7){
var _3cd8=_3cd2;
var _3cd9=false;
var _3cda=(FREEZED_ROW>0&&getAvailableStartRow()>=ROWS_PER_TILE&&_3cd2<=FREEZED_ROW);
var _3cdb;
if(_3cda){
_3cdb=FREEZED_ROW-1>=_3cd4?_3cd4:FREEZED_ROW-1;
}
if(_3cd4>=getAvailableStartRow()&&_3cd2<=getAvailableEndRow()){
_3cd4=_3cd4>getAvailableEndRow()?getAvailableEndRow():_3cd4;
_3cd2=_3cd2<getAvailableStartRow()?getAvailableStartRow():_3cd2;
_3cd9=true;
}
if(!_3cd9&&!_3cda){
return;
}
var _3cdc="";
var _3cdd=false;
switch(_3cd6){
case "fontWeight":
if(_3cd7==1){
_3cdc=" fwb";
}else{
_3cdd=true;
}
break;
case "fontStyle":
if(_3cd7==1){
_3cdc=" fsi";
}else{
_3cdd=true;
}
break;
case "textDecoration":
if(_3cd7==1){
_3cdc=" tdu";
}else{
_3cdd=true;
}
break;
case "strikeThrough":
if(_3cd7==1){
_3cdc=" tdst";
}else{
_3cdd=true;
}
break;
case "fontFamily":
_3cdc=getMatchedCSSFontStyle(_3cd7);
if(_3cdc==""){
var obj=$("#fontFace");
getDDIndex(obj,_3cd7);
}
break;
case "fontSize":
_3cdc=getCssFontSize(_3cd7);
if(_3cdc==""){
var obj=$("#fontSize");
getDDIndex(obj,_3cd7);
}
break;
case "verticalAlign":
switch(_3cd7){
case "top":
_3cdc=" vat";
break;
case "middle":
_3cdc=" vam";
break;
case "bottom":
_3cdc=" vab";
break;
default:
_3cdc=" vat";
}
break;
case "textAlign":
switch(_3cd7){
case "left":
case "start":
_3cdd=true;
break;
case "middle":
case "center":
_3cdc=" tac";
break;
case "end":
case "right":
_3cdc=" tar";
break;
}
break;
case "backgroundColor":
if(_3cd7=="transparent"||_3cd7=="rgb(255, 255, 255)"||_3cd7=="rgb(255,255,255)"||_3cd7=="#ffffff"){
if(_3cd9){
removeStyle("backgroundColor",_3cd2,_3cd3,_3cd4,_3cd5);
}
if(_3cda){
removeStyle("backgroundColor",_3cd8,_3cd3,_3cdb,_3cd5);
}
return;
}
break;
case "color":
if(_3cd7=="rgb(0, 0, 0)"||_3cd7=="rgb(0,0,0)"||_3cd7=="#000000"){
if(_3cd9){
removeStyle("color",_3cd2,_3cd3,_3cd4,_3cd5);
}
if(_3cda){
removeStyle("color",_3cd8,_3cd3,_3cdb,_3cd5);
}
return;
}
break;
}
var regex=getCSSStyleRegex(_3cd6);
if(_3cdd){
if(_3cda){
removeStyleValue(_3cd8,_3cd3,_3cdb,_3cd5,_3cd6,regex);
}
if(_3cd9){
removeStyleValue(_3cd2,_3cd3,_3cd4,_3cd5,_3cd6,regex);
}
}else{
if(_3cdc!=""){
if(_3cda){
addCssStyleValue(_3cd8,_3cd3,_3cdb,_3cd5,_3cd6,_3cdc,regex);
}
if(_3cd9){
addCssStyleValue(_3cd2,_3cd3,_3cd4,_3cd5,_3cd6,_3cdc,regex);
}
}else{
if(_3cda){
addStyleValue(_3cd8,_3cd3,_3cdb,_3cd5,_3cd6,_3cd7,regex);
}
if(_3cd9){
addStyleValue(_3cd2,_3cd3,_3cd4,_3cd5,_3cd6,_3cd7,regex);
}
}
}
}
function removeStyleValue(_3ce0,_3ce1,_3ce2,_3ce3,_3ce4,regex){
var range=new Range(_3ce0,_3ce1,_3ce2,_3ce3);
var iter=range.getIterator();
iter.iterate(function(_3ce8,_3ce9){
var _3cea=getCell(_3ce8,_3ce9);
removeStyleValueForCell(_3cea,_3ce4,regex);
if(ISFREEZED){
if(FREEZED_ROW>0){
_3cea=getCell(_3ce8,_3ce9,sheetPane2Id);
removeStyleValueForCell(_3cea,_3ce4,regex);
}
if(FREEZED_COL>0){
_3cea=getCell(_3ce8,_3ce9,sheetPane3Id);
removeStyleValueForCell(_3cea,_3ce4,regex);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_3cea=getCell(_3ce8,_3ce9,sheetPane1Id);
removeStyleValueForCell(_3cea,_3ce4,regex);
}
}
});
}
function removeStyleValueForCell(cell,_3cec,regex){
if(cell){
if(isUndefined(regex)){
regex=getCSSStyleRegex(_3cec);
}
cell.className=cell.className.replace(regex,"");
cell.style[_3cec]="";
if(_3cec=="fontSize"||_3cec=="fontFamily"){
setHyperLinkStyles(cell);
}
if(cell.className.indexOf(" tdsu")!=-1&&_3cec=="strikeThrough"){
cell.className=cell.className.replace(" tdsu"," tdu");
}
if(cell.className.indexOf(" tdsu")!=-1&&_3cec=="textDecoration"){
cell.className=cell.className.replace(" tdsu"," tdst");
}
}
}
function addStyleValue(_3cee,_3cef,_3cf0,_3cf1,_3cf2,_3cf3,regex){
var range=new Range(_3cee,_3cef,_3cf0,_3cf1);
var iter=range.getIterator();
iter.iterate(function(_3cf7,_3cf8){
var _3cf9=getCell(_3cf7,_3cf8);
addStyleValueForCell(_3cf9,_3cf2,_3cf3,regex);
if(ISFREEZED){
if(FREEZED_ROW>0){
_3cf9=getCell(_3cf7,_3cf8,sheetPane2Id);
addStyleValueForCell(_3cf9,_3cf2,_3cf3,regex);
}
if(FREEZED_COL>0){
_3cf9=getCell(_3cf7,_3cf8,sheetPane3Id);
addStyleValueForCell(_3cf9,_3cf2,_3cf3,regex);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_3cf9=getCell(_3cf7,_3cf8,sheetPane1Id);
addStyleValueForCell(_3cf9,_3cf2,_3cf3,regex);
}
}
});
}
function addStyleValueForCell(cell,_3cfb,_3cfc,regex){
if(cell){
if(isUndefined(regex)){
regex=getCSSStyleRegex(_3cfb);
cell.className=cell.className.replace(regex,"");
}
cell.style[_3cfb]=_3cfc;
if(_3cfb=="fontSize"||_3cfb=="fontFamily"){
setHyperLinkStyles(cell);
}
}
}
function addCssStyleValue(_3cfe,_3cff,_3d00,_3d01,_3d02,_3d03,regex){
var range=new Range(_3cfe,_3cff,_3d00,_3d01);
var iter=range.getIterator();
iter.iterate(function(_3d07,_3d08){
var _3d09=getCell(_3d07,_3d08);
addCssStyleValueForCell(_3d09,_3d02,_3d03,regex);
if(ISFREEZED){
if(FREEZED_ROW>0){
_3d09=getCell(_3d07,_3d08,sheetPane2Id);
addCssStyleValueForCell(_3d09,_3d02,_3d03,regex);
}
if(FREEZED_COL>0){
_3d09=getCell(_3d07,_3d08,sheetPane3Id);
addCssStyleValueForCell(_3d09,_3d02,_3d03,regex);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
_3d09=getCell(_3d07,_3d08,sheetPane1Id);
addCssStyleValueForCell(_3d09,_3d02,_3d03,regex);
}
}
});
}
function addCssStyleValueForCell(cell,_3d0b,_3d0c,regex){
if(cell){
var _3d0e=cell.className;
if((_3d0e.indexOf(_3d0c)==-1)){
if(_3d0b=="verticalAlign"){
var _3d0f=getCellInnerHTML(cell);
alignCellVertically(cell,_3d0c,_3d0f);
}
if(!isUndefined(regex)){
_3d0e=_3d0e.replace(regex,"");
}
if(_3d0b=="strikeThrough"||_3d0b=="textDecoration"){
if(_3d0e.indexOf(" tdu")!=-1){
_3d0e=_3d0e.replace(" tdu"," tdsu");
}else{
if(_3d0e.indexOf(" tdst")!=-1){
_3d0e=_3d0e.replace(" tdst"," tdsu");
}else{
_3d0e=_3d0e+_3d0c;
}
}
}else{
_3d0e=_3d0e+_3d0c;
}
if(_3d0b!=""){
cell.style[_3d0b]="";
}
cell.className=_3d0e;
if(_3d0b=="fontSize"||_3d0b=="fontFamily"){
setHyperLinkStyles(cell);
}
}
}
}
function updateSheetActionJson(_3d10){
if(_3d10.a==ActionConstants.SHEET_INSERT||_3d10.a==ActionConstants.SHEET_COPY){
if(isSheetBasedShare){
return;
}
var _3d11=_3d10.s;
var _3d12=_3d10.p;
var _3d13=document.createElement("TD");
_3d13.setAttribute("sheetname",_3d11);
_3d13.id="sheetdiv-"+_3d11;
_3d13.title=_3d11;
_3d13.innerHTML="<div class='tabItem'><div id='sheetnames_"+_3d12+"'>"+_3d11+"</div></div>";
_3d13.onmousedown=function(event){
return reorderSheet(event,this);
};
_3d13.oncontextmenu=function(event){
return showSheetsContextMenu(event,this);
};
var obj=getObj("sheetdiv-"+CURRSHEETNAME);
if(obj){
var _3d17=obj.parentNode;
if(_3d12==parseInt(TOTALSHEETS)+1){
_3d17.insertBefore(_3d13,getObj("dummySheetTab"));
}else{
var _3d18=getObj("sheetsTab").getElementsByTagName("TD");
_3d17.insertBefore(_3d13,_3d18[_3d12-1]);
}
toggleSheetsTabNavBar();
TOTALSHEETS=parseInt(TOTALSHEETS)+1;
IS_UNSAVED_SHEET=true;
}
}else{
if(_3d10.a==ActionConstants.SHEET_REMOVE){
var _3d11=_3d10.s;
var _3d12=_3d10.p;
var obj=getObj("sheetdiv-"+_3d11);
if(obj){
var _3d17=obj.parentNode;
_3d17.removeChild(obj);
TOTALSHEETS=parseInt(TOTALSHEETS)-1;
toggleSheetsTabNavBar();
removeSheets(_3d11);
getNamedRanges("delSheet");
}
}else{
if(_3d10.a==ActionConstants.SHEET_RENAME){
var _3d19=_3d10.o;
var _3d1a=_3d10.n;
var obj=getObj("sheetdiv-"+_3d19);
if(obj){
var _3d17=obj.parentNode;
if(_3d19==CURRSHEETNAME){
obj.innerHTML="<div class='tabItem selected'><div>"+_3d1a+"</div></div>";
CURRSHEETNAME=_3d1a;
}else{
obj.innerHTML="<div class='tabItem'><div>"+_3d1a+"</div></div>";
}
obj.setAttribute("sheetname",_3d1a);
obj.id="sheetdiv-"+_3d1a;
obj.title=_3d1a;
toggleSheetsTabNavBar();
renameSheets(_3d19,_3d1a);
}
}else{
if(_3d10.a==ActionConstants.SHEET_MOVE){
var _3d11=_3d10.s;
var _3d12=_3d10.p;
var obj=getObj("sheetdiv-"+_3d11);
if(obj){
var _3d17=obj.parentNode;
_3d17.removeChild(obj);
if(_3d12==parseInt(TOTALSHEETS)+1){
_3d17.insertBefore(obj,getObj("dummySheetTab"));
}else{
var _3d18=getObj("sheetsTab").getElementsByTagName("TD");
_3d17.insertBefore(obj,_3d18[_3d12-1]);
}
toggleSheetsTabNavBar();
}
}else{
if(_3d10.a==ActionConstants.SHEET_ACTIVATE){
var obj=getObj("sheetdiv-"+_3d10.s);
if(obj){
showsheet(obj,"open","false",true);
}
}
}
}
}
}
}
function updateChartJson(_3d1b){
if(_3d1b.a==ActionConstants.CHART_DATACHANGE){
for(var j=0;j<_3d1b.id.length;j++){
regenerateChart(_3d1b.id[j]);
}
}else{
if(_3d1b.a==ActionConstants.CHART_NEW){
var _3d1d={CP_DOCUMENTID:_3d1b.did,CP_DOCUMENTSHEET_NAME:_3d1b.s,CP_CHART_DBID:_3d1b.id};
setChartProps(_3d1d,_3d1b);
var chart=ExcelGraph.createInstance(_3d1d);
createChart(chart,"REGENERATE");
}else{
if(_3d1b.a==ActionConstants.CHART_REGENERATE){
var chart=ExcelGraph.getInstance(getChartImgId(_3d1b.id));
if(chart){
setChartProps(chart,_3d1b);
createChart(chart,"REGENERATE");
}
}else{
if(_3d1b.a==ActionConstants.CHART_DELETE){
for(var j=0;j<_3d1b.id.length;j++){
var imgid=getChartImgId(_3d1b.id[j]);
sheetObjectsPane.removeChild(getObj(imgid));
ExcelGraph.removeInstance(imgid);
}
}else{
if(_3d1b.a==ActionConstants.CHART_MOVE){
var imgid=getChartImgId(_3d1b.id);
if(imgid!=""){
if(typeof (_3d1b.x)!="undefined"){
OLE[imgid].setLeft(_3d1b.x);
}
if(typeof (_3d1b.y)!="undefined"){
OLE[imgid].setTop(_3d1b.y);
}
}
}
}
}
}
}
}
function setChartProps(chart,_3d21){
if(!isUndefined(_3d21.r)){
chart["CP_DATARANGE"]=_3d21.r;
}
if(!isUndefined(_3d21.d)){
chart["CP_DATAIN"]=_3d21.d;
}
if(!isUndefined(_3d21.h)){
if(getChartImgId(_3d21.id)!=""){
OLE[getChartImgId(_3d21.id)].setHeight(_3d21.h);
}
chart["CP_HEIGHT"]=_3d21.h;
}
if(!isUndefined(_3d21.w)){
if(getChartImgId(_3d21.id)!=""){
OLE[getChartImgId(_3d21.id)].setWidth(_3d21.w);
}
chart["CP_WIDTH"]=_3d21.w;
}
if(!isUndefined(_3d21.t)){
chart["CP_GRAPHTYPE"]=_3d21.t;
}
if(!isUndefined(_3d21.hl)){
chart["CP_SHOW_LEGEND"]=_3d21.hl;
}
if(!isUndefined(_3d21.tl)){
chart["CP_CHART_TITLE"]=_3d21.tl;
}
if(!isUndefined(_3d21.lf)){
chart["CP_LABEL_FORMAT"]=_3d21.lf;
}
if(!isUndefined(_3d21.o)){
chart["CP_PLOT_ORIENTATION"]=_3d21.o;
}
if(!isUndefined(_3d21.x)){
if(getChartImgId(_3d21.id)!=""){
OLE[getChartImgId(_3d21.id)].setLeft(_3d21.x);
}
chart["CP_LEFT"]=_3d21.x;
}
if(!isUndefined(_3d21.y)){
if(getChartImgId(_3d21.id)!=""){
OLE[getChartImgId(_3d21.id)].setTop(_3d21.y);
}
chart["CP_TOP"]=_3d21.y;
}
if(!isUndefined(_3d21.xt)){
chart["CP_CHART_X_LABEL"]=_3d21.xt;
}
if(!isUndefined(_3d21.yt)){
chart["CP_CHART_Y_LABEL"]=_3d21.yt;
}
}
function updateWorkbookActionJson(_3d22){
switch(_3d22.a){
case ActionConstants.SAVE_WORKBOOK:
isSaveButtonEnabled=false;
if(READ_WRITE){
btn_disabled();
}
if(ISMACROEDITOROPEN){
macroBtn_disabled();
}
break;
case ActionConstants.NEW_WORKBOOK:
var _3d23=_3d22.n;
var docId=_3d22.i;
var _3d25=getObj("mydocstbl");
if(_3d25.rows.length==1){
var extd=_3d25.rows[0];
if(extd.id==""){
_3d25.deleteRow(0);
}
}
var trObj=_3d25.insertRow(0);
trObj.id="mydoc-"+docId;
var _3d28=_3d25.rows.length+1;
trObj.className=(_3d28%2==0)?"trEven":"trOdd";
var td=document.createElement("td");
td.style.paddingLeft="4px";
td.style.width="14px";
td.innerHTML="<input type='checkbox' id='mydocs_"+(_3d25.rows.length-1)+"' value="+docId+">";
trObj.appendChild(td);
td=document.createElement("TD");
td.className="fileName";
var a=document.createElement("A");
a.href=ctxpath+"open.do?docid="+docId;
a.id=docId;
a.title=_3d23;
if(is_ie){
a.onclick=function(){
return loadDocument(this.id,this.title);
};
}else{
a.setAttribute("onclick","return loadDocument(\""+docId+"\", \""+_3d23+"\");");
}
var _3d2b=document.createTextNode(_3d23);
a.appendChild(_3d2b);
td.appendChild(a);
trObj.appendChild(td);
td=document.createElement("TD");
td.align="right";
td.style.paddingLeft="4px";
var _3d2c="spacer.gif";
var _3d2d="Modified: 1 min ago";
td.innerHTML="<a href=\"#\" onClick=\"return false;\"><img class=\"mainBgImg\" src=\""+IMAGE_PATH+_3d2c+"\"/></a><a href=\"#\" _contextmenuid=\"mySheetsDocMenu\" id=sbAct_"+docId+" onClick=\"showMySheetsDocMenu(this.id);return false;\"><img class=\"mainBgImg sidebar_actions\" src=\""+IMAGE_PATH+"spacer.gif\"/></a>";
trObj.appendChild(td);
var _3d2e=getObj("mysheetspan");
var _3d2f=_3d2e.innerHTML;
var _3d30=_3d2f.substring(_3d2f.indexOf("(")+1,_3d2f.length-1);
_3d30=parseInt(_3d30)+1;
_3d2e.innerHTML="("+_3d30+")";
break;
}
}
function updateSheetChangesInEditor(_3d31){
var _3d32=getObj("sheetobject");
if(_3d32||ISMINDLG){
switch(_3d31.a){
case ActionConstants.SHEET_INSERT:
case ActionConstants.SHEET_COPY:
if(ISMINDLG&&!ISMACROEDITOROPEN){
updateSheetOperations(_3d31);
return;
}
var _3d33=document.createElement("TD");
var _3d34=document.createElement("TD");
var tdObj=document.createElement("TD");
var trObj=document.createElement("TR");
trObj.id="tr_"+_3d31.c;
tdObj.innerHTML="<img src=\"../images/spacer.gif\" class=\"mainBgImg scriptExplrSheet\"/>&nbsp;";
tdObj.innerHTML+="<a href=\"javascript:loadMacro('"+_3d31.c+"','1')\">"+_3d31.c+"("+_3d31.s+")</a>";
_3d34.innerHTML="<img class='mainBgImg scriptExplrTreeBottomEnd' src='../images/spacer.gif'>";
trObj.appendChild(_3d33);
trObj.appendChild(_3d34);
trObj.appendChild(tdObj);
var _3d37=_3d32.getElementsByTagName("tr")[_3d32.rows.length-custommdlcnt-2];
_3d37.cells[1].getElementsByTagName("IMG")[0].className="mainBgImg scriptExplrTree";
_3d32.getElementsByTagName("TBODY")[0].insertBefore(trObj,_3d32.getElementsByTagName("tr")[_3d32.rows.length-custommdlcnt-1]);
if(_3d31.a==ActionConstants.SHEET_INSERT){
newmodule={id:_3d31.c,text:"REM Sheet Module",syntax:"vb"};
module_content.push("REM Sheet Module");
}else{
var _3d38;
if(ISMACROEDITOROPEN){
_3d38=editAreaLoader.getFile("macrotextid",_3d31.osc).text;
}else{
var i=getModuleIndex(_3d31.osc);
if(i!=null){
_3d38=module_content[i];
}
}
mdlnames.push(_3d31.c);
module_content.push(_3d38);
newmodule={id:_3d31.s,text:_3d38,syntax:"vb"};
}
editAreaLoader.openFile("macrotextid",newmodule);
break;
case ActionConstants.SHEET_REMOVE:
if(ISMINDLG&&!ISMACROEDITOROPEN){
updateSheetOperations(_3d31);
return;
}
if(ISMACROEDITOROPEN){
editAreaLoader.closeFile("macrotextid",_3d31.c);
}
if(_3d31.c==currentMdl.CURRENT){
currentMdl=new Object();
}
var deltr=getObj("tr_"+_3d31.c);
if(deltr){
if(deltr.cells[1].firstChild.className=="mainBgImg scriptExplrTreeBottomEnd"){
deltr.parentNode.rows[deltr.parentNode.rows.length-custommdlcnt-3].cells[1].firstChild.className="mainBgImg scriptExplrTreeBottomEnd";
}
deltr.parentNode.removeChild(deltr);
var i=0;
var _3d3b=mdlnames;
var _3d3c=module_content;
mdlnames=new Array();
module_content=new Array();
var j=0;
for(i=0;i<_3d3b.length;i++){
if(_3d3b[i]!=_3d31.c){
mdlnames[j]=_3d3b[i];
module_content[j]=_3d3c[i];
j++;
}
}
}
break;
case ActionConstants.SHEET_RENAME:
if(ISMINDLG&&!ISMACROEDITOROPEN){
updateSheetOperations(_3d31);
return;
}
var rentr=getObj("tr_"+_3d31.c);
if(rentr!=null){
var tdObj=rentr.cells[rentr.cells.length-1];
tdObj.innerHTML="<img src=\"../images/spacer.gif\" class=\"mainBgImg scriptExplrSheet\"/>&nbsp;";
tdObj.innerHTML+="<a href=\"javascript:loadMacro('"+_3d31.c+"','1')\">"+_3d31.c+"("+_3d31.n+")</a>";
}
break;
}
}
_3d32=getObj("modulsttable");
if(_3d32){
var i=0,id,len=_3d32.rows.length;
if(_3d31.a==ActionConstants.SHEET_COPY){
var html,newtr;
var rows=len,td,td1;
for(i=0;i<len;i++){
id=_3d32.rows[i].id;
if(id.indexOf(_3d31.osc+".")==0){
newtr=_3d32.insertRow(_3d32.rows.length);
if(rows%2==0){
newtr.className="trEven";
}else{
newtr.className="trOdd";
}
newtr.id=id.replace(_3d31.osc+".",_3d31.c+".");
var x;
for(x=0;x<_3d32.rows[i].cells.length;x++){
td1=document.createElement("TD");
html=replace(_3d32.rows[i].cells[x].innerHTML,_3d31.osc+".",_3d31.c+".");
html=replace(html,"'"+_3d31.osc+"'","'"+_3d31.c+"'");
td1.innerHTML=html;
newtr.appendChild(td1);
}
rows=rows+1;
}
}
}else{
if(_3d31.a==ActionConstants.SHEET_REMOVE){
for(i=0;i<_3d32.rows.length;i++){
id=_3d32.rows[i].id;
if(id.indexOf(_3d31.c+".")==0){
_3d32.rows[i].parentNode.removeChild(_3d32.rows[i]);
i=i-1;
}
}
}else{
if(_3d31.a==ActionConstants.SHEET_RENAME){
}
}
}
}
}
var repeat={LASTACTIONJSON:undefined,doAction:function(_3d47,_3d48,nvp){
if(_3d47&&READ_WRITE){
this.sendActionRequest(_3d47,_3d48,nvp);
}
},sendActionRequest:function(_3d4a,_3d4b,nvp){
fillCellRange();
var _3d4d=eval("("+_3d4a+")");
switch(_3d4d.a){
case 54:
var sr=(_3d4d.fd!="TO_TOP")?startR:endR-(_3d4d.er-_3d4d.sr);
var er=(_3d4d.fd!="TO_BOTTOM")?endR:startR+(_3d4d.er-_3d4d.sr);
var sc=(_3d4d.fd!="TO_LEFT")?startC:endC-(_3d4d.ec-_3d4d.sc);
var ec=(_3d4d.fd!="TO_RIGHT")?endC:startC+(_3d4d.ec-_3d4d.sc);
if(containsAnyArray(sr,sc,er,ec)||isPartOfArray(sr,sc,er,ec)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
break;
case 32:
case 44:
case 45:
if(isPartOfArray(startR,startC,endR,endC)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
break;
case 42:
if(isPartOfArray(startR,startC,endR,endC)){
sr=(_3d4d.pos=="above")?startR-1:startR+1;
er=(_3d4d.pos=="above")?endR-1:endR+1;
if(isPartOfArray(sr,startC,er,endC)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
}
break;
case 43:
if(isPartOfArray(startR,startC,endR,endC)){
sc=(_3d4d.pos=="before")?startC-1:startC+1;
ec=(_3d4d.pos=="before")?endC-1:endC+1;
if(isPartOfArray(startR,sc,endR,ec)){
showAlertDialog(jsTitleMsg.YouCannotChangeOnlyPartOfAnArray);
return;
}
}
break;
default:
break;
}
var _3d52="actionMode=Repeat";
_3d52+="&lastAction="+_3d4a;
_3d52+="&view="+getObj("VIEW").value;
if(!_3d4b){
var _3d53=startR;
var _3d54=startC;
var _3d55=endR;
var _3d56=endC;
if(startR==endR&&startC==endC){
var info=ActiveCellInfo;
var sRow=info.getStartRow();
var sCol=info.getStartCol();
var eRow=info.getEndRow();
var eCol=info.getEndCol();
if(sRow==startR&&sCol==startC){
_3d53=sRow;
_3d54=sCol;
_3d55=eRow;
_3d56=eCol;
}
}
_3d52+="&startRow="+_3d53;
_3d52+="&endRow="+_3d55;
_3d52+="&startColumn="+_3d54;
_3d52+="&endColumn="+_3d56;
_3d52+="&colSelected="+isColSelected();
_3d52+="&rowSelected="+isRowSelected();
_3d52+="&column="+currCol;
_3d52+="&row="+currRow;
}else{
_3d52+=nvp;
}
if(jsREMOTE_SAVE_VIEW){
_3d52+="&remoteEditorUser="+RMUSER;
_3d52+="&userStateId="+USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _3d5c=getObj("apiKey");
if(_3d5c!=null){
_3d52+="&apiKey="+_3d5c.value;
}
}
_3d52+="&currentSheet="+encodeURIComponent(CURRSHEETNAME);
_3d52+="&currentTime="+CURRENTTIME;
_3d52+="&documentId="+DOCUMENT_ID;
_3d52+="&documentOwner="+CURR_DOC_OWNERNAME;
_3d52+="&availableStartRow="+getAvailableStartRow();
_3d52+="&availableEndRow="+getAvailableEndRow();
_3d52+="&afterRTC="+_3d4b;
_3d52+="&isSameSheet="+ISSAMESHEET;
_3d52+="&rtcSheetName="+encodeURIComponent(RTCSHEETNAME);
_3d52+="&collabId="+COLLAB_ID;
_3d52+="&totCols="+totCols;
_3d52+="&allowWrite="+ALLOW_TO_WRITE+"&"+csrfParamName+"="+csrfToken;
var _3d5d=new getXmlhttp();
_3d5d.open("POST",ctxpath+"repeat.do",true);
_3d5d.onreadystatechange=function(){
if(_3d5d.readyState==4){
noOfUpdateRequestInProgress--;
if(_3d5d.status==200){
if(_3d5d.responseText){
var _3d5e=parseJSON(_3d5d.responseText);
if(repeat.isErrorOccured(_3d5e)){
updateJson(_3d5e);
focusSheet();
btn_enabled();
}
}
}
}
};
_3d5d.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_3d5d.send(_3d52);
noOfUpdateRequestInProgress++;
},setLastAction:function(_3d5f){
this.LASTACTIONJSON=JSON.stringify(_3d5f);
},isErrorOccured:function(resp){
if(resp.err){
switch(resp.err){
case 431:
showAlertDialog(jsTitleMsg["InsertCol.Alert.InsertingNotPossibleBeyondMaxCol"]);
break;
}
return false;
}
return true;
}};
var pageCount=1;
var currPage=1;
function setGlobalVariables(_3d61){
if(browser_ie){
window.attachEvent("onresize",Print.resetPrintDim);
}else{
window.addEventListener("resize",Print.resetPrintDim,false);
}
pageCount=_3d61;
Print.resetPrintDim();
$("#editablefname").css("display","none");
$("#readonlyfname").css("display","block");
$("#editorDialog").fadeIn();
setTimeout("closePrintMessageBox()",60000);
}
function goToPage(_3d62){
var _3d63=document.getElementById("pageIframe").contentWindow.document;
if((_3d62=="first"||_3d62=="prev")&&currPage==1){
return;
}
if((_3d62=="next"||_3d62=="last")&&currPage==pageCount){
return;
}
if(!_3d62){
var _3d64=parseInt(_3d63.getElementById("currPage").value);
if(isNaN(_3d64)){
return;
}
if(_3d64>pageCount||_3d64<1||_3d64==currPage){
return;
}
currPage=_3d64;
}else{
if(_3d62=="first"){
currPage=1;
}else{
if(_3d62=="last"){
currPage=pageCount;
}else{
if(_3d62=="prev"){
currPage=currPage-1;
}else{
if(_3d62=="next"){
currPage=currPage+1;
}
}
}
}
}
HidePageArrow(currPage);
_3d63.getElementById("currPage").value=currPage;
var yPos=findPosY(_3d63.getElementById("pimg"+currPage));
if(isIE){
_3d63.getElementById("contain-all").scrollTop=yPos-43;
}else{
_3d63.body.scrollTop=yPos-43;
}
}
function scrollHandle(){
var _3d66=getObj("pageIframe").contentWindow.document;
var _3d67=_3d66.body.scrollTop;
if(isIE){
_3d67=_3d66.getElementById("contain-all").scrollTop;
}
var _3d68=_3d66.getElementById("pimg1").offsetHeight;
for(pageNo=1;pageNo<=pageCount;pageNo++){
if(_3d67<=_3d68){
currPage=1;
}else{
if(_3d67>_3d68*pageNo&&_3d67<_3d68*(pageNo+1)){
currPage=pageNo+1;
break;
}
}
}
HidePageArrow(currPage);
_3d66.getElementById("currPage").value=currPage;
}
function HidePageArrow(_3d69){
var _3d6a=document.getElementById("pageIframe").contentWindow.document;
var fImg=_3d6a.getElementById("fImg");
var pImg=_3d6a.getElementById("pImg");
var nImg=_3d6a.getElementById("nImg");
var lImg=_3d6a.getElementById("lImg");
if(_3d69==1&&_3d69!=pageCount){
nImg.className="nextPagination_Btn";
lImg.className="lastPagination_Btn";
if(fImg.className.indexOf("hideImage")==-1){
fImg.className+=" hideImage";
pImg.className+=" hideImage";
}
}else{
if(_3d69!=1&&_3d69==pageCount){
fImg.className="firstPagination_Btn";
pImg.className="prevPagination_Btn";
if(nImg.className.indexOf("hideImage")==-1){
nImg.className+=" hideImage";
lImg.className+=" hideImage";
}
}else{
if(_3d69>1&&_3d69<pageCount){
fImg.className="firstPagination_Btn";
pImg.className="prevPagination_Btn";
nImg.className="nextPagination_Btn";
lImg.className="lastPagination_Btn";
}else{
if(fImg.className.indexOf("hideImage")==-1){
fImg.className+=" hideImage";
pImg.className+=" hideImage";
}
if(nImg.className.indexOf("hideImage")==-1){
nImg.className+=" hideImage";
lImg.className+=" hideImage";
}
}
}
}
}
function closePrintMessageBox(){
$("#editorDialog").fadeOut();
}
Print={init:function(){
if(pivotSheet){
if(ZDBClientUI.selectedTab.view.type=="Table"){
alert(jsTitleMsg["Print not supported for this table view."]);
}else{
alert(jsTitleMsg["Pivot.PrintNotSupportedForTableOrChart"]);
}
return false;
}
Print.resetVariables();
Print.openPrintSettingDialog();
},openPrintSettingDialog:function(){
$("sheetdialog").attr("style","");
$.sheetdialog.openURL(ctxpath+"pages/dialogs/printdialog.jsp",{autoOpen:false,width:560,modal:true,resizable:false,title:jsMsg["Print.Settings"]},Print.setDefaultValues);
},setDefaultValues:function(){
if(Print!=null){
var pN=(Print.paperName).replace(/\#/g,"").replace(" ","").toLowerCase();
$("#"+Print.paperSizeEl).zcombo("setValue",pN);
var _3d70=true;
if(pN.toLowerCase()=="custom"){
_3d70=false;
if(Print.paperWidth&&Print.paperHeight){
$("#"+Print.paperWidthEl).zspinner("setValue",Print.paperWidth+"\"");
$("#"+Print.paperHeightEl).zspinner("setValue",Print.paperHeight+"\"");
}
}else{
$("#"+Print.paperWidthEl).zspinner("setValue",Print.paper[pN].w+"\"");
$("#"+Print.paperHeightEl).zspinner("setValue",Print.paper[pN].h+"\"");
}
Print.changePreviewImage(_3d70);
Print.updatePagePreviewImage(pN);
Print.changePageOrientation(Print.orientation);
if(!isCellRange()){
Print.enableOptions();
if(Print.addImage==null&&Print.addChart==null&&Print.addButton==null){
Print.addImage=(ole.getObjects("img").length>0)?true:false;
Print.addChart=(ole.getObjects("chart").length>0)?true:false;
Print.addButton=(ole.getObjects("button").length>0)?true:false;
}
}else{
Print.disableOptions();
Print.addImage=false;
Print.addChart=false;
Print.addButton=false;
}
$("#print_addCharts").attr("checked",Print.addChart);
$("#print_addCharts").attr("checked",Print.addChart);
$("#print_addImages").attr("checked",Print.addImage);
$("#print_addGridLines").attr("checked",Print.addGridLine);
$("#print_addButtons").attr("checked",Print.addButton);
$("#buttonSpn").show();
if(jsREMOTE_SAVE_VIEW){
$("#buttonSpn").hide();
}
$("#print_leftMargin").zspinner("setValue",Print.paperLM);
$("#print_rightMargin").zspinner("setValue",Print.paperRM);
$("#print_topMargin").zspinner("setValue",Print.paperTM);
$("#print_bottomMargin").zspinner("setValue",Print.paperBM);
}
if(DOCUMENT_ID=="doc_id"){
SAVED=false;
savefile("autosave");
}
},disableOptions:function(){
var _3d71=$("#imageSpn");
var _3d72=$("#chartSpn");
var _3d73=$("#buttonSpn");
_3d71.children("input").attr("disabled",true);
_3d72.children("input").attr("disabled",true);
_3d73.children("input").attr("disabled",true);
_3d71.addClass("hideImage");
_3d72.addClass("hideImage");
_3d73.addClass("hideImage");
},enableOptions:function(){
var _3d74=$("#imageSpn");
var _3d75=$("#chartSpn");
var _3d76=$("#buttonSpn");
_3d74.children("input").attr("disabled",false);
_3d75.children("input").attr("disabled",false);
_3d76.children("input").attr("disabled",false);
_3d74.removeClass("hideImage");
_3d75.removeClass("hideImage");
_3d76.removeClass("hideImage");
},paper:{"a4":{"n":"A4","w":"8.27","h":"11.69","i":"0","iW":"53px","iH":"72px"},"letter":{"n":"Letter","w":"8.5","h":"11","i":"1","iW":"59px","iH":"70px"},"legal":{"n":"Legal","w":"8.5","h":"14","i":"2","iW":"59px","iH":"78px"},"executive":{"n":"Executive","w":"7.25","h":"10.5","i":"3","iW":"50px","iH":"69px"},"envelope10":{"n":"Envelope #10","w":"4.13","h":"9.5","i":"4","iW":"26px","iH":"61px","dO":"1"}},supportedPaperCnt:5,paperName:"A4",paperWidth:null,paperHeight:null,paperLM:"0.5",paperRM:"0.5",paperTM:"0.5",paperBM:"0.5",paperSizeEl:"print_paperSize",paperWidthEl:"print_paperWidth",paperHeightEl:"print_paperHeight",previewImgHgtLbl:"print_previewImgLabelHeight",previewImgWdhLbl:"print_previewImgLabelWidth",previewImg:"print_previewImg",previewDiv:"print_previewDiv",noPreview:"print_noPreview",changePaperSize:function(){
var input=$("#print_paperSize").zcombo("getValue");
if(input=="custom"){
Print.changePreviewImage(false);
Print.paperName="Custom";
return false;
}
if(Print.paperName==Print.paper[input].n){
return false;
}
Print.changePreviewImage(true);
Print.paperName=Print.paper[input].n;
var wdh=(Print.orientation==0)?Print.paper[input].w:Print.paper[input].h;
var hgt=(Print.orientation==0)?Print.paper[input].h:Print.paper[input].w;
Print.setPageWidthAndHeight(wdh,hgt);
Print.updatePagePreviewImage(Print.paper[input]);
},selectPaperSize:function(input){
if(!input){
input=Print.supportedPaperCnt;
Print.changePreviewImage(false);
}else{
Print.changePreviewImage(true);
}
$("#"+Print.paperSizeEl).zcombo("setSelectedIndex",input);
},getPageWidthAndHeight:function(){
if($("#"+Print.paperWidthEl).length==0){
var pName=(Print.paperName).replace(/\#/g,"").replace(" ","").toLowerCase();
return {"w":Print.paper[pName].w,"h":Print.paper[pName].h};
}else{
return {"w":$("#"+Print.paperWidthEl).zspinner("getValue"),"h":$("#"+Print.paperHeightEl).zspinner("getValue")};
}
},setPageWidthAndHeight:function(w,h){
$("#"+Print.paperWidthEl).zspinner("setValue",w+"\"");
$("#"+Print.paperHeightEl).zspinner("setValue",h+"\"");
},changePageDimension:function(){
var dim=Print.getPageWidthAndHeight();
if(isNaN(dim.w)||isNaN(dim.h)){
return false;
}
var w=dim.w;
var h=dim.h;
for(x in Print.paper){
var w1=(Print.orientation==0)?Math.abs(w):Math.abs(h);
var h1=(Print.orientation==0)?Math.abs(h):Math.abs(w);
w=w1;
h=h1;
if(w==Print.paper[x].w&&h==Print.paper[x].h){
Print.selectPaperSize(Print.paper[x].i);
Print.updatePagePreviewImage(Print.paper[x]);
Print.paperName=Print.paper[x].n;
return false;
}
}
Print.paperWidth=w;
Print.paperHeight=h;
Print.selectPaperSize();
Print.paperName="Custom";
},orientation:0,changePageOrientation:function(input){
var _3d84=(input!=null&&Print.orientation==input)?false:true;
if(input!=null&&input=="1"){
Print.enableLandscapeOrientation();
}else{
Print.enablePortraitOrientation();
}
if(_3d84){
var _3d85=Print.getPageWidthAndHeight();
Print.setPageWidthAndHeight(_3d85.h,_3d85.w);
Print.updatePagePreviewImage(getObj(Print.paperSizeEl).value);
}
},enablePortraitOrientation:function(){
Print.orientation=0;
$("#print_portraitOrient").attr("checked",true);
},enableLandscapeOrientation:function(){
Print.orientation=1;
$("#print_landscapeOrient").attr("checked",true);
},changePreviewImage:function(_3d86){
if(_3d86&&Print.isPreviewImageAvailable()){
return false;
}
if(_3d86){
$("#"+Print.previewDiv).show();
$("#"+Print.previewImgHgtLbl).show();
$("#"+Print.noPreview).hide();
}else{
$("#"+Print.previewDiv).hide();
$("#"+Print.previewImgHgtLbl).hide();
$("#"+Print.noPreview).show();
}
},isPreviewImageAvailable:function(){
return $("#"+Print.previewDiv).is(":visible");
},updatePagePreviewImage:function(paper){
if(!Print.isPreviewImageAvailable()){
return false;
}
if(typeof paper=="string"){
paper=Print.paper[paper];
}
var w=(Print.orientation==0)?paper.w:paper.h;
var h=(Print.orientation==0)?paper.h:paper.w;
var iW=(Print.orientation==0)?paper.iW:paper.iH;
var iH=(Print.orientation==0)?paper.iH:paper.iW;
var _3d8c=$("#"+Print.previewImgHgtLbl);
_3d8c.html(h+"&quot;");
$("#"+Print.previewImgWdhLbl).html(w+"&quot;");
var _3d8d=$("#"+Print.previewImg);
$(_3d8d).width(iW);
$(_3d8d).height(iH);
var mTop=(Print.orientation==0)?"30px":((paper.i!=4)?"22px":"8px");
$(_3d8c).css("marginTop",mTop);
},getPageMarginValues:function(){
if($("#print_leftMargin").length==0){
return {"l":Print.paperLM,"r":Print.paperRM,"t":Print.paperTM,"b":Print.paperBM};
}else{
return {"l":$("#print_leftMargin").zspinner("getValue"),"r":$("#print_rightMargin").zspinner("getValue"),"t":$("#print_topMargin").zspinner("getValue"),"b":$("#print_bottomMargin").zspinner("getValue")};
}
},setMarginValue:function(input){
Print.paperLM=(typeof input!="undefined")?input.l:$("#print_leftMargin").zspinner("getValue");
Print.paperRM=(typeof input!="undefined")?input.r:$("#print_rightMargin").zspinner("getValue");
Print.paperTM=(typeof input!="undefined")?input.t:$("#print_topMargin").zspinner("getValue");
Print.paperBM=(typeof input!="undefined")?input.b:$("#print_bottomMargin").zspinner("getValue");
},changeMargin:function(_3d90,obj){
var value=$(obj).zspinner("getValue");
switch(_3d90){
case "l":
Print.paperLM=value;
break;
case "r":
Print.paperRM=value;
break;
case "t":
Print.paperTM=value;
break;
case "b":
Print.paperBM=value;
break;
default:
}
},uC:0,uR:0,addGridLine:false,addChart:null,addImage:null,addButton:null,PDFTIME:"",changeOption:function(input){
switch(input){
case "gridLines":
Print.addGridLine=!(Print.addGridLine);
break;
case "charts":
Print.addChart=!(Print.addChart);
break;
case "images":
Print.addImage=!(Print.addImage);
break;
case "buttons":
Print.addButton=!(Print.addButton);
break;
case "download":
Print.download=!(Print.download);
break;
default:
}
},download:false,enableDownload:function(){
Print.download=true;
},disableDownload:function(){
Print.download=false;
},isPrintMessageShown:false,validate:function(_3d94,_3d95,_3d96,_3d97){
if(_3d97){
Print.setDefaultValues();
}
var dim=Print.getPageWidthAndHeight();
if(isNaN(dim.w)||isNaN(dim.h)||dim.w<1||dim.h<1){
showAlertDialog(jsTitleMsg["Print.InvalidPageFormat"]);
return false;
}
var _3d99=Print.getPageMarginValues();
if(isNaN(_3d99.l)||isNaN(_3d99.r)||isNaN(_3d99.t)||isNaN(_3d99.b)){
showAlertDialog(jsTitleMsg["Print.InvalidPageMargin"]);
return false;
}
if(dim.w-(parseFloat(_3d99.l)+parseFloat(_3d99.r))<1||dim.h-(parseFloat(_3d99.t)+parseFloat(_3d99.b))<1){
showAlertDialog(jsTitleMsg["Print.InvalidPageMargin"]);
return false;
}
if(_3d94){
Print.setMarginValue(_3d99);
if(Print.paperName.toLowerCase()=="custom"){
Print.paperWidth=dim.w;
Print.paperHeight=dim.h;
}
_3d96=(typeof _3d96=="string")?_3d96.toBoolean():_3d96;
if(_3d96){
Print.download=true;
}
Print.uC=usedCursCol;
Print.uR=usedCursRow;
if(!isCellRange()){
if(Print.addChart||Print.addImage||Print.addButton){
if(ole.getObjects().length!=0){
var _3d9a=ole.getObjectsLeft();
var _3d9b=ole.getObjectsTop();
var _3d9c=[];
var _3d9d=[];
for(var i=0;i<ole.getObjects().length;i++){
_3d9c[i]=_3d9a[i]+ole.getObjects()[i].width;
_3d9d[i]=_3d9b[i]+ole.getObjects()[i].height;
}
var _3d9f=Print.arrayMax(_3d9c);
var _3da0=Print.arrayMax(_3d9d);
var _3da1=findColInXPos(_3d9f,true);
var _3da2=findRowInYPos(_3da0,true);
Print.uC=(usedCursCol<_3da1)?_3da1:usedCursCol;
Print.uR=(usedCursRow<_3da2)?_3da2:usedCursRow;
}
}
var _3da3=Print.getUsedRowAndCol(0,0,Print.uR,Print.uC);
Print.uR=_3da3.row;
Print.uC=_3da3.col;
}
}
if(typeof _3d95!="undefined"){
Print.closePrintDialog();
}else{
return false;
}
switch(_3d95.toLowerCase()){
case "print":
Print.trigger("print");
break;
case "export":
Print.trigger("pdf");
break;
case "preview":
Print.trigger("preview");
break;
default:
}
},resetVariables:function(){
Print.download=false;
Print.uC=0;
Print.uR=0;
},trigger:function(input){
if(Print.uR==0&&Print.uC==0){
if(!showConfirmDialog(jsTitleMsg["Print.BlankSheetWarningMessage"])){
return false;
}
}
Print.closePrintDialog();
Print.deleteDoc();
if(input!="pdf"&&!isIE){
var msg=(input=="preview")?jsTitleMsg["Print.ProgressMessage1"]:jsTitleMsg["Print.ProgressMessage"];
showProgressMessage(msg);
isPrintMessageShown=true;
}
exportFlag=true;
var _3da6=document.pdfFORM;
_3da6.docname.value=DOCUMENT_NAME;
_3da6.docid.value=DOCUMENT_ID;
_3da6.currentsheet.value=CURRSHEETNAME;
_3da6.currenttime.value=CURRENTTIME;
_3da6.docowner.value=CURR_DOC_OWNERNAME;
_3da6.windowHeight.value=clientDim.height;
_3da6.viewType.value=getViewType();
_3da6.urlPath.value=location.pathname;
_3da6.rHgtArr.value=getAryMetadata(rowHeightAry);
_3da6.cWdhArr.value=getAryMetadata(colWidthAry);
_3da6.paperName.value=Print.paperName;
_3da6.lm.value=Print.paperLM;
_3da6.rm.value=Print.paperRM;
_3da6.tm.value=Print.paperTM;
_3da6.bm.value=Print.paperBM;
var _3da7="SHEET";
var sR=sC=eR=eC=0;
if(isCellRange()){
var range=getCellRange();
sR=range.startRow;
sC=range.startCol;
eR=range.endRow;
eC=range.endCol;
_3da7="RANGE";
}else{
eR=Print.uR;
eC=Print.uC;
}
_3da6.printType.value=_3da7;
_3da6.sR.value=sR;
_3da6.sC.value=sC;
_3da6.eR.value=eR;
_3da6.eC.value=eC;
_3da6.addGridLine.value=Print.addGridLine;
_3da6.addChart.value=Print.addChart;
_3da6.addButton.value=Print.addButton;
_3da6.addImage.value=Print.addImage;
_3da6.download.value=Print.download;
_3da6.orientation.value=Print.orientation;
if(getViewType()=="REMOTE_SAVE_VIEW"&&Print.addChart&&!isCellRange()){
var _3daa=[];
var imgs=sheet.getElementsByTagName("IMG");
var _3dac=0;
for(var i=0;i<imgs.length;i++){
if(imgs[i].className=="chart"){
var _3dae=imgs[i].src;
_3daa[_3dac]=_3dae.split("=")[1]+"&"+imgs[i].getAttribute("dbid");
_3dac++;
}
}
_3da6.chartNameList.value=encodeURI(_3daa);
}
if(Print.paperName=="Custom"){
_3da6.paperWidth.value=Print.paperWidth;
_3da6.paperHeight.value=Print.paperHeight;
}
if(input=="preview"){
_3da6.outputType.value="images_as_zip";
}else{
_3da6.outputType.value="pdf";
}
var url=ctxpath+"print.do";
_3da6.action=url;
if(!isPublished){
_3da6.target="hid_imp_doc";
}
var _3db0=document.createElement("input");
_3db0.setAttribute("type","hidden");
_3db0.setAttribute("name",csrfParamName);
_3db0.setAttribute("value",csrfToken);
_3da6.appendChild(_3db0);
_3da6.submit();
exportFlag=false;
},preview:function(){
Print.trigger("preview");
return false;
},arrayMax:function(ary){
var _3db2=ary[0];
for(i=1;i<ary.length;i++){
if(ary[i]>_3db2){
_3db2=ary[i];
}
}
return _3db2;
},deleteDoc:function(){
var _3db3=new getXmlhttp();
_3db3.onreadystatechange=function(){
if(_3db3.readyState==4){
Print.PDFTIME="";
return;
}
};
nvp="action=delete";
nvp+="&docId="+DOCUMENT_ID;
nvp+="&pdfTime="+Print.PDFTIME;
nvp+="&viewType="+getViewType();
postAjax(_3db3,ctxpath+"fetchPdfData.do",nvp);
},resetPrintDim:function(){
var _3db4=findClientDim().height;
var _3db5=($("#print_stdToolBar").length>0)?$("#print_stdToolBar").height():45;
var _3db6=($("#main").length>0)?$("#main").offset().top:45;
var _3db7=($("#wmstoolbar").length>0)?$("#wmstoolbar").outerHeight():0;
if(_3db7==0){
$("#editorDialog").css("bottom","0px");
}
var ht=_3db4-(_3db5+_3db6+_3db7);
if(getObj("pageIframe")){
getObj("pageIframe").style.height=ht+"px";
var _3db9=getObj("pageIframe").contentWindow.document;
if(_3db9.getElementById("contain-all")){
_3db9.getElementById("contain-all").style.height=ht+"px";
}
}
},printDoc:function(){
var _3dba=document.pdfFORM;
_3dba.download.value="false";
_3dba.outputType.value="pdf";
_3dba.action=ctxpath+"print.do";
_3dba.submit();
},saveAsPDF:function(){
var _3dbb=document.pdfFORM;
var docId=_3dbb.docid.value;
var url=ctxpath+"fetchPdfData.do?docId="+docId+"&action=PDF&pdfTime="+Print.PDFTIME+"&viewType="+getViewType()+"&docName="+DOCUMENT_NAME+"&urlPath="+location.pathname;
var obj=document.forms.utilFORM;
obj.method="POST";
obj.action=url;
if(!isPublished){
obj.target="hid_imp_doc";
}
obj.submit();
},backToEditor:function(){
Print.deleteDoc();
$("#pageIframe").attr("src",ctxpath+"pages/crossDomain.jsp");
$("#printPreviewDiv").hide();
sheetopen("open");
$("#widgetDIV").show();
$("#editablefname").css("display","block");
$("#readonlyfname").css("display","none");
resizeHScrollbarToDefaultWidth();
},getUsedRowAndCol:function(sr,sc,er,ec){
var iter=Merge.getIterator(sr,sc,er,ec);
var obj={"row":er,"col":ec};
iter.initData(obj);
iter.setDataProcessor(function(row,col){
var obj=this.getData();
obj["row"]=obj["row"]<row?row:obj["row"];
obj["col"]=obj["col"]<col?col:obj["col"];
return obj;
});
iter.iterate(function(row,col){
var _3dca=this.getMerge().getRowSpan()+row;
var _3dcb=this.getMerge().getColSpan()+col;
this.processData(_3dca,_3dcb);
});
var _3dcc=iter.getData();
return _3dcc;
},closePrintDialog:function(){
$.sheetdialog.close("#sheetdialog");
}};
var HYPERLINK={urlType:"Web",isRangeFocused:false,isUserValue:false,isRangeTab:false,isTabOpen:false,userValue:"",cellLbl:".A1"};
function showHyperlink(id){
var cell=currCellValue;
if(cell==null||cell=="undefined"){
cell="";
}
var url="";
if(validateEmail(cell)==null||((cell.indexOf("mailto:",0)>-1)&&(cell.length>7))){
url="mailto:";
}
if(id=="edit"||id=="Edit"){
url=getHyperLinkInCell(currCell).title;
}
if(cell.trim()!=""){
HYPERLINK.userValue=cell;
HYPERLINK.isUserValue=true;
}else{
HYPERLINK.isUserValue=false;
}
var _3dd0=encodeURIComponent(getRequiredSheetNames().sheetNames);
var _3dd1=encodeURIComponent(getRequiredRangeNames().rangeNames);
url=encodeURIComponent(url);
cell=encodeURIComponent(cell);
var _3dd2="SheetNames="+_3dd0;
_3dd2+="&RangeNames="+_3dd1;
_3dd2+="&url="+url;
_3dd2+="&cell="+cell;
_3dd2+="&id="+id;
_3dd2+="&currSheet="+encodeURIComponent(CURRSHEETNAME);
var _3dd3=getXMLHttpRequest();
_3dd3.open("POST",ctxpath+"pages/Hyperlink.jsp",true);
_3dd3.onreadystatechange=function(){
if(_3dd3.readyState==4){
showDialog(_3dd3.responseText,"position=absmiddle, width=400, title="+jsTitleMsg.Hyperlink+", closeOnEscKey=yes",callToggleMethod,closeLinkDialog);
}
};
_3dd3.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
_3dd3.send(_3dd2);
}
function toggleUrlType(_3dd4){
var _3dd5=["Web","Internal","Email"];
getObj(_3dd4).checked=true;
getObj(_3dd4.toLowerCase()+"Link").style.display="";
for(i=0;i<_3dd5.length;i++){
if(_3dd4!=_3dd5[i]){
getObj(_3dd5[i].toLowerCase()+"Link").style.display="none";
}
}
HYPERLINK.urlType=_3dd4;
if(HYPERLINK.urlType=="Internal"){
if(getObj("InternalUrl").value==""){
setCellRange();
}
HYPERLINK.isRangeFocused=true;
}else{
clearCellRangeFill();
HYPERLINK.isRangeFocused=false;
}
if(HYPERLINK.isUserValue){
autoFillValue();
}
setTimeout(function(){
var _3dd6=getObj(HYPERLINK.urlType+"Url");
if(_3dd6){
setCaretPos(_3dd6,"END");
}
},100);
}
function toggleInternalTab(_3dd7){
if(_3dd7=="sheetNameTab"){
getObj("sheetList").style.display="";
getObj("rangeList").style.display="none";
if(getObj("sheetNameTab").className.indexOf(" selected")==-1){
getObj("sheetNameTab").className+=" selected";
var _3dd8=getObj("rangeNameTab").className;
var _3dd9=_3dd8.replace(" selected","");
getObj("rangeNameTab").className=_3dd9;
}
doSelection(getObj("InternalUrl"));
if(getObj("SheetNames").value!=""){
makeAndPointUrl(getObj("SheetNames"),"sheet");
}
HYPERLINK.isRangeTab=false;
}else{
getObj("rangeList").style.display="";
getObj("sheetList").style.display="none";
if(getObj("rangeNameTab").className.indexOf(" selected")==-1){
getObj("rangeNameTab").className+=" selected";
var _3dd8=getObj("sheetNameTab").className;
var _3dd9=_3dd8.replace(" selected","");
getObj("sheetNameTab").className=_3dd9;
}
if(getObj("RangeNames").value!=""){
makeAndPointUrl(getObj("RangeNames"),"range");
}
HYPERLINK.isRangeTab=true;
}
setCaretPos(getObj("InternalUrl"),"END");
HYPERLINK.isRangeFocused=true;
}
function toggleHyperlinkArrow(){
var _3dda=getObj("showHideArrow").className;
var _3ddb=getObj("tabView").style.display;
getObj("tabView").style.display=(_3ddb=="none")?"":"none";
if(_3dda=="hyperlinkDownArrow"){
getObj("showHideArrow").className="hyperlinkUpArrow";
HYPERLINK.isTabOpen=true;
}else{
getObj("showHideArrow").className="hyperlinkDownArrow";
HYPERLINK.isTabOpen=false;
}
}
function makeAndPointUrl(obj,_3ddd){
var _3dde=obj.value;
var _3ddf,_3de0,_3de1,_3de2=0;
if(NAMEDRANGES.length!=0&&_3ddd=="range"){
for(var i=0;i<NAMEDRANGES.length;i++){
var _3de4=NAMEDRANGES[i];
var named=_3de4["NAME"];
var _3ddf,_3de0,_3de1,_3de2=0;
if(named.toUpperCase()==_3dde.toUpperCase()){
var _3de6=_3de4["REFSHEET"];
_3ddf=_3de4["STARTROW"];
_3de0=_3de4["STARTCOLUMN"];
_3de1=_3de4["ENDROW"];
_3de2=_3de4["ENDCOLUMN"];
break;
}
}
if(!FocusDottedCellRange(false,_3de6,_3ddf,_3de0,_3de1,_3de2)){
clearCellRangeFill();
}
if(getObj("SheetNames").selectedIndex>-1){
getObj("SheetNames").selectedIndex=-1;
}
}else{
if(_3ddd=="sheet"){
var _3de7=getObj("InternalUrl").value;
if(_3de7!=""&&_3de7.indexOf(".")>0){
HYPERLINK.cellLbl=_3de7.substring(_3de7.indexOf("."),_3de7.length);
}
if(!FocusDottedCellRange(true,_3dde)){
clearCellRangeFill();
}
if(getObj("RangeNames").selectedIndex>-1){
getObj("RangeNames").selectedIndex=-1;
}
_3dde=_3dde+HYPERLINK.cellLbl;
}
}
getObj("InternalUrl").value=_3dde;
autoFillValue(_3dde);
}
function autoFillValue(value){
if(!HYPERLINK.isUserValue){
getObj(HYPERLINK.urlType+"Text").value=value;
}else{
getObj("WebText").value=HYPERLINK.userValue;
getObj("InternalText").value=HYPERLINK.userValue;
getObj("EmailText").value=HYPERLINK.userValue;
}
getObj("CreateButton").disabled=(value=="")?true:false;
}
function stopAutoFill(_3de9){
if(_3de9==""){
HYPERLINK.isUserValue=false;
getObj("WebText").value="";
getObj("InternalText").value="";
getObj("EmailText").value="";
}else{
HYPERLINK.isUserValue=true;
}
}
function doSelection(obj){
if(obj!=undefined){
var _3deb=obj.value;
if(_3deb!=""){
_3deb=_3deb.replace(".","!");
if(_3deb.indexOf("!")!=-1){
var lbl=_3deb.substring(_3deb.indexOf("!"),_3deb.length);
HYPERLINK.cellLbl=lbl.replace("!",".");
_3deb=_3deb.substring(0,_3deb.indexOf("!"));
}
var _3ded=getRequiredSheetNames(_3deb).sheetName;
var _3dee=getRequiredRangeNames(_3deb).rangeName;
if(_3ded!=""){
getObj("SheetNames").value=_3ded;
if(!FocusDottedCellRange(true,_3ded)){
clearCellRangeFill();
}
}else{
if(_3dee!=""){
getObj("RangeNames").value=_3dee;
}else{
getObj("SheetNames").selectedIndex=-1;
getObj("RangeNames").selectedIndex=-1;
}
}
}
autoFillValue(obj.value);
}
}
function setCellRange(){
var _3def=getObj("SheetNames").value;
if(!isCellRange()){
getObj("InternalUrl").value=_3def+"."+getCellLabel(currRow,currCol);
HYPERLINK.cellLbl="."+getCellLabel(currRow,currCol);
}else{
if(!rangeFill){
var _3df0=getCellRange();
var _3df1=_3df0.startRow;
var _3df2=_3df0.startCol;
var _3df3=_3df0.endRow;
var _3df4=_3df0.endCol;
getObj("InternalUrl").value=_3def+"."+getCellLabel(_3df1,_3df2)+":"+getCellLabel(_3df3,_3df4);
HYPERLINK.cellLbl="."+getCellLabel(_3df1,_3df2)+":"+getCellLabel(_3df3,_3df4);
}
}
}
function FocusDottedCellRange(islbl,_3df6,sR,sC,eR,eC){
if(islbl&&HYPERLINK.cellLbl!=""){
sR,sC,eR,eC=0;
var ref1,ref2=0;
if(HYPERLINK.cellLbl.indexOf(":")!=-1){
lbl1=HYPERLINK.cellLbl.substring(1,HYPERLINK.cellLbl.indexOf(":"));
lbl2=HYPERLINK.cellLbl.substring(HYPERLINK.cellLbl.indexOf(":")+1,HYPERLINK.cellLbl.length);
if(isCellLabel(lbl1)){
ref1Obj=getCellPosByLabel(lbl1);
sR=ref1Obj.row;
sC=ref1Obj.col;
if(isCellLabel(lbl2)){
ref2Obj=getCellPosByLabel(lbl2);
eR=ref2Obj.row;
eC=ref2Obj.col;
}else{
eR=ref1Obj.row;
eC=ref1Obj.col;
}
}
}else{
lbl1=HYPERLINK.cellLbl.substring(1,HYPERLINK.cellLbl.length);
if(isCellLabel(lbl1)){
ref1Obj=getCellPosByLabel(lbl1);
sR=ref1Obj.row;
sC=ref1Obj.col;
eR=ref1Obj.row;
eC=ref1Obj.col;
}
}
}
if(_3df6==CURRSHEETNAME&&typeof sR!="undefined"){
var dim=getCellRangeDIM(parseInt(sR),parseInt(sC),parseInt(eR),parseInt(eC));
setCellRangeFillDIVPos(dim.left,dim.top);
setCellRangeFillDIVDim(dim.width,dim.height);
showCellRangeFillDIV();
return true;
}
return false;
}
function closeLinkDialog(){
HYPERLINK.isRangeFocused=false;
HYPERLINK.cellLbl=".A1";
closeDialog();
resetCellRangeFill("linkDialog");
clearCellRangeFill();
}
function callToggleMethod(){
var url="";
var _3dff="";
var _3e00="htt"+"p://";
var _3e01="mailto:";
if(getHyperLinkInCell(currCell).childTag){
url=getHyperLinkInCell(currCell).childTag.href;
if(!url){
url=getHyperLinkInCell(currCell).childTag.title;
}
}
if(url){
if(url.indexOf("#")==0){
_3dff=url.substring(1,url.length);
if(_3dff.indexOf("'")>-1){
_3dff=_3dff.replace(/\'/g,"");
}
HYPERLINK.urlType="Internal";
}else{
if(url.indexOf("mailto")==0){
_3e01=url;
HYPERLINK.urlType="Email";
}else{
_3e00=url;
HYPERLINK.urlType="Web";
}
}
}
if(HYPERLINK.urlType=="Internal"&&HYPERLINK.isTabOpen){
toggleHyperlinkArrow();
if(HYPERLINK.isRangeTab){
toggleInternalTab("rangeNameTab");
getObj("RangeNames").value=_3dff;
}
}
getObj("WebUrl").value=_3e00;
getObj("InternalUrl").value=_3dff;
getObj("EmailUrl").value=_3e01;
toggleUrlType(HYPERLINK.urlType);
positionDialog();
}
function constructHyperlinkString(link,label,_3e04,_3e05,_3e06){
var _3e07=true;
if(typeof _3e05=="undefined"){
_3e05="";
}
var _3e08=revertSplChrs(_3e05);
var _3e09=link.substring(0,link.indexOf(":")).toLowerCase()+link.substring(link.indexOf(":"),link.length);
var _3e0a=" style='text-decoration:underline;cursor:pointer;font:inherit;' target='_blank'";
if(link!=null){
if((_3e09.indexOf("htt"+"p://",0)>-1&&link.length>7)||(_3e09.indexOf("htt"+"ps://",0)>-1&&link.length>8)||(_3e09.indexOf("ftp://",0)>-1&&link.length>6)||(_3e09.indexOf("telnet://",0)>-1&&link.length>9)||(_3e09.indexOf("nntp://",0)>-1&&link.length>7)||(_3e09.indexOf("rlogin://",0)>-1&&link.length>9)||(_3e09.indexOf("gopher://",0)>-1&&link.length>9)||(_3e09.indexOf("url://",0)>-1&&link.length>6)){
_3e08+="<a idx='link' href='"+_3e09+"' title='"+_3e09+"'"+_3e0a+">"+label+"</a>";
}else{
if(link.indexOf("www.",0)>-1&&link.length>4){
_3e08+="<a idx='link' href='htt"+"p://"+link+"' title='htt"+"p://"+link+"'"+_3e0a+">"+label+"</a>";
}else{
if(_3e09.indexOf("#")==0&&_3e06){
_3e09=link.substring(1,link.length);
var _3e0b=_3e09.substring(0,_3e09.indexOf("."));
var title="#"+_3e09;
if(_3e09.indexOf("'")>-1){
_3e09=_3e09.replace(/\'/g,"");
}
if(_3e0b.indexOf(" ")!=-1&&_3e0b.indexOf("'")==-1){
title="#'"+_3e0b+"'"+_3e09.substring(_3e09.indexOf("."),_3e09.length);
}
_3e08+="<a idx='link' onclick = 'gotoCellInit(\""+_3e09+"\");' title= \""+title+"\" "+_3e0a+">"+label+"</a>";
}else{
var _3e0d=(_3e09.indexOf("mailto:",0)>-1)?_3e09.replace("mailto:",""):link;
var _3e0e=validateEmail(_3e0d,false);
if(_3e0e==null&&link.length>5){
_3e08+="<a idx='link' href='mailto:"+_3e0d+"' title='"+jsTitleMsg.mailto+":"+_3e0d+"'"+_3e0a+">"+label+"</a>";
}else{
if(_3e04){
_3e07=false;
_3e08+=label;
}else{
_3e08+="<a idx='link' href='htt"+"p://"+link+"' title='htt"+"p://"+link+"'"+_3e0a+">"+label+"</a>";
}
}
}
}
}
}
return {linkString:_3e08,isLink:_3e07};
}
function constructURL(elem,url,_3e11,_3e12){
if(elem){
if(url!=null&&url!=""){
var ic=/(;|\|<|>)/g;
var str="";
var _3e15="";
str=url;
var _3e16=new Array(str.length);
var temp="";
_3e15=url.replace(ic," ");
str="";
temp="";
var _3e18="";
var _3e19=0;
var _3e1a=0;
var _3e1b=[];
var _3e1c=_3e15.split("\n");
var _3e1d=[];
var _3e1e=0;
var _3e1f=_3e1c.length;
var _3e20=elem.style["color"];
for(var _3e21=0;_3e21<_3e1f;_3e21+=1){
_3e1d=_3e1c[_3e21].split(" ");
_3e1e=_3e1d.length;
for(var _3e22=0;_3e22<_3e1e;_3e22+=1){
_3e1b=_3e1b.concat(_3e1d[_3e22]);
}
}
for(i=0;i<_3e1b.length;i++){
if(i>0){
_3e18=url.charAt(temp.length);
}
var _3e23=constructHyperlinkString(_3e1b[i],escapeSpecialCharacters(_3e1b[i]),true,_3e18,"",_3e20);
if(_3e23.isLink){
str+=_3e23.linkString;
_3e1a+=1;
}else{
str+=_3e23.linkString;
_3e19+=1;
}
temp+=(_3e18)+(_3e1b[i]);
}
setCellInnerHTML(elem,encodeBlankSpaces(str.replace(/\n/g,"<br>"),true));
setHyperLinkStyles(elem,_3e11,_3e12);
}
if(_3e19==0&&_3e1a==1){
elem.setAttribute("hyper","full");
}else{
if(_3e19>0&&_3e1a>0){
elem.setAttribute("hyper","multi");
}else{
elem.removeAttribute("hyper");
}
}
}
}
function setHyperlink(id,nvp,_3e26,sR,sC,eR,eC,text,url){
if(typeof id=="undefined"){
id="add";
}
var _3e2d=new getXmlhttp();
if(typeof nvp=="undefined"){
nvp="";
}
if(typeof _3e26=="undefined"){
_3e26="false";
}
if(typeof text=="undefined"){
text="";
url="";
}
if(typeof sR=="undefined"){
startR=getCellRange().startRow;
startC=getCellRange().startCol;
}else{
startR=sR;
startC=sC;
endR=eR;
endC=eC;
}
var req="";
req="&range=false&srow="+startR+"&scol="+startC;
var _3e2f=getCellContent();
_3e2f=encodeURIComponent(_3e2f);
if(id!="remove"){
var _3e30="";
if(_3e26!="true"){
if(HYPERLINK.urlType=="Web"){
text=getObj("WebText").value;
url=getObj("WebUrl").value;
text=(text.trim()=="")?url:text;
_3e30=url;
}else{
if(HYPERLINK.urlType=="Internal"){
text=getObj("InternalText").value;
var ref=getObj("InternalUrl").value;
if(ref!=""){
var _3e32="";
var _3e33="";
var _3e34="";
var _3e35=CURRSHEETNAME;
if(!isDefinedName(ref)&&!isDefinedSheet(ref)){
ref=ref.replace(/\$/g,"").replace(".","!");
if(forCellLblCheck(ref)){
_3e35=ref.substring(0,ref.indexOf("!"));
_3e35=(_3e35=="")?CURRSHEETNAME:getRequiredSheetNames(_3e35).sheetName;
_3e34=ref.substring(ref.indexOf("!")+1,ref.length);
}else{
setCaretPos(getObj("InternalUrl"),"END");
getObj("InternalUrl").select();
return false;
}
}else{
if(isDefinedSheet(ref)){
_3e35=ref;
}else{
if(isDefinedName(ref)){
_3e32=ref;
_3e33=ref;
_3e35="";
}
}
}
if(_3e35!=""){
var _3e36=_3e35;
if(_3e35.indexOf(" ")!=-1){
_3e36="'"+_3e35+"'";
}
_3e32=(_3e34!="")?_3e35+"."+_3e34:_3e35;
_3e33=(_3e34!="")?_3e36+"."+_3e34:_3e36;
}
text=(text.trim()=="")?_3e32:text;
url="#"+_3e32;
_3e30="#"+_3e33;
}
}else{
if(HYPERLINK.urlType=="Email"){
text=getObj("EmailText").value;
url=getObj("EmailUrl").value;
if(url.indexOf(":")!=-1&&url.substring(0,url.indexOf(":"))=="mailto"){
mailId=url.substring(7,url.length).trim();
}else{
mailId=url;
}
if(mailId!=""){
var _3e37=validateEmail(mailId.trim());
if(_3e37!=null){
showAlertDialog(_3e37);
setCaretPos(getObj("EmailUrl"),"END");
return false;
}
}
text=(text.trim()=="")?url:text;
_3e30=url;
}
}
}
}
if(url.trim()==""||url.trim()=="mailto:"||url.trim()=="htt"+"p://"){
autoFillValue("");
return false;
}
if(nvp==""){
nvp="action="+id;
nvp+=req;
nvp+="&previousValue="+_3e2f;
nvp+="&text="+doit(text);
nvp+="&url="+doit(_3e30);
nvp+="&currtime="+CURRENTTIME;
nvp+="&currsheet="+encodeURIComponent(CURRSHEETNAME);
nvp+="&docowner="+CURR_DOC_OWNERNAME;
nvp+="&docid="+DOCUMENT_ID;
nvp+="&collabid="+COLLAB_ID;
nvp+="&readwrite="+ALLOW_TO_WRITE;
nvp+="&afterRTC="+_3e26;
nvp+="&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&viewType="+getObj("VIEW").value;
nvp+="&isDocSaved="+isDocSaved();
nvp+="&availableStartRow="+getAvailableStartRow();
nvp+="&availableEndRow="+getAvailableEndRow();
nvp+="&totCols="+totCols;
if(jsREMOTE_SAVE_VIEW){
nvp+="&RMLOGINNAME="+RMUSER;
nvp+="&userStateId="+USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _3e38=getObj("apiKey");
if(_3e38!=null){
nvp+="&apiKeyId="+_3e38.value;
}
}
}
nvp+="&bridgeNo="+bridgeNumber;
if(text!=null&&url!=null&&text.trim()!=""&&url.trim()!=""){
_3e2d.onreadystatechange=function(){
if(_3e2d.readyState==4){
gridListener.listen(6);
if(url!=null){
url=revertSplChrs(url);
}
if(text!=null){
text=revertSplChrs(text);
}
var str=constructHyperlinkString(url,text,false,"",true).linkString;
var elem=getCell(startR,startC);
if(elem!=null){
text=replaceSplChrs(text);
setHyperLinkForCell(id,elem,text,str);
if(ISFREEZED){
if(FREEZED_ROW>0){
elem=getCell(startR,startC,sheetPane2Id);
setHyperLinkForCell(id,elem,text,str);
}
if(FREEZED_COL>0){
elem=getCell(startR,startC,sheetPane3Id);
setHyperLinkForCell(id,elem,text,str);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
elem=getCell(startR,startC,sheetPane1Id);
setHyperLinkForCell(id,elem,text,str);
}
}
}
closeDialog();
btn_enabled();
var elem=getCell(startR,startC);
setTooltipForHyperLinkedCell(elem);
if(ISFREEZED){
if(FREEZED_ROW>0){
elem=getCell(startR,startC,sheetPane2Id);
setTooltipForHyperLinkedCell(elem);
}
if(FREEZED_COL>0){
elem=getCell(startR,startC,sheetPane3Id);
setTooltipForHyperLinkedCell(elem);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
elem=getCell(startR,startC,sheetPane1Id);
setTooltipForHyperLinkedCell(elem);
}
}
updateCell(_3e2d.responseXML);
}
};
nvp=appendCSRFToURL(nvp);
postAjax(_3e2d,ctxpath+"hyperlink.do",nvp);
}else{
closeDialog();
}
}
if(id=="remove"){
if(nvp==""){
nvp="action=remove";
nvp+=req;
nvp+="&previousValue="+_3e2f;
nvp+="&currtime="+CURRENTTIME;
nvp+="&currsheet="+encodeURIComponent(CURRSHEETNAME);
nvp+="&docowner="+CURR_DOC_OWNERNAME;
nvp+="&docid="+DOCUMENT_ID;
nvp+="&collabid="+COLLAB_ID;
nvp+="&readwrite="+ALLOW_TO_WRITE;
nvp+="&afterRTC="+_3e26;
nvp+="&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&currentSelection="+getCurrentSelection();
nvp+="&viewType="+getObj("VIEW").value;
nvp+="&isDocSaved="+isDocSaved();
if(jsREMOTE_SAVE_VIEW){
nvp+="&RMLOGINNAME="+RMUSER;
nvp+="&userStateId="+USERSTATEID;
}
if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){
var _3e38=getObj("apiKey");
if(_3e38!=null){
nvp+="&apiKeyId="+_3e38.value;
}
}
}
nvp+="&bridgeNo="+bridgeNumber;
_3e2d.onreadystatechange=function(){
if(_3e2d.readyState==4){
gridListener.listen(6);
var _3e3b=Row.getAvailableRowsInRange(startR,endR);
for(k=0,len=_3e3b.length;k<len;k++){
i=_3e3b[k];
for(j=startC;j<=endC;j++){
var elem=getCell(i,j);
if(elem!=null){
var val=getCellContent(elem);
setHyperLinkForCell(id,elem,val);
if(ISFREEZED){
if(FREEZED_ROW>0){
elem=getCell(i,j,sheetPane2Id);
setHyperLinkForCell(id,elem,val);
}
if(FREEZED_COL>0){
elem=getCell(i,j,sheetPane3Id);
setHyperLinkForCell(id,elem,val);
}
if(FREEZED_ROW>0&&FREEZED_COL>0){
elem=getCell(i,j,sheetPane1Id);
setHyperLinkForCell(id,elem,val);
}
}
}
}
}
closeDialog();
btn_enabled();
updateCell(_3e2d.responseXML);
}
};
nvp=appendCSRFToURL(nvp);
postAjax(_3e2d,ctxpath+"hyperlink.do",nvp);
}
}
function setHyperLinkForCell(_3e3e,elem,val,str){
if(elem!=null){
if(_3e3e=="remove"){
setCellInnerHTML(elem,"");
elem.setAttribute("hyper","null");
setCellContent(elem,val);
}else{
setCellContent(elem,val);
setCellInnerHTML(elem,revertQuote(str));
elem.setAttribute("hyper","full");
var color=elem.style.color;
setHyperLinkStyles(elem,color);
}
}
}
function setTooltipForHyperLinkedCell(elem){
if(elem!=null){
var _3e44=elem.getAttribute("comment");
if(_3e44!=null){
var _3e45=getHyperLinkInCell(elem).childTag;
if(_3e45!=null){
setCellTooltip(_3e45,"");
}
}
}
}
function hyperLinkSetting(){
var hyper=(currCell)?currCell.getAttribute("hyper"):null;
if(hyper=="null"||hyper==null){
showHyperlink("add");
}else{
if(hyper=="full"){
showHyperlink("edit");
}
}
}
function setHyperLinkStyles(elem,_3e48,_3e49){
if(elem!=null){
var _3e4a=getHyperLinkInCell(elem).childTag;
var _3e4b=elem.style["color"];
var _3e4c="";
var _3e4d="";
var _3e4e=elem.style["backgroundColor"];
if(_3e48){
_3e4c=_3e48;
}else{
if(_3e4b){
_3e4c=_3e4b;
}
}
if(_3e49){
_3e4d=_3e49;
}else{
if(_3e4e){
_3e4d=_3e4e;
}
}
if(_3e4c=="rgb(0, 0, 0)"||_3e4c=="rgb(0,0,0)"||_3e4c=="#000000"){
if(!_3e4d){
_3e4c="";
}
if(_3e4d==="rgb(255,255,255)"){
_3e4c="";
}
if(_3e4d!="rgb(255,255,255)"){
_3e4c="inherit";
}
}
var _3e4f=elem;
var cls=elem.className;
if(cls.indexOf("vab")!=-1||cls.indexOf("vam")!=-1){
if(!featureSupport.boxAlign){
_3e4f=getChildNode(getChildNode(elem,0),0);
}
}
if(isCellContainsHyperLink(_3e4f)){
var _3e51=getChildNodesLength(_3e4f);
var kids=_3e4f.childNodes;
var _3e53=kids.length;
for(var _3e54=0;_3e54<_3e53;_3e54++){
_3e4a=kids[_3e54];
if(_3e4a!=null&&_3e4a.nodeName=="A"){
var color="";
if(_3e4c){
color="inherit";
}else{
color="blue";
}
_3e4a.style.color=color;
if(browser_ie){
var _3e56=elem.className;
var _3e57="";
var _3e58=new RegExp(getCSSStyleRegex("fontSize")).exec(_3e56);
if(_3e58!=null){
_3e57=_3e58[0];
}
var _3e59=new RegExp(getCSSStyleRegex("fontFamily")).exec(_3e56);
if(_3e59!=null){
_3e57+=_3e59[0];
}
if(_3e57!=""){
_3e4a.className=_3e57;
}
_3e4a.style.fontSize=getCurrentStyle(elem,"fontSize");
_3e4a.style.fontFamily=getCurrentStyle(elem,"fontFamily");
}else{
_3e4a.style.font="inherit";
}
}
}
}
}
}
function hyperlink(_3e5a,row,col,url,text){
if(url!=null){
url=revertSplChrs(url);
}
if(text!=null){
text=revertSplChrs(text);
}
var str=constructHyperlinkString(url,text,true,"",true).linkString;
text=replaceSplChrs(text);
var elem=getCell(row,col);
if(elem){
setHyperLinkForCell(_3e5a,elem,text,str);
}
if(ISFREEZED){
if(FREEZED_ROW>0&&row<ROWS_PER_TILE){
elem=getCell(row,col,sheetPane2Id);
setHyperLinkForCell(_3e5a,elem,text,str);
}
if(FREEZED_COL>0){
elem=getCell(row,col,sheetPane3Id);
if(elem){
setHyperLinkForCell(_3e5a,elem,text,str);
}
}
if(FREEZED_ROW>0&&FREEZED_COL>0&&row<ROWS_PER_TILE){
elem=getCell(row,col,sheetPane1Id);
setHyperLinkForCell(_3e5a,elem,text,str);
}
}
}
function getRequiredSheetNames(_3e61){
var _3e62=false;
if(_3e61==undefined||_3e61==null){
_3e61="";
}
var _3e63=getObj("sheetsTab").getElementsByTagName("TD");
var _3e64=new Array();
for(var i=0;i<_3e63.length-1;i++){
_3e64[i]=_3e63[i].getAttribute("sheetname");
if(_3e64[i].toUpperCase()==_3e61.toUpperCase()){
_3e61=_3e64[i];
_3e62=true;
}
}
_3e61=(_3e62)?_3e61:"";
return {sheetNames:_3e64,sheetName:_3e61};
}
function getRequiredRangeNames(_3e66){
var _3e67=false;
if(_3e66==undefined||_3e66==null){
_3e66="";
}
var _3e68=new Array();
if(NAMEDRANGES.length!=0){
for(var i=0;i<NAMEDRANGES.length;i++){
_3e68[i]=NAMEDRANGES[i]["NAME"];
if(_3e66.toUpperCase()==_3e68[i].toUpperCase()){
_3e66=_3e68[i];
_3e67=true;
}
}
}
_3e66=(_3e67)?_3e66:"";
return {rangeNames:_3e68,rangeName:_3e66};
}
function checkBoundaryForTextInDiv(_3e6a,_3e6b,cell){
var _3e6d=getHyperLinkInCell(cell).childTag;
if(_3e6d){
if(isObject(_3e6d)&&(_3e6d.tagName)&&((_3e6d.tagName).toUpperCase()=="A")){
var _3e6e=_3e6d.getBoundingClientRect();
fromLeft=_3e6e.left;
fromTop=_3e6e.top;
contentWidth=_3e6e.right-_3e6e.left;
contentHeight=_3e6e.bottom-_3e6e.top;
var _3e6f=fromLeft+contentWidth;
var _3e70=fromTop+contentHeight;
if((_3e6a>=fromLeft&&_3e6a<=_3e6f)&&(_3e6b>=fromTop&&_3e6b<=_3e70)){
return true;
}
}
}
}
function submitFuction(_3e71,e,_3e73){
var key;
if(window.event){
key=window.event.keyCode;
}else{
if(e){
key=e.which;
}
}
if(key==13){
_3e73();
return false;
}else{
if(key==27){
focusCell(currRow,currCol);
return true;
}else{
return true;
}
}
}
function isCellContainsHyperLink(cell){
var _3e76=0;
var _3e77=cell.childNodes;
if(_3e77){
var _3e78=_3e77.length;
for(var i=0;i<_3e78;i++){
var kid=_3e77[i];
if(isHyperLink(kid)){
_3e76=1;
break;
}
}
}
return _3e76;
}
var GoalSeek={dialog:false,temp:0,targetCell:undefined,variableCell:undefined,variableCellSheet:undefined,targetCellSheet:undefined,desiredValue:undefined,vCellSheetName:undefined,vCellLbl:undefined,oldValue:undefined,init:function(){
var _3e7b=getXMLHttpRequest();
_3e7b.onreadystatechange=function(){
if(_3e7b.readyState==4){
var _3e7c=_3e7b.responseText;
GoalSeek.targetSelection(_3e7c);
}
};
postAjax(_3e7b,ctxpath+"pages/GoalSeek.jsp","");
},destroy:function(){
GoalSeek.dialog=false;
GoalSeek.dialog=false;
GoalSeek.temp=0;
GoalSeek.targetCell=undefined;
GoalSeek.variableCell=undefined;
GoalSeek.variableCellSheet=undefined;
GoalSeek.targetCellSheet=undefined;
GoalSeek.desiredValue=undefined;
clearCellRangeFill();
},targetSelection:function(_3e7d){
showDialog(_3e7d,"position=absmiddle,width=320,title="+jsMsg["GoalSeek.UI.GoalSeek"]+",closeOnEscKey=yes,modal=no",positionDialog,GoalSeek.destroy);
this.dialog=true;
this.variableCell=getObj("variableCell");
this.targetCell=getObj("targetCell");
this.targetCell.value=getCellLabel(currRow,currCol);
this.variableCell.focus();
},submit:function(){
var _3e7e=this.variableCell.value.replace("!",".");
var _3e7f=this.targetCell.value.replace("!",".");
if(!RangeRef.isSingleCell(_3e7e)){
showAlertDialog(jsMsg["GoalSeek.Msg.InvalidCell"]);
this.variableCell.focus();
return;
}
if(!RangeRef.isSingleCell(_3e7f)){
showAlertDialog(jsMsg["GoalSeek.Msg.InvalidCell"]);
this.targetCell.focus();
return;
}
this.desiredValue=getObj("desiredValue").value;
if(this.desiredValue.length==0){
showAlertDialog(jsMsg["GoalSeek.Msg.Blank"]);
getObj("desiredValue").focus();
return;
}
this.vCellSheetName=RangeRef.getSheetName(_3e7e);
var _3e80=RangeRef.getSheetName(_3e7f);
this.vCellLbl=RangeRef.getCellRef(_3e7e);
var _3e81=RangeRef.getCellRef(_3e7f);
var _3e82=getXMLHttpRequest();
_3e82.onreadystatechange=function(){
if(_3e82.readyState==4){
GoalSeek.responseHandler(_3e82);
}
};
var nvp="docid="+DOCUMENT_ID+"&sheetName="+encodeURIComponent(CURRSHEETNAME)+"&vCellSheetName="+encodeURIComponent(this.vCellSheetName)+"&tCellSheetName="+encodeURIComponent(_3e80)+"&curtime="+CURRENTTIME;
nvp+="&availableStartRow="+getAvailableStartRow()+"&availableEndRow="+getAvailableEndRow()+"&docowner="+CURR_DOC_OWNERNAME;
nvp+="&variableCell="+this.vCellLbl+"&targetCell="+_3e81+"&desiredValue="+getObj("desiredValue").value+"&actionConstants="+ActionConstants.GOAL_SEEK;
if(USERSTATEID!=""){
nvp+="&userStateId="+USERSTATEID;
}
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols+"&viewType="+getViewType();
nvp=postAjax(_3e82,ctxpath+"goalseek.do",nvp);
},responseHandler:function(_3e84){
var _3e85=eval("("+_3e84.responseText+")");
var _3e86=_3e85.message;
var _3e87=_3e85.solution;
if(_3e87!=null){
var _3e88=_3e85.clientUpdateJson;
updateJson(_3e88);
var _3e89=_3e85.TargetCellValue;
this.oldValue=_3e85.value;
document.getElementById("goalSeekDialog").parentNode.parentNode.parentNode.previousSibling.childNodes[2].childNodes[0].style.display="none";
GoalSeek.toggleVisibility("goalSeekResultDialog","goalSeekDialog");
closeOnEscKey=false;
freezeBackground({"BGColor":"","opacity":""});
setFreezeLayerHeight();
document.getElementById("message").innerHTML=_3e86;
document.getElementById("targetCellValue").innerHTML=_3e89;
document.getElementById("content").innerHTML=_3e87;
}else{
showAlertDialog(_3e86);
getObj("desiredValue").focus();
}
},constructOkCancelRequest:function(_3e8a){
var nvp="docid="+DOCUMENT_ID+"&sheetName="+encodeURIComponent(CURRSHEETNAME)+"&vCellSheetName="+encodeURIComponent(this.vCellSheetName)+"&curtime="+CURRENTTIME;
nvp+="&availableStartRow="+getAvailableStartRow()+"&availableEndRow="+getAvailableEndRow()+"&docowner="+CURR_DOC_OWNERNAME;
nvp+="&variableCell="+this.vCellLbl+"&actionConstants="+_3e8a+"&value="+encodeURIComponent(this.oldValue);
if(COLLABORATIVE_EDITING=="ON"){
nvp+="&collabid="+COLLAB_ID+"&iscollab=true";
}else{
nvp+="&iscollab=false";
}
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols+"&viewType="+getViewType();
return nvp;
},submitCancel:function(){
var _3e8c=GoalSeek.constructOkCancelRequest(ActionConstants.GOAL_SEEK_CANCEL);
var _3e8d=getXMLHttpRequest();
_3e8d.onreadystatechange=function(){
if(_3e8d.readyState==4){
var _3e8e=eval("("+_3e8d.responseText+")");
var _3e8f=_3e8e.clientUpdateJson;
updateJson(_3e8f);
closeDialog();
GoalSeek.destroy();
return;
}
};
postAjax(_3e8d,ctxpath+"goalseek.do",_3e8c);
},submitOk:function(){
var _3e90=GoalSeek.constructOkCancelRequest(ActionConstants.GOAL_SEEK_OK);
var _3e91=getXMLHttpRequest();
_3e91.onreadystatechange=function(){
if(_3e91.readyState==4){
var _3e92=eval("("+_3e91.responseText+")");
setUNDO(_3e92.u);
btn_enabled();
closeDialog();
GoalSeek.destroy();
return;
}
};
postAjax(_3e91,ctxpath+"goalseek.do",_3e90);
},focusCell:function(ev){
resetCellRangeFill();
isEditingInExprField=false;
clearTextSelection();
var el=(browser_ie)?window.event.srcElement:ev.target;
rangeFill=true;
if(el&&isCell(el)){
cellRangeStartRow=getRowPosInMouseEvent(ev);
cellRangeStartCol=getColPosInMouseEvent(ev);
var info=Merge.getCellInfo(cellRangeStartRow,cellRangeStartCol);
var _3e96=cellRangeStartRow;
var _3e97=cellRangeStartRow;
var _3e98=cellRangeStartCol;
var _3e99=cellRangeStartCol;
if(info){
_3e96=info["startRow"];
_3e97=info["endRow"];
_3e98=info["startCol"];
_3e99=info["endCol"];
}
funRow=_3e96;
funCol=_3e98;
functionLeft=getEndLeftOfCol(_3e97);
functionTop=getEndTopOfRow(_3e99);
rangeFill=true;
var dim=getCellRangeDIM(_3e96,_3e98,_3e97,_3e99);
setCellRangeFillDIVPos(dim.left,dim.top);
setCellRangeFillDIVDim(dim.width,dim.height);
showCellRangeFillDIV();
}
},toggleVisibility:function(id1,id2){
var ele1=document.getElementById(id1);
var ele2=document.getElementById(id2);
ele1.style.display="block";
ele2.style.display="none";
},submitOnEnter:function(e){
var key;
if(window.event){
key=window.event.keyCode;
}else{
key=e.which;
}
if(key!=13){
return true;
}else{
return GoalSeek.submit();
}
}};
var RangeRef={isSingleCell:function(_3ea1){
var cellN=false;
_3ea1=_3ea1.replace("!",".");
if(_3ea1.indexOf(".")!=-1){
var _3ea3=_3ea1.substring(0,_3ea1.indexOf("."));
if(_3ea3.indexOf(" ")!=-1&&_3ea3.indexOf("'")==0){
_3ea3=_3ea3.substring(1,_3ea3.length-1);
}
if(!isDefinedSheet(_3ea3)){
return false;
}
_3ea1=_3ea1.substring(_3ea1.indexOf(".")+1,_3ea1.length);
}
if(_3ea1.indexOf(":")!=-1){
return false;
}else{
if(isCellLabel(_3ea1)){
cellN=true;
}
}
return cellN;
},getSheetName:function(_3ea4){
if(_3ea4.indexOf(".")!=-1){
var _3ea5=_3ea4.substring(0,_3ea4.indexOf("."));
if(_3ea5.indexOf(" ")!=-1&&_3ea5.indexOf("'")==0){
_3ea5=_3ea5.substring(1,_3ea5.length-1);
}
return _3ea5;
}else{
return CURRSHEETNAME;
}
},getCellRef:function(_3ea6){
if(_3ea6.indexOf(".")!=-1){
var _3ea7=_3ea6.split(".");
return _3ea7[1];
}else{
return _3ea6;
}
}};
function showConditionalDialog(){
if(jsSHARE_VIEW&&!ALLOW_TO_WRITE){
showURLInDialog(ctxpath+"pages/conditionalformat.jsp?showtab=managerule","position=absmiddle,top=-100,title="+jsMsg.CFormat+",width=575",showManageRulesForReadOnlyView);
}else{
showURLInDialog(ctxpath+"pages/conditionalformat.jsp?showtab=createrule","position=absmiddle,top=-100,title="+jsMsg.CFormat+",width=575",cfOpenCallBack,"",resetCFDialogOpen);
}
if(isConditionalDialogOpen){
closeDialog();
}
}
function resetCFDialogOpen(){
isConditionalDialogOpen=false;
closeDialog();
resetCellRangeFill("conditionalDialogContent");
clearCellRangeFill();
}
function showCreateRule(){
isConditionalDialogOpen=true;
getObj("createRuleTab").className="selected";
getObj("manageRulesTab").className="";
getObj("createRuleContent").style.display="";
getObj("manageRulesContent").style.display="none";
}
function showManageRulesForReadOnlyView(){
isConditionalDialogOpen=false;
getObj("manageRulesTab").className="selected";
getObj("createRuleContent").style.display="none";
getObj("createRuleTab").style.display="none";
getObj("manageRulesContent").style.display="";
getManageRuleContent(ActionConstants.CONDITIONAL_FORMAT_READ_SHEET);
positionDialog();
}
function showManageRules(){
isConditionalDialogOpen=false;
getObj("createRuleTab").className="";
getObj("manageRulesTab").className="selected";
getObj("createRuleContent").style.display="none";
var _3ea8=getObj("manageRulesContent");
_3ea8.style.display="";
var _3ea9=_3ea8.getElementsByTagName("select");
_3ea9[0].selectedIndex=1;
getManageRuleContent(ActionConstants.CONDITIONAL_FORMAT_READ_SHEET);
}
function toggleRuleList(obj){
$(obj).find("div:first").toggle();
var tbl=$(obj).find("table:first");
if($(tbl).hasClass("treeExpand")){
$(tbl).removeClass("treeExpand").addClass("treeCollapse");
}else{
if($(tbl).hasClass("treeCollapse")){
$(tbl).removeClass("treeCollapse").addClass("treeExpand");
}
}
}
function changeState(_3eac){
var el=document.getElementById("condFormat");
if(_3eac=="expand"){
$(el).find("table.treeCollapse").removeClass("treeCollapse").addClass("treeExpand");
$(el).find("div").css("display","none").toggle();
}else{
if(_3eac=="collapse"){
$(el).find("table.treeExpand").removeClass("treeExpand").addClass("treeCollapse");
$(el).find("div").css("display","").toggle();
}
}
return false;
}
function setCombo(el){
var _3eaf=el.parentNode.parentNode;
var _3eb0=_3eaf.getElementsByTagName("select");
var _3eb1=_3eaf.getElementsByTagName("div");
var index=_3eb0[0].selectedIndex;
var _3eb3=$(_3eb1[1]).find(":input");
_3eb3.datepicker("destroy");
var _3eb4=$(_3eb1[2]).find(":input:first");
_3eb4.datepicker("destroy");
var _3eb5=$(_3eb1[2]).find(":input:last");
_3eb5.datepicker("destroy");
var _3eb6=$(_3eb1[1]).find(":input:first");
if(index==0){
_3eb0[1].selectedIndex=0;
_3eb0[1].style.display="";
_3eb0[2].style.display="none";
_3eb0[3].style.display="none";
_3eb0[4].style.display="none";
_3eb1[1].style.display="";
_3eb1[2].style.display="none";
_3eb1[3].innerHTML=jsMsg["CFormat.Sample1"];
$(_3eb6).toggleClass("cR",false);
$(_3eb6).css("width","200px");
$(_3eb6).val("");
_3eb1[3].style.visibility="";
}else{
if(index==1){
_3eb0[2].selectedIndex=0;
_3eb0[1].style.display="none";
_3eb0[2].style.display="";
_3eb0[3].style.display="none";
_3eb0[4].style.display="none";
_3eb1[1].style.display="";
_3eb1[2].style.display="none";
_3eb1[3].innerHTML=jsMsg["CFormat.Sample3"];
$(_3eb6).toggleClass("cR",false);
$(_3eb6).css("width","200px");
$(_3eb6).val("");
_3eb1[3].style.visibility="";
}else{
if(index==2){
_3eb0[3].selectedIndex=0;
_3eb0[1].style.display="none";
_3eb0[2].style.display="none";
_3eb0[3].style.display="";
_3eb0[4].style.display="none";
_3eb1[1].style.display="none";
_3eb1[2].style.display="none";
_3eb1[3].style.visibility="hidden";
}else{
if(index==3){
_3eb0[4].selectedIndex=0;
_3eb0[1].style.display="none";
_3eb0[2].style.display="none";
_3eb0[3].style.display="none";
_3eb0[4].style.display="";
_3eb1[1].style.display="none";
_3eb1[2].style.display="none";
_3eb1[3].style.visibility="hidden";
}else{
_3eb0[1].style.display="none";
_3eb0[2].style.display="none";
_3eb0[3].style.display="none";
_3eb0[4].style.display="none";
_3eb1[1].style.display="";
_3eb1[2].style.display="none";
_3eb1[3].style.visibility="hidden";
var _3eb6=$(_3eb1[1]).find(":input:first");
$(_3eb6).css("width","385px");
$(_3eb6).toggleClass("cR");
$(_3eb6).val("=");
}
}
}
}
}
function getListItems(el){
var _3eb8=el.parentNode.parentNode;
var _3eb9=_3eb8.getElementsByTagName("div");
var iElem=$(_3eb9[1]).find(":input");
var _3ebb=el.value;
if(_3ebb<=ConditionalFormatOperator.NOT_EQUAL){
_3eb9[1].style.display="";
_3eb9[2].style.display="none";
$(iElem).css("width","200px");
_3eb9[3].innerHTML=jsMsg["CFormat.Sample1"];
}else{
if(_3ebb==ConditionalFormatOperator.BETWEEN||_3ebb==ConditionalFormatOperator.NOT_BETWEEN){
_3eb9[2].style.display="";
_3eb9[1].style.display="none";
_3eb9[3].innerHTML=jsMsg["CFormat.Sample2"];
}else{
if(_3ebb>=ConditionalFormatOperator.TEXT_CONTAINING&&_3ebb<=ConditionalFormatOperator.TEXT_ENDINGWITH){
_3eb9[1].style.display="";
_3eb9[2].style.display="none";
_3eb9[3].innerHTML=jsMsg["CFormat.Sample3"];
}else{
if(_3ebb>=ConditionalFormatOperator.DATE_BEFORE&&_3ebb<=ConditionalFormatOperator.DATE_NOT_ON){
_3eb9[1].style.display="";
$(iElem).css("width","190px");
$(iElem).toggleClass("cR",false);
$(iElem).val("");
var _3ebc=$(_3eb9[1]).find(":input");
_3ebc.datepicker({showOn:"button",buttonImage:"styles/blue/images/datetime.png",buttonImageOnly:true,changeMonth:true,changeYear:true,buttonText:jsMsg["Filter.date"],constrainInput:false});
$(".ui-datepicker-trigger").mouseover(function(){
$(this).css("cursor","pointer");
});
_3eb9[2].style.display="none";
_3eb9[3].style.visibility="hidden";
}else{
if(_3ebb==ConditionalFormatOperator.DATE_BETWEEN||_3ebb==ConditionalFormatOperator.DATE_NOT_BETWEEN){
_3eb9[2].style.display="";
_3eb9[1].style.display="none";
_3eb9[3].style.visibility="hidden";
var _3ebd=$(_3eb9[2]).find(":input:first");
_3ebd.datepicker({showOn:"button",buttonImage:"styles/blue/images/datetime.png",buttonImageOnly:true,changeMonth:true,changeYear:true,buttonText:jsMsg["Filter.date"],constrainInput:false});
$(".ui-datepicker-trigger").mouseover(function(){
$(this).css("cursor","pointer");
});
var _3ebe=$(_3eb9[2]).find(":input:last");
_3ebe.datepicker({showOn:"button",buttonImage:"styles/blue/images/datetime.png",buttonImageOnly:true,changeMonth:true,changeYear:true,buttonText:jsMsg["Filter.date"],constrainInput:false});
$(".ui-datepicker-trigger").mouseover(function(){
$(this).css("cursor","pointer");
});
}else{
_3eb9[1].style.display="none";
_3eb9[2].style.display="none";
_3eb9[3].style.visibility="hidden";
}
}
}
}
}
}
function checkRuleState(id,state){
var el=getObj(id);
var combo=el.getElementsByTagName("select");
for(var i=0;i<combo.length;i++){
combo[i].disabled=!state;
}
var _3ec4=el.getElementsByTagName("input");
for(var i=0;i<_3ec4.length;i++){
_3ec4[i].disabled=!state;
}
}
function resetRules(){
for(var x=1;x<=3;x++){
var _3ec6=$("#rule"+x);
$(_3ec6).find("input[name*=\"val\"]").val("");
var _3ec7=$(_3ec6).find("div");
_3ec7[2].style.display="";
_3ec7[3].style.display="none";
}
$("input[name*=\"chk_rule\"]:gt(0)").attr("checked",false);
$("div[id*=\"rule\"]:gt(0)").find("select").attr("disabled","disabled");
$("div[id*=\"rule\"]:gt(0)").find("input").attr("disabled","disabled");
$("div[id*=\"rule\"]").find("div:last").attr("style","");
}
function cfOpenCallBack(){
var rule1=document.getElementById("rule1").getElementsByTagName("table")[0];
var _3ec9=document.getElementById("rule1").getElementsByTagName("div")[0];
var _3eca=_3ec9.cloneNode(true);
var _3ecb=rule1.cloneNode(true);
var rule2=document.getElementById("rule2");
rule2.appendChild(_3eca);
rule2.appendChild(_3ecb);
var _3ecd=_3ec9.cloneNode(true);
var _3ece=rule1.cloneNode(true);
var rule3=document.getElementById("rule3");
rule3.appendChild(_3ecd);
rule3.appendChild(_3ece);
var combo=rule1.getElementsByTagName("select");
for(var i=0;i<combo.length;i++){
combo[i].disabled=false;
}
var _3ed2=rule1.getElementsByTagName("input");
for(var i=0;i<_3ed2.length;i++){
_3ed2[i].disabled=false;
}
if(showtab=="managerule"){
showManageRules();
isConditionalDialogOpen=false;
}else{
var _3ed3=cfRange();
var _3ed4=_3ed3.startRow;
var _3ed5=_3ed3.startCol;
var _3ed6=_3ed3.endRow;
var _3ed7=_3ed3.endCol;
var _3ed8=CURRSHEETNAME+"."+getColHeadLabel(_3ed5+1)+(_3ed4+1)+":"+getColHeadLabel(_3ed7+1)+(_3ed6+1);
if(_3ed8.length>20){
$("#appliestofield").attr("dir","rtl");
}
document.conditionalForm.appliesto.value=_3ed8;
var _3ed9="";
var _3eda="&sheetname="+encodeURIComponent(CURRSHEETNAME)+"&action="+ActionConstants.CONDITIONAL_FORMAT_READ_RANGE+"&sR="+_3ed4+"&eR="+_3ed6+"&sC="+_3ed5+"&eC="+_3ed7+"&rowHeight="+_3ed9;
sendCFormatRequest(_3eda,false);
isConditionalDialogOpen=true;
}
try{
registerIconEvents(document.getElementById("rule1").getElementsByTagName("table")[2].getElementsByTagName("TD"));
registerIconEvents(document.getElementById("rule2").getElementsByTagName("table")[2].getElementsByTagName("TD"));
registerIconEvents(document.getElementById("rule3").getElementsByTagName("table")[2].getElementsByTagName("TD"));
}
catch(e){
}
positionDialog();
}
function loadExistingRules(_3edb){
var cnt=parseInt(_3edb["NOOFCOND"]);
var _3edd=document.getElementById("appliesto").getElementsByTagName("input")[0].value;
if(_3edb["RANGENAME"]!=null){
document.getElementById("appliesto").getElementsByTagName("input")[0].value=_3edb["RANGENAME"];
}
if(cnt>3){
cnt=3;
}
for(var x=1;x<=cnt;x++){
var _3edf=document.getElementById("rule"+x);
if(_3edf!=null){
var _3ee0=_3edf.getElementsByTagName("select");
var _3ee1=_3edf.getElementsByTagName("input");
var _3ee2=_3edf.getElementsByTagName("div");
if(document.getElementById("chk_rule"+x)!=null){
document.getElementById("chk_rule"+x).checked=true;
}
var _3ee3=getStyle(_3edb["CSTYLE"+x]);
var _3ee4=_3ee2[_3ee2.length-1];
_3ee4.style.cssText=""+_3ee3;
var cond=_3edb["COND"+x];
var val=_3edb["CVAL"+x];
_3ee0[0].style.display="";
if(x>1){
_3edf.checked=true;
for(var i=0;i<_3ee0.length;i++){
_3ee0[i].disabled=false;
}
for(var i=0;i<_3ee1.length;i++){
_3ee1[i].disabled=false;
}
}
if(cond<=ConditionalFormatOperator.NOT_EQUAL){
_3ee0[0].options[0].selected=true;
_3ee0[1].style.display="";
_3ee0[2].style.display="none";
_3ee0[3].style.display="none";
_3ee0[4].style.display="none";
for(var j=0;j<_3ee0[1].length;j++){
if(_3ee0[1].options[j].value==cond){
_3ee0[1].options[j].selected=true;
break;
}
}
_3ee2[2].style.display="";
_3ee2[3].style.display="none";
_3ee1[0].value=""+val.replace(/\"/g,"");
}else{
if(cond==ConditionalFormatOperator.BETWEEN||cond==ConditionalFormatOperator.NOT_BETWEEN){
_3ee0[0].options[0].selected=true;
_3ee0[1].style.display="";
_3ee0[2].style.display="none";
_3ee0[3].style.display="none";
_3ee0[4].style.display="none";
for(var j=0;j<_3ee0[1].length;j++){
if(_3ee0[1].options[j].value==cond){
_3ee0[1].options[j].selected=true;
break;
}
}
_3ee2[3].style.display="";
_3ee2[2].style.display="none";
_3ee1[1].value=val.split(",")[0];
_3ee1[2].value=val.split(",")[1];
}else{
if(cond>=ConditionalFormatOperator.TEXT_CONTAINING&&cond<=ConditionalFormatOperator.TEXT_ENDINGWITH){
_3ee0[0].options[1].selected=true;
_3ee0[1].style.display="none";
_3ee0[2].style.display="";
_3ee0[3].style.display="none";
_3ee0[4].style.display="none";
for(var j=0;j<_3ee0[2].length;j++){
if(_3ee0[2].options[j].value==cond){
_3ee0[2].options[j].selected=true;
break;
}
}
_3ee2[2].style.display="";
_3ee2[3].style.display="none";
val=val.replace(/\\\\/g,"\\");
_3ee1[0].value=val;
}else{
if(cond>=ConditionalFormatOperator.YESTERDAY&&cond<=ConditionalFormatOperator.NEXT_YEAR){
_3ee0[0].options[2].selected=true;
_3ee0[1].style.display="none";
_3ee0[2].style.display="none";
_3ee0[3].style.display="";
_3ee0[4].style.display="none";
for(var j=0;j<_3ee0[3].length;j++){
if(_3ee0[3].options[j].value==cond){
_3ee0[3].options[j].selected=true;
break;
}
}
_3ee2[2].style.display="none";
_3ee2[3].style.display="none";
}else{
if(cond>=ConditionalFormatOperator.DATE_BEFORE&&cond<=ConditionalFormatOperator.DATE_NOT_ON){
_3ee0[0].options[2].selected=true;
_3ee0[1].style.display="none";
_3ee0[2].style.display="none";
_3ee0[3].style.display="";
_3ee0[4].style.display="none";
for(var j=0;j<_3ee0[3].length;j++){
if(_3ee0[3].options[j].value==cond){
_3ee0[3].options[j].selected=true;
break;
}
}
_3ee2[2].style.display="";
var _3ee9=$(_3ee2[2]).find(":input");
_3ee9.datepicker({showOn:"button",buttonImage:"styles/blue/images/datetime.png",buttonImageOnly:true,changeMonth:true,changeYear:true,buttonText:jsMsg["Filter.date"],constrainInput:false});
$(".ui-datepicker-trigger").mouseover(function(){
$(this).css("cursor","pointer");
});
_3ee2[3].style.display="none";
_3ee1[0].style.width="190px";
_3ee1[0].value=""+val.replace(/\"/g,"");
}else{
if(cond==ConditionalFormatOperator.DATE_BETWEEN||cond==ConditionalFormatOperator.DATE_NOT_BETWEEN){
_3ee0[0].options[2].selected=true;
_3ee0[1].style.display="none";
_3ee0[2].style.display="none";
_3ee0[3].style.display="";
_3ee0[4].style.display="none";
for(var j=0;j<_3ee0[3].length;j++){
if(_3ee0[3].options[j].value==cond){
_3ee0[3].options[j].selected=true;
break;
}
}
_3ee2[3].style.display="";
_3ee2[2].style.display="none";
_3ee1[1].value=val.split(",")[0];
_3ee1[2].value=val.split(",")[1];
var _3eea=$(_3ee2[3]).find(":input:first");
_3eea.datepicker({showOn:"button",buttonImage:"styles/blue/images/datetime.png",buttonImageOnly:true,changeMonth:true,changeYear:true,buttonText:jsMsg["Filter.date"],constrainInput:false});
$(".ui-datepicker-trigger").mouseover(function(){
$(this).css("cursor","pointer");
});
var _3eeb=$(_3ee2[3]).find(":input:last");
_3eeb.datepicker({showOn:"button",buttonImage:"styles/blue/images/datetime.png",buttonImageOnly:true,changeMonth:true,changeYear:true,buttonText:jsMsg["Filter.date"],constrainInput:false});
$(".ui-datepicker-trigger").mouseover(function(){
$(this).css("cursor","pointer");
});
}else{
if(cond>=ConditionalFormatOperator.ISBLANK&&cond<=ConditionalFormatOperator.ISNOTERROR){
_3ee0[0].options[3].selected=true;
_3ee0[1].style.display="none";
_3ee0[2].style.display="none";
_3ee0[3].style.display="none";
_3ee0[4].style.display="";
for(var j=0;j<_3ee0[4].length;j++){
if(_3ee0[4].options[j].value==cond){
_3ee0[4].options[j].selected=true;
break;
}
}
_3ee2[2].style.display="none";
_3ee2[3].style.display="none";
}else{
_3ee0[0].options[4].selected=true;
_3ee0[1].style.display="none";
_3ee0[2].style.display="none";
_3ee0[3].style.display="none";
_3ee0[4].style.display="none";
_3ee2[2].style.display="";
_3ee2[3].style.display="none";
var _3eec=$(_3ee2[2]).find(":input:first");
$(_3eec).css("width","385px");
$(_3eec).toggleClass("cR");
val=val.replace(/\\\\/g,"\\");
$(_3eec).val("="+val);
}
}
}
}
}
}
}
_3ee2[4].innerHTML="";
}
}
}
function colorRGBtoHex(_3eed){
if(_3eed!="transparent"&&_3eed.indexOf("#")==-1){
var colr=_3eed.substring(_3eed.indexOf("(")+1,_3eed.indexOf(")"));
var _3eef=colr.split(",");
hexstr=d2h(_3eef[0].trim());
hexstr+=d2h(_3eef[1].trim());
hexstr+=d2h(_3eef[2].trim());
return "#"+hexstr;
}
return null;
}
function getStyleOfPreview(elem){
var _3ef1="";
if(elem.style.backgroundColor!=""){
var _3ef2=colorRGBtoHex(elem.style.backgroundColor);
if(_3ef2==null){
_3ef2=elem.style.backgroundColor;
}
_3ef1+=_3ef2+"~";
}else{
_3ef1+="none~";
}
if(elem.style.color!=""){
var _3ef2=colorRGBtoHex(elem.style.color);
if(_3ef2==null){
_3ef2=elem.style.color;
}
_3ef1+=_3ef2+"~";
}else{
_3ef1+="none~";
}
if(elem.style.fontWeight!=""){
_3ef1+="true~";
}else{
_3ef1+="false~";
}
if(elem.style.fontStyle!=""){
_3ef1+="true~";
}else{
_3ef1+="false~";
}
if(elem.style.textDecoration!=""){
_3ef1+="single";
}else{
_3ef1+="none";
}
return _3ef1;
}
function applyCondFormat(){
if(isValidRange(document.conditionalForm.appliesto.value,"submit")){
var _3ef3=false;
var _3ef4="";
var _3ef5=0;
var _3ef6="{";
for(var e=1;e<=3;e++){
var _3ef8=document.getElementById("chk_rule"+e);
if(_3ef8.checked){
_3ef5++;
var cond=0;
var val="";
var _3efb="";
var _3efc=document.getElementById("rule"+e);
var _3efd=_3efc.getElementsByTagName("select");
var _3efe=_3efc.getElementsByTagName("input");
var _3eff=_3efc.getElementsByTagName("div");
var _3f00=_3eff[_3eff.length-1];
var index=_3efd[0].selectedIndex;
if(index==0){
cond=_3efd[1].value;
}else{
if(index==1){
cond=_3efd[2].value;
}else{
if(index==2){
cond=_3efd[3].value;
}else{
if(index==3){
cond=_3efd[4].value;
}else{
if(index==4){
cond=ConditionalFormatOperator.FORMULA;
}
}
}
}
}
if((cond<=ConditionalFormatOperator.NOT_EQUAL)||(cond>=ConditionalFormatOperator.TEXT_CONTAINING&&cond<=ConditionalFormatOperator.TEXT_ENDINGWITH)||(cond>=ConditionalFormatOperator.DATE_BEFORE&&cond<=ConditionalFormatOperator.DATE_NOT_ON)||(cond==ConditionalFormatOperator.FORMULA)){
if(_3efe[0].value==""){
_3ef3=true;
break;
}
val=_3efe[0].value;
val=val.replace(/\\/g,"\\\\");
val=val.replace(/([\\"'])/g,"\\$1").replace(/\0/g,"\\0");
}else{
if(cond==ConditionalFormatOperator.BETWEEN||cond==ConditionalFormatOperator.NOT_BETWEEN||cond==ConditionalFormatOperator.DATE_BETWEEN||cond==ConditionalFormatOperator.DATE_NOT_BETWEEN){
if(_3efe[1].value==""||_3efe[2].value==""){
_3ef3=true;
break;
}
val=_3efe[1].value+","+_3efe[2].value;
}
}
_3efb=getStyleOfPreview(_3f00);
_3ef6+="\"COND"+_3ef5+"\":"+cond+",\"CVAL"+_3ef5+"\":\""+encodeURIComponent(val)+"\",\"CSTYLE"+_3ef5+"\":\""+_3efb+"\",";
}
}
if(_3ef3){
showAlertDialog(jsMsg["CFormat.FieldsBlank"]);
}else{
_3ef6+="\"NOOFCOND\":"+_3ef5+"}";
var _3f02=getRangeValues(document.conditionalForm.appliesto.value);
var _3f03=_3f02.startRow;
var _3f04=_3f02.startCol;
var _3f05=_3f02.endRow;
var _3f06=_3f02.endCol;
var _3f07=fetchRowHeights(_3f03,_3f05);
_3ef4+="&sheetname="+encodeURIComponent(CURRSHEETNAME)+"&action="+ActionConstants.CONDITIONAL_FORMAT_APPLY+"&sR="+_3f03+"&eR="+_3f05+"&sC="+_3f04+"&eC="+_3f06+"&rowHeight="+_3f07+"&conditionsparam="+_3ef6;
sendCFormatRequest(_3ef4,false);
resetCFDialogOpen();
closeDialog();
}
}
}
function cfRange(){
var _3f08;
var _3f09;
var _3f0a;
var _3f0b;
if(isCellRange()){
var _3f0c=getCellRange();
_3f08=_3f0c.startRow;
_3f09=_3f0c.startCol;
_3f0a=_3f0c.endRow;
_3f0b=_3f0c.endCol;
if(isRowSelected()){
_3f09=0;
_3f0b=getColMax()-1;
}
if(isColSelected()){
_3f08=0;
_3f0a=getRowMax()-1;
}
if(isRowSelected()&&isColSelected()){
_3f0b=_3f0b;
_3f0a=_3f0a;
}
}else{
_3f08=_3f0a=ActiveCellInfo.getStartRow();
_3f09=_3f0b=ActiveCellInfo.getStartCol();
}
return {type:"RANGE",startRow:_3f08,startCol:_3f09,endRow:_3f0a,endCol:_3f0b};
}
function updateCFChangesInHtmlClient(_3f0d,_3f0e,sname){
var _3f10=_3f0d.A;
if(typeof _3f10=="undefined"){
return;
}
if(_3f10==69){
var _3f11=_3f0d.RI;
var _3f12=_3f0d.CI;
var _3f13=getCell(_3f11,_3f12);
var _3f14,_3f15,_3f16;
if(ISFREEZED){
if(FREEZED_ROW>0&&_3f11<FREEZED_ROW){
_3f14=getCell(_3f11,_3f12,sheetPane2Id);
}
if(FREEZED_COL>0&&_3f12<FREEZED_COL){
_3f15=getCell(_3f11,_3f12,sheetPane3Id);
}
if(FREEZED_ROW>0&&FREEZED_COL>0&&_3f11<FREEZED_ROW&&_3f12<FREEZED_COL){
_3f16=getCell(_3f11,_3f12,sheetPane1Id);
}
}
if(_3f13!=null&&_3f13!="null"){
var _3f17=_3f0d.CF;
for(var x=0,len=_3f17.length;x<len;x++){
setCellFormat(_3f13,_3f17[x],_3f17[x].SA);
if(ISFREEZED){
if(_3f14){
setCellFormat(_3f14,_3f17[x],_3f17[x].SA);
}
if(_3f15){
setCellFormat(_3f15,_3f17[x],_3f17[x].SA);
}
if(_3f16){
setCellFormat(_3f16,_3f17[x],_3f17[x].SA);
}
}
}
}
}
}
function updateCFRTC(msg){
var _3f1b=parseInt(msg["SUBMODE"]);
var sname=msg["SHEETNAME"];
if(typeof (msg["CFCONTENT"])!="undefined"){
var _3f1d=parseJSON(msg["CFCONTENT"]);
if(_3f1b==ActionConstants.CONDITIONAL_FORMAT_APPLY||_3f1b==ActionConstants.CONDITIONAL_FORMAT_EDIT||_3f1b==ActionConstants.CONDITIONAL_FORMAT_DELETE){
if(typeof (_3f1d.CFPARAMS)!="undefined"&&_3f1d.CFPARAMS!=""){
var sR=_3f1d.SR;
var sC=_3f1d.SC;
var eR=_3f1d.ER;
var eC=_3f1d.EC;
var _3f22=JSON.stringify(_3f1d.CFPARAMS);
var _3f23=fetchRowHeights(startRow,endRow);
var _3f24="&sheetname="+encodeURIComponent(sname)+"&action="+_3f1b+"&sR="+sR+"&eR="+eR+"&sC="+sC+"&eC="+eC+"&rowHeight="+_3f23+"&conditionsparam="+_3f22;
sendCFormatRequest(_3f24,true);
}
}
}
}
function clearForRange(sR,sC,eR,eC){
for(var _3f29=sR;_3f29<=eR;_3f29++){
for(var _3f2a=sC;_3f2a<=eC;_3f2a++){
var _3f2b=getCell(_3f29,_3f2a);
_3f2b.style["color"]="";
_3f2b.style["backgroundColor"]="";
removeCSSStyle("fontStyle",_3f2b);
removeCSSStyle("fontWeight",_3f2b);
removeCSSStyle("textDecoration",_3f2b);
}
}
}
function getFormula(cond,val){
var condn=parseInt(cond);
var _3f2f;
switch(condn){
case ConditionalFormatOperator.LESS_THAN:
_3f2f=jsMsg["CFormat.Condition.LessThan"]+" "+val;
break;
case ConditionalFormatOperator.GREATER_THAN:
_3f2f=jsMsg["CFormat.Condition.GreaterThan"]+" "+val;
break;
case ConditionalFormatOperator.LESS_EQUAL:
_3f2f=jsMsg["CFormat.Condition.LessThanOrEqual"]+" "+val;
break;
case ConditionalFormatOperator.GREATER_EQUAL:
_3f2f=jsMsg["CFormat.Condition.GreaterThanOrEqual"]+" "+val;
break;
case ConditionalFormatOperator.EQUAL:
_3f2f=jsMsg["CFormat.Condition.Equal"]+" "+val;
break;
case ConditionalFormatOperator.NOT_EQUAL:
_3f2f=jsMsg["CFormat.Condition.NotEqual"]+" "+val;
break;
case ConditionalFormatOperator.BETWEEN:
_3f2f=jsMsg["CFormat.Condition.Between"]+" "+val;
break;
case ConditionalFormatOperator.NOT_BETWEEN:
_3f2f=jsMsg["CFormat.Condition.NotBetween"]+" "+val;
break;
case ConditionalFormatOperator.TEXT_CONTAINING:
_3f2f=jsMsg["CFormat.Condition.Contains"]+" '"+val+"'";
break;
case ConditionalFormatOperator.TEXT_NOTCONTAINING:
_3f2f=jsMsg["CFormat.Condition.NotContains"]+" '"+val+"'";
break;
case ConditionalFormatOperator.TEXT_BEGINNINGWITH:
_3f2f=jsMsg["CFormat.Condition.BeginsWith"]+" '"+val+"'";
break;
case ConditionalFormatOperator.TEXT_ENDINGWITH:
_3f2f=jsMsg["CFormat.Condition.EndsWith"]+" '"+val+"'";
break;
case ConditionalFormatOperator.YESTERDAY:
_3f2f=jsMsg["CFormat.Condition.Yesterday"];
break;
case ConditionalFormatOperator.TODAY:
_3f2f=jsMsg["CFormat.Condition.Today"];
break;
case ConditionalFormatOperator.TOMORROW:
_3f2f=jsMsg["CFormat.Condition.Tomorrow"];
break;
case ConditionalFormatOperator.LAST_7_DAYS:
_3f2f=jsMsg["CFormat.Condition.Last7Days"];
break;
case ConditionalFormatOperator.NEXT_7_DAYS:
_3f2f=jsMsg["CFormat.Condition.Next7Days"];
break;
case ConditionalFormatOperator.LAST_WEEK:
_3f2f=jsMsg["CFormat.Condition.LastWeek"];
break;
case ConditionalFormatOperator.THIS_WEEK:
_3f2f=jsMsg["CFormat.Condition.ThisWeek"];
break;
case ConditionalFormatOperator.NEXT_WEEK:
_3f2f=jsMsg["CFormat.Condition.NextWeek"];
break;
case ConditionalFormatOperator.LAST_MONTH:
_3f2f=jsMsg["CFormat.Condition.LastMonth"];
break;
case ConditionalFormatOperator.THIS_MONTH:
_3f2f=jsMsg["CFormat.Condition.ThisMonth"];
break;
case ConditionalFormatOperator.NEXT_MONTH:
_3f2f=jsMsg["CFormat.Condition.NextMonth"];
break;
case ConditionalFormatOperator.LAST_YEAR:
_3f2f=jsMsg["CFormat.Condition.LastYear"];
break;
case ConditionalFormatOperator.THIS_YEAR:
_3f2f=jsMsg["CFormat.Condition.ThisYear"];
break;
case ConditionalFormatOperator.NEXT_YEAR:
_3f2f=jsMsg["CFormat.Condition.NextYear"];
break;
case ConditionalFormatOperator.ISBLANK:
_3f2f=jsMsg["CFormat.Condition.Blanks"];
break;
case ConditionalFormatOperator.ISNOTBLANK:
_3f2f=jsMsg["CFormat.Condition.NoBlanks"];
break;
case ConditionalFormatOperator.ISERROR:
_3f2f=jsMsg["CFormat.Condition.Errors"];
break;
case ConditionalFormatOperator.ISNOTERROR:
_3f2f=jsMsg["CFormat.Condition.NoErrors"];
break;
case ConditionalFormatOperator.DATE_BEFORE:
_3f2f=jsMsg["CFormat.Condition.DateBefore"]+" "+val;
break;
case ConditionalFormatOperator.DATE_ON_OR_BEFORE:
_3f2f=jsMsg["CFormat.Condition.DateOnOrBefore"]+" "+val;
break;
case ConditionalFormatOperator.DATE_AFTER:
_3f2f=jsMsg["CFormat.Condition.DateAfter"]+" "+val;
break;
case ConditionalFormatOperator.DATE_ON_OR_AFTER:
_3f2f=jsMsg["CFormat.Condition.DateOnOrAfter"]+" "+val;
break;
case ConditionalFormatOperator.DATE_ON:
_3f2f=jsMsg["CFormat.Condition.DateOn"]+" "+val;
break;
case ConditionalFormatOperator.DATE_NOT_ON:
_3f2f=jsMsg["CFormat.Condition.DateNotOn"]+" "+val;
break;
case ConditionalFormatOperator.DATE_BETWEEN:
_3f2f=jsMsg["CFormat.Condition.DateBetween"]+" "+val;
break;
case ConditionalFormatOperator.DATE_NOT_BETWEEN:
_3f2f=jsMsg["CFormat.Condition.DateNotBetween"]+" "+val;
break;
case ConditionalFormatOperator.FORMULA:
_3f2f=jsMsg["CFormat.Condition.Formula"]+" ="+val;
break;
default:
_3f2f="";
}
return _3f2f;
}
function getManageRuleContent(_3f30){
var _3f31="&sheetname="+encodeURIComponent(CURRSHEETNAME)+"&action="+_3f30;
sendCFormatRequest(_3f31,false);
}
function getStyle(csarr){
if(typeof csarr!="undefined"){
var _3f33=csarr.split("~");
if(_3f33.length==0){
_3f33=csarr.split("$");
}
var style="";
if((_3f33[0]!="[1]")&&(_3f33[0]!="none")){
style+="background-color:"+_3f33[0]+";";
}
if((_3f33[1]!="[2]")&&(_3f33[1]!="none")){
style+="color:"+_3f33[1]+";";
}
if((_3f33[2]!="[3]")&&(_3f33[2]!="false")){
style+="font-weight:bold;";
}
if((_3f33[3]!="[4]")&&(_3f33[3]!="false")){
style+="font-style:italic;";
}
if((_3f33[4]!="[5]")&&(_3f33[4]!="none")){
style+="text-decoration:underline;";
}
return style;
}
}
function getParentByTagName(obj,tag){
var _3f37=obj.parentNode;
if(!_3f37){
return false;
}
if((_3f37.tagName!="undefined")&&(_3f37.tagName.toLowerCase()==tag)){
return _3f37;
}else{
return getParentByTagName(_3f37,tag);
}
}
function setCFInputNull(){
cfinputElem=null;
isConditionalDialogOpen=true;
}
function setRuleElem(_3f38){
var relem=$(_3f38).parents("div[id^=rule]");
ruleElem=relem;
var _3f3a=$(relem).find("select:first option:selected").index();
if(_3f3a==4){
isConditionalDialogOpen=true;
cfinputElem=$(relem).find("input:first");
cfinputVal=null;
}else{
isConditionalDialogOpen=false;
cfinputElem=null;
}
}
function setCFStyleValue(obj){
var relem=$(obj).parents("div[id^=rule]");
ruleElem=relem;
if(ruleElem!="undefined"){
var _3f3d=$(ruleElem).find("div.previewBg");
if(obj.id=="cfbold"){
var fw=$(_3f3d).css("fontWeight");
if(fw==400||fw=="normal"){
$(_3f3d).css("fontWeight","bold");
}else{
$(_3f3d).css("fontWeight","");
}
}else{
if(obj.id=="cfitalic"){
var fs=$(_3f3d).css("fontStyle");
if(fs=="normal"){
$(_3f3d).css("fontStyle","italic");
}else{
$(_3f3d).css("fontStyle","");
}
}else{
if(obj.id=="cfuline"){
var td=$(_3f3d).css("textDecoration");
if(td=="none"){
$(_3f3d).css("textDecoration","underline");
}else{
$(_3f3d).css("textDecoration","");
}
}
}
}
}
}
function showEditDialog(_3f41){
showURLInDialog(ctxpath+"pages/editcondformat.jsp?rname="+_3f41,"position=absmiddle,top=-100,title="+jsMsg["CFormat.EditRule"]+",width=575",editCFRange);
return;
}
function editCFRange(){
var rule1=document.getElementById("rule1").getElementsByTagName("table")[1];
var _3f43=document.getElementById("appliesto").getElementsByTagName("input")[0].value;
if(_3f43.length>20){
$("#appliestofield").attr("dir","rtl");
}
var _3f44=getRangeValues(_3f43);
var sR=_3f44.startRow;
var sC=_3f44.startCol;
var eR=_3f44.endRow;
var eC=_3f44.endCol;
var _3f49=_3f43.split(".")[0];
var _3f4a=fetchRowHeights(sR,eR);
var _3f4b="&sheetname="+_3f49+"&action="+ActionConstants.CONDITIONAL_FORMAT_READ_EDITOBJ+"&sR="+sR+"&eR="+eR+"&sC="+sC+"&eC="+eC+"&rowHeight="+_3f4a;
sendCFormatRequest(_3f4b,false);
positionDialog();
}
function getRangeValues(range){
if(range.indexOf(":")>-1){
if(range.indexOf(";")>-1){
range=range.substring(0,range.indexof(";")-1);
}
var _3f4d=range.split(":");
for(i=0;i<_3f4d.length;i++){
splitSheetName=_3f4d[i].split(".");
if(splitSheetName.length==2){
range=range.replace(splitSheetName[0]+".","");
}
}
var _3f4e=getCellPosByLabel(range.split(":")[0]);
var _3f4f=getCellPosByLabel(range.split(":")[1]);
return {type:"RANGE",startRow:_3f4e.row,startCol:_3f4e.col,endRow:_3f4f.row,endCol:_3f4f.col};
}
}
function editConditions(){
var _3f50=document.getElementById("appliesto").getElementsByTagName("input")[0].value;
var _3f51=false;
var _3f52=getRangeValues(_3f50);
var sR=_3f52.startRow;
var sC=_3f52.startCol;
var eR=_3f52.endRow;
var eC=_3f52.endCol;
var _3f57=_3f50.split(".")[0];
var _3f58="";
var _3f59="{";
var _3f5a=0;
for(var e=1;e<=3;e++){
var _3f5c=document.getElementById("chk_rule"+e);
if(_3f5c.checked){
_3f5a++;
var cond=0;
var val="";
var _3f5f="";
var _3f60=document.getElementById("rule"+e);
var _3f61=_3f60.getElementsByTagName("select");
var _3f62=_3f60.getElementsByTagName("input");
var _3f63=_3f60.getElementsByTagName("div");
var _3f64=_3f63[_3f63.length-1];
var index=_3f61[0].selectedIndex;
if(index==0){
cond=_3f61[1].value;
}else{
if(index==1){
cond=_3f61[2].value;
}else{
if(index==2){
cond=_3f61[3].value;
}else{
if(index==3){
cond=_3f61[4].value;
}else{
if(index==4){
cond=ConditionalFormatOperator.FORMULA;
}
}
}
}
}
if((cond<=ConditionalFormatOperator.NOT_EQUAL)||(cond>=ConditionalFormatOperator.TEXT_CONTAINING&&cond<=ConditionalFormatOperator.TEXT_ENDINGWITH)||(cond>=ConditionalFormatOperator.DATE_BEFORE&&cond<=ConditionalFormatOperator.DATE_NOT_ON)||(cond==ConditionalFormatOperator.FORMULA)){
if(_3f62[0].value==""){
_3f51=true;
break;
}
val=_3f62[0].value;
val=val.replace(/\\/g,"\\\\");
val=val.replace(/([\\"'])/g,"\\$1").replace(/\0/g,"\\0");
}else{
if(cond==ConditionalFormatOperator.BETWEEN||cond==ConditionalFormatOperator.NOT_BETWEEN||cond==ConditionalFormatOperator.DATE_BETWEEN||cond==ConditionalFormatOperator.DATE_NOT_BETWEEN){
if(_3f62[1].value==""||_3f62[2].value==""){
_3f51=true;
break;
}
val=_3f62[1].value+","+_3f62[2].value;
}
}
_3f5f=getStyleOfPreview(_3f64);
_3f59+="\"COND"+_3f5a+"\":"+cond+",\"CVAL"+_3f5a+"\":\""+encodeURIComponent(val)+"\",\"CSTYLE"+_3f5a+"\":\""+_3f5f+"\",";
}
}
if(_3f5a==0){
var _3f66=showConfirmDialog(jsMsg["CFormat.ConfirmDeleteRules"]);
if(!_3f66){
return;
}
}
if(_3f51){
showAlertDialog(jsMsg["CFormat.FieldsBlank"]);
}else{
_3f59+="\"NOOFCOND\":"+_3f5a+"}";
var _3f67=fetchRowHeights(sR,eR);
_3f58+="&sheetname="+_3f57+"&action="+ActionConstants.CONDITIONAL_FORMAT_EDIT+"&sR="+sR+"&eR="+eR+"&sC="+sC+"&eC="+eC+"&rowHeight="+_3f67+"&conditionsparam="+_3f59;
sendCFormatRequest(_3f58,false);
closeDialog();
showProgressMessage(jsMsg.Updating,true);
setTimeout("hideProgressMessage()",450);
setTimeout("showManageRulesAfterEdit()",500);
}
}
function showManageRulesAfterEdit(){
isConditionalDialogOpen=false;
showURLInDialog(ctxpath+"pages/conditionalformat.jsp?showtab=managerule","position=absmiddle,top=-100,title="+jsMsg.CFormat+",width=575",cfOpenCallBack,"",resetCFDialogOpen);
}
function sendCFormatRequest(_3f68,_3f69){
var _3f6a=getObj("apiKey");
var nvp="&docid="+DOCUMENT_ID+"&curtime="+CURRENTTIME+"&isSameSheet="+ISSAMESHEET+"&rtcSheetName="+encodeURIComponent(RTCSHEETNAME);
if(_3f6a!=null){
nvp+="&apiKeyId="+_3f6a.value;
}
if(USERSTATEID!=""){
nvp+="&userStateId="+USERSTATEID;
}
nvp+="&viewType="+getViewType();
nvp+="&docowner="+CURR_DOC_OWNERNAME+"&collabid="+COLLAB_ID+"&isDocSaved="+isDocSaved();
nvp+="&readwrite="+ALLOW_TO_WRITE+"&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&bridgeNo="+bridgeNumber+"&filename="+DOCUMENT_NAME+_3f68;
if(typeof getAvailableStartRow()=="undefined"){
nvp+="&availableStartRow=-1";
}else{
nvp+="&availableStartRow="+getAvailableStartRow();
}
if(jsREMOTE_SAVE_VIEW){
nvp+="&RMLOGINNAME="+RMUSER;
}
if(typeof getAvailableEndRow()=="undefined"){
nvp+="&availableEndRow=-1";
}else{
nvp+="&availableEndRow="+getAvailableEndRow();
}
nvp+="&freezedRow="+FREEZED_ROW;
nvp+="&totCols="+totCols;
nvp+="&afterRTC="+_3f69;
var _3f6c=new getXmlhttp();
_3f6c.open("POST",ctxpath+"cformat.do",true);
_3f6c.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
sendXMLHTTPRequest(_3f6c,nvp,true);
_3f6c.onreadystatechange=function(){
if(_3f6c.readyState==4){
if(_3f6c.responseText!=""){
var _3f6d=parseJSON(_3f6c.responseText);
if(typeof (_3f6d.CONDITIONALFORMAT)=="undefined"&&typeof (_3f6d.CFA)!="undefined"&&_3f6d.CFA==ActionConstants.CONDITIONAL_FORMAT_READ_SHEET){
var _3f6e=document.getElementById("condFormat");
if(_3f6e.hasChildNodes()){
_3f6e.parentNode.vAlign="middle";
_3f6e.innerHTML="<center>"+jsMsg["CFormat.NoConditionsSet"]+"</center>";
}
}else{
if(typeof (_3f6d.CONDITIONALFORMAT)!="undefined"&&_3f6d.CONDITIONALFORMAT!=""){
var _3f6f=_3f6d.CONDITIONALFORMAT;
var _3f70=_3f6d.CFA;
if(_3f70==ActionConstants.CONDITIONAL_FORMAT_APPLY||_3f70==ActionConstants.CONDITIONAL_FORMAT_EDIT||_3f70==ActionConstants.CONDITIONAL_FORMAT_DELETE){
var sname=_3f6d.SHEETNAME;
if(sname!=CURRSHEETNAME){
}else{
if(sname==CURRSHEETNAME){
var x;
for(x in _3f6f){
updateCFChangesInHtmlClient(_3f6f[x],false,encodeURIComponent(CURRSHEETNAME));
}
if(typeof (_3f6d.undoredo)!="undefined"){
var _3f73=_3f6d.undoredo;
setUNDO(_3f73.u);
setREDO(_3f73.r);
if(READ_WRITE){
btn_enabled();
}
}
}
}
}else{
if(_3f70==ActionConstants.CONDITIONAL_FORMAT_READ_RANGE){
var _3f74=_3f6d.DATATYPE;
if(_3f74!=""&&_3f74!="number"){
setSelectForDatatype(_3f74);
}
loadExistingRules(_3f6f);
}else{
if(_3f70==ActionConstants.CONDITIONAL_FORMAT_READ_SHEET){
var _3f6e=document.getElementById("condFormat");
_3f6e.parentNode.vAlign="top";
_3f6e.innerHTML="";
createRulesList(_3f6f);
}else{
if(_3f70==ActionConstants.CONDITIONAL_FORMAT_READ_WORKBOOK){
var y;
var _3f6e=document.getElementById("condFormat");
_3f6e.parentNode.vAlign="top";
_3f6e.innerHTML="";
for(y in _3f6f){
if(typeof (_3f6f[y])!="undefined"){
createRulesList(_3f6f[y]);
}
}
}else{
if(_3f70==ActionConstants.CONDITIONAL_FORMAT_READ_EDITOBJ){
loadEditRule(_3f6f);
}else{
if(_3f70==ActionConstants.SHEETACTION){
for(x in _3f6f){
updateCFChangesInHtmlClient(_3f6f[x],false,encodeURIComponent(CURRSHEETNAME));
}
}
}
}
}
}
}
}
}
}
}
};
}
function createRulesList(_3f76){
var _3f77=document.getElementById("condFormat");
_3f77.parentNode.vAlign="top";
var y;
for(y in _3f76){
var _3f79=_3f76[y];
if(typeof (_3f79.RANGENAME)!="undefined"){
var _3f7a=document.createElement("li");
_3f7a.setAttribute("onclick","toggleRuleList(this)");
if(browser_ie){
_3f7a.onclick=function(){
toggleRuleList(this);
};
}
var cnt=parseInt(_3f79["NOOFCOND"]);
var rhtml="<div style='display:;'><table cellpadding='3' cellspacing='3' width='98%' style='table-layout:fixed'>";
for(var x=1;x<=cnt;x++){
var style=getStyle(_3f79["CSTYLE"+x]);
var val=_3f79["CVAL"+x];
if(val!=null&&val!="null"){
val=val.replace(/\\\\/g,"\\");
val=val.replace(/</g,"&lt;");
val=val.replace(/>/g,"&gt;");
}
rhtml+="<tr><td style='width:350px;' class='breakWrap'>"+getFormula(_3f79["COND"+x],val)+"</td><td align='right' style='width:100px;'><dt style='text-align:center;"+style+"' class='previewBg'>"+jsMsg["CFormat.Preview"]+"</dt></td></tr>";
}
rhtml+="</table></div>";
var _3f80="<table cellpadding='0' cellspacing='0' border='0' class='treeExpand' style='border-top:none;width:100%;'><tr><td style='padding:0px 0px 0 25px;'>"+jsMsg["CFormat.AppliesTo"]+" "+_3f79.RANGENAME+"</td><td align='right' style='padding:0px 5px 0 0px;'>";
if(jsSHARE_VIEW&&!ALLOW_TO_WRITE){
_3f80+="&nbsp;";
}else{
_3f80+="<a href=\"#\" onclick=\"showEditDialog('"+_3f79["RANGENAME"]+"')\" class=\"trActionLink\">"+jsMsg.Edit+"</a>";
}
_3f80+="</td></tr></table>";
_3f7a.innerHTML=_3f80+rhtml;
_3f77.appendChild(_3f7a);
}
}
}
function loadEditRule(_3f81){
var rule1=document.getElementById("rule1");
var _3f83=rule1.getElementsByTagName("table")[0];
for(var j=2;j<=3;j++){
var _3f85=rule1.getElementsByTagName("div")[0];
var _3f86=_3f85.cloneNode(true);
var _3f87=_3f83.cloneNode(true);
var _3f88=document.getElementById("rule"+j);
_3f88.appendChild(_3f86);
_3f88.appendChild(_3f87);
}
var combo=rule1.getElementsByTagName("select");
for(var i=0;i<combo.length;i++){
combo[i].disabled=false;
}
var _3f8b=rule1.getElementsByTagName("input");
for(var i=0;i<_3f8b.length;i++){
_3f8b[i].disabled=false;
}
try{
for(var j=1;j<=3;j++){
registerIconEvents(document.getElementById("rule"+j).getElementsByTagName("table")[2].getElementsByTagName("TD"));
}
}
catch(e){
}
loadExistingRules(_3f81);
}
function setSelectForDatatype(_3f8c){
for(var x=1;x<=3;x++){
var _3f8e=document.getElementById("rule"+x);
if(_3f8e!=null){
var _3f8f=_3f8e.getElementsByTagName("select");
if(_3f8c=="date"){
_3f8f[0].options[2].selected=true;
setCombo(_3f8f[0]);
}else{
if(_3f8c=="text"){
_3f8f[0].options[1].selected=true;
setCombo(_3f8f[0]);
}
}
}
}
}
function getConditionalFormats(_3f90,sR,sC,eR,eC){
var _3f95="&sheetname="+encodeURIComponent(CURRSHEETNAME)+"&action="+ActionConstants.SHEETACTION+"&sR="+sR+"&eR="+eR+"&sC="+sC+"&eC="+eC;
sendCFormatRequest(_3f95,false);
}
var functionDescription=undefined;
function initialiseFormulaAutoComplete(){
if(pivotSheet){
jQuery.noConflict();
return;
}
function requestData(){
var _3f96=new getXmlhttp();
_3f96.open("POST",ctxpath+"formulaInfo.do",true);
_3f96.onreadystatechange=function(){
if(_3f96.readyState===4){
functionDescription=JSON.parse(_3f96.responseText);
}
};
_3f96.send(null);
}
var _3f97="#cF,#cF1,#cF2,#cF3,#Tv";
$(".ui-autocomplete").remove();
$(_3f97).autocomplete("destroy");
$(_3f97).autocomplete({minLength:1,autoFocus:true,delay:100,position:{my:"left top",at:"left bottom",collision:"fit flip",offset:"5 5"},create:function(event,ui){
var _3f9a=$(this),self=_3f9a.data("autocomplete"),_3f9c;
_3f9a.unbind("keydown.autocomplete").unbind("keypress.autocomplete").unbind("blur.autocomplete").bind("keydown.autocomplete",function(event){
if(self.options.disabled||self.element.attr("readonly")){
return;
}
_3f9c=false;
var _3f9e=$.ui.keyCode;
var key=event.keyCode;
switch(key){
case _3f9e.PAGE_UP:
self._move("previousPage",event);
break;
case _3f9e.PAGE_DOWN:
self._move("nextPage",event);
break;
case _3f9e.UP:
self._move("previous",event);
break;
case _3f9e.DOWN:
self._move("next",event);
break;
case _3f9e.ENTER:
case _3f9e.NUMPAD_ENTER:
if(self.menu.active){
_3f9c=true;
event.preventDefault();
}
case _3f9e.TAB:
if(!self.menu.active){
return;
}
if(isFMenuOpened){
self.menu.select(event);
}
break;
case _3f9e.HOME:
case _3f9e.LEFT:
case _3f9e.RIGHT:
case _3f9e.ESCAPE:
case _3f9e.END:
if(isFMenuOpened){
self.close(event);
}
if(key==27){
formulaSyntaxTip.hideMe();
}
break;
default:
clearTimeout(self.searching);
self.searching=setTimeout(function(){
if(self.term!=self.element.val()){
self.selectedItem=null;
self.search(null,event);
}
},self.options.delay);
break;
}
}).bind("keypress.autocomplete",function(event){
if(_3f9c){
_3f9c=false;
event.preventDefault();
}
}).bind("mouseup",function(event){
var _3fa2=$(this);
_3fa2.autocomplete("close");
var id=_3fa2.attr("id");
var _3fa4="";
if(id=="Tv"){
_3fa4=(exprField.value).substr(0,getCaretPos(exprField));
}else{
_3fa4=(cellField.value).substr(0,getCaretPos(cellField));
}
formulaSyntaxTip.showTip(_3fa4,_3fa2);
return;
}).bind("blur.autocomplete",function(event){
if(self.options.disabled){
return;
}
clearTimeout(self.searching);
});
},search:function(event,ui){
var _3fa8=$(this);
var _3fa9=_3fa8.val();
if(_3fa9.indexOf("=")==0){
var id=_3fa8.attr("id");
if(id!="Tv"){
removeCSSStyle("textAlign",cellField);
}
if(functionDescription===undefined){
requestData();
return false;
}
var _3fab=getFieldValByCaretPos("before"),_3fac=_3fab.split("\"").length-1,_3fad=_3fab.length,_3fae=(_3fa9.trim()).length,_3faf=0;
var items=formulaMenuItemsList.itemsMatched(_3fab);
if(items){
_3faf=items.length;
}
if(_3fad>_3fae||_3fac%2!=0||!_3faf){
_3fa8.autocomplete("close");
return false;
}
var menu=_3fa8.autocomplete("widget");
if(_3faf>=12){
menu.css("overflow-y","scroll");
}else{
menu.css("overflow-y","auto");
}
var index=getLastIndexOfRegex(_3fab.trim());
if(index!=-1){
var str=_3fab.substr(0,index+1),newLn=/\n/g,nLn=_3fab.match(newLn),_3fb6;
if(nLn){
var _3fb7=_3fab.lastIndexOf("\n");
var _3fb8=_3fab.substr(_3fb7);
if(_3fb8){
_3fb6=getCellValueWidth(_3fb8);
}
}else{
_3fb6=getCellValueWidth(str);
}
var _3fb9=formulaSyntaxTip.getObj();
if(_3fb9.is(":visible")){
var h2=_3fb9.outerHeight();
h2=h2+5;
_3fb6=_3fb6+" "+h2;
}else{
_3fb6=_3fb6+" 6";
}
var _3fbb="left bottom";
_3fa8.autocomplete("option","position",{my:"left top",at:_3fbb,collision:"fit flip",offset:_3fb6});
}
}else{
}
},source:function(_3fbc,_3fbd){
var _3fbe=getFieldValByCaretPos("before");
if(_3fbe.indexOf("=")==0){
var items=formulaMenuItemsList.getMatchedItems(_3fbe);
var count=0;
if(items){
count=items.length;
}
if(count>0){
_3fbd(items);
}else{
$(this).autocomplete("close");
return;
}
}else{
if(intAutoSuggestion!=null){
var text=_3fbc.term;
text=text.replace(/[ ]*/,"");
var li=text.lastIndexOf(",");
if(li!=-1){
text=text.substring(li+1).replace(/[ ]*/,"");
}
for(i=0;i<intAutoSuggestion.length;i++){
var val=getCellContent(getCell(currRow,intAutoSuggestion[i].PKColNo));
if(currCol==intAutoSuggestion[i].sugColNo&&val!=""){
_3fbd($.ui.autocomplete.filter(intAutoSuggestion[i].sugDisplay,extractLast(text)));
}
}
}
}
},focus:function(event,ui){
var _3fc6=getFieldValByCaretPos("before");
if(_3fc6.indexOf("=")==0){
if(funcLangCode=="en"){
var _3fc7=ui.item.description;
var _3fc8=$(".ui-menu-item .ui-state-hover");
var _3fc9=_3fc8.parent();
var menu=_3fc9.parent();
var _3fcb=_3fc9.offset();
var _3fcc=_3fcb.top;
var _3fcd=menu.offset();
var _3fce=_3fcd.left;
var _3fcf=menu.width();
formulaHelper.showHelp(_3fc7,_3fce,_3fcc,_3fcf);
}
}
return false;
},open:function(event,ui){
isFMenuOpened=true;
},select:function(event,ui){
var _3fd4=getFieldValByCaretPos("before");
if(_3fd4.indexOf("=")==0){
if(!event.ctrlKey&&!event.altKey){
var key=event.which;
var _3fd6=getFieldValByCaretPos("before");
var _3fd7=_3fd6.length;
var _3fd8=this.value;
var len=_3fd8.length;
var _3fda=_3fd8.substr(_3fd7,len-1);
_3fd6=_3fd6.trim();
var _3fdb=getLastIndexOfRegex(_3fd6);
_3fd6=_3fd6.substr(0,_3fdb+1);
var _3fdc=ui.item.label;
_3fd6=_3fd6+_3fdc;
var _3fdd=getFieldValByCaretPos("After");
var _3fde=_3fda.charAt(0);
var type=ui.item.type.trim();
if(!(type=="NAMEDRANGE")){
if(_3fde!="("){
_3fd6=_3fd6+"(";
}
}
var _3fe0=_3fd6.trim()+_3fda;
cellField.value=_3fe0;
exprField.value=_3fe0;
if(isEditingInExprField){
setCaretPos(exprField,_3fd6.length);
}else{
if(isCellEdited()){
setCaretPos(cellField,_3fd6.length);
}
}
if(type=="FUNCTION"){
var ele=$(this);
if(ele.autocomplete("widget").is(":visible")){
formulaSyntaxTip.showTip(_3fd6,ele,key);
}
}
setCellFieldWidth();
}
}else{
if(intAutoSuggestion!=null){
var _3fe2=cellField.value;
var li=cellField.value.lastIndexOf(",");
if(li!=-1){
var str=_3fe2.substring(0,li+1);
var str1=str+ui.item.value;
cellField.value=str+ui.item.value;
}else{
cellField.value=ui.item.value;
}
}
}
return false;
},close:function(event,ui){
hideFormulaMenu();
},change:function(event,ui){
isFMenuOpened=false;
$("#fHelpDiv").hide();
}});
$.ui.autocomplete.prototype._renderItem=function(ul,item){
if(item.type==="FUNCTION"||item.type==="NAMEDRANGE"){
var _3fec=$("<span></span>").text(item.label).css("left",6).css("position","relative");
var img=$("<span></span>");
if(item.type=="FUNCTION"){
img.addClass("functionicon");
}else{
img.addClass("namerangeicon");
}
var $Item=$("<li></li>").data("item.autocomplete",item).append($("<a></a>").append(img).append(_3fec)).appendTo(ul);
return $Item;
}else{
return $("<li></li>").data("item.autocomplete",item).append($("<a></a>").text(item.label)).appendTo(ul);
}
};
$.ui.autocomplete.prototype._move=function(_3fef,event){
if(!isFMenuOpened){
return;
}
this.menu[_3fef](event);
event.preventDefault();
return;
};
$.ui.autocomplete.prototype._resizeMenu=function(ul,item){
return;
};
$.ui.menu.prototype.activate=function(event,item){
this.deactivate();
if(this.hasScroll()){
var _3ff5=item.offset().top-this.element.offset().top,_3ff6=this.element.scrollTop(),_3ff7=this.element.height();
if(_3ff5<0){
this.element.scrollTop(_3ff6+_3ff5);
}else{
if(_3ff5>=_3ff7){
this.element.scrollTop(_3ff6+_3ff5-_3ff7+item.height());
}
}
}
this.active=item.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();
this._trigger("focus",event,{item:item});
};
$.ui.menu.prototype.hasScroll=function(){
return this.element.height()<this.element[$.fn.prop?"prop":"attr"]("scrollHeight");
};
var _3ff8=false;
$(".ui-autocomplete").mouseout(function(){
var item=$(".ui-menu-item .ui-state-hover");
var _3ffa=item.parent().hasClass("ui-menu-item");
if(_3ffa){
return;
}
formulaHelper.hideMe();
});
$("#fHelpDiv").hide();
}
var hideFormulaMenu=function(){
if(pivotSheet){
jQuery.noConflict();
return;
}
isFMenuOpened=false;
var _3ffb=["cF","cF1","cF2","cF3","Tv"];
var len=_3ffb.length;
for(var i=0;i<len;i++){
var _3ffe=_3ffb[i];
var _3fff=$("#"+_3ffe).autocomplete("widget");
var _4000=_3fff.is(":visible");
if(_4000){
_3fff.hide();
_3fff.html("");
}
}
$("#fHelpDiv").hide();
return;
};
var isAutocompleteDisabled=function(){
var _4001=$(".cF,#Tv");
var _4002=_4001.autocomplete("option","disabled");
return _4002;
};
var disableAutoComplete=function(id){
var _4004=$(".cF,#Tv");
var _4005=_4004.autocomplete("option","disabled");
if(_4005){
_4004.autocomplete("enable");
$("#"+id).autocomplete("search");
}else{
_4004.autocomplete("close");
_4004.autocomplete("disable");
}
return;
};
var AutocompleteItem=function(label,value,_4008,type){
this.label=label;
this.value=value;
this.description=_4008;
this.type=type;
};
var formulaMenuItemsList={input:function(_400a){
var str=(_400a.substr(1)).trim();
var _400c=getLastIndexOfRegex(str.trim());
if(_400c!=-1){
str=str.substr(_400c+1);
}
return str;
},functionsMatched:function(str){
var _400e=[];
_400e=functionDescription.localizedFnNames;
var _400f=matchString(str,_400e);
return _400f;
},matchedNameRanges:function(str){
var _4011=[],_4012=NAMEDRANGES.length;
for(var i=0;i<_4012;i++){
_4011[i]=NAMEDRANGES[i].NAME+"!";
}
var _4014=[];
_4014=matchString(str,_4011);
if(_4014){
return _4014;
}
},sheets:function(str){
var _4016=[];
var sT=$("#sheetsTab");
var _4018=getObj("sheetsTab").getElementsByTagName("TD");
var l=_4018.length;
for(var i=0;i<l-1;i++){
_4016[i]=_4018[i].getAttribute("sheetname");
}
var _401b=matchString(str,_4016);
return _4016;
},ignoreCaseSort:function(item1,item2){
var x=item1.toLowerCase();
var y=item2.toLowerCase();
return ((x<y)?-1:((x>y)?1:0));
},itemsMatched:function(_4020){
var str=this.input(_4020);
var _4022=this.functionsMatched(str);
var _4023=this.matchedNameRanges(str);
var items=_4022;
if(_4023){
items=(_4022.concat(_4023)).sort(this.ignoreCaseSort);
}
return items;
},getMatchedItems:function(_4025){
var items=this.itemsMatched(_4025);
var _4027=items.length;
var _4028=[];
for(var i=0;i<_4027;i++){
var _402a=items[i];
var len=_402a.length;
if((items[i].charAt(len-1))=="!"){
_402a=_402a.substring(0,len-1);
var ref=getDefinedNameProperty(_402a,"CONTENT");
ref=jsMsg.Refersto+" "+ref;
_4028[i]=new AutocompleteItem(_402a,_402a,ref,"NAMEDRANGE");
}else{
var index=functionDescription.localizedFnNames.indexOf(_402a);
var desc=functionDescription.fnTips[index];
_4028[i]=new AutocompleteItem(_402a,_402a,desc,"FUNCTION");
}
}
return _4028;
}};
var $formulaSyntaxDiv;
var formulaSyntaxTip={options:{id:"aFSyntax",clas:"formulaSyntax",appendTo:"body",position:{my:"left top",at:"left bottom",collision:"none"}},isVisible:function(){
var me=this.getObj();
var _4030=me.is(":visible");
return _4030;
},getObj:function(){
var id=this.options.id;
id="#"+id;
var me=$(id);
return me;
},hideMe:function(){
var me=this.getObj();
if(me.is(":visible")){
me.css("display","none");
}
return;
},showTip:function(text,_4035,key,_4037,_4038){
if(key==36||key==27){
this.hideMe();
return;
}
formulaParser.getCurrFormulaDetails(text,key,_4037,_4038,_4035);
return;
},_construct:function(_4039,_403a,_403b,_403c,key,_403e,_403f){
_4039=_4039.toUpperCase();
var index=functionDescription.localizedFnNames.indexOf(_4039),_4041=functionDescription.maxArgs[index];
var _4042=["en","es","de","fr","pl"];
if(index!=-1){
var _4043=functionDescription.fnSyntax[index];
if(_4043){
if(!$formulaSyntaxDiv){
var _4044=this.options;
$formulaSyntaxDiv=$("<div>").attr("id",_4044.id).addClass(_4044.clas).appendTo(_4044.appendTo);
}
this._removeChilds();
var _4045=_403c;
if($formulaSyntaxDiv.data("formulaData")){
$formulaSyntaxDiv.removeData("formulaData");
}
var _4046={"indx":_4045,"name":_4039};
$formulaSyntaxDiv.data("formulaData",_4046);
var fName,_4048,_4049,_404a;
fName=$("<a>").addClass("formulaHelpLink").text(_4039).bind("click",function(){
var _404b;
var _404c;
if(_4042.indexOf(funcLangCode)!=-1){
_404b=funcLangCode;
_404c=functionDescription.fnNames[index];
}else{
_404b="en";
_404c=_4039;
}
showURLInDialog(ctxpath+"html/functions/"+_404b+"/"+_404c+".html","status = 1, height = 250, width = 720, resizable = 0, scrollbars=yes, location = yes, title = "+jsTitleMsg.FunctionReference+" ",positionDialog);
}).appendTo($formulaSyntaxDiv);
_4048=$("<span>").text("(").addClass("openBrace").appendTo($formulaSyntaxDiv);
this._addArguments(_4043,_403a,_403b,_4041);
_4049=$("<span>").text(")").addClass("closedBrace").appendTo($formulaSyntaxDiv);
this._removeAndAddBold(_403a);
this.setLeftAndTop(_4045,_403f,_4039);
this._dragMe();
return;
}
}
},_addArguments:function(_404d,_404e,_404f,_4050){
var _4051=_404d.substr(1,_404d.length-2),_4052=_4051.split(";"),_4053=_4052.length,_4054;
if(_4050>=30){
var _4055=_4052[0];
_4055=_4055+";";
var temp=_4052[1],_4057=/[a-z]+/i,_4058=temp.match(_4057),_4059=_4058[0],_405a=$("<span>").addClass("fParams");
var fArg1=_405a.clone().text(_4055).appendTo($formulaSyntaxDiv);
var txt;
if(_4050>30){
txt=_4059+"1;";
var fArg2=_405a.clone().text(txt).appendTo($formulaSyntaxDiv);
}
var _4051;
var _405e=_404f+2;
for(var i=1;i<_405e;i++){
txt="["+_4059+(i+1)+"];";
_4051=_405a.clone().text(txt).appendTo($formulaSyntaxDiv);
}
var _4060=_405a.clone().text("...").appendTo($formulaSyntaxDiv);
_405a.remove();
}else{
for(var i=0;i<_4053;i++){
var arg=_4052[i].trim();
_4054=$("<span>").addClass("fParams").appendTo($formulaSyntaxDiv);
if(i==_4053-1){
_4054.text(arg);
}else{
_4054.text(arg+";");
}
}
}
this._attachMouseEvents(_404f);
},_highlightNextArg:function(_4062,_4063,key){
var args=$("#aFSyntax").find("span.fParams"),last=args.last(),_4067=last.prev();
if(key==44||key==59){
var _4068=_4067.text(),_4069=/[a-z]+/gi,_406a=_4068.match(_4069),txt=_406a[0];
txt=txt+(_4063+2);
txt="["+txt+"];";
var _406c=$("<span>").addClass("fParams").text(txt).insertBefore(last);
}
if(key==8){
_4067.remove();
}
args.removeClass("fParamBold");
$(args[_4062]).addClass("fParamBold");
return;
},_attachMouseEvents:function(_406d){
_406d=_406d+1;
var args=$("#aFSyntax").find("span.fParams:lt("+_406d+")");
args.mousedown(function(event){
if(!browser_ie){
var _4070=this;
formulaSyntaxTip._selectArgTxtInField(_4070,_406d);
}
return;
}).mouseup(function(event){
if(browser_ie){
var _4072=this;
formulaSyntaxTip._selectArgTxtInField(_4072,_406d);
}
return;
}).css("cursor","pointer");
},_functionHelpWindow:function(fun){
var myWin=window.open("/html/functions/"+funcLangCode+"/"+fun+".html","myWindow","status = 1, height = 250, width = 720, resizable = 0, scrollbars=yes, location = yes ");
},_selectArgTxtInField:function(_4075,_4076){
var _4077=$("#aFSyntax").find("span.fParams"),indx=_4077.index(_4075);
formulaSyntaxTip._removeAndAddBold(indx);
formulaParser.selectArgText(indx,_4076);
return;
},_removeChilds:function(){
var _4079=$formulaSyntaxDiv;
if(_4079){
var _407a=_4079.children();
if(_407a.length>0){
_4079.empty();
}
}
},setLeftAndTop:function(indx,_407c,_407d){
var _407e,_407f,_4080=formulaParser.getFieldValueWidthByCaretPos(indx);
if(isEditingInExprField){
var _4081=$("#cHC").position();
_407e=_4080+findPosX(exprField);
_407f=_4081.top;
}else{
$formulaSyntaxDiv.css("left",0);
var _4082=$formulaSyntaxDiv.outerWidth(),_4083=getColLeft(currCol)+sheetLeft-getSheetScrollLeft(),total=_4082+_4083,_4085=$(window).width();
total=total+_4080;
var _4086=$("#ssVScrollbar");
var _4087=_4086.offset();
var _4088=_4087.left;
var _4089=_4086.outerWidth();
var _408a=_4088+_4089;
if(total>=_408a){
_407e=_4085-_4082;
}else{
_407e=_4080+getColLeft(currCol)+sheetLeft-getSheetScrollLeft();
}
_407f=getRowTop(currRow)+sheetTop-getSheetScrollTop()+_407c.outerHeight();
}
var map={"left":_407e,"top":_407f,"display":"block"};
$formulaSyntaxDiv.css(map);
},_removeAndAddBold:function(child){
var args=$("#aFSyntax").find("span.fParams");
args.removeClass("fParamBold");
$(args[child]).addClass("fParamBold");
},_dragMe:function(){
var me=this.getObj();
me.draggable({containment:"parent"});
}};
var formulaParser={regexOptions:{formulaRegex:/[\/\-()-+=,~@%^*"|;<>'&}{\n ]/g,openRound:/\(/g,closedRound:/\)/g,roundPair:/\(([^\(])*?\)/g,openFlower:/{/g,closedFlower:/}/g,flowerPair:/{([^{])*?}/g,openSquare:/\[/g,closedSquare:/\]/g,squarePair:/\[([^\[])*?\]/g,doubleQuotes:/"/g,doubleQtStrings:/".*?"/g,separators:/[,;]/g,newLine:/\n/g},getCurrFormulaDetails:function(text,key,_4091,_4092,_4093){
if(text.indexOf("=")==0){
if(key==37||key==44||key==59){
var _4094=text.split("\"").length-1;
if(_4094%2!=0){
return;
}
}
var _4095=text,_4096=getFieldValByCaretPos("after",key),lenB4=_4095.length,_4098=_4096.length,_4099=_4095.charAt(lenB4-1);
switch(key){
case 57:
if(_4092){
_4095=_4095+"(";
}
break;
case 8:
if(!_4091){
_4095=_4095.substr(0,lenB4-1);
}
break;
case 48:
if(_4092){
_4095=_4095+")";
}
break;
case 222:
_4095=_4095+"\"";
break;
case 46:
_4096=_4096.substr(1);
break;
default:
break;
}
if(key==8||(_4092&&key==57)||(_4092&&key==48)){
var _4094=_4095.split("\"").length-1;
if(_4094%2!=0){
return;
}
}
var _409a=_4095+_4096;
lenB4=_4095.length;
_4098=_4096.length;
var temp=_4095;
var _409c=this;
temp=_409c.escDblQtStrings(temp);
var _409d=[];
_409d=_409c.getFnameAndIndx(temp);
if(_409d){
var _409e=_409d[0],_409f=_409d[1],_40a0=_409d[2];
_40a0=_409c.getCurrentFormulaText(_40a0);
var _40a1=_409f.length,l=_409e+_40a1,_40a3=_409a.substr(l);
_40a3=_409c.escapeStrings(_40a3);
_40a3=_409c.filterIncompleteArg(_40a3)[0];
_40a3=_409c.getCurrentFormulaText(_40a3);
var _40a4=_409c.separators(_40a0),_40a5=_409c.separators(_40a3);
_409f=_409f.substr(0,_40a1-1);
var _40a6=[];
_40a6[0]=_409f;
_40a6[1]=_40a4;
_40a6[2]=_40a5;
_40a6[3]=_409e;
_40a6[4]=_4099;
formulaSyntaxTip._construct(_409f,_40a4,_40a5,_409e,key,_4099,_4093);
}else{
formulaSyntaxTip.hideMe();
return;
}
}
return;
},getFnameAndIndx:function(_40a7){
var _40a8=_40a7.length,reg=/[a-z\u00c0-\u00d6\u00d8-\u00f6\u0100-\u017F]([_.a-z0-9\u00c0-\u00d6\u00d8-\u00f6\u0100-\u017F])*\(/gi,_40aa=_40a7.match(reg),_40ab=[];
if(_40aa){
var _40ac=_40aa.length,_40ad=_40a8;
for(var i=_40ac-1;i>=0;i--){
var _40af=_40aa[i],len=_40af.length;
_40ad=_40a7.substr(0,_40ad).lastIndexOf(_40af);
if(_40ad!=-1){
var _40b1=_40a7.charAt(_40ad-1),rg=/[-()+=,~@%^*"|;:<>'&}{\n ]/g,_40b3=rg.test(_40b1);
if(!_40b3){
continue;
}
var l=_40ad;
l=l+len;
var _40b5=_40a7.substr(l);
_40b5=this.filterIncompleteArg(_40b5)[0];
_40ab[0]=_40ad;
_40ab[1]=_40af;
_40ab[2]=_40b5;
var _40b6=this.isThisAFormula(_40af);
if(_40b6){
var _40b7=this.isThisCurrentFormula(_40b5);
if(!_40b7){
return _40ab;
}else{
if(i==0){
return null;
}
continue;
}
}else{
continue;
}
}
}
}
},getCurrentFormulaText:function(str){
str=this.escapeBrackets(str,"round");
var obc=str.split("(").length-1,cbc=str.split(")").length-1;
if(cbc){
var indx=str.indexOf(")");
if(indx!=-1){
str=str.substr(0,indx);
}
}else{
if(obc){
var indx=str.indexOf("(");
if(indx!=-1){
str=str.substr(0,indx);
}
}else{
str=str;
}
}
return str;
},isThisCurrentFormula:function(str){
str=this.escapeRoundBrkts(str);
var _40bd=str.split("(").length-1,_40be=str.split(")").length-1,_40bf;
if(_40be){
_40bf=true;
}else{
_40bf=false;
}
return _40bf;
},selectArgText:function(_40c0,_40c1){
var _40c2=$formulaSyntaxDiv.data("formulaData"),_40c3=_40c2["indx"],_40c4=_40c2["name"],l=_40c3+_40c4.length+1,_40c6=getValByField();
var _40c7=formulaParser.filterIncompleteArg(_40c6),_40c8=_40c7[0],_40c9=_40c7[1],_40ca=_40c8.substr(l);
_40ca=this.getCurrentFormulaText(_40ca);
var _40cb=this.separators(_40ca),k=0,_40cd=0;
_40ca=_40ca.replace(/;/g,",");
for(var i=0;i<_40c0;i++){
var s=",",z=0;
z=_40ca.indexOf(s,k);
k=z+s.length;
_40cd=z;
}
if(_40c0!=0){
_40cd=_40cd+1;
}
var sub=_40ca.substr(_40cd),_40d2=_40c4.length+1,i1=_40c3+_40d2+_40cd,len=_40ca.length,i2=sub.length,reg=/[,;]/g,_40d7=sub.match(reg);
if(_40d7){
i2=sub.indexOf(_40d7[0]);
}
if(_40c0==0){
i1=_40c3+_40d2;
}
if(_40c0==_40cb){
var ll=_40c9.length;
i2=i2+ll;
}
i2=i1+i2;
if(isEditingInExprField){
selectText(exprField,i1,i2);
}else{
selectText(cellField,i1,i2);
}
return;
},bracketType:{round:"round",flower:"flower",square:"square"},fieldValue:function(){
var str;
if(isEditingInExprField){
str=exprField.value;
}else{
str=cellField.value;
}
return str;
},separators:function(str){
var reg=/[,;]/g,count=0,arr=str.match(reg);
if(arr){
count=arr.length;
}
return count;
},getMatchCount:function(str,reg){
var count=0,_40e1=str.match(reg);
if(_40e1){
count=_40e1.length;
}
return count;
},escDblQtStrings:function(str){
var dbRg=this.regexOptions.doubleQtStrings,rplc=this.replaceBy,dbArr=str.match(dbRg);
if(dbArr){
str=str.replace(dbRg,rplc);
}
return str;
},escapeRoundBrkts:function(str){
var _40e7=this.regexOptions.roundPair,obc=str.split("(").length-1,cbc=str.split(")").length-1,total=obc+cbc,pairs=Math.min(obc,cbc),rplc=this.replaceBy;
for(var i=0;i<pairs;i++){
var indx=str.search(_40e7);
if(indx!=-1){
str=str.replace(_40e7,rplc);
}
}
return str;
},replaceBy:function(_40ef,Index,_40f1){
var str=formulaParser.replaceWith(_40ef);
return str;
},replaceWith:function(str){
var tild="~",temp="",l=str.length;
var len=l+1;
temp=new Array(len).join("~");
return temp;
},isThisAFormula:function(str){
var _40f9=str.substr(0,str.length-1),index;
if(_40f9){
_40f9=_40f9.toUpperCase();
index=functionDescription.localizedFnNames.indexOf(_40f9);
}
if(index!=-1){
return 1;
}else{
return 0;
}
},escapeStrings:function(str){
var _40fc=this.regexOptions.doubleQtStrings,_40fd=str.match(_40fc);
if(_40fd){
var _40fe=this.replaceBy;
str=str.replace(_40fc,_40fe);
}
return str;
},filterIncompleteArg:function(text){
var temp;
temp=text;
temp=this.escapeStrings(temp);
temp=this.escapeBrackets(temp,"flower");
temp=this.escapeBrackets(temp,"square");
var reg1=/"/g,reg2=/{/g,reg3=/\[/g,_4104=Number.POSITIVE_INFINITY,i1=_4104,i2=_4104,i3=_4104,arr1=temp.match(reg1),arr2=temp.match(reg2),arr3=temp.match(reg3);
if(arr1){
i1=temp.indexOf(arr1[0]);
}
if(arr2){
i2=temp.indexOf(arr2[0]);
}
if(arr3){
i3=temp.indexOf(arr3[0]);
}
var _410b=Math.min(i1,i2,i3),_410c="",_410d=[];
if((_410b!=-1)&&_410b<_4104){
_410c=temp.substr(_410b);
temp=temp.substr(0,_410b);
}
_410d[0]=temp;
_410d[1]=_410c;
return _410d;
},escapeBrackets:function(str,type){
var _4110,_4111,_4112,_4113=this;
if(type==_4113.bracketType.round){
_4110=_4113.regexOptions.openRound;
_4111=_4113.regexOptions.closedRound;
_4112=_4113.regexOptions.roundPair;
}else{
if(type==_4113.bracketType.flower){
_4110=_4113.regexOptions.openFlower;
_4111=_4113.regexOptions.closedFlower;
_4112=_4113.regexOptions.flowerPair;
}else{
if(type==_4113.bracketType.square){
_4110=_4113.regexOptions.openSquare;
_4111=_4113.regexOptions.closedSquare;
_4112=_4113.regexOptions.squarePair;
}else{
return;
}
}
}
var _4114=0,_4115=0;
_4114=_4113.getMatchCount(str,_4110);
_4115=_4113.getMatchCount(str,_4111);
var total=_4114+_4115,pairs=Math.floor(total/2);
if(pairs){
var rplc=_4113.replaceBy;
for(var i=0;i<pairs;i++){
var indx=str.search(_4112);
if(indx!=-1){
str=str.replace(_4112,rplc);
}
}
}
return str;
},getFieldValueWidthByCaretPos:function(indx){
var _411c=this.fieldValue();
if(indx){
_411c=_411c.substr(0,indx);
}
var nLn=this.regexOptions.newLine,_411e=_411c.match(nLn);
if(_411e){
var ind=_411c.lastIndexOf("\n");
if(ind!=-1){
_411c=_411c.substr(ind);
}
}
return getCellValueWidth(_411c);
}};
var getFieldValByCaretPos=function(str,key){
var _4122,_4123,_4124,_4125=false,_4126="";
if(isEditingInExprField){
_4122=getCaretPos(exprField);
_4123=exprField.value;
_4125=isTextSelected(exprField);
if(_4125&&key){
_4126=getSelectedText(exprField);
}
}else{
_4122=getCaretPos(cellField);
_4123=cellField.value;
_4125=isTextSelected(cellField);
if(_4125&&key){
_4126=getSelectedText(cellField);
}
}
if(str=="before"){
_4124=(_4123.substr(0,_4122));
}else{
var len=_4126.length;
if(len){
_4122=_4122+len;
}
_4124=(_4123.substr(_4122));
}
return _4124;
};
var getValByField=function(){
var _4128,_4129;
if(isEditingInExprField){
_4128=exprField.value;
}else{
_4128=cellField.value;
}
return _4128;
};
var getLastIndexOfRegex=function(_412a){
var _412b=_412a.match(formulaParser.regexOptions.formulaRegex);
if(_412b){
var len=_412b.length;
if(len>0){
var _412d=_412b[len-1],_412e=_412a.lastIndexOf(_412d);
return _412e;
}
}else{
return -1;
}
};
var $formulaHelpTip;
var formulaHelper={_construct:function(_412f,_4130,top,_4132){
if(!$formulaHelpTip){
$formulaHelpTip=$("<div>").attr("id","fHelpDiv").addClass("fHelper").appendTo("body");
}
$formulaHelpTip.text(_412f);
$formulaHelpTip.css("left",0);
var _4133=10;
var _4134=$formulaHelpTip.width();
var left=_4132+_4130+_4133;
var _4136=$(window).width();
var _4137=left+_4134;
if(_4137>=_4136){
var diff=1.6;
left=_4130-(_4134+_4133+diff);
}
$formulaHelpTip.css("left",left);
$formulaHelpTip.css("top",top);
$formulaHelpTip.show();
this._dragMe();
},showHelp:function(_4139,left,top,_413c){
this._construct(_4139,left,top,_413c);
},hideMe:function(){
$("#fHelpDiv").hide();
},_dragMe:function(){
$formulaHelpTip.draggable({containment:"parent"});
}};
function split(val){
return val.split(/,\s*/);
}
function extractLast(term){
return split(term).pop();
}
function Filter(id,range,_4141){
this.id=id;
this.range=range||{};
this.appliedCols=_4141||[];
this.columns=[];
this.row=this.range.sR;
this.rowTop=getRowTop(this.row);
var _4142=range.sC;
for(var i=_4142,len=range.eC;i<=len;i++){
this.columns[i]=new columnClass(i-_4142);
}
return this;
}
Filter.instances={};
Filter.hasFilter=false;
Filter.currCol;
function columnClass(index,_4146){
this.index=index,this.dataType=undefined,this.lastAppliedCondtion=undefined,this.columnData=undefined;
}
columnClass.prototype={getIndex:function(){
},getLastAppliedCondition:function(){
},getColumnData:function(){
},setIndex:function(){
},setLastAppliedCondition:function(){
},setColumnData:function(){
},isDataModified:false,setDataModifed:function(){
}};
Filter.header={filterImage:"filter_new.png",filterAppliedImage:"filterApplied.png",selectAllItemsMsg:jsMsg["Filter.selectAll"],selectAllSearchResultsMsg:jsMsg["Filter.selectAllSearchResults"],selectedItem:"filterItemSelect",partiallySelectedItem:"filterPartialSelection",deselectedItem:"filterItem",filterMenuHeader:"filterMenuHeader"};
Filter.getHeader=function(){
return Filter.header;
};
Filter.create=function(id,range,_4149,_414a){
Filter.instances[id]=new Filter(id,range,_4149);
!_414a&&Filter.instances[id].buildIcons();
Filter.hasFilter=true;
$("#filterData").zbutton("check","#filter");
return Filter.instances[id];
};
var filterInfo=new Array();
var isFilterOptionsDIVOpened=false;
var currentFilterIndex;
var filterRange={};
var indexChanged=false;
var startTime=new Date().getTime();
var specialCondition=false;
var displayMaxDataInfo=false;
var operatorList1=["eq","!eq"];
var operatorList2=["gt","gte","lt","lte"];
var operatorList3=["begins","!begins","ends","!ends","contains","!contains"];
var operatorList4=["match","!match"];
var commonOptions=[jsMsg["Filter.equals"],jsMsg["Filter.notEquals"]];
var typeSpecificOptions={"DATE":[jsMsg["Filter.isAfter"],jsMsg["Filter.isAfterOrEqual"],jsMsg["Filter.isBefore"],jsMsg["Filter.isBeforeOrEqual"]],"TEXT":[jsMsg["Filter.isGreaterThan"],jsMsg["Filter.isGreaterThanOrEqual"],jsMsg["Filter.isLessThan"],jsMsg["Filter.isLessThanOrEqual"]],"NUMBER":[jsMsg["Filter.isGreaterThan"],jsMsg["Filter.isGreaterThanOrEqual"],jsMsg["Filter.isLessThan"],jsMsg["Filter.isLessThanOrEqual"]]};
var strOptions=[jsMsg["Filter.begins"],jsMsg["Filter.notBegins"],jsMsg["Filter.ends"],jsMsg["Filter.notEnds"],jsMsg["Filter.contains"],jsMsg["Filter.notContains"]];
var wildCardOptions=[jsMsg["Filter.match"],jsMsg["Filter.notMatch"]];
Filter.selectedIndexes=[];
Filter.searchInputKeydown=function(ev,obj){
return Filter.keyEventsManager(ev,obj);
};
Filter.keyEventsManager=function(ev,obj){
if(browser_ie){
ev=window.event;
}
var _414f=ev.keyCode;
var _4150=ev.altKey;
var _4151=(getPrintableCharacterKeyCodes().indexOf(_414f)!=-1);
if(_414f===27||(_4150&&_414f===38)){
Filter.hideFilterOptions();
return false;
}
if(_4150){
var _4152=false;
var col=Filter.currCol;
var range=Filter.getInstance().range;
if(_414f===37&&col>range.sC){
_4152=true;
col=col-1;
}
if(_414f===39&&col<range.eC){
_4152=true;
col=col+1;
}
if(_4152){
Filter.showFilterOptions(undefined,col);
return false;
}
}
if(_414f===13){
Filter.applyCustomFilter();
return false;
}
if(Filter.mode===1){
if(_414f===65&&(os_mac&&ev.metaKey||os_windows&&ev.ctrlKey)&&ev.shiftKey){
Filter.selectAllItems();
return false;
}
if(_4151){
Filter.clearSearchTimeout();
Filter.timeoutId=window.setTimeout(Filter.onSearchTimeout,10,obj);
}
}
};
Filter.onSearchTimeout=function(obj){
Filter.searchItems(obj.value.toLowerCase());
};
Filter.clearSearchTimeout=function(){
if(!isUndefined(Filter.timeoutId)){
window.clearTimeout(Filter.timeoutId);
}
};
Filter.deselectAll=function(){
for(var i=0,len=Filter.currColData.length;i<len;i++){
Filter.selectedItemIndexes[i]=0;
}
};
Filter.rememberSelection=true;
Filter.searchItems=function(_4158){
var _4159=Filter.currColData;
var _415a=document.createElement("div");
var _415b=document.createDocumentFragment();
var _415c=(_4158==="");
var _415d=0;
Filter.resultantSearchItemIndexes=[];
var _415e=Filter.header;
var i=0,j=0;
if(Filter.hasBlanks&&_415c){
var _4161=0;
var _4162=_415a.cloneNode(true);
if(!Filter.rememberSelection){
Filter.selectedItemIndexes[i]=1;
}
if(!Filter.rememberSelection){
$(_4162).attr("position",j++);
}
var _4163=Filter.isItemSelected(i);
var style=_4163?(_415d++,_4161=1,_415e.selectedItem):_415e.deselectedItem;
$(_4162).text("(Blanks)").attr("itemIndex",i).addClass(style);
Filter.resultantSearchItemIndexes.push(_4161);
_415b.appendChild(_4162);
i++;
}
if(!Filter.rememberSelection){
Filter.deselectAll();
}
for(var len=_4159.length;i<len;i++){
var _4166=_4159[i];
if(_4166.toLowerCase().indexOf(_4158)>-1||_415c){
var _4161=0;
var _4162=_415a.cloneNode(true);
if(!Filter.rememberSelection){
Filter.selectedItemIndexes[i]=1;
}
var _4163=Filter.isItemSelected(i);
if(!Filter.rememberSelection){
$(_4162).attr("position",j++);
}
var style=_4163?(_415d++,_4161=1,_415e.selectedItem):_415e.deselectedItem;
$(_4162).text(_4166).attr("itemIndex",i).addClass(style);
Filter.resultantSearchItemIndexes.push(_4161);
_415b.appendChild(_4162);
}
}
var _4167=getObj("div1").childNodes[0];
_4167.innerHTML=_415c?_415e.selectAllItemsMsg:_415e.selectAllSearchResultsMsg;
var _4168=getObj("filterSearch");
if(Filter.resultantSearchItemIndexes.length===0){
_4167.style.visibility="hidden";
_4168.className="filterSearchBox filterSearchError";
}else{
_4167.style.visibility="visible";
_4168.className="filterSearchBox";
}
if(_415c){
}
var _4169=_415e.partiallySelectedItem;
if(Filter.rememberSelection){
if(Filter.isViewFiltered()){
_415d=Filter.selectedItemIndexes.toString().split("1").length-1;
}
}
if(_415d===0){
_4169=_415e.deselectedItem;
if(browser_ie){
getObj("btn").childNodes[2].style.filter="alpha(opacity=40)";
}else{
getObj("btn").childNodes[2].style.opacity="0.4";
}
getObj("btn").childNodes[2].style.cursor="default";
}else{
if(Filter.resultantSearchItemIndexes.toString().indexOf("0")<0){
_4169=_415e.selectedItem;
if(browser_ie){
getObj("btn").childNodes[2].style.filter="alpha(opacity=100)";
}else{
getObj("btn").childNodes[2].style.opacity="1";
}
getObj("btn").childNodes[2].style.cursor="";
}
}
var _416a=getObj("filterdataDiv");
_416a.innerHTML="";
_416a.appendChild(_415b);
_4167.className=_4169;
};
Filter.isItemSelected=function(_416b){
return parseInt(Filter.selectedItemIndexes[_416b]);
};
Filter.selectItem=function(el){
var jqEl=$(el);
var _416e=Filter.header;
var _416f=parseInt(jqEl.attr("itemIndex"));
var _4170=Filter.isItemSelected(_416f);
var _4171=Filter.isViewFiltered();
el.className=_4170?(_4170=0,_416e.deselectedItem):(_4170=1,_416e.selectedItem);
Filter.selectedItemIndexes[_416f]=_4170;
var _4172=jqEl.attr("position");
if(!Filter.rememberSelection&&_4172!==undefined){
Filter.resultantSearchItemIndexes[parseInt(_4172)]=_4170;
}
if(_4171&&Filter.rememberSelection){
Filter.resultantSearchItemIndexes[_416f]=_4170;
}
Filter.setSelectionCue();
};
Filter.isViewFiltered=function(){
return (getObj("filterSearch").value!=="");
};
Filter.setSelectionCue=function(){
var _4173=Filter.isViewFiltered();
var _4174=Filter.header;
var _4175=_4173?Filter.resultantSearchItemIndexes:Filter.selectedItemIndexes;
var _4176=_4173&&Filter.rememberSelection?Filter.resultantSearchItemIndexes:Filter.selectedItemIndexes;
var _4177=_4175.toString();
var _4178=_4177.indexOf(0)>-1;
var _4179=_4177.indexOf(1)>-1;
var _417a=_4174.partiallySelectedItem;
var _417b="";
if(browser_ie){
var _417c=_4176.toString().indexOf("1")!==-1?100:(_417b="default",40);
}else{
var _417c=_4176.toString().indexOf("1")!==-1?1:(_417b="default",0.4);
}
if(!_4178){
_417a=_4174.selectedItem;
}else{
if(!_4179){
_417a=_4174.deselectedItem;
}
}
getObj("btn").childNodes[2].style.cursor=_417b;
getObj("div1").childNodes[0].className=_417a;
if(browser_ie){
getObj("btn").childNodes[2].style.filter="alpha(opacity="+_417c+")";
}else{
getObj("btn").childNodes[2].style.opacity=_417c;
}
};
Filter.itemSelectorMouseDown=function(){
Filter.selectAllItems();
};
Filter.selectAllItems=function(_417d){
var _417e=Filter.isViewFiltered();
var _417f=Filter.header;
var _4180=getObj("div1").childNodes[0];
var _4181=_417f.selectedItem;
var _417d=true;
if(_4180.className===_417f.selectedItem){
_4181=_417f.deselectedItem;
_417d=false;
}
_4180.className=_417d?_417f.selectedItem:_417f.deselectedItem;
var _4182=getObj("filterdataDiv").childNodes;
var flag=_417d?1:0;
for(var i=0,len=_4182.length;i<len;i++){
var item=_4182[i];
item.className=_4181;
if(_417e){
Filter.resultantSearchItemIndexes[i]=flag;
}
Filter.selectedItemIndexes[parseInt(item.getAttribute("itemIndex"))]=flag;
}
var _4187=(Filter.selectedItemIndexes.toString().indexOf("1")===-1);
if(browser_ie){
getObj("btn").childNodes[2].style.filter=_4187?"alpha(opacity=40)":"alpha(opacity=100)";
}else{
getObj("btn").childNodes[2].style.opacity=_4187?0.4:1;
}
getObj("btn").childNodes[2].style.cursor=_4187?"":"default";
};
Filter.showFilterOptions=function(ev,col){
var el;
if(!ev){
ev=event;
}
var _418b=!!ev;
var _418c=Filter.header;
if(_418b){
if(browser_ie){
el=ev.srcElement;
}else{
el=ev.target;
}
}
if(isCellEdited()){
submitCell();
}
Menu.hide(Menu._currMenuId);
closeDialog();
if(isUndefined(col)){
col=currCol;
}
var obj=_418b?el:Filter.getIcon(col);
var _418e=Filter.getInstance();
var _418f=_418e.range;
var _4190=getObj("filterColumnData");
var _4191=_418b?parseInt(obj.getAttribute("col")):col;
var index=_418b?parseInt(obj.getAttribute("index")):col-_418f.sC;
if(_4190.style.display!="none"){
if(currentFilterIndex==index){
Filter.hideFilterOptions();
return;
}else{
if(!_418e.isFilteredCol(Filter.currCol)){
Filter.getIcon(Filter.currCol).src=IMAGE_PATH+"filter_new.png";
}
}
}
Filter.currCol=_4191;
if(!_418e.isFilteredCol(_4191)){
Filter.getIcon(_4191).src=IMAGE_PATH+"filter_state.png";
}
_4190.style.display="block";
currentFilterIndex=index;
var _4193=new getXMLHttpRequest();
var url=ctxpath+"getSheetFiltersData.do";
_4193.open("POST",url,true);
_4193.onreadystatechange=function(){
if(_4193.readyState==4){
var _4195=parseJSON(_4193.responseText);
if(_4195){
var _4196=_4195.cD;
var _4197=index+_418f.sC;
var _4198=_4195.dT;
var _4199=_4195.hV;
var fC=_4195.fC;
var _419b=_4195.ica;
var _419c=_4195.o1;
var _419d=_4195.o2;
var _419e=_4195.v1;
var _419f=_4195.v2;
var _41a0=_4195.ft;
var _41a1=_4195.af;
var _41a2=_4195.hB;
var _41a3=_4195.isc;
var _41a4=_4196.length;
var _41a5=_4195.selectAll;
Filter.selectedItemIndexes=_4195.selectedItemIndexes;
if(_41a5&&Filter.rememberSelection){
Filter.selectedItemIndexes=new Array(_41a4+1).join("0").split("");
}
var _41a6=_4195.smd;
var _41a7=getObj("filterdataDiv");
_41a7.innerHTML="";
var _41a8=document.createDocumentFragment();
var _41a9=document.createElement("div");
_41a7.onmousedown=Filter.applyFilter1;
var fType=getObj("dType");
if(_4198=="TEXT"){
$(fType.firstChild).text(jsMsg["Filter.textFilter"]);
getObj("Top10").style.display="none";
}else{
if(_4198=="NUMBER"){
$(fType.firstChild).text(jsMsg["Filter.numberFilter"]);
getObj("Top10").style.display="";
}else{
if(_4198=="DATE"){
$(fType.firstChild).text(jsMsg["Filter.dateFilter"]);
getObj("Top10").style.display="none";
}
}
}
var _41ab=getObj(_418c.filterMenuHeader);
_41ab.innerHTML="";
_41ab.appendChild(document.createTextNode(_4199));
var _41ac=getObj("btn").childNodes[0];
var _41ad=0.4;
var _41ae="default";
if(_419b){
_41ad=1;
_41ae="";
_41ac.onmousedown=Filter.applyFilterAll;
}else{
_41ac.onmousedown=function(ev){
stopEvt(ev);
};
}
_41ac.style.cursor=_41ae;
if(browser_ie){
_41ac.style.filter=_419b?"alpha(opacity=100)":"alpha(opacity=40)";
}else{
_41ac.style.opacity=_419b?1:0.4;
}
Filter.currColData=_4196.slice(0);
Filter.isAllItemsSelected=_41a5;
Filter.selectedItems=[];
Filter.hasBlanks=false;
var i=0;
if(_41a2=="true"){
Filter.hasBlanks=true;
var _41b1=_41a9.cloneNode(true);
var style=_41a1&&Filter.isItemSelected(i)?_418c.selectedItem:_418c.deselectedItem;
$(_41b1).attr("itemIndex",i++).text("(Blanks)").addClass(style);
_41a8.appendChild(_41b1);
}
for(;i<_41a4;i++){
var _41b3=_41a9.cloneNode(true);
var style=_41a1&&Filter.isItemSelected(i)?_418c.selectedItem:_418c.deselectedItem;
$(_41b3).attr("itemIndex",i).text(_4196[i]).addClass(style);
_41a8.appendChild(_41b3);
}
_41a7.appendChild(_41a8);
Filter.setSelectionCue();
var _41b4=getObj("maxDataInfo");
if(_41a6){
_41b4.style.display="";
displayMaxDataInfo=true;
}else{
_41b4.style.display="none";
displayMaxDataInfo=false;
}
var _41b5=getObj("foType");
var _41b6=getObj("foCategory");
var _41b7=$("#fVal3");
if(_41a3){
var _41b8=_4195.sOpr;
if(_41b8=="top"){
_41b5.children[0].selected=true;
}else{
_41b5.children[1].selected=true;
}
var _41b9=_4195.sC;
if(_41b9=="items"){
_41b6.children[0].selected=true;
}else{
_41b6.children[1].selected=true;
}
var _41ba=_4195.sVal;
_41b7.zspinner("setValue",_41ba);
_419b=false;
}else{
_41b5.children[0].selected=true;
_41b6.children[0].selected=true;
_41b7.zspinner("setValue",10);
}
var _41bb=getObj("fo1");
var _41bc=getObj("fo2");
Filter.constructOperatorOptions(_41bb,_419c,_4198,_419b,true);
var _41bd=$("#fVal1");
Filter.constructOperatorOptions(_41bc,_419d,_4198,_419b,false);
var _41be=$("#fVal2");
if(_4198=="DATE"){
_41bd.datepicker({showOn:"button",buttonImage:"styles/blue/images/datetime.png",buttonImageOnly:true,changeMonth:true,changeYear:true,buttonText:jsMsg["Filter.date"],constrainInput:false});
_41be.datepicker({showOn:"button",buttonImage:"styles/blue/images/datetime.png",buttonImageOnly:true,changeMonth:true,changeYear:true,buttonText:jsMsg["Filter.date"],constrainInput:false});
$(".ui-datepicker-trigger").mouseover(function(){
$(this).css("cursor","pointer");
});
_41bd.css({"width":"112px","marginRight":"6px"});
_41be.css({"width":"112px","marginRight":"6px"});
_41bb.style.width="144px";
_41bc.style.width="144px";
}else{
_41bd.datepicker("destroy");
_41be.datepicker("destroy");
_41bd.css({"width":"106px","marginRight":"0px"});
_41be.css({"width":"106px","marginRight":"0px"});
_41bb.style.width="170px";
_41bc.style.width="170px";
}
_41bd.val(_419e);
_41be.val(_419f);
if(_41a0=="AND"){
getObj("and").checked=true;
}else{
getObj("or").checked=true;
}
if(_41a3){
Filter.customFilter(3);
}else{
if(_41a1){
Filter.customFilter(2,true);
}else{
Filter.customFilter(1);
}
}
_418e.columns[_4191].dataType=_4198;
}
isFilterOptionsDIVOpened=true;
var _41bf=getSheetScrollLeft();
var _41c0=getColLeft(_4197)+getColWidth(_4197);
if(_4197>FREEZED_COL){
_41c0-=_41bf;
}
var left=_41c0-obj.offsetWidth;
if((left+_4190.offsetWidth)>(getSheetWidth()+sheetLeft-ssVScrollbar.offsetWidth)){
left=_41c0-_4190.offsetWidth;
}
left+=sheetLeft;
filterStartRow=_418e.range.sR;
var _41c2=getSheetScrollTop();
var top=getRowTop(parseInt(filterStartRow)+1)-_41c2;
var _41c4=top;
if((top-_41c2+_4190.offsetHeight)>getSheetHeight()){
top=getRowTop(parseInt(filterStartRow))+obj.offsetTop-_4190.offsetHeight-_41c2;
}
if(top+sheetTop<0){
top=_41c4;
}
if(filterStartRow<FREEZED_ROW){
top+=_41c2;
}
_4190.style.left=left+"px";
_4190.style.zIndex=1000000;
_4190.style.top=top+sheetTop+"px";
}
};
_4193.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
var nvp="docid="+DOCUMENT_ID+"&sheetName="+encodeURIComponent(CURRSHEETNAME)+"&curTime="+CURRENTTIME;
nvp+="&index="+index+"&col="+_4191;
nvp+="&viewType="+getViewType();
nvp+="&docowner="+CURR_DOC_OWNERNAME+"&isDocSaved="+isDocSaved();
nvp+="&bridgeNo="+bridgeNumber;
sendXMLHTTPRequest(_4193,nvp,true,false,url);
_418b&&stopEvt(ev);
return false;
};
Filter.setMaxRange=function(el){
if(el){
var _41c7=$("#fVal3");
if(el.selectedIndex==0){
_41c7.zspinner("setMaxvalue",65536);
}else{
if(el.selectedIndex==1){
_41c7.zspinner("setMaxvalue",100);
}
}
}
};
Filter.constructOperatorOptions=function(_41c8,_41c9,_41ca,_41cb,_41cc){
if(_41c8){
_41c8.innerHTML="";
var _41cd=document.createElement("option");
var _41ce=document.createElement("optgroup");
_41c8.appendChild(_41cd.cloneNode(true));
Filter.constructOptionList(_41c8,commonOptions,operatorList1,_41c9,_41ca,_41cb,_41cc);
Filter.constructOptionList(_41c8,typeSpecificOptions[_41ca],operatorList2,_41c9,_41ca,_41cb,_41cc);
Filter.constructOptionList(_41c8,strOptions,operatorList3,_41c9,_41ca,_41cb,_41cc);
Filter.constructOptionList(_41c8,wildCardOptions,operatorList4,_41c9,_41ca,_41cb,_41cc);
}
};
Filter.constructOptionList=function(_41cf,_41d0,_41d1,_41d2,_41d3,_41d4,_41d5){
var _41d6=_41d0.length;
var _41d7=document.createElement("option");
for(i=0;i<_41d6;i++){
var _41d8=_41d7.cloneNode(true);
var node=document.createTextNode(_41d0[i]);
_41d8.appendChild(node);
_41d8.setAttribute("value",_41d1[i]);
if(_41d1[i]==_41d2||(_41d5&&!_41d4&&"eq"==_41d1[i])){
_41d8.selected=true;
}
if((i+1)==_41d6){
_41d8.className="optionSep";
}
_41cf.appendChild(_41d8);
}
};
Filter.filterDataScroll=function(ev){
var _41db=getMouseWheelData(ev);
var _41dc=getObj("nrmlflyoutmenu");
var _41dd=_41dc.scrollTop;
var _41de=30*(_41db/3);
if(_41db<0){
var _41df=(_41dd+(-1*_41de));
}else{
_41df=(_41dd-_41de);
}
getObj("filterColumnData").scrollTop=_41df;
stopEvt(ev);
};
Filter.resetAutoFilterOptions=function(){
var _41e0=getObj("filterSearch");
_41e0.value="";
_41e0.className="filterSearchBox";
if(getObj("btn")){
if(browser_ie){
getObj("btn").childNodes[2].style.filter="alpha(opacity=100)";
}else{
getObj("btn").childNodes[2].style.opacity=1;
}
getObj("btn").childNodes[2].style.cursor="";
}
};
Filter.hideFilterOptions=function(){
var _41e1=getObj("filterColumnData");
if(_41e1){
isFilterOptionsDIVOpened=false;
getObj("filterdataDiv").scrollTop=0;
_41e1.style.left="-100000px";
_41e1.style.top="-100000px";
_41e1.style.display="none";
}
var _41e2=Filter.getInstance();
if((Filter.currCol!==undefined)&&_41e2&&!_41e2.isFilteredCol(Filter.currCol)){
Filter.getIcon(Filter.currCol).src=IMAGE_PATH+"filter_new.png";
}
Filter.resetAutoFilterOptions();
setFocusInCellField();
};
Filter.closeFilterOptions=function(){
if(isFilterOptionsDIVOpened){
Filter.hideFilterOptions();
}
};
Filter.applyCustomFilter=function(){
if(specialCondition){
var type=getObj("foType").value;
var value=getObj("fVal3").value;
var _41e5=getObj("foCategory").value;
Filter.applySpecialCondition(type,value,_41e5);
return;
}
var _41e6=(getObj("div1").style.display!=="none");
var _41e7=new Array();
var _41e8=getObj("fo1").value;
var _41e9=getObj("fo2").value;
if(_41e8==""){
Filter.hideFilterOptions();
return false;
}
var _41ea=getObj("fVal1").value;
var _41eb=getObj("fVal2").value;
var _41ec="AND";
if(getObj("or").checked){
_41ec="OR";
}
if(_41e6){
_41e7[0]=_41ea;
_41e7[1]=_41e8;
if(Filter.selectedItemIndexes.toString().indexOf("1")<0){
return;
}
}else{
_41e7[0]=_41ea;
_41e7[1]=_41eb;
_41e7[2]=_41ec;
_41e7[3]=_41e8;
_41e7[4]=_41e9;
}
indexChanged=false;
if(_41e6&&Filter.selectedItemIndexes.toString().indexOf("0")<0){
Filter.applyFilterAll();
}else{
Filter.applyFilter(_41e7,_41e6);
}
closeDialog();
return false;
};
function getSelectedValue(obj){
return obj.options[obj.selectedIndex].value;
}
Filter.applySpecialCondition=function(type,value,_41f0){
if(value>=1){
value=Math.round(value);
filterValue=type+" "+_41f0;
Filter.applyFilter(filterValue,true,"false","specialCondition",value);
}else{
Filter.hideFilterOptions();
return false;
}
};
Filter.applyFilterAll=function(){
Filter.applyFilter("allColumnValues",true,undefined,"all");
};
Filter.applyFilterBlank=function(ev){
var el;
if(browser_ie){
ev=window.event;
el=ev.srcElement;
}else{
el=ev.target;
}
Filter.selectItem(el,"");
stopEvt(ev);
};
Filter.applyFilter1=function(ev){
var el;
if(browser_ie){
ev=window.event;
el=ev.srcElement;
}else{
el=ev.target;
}
if(el.id){
return false;
}
Filter.selectItem(el);
};
Filter.applyFilter=function(_41f5,_41f6,_41f7,_41f8,value,_41fa){
var _41fb=Filter.getInstance();
if(_41fb){
var range=_41fb.range;
}
if(typeof _41f6=="undefined"){
_41f6=true;
}
if(typeof _41f7=="undefined"){
_41f7="false";
}
if(typeof _41f5=="undefined"){
_41f5="";
}
setResponseWaitingTime();
var _41fd=new getXMLHttpRequest();
var url=ctxpath+"filterAction.do";
_41fd.open("POST",url,true);
_41fd.onreadystatechange=function(){
if(_41fd.readyState==4){
clearResponseWaitingTime();
if(_41f7=="false"){
Filter.hideFilterOptions();
}
if(READ_WRITE){
btn_enabled();
}
var _41ff=_41fd.responseText;
if(_41ff==""){
return;
}
_41ff=parseJSON(_41ff);
var _4200=_41ff.Status;
if(_4200==="Failure"){
handleServerError("ERROR",showErrorPanelMsg,true,false);
return false;
}
var _4201=_41ff.revertCount;
if(_4201){
updateUndoRangeJson(JSON.stringify(_4201),_41f7);
}
var _4202=_41ff.chartList;
var _4203=_41ff.RowHeights;
var _4204=_41ff.Hidden;
var _4205=_41ff.TVR;
range=_41ff.range;
var _4206=getObj("cellStatus");
if(_4206){
var _4207="";
if(_4205>=0){
_4207=_4205+" "+jsMsg["Filter.of"]+" "+(range.eR-range.sR)+" "+jsMsg["Filter.foundRecords"];
}
$(_4206).text(_4207);
setTimeout("$('#cellStatus').html('')",5000);
}
var _4208=Filter.currCol;
if(_41f7=="true"){
_4208=_41fa["filterCol"];
}
var _4209=Filter.getIcon(_4208);
if(_41f8==="all"){
if(_4209){
_4209.src=IMAGE_PATH+"filter_new.png";
}
if(_41fb){
_41fb.removeFromAppliedCols(_4208);
}
}else{
if(_4209){
_4209.src=IMAGE_PATH+"filterApplied.png";
}
if(_41fb){
_41fb.addToAppliedCols(_4208);
}
}
Filter.reloadView(_4203,_41f7);
if(_41f7=="false"){
setFocusInCellField();
}
Filter.regenerateAffectedCharts(_4202);
}
};
var _420a,_420b,_420c,index;
if(!_41f7||_41f7=="false"){
_420a=CURRSHEETNAME;
_420b=Filter.currCol;
var _420e=_41fb.columns[_420b];
_420c=_420e.dataType;
index=(_420b-_41fb.range.sC);
}else{
if(_41fa){
_420a=_41fa["sheetName"];
_420b=_41fa["filterCol"];
_420c=_41fa["dataType"];
index=_41fa["fieldNumber"];
}
}
var _420f=getViewType();
var nvp="action=apply"+"&docid="+DOCUMENT_ID+"&sheetName="+encodeURIComponent(_420a)+"&curTime="+CURRENTTIME;
nvp+="&viewType="+_420f;
nvp+="&docowner="+CURR_DOC_OWNERNAME+"&collabid="+COLLAB_ID+"&isDocSaved="+isDocSaved();
nvp+="&readwrite="+ALLOW_TO_WRITE+"&afterRTC="+_41f7+"&collabEditing="+COLLABORATIVE_EDITING+"&criteria="+_41f8;
if(_41f6){
var fC="eq";
if(_41f8=="specialCondition"&&(_41f5=="top values"||_41f5=="bottom values"||_41f5=="top percent"||_41f5=="bottom percent")){
fC=_41f5;
_41f5=value;
}
nvp+="&fC1="+fC;
if(_41f8==="specialCondition"){
nvp+="&fV1="+encodeURIComponent(_41f5);
}else{
nvp+="&fO="+"OR";
if(_41f8!=="all"){
nvp+="&fV1="+((_41f7!="true")?Filter.getSelectedItems():JSON.stringify(Filter.selectedItems));
}else{
nvp+="&fV1="+encodeURIComponent(_41f5);
}
}
}else{
if(!isUndefined(_41f5[1])){
nvp+="&fV2="+encodeURIComponent(_41f5[1]);
}
if(!isUndefined(_41f5[2])){
nvp+="&fO="+_41f5[2];
}
nvp+="&fC1="+_41f5[3];
if(!isUndefined(_41f5[4])){
nvp+="&fC2="+_41f5[4];
}
if(isUndefined(_41f5[4])){
_41f6=true;
nvp+="&fV1="+JSON.stringify(new Array(encodeURIComponent(_41f5[0])));
}else{
nvp+="&fV1="+encodeURIComponent(_41f5[0]);
}
}
nvp+="&isAuto="+_41f6+"&currSheet="+CURRSHEETNAME;
nvp+="&bridgeNo="+bridgeNumber;
nvp+="&fC="+_420b;
nvp+="&index="+index+"&dT="+_420c;
if(_420f==="REMOTE_SAVE_VIEW"){
nvp+="&RMLOGINNAME="+RMUSER+"&userStateId="+USERSTATEID;
}
_41fd.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
sendXMLHTTPRequest(_41fd,nvp,true,false,url);
};
Filter.getSelectedItems=function(){
var str="[";
var _4213=false;
for(var i=0,len=Filter.currColData.length;i<len;i++){
if(Filter.isItemSelected(i)){
_4213=true;
str+="\""+encodeURIComponent(Filter.currColData[i].replace(/\"/g,"\\\""))+"\",";
}
}
if(_4213){
str=str.substring(0,str.length-1);
}
str+="]";
return str;
};
Filter.doFilterAction=function(_4216,_4217,_4218,_4219,_421a){
startTime=new Date().getTime();
if(typeof _4218=="undefined"){
_4218="false";
}
if(typeof _4217=="undefined"){
_4217="";
}
if(typeof _4216=="undefined"){
_4216="create";
if(Filter.hasFilter){
_4216="remove";
}
}
if(_4216!="read"&&_4218=="false"&&isCellEdited()){
submitCell();
}
if(_4216=="create"){
$("#filterData").zbutton("uncheck","#filter");
}
if(_4216!="read"){
setResponseWaitingTime();
}
var _421b=new getXMLHttpRequest();
var url=ctxpath+"filterAction.do";
_421b.open("POST",url,true);
_421b.onreadystatechange=function(){
if(_421b.readyState==4){
if(_4218=="false"){
Filter.hideFilterOptions();
}
var _421d=_421b.responseText;
if(_421d==""){
return;
}
_421d=parseJSON(_421d);
var _421e=_421d.Status;
if(_421e==="Failure"){
handleServerError("ERROR",showErrorPanelMsg,true,false);
return false;
}
var _421f=_421d.FilterAction;
var sN=_421d.SheetName;
var range=_421d.range;
var _4222=_421d.Hidden;
if(_421f!="read"){
clearResponseWaitingTime();
}
if(_421f=="read"){
filterRange={};
var _4223=_421d.hasFilter;
if(_4223=="false"){
$("#filterData").zbutton("uncheck","#filter");
Filter.hasFilter=false;
return false;
}
var _4224=_421d.FilteredCols;
filterMetaInfo=undefined;
Filter.create(CURRSHEETNAME,range,_4224);
_resettingRowHdrs();
}else{
if(_421f=="create"){
var _4225=_421d.revertCount;
if(_4225){
updateUndoRangeJson(JSON.stringify(_4225));
}
if(READ_WRITE){
btn_enabled();
}
filterMetaInfo=undefined;
activateCellField();
Filter.create(CURRSHEETNAME,range);
if(_4218=="false"){
scrollCellIntoView(range.sR,range.sC);
}
}else{
if(_421f=="remove"){
var _4225=_421d.revertCount;
if(READ_WRITE){
btn_enabled();
}
filterMetaInfo=undefined;
activateCellField();
if(_4225){
updateUndoRangeJson(JSON.stringify(_4225),_4218);
}
var _4226=_421d.RowHeights;
var _4227=_421d.chartList;
Filter.regenerateAffectedCharts(_4227);
if(_4226){
Filter.reloadView(_4226,_4218);
}
Filter.remove();
}
}
}
}
};
if(_4218=="false"&&!_421a){
_421a=CURRSHEETNAME;
}
var nvp="action="+_4216+"&docid="+DOCUMENT_ID+"&sheetName="+encodeURIComponent(_421a)+"&curTime="+CURRENTTIME;
if(_4216=="create"){
var _4229,_422a,_422b,_422c;
if(_4218=="false"){
if(isCellRange()){
var range=getCellRange();
_4229=range.startRow;
_422a=range.startCol;
_422b=range.endRow;
_422c=range.endCol;
}else{
_4229=currRow;
_422a=currCol;
_422b=currRow;
_422c=currCol;
}
}else{
if(_4219){
_4229=_4219.sR;
_422a=_4219.sC;
_422b=_4219.eR;
_422c=_4219.eC;
}
}
nvp+="&sR="+_4229+"&eR="+_422b+"&sC="+_422a+"&eC="+_422c;
}
var _422e=getViewType();
nvp+="&viewType="+_422e+"&currSheet="+CURRSHEETNAME;
nvp+="&docowner="+CURR_DOC_OWNERNAME+"&collabid="+COLLAB_ID;
nvp+="&readwrite="+ALLOW_TO_WRITE+"&afterRTC="+_4218+"&collabEditing="+COLLABORATIVE_EDITING+"&isDocSaved="+isDocSaved();
if(_422e==="REMOTE_SAVE_VIEW"){
nvp+="&RMLOGINNAME="+RMUSER+"&userStateId="+USERSTATEID;
}
_421b.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");
sendXMLHTTPRequest(_421b,nvp,true,false,url);
};
Filter.remove=function(){
var _422f=Filter.getInstance();
if(_422f){
_422f.remove();
$("#filterData").zbutton("uncheck","#filter");
}
};
Filter.regenerateAffectedCharts=function(_4230){
if(_4230){
for(var x in _4230){
regenerateChart(_4230[x]);
}
}
};
Filter.filterColDataMouseDown=function(ev){
var el;
if(browser_ie){
el=ev.srcElement;
}else{
el=ev.target;
}
if(el&&el.alt!="Date"){
var _4234=$("#fVal1");
var _4235=$("#fVal2");
_4234.datepicker("hide");
_4235.datepicker("hide");
}
if((browser_safari||browser_firefox||browser_ie&&el.id.indexOf("fo")!=-1)||el.id.indexOf("fVal")!=-1||el.className.indexOf("zspinner")!=-1||el.id.indexOf("filterSearch")!=-1){
return true;
}
stopEvt(ev);
return false;
};
Filter.hasFilteredCols=function(){
var _4236=Filter.getInstance();
if(_4236){
return _4236.appliedCols.length>0;
}
return false;
};
Filter.sortFilterRange=function(_4237){
Filter.hideFilterOptions();
var _4238=Filter.getInstance();
if(_4238){
var _4239=_4238.range;
var nvp="actionMode=FilterRangeSort&startColumn="+_4239.sC+"&endColumn="+_4239.eC+"&startRow="+_4239.sR+"&endRow="+_4239.eC;
nvp+="&currentTime="+CURRENTTIME+"&currentSheet="+encodeURIComponent(CURRSHEETNAME)+"&documentId="+DOCUMENT_ID;
nvp+="&isSortColumns=FALSE&containsHeader=TRUE&sensitive=FALSE&numberofColumns=1&field0="+(Filter.currCol-_4239.sC)+"&sortorder0="+_4237+"&afterRTC=false";
nvp+="&collabId="+COLLAB_ID+"&collabEditing="+COLLABORATIVE_EDITING;
nvp+="&documentOwner="+CURR_DOC_OWNERNAME;
sortvalues(nvp,"false");
}
};
Filter.showSpecialConditions=function(ev){
if(ev&&(ev.value=="top"||ev.value=="bottom")){
Filter.customFilter(3);
}else{
Filter.customFilter(1);
}
};
Filter.customFilter=function(tab,open){
specialCondition=false;
var _423e=getObj("maxDataInfo");
var _423f=Filter.getInstance();
var _4240=getObj("filterSearch");
var _4241;
if(_423f){
datatType=_423f.getColumnData(Filter.currCol).dataType;
}
if(tab==1){
getObj("div1").style.display="none";
getObj("div2").style.display="";
getObj("div3").style.display="none";
getObj("span1").style.display="none";
getObj("span2").style.display="";
_423e.style.display="none";
_4240.style.display="none";
if(datatType=="NUMBER"){
getObj("Top10").style.display="";
}
getObj("fVal1").focus();
Filter.resetAutoFilterOptions();
Filter.mode=2;
}else{
if(tab==2){
getObj("div2").style.display="none";
getObj("div1").style.display="";
getObj("filterdataDiv").style.display="";
getObj("filterdataDiv").scrollTop=0;
getObj("div3").style.display="none";
getObj("span2").style.display="none";
getObj("span1").style.display="";
_4240.style.display="";
_4240.focus();
if(datatType=="NUMBER"){
getObj("Top10").style.display="";
}
if(displayMaxDataInfo){
_423e.style.display="";
}
if(!open){
Filter.searchItems("");
}else{
getObj("div1").childNodes[0].innerHTML=Filter.header.selectAllItemsMsg;
}
Filter.mode=1;
}else{
if(tab==3){
specialCondition=true;
getObj("div2").style.display="none";
getObj("div1").style.display="none";
getObj("div3").style.display="";
getObj("span1").style.display="none";
getObj("span2").style.display="";
getObj("Top10").style.display="none";
_4240.style.display="none";
_423e.style.display="none";
Filter.resetAutoFilterOptions();
Filter.mode=3;
}
}
}
};
Filter.clear=function(){
Filter.instances={};
delete Filter.currCol;
};
Filter.getInstance=function(id){
if(!id){
id=CURRSHEETNAME;
}
return Filter.instances[id];
};
Filter.positionFilterIcons=function(start,end){
var _4245=Filter.getInstance(CURRSHEETNAME);
if(_4245){
var _4246=_4245.range.sR;
if(_4246>=start){
var _4247=filterIconsPane.childNodes;
var _4248=getRowTop(_4246);
var _4249=getRowHeight(_4246);
for(var i=0,len=_4247.length;i<len;i++){
_4247[i].style.top=_4248;
_4247[i].style.height=_4249;
}
if(ISFREEZED){
Filter.replicateInAllPanes();
}
}
}
};
Filter.prototype={};
Filter.prototype.addToAppliedCols=function(col){
var _424d=this.appliedCols;
if(_424d.indexOf(col)===-1){
_424d.push(col);
}
};
Filter.prototype.removeFromAppliedCols=function(col){
var _424f=this.appliedCols;
var idx=_424f.indexOf(col);
if(idx!==-1){
this.appliedCols=_424f.slice(0,idx).concat(_424f.slice(idx+1,_424f.length));
}
};
Filter.prototype.getColumnData=function(col){
return Filter.instances[this.id].columns[col];
};
Filter.prototype.modfiyRange=function(_4252){
};
Filter.prototype.buildIcons=function(){
var _4253=Filter.getHeader();
var _4254=getObj("fIP");
var _4255=this.appliedCols;
var _4256=this.range.sR;
var _4257=getRowTop(_4256);
var _4258=getRowHeight(_4256);
var _4259=Filter.getIconContainer();
var _425a=this.range;
var _425b=_425a.sC;
var _425c=_425a.eC;
_4254.innerHTML="";
if(browser_ie){
_4254.style.zIndex=1;
}
for(var i=_425b,len=_425a.eC;i<=len;i++){
var index=i-_425b;
var _4260=_4255.indexOf(i)!==-1;
var _4261=_4259.cloneNode(true);
_4261.setAttribute("col",i);
_4261.setAttribute("index",index);
var lV=0;
_4261.style.height=_4258+"px";
_4261.style.width=getColWidth(i)+"px";
_4261.style.left=getColLeft(i)+"px";
_4261.style.top=_4257+"px";
_4254.appendChild(_4261);
var icon=_4261.childNodes[0];
icon.src=IMAGE_PATH+(!_4260?_4253.filterImage:_4253.filterAppliedImage);
icon.setAttribute("col",i);
icon.setAttribute("index",index);
icon.onmousedown=Filter.showFilterOptions;
if(browser_ie){
_4261.onmousedown=function(ev){
sheetMouseDown(ev);
};
}
}
Filter.replicateInAllPanes();
return this;
};
Filter.prototype.reconstructIcons=function(){
this.removeIcons().buildIcons();
};
Filter.prototype.removeIcons=function(sC,eC){
filterIconsPane.innerHTML="";
if(ISFREEZED){
filterIconsPane1.innerHTML="";
filterIconsPane2.innerHTML="";
filterIconsPane3.innerHTML="";
}
return this;
};
Filter.prototype.remove=function(){
var id=Filter.getInstance().removeIcons().id;
Filter.hasFilter=false;
delete Filter.instances[id];
var _4268=getObj("cellStatus");
if(_4268){
$(_4268).text("");
}
};
Filter.prototype.setRange=function(range){
this.range=range;
};
Filter.prototype.setAppliedCols=function(_426a){
this.appliedCols=_426a;
};
Filter.prototype.modify=function(_426b){
this.appliedCols=_426b;
};
Filter.prototype.isFilteredCol=function(col){
var _426d=this.appliedCols;
return (_426d.indexOf(col)!==-1);
};
var isFilterIconsReplicationPending=false;
Filter.replicateInAllPanes=function(_426e){
if((_426e&&filterMetaInfo===undefined)||ISFREEZED){
var _426f=filterIconsPane.innerHTML;
var _4270=Filter.getInstance();
if(!_4270){
isFilterIconsReplicationPending=true;
}else{
isFilterIconsReplicationPending=false;
var range=_4270.range;
var _4272=range.sR;
var _4273=range.sC;
var len=range.eC-range.sC+1;
filterIconsPane2.innerHTML=_426f;
filterIconsPane1.innerHTML=_426f;
filterIconsPane3.innerHTML=_426f;
var _4275=filterIconsPane1.childNodes;
var _4276=filterIconsPane2.childNodes;
var _4277=filterIconsPane3.childNodes;
for(var i=0;i<len;i++){
_4275[i].childNodes[0].onmousedown=Filter.showFilterOptions;
_4276[i].childNodes[0].onmousedown=Filter.showFilterOptions;
_4277[i].childNodes[0].onmousedown=Filter.showFilterOptions;
if(browser_ie){
_4275[i].onmousedown=sheetMouseDown;
_4276[i].onmousedown=sheetMouseDown;
_4277[i].onmousedown=sheetMouseDown;
}
}
}
}
};
Filter.getIconContainer=function(){
if(!Filter.iconContainerProto){
var _4279=document.createElement("div");
_4279.style.position="absolute";
_4279.className="filterIconContainer";
var icon=document.createElement("img");
icon.style.position="absolute";
icon.style.cursor="pointer";
icon.style.right="1px";
icon.style.bottom="1px";
icon.style.maxWidth="100%";
icon.style.maxHeight="100%";
icon.style.zIndex=15;
_4279.appendChild(icon);
Filter.iconContainerProto=_4279;
}
return Filter.iconContainerProto;
};
Filter.isApplied=function(id){
if(!id){
id=CURRSHEETNAME;
}
var _427c=Filter.getInstance(id);
return (_427c&&_427c.appliedCols.length>0);
};
Filter.getIcon=function(_427d){
var _427e=Filter.getInstance();
return filterIconsPane.childNodes[_427d-_427e.range.sC].childNodes[0];
};
Filter.renameFilterInstance=function(_427f,_4280){
var _4281=Filter.getInstance(_427f);
if(_4281){
Filter.instances[_4280]=_4281;
Filter.instances[_4280].id=_4280;
delete Filter.instances[_427f];
}
};
Filter.isAcrossFilterHeader=function(_4282,_4283,_4284,_4285){
var _4286=Filter.getInstance();
if(_4286){
var range=_4286.range;
var _4288=range.sC;
var _4289=range.eC;
var _428a=range.sR;
var _428b=range.eR;
if(_4282<_428a&&_4284>=_428a&&((_4283>=_4288&&_4283<=_4289)||(_4285>=_4288&&_4285<=_4289))){
return true;
}
}
return false;
};
Filter.reloadView=function(_428c,_428d){
var _428e={};
var _428f=Filter.getInstance();
if(_428f){
var range=_428f.range;
if(ISFREEZED&&range.sR<FREEZED_ROW-1){
_428e={reloadFrozenRows:true,onBeforeReload:reloadSheetPanes,onAfterReload:function(){
setFreezeCues(FREEZED_ROW,FREEZED_COL);
}};
}
_428e.passiveReload=(_428d=="true");
setRowsHeightAndModifyDOM(_428c,true,_428e);
}
};
var swfobject=function(){
var D="undefined",r="object",S="Shockwave Flash",W="ShockwaveFlash.ShockwaveFlash",q="application/x-shockwave-flash",R="SWFObjectExprInst",x="onreadystatechange",O=window,j=document,t=navigator,T=false,U=[h],o=[],N=[],I=[],l,Q,E,B,J=false,a=false,n,G,m=true,M=function(){
var aa=typeof j.getElementById!=D&&typeof j.getElementsByTagName!=D&&typeof j.createElement!=D,ah=t.userAgent.toLowerCase(),Y=t.platform.toLowerCase(),ae=Y?/win/.test(Y):/win/.test(ah),ac=Y?/mac/.test(Y):/mac/.test(ah),af=/webkit/.test(ah)?parseFloat(ah.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,X=!+"\v1",ag=[0,0,0],ab=null;
if(typeof t.plugins!=D&&typeof t.plugins[S]==r){
ab=t.plugins[S].description;
if(ab&&!(typeof t.mimeTypes!=D&&t.mimeTypes[q]&&!t.mimeTypes[q].enabledPlugin)){
T=true;
X=false;
ab=ab.replace(/^.*\s+(\S+\s+\S+$)/,"$1");
ag[0]=parseInt(ab.replace(/^(.*)\..*$/,"$1"),10);
ag[1]=parseInt(ab.replace(/^.*\.(.*)\s.*$/,"$1"),10);
ag[2]=/[a-zA-Z]/.test(ab)?parseInt(ab.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;
}
}else{
if(typeof O.ActiveXObject!=D){
try{
var ad=new ActiveXObject(W);
if(ad){
ab=ad.GetVariable("$version");
if(ab){
X=true;
ab=ab.split(" ")[1].split(",");
ag=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)];
}
}
}
catch(Z){
}
}
}
return {w3:aa,pv:ag,wk:af,ie:X,win:ae,mac:ac};
}(),k=function(){
if(!M.w3){
return;
}
if((typeof j.readyState!=D&&j.readyState=="complete")||(typeof j.readyState==D&&(j.getElementsByTagName("body")[0]||j.body))){
f();
}
if(!J){
if(typeof j.addEventListener!=D){
j.addEventListener("DOMContentLoaded",f,false);
}
if(M.ie&&M.win){
j.attachEvent(x,function(){
if(j.readyState=="complete"){
j.detachEvent(x,arguments.callee);
f();
}
});
if(O==top){
(function(){
if(J){
return;
}
try{
j.documentElement.doScroll("left");
}
catch(X){
setTimeout(arguments.callee,0);
return;
}
f();
})();
}
}
if(M.wk){
(function(){
if(J){
return;
}
if(!/loaded|complete/.test(j.readyState)){
setTimeout(arguments.callee,0);
return;
}
f();
})();
}
s(f);
}
}();
function f(){
if(J){
return;
}
try{
var Z=j.getElementsByTagName("body")[0].appendChild(C("span"));
Z.parentNode.removeChild(Z);
}
catch(aa){
return;
}
J=true;
var X=U.length;
for(var Y=0;Y<X;Y++){
U[Y]();
}
}
function K(X){
if(J){
X();
}else{
U[U.length]=X;
}
}
function s(Y){
if(typeof O.addEventListener!=D){
O.addEventListener("load",Y,false);
}else{
if(typeof j.addEventListener!=D){
j.addEventListener("load",Y,false);
}else{
if(typeof O.attachEvent!=D){
i(O,"onload",Y);
}else{
if(typeof O.onload=="function"){
var X=O.onload;
O.onload=function(){
X();
Y();
};
}else{
O.onload=Y;
}
}
}
}
}
function h(){
if(T){
V();
}else{
H();
}
}
function V(){
var X=j.getElementsByTagName("body")[0];
var aa=C(r);
aa.setAttribute("type",q);
var Z=X.appendChild(aa);
if(Z){
var Y=0;
(function(){
if(typeof Z.GetVariable!=D){
var ab=Z.GetVariable("$version");
if(ab){
ab=ab.split(" ")[1].split(",");
M.pv=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)];
}
}else{
if(Y<10){
Y++;
setTimeout(arguments.callee,10);
return;
}
}
X.removeChild(aa);
Z=null;
H();
})();
}else{
H();
}
}
function H(){
var ag=o.length;
if(ag>0){
for(var af=0;af<ag;af++){
var Y=o[af].id;
var ab=o[af].callbackFn;
var aa={success:false,id:Y};
if(M.pv[0]>0){
var ae=c(Y);
if(ae){
if(F(o[af].swfVersion)&&!(M.wk&&M.wk<312)){
w(Y,true);
if(ab){
aa.success=true;
aa.ref=z(Y);
ab(aa);
}
}else{
if(o[af].expressInstall&&A()){
var ai={};
ai.data=o[af].expressInstall;
ai.width=ae.getAttribute("width")||"0";
ai.height=ae.getAttribute("height")||"0";
if(ae.getAttribute("class")){
ai.styleclass=ae.getAttribute("class");
}
if(ae.getAttribute("align")){
ai.align=ae.getAttribute("align");
}
var ah={};
var X=ae.getElementsByTagName("param");
var ac=X.length;
for(var ad=0;ad<ac;ad++){
if(X[ad].getAttribute("name").toLowerCase()!="movie"){
ah[X[ad].getAttribute("name")]=X[ad].getAttribute("value");
}
}
P(ai,ah,Y,ab);
}else{
p(ae);
if(ab){
ab(aa);
}
}
}
}
}else{
w(Y,true);
if(ab){
var Z=z(Y);
if(Z&&typeof Z.SetVariable!=D){
aa.success=true;
aa.ref=Z;
}
ab(aa);
}
}
}
}
}
function z(aa){
var X=null;
var Y=c(aa);
if(Y&&Y.nodeName=="OBJECT"){
if(typeof Y.SetVariable!=D){
X=Y;
}else{
var Z=Y.getElementsByTagName(r)[0];
if(Z){
X=Z;
}
}
}
return X;
}
function A(){
return !a&&F("6.0.65")&&(M.win||M.mac)&&!(M.wk&&M.wk<312);
}
function P(aa,ab,X,Z){
a=true;
E=Z||null;
B={success:false,id:X};
var ae=c(X);
if(ae){
if(ae.nodeName=="OBJECT"){
l=g(ae);
Q=null;
}else{
l=ae;
Q=X;
}
aa.id=R;
if(typeof aa.width==D||(!/%$/.test(aa.width)&&parseInt(aa.width,10)<310)){
aa.width="310";
}
if(typeof aa.height==D||(!/%$/.test(aa.height)&&parseInt(aa.height,10)<137)){
aa.height="137";
}
j.title=j.title.slice(0,47)+" - Flash Player Installation";
var ad=M.ie&&M.win?"ActiveX":"PlugIn",ac="MMredirectURL="+O.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ad+"&MMdoctitle="+j.title;
if(typeof ab.flashvars!=D){
ab.flashvars+="&"+ac;
}else{
ab.flashvars=ac;
}
if(M.ie&&M.win&&ae.readyState!=4){
var Y=C("div");
X+="SWFObjectNew";
Y.setAttribute("id",X);
ae.parentNode.insertBefore(Y,ae);
ae.style.display="none";
(function(){
if(ae.readyState==4){
ae.parentNode.removeChild(ae);
}else{
setTimeout(arguments.callee,10);
}
})();
}
u(aa,ab,X);
}
}
function p(Y){
if(M.ie&&M.win&&Y.readyState!=4){
var X=C("div");
Y.parentNode.insertBefore(X,Y);
X.parentNode.replaceChild(g(Y),X);
Y.style.display="none";
(function(){
if(Y.readyState==4){
Y.parentNode.removeChild(Y);
}else{
setTimeout(arguments.callee,10);
}
})();
}else{
Y.parentNode.replaceChild(g(Y),Y);
}
}
function g(ab){
var aa=C("div");
if(M.win&&M.ie){
aa.innerHTML=ab.innerHTML;
}else{
var Y=ab.getElementsByTagName(r)[0];
if(Y){
var ad=Y.childNodes;
if(ad){
var X=ad.length;
for(var Z=0;Z<X;Z++){
if(!(ad[Z].nodeType==1&&ad[Z].nodeName=="PARAM")&&!(ad[Z].nodeType==8)){
aa.appendChild(ad[Z].cloneNode(true));
}
}
}
}
}
return aa;
}
function u(ai,ag,Y){
var X,aa=c(Y);
if(M.wk&&M.wk<312){
return X;
}
if(aa){
if(typeof ai.id==D){
ai.id=Y;
}
if(M.ie&&M.win){
var ah="";
for(var ae in ai){
if(ai[ae]!=Object.prototype[ae]){
if(ae.toLowerCase()=="data"){
ag.movie=ai[ae];
}else{
if(ae.toLowerCase()=="styleclass"){
ah+=" class=\""+ai[ae]+"\"";
}else{
if(ae.toLowerCase()!="classid"){
ah+=" "+ae+"=\""+ai[ae]+"\"";
}
}
}
}
}
var af="";
for(var ad in ag){
if(ag[ad]!=Object.prototype[ad]){
af+="<param name=\""+ad+"\" value=\""+ag[ad]+"\" />";
}
}
aa.outerHTML="<object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\""+ah+">"+af+"</object>";
N[N.length]=ai.id;
X=c(ai.id);
}else{
var Z=C(r);
Z.setAttribute("type",q);
for(var ac in ai){
if(ai[ac]!=Object.prototype[ac]){
if(ac.toLowerCase()=="styleclass"){
Z.setAttribute("class",ai[ac]);
}else{
if(ac.toLowerCase()!="classid"){
Z.setAttribute(ac,ai[ac]);
}
}
}
}
for(var ab in ag){
if(ag[ab]!=Object.prototype[ab]&&ab.toLowerCase()!="movie"){
e(Z,ab,ag[ab]);
}
}
aa.parentNode.replaceChild(Z,aa);
X=Z;
}
}
return X;
}
function e(Z,X,Y){
var aa=C("param");
aa.setAttribute("name",X);
aa.setAttribute("value",Y);
Z.appendChild(aa);
}
function y(Y){
var X=c(Y);
if(X&&X.nodeName=="OBJECT"){
if(M.ie&&M.win){
X.style.display="none";
(function(){
if(X.readyState==4){
b(Y);
}else{
setTimeout(arguments.callee,10);
}
})();
}else{
X.parentNode.removeChild(X);
}
}
}
function b(Z){
var Y=c(Z);
if(Y){
for(var X in Y){
if(typeof Y[X]=="function"){
Y[X]=null;
}
}
Y.parentNode.removeChild(Y);
}
}
function c(Z){
var X=null;
try{
X=j.getElementById(Z);
}
catch(Y){
}
return X;
}
function C(X){
return j.createElement(X);
}
function i(Z,X,Y){
Z.attachEvent(X,Y);
I[I.length]=[Z,X,Y];
}
function F(Z){
var Y=M.pv,X=Z.split(".");
X[0]=parseInt(X[0],10);
X[1]=parseInt(X[1],10)||0;
X[2]=parseInt(X[2],10)||0;
return (Y[0]>X[0]||(Y[0]==X[0]&&Y[1]>X[1])||(Y[0]==X[0]&&Y[1]==X[1]&&Y[2]>=X[2]))?true:false;
}
function v(ac,Y,ad,ab){
if(M.ie&&M.mac){
return;
}
var aa=j.getElementsByTagName("head")[0];
if(!aa){
return;
}
var X=(ad&&typeof ad=="string")?ad:"screen";
if(ab){
n=null;
G=null;
}
if(!n||G!=X){
var Z=C("style");
Z.setAttribute("type","text/css");
Z.setAttribute("media",X);
n=aa.appendChild(Z);
if(M.ie&&M.win&&typeof j.styleSheets!=D&&j.styleSheets.length>0){
n=j.styleSheets[j.styleSheets.length-1];
}
G=X;
}
if(M.ie&&M.win){
if(n&&typeof n.addRule==r){
n.addRule(ac,Y);
}
}else{
if(n&&typeof j.createTextNode!=D){
n.appendChild(j.createTextNode(ac+" {"+Y+"}"));
}
}
}
function w(Z,X){
if(!m){
return;
}
var Y=X?"visible":"hidden";
if(J&&c(Z)){
c(Z).style.visibility=Y;
}else{
v("#"+Z,"visibility:"+Y);
}
}
function L(Y){
var Z=/[\\\"<>\.;]/;
var X=Z.exec(Y)!=null;
return X&&typeof encodeURIComponent!=D?encodeURIComponent(Y):Y;
}
var d=function(){
if(M.ie&&M.win){
window.attachEvent("onunload",function(){
var ac=I.length;
for(var ab=0;ab<ac;ab++){
I[ab][0].detachEvent(I[ab][1],I[ab][2]);
}
var Z=N.length;
for(var aa=0;aa<Z;aa++){
y(N[aa]);
}
for(var Y in M){
M[Y]=null;
}
M=null;
for(var X in swfobject){
swfobject[X]=null;
}
swfobject=null;
});
}
}();
return {registerObject:function(ab,X,aa,Z){
if(M.w3&&ab&&X){
var Y={};
Y.id=ab;
Y.swfVersion=X;
Y.expressInstall=aa;
Y.callbackFn=Z;
o[o.length]=Y;
w(ab,false);
}else{
if(Z){
Z({success:false,id:ab});
}
}
},getObjectById:function(X){
if(M.w3){
return z(X);
}
},embedSWF:function(ab,ah,ae,ag,Y,aa,Z,ad,af,ac){
var X={success:false,id:ah};
if(M.w3&&!(M.wk&&M.wk<312)&&ab&&ah&&ae&&ag&&Y){
w(ah,false);
K(function(){
ae+="";
ag+="";
var aj={};
if(af&&typeof af===r){
for(var al in af){
aj[al]=af[al];
}
}
aj.data=ab;
aj.width=ae;
aj.height=ag;
var am={};
if(ad&&typeof ad===r){
for(var ak in ad){
am[ak]=ad[ak];
}
}
if(Z&&typeof Z===r){
for(var ai in Z){
if(typeof am.flashvars!=D){
am.flashvars+="&"+ai+"="+Z[ai];
}else{
am.flashvars=ai+"="+Z[ai];
}
}
}
if(F(Y)){
var an=u(aj,am,ah);
if(aj.id==ah){
w(ah,true);
}
X.success=true;
X.ref=an;
}else{
if(aa&&A()){
aj.data=aa;
P(aj,am,ah,ac);
return;
}else{
w(ah,true);
}
}
if(ac){
ac(X);
}
});
}else{
if(ac){
ac(X);
}
}
},switchOffAutoHideShow:function(){
m=false;
},ua:M,getFlashPlayerVersion:function(){
return {major:M.pv[0],minor:M.pv[1],release:M.pv[2]};
},hasFlashPlayerVersion:F,createSWF:function(Z,Y,X){
if(M.w3){
return u(Z,Y,X);
}else{
return undefined;
}
},showExpressInstall:function(Z,aa,X,Y){
if(M.w3&&A()){
P(Z,aa,X,Y);
}
},removeSWF:function(X){
if(M.w3){
y(X);
}
},createCSS:function(aa,Z,Y,X){
if(M.w3){
v(aa,Z,Y,X);
}
},addDomLoadEvent:K,addLoadEvent:s,getQueryParamValue:function(aa){
var Z=j.location.search||j.location.hash;
if(Z){
if(/\?/.test(Z)){
Z=Z.split("?")[1];
}
if(aa==null){
return L(Z);
}
var Y=Z.split("&");
for(var X=0;X<Y.length;X++){
if(Y[X].substring(0,Y[X].indexOf("="))==aa){
return L(Y[X].substring((Y[X].indexOf("=")+1)));
}
}
}
return "";
},expressInstallCallback:function(){
if(a){
var X=c(R);
if(X&&l){
X.parentNode.replaceChild(l,X);
if(Q){
w(Q,true);
if(M.ie&&M.win){
l.style.display="block";
}
}
if(E){
E(B);
}
}
a=false;
}
}};
}();
var exportFlag=false;
window.onbeforeunload=function(){
if(isExportEvent){
isExportEvent=false;
return;
}
if(isFilterOptionsDIVOpened){
Filter.hideFilterOptions();
}
if((SAVED!=true||exprFieldKeyPressed||isCellEdited())&&jsREMOTE_SAVE_VIEW&&ALLOW_TO_WRITE&&UNSAVED_WARNING){
var _433a=showConfirmDialog(jsTitleMsg["confirmMsg.remoteDocSaveAndContinue"]);
if(_433a){
if(ISGEEDITOR){
saveremoteDraft();
}else{
deleteremotedoc();
}
}else{
return false;
}
}else{
if(!jsREMOTE_VIEW_SAVE_CALLED){
deleteremotedoc();
}
}
if(l10n){
if(messagetranslated){
saveMsg("autosave");
}
}
if((SAVED&&jsREMOTE_SAVE_VIEW)||(!exportFlag&&SAVED&&!exprFieldKeyPressed&&!isCellEdited()&&!browser_ie&&!jsREMOTE_VIEW_SAVE_CALLED)){
closeDocumentInstance(undefined,true);
}else{
if(!jsREMOTE_SAVE_VIEW&&!cdview){
if((!SAVED||exprFieldKeyPressed||isCellEdited())&&ALLOW_TO_WRITE){
return jsTitleMsg["confirmMsg.remoteDocSaveAndContinue"];
}
}
}
if(jsPUBLIC_VIEW||jsREMOTE_VIEW){
if(!SAVED){
if(isConfirmation){
return "";
}
}
}
};
window.onblur=function(){
unsetStatus();
(typeof snippet!=="undefined")&&snippet.hideDesignModeCue();
};
if(browser_nn6){
$(document.body).bind("focus",function(){
if(jsEMBED_VIEW){
return;
}
var el=ev.target;
if((el==document||el==window)){
if(typeof ole!=="undefined"&&ole.currObj){
ole.conf.onfocus();
}
}
});
}
if(browser_ie){
document.onfocusout=function(){
(typeof snippet!=="undefined")&&snippet.hideDesignModeCue();
};
}
function winResizeThrottle(){
var self=this;
this.lastExecThrottle=1000;
this.lastExec=new Date();
this.timer=null;
this.resizeHandler=function(){
var d=new Date();
if(d-self.lastExec<self.lastExecThrottle){
if(self.timer){
window.clearTimeout(self.timer);
}
self.timer=window.setTimeout(self.resizeHandler,self.lastExecThrottle);
return false;
}
self.lastExec=d;
resetPageDim("WIN_RESIZE");
clientDim=findClientDim();
clientWidth=clientDim.width;
clientHeight=clientDim.height;
};
}
var clientDim=findClientDim();
var clientWidth=clientDim.width;
var clientHeight=clientDim.height;
var winResizeThrotInst=new winResizeThrottle();
window.onresize=winResizeThrotInst.resizeHandler;
var Solver={dialog:false,validate:false,focusVariable:0,cnt:0,idcnt:0,isValueboxSelected:false,isNonNegRes:false,objectiveCell:undefined,oCellSheetName:undefined,vCellsSheetName:undefined,vCellStartRow:undefined,vCellStartCol:undefined,vCellEndRow:undefined,vCellEndCol:undefined,variableCellValues:undefined,oldValues:undefined,variableNewvalue:undefined,variableOldvalue:undefined,specificValue:undefined,goalType:undefined,focusConstraint:undefined,init:function(){
$.sheetdialog.close();
$.sheetdialog.openURL(ctxpath+"pages/dialogs/solverdialog.jsp",{width:550,closeOnEscape:false,minHeight:10,resizable:false,autoOpen:false,modal:true,title:jsMsg["Solver.UI.Solver"],},Solver.targetSelection);
},finalDestroy:function(){
delete Solver.dialog;
delete Solver.validate;
delete Solver.focusVariable;
Solver.cnt=0;
Solver.idcnt=0;
delete Solver.isValueboxSelected;
delete Solver.isNonNegRes;
delete Solver.objectiveCell;
delete Solver.oCellSheetName;
delete Solver.vCellsSheetName;
delete Solver.vCellStartRow;
delete Solver.vCellStartCol;
delete Solver.vCellEndRow;
delete Solver.vCellEndCol;
delete Solver.specificValue;
delete Solver.variableCellValues;
delete Solver.oldValues;
delete Solver.variableNewvalue;
delete Solver.variableOldvalue;
delete Solver.goalType;
delete Solver.focusConstraint;
clearCellRangeFill();
},destroy:function(){
if($("#SolverDialog").is(":visible")){
$(".ui-widget-overlay").show();
$.sheetdialog.close();
Solver.finalDestroy();
}else{
if($("#SolverResultDialog").is(":visible")){
Solver.submitCancel();
$.sheetdialog.close();
Solver.finalDestroy();
}
}
},focusValue:function(){
Solver.focusVariable=0;
Solver.focusConstraint=undefined;
setTimeout("$(\"#SpecValue\").focus()",280);
},showHideValueBox:function(){
var _433e=$("#optimize select").val();
if(_433e=="VALUE"){
$("#SpecValue").show();
setTimeout("$(\"#SpecValue\").focus()",300);
$("#SpecValue").bind("click",Solver.focusValue);
}else{
$("#SpecValue").hide();
}
},focusSolverElement:function(){
if($("#SolverDialog").is(":visible")){
if(Solver.focusVariable==1){
$("#objectiveCell").focus();
}else{
if(Solver.focusVariable==2){
$("#decisionVariable").focus();
}else{
if(Solver.focusVariable==3){
$(Solver.focusConstraint).focus();
}else{
if($("#SpecValue").is(":visible")){
$("#SpecValue").focus();
}else{
$("#sheetdialog").parent().focus();
}
}
}
}
}
},targetSelection:function(){
var _433f=$("#sheetdialog").parent().find(".ui-icon-closethick");
$(_433f).bind("mousedown",Solver.destroy);
var _4340=$("#sheetdialog").parent();
$(_4340).bind("click",Solver.focusSolverElement);
$(".ui-dialog-titlebar-close").show();
$("#SpecValue").hide();
$("#deletebutton").hide();
$(".ui-widget-overlay").hide();
Solver.dialog=true;
var row=ActiveCellInfo.getStartRow();
var col=ActiveCellInfo.getStartCol();
$("#objectiveCell").val(CURRSHEETNAME+"."+getColHeadLabel(col+1)+getRowHeadLabel(row));
$("#decisionVariable").focus();
},submit:function(){
if($("#SolverDialog").is(":visible")){
if(!Solver.Util.validateCellReference($("#objectiveCell").val(),3)){
showAlertDialog(jsMsg["GoalSeek.Msg.InvalidCell"]);
$("#objectiveCell").focus();
return;
}
if(!Solver.Util.validateCellReference($("#decisionVariable").val(),2)){
showAlertDialog(jsMsg["Solver.Error.Range"]);
$("#decisionVariable").focus();
return;
}
this.goalType=$("#optimize select").val();
if(this.goalType=="VALUE"){
this.isValueboxSelected=true;
}else{
this.isValueboxSelected=false;
}
if(this.isValueboxSelected){
this.specificValue=$("#SpecValue").val();
if((this.specificValue).length==0){
showAlertDialog(jsMsg["Solver.Error.NotNumber"]);
$("#SpecValue").focus();
return;
}
}
this.isNonNegRes=$("#SolverDialog input[type=checkbox]").is(":checked");
var _4343=[];
var _4344=[];
Solver.validate=false;
var _4345=$("#dynamicChangediv .textField");
for(var i=0,j=1,len=_4345.length;j<len;i=i+2,j=j+2){
if(($(_4345[i]).val()==""&&!($(_4345[j]).val()==""))||(!($(_4345[i]).val()=="")&&$(_4345[j]).val()=="")){
Solver.validate=true;
break;
}
}
if(Solver.validate){
showAlertDialog(jsMsg["GoalSeek.Msg.InvalidCell"]);
if($(_4345[i]).val()==""){
$(_4345[i]).val("");
$(_4345[i]).focus();
}else{
$(_4345[j]).val("");
$(_4345[j]).focus();
}
return;
}
for(var i=0,len=_4345.length;i<len;i++){
if((i%2)==0){
if($(_4345[i]).val()!=""&&(!Solver.Util.validateCellReference($(_4345[i]).val(),3))){
Solver.validate=true;
break;
}
}
}
if(Solver.validate){
showAlertDialog(jsMsg["GoalSeek.Msg.InvalidCell"]);
$(_4345[i]).val("");
$(_4345[i]).focus();
return;
}
var _4349=0;
var _434a=$("#dynamicChangediv select");
for(var _434b=0,_434c=1,len=_4345.length;_434c<len;_434b=_434b+2,_434c=_434c+2){
if(($(_4345[_434b]).val()!="")&&($(_4345[_434c]).val()!="")){
var _434d=$(_4345[_434b]).val();
var _434e=$(_434a[_4349]).val();
var _434f=$(_4345[_434c]).val();
_4343.push(_434d);
_4344.push(_434e);
_4343.push(_434f);
}
_4349++;
}
this.objectiveCell=Solver.Util.getCellRef($("#objectiveCell").val());
var vrLbl=Solver.Util.getStartLabelinRange($("#decisionVariable").val());
var vcLbl=Solver.Util.getEndLabelinRange($("#decisionVariable").val());
var _4352=getCellPosByLabel(vrLbl);
var _4353=getCellPosByLabel(vcLbl);
this.oCellSheetName=Solver.Util.getSheetName($("#objectiveCell").val());
this.vCellsSheetName=Solver.Util.getSheetName($("#decisionVariable").val());
this.vCellStartRow=_4352.row;
this.vCellStartCol=_4352.col;
this.vCellEndRow=_4353.row;
this.vCellEndCol=_4353.col;
if(cellRangeContainsMergeCells(_4352.row,_4352.col,_4353.row,_4353.col)){
showAlertDialog(jsMsg["Solver.Error.MergeCells"]);
return;
}
var _4354=[];
var _4355=[];
var _4356=[];
for(var _4357=0,_4358=1,k=0,len=_4343.length;_4357<len,_4358<len;_4357=_4357+2,_4358=_4358+2,k++){
var _435a=Solver.Util.getSheetName(_4343[_4357]);
var _435b=Solver.Util.getCellRef(_4343[_4357]);
_4354.push(_435a);
_4354.push(_435b);
_4355.push(_4344[k]);
_4356.push(_4343[_4358]);
}
var _435c=getXMLHttpRequest();
_435c.onreadystatechange=function(){
if(_435c.readyState==4){
Solver.responseHandler(_435c);
}
};
var nvp="docId="+DOCUMENT_ID+"&objectiveCell="+this.objectiveCell+"&curSheetName="+encodeURIComponent(CURRSHEETNAME)+"&oCellSheetName="+encodeURIComponent(this.oCellSheetName)+"&vCellsSheetName="+encodeURIComponent(this.vCellsSheetName)+"&curTime="+CURRENTTIME;
nvp+="&availableStartRow="+getAvailableStartRow()+"&availableEndRow="+getAvailableEndRow()+"&docOwner="+CURR_DOC_OWNERNAME+"&nonNegRestriction="+this.isNonNegRes;
nvp+="&goalType="+this.goalType+"&vCellStartRow="+this.vCellStartRow+"&vCellStartCol="+this.vCellStartCol+"&vCellEndRow="+this.vCellEndRow+"&vCellEndCol="+this.vCellEndCol+"&actionConstants=170";
nvp+="&constrLHS="+_4354+"&constrREL="+_4355+"&constrRHS="+_4356+"&isValueboxSelected="+this.isValueboxSelected;
if(this.isValueboxSelected){
nvp+="&specificValue="+this.specificValue;
}
if(USERSTATEID!=""){
nvp+="&userStateId="+USERSTATEID;
}
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols+"&viewType="+getViewType();
postAjax(_435c,ctxpath+"solver.do",nvp);
}else{
Solver.submitOk();
}
},responseHandler:function(_435e){
var _435f=parseJSON(_435e.responseText);
var error=_435f.message;
var _4361=_435f.solution;
var _4362=_435f.noNumber;
var _4363=_435f.exceptionformulaConstraint;
var _4364=_435f.exceptionformula;
var _4365=_435f.exception;
if(error!=null){
showAlertDialog(error);
}
if(_4362!=null){
showAlertDialog(_4362);
if(_4362==jsMsg["Solver.Error.NotNumber"]){
$("#SpecValue").focus();
}else{
$("#decisionVariable").focus();
}
return;
}
if(_4364!=null){
showAlertDialog(_4364);
$("#objectiveCell").focus();
return;
}
if(_4363!=null){
showAlertDialog(_4363);
$("#decisionVariable").focus();
return;
}
if(_4361!=null){
var _4366=_435f.solverClientUpdateJson;
var _4367=_435f.resultValue;
updateJson(_4366);
this.variableCellValues=_435f.variableCellValues;
this.oldValues=_435f.oldValues;
$(".ui-dialog-titlebar-close").hide();
$("#SolverDialog").attr("style","display:none");
$("#SolverResultDialog").attr("style","display:block");
$("#message").text(_4361);
$("#Result").text(_4367);
document.getElementById("solverSubmit").firstChild.textContent=jsTitleMsg.OK;
$(".ui-widget-overlay").show();
return;
}
if(_4365!=null){
var _4366=_435f.solverClientUpdateJson;
updateJson(_4366);
Solver.destroy();
showAlertDialog(_4365);
return;
}
},addConstraints:function(){
this.idcnt++;
var _4368="inEquality"+this.idcnt;
var _4369=document.getElementById("dynamicChangediv");
var _436a=document.createElement("div");
$(_436a).addClass("constraints");
_4368+=this.idcnt;
var _436b=document.createElement("div");
$(_436b).attr("style","float:left;padding-right:10px");
$(_436b).attr("title",jsMsg["CellReference.SingleSelection.Tooltip"]);
var _436c=document.createElement("input");
$(_436c).attr("type","text");
$(_436c).addClass("textField cR");
$(_436c).css("width","160px");
$(_436c).focus(function(){
Solver.focusVariable=3;
Solver.focusConstraint=this;
});
_436b.appendChild(_436c);
var _436d=document.createElement("div");
$(_436d).attr("style","float:left;padding-right:10px");
$(_436d).attr("title",jsMsg["CellReference.SingleSelection.Tooltip"]);
var _436e=document.createElement("input");
$(_436e).attr("type","text");
$(_436e).attr("maxlength","30");
$(_436e).addClass("textField cR");
$(_436e).attr("style","float:center");
$(_436e).css("width","160px");
$(_436e).focus(function(){
Solver.focusVariable=3;
Solver.focusConstraint=this;
});
_436d.appendChild(_436e);
var _436f=document.createElement("div");
$(_436f).attr("style","float:left;padding-right:10px");
$(_436f).attr("title",jsMsg["CellReference.SolverEQL"]);
$(_436f).click(function(){
Solver.focusVariable=0;
});
var _4370=document.createElement("select");
$(_4370).attr("style","width:70px");
$(_4370).attr("ctype","zcombo");
$(_4370).attr("data","{componentOptions:{type: 'text_only','editable': false}}");
var _4371=document.createElement("Option");
$(_4370).attr("id",_4368);
$(_4371).attr("value","LEQ");
$(_4371).text("<=");
$(_4370).append(_4371);
var _4372=document.createElement("Option");
$(_4372).attr("value","GEQ");
$(_4372).text(">=");
$(_4370).append(_4372);
var _4373=document.createElement("Option");
$(_4373).attr("value","EQ");
$(_4373).text("=");
$(_4370).append(_4373);
_436f.appendChild(_4370);
var _4374=document.createElement("span");
var _4375=document.createElement("input");
$(_4375).attr("type","button");
$(_4375).attr("id","deletebutton");
$(_4375).addClass("closeIconSmall");
$(_4375).click(function(){
Solver.delConstraint(this);
});
_4374.appendChild(_4375);
_436a.appendChild(_436b);
_436a.appendChild(_436f);
_436a.appendChild(_436d);
_436a.appendChild(_4374);
_4369.appendChild(_436a);
$.ui.utils.initComponents($(_4370));
$(_436c).focus();
this.cnt++;
if(this.cnt>0){
$("#deletebutton").show();
}
if(this.cnt==9){
$("#addLink").hide();
}
},submitOnEnter:function(e){
var key;
if(window.event){
key=window.event.keyCode;
}else{
key=e.which;
}
if(key==13){
return Solver.submit();
}else{
if(key==Event.KEY_ESC){
return Solver.destroy();
}else{
return false;
}
}
},delConstraint:function(ele){
var _4379=$(ele).parent().parent();
$(_4379).slideUp(200,function(){
if(Solver.cnt!=0){
$(ele).parent().parent().remove();
Solver.cnt--;
}
if(Solver.cnt==0){
$("#deletebutton").hide();
}
if(Solver.cnt<=9){
$("#addLink").show();
}
});
var _437a=$(_4379).siblings();
var _437b=$(_437a).last();
var _437c=$(_437b).children().find("input");
$(_437c[0]).focus();
},constructOkCancelRequest:function(_437d){
var nvp="docId="+DOCUMENT_ID+"&curSheetName="+encodeURIComponent(CURRSHEETNAME)+"&vCellsSheetName="+encodeURIComponent(this.vCellsSheetName)+"&curTime="+CURRENTTIME;
nvp+="&availableStartRow="+getAvailableStartRow()+"&availableEndRow="+getAvailableEndRow()+"&docOwner="+CURR_DOC_OWNERNAME;
nvp+="&vCellStartRow="+this.vCellStartRow+"&vCellStartCol="+this.vCellStartCol+"&vCellEndRow="+this.vCellEndRow+"&vCellEndCol="+this.vCellEndCol+"&actionConstants="+_437d+"&oldValue="+this.oldValues;
if(_437d==ActionConstants.SOLVER_TOOL_OK){
nvp+="&newValue="+this.variableNewvalue;
}
if(COLLABORATIVE_EDITING=="ON"){
nvp+="&collabId="+COLLAB_ID+"&isCollab=true";
}else{
nvp+="&isCollab=false";
}
if(FREEZED_ROW>0&&availableStartRow>ROWS_PER_TILE){
nvp+="&freezedRow="+FREEZED_ROW;
}
nvp+="&totCols="+totCols+"&viewType="+getViewType();
return nvp;
},submitCancel:function(){
var _437f=Solver.constructOkCancelRequest(ActionConstants.SOLVER_TOOL_CANCEL);
var _4380=getXMLHttpRequest();
_4380.onreadystatechange=function(){
if(_4380.readyState==4){
var _4381=parseJSON(_4380.responseText);
var _4382=_4381.solverClientUpdateJson;
updateJson(_4382);
return;
}
};
postAjax(_4380,ctxpath+"solver.do",_437f);
},submitOk:function(){
var _4383=this.variableCellValues;
var _4384=this.oldValues;
var _4385=doit(_4384);
this.oldValues=copypastedoit(_4385);
var _4386=doit(_4383);
this.variableNewvalue=copypastedoit(_4386);
this.variableNewvalue=decodeURIComponent(this.variableNewvalue);
var _4387=Solver.constructOkCancelRequest(ActionConstants.SOLVER_TOOL_OK);
var _4388=getXMLHttpRequest();
_4388.onreadystatechange=function(){
if(_4388.readyState==4){
var _4389=parseJSON(_4388.responseText);
setUNDO(_4389.u);
btn_enabled();
$("#sheetdialog").dialog("close");
Solver.finalDestroy();
return;
}
};
postAjax(_4388,ctxpath+"solver.do",_4387);
},focusCell:function(ev){
resetCellRangeFill();
isEditingInExprField=false;
clearTextSelection();
var el=(browser_ie)?window.event.srcElement:ev.target;
rangeFill=true;
if(el&&isCell(el)){
cellRangeStartRow=getRowPosInMouseEvent(ev);
cellRangeStartCol=getColPosInMouseEvent(ev);
if(isCellMerged(cellRangeStartRow,cellRangeStartCol)){
cellRangeStartCol=getMergedStartCol(cellRangeStartRow,cellRangeStartRow,cellRangeStartCol);
}
funRow=cellRangeStartRow;
funCol=cellRangeStartCol;
functionLeft=getEndLeftOfCol(cellRangeStartCol);
functionTop=getEndTopOfRow(cellRangeStartRow);
rangeFill=true;
var dim=getCellRangeDIM(cellRangeStartRow,cellRangeStartCol,cellRangeStartRow,cellRangeStartCol);
setCellRangeFillDIVPos(dim.left,dim.top);
setCellRangeFillDIVDim(dim.width,dim.height);
showCellRangeFillDIV();
}
}};
Solver.Util={validateCellReference:function(_438d,key){
var cellN=false;
_438d=Solver.Util.removeDollar(_438d);
if(_438d.indexOf(".")!=-1){
var _4390=_438d.substring(0,_438d.indexOf("."));
if(_4390.indexOf(" ")!=-1&&_4390.indexOf("'")==0){
_4390=_4390.substring(1,_4390.length-1);
}
if(!isDefinedSheet(_4390)){
return false;
}
_438d=_438d.substring(_438d.indexOf(".")+1,_438d.length);
}
if(key==2){
if(_438d.indexOf(":")!=-1){
if((isCellLabel(_438d.substring(0,_438d.indexOf(":"))))&&(isCellLabel(_438d.substring(_438d.indexOf(":")+1,_438d.length)))){
cellN=true;
}
}else{
if(isCellLabel(_438d)){
cellN=true;
}
}
}
if(key==3){
if(_438d.indexOf(":")!=-1){
return false;
}
if(isCellLabel(_438d)){
cellN=true;
}
}
return cellN;
},removeDollar:function(_4391){
_4391=_4391.replace("!",".");
while(_4391.indexOf("$")!=-1){
_4391=_4391.replace("$","");
}
return _4391;
},getSheetName:function(_4392){
_4392=Solver.Util.removeDollar(_4392);
if(_4392.indexOf(".")!=-1){
var _4393=_4392.substring(0,_4392.indexOf("."));
if(_4393.indexOf(" ")!=-1&&_4393.indexOf("'")==0){
_4393=_4393.substring(1,_4393.length-1);
}
return _4393;
}else{
return CURRSHEETNAME;
}
},getCellRef:function(_4394){
_4394=Solver.Util.removeDollar(_4394);
if(_4394.indexOf(".")!=-1){
var _4395=_4394.split(".");
return _4395[1];
}else{
return _4394;
}
},getStartLabelinRange:function(_4396){
_4396=Solver.Util.removeDollar(_4396);
if(_4396.indexOf(".")!=-1){
if(_4396.indexOf(":")!=-1){
var _4397=_4396.substring(_4396.indexOf(".")+1,_4396.indexOf(":"));
}else{
var _4397=_4396.substring(_4396.indexOf(".")+1,_4396.length);
}
}else{
if(_4396.indexOf(":")!=-1){
var _4397=_4396.substring(0,_4396.indexOf(":"));
}else{
var _4397=_4396.substring(0,_4396.length);
}
}
return _4397;
},getEndLabelinRange:function(_4398){
_4398=Solver.Util.removeDollar(_4398);
if(_4398.indexOf(".")!=-1){
if(_4398.indexOf(":")!=-1){
var EndLb=_4398.substring(_4398.indexOf(":")+1,_4398.length);
}else{
var EndLb=_4398.substring(_4398.indexOf(".")+1,_4398.length);
}
}else{
if(_4398.indexOf(":")!=-1){
var EndLb=_4398.substring(_4398.indexOf(":")+1,_4398.length);
}else{
var EndLb=_4398.substring(0,_4398.length);
}
}
return EndLb;
}};
function Feature(){
}
var tourdivopen=false;
var tourContent=new Array();
var featureList=new Array();
tourContent[1]="<b>File > Open </b></br>You can navigate, organize, and manage your files and folders.";
tourContent[2]="<b>File > Print</b></br>Set print options and preview it before printing.";
tourContent[3]="<b>Conditional Formatting</b></br>Format cells based on the desired criteria. You can even use Formulas to define the rule thereby expanding your possibilities. ";
tourContent[4]="<b>Format Cells </b></br>Choose from a variety of formats (number, currency, date, etc.) for your cells including your custom formats. ";
tourContent[5]="<b>Filter</b></br>Add filter to your spreadsheet to slice and dice your data.";
tourContent[6]="<b>Solver </b></br>A what-if analysis tool used for optimization.";
tourContent[7]="<b>Find and Replace </b></br>Find the string that you are looking for and optionally replace it with the desired string.";
tourContent[8]="<span style='font-size:14px;font-weight:bold;color:#000'>Welcome!</span></br>You are looking at the new version of Zoho Sheet! We have some new features for you: <b> Filters, Conditional Formatting, Format Cells, Improved Printing, Solver, Find and Replace.</b>";
featureList[1]="Feature.fileMenuOpen()";
featureList[2]="Feature.fileMenuPrint()";
featureList[3]="Feature.ConditionalFormatting()";
featureList[4]="Feature.FormatCells()";
featureList[5]="Feature.Filters()";
featureList[6]="Feature.Solver()";
featureList[7]="Feature.FindandReplace()";
Feature.fileMenuOpen=function(){
tourdivopen=true;
$("#tourDiv").fadeIn(1000);
$("#rightArrow").css("top","");
$("#tourDiv").css("top","");
$("#freezeTour,#startTour").fadeOut();
$("#leftArrow").fadeIn();
$("#topArrow,#start,#dontShowIt,#previous,#rightArrow").hide();
$("#dismiss").fadeIn();
$("#next").fadeIn();
$("#tourDiv").css("left","");
setTimeout("$('#fileMenu').click();$('#openfile').mouseover();",400);
var top=$("#eFTC").offset().top;
$("#filemenu").css("z-index",10002);
$("#fileMenu").css("z-index",10002);
var _439b=window.screen.width;
if(_439b<1030){
$("#tourDiv").css("top",top);
}else{
$("#tourDiv").css("top",top-4);
}
$("#tourDiv").fadeIn(1000).css("margin-left",215);
$("#leftArrow").fadeIn(1000).css("margin-left",0);
Feature.content(1);
};
Feature.fileMenuPrint=function(){
$("#tourDiv").fadeIn(1000);
$("#rightArrow").css("top","");
$("#tourDiv").css("top","");
$("#previous").fadeIn();
$("#freezeTour,#startTour").fadeOut();
$("#leftArrow").fadeIn();
$("#topArrow,#start,#dontShowIt,#rightArrow").hide();
$("#dismiss").fadeIn();
$("#next").fadeIn();
$("#tourDiv").css("left","");
setTimeout("$('#fileMenu').click();$('#print').mouseover();",100);
var top=$("#eFTC").offset().top;
$("#filemenu").css("z-index",10002);
$("#fileMenu").css("z-index",10002);
var _439d=window.screen.width;
if(_439d<1030){
$("#tourDiv").css("top",top+96);
}else{
$("#tourDiv").css("top",top+98);
}
$("#tourDiv").fadeIn(1000).css("margin-left",215);
$("#leftArrow").fadeIn(1000).css("margin-left",0);
$("#previous")[0].setAttribute("onclick",featureList[1]);
Feature.content(2);
};
Feature.ConditionalFormatting=function(){
$("#leftArrow").hide();
$("#rightArrow").hide();
$("#topArrow").fadeIn();
$("#previous").fadeIn();
$("#formattw").click();
var left=$("#conditionalformat").offset().left;
var top=$("#conditionalformat").offset().top;
var _43a0=window.screen.width;
$("#topArrow").css("left","125px");
if(_43a0<1030){
$("#tourDiv").animate({marginLeft:left-248},600);
$("#topArrow").css("left","250px");
}else{
$("#tourDiv").animate({marginLeft:left-120},600);
}
$("#tourDiv").css("top",top+40);
$("#previous")[0].setAttribute("onclick",featureList[2]);
Feature.content(3);
};
Feature.FormatCells=function(){
$("#leftArrow").hide();
$("#rightArrow").hide();
$("#topArrow").fadeIn();
$("#previous").fadeIn();
$("#formattw").click();
var left=$("#frmtCells").offset().left;
var top=$("#conditionalformat").offset().top;
$("#tourDiv").css("top",top+40);
$("#topArrow").css("left","125px");
var _43a3=window.screen.width;
if(_43a3<1030){
$("#tourDiv").animate({marginLeft:left-219},600);
$("#topArrow").css("left","225px");
}else{
$("#tourDiv").animate({marginLeft:left-120},600);
}
$("#previous")[0].setAttribute("onclick",featureList[3]);
Feature.content(4);
};
Feature.Filters=function(){
$("#leftArrow").hide();
$("#rightArrow").hide();
$("#topArrow").fadeIn();
$("#previous").fadeIn();
$("#next").fadeIn();
$("#datatw").click();
var left=$("#filterData").offset().left;
var top=$("#filterData").offset().top;
$("#topArrow").css("left","127px");
$("#tourDiv").css("top",top+40);
$("#tourDiv").animate({marginLeft:left-111},600);
$("#previous")[0].setAttribute("onclick",featureList[4]);
Feature.content(5);
};
Feature.Solver=function(){
$("#leftArrow").hide();
$("#rightArrow").hide();
$("#topArrow").fadeIn();
$("#previous").fadeIn();
$("#next").fadeIn();
$("#datatw").click();
var left=$("#solverTool").offset().left;
var top=$("#solverTool").offset().top;
$("#tourDiv").css("top",top+40);
$("#topArrow").css("left","125px");
$("#tourDiv").animate({marginLeft:left-99},600);
$("#previous")[0].setAttribute("onclick",featureList[5]);
Feature.content(6);
};
Feature.FindandReplace=function(){
$("#leftArrow").hide();
$("#rightArrow").hide();
$("#topArrow").fadeIn();
$("#previous").fadeIn();
$("#next").hide();
$("#reviewtw").click();
var left=$("#find").offset().left;
var top=$("#find").offset().top;
var width=$("#find").width();
$("#topArrow").css("left",left+15);
$("#tourDiv").css("top",top+40);
$("#tourDiv").animate({marginLeft:left-71},600);
$("#previous")[0].setAttribute("onclick",featureList[6]);
Feature.content(7);
};
Feature.hideStartTour=function(){
tourdivopen=false;
$("#tourDiv").fadeOut(700);
var _43ab=new getXmlhttp();
_43ab.onreadystatechange=function(){
if(_43ab.readyState==4){
}
};
var nvp=appendCSRFToURL("action=releaseNotify&docowner="+CURR_DOC_OWNERNAME);
postAjax(_43ab,ctxpath+"releaseNotify.do",nvp);
};
Feature.closeTour=function(){
$("#tourDiv").fadeOut(700);
tourdivopen=false;
};
Feature.content=function(_43ad){
$("#msgDiv").html("").html(tourContent[_43ad]);
$("#next")[0].setAttribute("onclick",featureList[_43ad+1]);
};
Feature.ShowWelcomeNotes=function(view){
if(view=="View"){
tourdivopen=true;
if(!$("#tourDiv")[0]){
return;
}
$("#tourDiv").show();
$("#topArrow,#leftArrow,#next,#previous").hide();
$("#rightArrow").css("top","31px").fadeIn();
$("#rightArrow").css("margin-left",0);
$("#dismiss")[0].setAttribute("onclick","Feature.hideStartTour()");
$("#dismiss").fadeOut();
$("#dontShowIt").fadeIn();
Feature.content(8);
var top=$("#sheetOptions").offset().top;
$("#tourDiv").css("margin-top","");
$("#tourDiv").css("top",top+90);
if(browser_ie){
$("#tourDiv").css("margin-left",document.body.clientWidth-227-300);
}else{
$("#tourDiv").css("margin-left",window.outerWidth-227-300);
}
$("#rightArrow").css("margin-left",1+($("#tourDiv").offset().left+$("#tourDiv").width()-$("#rightArrow").offset().left));
setTimeout("$('#sheetOptions').click();$('#whatsnew').mouseover();",0);
}else{
Feature.closeTour();
}
};
if(typeof WMSUI!=="undefined"){
WMSUI.initContactsUI=function(){
if(WMSUI.usersdiv==undefined||WMSUI.contactscont==undefined){
WMSUI.usersdiv=document.createElement("DIV");
if(!WMSUI.contactsenabled){
return;
}
WMSUI.usersdiv.className="wms-ucd";
WMSUI.usersdiv.style.display="none";
WMSUI.toolbar.appendChild(WMSUI.usersdiv);
WMSUI.usersdiv.innerHTML="<p class=\"wms-th1\"><img class=\"wms-ac\" id=\"wmsinvite\" onclick=\"return WMSUI.toggleaddcnt();\" title=\""+WmsResource.getRealValue("Invite")+"\" src=\"/"+_WMSCONT+"/images/spacer.gif\"/><img src=\"/"+_WMSCONT+"/images/spacer.gif\" class=\"wms-min2\" onclick=\"WMSUI.hideusrs();\" title=\""+WmsResource.getRealValue("Minimize")+"\" \"/><span class=\"wms-oh\" id=\"wmsdname\" onclick=\"WMSUI.hideusrs();\" style=\"cursor:pointer\" title=\""+WmsResource.getRealValue("Click_to_minimize")+"\"><img src=\"/"+_WMSCONT+"/images/spacer.gif\" class=\"wmsus-1\"/><span class=\"wms-thuname\">&nbsp;</span></span><div id=\"wms-userstatus\" class=\"wmsuserstatus\" ><div class=\"statusdiv\" id=\"ustatustxt\" ><input type=\"text\" value=\"\"  onclick=\"WMSUI.editUserStatus();\" /><img src=\"/"+_WMSCONT+"/images/spacer.gif\" class=\"arrowdrop\"  id=\"ustatusimg\"  onclick=\"WMSUI.toggleustatus(event);\" /></div></div></p><div class=\"wmspd1\" style=\"display:none;overflow-x:hidden;\" id=\"uslsdiv\">&nbsp;</div><div class=\"wmssd\"><div id=\"wms-addcntct\" class=\"wmssearch\"><input onkeydown=\"return WMSUI.handleKeyDown(event);\" onkeyup=\"WMSUI.searchContacts(this.value,event);\" onclick=\"WMSUI.clearSearch(this)\" onblur=\"WMSUI.SetSearchTxt(this)\" type=\"text\" id=\"wms-clist\" name=\"clist\" class=\"wmstxt\" style=\"width:180px;color:#999;\" value=\""+WmsResource.getRealValue("Search_Contacts")+"\"/></div><div id=\"wms-addmem\" class=\"wmsaddmem\" style=\"display:none\"></div><div id=\"wmsoptionsdiv\" class=\"wms-rigb\" style=\"display:none;\" onmouseover=\"WMSUI.clearOptionTimer()\" onmouseout=\"WMSUI.hideOption()\"></div><div id=\"wmsconcont\" class=\"wmsconcont\" onscroll=\"WMSUI.contactScrolled(event);WMSUI.hideContactinfo()\" onmouseout=\"WMSUI.setClickedId(-1);\"></div><div id=\"wmscontactinfo\" class=\"wms-contactinfodiv\" style=\"position:absolute;display:none;\"></div>";
WMSUI.objshown="search";
WMSUI.contactinfodiv=WindowHandler.getObjectInObject(WMSUI.usersdiv,"wmscontactinfo","DIV");
WMSUI.contactscont=WindowHandler.getObjectInObject(WMSUI.usersdiv,"wmsconcont","DIV");
WMSUI.optionsdiv=WindowHandler.getObjectInObject(WMSUI.usersdiv,"wmsoptionsdiv","DIV");
if(!WMSUI.showusers){
WMSUI.usersdiv.style.display="none";
}else{
WMSUI.usersdiv.className="wms-ucd";
WMSUI.usersbar.className="wms-od-selected";
}
WMSUI.updateUserInfo();
}
};
}
if(document.getElementsByClassName){
document.getElementsByClassName=nativeGetElementsByClassName;
}
var ActionConstants={"GOAL_SEEK_OK":146,"BATCH_UPDATE_CSV_DATA":135,"VALIGN":5,"BORDER_BOTTOM":17,"LIST_SHEET_NAMES":131,"OTHER_SHEET_CHANGE":106,"FILLSERIES":54,"LAYOUTFORMAT":78,"MACRO_WARNING":130,"SHEET_VISIBLE":103,"CONDITIONAL_FORMAT_READ_RANGE":147,"WEB_DATA":68,"BORDER_TOP_BOTTOM_DOUBLE":27,"BORDER_INSIDE":24,"BOLD":38,"READ_CELL_FORMULA":133,"BORDER_ALL_RIGHT":114,"COMPUTE_SUM":55,"DELETE_ROW":44,"FONTSIZE":4,"BORDER_HORIZONTAL_OUTSIDE":23,"STRIKETHROUGH":77,"SHEET_MOVE":101,"INSERT_COL":43,"HIDE_ROWS":161,"COMMENT":35,"SELECT":95,"FIND_IN_COL":156,"GOAL_SEEK_CANCEL":145,"NEW_WORKBOOK":128,"COPY_PASTE":52,"UNHIDE_ROWS":162,"STRINGFORMAT":34,"COLUMN_PATTERN":66,"INSERT_CSV_DATA_AT_END":134,"FIND_IN_WORKBOOK":153,"SUBMIT":0,"CLEARCONTENTS":32,"SHADOW":76,"NAMEDRANGE_ADD":137,"HEIGHT":10,"RANGE_PATTERN":65,"INSERT_COPY_ROW":121,"CLEAR_ANNOTATION":112,"BORDERS":36,"FORMATNUMBER":58,"CHART_MOVE":74,"BORDER_LEFT":13,"GOAL_SEEK":144,"CONDITIONAL_FORMAT_DELETE":146,"INSERT_COPY_COLUMN":122,"SHEET_INSERT":104,"DELETE":83,"CHART_DELETE":73,"VALUE":94,"ERROR":200,"BORDER_BOTTOM_DOUBLE":26,"BORDER_RIGHT":14,"ENABLE_EVENTS":80,"SHEET_COPY":99,"INSERTMODE_COPY_NEXTCELL_STYLE":142,"MERGE_SPLIT":37,"UNDERLINE":2,"BORDER_OUTSIDE":19,"DOCACTION":79,"CLEARALL":61,"WORKBOOK_ACTION":126,"CONDITIONAL_FORMAT_READ_WORKBOOK":149,"BORDER_NONE":12,"BORDER_VERTICAL_OUTSIDE":21,"CALCULATE":96,"BORDER_TOP_BOTTOM_THICK":28,"WIDTH":41,"SAVE_WORKBOOK":127,"TEXTCOLOR":8,"CHART":70,"PASTESPECIAL_FORMATS":148,"INSERTMODE_COPY_NOSTYLE":140,"ITALIC":1,"BORDER_ALL_TOP":115,"NAMEDRANGE_MODIFY":138,"COLUMN_CELLSTYLENAME":48,"CREATE_FILTER":109,"INSERT_CUT_ROW":123,"CUT_PASTE":53,"CONDITIONAL_FORMAT_APPLY":144,"BORDER_BOTTOM_THICK":29,"FORMULA":93,"CELL_STYLENAME":50,"NAMED_RANGE":67,"SOLVER_TOOL_CANCEL":172,"INSERT_CUT_COLUMN":124,"FIND_IN_SHEET":154,"HYPERLINK":56,"SOLVER_TOOL":170,"MERGE_ACROSS":151,"CONDITIONAL_FORMAT_EDIT":145,"FIND":157,"REPLACE_ALL":159,"CELL":49,"CHART_NEW":75,"MODE_DOWN":87,"INSERTMODE_CLEAR_STYLE":143,"SWITCH_SHEET":62,"CONDITIONAL_FORMAT_READ_SHEET":148,"MODE_COLUMNS":92,"COLOR":7,"BORDER_ALL_BOTTOM":116,"MODE_LEFT":88,"FIND_IN_ROW":155,"FONTFAMILY":3,"SHEET_ACTIVATE":98,"HALIGN":6,"NAMEDRANGE_DELETE":139,"DELETE_RANGE":84,"BORDER_DIAGONAL_DOWN":117,"CHART_DATACHANGE":72,"ERROR_MESSAGE":201,"REPLACE":158,"DEPENDENT_CELL":59,"COPY_PASTE_CONTENT":51,"COLUMN":47,"BORDER_TOP_BOTTOM":18,"DELETE_COL":45,"MODE_UP":86,"FORMATCELLS":147,"BATCH_UPDATE_BY_CELL_REF":136,"BORDER_ALL_LEFT":113,"BORDER_VERTICAL":20,"CHANGE_BRIDGENO":105,"MODE_RIGHT":89,"APPLY_FILTER_CONDITION":111,"REMOVE_FILTER":110,"ADD":81,"INSERTMODE_COPY_PREVIOUSCELL_STYLE":141,"SHEET_REMOVE":100,"MERGE_AND_CENTER":152,"NUMBERFORMAT":33,"BORDER_TOP":16,"INSERT_RANGE":85,"PERCENT":108,"SHEETACTION":97,"BORDER_LEFT_RIGHT":15,"CLEARSTYLES":31,"SOLVER_TOOL_OK":171,"INSERT_ROW":42,"RANGE":46,"SORT":60,"CELL_COMMENT":57,"CONDITIONAL_FORMAT_READ_EDITOBJ":150,"BORDER_DIAGONAL_UP":118,"CHART_REGENERATE":71,"MERGE_RANGE":149,"UNDO_MESSAGE":63,"CHANGE":82,"MERGE_DOWN":150,"BORDER_INSIDE_HORIZONTAL":120,"READ_CELL_CONTENT":132,"UNDOREDOCOUNT":11,"MODE_NONE":90,"REPEAT_ACTION":129,"MODE_ROWS":91,"UPDATE_FILTER_RANGE":160,"BORDER_INSIDE_VERTICAL":119,"SET_VISIBILITY":163,"FORMAT":69,"DEBUG_MSG":107,"MACRO":125,"BORDER_ALL":25,"BORDER_HORIZONTAL":22,"WRAP":9,"SHEET_RENAME":102,"RANGE_STYLE":64};
var ConditionalFormatOperator={"DATE_NOT_ON":38,"TODAY":14,"NEXT_MONTH":23,"FORMULA":41,"DATE_BEFORE":33,"GREATER_THAN":1,"DATE_AFTER":35,"ISERROR":29,"THIS_YEAR":25,"DATE_ON_OR_BEFORE":34,"NEXT_7_DAYS":17,"THIS_MONTH":22,"NEXT_WEEK":20,"DATE_BETWEEN":39,"NOT_BETWEEN":8,"TEXT_BEGINNINGWITH":11,"TEXT_ENDINGWITH":12,"ISBLANK":27,"THIS_WEEK":19,"LAST_YEAR":24,"NEXT_YEAR":26,"ISNOTBLANK":28,"LAST_MONTH":21,"NOT_EQUAL":6,"LAST_WEEK":18,"EQUAL":5,"LESS_THAN":2,"DATE_ON":37,"LESS_EQUAL":4,"DATE_NOT_BETWEEN":40,"TEXT_CONTAINING":9,"LAST_7_DAYS":16,"TEXT_NOTCONTAINING":10,"ISNOTERROR":30,"YESTERDAY":13,"BETWEEN":7,"GREATER_EQUAL":3,"DATE_ON_OR_AFTER":36,"TOMORROW":15};
console.log('skiliks');
